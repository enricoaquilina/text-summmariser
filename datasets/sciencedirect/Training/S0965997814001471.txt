@&#MAIN-TITLE@&#
Upper bound sequential linear programming mesh adaptation scheme for collapse analysis of masonry vaults

@&#HIGHLIGHTS@&#
Upper bound limit analysis of masonry vaults and double curvature structures.Utilization of curved, six noded infinitely resistant triangular elements.Plastic dissipation allowed on curved interfaces only.Mesh adaptation (nodes coordinate movements) with sequential linear programming.Substitution of the heterogeneous material with a homogenized continuum.

@&#KEYPHRASES@&#
Masonry,Upper bound limit analysis,Double curvature structures,Rigid elements and interfaces,Sequential linear programming,Mesh adaptation,

@&#ABSTRACT@&#
The analysis of masonry double curvature structures by means of the kinematic theorem of limit analysis is traditionally the most diffused and straightforward method for an estimate of the load carrying capacity. However, the evaluation of the actual failure mechanism is not always trivial, especially for complex geometries and load conditions. Usually, the failure mechanism is simply hypothesized basing on previous experience, or – due to the complexity of the problem – FE rigid elements with interfaces are used. Both strategies may result in a wrong evaluation of the failure mechanism and hence, in the framework of the kinematic theorem of limit analysis, in an overestimation of the collapse load.In this paper, a simple discontinuous upper bound limit analysis approach with sequential linear programming mesh adaptation to analyze masonry double curvature structures is presented. The discretization of the vault is performed with infinitely resistant triangular elements (curved elements basing on a quadratic interpolation), with plastic dissipation allowed only at the interfaces for possible in- and out-of-plane jumps of velocities. Masonry is substituted with a fictitious material exhibiting an orthotropic behavior, by means of consolidated homogenization strategies.To progressively favor that the position of the interfaces coincide with the actual failure mechanism, an iterative mesh adaptation scheme based on sequential linear programming is proposed. Non-linear geometrical constraints on nodes positions are linearized with a first order Taylor expansion scheme, thus allowing to treat the NLP problem with consolidated LP routines.The choice of inequalities constraints on elements nodes coordinates turns out to be crucial on the algorithm convergence. The model performs poorly for coarse and unstructured meshes (i.e. at the initial iteration), but converges to the actual solution after few iterations.Several examples are treated, namely a straight circular and a skew parabolic arch, a cross vault and a dome. The results obtained at the final iteration fit well, for all the cases analyzed, previously presented numerical approaches.

@&#INTRODUCTION@&#
The analysis of masonry vaults up to collapse is a controversial issue that still is the object of investigation by specialized literature.Far before the diffusion of computers, several graphical attempts for the study of the equilibrium of masonry domes were attempted by famous “fathers” of the mechanics, as for instance Bouguer (1734), Coulomb (1773), Bossut (1778) and Mascheroni (1785), who proposed simple mono-dimensional equilibrium equations, neglecting the role of circumferential actions. Anyway, what was clear from the beginning, was that non-linearity appears very early on curved masonry elements, even in presence of self-weight and with very low tensile stresses.In this context, a considerable improvement in the analysis of spherical domes was achieved about 100years later, when Levy (1888) proposed a graphical analysis aimed at finding the circle on which circumferential forces vanish. The history on the theories dealing with masonry vaults is long and fascinating and we refer the reader to the treatise by Benvenuto [1] for a comprehensive review.Exception made for some particular cases, either where geometric and load symmetry may help in simplifying the problem or for single curvature structures (arches), and despite the considerable wide spreading of Finite Elements programs, it can be affirmed that, at present the models available to practitioners for a fast and reliable analysis of curved structural elements beyond the elastic limit are a few, see for instance the indications provided by Como [2], Heyman [3–5] and Huerta [6].Limit analysis theorems associated with FEs, both in the static and kinematic version, are still the most effective and widespread procedure to estimate the collapse loads of one dimensional arches [7–12]. Indeed, limit analysis combines, on one hand, sufficient insight into collapse mechanisms, ultimate stress distributions – at least in critical sections – and load capacities, and on the other hand, simplicity to be cast into a practical computational tool. Given the difficulties in obtaining reliable experimental data for frictional materials, another appealing feature of limit analysis is the reduced number of necessary material parameters.Similarly to arches, cupolas may be treated as well with 1D computerized approaches, but only under the quite restrictive condition of axi-symmetric loads [12–14].Exception made for some special cases, the extension of automated approaches for complex geometries, general load conditions, reinforced arches and structures interacting with the infill still remains a challenging topic [15–19], despite experimentation in the field is putting at disposal a huge amount of experiences and evidences [20–22].In absence of dedicated software, the most straightforward approach still remains the utilization of general purpose non-linear FEs, either already implemented in commercial codes [23,24] or non commercial but conceived for isotropic materials, as for instance concrete [18,19].The author of this paper has been active on the implementation of FE limit analysis software specialized to the analysis of masonry structures from one decade. In this framework, some different approaches were proposed dealing with the prediction of the collapse loads and failure mechanisms of masonry vaults, taking into account some important distinctive aspects of the material, as orthotropy and geometry issues [25–30]. The models include (1) homogenized limit analyses by means of both plate and shell [30] and 3D elements [28,29].An enhanced code [27] recently presented allows the possibility to model FRP reinforcement strips and steel tie rods, to quantitatively compare the situation before and after a rehabilitation intervention conducted with either innovative or traditional technology, thus implicitly selecting the most effective strategy for structural upgrading and refurbishment.The approaches proposed base almost always on the upper bound theorem of classic limit analysis, i.e. where constitutive materials are assumed rigid-perfectly plastic with infinite ductility and the flow rule is associated.From a technical point of view, the FE procedure bases on the original idea firstly proposed by Sloan and Kleeman [31], who presented a plane strain upper bound approach with triangular discretization and possible plastic dissipation on both continuum (triangles) and at the interfaces between adjoining elements. It has been widely shown, indeed, that such approach is extremely effective for cohesive frictional materials and therefore adapts well to masonry [32].To deal with complex coupled problems where both flexural and membrane loads may play a crucial role in the formation of the failure mechanism, as in the case of masonry vaults, the utilization of triangular discretizations with dissipation on both elements and interfaces appears hardily applicable, both for the difficulties in determining homogenized failure surfaces to be used in a continuum schematization through a Reissner–Mindlin plate and shell model (a failure surface with eight independent variables, i.e. three internal membrane actions, three moments and two out-of-plane shears) and for the prohibitive number of variables to use in the classic framework of linear programming, even for small-scale problems.Recent trends in limit analysis (see for instance [33–41]) demonstrated that the utilization of LP in solving the typical linear optimization problem associated to the upper and lower bound problems of limit analysis is less effective than the application of robust non-linear programming routines (NLP), with the considerable advantage that the linearization of the material strength domain is avoided. This allowed a further improvement in the numerical efficiency of FE limit analysis programs.Another fundamental issue of limit analysis is that the classical lower and upper bound theorems allow a rigorous bracketing of the exact collapse load for a perfectly plastic structure. As a consequence, when such theorems are used in combination with the finite element method, the ability to obtain tight bracketing depends not only on the efficient solution of the arising optimization problem, but also on the effectiveness of the elements employed. Classic approaches aimed at improving the performance is to increase the “quality” of velocity (or stress) field interpolation inside elements, for instance using polynomial expansions with degree larger than one [42]. Basing on this idea, for example the so called free Galerkin approach and the p-FEM were used in [43–45], respectively.However, such high order elements pose a particular difficulty when (strict) upper bound analyses must be performed, since the flow rule is required to hold throughout each element, whereas practically it can only be enforced on a finite number of points. To circumvent such a limitation, a constant strain element combined with discontinuities in the displacement field (see again Sloan and Kleeman [31]) was proposed in the past.A quite simple and diffused classic alternative is to use remeshing [46,47], which relies into the introduction of new nodes and elements on those regions of the structure inside the processing zone. Remeshing basically requires (1) a rule to decide where to refine the mesh and (2) to establish in which way the mesh must be automatically refined. Whilst the procedure is very straightforward, it has the obvious drawback of increasing exponentially the computational effort needed after a few iterations, because the discretization is continuously refined where needed. In the framework of an upper bound approach of limit analysis, one of the rules – but not the unique – that may be adopted to identify the zones needing remeshing is represented by the identification of those elements where the plastic dissipation is large. In order not to generate distorted meshes in the new iteration, either a regular refinement approach (i.e. triangles with large plastic dissipation are refined twice) or a refinement by bisection of the longest edge (i.e. triangles are refined four times) is recommended, as extensively shown in Christiansen and Pedersen [47]. The procedure however may be effective exclusively for FE models where plastic dissipation in continuum is allowed.In all those problems, as for instance for masonry vaults, where the complexity of the geometry and the variety of internal stresses acting would require a large number of optimization variables, an alternative possibility of analysis is constituted by the utilization of rigid and infinitely resistant elements with plastic dissipation allowed exclusively on interfaces.In this way, the number of variables is drastically reduced but unfortunately the failure mechanism is constrained to run exclusively within interfaces, with the consequence of making the problem strongly mesh-dependent with the risk of an incorrect evaluation of the collapse load, which in the framework of the upper bound theorem of limit analysis, is overestimated.In practice, the alignment of the discontinuities becomes crucial and the FE approach can perform poorly if an unstructured mesh is employed. In order to circumvent this limitation, again re-meshing and adaptive re-meshing strategies could be adopted [46–49]. In particular, for models where dissipation is allowed only on interfaces, a possible intuitive refinement may be represented by the subdivision into three elements of each triangle sharing an interface with large dissipation. The subdivision involves the centroid of the triangle, which will become a new vertex for the three subdivided elements in the next iteration. The algorithm is simple, but has the drawback of generating rather distorted meshes after a few iterations. In addition, if the dissipation is allowed exclusively on interfaces, elements distortion does not affect sensibly the value of the collapse load, but the identification of a well-defined failure mechanism becomes impossible, the convergence is slow and the processing zone is fuzzy.An effective alternative to remeshing has been recently proposed in [50] by the author for in-plane problems, which relies on an iterative procedure of adaptation of the mesh involving only geometrical issues, where the number of optimization variables is left unaltered at the successive iterations and the nodes belonging to the mesh are moved with a Sequential Linear Programming (SLP) scheme, enforcing some of the interfaces to coincide with the yield lines.On the other hand SLP has been already successfully used for the limit analysis of concrete slabs [51–53], where a linear interpolation of the velocity field on triangular elements naturally constraints the dissipation exclusively on interfaces [54,55].The idea of “adjusting” the position of the nodes presented in [50], belongs to the wide family of so-called perturbative methods and has been considerably enhanced and successfully applied for geotechnical problems in the framework of cone programming in [56].The simple approach presented in [50] is here generalized to double curvature geometries and structures subjected contemporarily to in- and out-of-plane loads, applied on a set of very demanding limit analysis problems and specialized to masonry structures, where the failure surface is orthotropic and the application of non-linear programming is not beneficial because a closed form expression for the failure surface is not available.The advantages achieved consist in (1) a strong limitation of optimization variables in order to make the numerical model fast and efficient and (2) in the quite reliable reproduction of general failure mechanisms involving in- and out-of-plane loads, even with quite coarse meshes.Furthermore, it is worth noting that the generalization to masonry vaults appears extremely interesting, because it follows the classic procedure commonly accepted within upper bound limit analysis of masonry structures, of identifying rigid blocks forming a failure mechanism, but without a priori selecting the failure mechanism. In this manner, the collapse loads estimates are reliable, whereas the only skills requires to the final utilizer are the preparation of the initial mesh and to be vaguely familiar with the concept of linear programming.In the model, quadratic six-noded curved rigid triangles, with possible dissipation along (curved) interfaces between adjoining elements are utilized, with the aim of better approximating curved geometries with a few elements. Since dissipation can occur only at the interfaces between contiguous elements, the mesh adaptation scheme based on SLP requires exclusively a linearization of the equations expressing the power dissipated on interfaces and associated flow rule on discontinuities. The recursive algorithm follows a classical procedure based on linear programming and mainly deals with geometrical aspects (nodes movement) rather than on numerical issues related to non-linear programming. For this reason, it is believed it can be of interest also for the masonry community, usually not familiar with recent trends regarding operational research.Another new aspect of the method proposed with respect to the in-plane approach presented in [50], is that an efficient procedure is proposed to avoid topology errors, which can be sometimes encountered during the mesh adaptation, especially if nodes movement during an adaptation iteration is constrained within a too large range. As for the in-plane case, indeed, the choice of inequalities constraints on elements nodes coordinates turns out to be crucial on the algorithm convergence.Several meaningful examples are treated to validate the procedure proposed, namely a 1D circular arch (to compare with alternative procedures based on classic 1D limit analysis and a new Genetic Algorithm procedure), a parabolic skew arch, a ribbed cross vault with eccentric vertical load and a masonry dome with an axisymmetric load applied on the top. The results obtained at the final iteration fit very well, for all the cases analyzed, previously presented numerical approaches and, where available, analytical predictions.In this section, an adaptive upper bound limit analysis conducted by means of curved rigid triangular elements and curved interfaces is proposed.The reasons at the base of the utilization of adaptive rigid elements with generally curved edges are (1) the capability of the method to reproduce complex failure mechanisms with a few elements and non-straight yield lines more accurately, when compared with standard rigid blocks and (2) the simplicity of the algorithm, consisting on a trivial recursive utilization of robust LP routines. In the paper, it is shown how the method could potentially compete favorably with classical remeshing [46,47] in case of structures with many optimization variables (especially for the presence of many plastic multiplier rates). In fact, while for the present analyses a number of LP problems with the same number of optimization variables has to be solved to converge to suitable solutions, in re-meshing [46] the number of optimization variables increases at successive iterations, meaning that time required to perform the simulation becomes large near the optimal mesh.Let a six-noded triangular curved shell element E be considered, as shown in Fig. 1, with nodes coordinates (xi,yi,zi), i=1,…,6 and node numbers disposed in counter clockwise order, with vertex node numbers from 1 to 3. Let symbol Ω indicates the surface of E, Fig. 1.Introducing natural coordinates t and p varying respectively from 0 to 1 and from 0 to 1−t), the global coordinate (x,y,z) of a point P within the triangular element E can be expressed as:(1)P≡[xyz]T=∑i=16Ni(t,p)[xiyizi]Twhere xi, yiand ziare global coordinates of node Pi(i=1,…,6) and Niis the node i shape function. Niare given by:(2)Ni(t,p)=ηi(2ηi-1)i=1,2,34ηi-3ηi-2i=4,5,6ηi=1-p-ti=1,4ti=2pi=3Natural coordinates of nodal points are respectivelyP1(t,p)=(0,0),P2(t,p)=(1,0),P3(t,p)=(0,1),P4(t,p)=(1/2,0),P5(t,p)=(1/2,1/2),P6(t,p)=(0,1/2).If we consider the edgeΓ12eof element E connecting P1 and P2 nodes corner, assuming that the edge is constrained to pass also through P4, each point P onΓ12eis given in parametric form (assuming, i.e. p=0) as follows:(3)P=P(t)=x(t)y(t)z(t)x(t)=xP1+(-3xP1-xP2+4xP4)t+2[(xP1+xP2)-2xP4]t2y(t)=yP1+(-3yP1-yP2+4yP4)t+2[(yP1+yP2)-2yP4]t2z(t)=zP1+(-3zP1-zP2+4zP4)t+2[(zP1+zP2)-2zP4]t2wherexPi,yPiandzPiare respectively x, y and z coordinates of node Piandt∈[01].It is mathematically convenient to re-write (3) as:(4)P=P(t)=Ax0+Ax1t+Ax2t2Ay0+Ay1t+Ay2t2Az0+Az1t+Az2t2with obvious meaning of the symbols.From (3), it follows that for an arbitrary edgeΓijeof an element E which connects nodes i−j, a suitable local curved frame of reference se−re−qewith origin on vertex i can be identified, as shown in Fig. 2.Assuming that triangles are rigid and infinitely resistant, and that plastic dissipation is allowed only at the edges between adjoining elements, in the model it is only required to evaluate velocities jump on interfaces in the local coordinate system se−re−qe.From (1)–(3), by differentiation of the edge curve it is possible to obtain unitary vectors se−re−qein the global coordinate system:(5)re=-n1×n2=-(∂P/∂t)/∂P/∂t×(∂P/∂p)/∂P/∂pse=dP(t)dtdP(t)dtqe=se×reat each point P(t) belonging to the edgeΓ12e. It is interesting to notice that it usually occurs that for a common edge between two elements, say M and N, the evaluation of reusing natural coordinates of M is slightly different from reevaluated in N. This is obviously a consequence of the approximation of the same surface with two different quadratic functions. In all these cases, the average of the two results is assumed for re.From (5), trivial algebra allows to determine the rotation matrixT(t)which permits transformation from the global coordinate system to the local one:(6)seqere=T(t)e1e2e3=T(t)I3×3where I3×3 is the 3D identity matrix.On the other hand, for a generic point P onΓ12e, local abscissa se(from P1) is determined by means of:(7)se(t)=∫0tdse=∫0t(dx/dt)2+(dy/dt)2+(dz/dt)2dtCoordinates of element centroid (i.e.xG=1Ω∫ΩxdΩ,yG=1Ω∫ΩydΩ,zG=1Ω∫ΩzdΩ) are evaluated by means of numerically tackled surface integrals, taking into account thatdΩ=∂P/∂t×∂P/∂pdpdt.Velocity field interpolation inside each element depends only on 6 independent variables representing centroid velocitiesuG=uxGuyGuzGTand rigid rotation ratesΦG=ΦxxGΦyyGΦzzGTalong coordinate axes.Therefore, velocity field of a generic point P onΓ12eedge is expressed in the global frame of reference as:(8)ux(t)uy(t)uz(t)=uxGuyGuzG+0-ΦyyGΦzzGΦyyG0-ΦxxG-ΦzzGΦxxG0x(t)-xGy(t)-yGz(t)-zG=UG+ΦG(P-G)=UG+ΦGAx0+Ax1t+Ax2t2-GxAy0+Ay1t+Ay2t2-GyAz0+Az1t+Az2t2-GzUsing instead of the skew matrixΦGthe vectorΦG, Eq. (8) may be re-written as follows in a much more compact notation:(9)ux(t)uy(t)uz(t)=UG+0-(y(t)-yG)+(z(t)-zG)-(z(t)-zG)+(x(t)-xG)0+(y(t)-yG)0-(x(t)-xG)Φ∼G=UG+S(t)Φ∼G=I3×3O3×3O3×3S(t)UGΦ∼G=S′(t)U∼GwhereI3×3andO3×3are a 3×3 identity matrix and a 3×3 matrix of all zeros respectively andU∼Gis the vector of kinematic unknowns of the element collecting centroid velocities and rotation rates.S′(t)is a block matrix where the sparse matrix technology is used to speed up computations.In order to evaluate internal power dissipated at the interfaces by means ofShom, the adopted failure surface (eventually derived from homogenization), the jump in velocity vector[uM-N]=[Δ̇qΔ̇sΔϑ̇nnΔϑ̇ntΔ̇r] for each point of the interface has to be evaluated as a function of elements centroids velocities and rotation rates.Δ̇qandΔ̇srepresent the in-plane normal and tangential velocity jumps,Δϑ̇nnandΔϑ̇ntare the flexion and torsion rotation rates jumps, whereasΔ̇ris the out-of-plane tangential velocity jump (see Fig. 3).By means of (6) and (8), jump in velocities field between elements M and N in the local coordinate system(Δ̇qΔ̇sΔ̇r̃)can be written as follows:(10)Δ̇s(se)Δ̇q(se)Δ̇r̃(se)=TM(t)-1S′M(t)U∼GM-TN(t)-1S′N(t)U∼GNwhereΔ̇r̃(se)is the total out-of-plane jump in velocities, containing contributions ofΔ̇r(se)andΔϑ̇nt. Through Eq. (7), it turns out thatΔ̇qΔ̇sandΔ̇r̃depend on t through the composition of non-linear functions.Δϑ̇nnandΔϑ̇ntcan be evaluated with the deformation scheme of Fig. 3, considering the single contributionsΔϑ̇nnEandΔϑ̇ntEof each element E to flexural and torque rotations respectively:(11)Δϑ̇nnE=ΦxxEe1+ΦyyEe2+ΦzzEe3·seΔϑ̇ntE=ΦxxEe1+ΦyyEe2+ΦzzEe3·qeEq. (11) may be re-written in more compact notation as:(12)Δϑ̇nnEΔϑ̇ntE=seT(se)qeT(se)e1Te2Te3TΦxxEΦyyEΦzzE=100010[se(se)qe(se)te(se)]TI3×3Φ∼E=I2×3TE(t)TI3×3Φ∼E=O3×3O2×3O2×3I2×3TE(t)TI3×3U∼G=T′E(t)U∼GEFrom Eqs. (11) and (10), for a generic point with abscissa seit yields:(13)Δ̇r(se)=Δ̇r̃(se)-Δϑ̇ntL122-sewhere L12 is the interface length.Assuming to evaluate the out-of-plane sliding inse=L122, thenΔ̇r(se)=Δ̇r̃(se).Condensing Eqs. (10), (11) and (13), one obtains the following expressions for the jump of velocities/rotation rates in compact form:(14)[uM-N]=Δ̇s(se)Δ̇q(se)Δ̇r(se)Δϑ̇nnΔϑ̇nt=TM(t)-1S′M(t)U∼GM-TN(t)-1S′N(t)U∼GNT′M(t)U∼GM-T′N(t)U∼GN=FM(t)U∼GM-FN(t)U∼GNHaving assumedFM(t)=TM(t)-1S′M(t)T′M(t).Finally, it is worth noting that, in the model, both an out-of-plane sliding at the interfaces between contiguous triangular elements and torsional failure are possible (see Fig. 3). As a consequence, both thin and relatively thick shells may be modelled quite accurately (Reissner–Mindlin hypotheses).In the framework of associated plasticity, the plastic flow has to remain always perpendicular to the yield surface.We introduce for each interface I between contiguous elements N and M with common edgeΓije, macroscopic specific actions collected in the vector tI(Fig. 4) defined astIT=TssINqqITrrIMnnIMntI, constituted by membrane actions along local axis qeNqqIand local axis seTssI, bending momentMnnI, torsionMntIand out-of-plane shearTrrI.Considering the same previous of length L12, we suppose to have at disposal the homogenized (linearized) strength domain constituted by mIplanes in the local coordinate system (a generic linearization plane qIhas equationAqqqINqqI+AssqITssI+BnnqIMnnI+BntqIMntI+ArrqITrrI=CIqI, with 1⩽qI⩽mI). Such a linearization for each interface (and, in principle, for each point of the interface) can be obtained from a homogenized failure criterion, found for instance following the procedure envisaged in [30] and exploiting the procedure recommended by Krabbenhoft et al. [57], and the reader is referred there for further details.In this context, considering that Eq. (14) furnishing the velocity jump as a function of variables belonging to elements M and N, plastic flow relationship may be written as:(15)[uM-N(t)]=FM(t)U∼GM-FN(t)U∼GN=∑i=1mIλ̇i(t)AssiAqqiAttiBnniBntiT=∑i=1mIλ̇i(t)A∼iSet of Eq. (15) is checked on interface nodes (i.e. 1, 2 and 4).Power dissipated at the interface is evaluated, considering the associated plastic flow relationship (15), by standard numerical integration as follows:(16)PI=∫0L12tIT(t)[uM-N(t)]dse=∫0L12∑i=1mIλ̇i(t)tIT(t)A∼idse=∫0L12∑i=1mIλ̇i(t)CIidseObviously, fieldsλ̇iassume the same analytical expression found for the velocity field, i.e. they are quadratic in t, see Eqs. (3) and (8). Therefore,λ̇iare fully determined introducing only three sets of plastic multipliers for each internal interface and for each linearization plane, corresponding to nodes 1, 4, 2.On the other hand, the numerical evaluation of (16) may be done as follows:(17)PI=∑imIW1λ̇iI,1+W4λ̇iI,4+W2λ̇iI,2CIqIwhere W1, W2 and W4 are easily evaluated numerically. It is worth noting that rigorous upper bounds are obtained only in presence of (a) straight interfaces or (b) interfaces lying on a plane but with quadratic shape. In all the other cases, only a second order approximation of the actual plastic multipliers field is obtained, that means that the generic curved shell is approximated with a second degree surfaces patch. Such a choice seems reasonable for all the numerical analyses performed at a structural level in the present paper.External power expended both by loads dependent and not dependent on load multiplier isPex=P0T+λP1TU∼, whereP0is the vector of permanent loads,λis the load multiplier for the structure examined,P1Tis the vector of variable loads andU∼is the vector of assembled centroid elements velocities and rotation rates. As the amplitude of the failure mechanism is arbitrary, a further normalization conditionP1TU∼=1is usually introduced. Hence, the external power becomes linear inU∼andλ.The linear programming problem obtained by means of the upper bound discretization previously discussed is classic and allows to obtain an estimation of the collapse load by means of the constrained minimization of the objective function, represented by the total internal power dissipated minus the power expended by external loads not dependent on the load multiplier:(18)minPIin,assλ̇I,assT-P0TU∼such thatAeqU∼=beqλ̇I,ass⩾0where–U∼is the vector of global unknowns and collects the vector of elements centroids velocities and rotation ratesU∼GEand the vector of assembled interface plastic multiplier ratesλ̇I,ass.Aeqis the overall constraints matrix and collects normalization conditions, velocity boundary conditions and constraints for plastic flow in velocity discontinuities, i.e. Eq. (15).PIin,asscollects the coefficientsWiCIqIof Eq. (17) of all the nIinterfaces.Linear programming (18) is solved by means of a robust interior point algorithm and sparse matrix technology, which allows to handle several optimization variables and is capable of reaching a converged solution with a very limited computational effort.When a mesh adaptation strategy is adopted, nodes coordinates must move and therefore they enter into the optimization problem. To deal with the adaptation of the mesh, a two-step approach is needed. In the first step, nodes position is considered fixed and a solution in terms of velocities field and collapse multiplier is found. In the second step, velocities field is assumed a priori known, and the position of the nodes with the collapse multiplier are considered as optimization variables.The aim is of reproducing real failure mechanisms as closest as possible with the numerical approach proposed, even with relatively coarse discretizations and rigid elements. If variation in an element geometry is considered, equality constraint (15) and internal power dissipation (17) become non linear.Constraints may be however linearized with a first order Taylor expansion on the origin. In this context, the adopted technique may be regarded as belonging to the well known family of Sequential Linear Programming (SLP), which is no more than an iterative process in which linearized approximations are used in any particular iteration [51–53]. It is worth mentioning that SLP schemes have been adopted by many authors in the recent past for the limit analysis of slabs, see for instance Johnson [51,53] and Ramsay and Johnson [52] making use of triangular linear elements and by the Author for in-plane problems with rigid elements [50]. While triangular elements with linear edges are adequate for out-of-plane problems as shown in [51–53], such an approach may give an overestimation of the actual collapse loads in the case of coupled problems or when slip lines are generally non linear, as the case here treated. In addition, double curvature structures require much more attention in the meshing process with a few elements, also because a satisfactory fitting of the actual geometry is crucial for the exact evaluation of the power expended by dead loads (which are very important especially for quasi no-tension materials as the case of masonry). The utilization of quadratic elements appears therefore very suitable for the problem at hand.In order to use a sequential linear programming scheme, nodes coordinates of each interface must be assumed as optimization variables. Each non linear inequality and/or equality constraint may be linearised by replacing each term by its first-order Taylor series approximation. This essentially involves the equations representing the plastic flow in discontinuities and power dissipation. Due to the complexity of the equations involved, a numerical procedure is utilized for the evaluation of the gradient of the non-linear functions.When dealing with plastic flow relationship, for an interface between elements M and N, the following set of equations is obtained from (15):(19)FM(X)U∼GM-FN(X)U∼GN-∑i=1mIλ̇i(X)A∼i=O5×1where X is the position of the nodes of elements M and N and O5×1 is a 5×1 vector of all zeros.A numerical first order Taylor expansion is performed on (19) in order to obtain a linearization as follows:(20)FM(Xk)U∼GM-FN(Xk)U∼GN-∑i=1mIλ̇iA∼i+∇FM(Xk)U∼GM-∇FN(Xk)U∼GN(Xk+1-Xk)=O5×1where–Indices k+1 and k represent the unknown and known position of the nodes in the optimization process respectively.∇ is the gradient operator, which is performed numerically by means of a standard finite differences approach, due to the complexity of the equations at hand.Xk+1and Xkcollect nodes positions in the k+1-th and k-th iteration.It is interesting to notice that the independent variables entering into X vector are only nodes coordinates on x–y plane, since z coordinate of each node is constrained to move along the vaults surface of equation z=f(x, y).Analogously to plastic flow constraints, a linearization of Eq. (17) can be written as follows:(21)PI=∑imIW1(Xk)λ̇iI,1+W4(Xk)λ̇iI,4+W2(Xk)λ̇iI,2CIqI+∑imI∇W1(Xk)λ̇iI,1+∇W4(Xk)λ̇iI,4+∇W2(Xk)λ̇iI,2CIqI(Xk+1-Xk)where ∇Wi, similarly to the previous case, are evaluated numerically.Eqs. (20) and (21) replace classic linear programming constraints and the linear programming solution is repeated until a desired adjustment of the initial mesh is reached. At the conclusion of each linear programming iteration, the nodes coordinate values xNand yNwill indicate directly the mesh adaptation.Obviously, the magnitude of the changes to the geometric variables cannot be obtained from a linear solution and must be enforced by the imposition of suitable inequality bounds. The geometric variables will need to be constrained by lower and upper bounds as follows:(22)x-≤xiN≤x+y-≤yiN≤y+where–x−, y−, x+, y+ are respectively lower and bound vectors for x and y nodes coordinates;xiNandyiNare horizontal and vertical vectors of nodes coordinates at the i-th iteration.For particular nodes, e.g. nodes belonging to the boundary or nodes under external loads, having coordinates equal to, say,xFNandyFN, it is required that their position is not altered. This implies that, e.g.xFN=xF0andyFN=yF0, which results in further linear equality constraints to add into the linear programming problem.Finally, since failure load of the linearized linear programming problem does not necessarily represent a rigorous upper bound of the true collapse load, a post-processing linear programming problem with the new positions of nodes obtained from the i-th iteration kept fixed has to be performed. The pseudo-code of the SLP algorithm used for all the examples treated is shown in Fig. 5.Condensation of nodes with re-meshing is usually not needed if the adjustment of the mesh is small. In some particular cases, however, it may happen that, passing from one iteration to the successive, topological errors (i.e. overlapping of existing elements) occur. In such cases, at the end of each iteration, a quite straightforward strategy is adopted to check overlapping of elements.The strategy is much more efficient than that applied in [50] and it is applied here for the first time. The six-noded element is firstly projected to the x–y plane and subsequently subdivided into four three noded triangles, as in Fig. 6. Then, for each sub-triangle, vectors v1 and v2 are evaluated simply as difference between the nodal coordinates. Then the cross product v1×v2 is performed, which obviously has only z component different to zero and its module measures twice the area of the triangle. If the z-components of all the four vectors are positive numbers in the updated structure, no topological errors occurred. If at least one negative value is experienced, the nodes responsible are re-allocated in the previous correct position and the element topology error is fixed.The numerical performance of the adaptive upper bound formulation presented is assessed by using it to predict the collapse load of a number of technically meaningful examples. In particular, the model is first tested on a circular arch with a very coarse mesh, where interfaces intentionally do not coincide with the actual position of the hinges. In this case, an alternative upper bound limit analysis software relying into three curved rigid blocks interconnected by internal geometrical hinges is utilized to assess the results obtained with the approach proposed. The positions of the two internal hinges are assumed as unknowns and a Genetic Algorithm procedure is utilized to find their actual position. The procedure is validated with Ring software, see [58].The second example is a skew parabolic arch experimentally tested by Vermeltfoort in [20] and numerically analyzed both by means of limit and non-linear analyses in [30,26] respectively.The failure mechanism is constituted by a rather complex pattern of hinges with curved shape and dissipating both for flexural and torque actions. It appears therefore a quite interesting benchmark to test the capabilities of the procedure proposed in presence of very coarse meshes and complex failure mechanisms.The third example is a ribbed cross vault experimentally tested by Foraboschi in [21,22] up to collapse with an increasing eccentric concentrated vertical load and again numerically tested with regular quite refined meshes in [30,26]. The results of the analyses address that the mesh adaptation occurs exclusively near the point of application of the load, i.e. in correspondence of the active failure mechanism.The last example is a hemispherical dome, again tested up to collapse in [21,22] and numerically re-considered in [30,26]. The failure mechanism is constituted by a flexural annular hinge positioned on the upper part and by in-plane meridian cracks. The crucial issue when determining the correct failure mechanism and, consequently, to provide a reliable estimation of the failure load, is the identification of the exact position of the annular flexural hinge.From the results of the numerical simulations reported, it is possible to conclude that the adaptive SLP scheme allows approximating rather well the actual failure behavior of the structure, in terms of both collapse load and failure mechanism, meaning that the approach proposed is able to provide accurate upper bounds.The first example is a benchmark on a 2D problem relying into the prediction of the exact position of the hinges of a circular arch subjected to an eccentric distributed load, see Fig. 7. The material under consideration is unable to withstand tensile stresses and the failure domain of the interfaces is written in terms of flexural bending moment and in plane compression acting perpendicularly to the interface direction. Intentionally, a few elements are utilized to mesh the structure, in order to constrain the hinges to be placed in the wrong position. The arch has circular shape, with a span equal to 5m, a rise equal to 800mm and a width equal to 1m. Arch thickness is assumed equal to 200mm and masonry self-weight equal to 2000kg/m3. A distributed load depending on the load multiplier having a width equal to 1.5m is placed eccentrically, starting from the left side abutment. As commonly accepted when dealing with the analysis at collapse of masonry arches, the materials is assumed unable to withstand tensile stresses (no tension material assumption).The arch fails for the formation of a four hinges mechanism, with two hinges placed in correspondence of the abutments and the remain two hinges positioned at a distance equal to 1200 and 3250mm from the left abutment.The very coarse mesh shown in Fig. 7 is used for the analyses, intentionally constituted by 6 curved elements only, with position of the internal plastic hinges at 1/3 of the span from the left and right respectively.An alternative 1D procedure with rigid blocks is also utilized to assess the proposed numerical model. The 1D approach is the object of a wide numerical validation presented elsewhere [59]. Here only the main features of the procedure are summarized and the reader is referred in [59] for further details. In the numerical approach, a GA algorithm is used to optimize the position of the hinges forming the failure mechanism. In the mechanism with position of the plastic hinges frozen, each portion of the arch between two contiguous hinges is treated as rigid block, so that each rigid block is characterized by three kinematic variables, two velocities of the centroid and a rotation rate around the centroid. In total, nine kinematic variables are present in the model, which can be reduced to one single variable imposing that the mutual displacement of two contiguous rigid-blocks in correspondence of the point in compression belonging to each hinge is zero. The only independent kinematic variable remaining after the application of the aforementioned equality constraints is the Lagrangian parameter of the limit analysis problem. In the framework of the kinematic theorem of limit analysis, the procedure furnishes an upper bound estimation of the actual collapse load, depending on the position of the plastic hinges selected, i.e. depending on the failure mechanism. The collapse multiplier is simply obtained equating to zero the total power expended by external forces (masonry self-weight and loads depending on the load multiplier). It is worth noting that internal power dissipation on hinges is equal to zero, being the material unable to withstand tensile stresses.The optimization of the position of the plastic hinges is obtained iteratively by means of a non-standard GA approach already presented in [59] by the author in another context, where independent variables are only two in this case (horizontal position of the internal plastic hinges) and the fitness function is the collapse multiplier. Thanks to the limited computational effort required, a very small population of 10 individuals is adopted (indeed a so called micro-GA procedure is proposed). For the problem at hand, best fitness function from a typical GA run is depicted in Fig. 8, where it can be observed that a converged solution is obtained after 10–15 iterations in this case. The position of the hinges at the converged solution as well as the failure mechanism are perfectly in agreement with those found with the software Ring [58].The convergence plot of the collapse load to the actual solution at successive iterations obtained with the SLP procedure proposed is shown in Fig. 9, whereas in Fig. 10the failure mechanisms obtained at the last iteration are compared (a: Ring software, b: 1D GA approach, c: 2D SLP approach). It is interesting to notice from Fig. 9 that an incorrect evaluation of the position of the plastic hinges results in this case into an overestimation of the collapse load equal to 51%. In the GA approach several individuals exhibit very high limit multipliers because associated to totally wrong mechanisms, see Fig. 8.The SLP procedure here proposed allows to use very coarse meshes and very few iterations (around 4-6) are needed to converge to the optimal solution, with a computational effort very limited, thanks to the extremely reduced number of elements required.A skew parabolic arch is analyzed as second example. The arch has span of 3m, a width of 1.25m, and a rise of 500mm, see Fig. 11. The arch is a one-head brick structure with depth equal to 100mm. The arch was experimentally tested by Vermeltfoort in [20] and numerically analyzed both by means of limit and non-linear analyses in [30,26] respectively. Vermeltfoort in [20] studied the behavior up to collapse of two typologies of parabolic arches, one straight, not considered here for the sake of conciseness, where the utilization of 1D models is possible and recommended, the other in a so-called “skew” disposition of the supports (i.e. supports are offset perpendicularly to arch axis of 1.25m). The offset makes the behavior strongly tri-dimensional, thus precluding an analysis with mono-dimensional models.Its analysis by means of the SLP code proposed is therefore particularly intriguing because the experimental failure mechanism is constituted by a rather complex system of yield lines exhibiting curved shape and with internal power dissipation due both to flexural and torque actions.Mechanical properties assumed for joints and bricks are reported in Table 1. The homogenization limit analysis approach proposed in [28] is used to deduce in- and out-of-plane homogenized failure surfaces, which are depicted for the case at hand in Fig. 12.Homogenization combined with limit analysis is a relatively simple strategy that allows estimating masonry strength domain under different load conditions, knowing only mechanical properties at failure of the constituent materials. Such procedure has the advantage that there is no need to mesh separately bricks and mortar at a structural level. Since the objective of the present paper is the description of a mesh adaptation strategy, the reader is referred to [60,61] for a comprehensive description of the homogenization problem in the rigid plastic case, with application to real masonry structures.A elementary cell in running bond with bricks of dimensions equal to 200×100×52mm3 (Rijswaard soft mud bricks) and with joints thickness equal to 12mm is considered. In the model presented in [28], blocks are meshed with six-noded rigid infinitely resistant wedge elements, whereas joints are reduced to interfaces with a frictional behavior. Possible dissipation inside bricks is possible at the interface between contiguous elements. In particular, for joints, a Mohr–Coulomb failure criterion with tension cutoff and linearized cap in compression is adopted, whereas for bricks a Rankine failure criterion in compression is imposed. Full details of the limit analysis model at the meso scale are provided in [28], where the reader is referred for further details.No experimental force–displacement curves are at disposal for the example at hand. From Vermeltfoort [20], only the experimental collapse load (around 26kN) is available.Non linear heterogeneous analyses have been also performed in [29] by means of the commercial code DIANA, with a predicted collapse load approximately equal to 27kN, in very good agreement with both experimental data and limit analysis predictions discussed in [30].When the mechanical properties reported in Table 1 are adopted, a numerical collapse load of 34kN is obtained in [30], in acceptable agreement (when an associated limit analysis approach is adopted) with experimental evidences.The very coarse meshes of Fig. 11 are utilized to perform the numerical analyses. As can be noted, both are quite coarse, especially the first being extremely unrefined. Nodes under the four lines of application of the external loads are constrained not to move during the optimization process, and also it is imposed to use meshes with at least two elements between two contiguous lines.In Fig. 13, the upper bound convergence of the collapse loads obtained with both meshes at successive iterations is shown. An indication of experimental collapse load, non linear FE analysis and homogenized limit analysis estimations (reported in [29,30]) of the failure force is also provided. It is interesting to notice that the estimation of the collapse load at the converged (last) iteration in both cases is closer to experimental collapse load and non-linear FEM prediction, due to the more accurate determination of the actual failure mechanism active.Deformed shapes at collapse obtained at the first and last iteration with both meshes are depicted in Fig. 14(coarse mesh) and Fig. 15(medium refined mesh). As it is possible to note, internal dissipation is concentrated not only under the line of application of the external load, but also along two diagonal paths with curved shape, thus demonstrating that failure occurs as a consequence of the limited torsional strength of the arch.It is particularly evident that some of the yield lines active exhibit a curved shape, which cannot be reproduced with a mesh constituted by rigid elements without mesh adaptation, as proposed in [30]. The existence of curved yield lines fully justifies the utilization of the SLP approach proposed and shows that it is possible, even with very few elements, to obtain results more reliable than those provided by standard FEs with dissipation allowed at the interfaces only and very refined discretizations.A ribbed cross vault, experimentally tested by Faccio et al. [21], formed by the intersection of two barrel vaults with an external radius of 2.3m, is considered as third example, see Fig. 16.Common Italian bricks of dimensions 120×250×55mm3 were used, with joints thickness equal to 12mm. Mechanical properties assumed for joints and bricks are reported in Table 2. As in the previous case, for joints a Lourenço–Rots failure criterion is assumed, whereas for bricks a Rankine failure criterion in compression is imposed. Data not available from experimentation have been chosen from typical values from the literature, whereas the remaining coefficients adopted are taken in agreement with Creazza et al. [18,19]. The corresponding masonry homogenized failure surface is reported in Fig. 17, and has been obtained by means of the homogenization technique utilized in the previous sub-section and presented for the first time in [28]. Furthermore, in Fig. 16 the geometry and the loading condition of the ribbed cross vault are reported.Two different very coarse meshes are utilized for the analyses, as indicated in Fig. 16, and labeled as mesh 3×3 and mesh 4×4, being the name referred to the size of the regular grid used to discretized one fourth of the structure.Due to the presence of different thicknesses (arches and vault), some nodes and the mesh are constrained to pass through the interface between ribbed arches and vault.Similarly to the previous case, reasonable estimates of the collapse loads by means of sophisticated non-linear macroscopic approaches [18,19], a heterogeneous procedure within DIANA commercial software [29] and limit analysis predictions with very refined discretizations [30] are available for comparison.In addition, in order to show that the computational efficiency of the present approach competes favorably with classic remeshing, the cross vault is also analyzed trying to improve the quality of the predicted failure multiplier by means of classic automatic mesh refinement. In the framework of a discretization with rigid elements, as already mentioned, the most suitable refinement criterion seems represented by the amount of plastic dissipation on interfaces, whereas remeshing is obtained subdividing each of the two elements sharing an interface exhibiting large dissipation into three triangles having one common vertex on the centroid.In Fig. 18the deformed shapes (under different points of view) of the cross vault after several remeshing iterations are depicted, with an indication of the number of elements present in each mesh. Correctly, refinement occurs under the point of application of the load and in any case in correspondence of the active failure mechanism. However, mesh distortion is rather evident, especially for the more refined discretization, with the formation of a fuzzy collapse mechanism.In Fig. 19, the convergence to the actual failure load for both SLP and remeshing is depicted at successive iterations. As can be noted, the convergence is very quick and occurs after a few iterations. The final estimate of the collapse load is very near to both the experimental one and those obtained with alternative procedures requiring much more finite elements.It is interesting to notice that the procedure based on remeshing, in particular, provides at convergence a collapse load very similar to that found with the present mesh adaptation scheme, roughly requiring the same number of iterations. However, being at the last iteration the number of elements much larger in remeshing, it can be easily deduced that the time needed to achieve convergence is huge, thus implicitly demonstrating the computational advantage of the proposed approach.Finally, observing the deformed shapes at failure obtained at the first and last iterations, depicted respectively in Figs. 20 and 21for meshes 3×3 and 4×4, it is particularly evident the adaptation of the mesh provided by the SLP procedure proposed. Curved yield lines are present near the application of the external load. A flexural behavior of the ribbed arch near the external load is quite evident, with the formation of at least three flexural hinges in symmetric position. Out-of-plane sliding is also present in this zone but yield lines with a rather marked curved shape spread from the top to the two abutments of the ribbed arch involved by the failure mechanism.It is finally interesting to underline that the results of the analyses show that the mesh adaptation occurs near the external load, i.e. exclusively in correspondence of the active failure mechanism.The fourth analysis relies into the limit analysis of a hemispherical dome with an inner radius of 2.2m and thickness of 12cm, experimentally tested by Foraboschi [21,22].In Fig. 22, the geometry and the loading condition are reported, along with the initial meshes used for the adaptive limit analysis.Common Italian bricks of dimensions 120×250×55mm3 were used, with joints thickness equal to 12mm. Mechanical properties assumed for joints and bricks are summarized in Table 3. Using the same homogenization procedure adopted for the examples of the previous sections, homogenized in- and out-of-plane failure surfaces depicted in Fig. 23are obtained and utilized at a structural level.In Fig. 24, the convergence to the actual failure load experienced both experimentally and reproduced numerically with a number of different sophisticated strategies is depicted.Again, the performance of the SLP procedure is worth noting, which appears capable of reaching a quite satisfactory solution in terms of collapse loads in a very few iterations. Also in this case, apart the experimental failure load, results obtained by means of a limit analysis conducted with very refined meshes and with plastic dissipation allowed at the interfaces only [30,29] and by means of non-linear approaches with damage [26,19] are available for comparison purposes.Finally, in Figs. 25 and 26, the failure mechanisms obtained at the first and last iteration are shown for a very coarse and a more refined mesh respectively. As it is possible to notice, collapse occurs for the formation of a hinge along the parallel located in an intermediate position, near the upper part of the structure. Meridian cracks are also present in the lower part – as it always occurs for no tension material cupolas subjected to self-weight – as a consequence of the presence of positive membrane stresses acting along meridians and the very low tensile strength of masonry. The crucial issue to obtain reliable estimations of the collapse loads with rigid infinitely resistant elements is thus the identification of the exact position of the annular flexural hinge.From a comparison between the position of the nodes of the mesh in the initial and final configuration, it is possible to notice that the SLP scheme tends to move all nodes belonging to a parallel symmetrically along meridians, thus approximating at the last iteration rather well the actual position of the flexural hinge. Such adaptation allows a consistent reduction of the collapse load found, with a quite reliable approximation of the actual failure mechanism, when compared with alternative strategies, see Fig. 24.

@&#CONCLUSIONS@&#
A discontinuous upper bound limit analysis model with Sequential Linear Programming mesh adaptation (SLP) has been presented. In the model, rigid, infinitely strong triangular elements with quadratic interpolation of the middle surface have been used. A possible jump of velocities is allowed at the interfaces between contiguous elements, thus constraining plastic dissipation only at the interfaces. Curved elements have been used with the sole aim of improving the element performance when dealing with limit analysis problems involving curved sliding surfaces. Since the model performs poorly for unstructured meshes (typically at the initial iteration), an iterative mesh adaptation scheme based on the linearization of equality constraints (SLP) has been performed.Several applications have been analyzed, consisting in the determination of failure loads for a circular arch, a skew parabolic arch, a ribbed cross vault and a hemispherical dome.Comparisons with predictions obtained in existing literature by means of very refined meshes show that reliable results may be obtained with very coarse meshes simply adapting the mesh. In order to evaluate the numerical performance of the method, a synopsis of CPU times required to obtain a converged solution and corresponding limit loads for all the examples analyzed are summarized in Table 4. As it is possible to notice (also comparing present CPU times with data collected from the literature), the procedure proposed requires CPU times much less expensive than those required by standard very refined discretizations without mesh adaptation. From an overall analysis of simulations results, it can be affirmed that the SLP approach proposed has several important advantages as for instance: (a) the simplicity of the algorithm, which focuses exclusively on geometrical issues, (b) the robustness of the iterative approach, which requires only the recursive utilization of LP packages with few variables (usually available for free in the market) and (c) the very limited computational effort require for the optimization of real scale examples, strictly related to the utilization of curved elements (i.e. able to reproduce, in principle, complex curved failure mechanisms) with dissipation allowed only at the interfaces between contiguous elements.Considering the advantages and limitations of both the present node adaptation scheme and remeshing, it is under study by the author an integrated algorithm combining in the same step a preliminary adjustment of nodes position, followed by a refinement of the mesh only where needed. After a preliminary validation, the convergence rate appears much higher than those exhibited by the two aforementioned approaches considered separately, thus allowing an effective mitigation of the negative effects induced by remeshing, i.e. the heavy computational effort experienced even for coarse meshes after few iterations.