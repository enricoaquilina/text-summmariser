@&#MAIN-TITLE@&#
Cooperation and game-theoretic cost allocation in stochastic inventory models with continuous review

@&#HIGHLIGHTS@&#
We model two companies that continuously review inventories and face Poisson demand.Two cooperation strategies for joint replenishment are studied.Replenish when a company reaches its reorder level, has the lowest cost, numerically.The Shapley value and the distribution rule are stable cost allocations.These results also hold for three companies.

@&#KEYPHRASES@&#
Joint replenishment,Stochastic demand,Cost allocation,Continuous review,Game theory,Inventory model,

@&#ABSTRACT@&#
We study cooperation strategies for companies that continuously review their inventories and face Poisson demand. Our main goal is to analyze stable cost allocations of the joint costs. These are such that any group of companies has lower costs than the individual companies. If such allocations exist they provide an incentive for the companies to cooperate.We consider two natural cooperation strategies: (i) the companies jointly place an order for replenishment if their joint inventory position reaches a certain reorder level, and (ii) the companies reorder as soon as one of them reaches its reorder level. Numerical experiments for two companies show that the second strategy has the lowest joint costs. Under this strategy, the game-theoretical Shapley value and the distribution rule—a cost allocation in which the companies share the procurement cost and each pays its own holding cost—are shown to be stable cost allocations. These results also hold for situations with three companies.

@&#INTRODUCTION@&#
Several companies or business units may have the same item on stock to meet the demands of their customers. Instead of working on their own, the companies may jointly place an order for replenishment of their stocks and save on procurement costs. Consider, for example, the inventory of band-aids in a hospital with several departments. Each department has its own warehouse where it stocks the band-aids. There is central purchasing of replenishments, as is common practice in many Dutch hospitals. The ordered goods arrive in the central warehouse, from which they are distributed to the departments. A major concern is how to organize the central purchasing. Hospital management has several options. First, they could base the purchase decision on the joint inventory of band-aids in all departments. If this joint inventory falls below a certain threshold, a replenishment order for all departments is placed. Second, they could base it on the individual stocks of the departments; if one department runs out of stock, a replenishment order for all departments is placed. Finally, one could decide to allow decentralized replenishment of stock by the individual departments.The main questions in such joint replenishment problems are how much to order, when to order and how much money can be saved. The distribution of these cost savings or of the joint costs among the companies is also of importance. If a company believes it pays too much of the costs, then it may not be willing to cooperate in the first place. Therefore, our main goal is to study allocations of the costs.This paper studies joint replenishments for multiple companies that continuously review their inventories and face Poisson demand. We consider two natural cooperation strategies. Under the sum constraint strategy the companies jointly place an order for replenishment if their joint inventory position reaches a certain reorder level. Under the individual constraints strategy the companies reorder as soon as one of them reaches its reorder level. We compare the resulting expected costs of these strategies with the costs of non-cooperation. Numerical experiments show that the individual constraints strategy is better, that is, it has the lowest joint costs. Hence, this strategy saves costs compared to non-cooperation. Now, a natural question that arises is how to allocate the saved costs among the companies.Cooperative game theory is a very suitable tool for studying cost allocations. A natural requirement for such allocations is that they are stable. Stability means that the cost is allocated to the companies such that any group of companies pays at most its own cost; the group has no incentive to disagree with the cost allocation. This requirement is represented by the core—a stability concept from cooperative game theory. The core is the set of all stable cost allocations. Often, there are many stable allocations. Then the companies should select one of these. Under the individual constraints strategy, we study existence of stable cost allocations in our model.Two specific cost allocations are the Shapley value (Shapley, 1953), and the distribution rule (Meca et al., 2004). The Shapley value is a cost allocation that distributes marginal contributions to the costs equally among the companies. The distribution rule consists of two parts: (i) the joint procurement costs are allocated in a proportional way to the companies, and (ii) each company pays its individual inventory holding costs under cooperation. Our numerical experiments show that both these cost allocations are stable for the joint replenishment problem with continuous review and Poisson demand under the individual constraints strategy.There is a large literature on joint replenishment problems. The papers by Arshinder and Deshmukh (2008) and Khouja and Goyal (2008) are excellent surveys on this research subject. Initiated by Balintfy (1964) and Silver (1965), nowadays complex stochastic inventory control problems are studied. Since it is very difficult to determine the optimal policies of these problems, the main focus is on studying the performance of certain classes of replenishment policies. Federgruen et al. (1984) provides an efficient heuristic algorithm to search for an optimal can-order policy in case the companies face compound stochastic demand. Viswanathan (1997) and Chiou et al. (2007) study classes of replenishment policies that lead to low joint costs. More recent, Tanrikulu et al. (2010) introduce a new policy for stochastic joint replenishment problems under continuous review. This policy performs well in case of large backup and order costs. Kiesmüller (2010) considers inventory control when full truckloads are required. Two policies are compared, one depends on the aggregate inventory position, and the other on the individual inventory positions of the items. Most of these papers focus on showing that a certain class of policies leads to lower costs than other well-known policies. However, none of these papers study the allocation of the joint costs to the companies.There are a few papers that analyse cost allocations for joint replenishment problems by means of cooperative game theory. Hartman and Dror (1996) study allocations of joint costs in inventory models under continuous review. A central warehouse is set up to store the goods and to meet the demand of the customers. In the case of three companies the authors show that there exists a cost allocation that is stable, justifiable (the allocated cost is in line with the cost savings) and computable in polynomial time. More general, Dror et al. (2012) study the computation of stable cost allocations in joint replenishment problems, and the sensitivity of stable cost allocations to the cost parameter values. A review on general game theoretical applications in supply chain management may be found in Leng and Parlar (2005).In Meca et al. (2004) cooperation in an inventory system with stationary deterministic demand is studied. The companies face procurement and holding costs. Further, the authors introduce the distribution rule, which is a cost allocation designed for joint replenishment problems. The authors show that this cost allocation is stable. In this paper, we extend their model to inventory situations with stochastic (Poisson) demand and integer order quantities, and show that their result also holds for our model. Also related is Chessa (2009), which contains an initial study on our model with some other types of cost allocations.The outline of this paper is as follows. In Section 2 we introduce our model. Section 3 analyses the costs of non-cooperating companies. Joint replenishment is studied in Section 4, where we consider two natural cooperation strategies. We compare their costs with the cost of non-cooperation. Section 5 studies cost allocations. Finally, Section 6 concludes. All proofs are in Appendix A.We consider the inventory control problem of a single product for multiple companies under continuous review. Our model is an extension of the model of Meca et al. (2004) to Poisson demand. Let N denote the set of companies; we will mainly consider situations with two companies, N={1,2}. The demand for the product at the different companies occurs in discrete units, and the demand processes are independent Poisson processes with rate λifor company i, i∈N.To meet their demands the companies place orders for replenishment of their stocks. We assume that the lead time of an order is zero time units and that backorders are not allowed. The replenishment policy for company i is to place an order for Qiitems when its inventory position falls below riitems. Hence, such a policy is defined by the reorder level riand the order quantity Qi. The state of company i is determined by the inventory positionZitat time t, and let Zidenote the steady state random variable.To evaluate the benefits of cooperation, let us specify the cost structure of the companies. We identify procurement costs and inventory holding costs. The procurement costs are the costs associated with procuring (replenishing) the units stocked. We assume that each replenishment order (either by a single company or by multiple cooperating companies) incurs the fixed procurement cost A. There are no minor ordering costs for individual companies. The inventory holding costs are the costs of carrying the items in inventory. Let company i have holding cost hiper unit in stock per time unit. Then the inventory holding costs equalhiZitper time unit when the inventory at time t equalsZit. Since backorders cannot occur, the inventory position of a company is equal to its inventory level.In this section we consider non-cooperating companies that place their orders independently. The lead time is zero, so that company i uses the following replenishment policy: place an order for an amount Qieach time the inventory level drops to 0. It is obvious that the inventory level processesZinc,ti∈Nof the companies are independent processes, and that processZinc,thas state space Si={ni: 1⩽ni⩽Qi}. For completeness, and to support the more complicated expressions for cooperating companies, we review below the results for a single company.The marginal inventory level equilibrium distribution is (see e.g., Hadley and Whitin, 1963, p. 183)(1)vi(j)=limt→∞P(Zit=j)=1Qi,j=1,…,Qi,with expectationEZinc=12(Qi+1).The expected procurement cost per unit time can be obtained from a renewal argument. The inventory level processZitforms a renewal process that regenerates each time an order is placed. Thus, the long run average procurement costs are(2)limt→∞1tANi(t)=AλiQi,where Ni(t) is the number of replenishment orders in the time interval (0,t]. By the renewal propertylimt→∞Ni(t)/t=1/ETiwith probability 1, where Tiis the cycle time for company i, so that(3)ETi=Qi/λi.Observe that vi(Qi)−1 is the mean recurrence time to state Qiof the Markov jump chain on Si, so thatλi-1vi(Qi)-1is the mean time for the inventory level process to return to state Qi.The total expected cost rateKinc(Qi)for company i is(4)Kinc(Qi)=AλiQi+hiEZinc=AλiQi+12hi(Qi+1).This is a convex function in Qi. Company i will select an integer quantity that minimizes this expected cost per time unit. This quantityQincis called the optimal replenishment quantity for company i, and it equals ⌊x⌋ or ⌈x⌉ withx=2Aλi/hi.In this section we consider cooperating companies. Cooperation means that the companies join their orders for replenishment of their inventories; this way they save on procurement costs. We introduce and study two cooperation strategies. We compare their costs, also with the costs of non-cooperation. We first consider two companies, and then extend our results to multiple companies.Note that the companies may want to keep information about their inventory levels private or they may not communicate with each other. Then joint replenishment may be implemented via an intermediary, who acts as a central purchasing agent. The companies inform the intermediary about their individual inventory levels. Using this information, the intermediary can keep track of the joint inventory level, issue an order when the reorder level is reached, and assign the ordered items to the individual companies.A natural candidate for a replenishment strategy for two companies is that the companies jointly order up to some desired inventory levels (Q1,Q2) as soon as their total inventory level falls below a certain level. This happens when the aggregate demand reaches a target level. Without loss of generality assume that Q1⩾Q2. Let nidenote the inventory level of company i, and let (n1,n2) be the state of the system. A joint order for replenishment is placed when the total inventory level n1+n2 drops to Q1 units, that is, when the joint demand reaches Q2 units. Note that this ensures nonnegative inventory levels for both companies.A replenishment order is issued when the total inventory level drops to Q1, so that the state spaceS∼is(5)S∼={(n1,n2):ni⩽Qi,i=1,2;n1+n2⩾Q1+1}.We name this strategy the sum constraint strategy as it involves a constraint on the sum of the inventory levels. Notice that this policy requires very little information; only the total inventory level is needed.The joint inventory level (n1,n2) evolves as a continuous time Markov chain at the state spaceS∼. Letπ̃(n1,n2)denote the equilibrium probability for state (n1,n2). The flow balance equations (“rate out equals rate in”) are(6)(λ1+λ2)π̃(n1,n2)=λ1π̃(n1+1,n2)+λ2π̃(n1,n2+1),n1<Q1,n2<Q2λ1π̃(n1+1,n2),n1<Q1,n2=Q2,λ2π̃(n1,n2+1),n1=Q1,n2<Q2,(λ1+λ2)∑n2′=1Q2π̃Q1+1-n2′,n2′,n1=Q1,n2=Q2.The equilibrium distributionπ̃is a truncated binomial distribution:(7)π̃(n1,n2)=1Q2Q1-n1+Q2-n2Q1-n1pQ1-n1(1-p)Q2-n2,for all(n1,n2)∈S∼, with p=λ1/(λ1+λ2) the proportion of demand for company 1. This distribution follows directly from substitution into the balance Eq. (6).LetT∼be the joint cycle time under cooperation. The probability that the cycle did not end by time t isP(T∼>t). In that case, the total demand is smaller than Q2 units. Since the joint demand is Poisson with rate λ1+λ2, the expected length of a cycle is(8)ET∼=∫0∞P(T∼>t)dt=∫0∞∑k=0Q2-1((λ1+λ2)t)kk!e-(λ1+λ2)tdt=Q2(λ1+λ2).The expression for the expected cycle time is natural since it is the expected time until replenishment, that is, until Q2 demands have occurred. Standard Markov chain theory yields thatET∼=[(λ1+λ2)π̃(Q1,Q2)]-1, whereπ̃(Q1,Q2)-1is the mean recurrence time to state (Q1,Q2) of the Markov jump chain with transition probabilities p and 1−p, and λ1+λ2 the rate at which jumps occur.The lemma below gives the joint cost rate for the companies if they use the cooperation strategy under the sum constraint. The proof of this lemma is in Appendix A.Lemma 1Consider the cooperation strategy under the sum constraint. The expected joint costs per time unit given order quantities (Q1,Q2) equals(9)K∼(Q1,Q2)=Aλ1+λ2Q2+12h1(2Q1-p(Q2-1))+12h2(Q2+1+p(Q2-1)).The results can readily be extended to multiple companies. Then all companies jointly reorder when their total inventory level falls below a certain level. Without loss of generality assume that the order quantities are non-increasing: Q1⩾Q2⩾⋯⩾Q∣N∣, where ∣N∣ denotes the cardinality of N. Let(10)S∼=n=(ni)i∈N:ni⩽Qi,i∈N;∑i∈Nni⩾∑j=1|N|-1Qj+1.be the state space. The equilibrium distributionπ̃is a truncated multinomial distribution:(11)π̃(n)=1Q|N|∑i∈N(Qi-ni)!∏i∈N(Qi-ni)!∏i∈NpiQi-ni,wheren∈S∼andpi=λi/∑j∈Nλjis the proportion of demand for company i. The expected cycle time is(12)ET∼=Q|N|∑i∈Nλi,and the average joint cost is(13)K∼(Q)=A∑i∈NλiQ|N|+∑i∈Nhi2(2Qi-pi(Q|N|-1)),where Q=(Qi)i∈N.In this section another natural replenishment strategy is studied. Namely, both companies reorder as soon as one of the companies reaches its individual reorder level, ni=0. Hence, this strategy is named joint replenishment under individual constraints. The state space corresponding to this strategy is(14)S={(n1,n2):1⩽ni⩽Qi,i=1,2}.A joint order for replenishment is placed as soon as a company runs out of inventory. The global balance equations are analogous to (6), except for the case n1=Q1, n2=Q2, where the right-hand side isλ1∑n2′=1Q2π̃1,n2′+λ2∑n1′=1Q1π̃n1′,1. The corresponding equilibrium distribution π is a truncated binomial distribution:(15)π(n1,n2)=1G(Q1,Q2)Q1-n1+Q2-n2Q1-n1pQ1-n1(1-p)Q2-n2,for states (n1,n2)∈S with normalizing constant(16)G(Q1,Q2)=∑z1=0Q1-1∑z2=0Q2-1z1+z2z1pz1(1-p)z2,where zi=Qi−ni. This is shown by substitution of the equilibrium distribution into the balance equations.Let us now consider the cycle time T. Let T1 and T2 denote the time from a replenishment until a reorder level for companies 1 and 2 if the companies would operate on their own. T1 and T2 are independent random variables. If Ti>t then company i did not reach its reorder level by time t, thus, the total demand for company i so far during this cycle is less than Qi. The expected cycle time is(17)ET=∫0∞P(T>t)dt=∫0∞P(T1>t)P(T2>t)dt=∫0∞∑k=0Q1-1(λ1t)kk!e-λ1t∑ℓ=0Q2-1(λ2t)ℓℓ!e-λ2tdt=G(Q1,Q2)λ1+λ2.Standard Markov chain theory yields thatET=[(λ1+λ2)π(Q1,Q2)]-1, where π(Q1,Q2)−1 is the mean recurrence time to state (Q1,Q2) of the Markov jump chain with transition probabilities p and 1−p, and λ1+λ2 the rate at which jumps occur.Define P(n1,n2) as the probability that the system reaches the state (n1,n2) in a cycle. Clearly, the regeneration point is reached for sure—P(Q1,Q2)=1—and(18)P(n1,n2)=pP(n1+1,n2)+(1-p)P(n1,n2+1).Hence,(19)P(n1,n2)=Q1-n1+Q2-n2Q1-n1pQ1-n1(1-p)Q2-n2,for all states (n1,n2)∈S. Further, define the probability P(0,n2) as the probability that the cycle terminates from state (1,n2) due to an arrival of a demand for company 1; P(0,n2)=pP(1,n2). Similarly, define P(n1,0)=(1−p)P(n1,1). The probability that firm 1 ends a cycle is(20)∑n2=1Q2P(0,n2)=∑z2=0Q2-1Q1-1+z2z2pQ1(1-p)z2=Ip(Q1,Q2),whereIq(a,b)=∑s=0b-1s+a-1sqa(1-q)sis the generalized incomplete beta function (Abramowitz and Stegun, 1972, section 26.5). Further,(21)∑n1=1Q1P(n1,0)=∑z1=0Q1-1z1+Q2-1z1pz1(1-p)Q2=I1-p(Q2,Q1)is the probability that firm 2 ends the cycle. The cycle terminates via a demand for company 1 or 2 and therefore these probabilities sum to 1; this is directly verified from the property Iq(a,b)+I1−q(b,a)=1 of the generalized incomplete beta function.The probabilities P(n1,n2) allow for an alternative formulation of the expected cycle time and the normalizing constant of the equilibrium distribution. The cycle ends because of a demand for company 1 or company 2. If company 2 ends the cycle then the expected cycle length is the expected time it takes for Q1−n1+Q2 demands to occur times the probability that company 2 triggers the replenishment order while company 1 still has n1 items on stock. A similar interpretation holds for the case that company 1 ends the cycle. This leads to(22)ET=∑n1=1Q1Q1-n1+Q2λ1+λ2P(n1,0)+∑n2=1Q2Q1+Q2-n2λ1+λ2P(0,n2)=Q2λ2I1-p(Q2+1,Q1)+Q1λ1Ip(Q1+1,Q2).By (17)(23)G(Q1,Q2)=Q21-pI1-p(Q2+1,Q1)+Q1pIp(Q1+1,Q2)is an alternative expression for the normalizing constant.The joint costs for the companies are as follows.Lemma 2In case of cooperation under individual constraints, the expected joint costs per time unit given order quantities (Q1,Q2) equal(24)K(Q1,Q2)=A(λ1+λ2)/G(Q1,Q2)+Q2G(Q1,Q2)∑z1=0Q1-1[h1(Q1-z1/2)+h2(Q2+1)/2]z1+Q2z1pz1(1-p)Q2+Q1G(Q1,Q2)∑z2=0Q2-1[h1(Q1+1)/2+h2(Q2-z2/2)]Q1+z2z2pQ1(1-p)z2.The companies minimize the costs K by selecting a pairQ1N,Q2Nof optimal integer order quantities, N={1,2}.The result can readily be extended to multiple companies. Now all companies reorder as soon as one of them reaches its re-order level. Let(25)S={n=(ni)i∈N:1⩽ni⩽Qi,i∈N},be the state space. The equilibrium distribution π is a truncated multinomial distribution:(26)π(n)=1G(Q)∑i∈N(Qi-ni)!∏i∈N(Qi-ni)!∏i∈NpiQi-ni,where n∈S, and(27)G(Q)=∑n∈S∑i∈N(Qi-ni)!∏i∈N(Qi-ni)!∏i∈NpiQi-ni.The expected cycle time is(28)ET=G(Q)∑j∈Nλj,and the average joint cost is(29)KN(Q)=A∑j∈NλjG(Q)+∑i∈NQiG(Q)×∑j≠i∑zj=0Qj-1∑j≠ihj(Qj-zj/2)+hi(Qi+1)/2(Qi+∑j≠izj)!Qi!∏j≠izj!piQi∏j≠ipjzj.We now study the costs of the three strategies: non-cooperation, sum constraint and individual constraints. We first consider two companies and show that the sum constraint strategy is not optimal compared to both independent companies and the individual constraints strategy. Then we numerically investigate the cost structure for two and three companies.A strategy is said to be better than another one if it has lower expected joint costs.Theorem 1We have the following ordering:•Non-cooperation is better than cooperation under the sum constraint.The individual constraints strategy is better than the sum-constraint strategy.The optimal order quantity under cooperation with the individual constraints does not exceed the individual optimal order quantity,QiN⩽Qincfor any company i.The first and second item in this theorem state that the sum-constraint strategy does not perform well. This follows from the observation that under the sum-constraint strategy replenishment usually occurs when both companies have an inventory level larger than 1 unit. This implies larger holding costs for the companies than under, for example, non-cooperation.The cost structure (24) prohibits an analytical comparison of these costs with those for non-cooperation. For identical companies that have equal parameters for holding costs, demand rates, and therefore also for the order quantities, the costs structure simplifies to(30)K(Q,Q)=Aλ/Q+hQ1-2QQ122Q,where h, λ and Q, denote respectively the common holding costs, demand rates and order quantities. The derivation of this expression is in the appendix.Invoking Stirling’s approximation2QQ122Q≈1πQ, an approximate expression for the joint cost is(31)K(Q,Q)≈(Aλ/Q+hQ)/1-1/πQ.Taking the derivative with respect to Q we obtain that the optimal order quantity is approximated by the solution of(32)2hπQ5/2-3hQ2-2AλπQ1/2+Aλ=0.It is straightforward to compare these costs (31) with those under non-cooperation. To this end, note that if the procurement cost A decreases, then replenishing inventory becomes cheaper. Hence, the companies replenish more often and the order quantity per replenishment decreases for both individual firms and cooperating firms. If the procurement cost A is low enough then the order quantities are equal to one unit, Q∗=1 and Qnc=1. In this case, cooperation leads to the same cost as no cooperation: K(1,1)=2(Aλ+h)=K1(1)+K2(1). This is also true for even lower values of A. Therefore, we determine the largest value of the procurement cost A such that the cost of cooperation is equal to the total individual cost.Theorem 2For two identical companies cooperation under individual constraints is better than non-cooperation if and only if A>h/λ.Fig. 1gives the joint costs K(Q,Q) and the total individual costs K1(Q)+K2(Q) for parameter values A=20, λ=60, and h=6. Both cost functions are convex in the order quantity Q. The optimal joint costs (198.7) are lower than the individual optimal costs (246.0); the same relation holds for the optimal order quantities (15 and 20, respectively).For non-identical companies, the cost structure, as in (24), (29), prohibits an analytical comparison of the joint costs and the total individual costs. Note that in general the optimal strategy may be rather complicated, see e.g., Ignall (1969). The explicit expression for the costs is amenable for numerical comparison. This is a common approach in literature, see e.g., Federgruen et al. (1984). For numerical comparison, we randomly select the problem parameters (A, (λi,hi)i∈N) from the following ranges similar to those used in the numerical tests in Viswanathan (1997)A∈{50,100,…,250},λi∈{20,25,…,40},andhi∈{2,6,10},i=1,2.We consider the cost effectiveness, that is the optimal joint cost divided by the total optimal cost under non-cooperation. For two companies (Table 1) and three companies (Table 2) we observe that cooperation under the individual constraints outperforms non-cooperation.Hence, in all the test instances comparing the numerical optimum of the joint cost K with the analytical optimum of the individual total costs reveals that cooperation outperforms non-cooperation. We further observe that cooperation is more beneficial for more companies. Some further observations from the experiments are as follows.(i)The cost function K under the individual constraints strategy appears to be convex. Hence, it has a unique minimum.Cooperation under the optimal quantities for non-cooperation yields lower costs:KQ1nc,Q2nc⩽K1Q1nc+K2Q2nc.Cooperation results in shorter expected cycle times. That is, on average a joint order for replenishment is placed more often than any individual order.Under cooperation the procurement costs per time unit are smaller than under individual optimization. Under cooperation the firms pay A per cycle instead of 2A. On the other hand, the expected cycle time is smaller. Apparently the reduction in procurement costs dominates the decrease in cycle time.If the optimal order quantity under cooperation of firm j is the same as the individual optimal order quantity,QjN=Qjnc, then the holding cost of this firm is larger under cooperation than under individual optimization. This has two causes. Under cooperation for each sample path of demands firm j has a weakly larger inventory level with probability 1. This causes a larger average inventory for firm j, so larger holding costs. On the other hand, with positive probability company k≠j ends the cycle. Then the cycle time is lower than under individual optimization.We have seen that the individual constraints strategy saves costs. Thus the companies are willing to cooperate. In this section we investigate how to allocate the joint costs among the companies. For this, we use cooperative game theory as a tool. We start with a description of the game theoretic concepts and then proceed with a numerical investigation.The replenishment game is a cooperative cost game (N,c), see e.g., Peters (2008). N is the player set consisting of the companies. A coalition U of players is a nonempty subset of N. The cost function c assigns to any coalition of players a cost. In this game, the cost of firm i is the minimal cost of cost functionKinc(Qi), as defined in (4);c({i})=KincQincfor i∈N. LetQiUi∈Ube the optimal order quantities that minimize the cost KU({Qi}i∈U). The cost of coalition U is the minimal cost of the joint cost function KUas defined in (29),KUQiUi∈U. A game (N,c) is called concave if c(U1∪U2)+c(U1∩U2)⩽c(U1)+c(U2) for any coalitions U1, U2.An allocation of the joint cost c(N) should be in the core C(N,c) of the game,(33)C(N,c)=x∈RN:∑i∈Nxi=c(N),∑i∈Txi⩽c(U)forallU,if this set is nonempty. Then all coalitions U pay a quantity that is at most equal to their cost c(U). Hence, no coalition wants to deviate from the cooperation within coalition N. Such an allocation is called a stable allocation. Since the core often contains more than one allocation, a natural question that arises is which core element to select.We consider two specific cost allocations and check if they belong to the core. The first one is the Shapley value (Shapley, 1953). It is defined as follows. Let σ be a permutation of the players, with player σ(k) in position k. The marginal vector mσ(c) is a vector that assigns to each player its marginal contribution to the cost for the permutation σ:(34)mσ(i)σ(c)=c({σ(i)}),i=1,c({σ(1),σ(2),…,σ(i)})-c({σ(1),σ(2),…,σ(i-1)}),i>1.The Shapley value ϕ(c) is an allocation of the joint cost c(N) such that each player pays its average marginal contribution to the costs:(35)ϕ(c)=1|N|!∑σmσ(c).The distribution rule δ is a cost allocation designed for inventory cost games. This rule is an extension of the distribution rule for deterministic inventory cost games (Meca et al., 2004), which was shown to be stable. The distribution rule consists of two parts. The first part is the distribution of the joint average order costsA∑j∈Nλj/G(QN)among the firms proportional to the square of the individual optimal order costsAλi/Qinc2. The second part is the individual holding cost of each firm as experienced under cooperation; recall (29). The distribution rule allocates(36)δi=Aλi/Qinc2∑j∈NAλj/Qjnc2A∑j∈NλjG(QN)+∑j≠iQjNG(QN)∑zi=0QiN-1hiQiN-zi/2∑k∉{i,j}∑zk=0QkN-1QjN+∑k≠jzk!QjN!∏k≠jzk!pjQjN∏k≠jpkzk+QiNG(QN)∑j≠i∑zj=0QjN-1hiQiN+1/2QiN+∑j≠izj!QiN!∏j≠izj!piQiN∏j≠ipjzj,to company i.Notice that the Shapley value is a general solution for cooperative games, while the distribution rule is tailor-made for inventory situations. Neither is better than the other. A cost allocation is chosen based on its properties.For two companies, cooperation is better than non-cooperation, c(N)<c({1})+c({2}), as seen in Table 1. Consequently, the two-firm replenishment game is concave and the core(37)C(N,c)={x∈R2:x1+x2=c(N),x1⩽c({1}),x2⩽c({2})}is a nonempty set. Then the Shapley value is a stable allocation because it belongs to the core of the game (Shapley, 1971). The distribution rule belongs to the core of the game in all test instances, and is therefore stable; see Table 3for an example.For three companies, the corresponding replenishment game is a concave game in all test instances, as summarized in Table 2. Further, the Shapley value and the distribution rule are both stable allocations. See Table 4for an example. Our numerical results indicate the following conjecture.Conjecture 1The Shapley value ϕ(c) and the distribution rule δ are stable cost allocations for replenishment situations.These stability results extend those for deterministic inventory situations (Meca et al., 2004) to Poisson demand.We also investigate how sensitive the cost allocations are to changes in the parameters in a two-company setting. First, we consider the Shapley value. In a two-company game this value equals ϕ(c)=((c({1})−c({2})+c(N))/2, (c({2})−c({1})+c(N))/2) by definition. Since the core is the line segment between the two allocations (c({1}),c(N)−c({1})) and (c(N)−c({2}),c({2})), the Shapley value always lies in the center of the core. This means that the cost savings due to cooperation are shared equally among the companies. Thus, both companies have the same strong incentive to cooperate if the cost is allocated according to the Shapley value.Next, we analyse the sensitivity of the distribution rule δ. If both companies are identical, then they will order identical quantities. By definition, the distribution rule allocates the same cost to both companies. Hence, the cost allocation lies in the center of the core, and coincides with the Shapley value. This means that the cost savings are shared equally among the companies, so they always have the same strong incentive to cooperate.Fig. 2illustrates the sensitivity with regard to the procurement cost A if the companies are not identical. In this situation, the allocated cost for company 1 shows an increasing trend, although not monotonically. The reasons for this are as follows. First, the companies can only order integer quantities, hence a discretisation effect occurs. Second, due to the increase in procurement cost, both companies will order larger quantities. However, company 2 has a larger demand rate and his increase in order quantity is larger than for company 1. These effects result in the non-smooth cost allocation for company 1.Finally, we consider the sensitivity with regard to changes in demand rate and holding cost. In Fig. 3one sees that the allocation to company 1 by the distribution rule, increases with the demand rate and the holding cost. Also, the position in the core increases slightly from the bottom half of the core to the top half. In all cases, the cost allocation does not get near the bounds of the core. Hence, both companies receive reasonable large parts from the cost savings. Therefore, the incentives for cooperation remain strong.We conclude that changes in the parameters have a very small effect on the incentives of the companies to cooperate if the distribution rule is used. These incentives remain strong. In case of cost allocation via the Shapley value, the incentives even remain the same.

@&#CONCLUSIONS@&#
In this paper we study stable cost allocations for companies that jointly control their inventories. These inventories are reviewed continuously, and the companies face Poisson demand. The paper starts with the analysis of two natural cooperation strategies. First, the sum constraint strategy prescribes the companies to place a joint order for replenishment of their stocks when their joint inventory position reaches a certain reorder level. Second, the individual constraints strategy prescribes the firms to reorder as soon as a company reaches its reorder level. We obtain explicit expressions of the joint costs under cooperation, and of the individual costs.Comparison of the costs of these two strategies, also with the cost of non-cooperation, shows that the individual constraints strategy has the lowest costs for situations with two or three companies. For two identical companies we characterize when cooperation is beneficial. The numerical experiments show that stable cost allocations of the joint cost exist, namely the distribution rule and the Shapley value are stable allocations for two or three companies. Further, when the parameters change, both cost allocations still provide strong incentives to cooperate for two companies.In future research we like to extend our model to include minor ordering costs, positive lead time, backorders, batch arrivals at multiple companies, and to study other suitable cost allocations.Proof of Lemma 1We start by calculating the probability that a demand for one of the companies ends the cycle. Let P(n1,n2) be the probability that the system reaches state (n1,n2) in a cycle. The regeneration point is reached for sure—P(Q1,Q2)=1—and P(n1,n2)=pP(n1+1,n2)+(1−p)P(n1,n2+1). Notice that this equation resembles the first case in (6), hence the solution is(A.1)P(n1,n2)=Q1+Q2-n1-n2Q1-n1pQ1-n1(1-p)Q2-n2.Next define the probability P1(Q1−x,x) that a cycle terminates due to a demand for company 1 in state (Q1−x+1,x). Then(A.2)P1(Q1-x,x)=pP(Q1-x+1,x)=Q2-1x-1px(1-p)Q2-x,for x=1,…,Q2. Similarly, the probability P2(Q1−y,y) that a cycle terminates due to a demand for company 2 at state (Q1−y,y+1) is(A.3)P2(Q1-y,y)=(1-p)P(Q1-y,y+1)=Q2-1ypy(1-p)Q2-y,for y=0,…,Q2−1. The expected holding cost incurred during a cycle that is terminated by company 1 in state (Q1−x,x), x=1,…,Q2, is the expected cost times the cycle length:(A.4)[h1(2Q1-x+1)/2+h2(Q2+x)/2]Q2λ1+λ2.Similarly, the expected holding cost during a cycle that is terminated by company 2 in state (Q1−y,y), y=0,…,Q2−1, is(A.5)[h1(2Q1-y)/2+h2(Q2+y+1)/2]Q2λ1+λ2.Thus the expected holding cost during a cycle terminated by company 1 is(A.6)∑x=1Q2[h1(2Q1-x+1)/2+h2(Q2+x)/2]Q2λ1+λ2P1(Q1-x,x)(A.7)=Q2λ1+λ2∑x=1Q2h1Q1-x-12+h2Q2+x2Q2-1x-1px(1-p)Q2-x(A.8)=Q2λ1+λ2p∑y=0Q2-1h1Q1-y2+h2Q2+y+12Q2-1ypy(1-p)Q2-1-yLet Y be the random variable with realisations y in this expression. This variable Y is binomial distributed with Q2−1 trials and probability p of success. Therefore we proceed:(A.9)=Q2λ1+λ2pEh1Q1-12Y+h212(Q2+1)+12Y(A.10)=Q2λ1+λ2ph1Q1-12p(Q2-1)+h212(Q2+1)+12p(Q2-1).In a similar fashion we derive the expected holding cost during a cycle terminated by company 2.(A.11)∑y=0Q2-1h1(2Q1-y)/2+h2(Q2+y+1)/2Q2λ1+λ2P2(Q1-y,y)(A.12)=Q2λ1+λ2(1-p)h1Q1-12p(Q2-1)+h212(Q2+1)+12p(Q2-1).Summarizing, the expected procurement and holding cost per cycle are(A.13)A+Q2λ1+λ2ph1Q1-12p(Q2-1)+h212(Q2+1)+12p(Q2-1)+Q2λ1+λ2(1-p)h1Q1-12p(Q2-1)+h212(Q2+1)+12p(Q2-1)=A+Q2λ1+λ2h1Q1-12p(Q2-1)+h212(Q2+1)+12p(Q2-1).Dividing this by the expected cycle time results in the expected joint cost per time unit.□The expected holding cost incurred during a cycle are the holding cost per time unit times the cycle length(A.14)[h1(Q1+n1)/2+h2(Q2+1)/2]Q1-n1+Q2λ1+λ2if firm 2 ends the cycle while the inventory position of firm 1 is n1, and(A.15)[h1(Q1+1)/2+h2(Q2+n2)/2]Q1+Q2-n2λ1+λ2if firm 1 ends the cycle while the inventory position of firm 2 is n2. Then the expected joint procurement and holding costs per cycle under cooperation are(A.16)A+∑n1=1Q1[h1(Q1+n1)/2+h2(Q2+1)/2]Q1-n1+Q2λ1+λ2P(n1,0)+∑n2=1Q2h1(Q1+1)/2+h2(Q2+n2)/2Q1+Q2-n2λ1+λ2P(0,n2)(A.17)=A+Q2λ1+λ2∑z1=0Q1-1[h1(Q1-z1/2)+h2(Q2+1)/2]z1+Q2z1pz1(1-p)Q2+Q1λ1+λ2∑z2=0Q2-1[h1(Q1+1)/2+h2(Q2-z2/2)]Q1+z2z2pQ1(1-p)z2The average cost per time unit K is obtained by dividing this cost by the expected cycle time (17).□LetQ1s,Q2sbe the optimal order quantities for cooperation under sum constraint. The expected joint cost per time unit (9) and the assumption Q1⩾Q2 imply thatQ1s=Q2s. Let Qsbe this optimal order quantity. Notice that(A.18)K1(Qs)+K2(Qs)=Aλ1+λ2Qs+12(h1+h2)(Qs+1)(A.19)⩽Aλ1+λ2Qs+12h1((2-p)Qs+p)+12h2((1+p)Qs+1-p)(A.20)=K∼(Qs,Qs).Together withKiQinc⩽Ki(Qs)for i=1, 2 this proves that non-cooperation is better than cooperation under the sum constraint.For the second statement, consider a joint inventory situation with parameters A, λ1, λ2, h1 and h2. We show thatK(Qs,Qs)⩽K∼(Qs,Qs), the cost of cooperation under the individual constraints while using the optimal quantities of the sum constraint strategy do not exceed the optimal cost of cooperation under the sum constraint. Then the proof is finished because the strategy (Qs,Qs) need not be optimal for cooperation under the individual constraints,KQ1N,Q2N⩽K(Qs,Qs).First, when cooperating under the individual constraints the joint inventory position ranges from 2Qsdown to ni+1 with nibetween 1 and Qs, for some company i. When the companies cooperate under the sum constraint then the joint inventory position ranges from 2Qsdown to Qs+1. This lower bound is larger than for cooperation under the individual constraints. Therefore, the average inventory position of both companies are larger than for cooperation under the sum constraints.Second, in case of individual constraints inventory is replenished when the inventory position of one of the firms—say firm i—drops to 0; the joint accumulated demand equals 2Qs−nj, j≠i. In case of the sum constraint, replenishment occurs when the joint inventory position reaches Qs. Then, the joint accumulated demand equals Qs. This is lower than in case of individual constraints, Qs⩽2Qs−nj. Therefore, the cycle time is lower than for cooperation under the individual constraints. Together with the first result this implies that both the holding cost per time unit and the order cost per time unit are lower under cooperation with individual constraints. This strategy is better than cooperation under the sum constraint.For the third statement, without loss of generality consider i=1. Assume that the order quantity of company 2, Q2, is fixed. Then under cooperation there is a positive probability that firm 2 ends the cycle and initiates a new joint order. In that case, the cycle ends before company 1 has reached its reorder level; its inventory position is rather high, leading to rather large holding costs. A lower order quantity would decrease these costs. If under cooperation firm 1 ends the cycle, then the situation is the same as under individual optimization. Hence, the optimum order quantity for company 1 under cooperation does not exceed the individual optimal quantityQ1nc.□Derivation of equation(30). According to (23),G(Q,Q)=4QI12(Q+1,Q). By Lemma 2,(A.21)K(Q,Q)=Aλ/Q2I12(Q+1,Q)+12I12(Q+1,Q)∑z=0Q-1[h(3Q+1)/2-hz/2]z+Qz12z+Q.The summation in this expression reduces to:(A.22)∑z=0Q-1[h(3Q+1)/2-hz/2]z+Qz12z+Q(A.23)=h(3Q+1)∑z=0Q-1z+Qz12z+Q+1-h(Q+1)∑z=1Q-1z+QQ+112z+Q+1(A.24)=h(3Q+1)I12(Q+1,Q)-h(Q+1)I12(Q+2,Q-1).Therefore,(A.25)K(Q,Q)=Aλ/Q2I12(Q+1,Q)+h23Q+1-h(Q+1)I12(Q+2,Q-1)2I12(Q+1,Q).Using the equalityI12(Q+2,Q-1)=I12(Q+1,Q)-2QQ+1122Q(Abramowitz and Stegun, 1972, (26.5.15)), we obtain(A.26)K(Q,Q)=Aλ/Q2I12(Q+1,Q)+hQ+h(Q+1)2QQ+1122Q2I12(Q+1,Q).Finally, becauseh(Q+1)2QQ+1122Q=hQ2Q-1Q122Q-1, andI12(Q+1,Q)=1-I12(Q,Q+1)=12-2QQ122Q+1, we conclude(A.27)K(Q,Q)=Aλ/Q2I12(Q+1,Q)+hQ1+2Q-1Q122Q-12I12(Q+1,Q)=Aλ/Q+hQ1-2QQ122Q.Proof of Theorem 2By definition of the switch value, cooperation under the individual constraints has lower cost than individual optimization if and only ifA>A¯. To determine the switch value, we observe the following. If the procurement cost A is slightly larger thanA¯, then the optimal order quantities increase to 2 (because they are integer valued). In other words, the switch value is the smallest value of A such that the optimal order quantities are equal to 2, and the costs of cooperation and non-cooperation are the same. By Eq. (30),K(2,2)=45(Aλ+4h). Also, K1(2)+K2(2)=Aλ+3h. The solution of K(2,2)=K1(2)+K2(2) is A=h/λ.□