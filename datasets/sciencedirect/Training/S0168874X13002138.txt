@&#MAIN-TITLE@&#
Separable stress interpolation scheme for stress-based topology optimization with multiple homogenous materials

@&#HIGHLIGHTS@&#
Stress-based topology optimization with multiple materials is developed.A separable stress interpolation scheme should be used for the stress evaluation.Higher p-norm stress values are obtained at more than one point per element.A new regional constraint method based on the sorting algorithm is developed.

@&#KEYPHRASES@&#
Topology optimization,Stress-based topology optimization,Separable stress interpolation scheme,Multiple materials,

@&#ABSTRACT@&#
This research develops a new interpolation scheme, a separable stress interpolation (SSI) which allows stress-based topology optimization with multiple materials (STOMM). In common material interpolation function such as extended solid isotropic material with penalization (SIMP) for multiple materials, Young's modulus is interpolated from those of several solids to a smaller value with respect to design variables whose number is same as the number of considered materials. When the same interpolated Young's modulus is used for stress evaluation, it is found that the calculated stress norm becomes a small value when ones are assigned to the design variables of each element causing physically unacceptable layouts. In order to resolve this ill-posed issue for STOMM, we present the SSI scheme which computes the stress constraints of stacked elements separately. For a stable topology optimization process, the computational issues of the p-norm stress measure, the number of stress evaluation points inside an element, and the correction parameter for the approximated stress measure are addressed for STOMM. Furthermore, we present a new regional constraint method based on the sorting algorithm. The applicability and limitations of the newly developed framework are discussed in the context of its application to several stress-based topology optimizations with multiple materials.

@&#INTRODUCTION@&#
This research presents a new optimization framework for stress-based topology optimization with multiple materials (STOMM) in the framework of a mathematical optimization algorithm. In order to improve the static and dynamic characteristics of various engineering structures systematically, the size, the shape and the topology optimization (TO) methods have been established and applied [1–13]. Because the topology optimization enables topological evolutions (i.e., creating, reshaping and removing holes inside design domain), it can provide better initial engineering designs than the size or the shape optimization methods which cannot change the topologies of given initial designs. In order to conduct TO, the material properties of each finite element (FE) such as Young's modulus and density in structural engineering structure are commonly interpolated from those of the nonstructural domain (the so-called void) and to those of the structural domain (the so-called solid) with respect to design variables defined on each element. Depending on how the material properties are modeled with respect to the design variables, there are the solid isotropic material with penalization (SIMP) approach (sometimes called the density based method) [6,8,9,14] or the homogenization-based approach [1,5,15–18]. Furthermore, the element stacking method which interpolates and optimizes the stiffness matrix for multiple materials was also proposed [19,20]. With these material interpolation schemes, it seems likely that the TO method becomes one of the important engineering tools. In particular, its potential has been demonstrated in the designs of multiphysics systems [21–25]. Despite these vast researches on TO, it is ironical that TO minimizing mass usage subject to stress constraint is yet difficult to solve. Thus this research develops a new topology optimization method for the stress based topology optimization with multiple materials.Very recently, TO research considering static failure constraint (mainly confining von Mises stress) was successfully applied in some researches [26–32]. In these recent researches, many schemes and concepts have been introduced for successful stress-based topology optimization. For example, to overcome the intricate issue associated with many local constraints, most of these researches relied on the p-norm approach calculating the p-norm of the local stress constraints, and allegedly representing the maximum stress value for a single material continuum. Also there is a research based on a heuristic optimization process such as evolutionary structural optimization [33,34]. Recently, a topology optimization method for steel-concrete composite structure under stiffness and strength constraints is proposed which consider strength constraint for concrete material and stiffness constraint for steel material [35]. As noted, most of the studies that solve stress-based TO are based on a single material continuum and the stress-based TO with multiple materials using a gradient based approach has not been considered yet. To contribute the stress-based TO with multiple materials (STOMM) with the von Mises failure criterion, this research develops a new optimization framework by introducing a new interpolation scheme called a separable stress interpolation (SSI) scheme which adopts different interpolation functions for material properties and stress norm evaluation with respect to design variables.Besides the existing issues of stress-based topology optimization with a single material, to make it possible to conduct STOMM successfully, the following numerical issues for which the existing topology optimization formulation or modeling techniques are to be applied should be additionally addressed.1.Stress interpolation scheme for multiple materials as well as material interpolation scheme with respect to design variables.Stress' singularity and nonlinear behavior for multiple materials.Too many local constraints for multiple materials (including local constraints at stress evaluation points).Within the existing material interpolation schemes such as SIMP or the Homogenization method, it is common to interpolate Young's moduli of the involved materials with respect to design variables assigned to one single finite element [6,36] as shown inFig. 1(a); the number of the design variables is same with the number of the materials of interest. Although this approach is adopted as a standard and it is widely used without any doubt, it becomes ambiguous for stress evaluation. In [29], the penalization factor, 0.5, which is different from the penalization factor of Young's modulus for analysis, is used for stress evaluation for stress-based TO with single material. Likewise, the interpolation function issue becomes critical for STOMM and has not been researched yet. For instant, let us consider the stress based topology optimization with two materials in Fig. 1(a). Obviously Young's modulus, E, may be interpolated among a small value for void, E1 for the first material and E2for the second material using an interpolation function. For Fig. 1(a), the stress value becomes zero when γ1=γ2=0 because no material is used. When γ1=γ2=1, the stress value becomes zero therefore we cannot capture stress. The effect of this phenomenon will be investigated in detail in the next section. To restrict the maximum von Mises stress depending on the employed materials, the stress constraints for the two materials should somehow be added to a topology optimization process. According to the previous research [34], it seems that the stress constraint for each material may be included for the topology optimization minimizing volume; one for the first material with E1 and another for the second material with E2. Here it is not clear how to formulate or evaluate the stress constraints for the two materials with respect to the design variables during a topology optimization process. In another word, the question that the stress evaluation with the same interpolated Young's modulus can be possible or not arises. In our research, we conclude that it is impossible to use the interpolation scheme of Fig. 1(a) and the SSI scheme in Fig. 1(b) should be used instead; the detail descriptions are given in the next section.For the second issue, we note that the stress's singularity and nonlinear behavior that are serious even with a single material becomes more serious with multiple materials. According to previous studies [29,31,37,38], it is likely that the stress singularity for single material is well understood. When the interpolated Young's modulus approaches zero, the corresponding element may exhibit an excessive distortion, resulting in a higher stress level that should be considered in the optimization process. However, because the corresponding design variable becomes zero (non-structure), the stress should not be considered at all. Thus, briefly, we can describe the stress's singularity issue as the necessity of the element with a lower-bound design variable simulating void. To resolve this critical issue, the ε-relaxation method [37] has been introduced. To illustrate this singularity feature further, the variations of the von Mises stress of the 21st element inFig. 2 are evaluated and plotted in Fig. 2. As shown, the stress values are large when the two design variables are zeros. Therefore, it is postulated that there are many possibilities for the constraint violations of element stresses with zero design variables.As the third issue, the local constraint issue becomes serious with multiple materials. From the recent researches, it is found that the only element-wise stress, evaluated at the center of the element, is considered to formulate the local stress constraint. Therefore, the nonlinear constraints whose number is the same as that of the element are imposed. However, this makes the stress based topology optimization impossible to solve within a moderate time even with an advanced computer hardware and software. The so-called p-norm constraint approach is commonly adopted to resolve this difficulty, which makes the too many local constraints into the global constraint. To our knowledge, first, only one p-norm was tested for stress-based topology optimization but later the many p-norm constraints defined at so called regions were used to resolve the oscillating stress constraint issue that results in non-convergence of TO with a lot of grey elements. In this research, because we also observed the merits and benefits of many p-norm constraints defined at regions, it is adopted and a new scheme to define region based on the sorting algorithm is proposed and tested.The layout of the paper is as follows. After describing equations for the stress-based topology optimization of a linear system, we introduce the stress evaluation scheme for multiple materials and implement it within the framework of the element stacking method. By extending the idea of the element stacking method into the patch stacking method, it becomes possible to solve the stress-based topology optimization with multiple materials. Furthermore, the topology optimization formulations for stress-constraints and the p-norm stress constraint with the element stacking method are introduced in Section 2. To show the potential of the proposed method, several numerical examples are considered in Section 3. Finally, our findings and some topics for future research are summarized and discussed in the conclusion.The present topology optimization methodology benefits from many elaborated researches [27–31,38]. Therefore before discussion of the present approach, let us review the stress-based topology optimization for one material.It is one of the important and difficult engineering problems to minimize the usage of materials subject to the stress constraint even with a single material for various engineering purposes. Through the appreciated researches in [27–31,38] for stress-based topology optimization, the original stress-based topology optimization formulation can be stated as follows:(1)MinimizeγV(γ)=∑e=1NEγevesubjecttoσe≤σ⁎iftheethelementexist(e=1,2,…,NE):Localconstraint(2)γ=[γ1⋯γNE](ε≤γi≤1,ε:alowerbound)where the design variables assigned to each element are denoted by γ and the number of the design variables or finite elements is denoted by NE. The maximum von Mises value σebefore failure of the finite element is denoted by σ⁎.To evaluate the displacements, stress and other quantities, FE analysis is performed as follows:(3)KU=Fwhere the stiffness matrix, the displacement vectors and the external force are denoted by K, U, and F, respectively. In the FE context, the stiffness matrix is assembled as follows:(4)K=Ae=1NEkeandke=∫veBTCeBdvwhere the assembly FE operator is denoted by A for the element stiffness matrices keand the strain–displacement matrix is B. The eth element domain used for the domain integration of the element stiffness matrix is ve. Assuming the plane stress problem and the solid isotropic material with penalization (SIMP), the constitutive matrix, Ce, is defined as follows:(5)Ce=E(γe)1−ν2[1ν0ν1000(1−ν)/2](6)E(γe)=E0γenwhere the penalization factor and the nominal Young's modulus are denoted by n and E0, respectively. With the above optimization formulation, it seems that it is possible to conduct stress-based topology optimization properly; we appreciate the many elaborated researches for the stress-based topology optimization with one material and presented the condensed description for it.With the element-wise stress evaluation, i.e., the stress norm at the center of elements, the von Mises failure criterion is calculated as follows:(7)σe=CeSBue={σxx,σyy,τxy}atacenteroftheethelement(8)CeS=E0γens1−ν2[1ν0ν1000(1−ν)/2](9)vonMisescriterion:σe=(σxx2−σxxσyy+σyy2+3τxy2)0.5The displacements, the constitutive matrix used for the stress evaluation, and the strain–displacement matrix are ue,SCe, and B, respectively. Note that in the evaluation of the stress, we useSCewith the density penaltynsrather than Ce; it was reported that 0.5 for nsworks for some numerical examples [29].Because of the issues associated with the non-differentiable operator, the issues of too many local constraint, and the singularity issue [9,28], the above optimization problem are first relaxed by adopting the density filter and the regional scheme of the local stress constraints in [29] as follows:(10)MinimizeγV(γ˜)=∑e=1NEγ˜eve(γ˜:Filtereddensity)subjectto〈σmax〉1≤σ⁎〈σmax〉2≤σ⁎⋮〈σmax〉RN≤σ⁎γ˜=Ξ(γ)withthedenstiyfilterΞ(11)〈σmax〉k=max(σe)whene∈Ωkandtheethelementexistswhere for a smooth convergence the stress constraints defined at the kth region, whose meaning and a new scheme are explained and presented in the following section, are also adopted [29–31]. The maximum von Mises stress at the kth region is denoted by 〈σmax〉k. The number of subdivided regions for the stress constraint evaluation regions is RN. Furthermore, the filtered density is employed to regulate the design process. (See [7,29] for more discussions.) It is worth to notice that the maximum operator in (11) becomes a huddle because it is non-differentiable. Furthermore, the singularity issue of the stress measure should be considered [38]. In order to resolve this difficulty, the p-norm approach is adopted in the existing stress-based topology optimization research [9]. The constraints in (10) are further reformulated as follows using the p-norm approximation at the iter-th optimization iteration:(12)〈σmax〉k≡ckiter〈σPN〉k≤σ⁎(e∈Ωk)(13)〈σPN〉k≡(∑eσepγ˜e)1/p(e∈Ωk)(14)ckiter=ασmax,kiter−1〈σPN〉kiter−1+(1−α)ckiter−10<α<1where the correction factor at the iter-th optimization iteration, the real maximum von Mises stress at the kth region, and the damping factor are citer,σmax,kiterand α, respectively. The parameter employed for the p-norm approximating the maximum operator is p, and is fixed as 4 unless stated otherwise; in principle it should be infinite, but in practice a value from 3 to 4 was reported to work properly. In Eq. (14), if it seems that c oscillates between iterations, a variable from 0 to 1 can be assigned to the parameter α. Unless stated otherwise, we use 0.5 when c oscillates. As a result of these vast researches, the above approach applicable to single material is possible.When considering multiple materials during topology optimization, the issues observed for stress-based topology optimization with one material become more serious. To our best knowledge, there is no previous research studying stress-based topology optimization with multiple materials using a gradient-based approach. By following the approaches in [29] and the above formulations, the stress-based topology optimization with multiple materials can be formulated as follows:(15)MinimizeγV(γ˜)(γ˜:Filtereddensity)subjectto〈σ1,max〉1≤σ1⁎⋯〈σ1,max〉RN≤σ1⁎〈σ2,max〉2≤σ2⁎⋯〈σ2,max〉RN≤σ2⁎⋮〈σNM,max〉1≤σNM⁎⋯〈σNM,max〉RN≤σNM⁎gi(γ˜)=∑e=1NEγ˜e,ive−βi∑e=1NEve≤0(k=1,2,…,NM)optionalγ˜=Ξ(γ)withthedenstiyfilterΞ(16)γ=[γ1,1⋯γNE,1⋮⋮⋮γ1,NM︸thedesignvariablesforthe1stelement⋯γNE,NM︸thedesignvariablesfortheNE-thelement]The numbers of finite elements and the employed materials are denoted by NE and NM, respectively. The total number of design variables in (16) now becomes NE×NM rather than NE. The maximum nominal stress for the finite elements modeled for the ith material at the kth region is denoted by 〈σi,max〉kand its upper bound for the ith material isσi⁎. The defined usage of material with the filtered density is calculated as follows:(17)V(γ˜)=∑i=1NM∑e=1NEγ˜e,ivewhere the eth element volume is ve. Here, as it is noticed that only with the above objective function, it is not possible to control the usage of each material. Therefore, the additional constraints are included in the optimization formulation (15):(18)gi(γ˜)=∑e=1NEγ˜e,ive−βi∑e=1NEve≤0where the mass constraint of the ith material is βi.For the material interpolation for structural analysis but not for the stress evaluation, the following extended SIMP approach for multiple materials can be used [36]:(19)E(γ˜e,1⋯γ˜e,NM)=∑i=1NM[γ˜e,in1∏j=1j≠iNM[1−(γ˜e,j)n2]Einominal](20)E(γ˜e,1⋯γ˜e,NM)=γ˜e,0n0∑i=1NM[∏j=1j≠ii−1[1−(γ˜e,j)n2](γ˜e,in1)Einominal](21)Planestress:Ce=E(γ˜e,1⋯γ˜e,NM)1−ν2[1ν0ν1000(1−ν)/2]where the nominal Young's modulus for the ith material is denoted byEinominal. In (19), Young's modulus is now the function of the design variables,γ˜e,1⋯γ˜e,NM. Before the interpolation function (19), (20) was proposed for the topology optimization using multiple materials by Sigmund and co-workers [9]. However, according to Stegmann and Lund [36], it tends to get stuck in local optima when the number of materials becomes large. Therefore, we use (19) for the SIMP interpolation. By following the standard FE procedure for structural displacements, the stresses of the finite elements are calculated as follows:(22)ES(γ˜e,1⋯γ˜e,NM)=∑i=1NM[γ˜e,in3∏j=1j≠iNM[1−(γ˜e,j)n3]Einominal](23)Planestress:CeS=ES(γ˜e,1⋯γ˜e,NM)1−ν2[1ν0ν1000(1−ν)/2](24)σe=CeSBueAs in the stress-based topology optimization with a single material, the interpolated Young's modulus and the constitutive matrix for stress evaluation are denoted bySE andSCe, respectively. The maximum nominal stress can be written mathematically as follows:(25)Ωk={e|onlywhentheethelementinsidethekthregion}(26)〈σi,max〉k=ck,iiter〈σi,PN〉k≤σi⁎,(27)〈σi,PN〉k=(∑eσepγ˜e,i)1/p,e∈Ωk,σe=vonMisesstressofσein(24)(28)ck,iiter=ασmax,kiter−1〈σi,PN〉kiter−1+(1−α)ck,iiter−1For multiple materials case, it is found that the standard material interpolation approach such as the extended SIMP with multiple variables does not work. To explain the difficulty of the above stress evaluation for multiple materials, let us consider the following material interpolation of the two materials with the two design variables,γ˜e,1andγ˜e,2which is an extended material interpolation based on the SIMP approach and has been widely employed for structural optimization. The interpolated Young's modulus,E(γ˜e,1,γ˜e,2), for the eth element is written as follows:(29)E(γ˜e,1,γ˜e,2)=γ˜e,1n1(1−γ˜e,2n2)E1+γ˜e,2n1(1−γ˜e,1n2)E2(30)Ce=E(γ˜e,1⋯γ˜e,NM)1−ν2[1ν0ν1000(1−ν)/2]=[γ˜e,1n1(1−γ˜e,2n2)C1nominal+γ˜e,2n1(1−γ˜e,1n2)C2nominal](31)ES(γ˜e,1,γ˜e,2)=γ˜e,1n3(1−γ˜e,2n3)E1+γ˜e,2n3(1−γ˜e,1n3)E2(32)CeS=ES(γ˜e,1⋯γ˜e,NM)1−ν2[1ν0ν1000(1−ν)/2]=[γ˜e,1n3(1−γ˜e,2n3)C1nominal+γ˜e,2n3(1−γ˜e,1n3)C2nominal](33)ε≤γ˜e,1≤1,ε≤γ˜e,2≤1(34)C1nominal=E11−ν2[1ν0ν1000(1−ν)/2],C2nominal=E21−ν2[1ν0ν1000(1−ν)/2]where the penalization factors are denoted by n1 and n2. The nominal constitutive matrices areC1nominalandC2nominal. Now, assuming that by inversing the assembled FE matrix and multiplying it to the force vector, the structural displacements, U, is obtained. With the eth element displacement, the strain and the stress for the eth element can then be obtained. The relaxed p-norm can be simply written as follows:(35-1)〈σ1,max〉k=ck,1iter(∑eσepγ˜e,1)1/p≤σ1⁎,e∈Ωk(35-2)〈σ2,max〉k=ck,2iter(∑eσepγ˜e,2)1/p≤σ2⁎(e∈Ωk,therelaxedstressσeissameasthatof(35-1)Note that the above equations use the same relaxed stresses of the failure, σe(e∈Ωk) for the two stress constraints. A detailed investigation, as we shall numerically present soon, of the above material interpolation that works fine for one material, reveals that it is improper to use σein Eq. (35) because assigning ones toγ˜i,1andγ˜i,2, i.e., using the both materials, results in small values for the stress components and the nominal stress norm. Therefore, the relaxed stress constraints are automatically satisfied that is physically unacceptable.In response to the above non-sense solution with ones for the design variables, this research presents a separable stress interpolation (SSI) scheme based on the element stacking method [19,20] that interpolates the stiffness matrices with respect to design variables. Unlike the material interpolation method of (29), the element stacking method interpolates stiffness matrices. Therefore, the standard FE assembly procedure of (4) is modified as follows:(36)ke(γ)=Ai=1NMke,i(γ˜)=Ai=1NM[γ˜e,in1∏j=1j≠iNM[1−(γ˜e,j)n2]ke,inominal]where the nominal stiffness matrix of the eth element for the ith material and the juxtaposed FE stiffness matrix areke,inominalandke,i, respectively. In the above stiffness matrix interpolation equation, the design variables are used to interpolate the stiffness matrices. Here, what we want to emphasize is that considering only an analysis of a structure without evaluating stress constraints, the above interpolation of matrices produces exactly the same displacements of Eqs. (4)–(6). However, the significant differences exist from a stress evaluation point of view. Note that the present stress evaluation scheme calculates multiple stress values for each material per an element unlike the standard SIMP method evaluating only one stress values per an element. As we describe below, this difference resolves the mentioned side effect of assigning ones toγ˜e,ithat results in a small stress norm value for the eth element. Furthermore, with this modification from the material interpolation to the stiffness matrix interpolation, it was reported that some difficult boundary conditions can be considered during optimization [19,20]. For topology optimization, the following p-norm is also adopted:(37)σe,i=γ˜e,in3CinominalBue(38)Planestress:Cinominal=Ei1−ν2[1ν0ν1000(1−ν)/2](39)σe,i=vonMisesstressofσe,i(40)〈σi,max〉k=ck,iiter〈σi,PN〉k≤σi⁎(41)Ωk={e|onlywhentheelementsinsidethekthregion}(42)〈σi,PN〉k=(∑eσe,ipγ˜e,i)1/p,e∈Ωk(43)ck,iiter=ασmax,i,kiter−1〈σi,PN〉kiter−1+(1−α)ck,iiter−1For example, the above interpolation with two materials can be written as follows:(44)ke,inominal=∫veBTCinominalBdv,ke,1=γ˜e,1n1(1−γ˜e,2n2)ke,1nominal,ke,2=γ˜e,2n1(1−γ˜e,1n2)ke,2nominal(45)ke=ke,1+ke,2=γ˜e,1n1(1−γ˜e,2n2)ke,1nominal+γ˜e,2n1(1−γ˜e,1n2)ke,2nominal(46)ε≤γ˜e,1≤1,ε≤γ˜e,2≤1With the above FE simulation, the followings are used to evaluate stress and stress constraints:(47)σe,1=γ˜e,1n3C1nominalεe,σe,2=γ˜e,2n3C2nominalεe(48)σe,1=vonMisesstressofσe,1,σe,2=vonMisesstressofσe,2To illustrate the features of the SSI scheme compared with the extended SIMP based approach further, let us consider an elementary structure inFig. 3 with a bilinear 4 node plane stress element. The detailed geometry and the material properties are provided in Fig. 3 and only von Mises stresses at the center of the elements are evaluated in this example by using the equations inTable 1.To demonstrate the side effect of SIMP based interpolation for multiple materials on stress evaluation, the p-norms of the von Mises stresses with ones forc1,1iterandc1,2iterare calculated in Fig. 3. As seen in Fig. 3(c), when the two design variables become ones, the p-norm stresses for the two materials become zero, which results in the solid–solid design variables to minimize the p-norm stress measure. On the other hand, as seen in Fig. 3(d), the present SSI scheme has lower stress values when only one of the two design variables becomes one. Therefore, the side effect of the SIMP based interpolation for multiple materials on the stress evaluation can be resolved. In conclusion, although it seems appropriate to employ the same interpolation constitutive matrix (32) used for the calculation of the stiffness matrix for the stress evaluation, it causes the underestimation of the stress value when the corresponding design variables become ones due to the feature of the SIMP interpolation function (32). Thus, it seems reasonable to use the present SSI scheme that provides comparatively larger stress values with ones for all the design variables and nominal stress values only with one for one of the design variables. To show its validity in the stress-based topology optimization, the numerical section provides several topology optimization examples and compares the stress values calculated by the present SSI scheme and the SIMP scheme.Commonly, for the represented stress values, the failure criteria such as von Mises stress are only evaluated at the centers of finite elements for stress-based TO. However, it is now possible to calculate stress values at the boundaries or Gauss's points of elements for accurate stress values compared with only one value in the existing researches. To our best knowledge, it seems that this approach, i.e., stress evaluation at one point, is mainly due to the following difficulties.Issue 1: The number of local constraints is dramatically increased without the concept of the global constraint measure such as the p-norm approach.Issue 2: Strong discontinuity of the global constraint is observed.To resolve the above difficulties, the global constraint measure scheme, i.e., the p-norm approach, and the segregation region scheme which splits a design domain into several subdomains have been developed [29–31]. Therefore, it is now possible to investigate the effects of including the representing stress values at many points inside finite elements as shown inFig. 4. According to the different stress evaluation points, the stress distribution can be changed as shown in Fig. 5. In this research, the Gauss's quadrature points and the positions of nodes are additionally considered during TO, because most FE software provides the representing stress values at these points, and it is a general engineering practice to evaluate the failure of mechanical parts at these points. With the help of the mentioned schemes, additional computational effort can be minimized from a computational point of view.In this subsection, an alternative segregation scheme based on the sorting algorithm is developed for the stress constraints. As stated in Introduction, the issue of too many stress constraints is now resolved with the help of the global constraint measure (the p-norm scheme). Its success in reducing the number of local stress constraints, however, induces another optimization problem of fluctuating stress values because it cannot constrain or control the stress values of each element. To resolve this side effect, an innovative segregation scheme compromising the advantage, i.e., reducing the number of constraints, and disadvantage, i.e., not controlling stress values of an element wisely, was proposed [29–31]. In this segregation scheme, the design domain is segregated or split into several subdomains called regions for the local stress constraints and the p-norm measures are calculated at these subdomains. Until now, the two schemes in sorting the local stress values have been proposed. One scheme is based on geometrical location [30,31] and is conceptually similar to the domain decomposition method, the other is based on the numerical sorting algorithm [29] with respect to the magnitudes of stress values. In the latter method, the elements of a design domain are sorted according to the magnitudes of the von Mises stress values at every optimization iteration as follows:(49){e1,e2,…,eNE:σe1≤σe2≤⋯≤σeNE}σek:ThevonMisesstressdefinedin(24)oftheekthelementwhere the index, ei, indicates the sorted element number. Upon these indices, the kth design domain in the RN regions is defined as(50)Thesegregationschemein[29]:Ωk≡{ek,em+k,e2m+k,…}(k=1,2,…,RN)For example, with RN=3 and NE=12, the three regions are defined as follows:(51)Ω1≡{e1,e4,e7,e10}Ω2≡{e2,e5,e8,e11}Ω3≡{e3,e6,e9,e12}Not presented in this paper, the segregation scheme of (50) shows better optimization convergence in terms of the design variable convergence into solid and void, and the confining of the aggregated stress values to a stress upper limit compared with the segregation scheme on the graphical location. Furthermore, in our numerical observations conduced in the next section, it seems that when only one global stress constraint is used, an optimizer mainly considers the highest stress value and induces some oscillations among stress values; if one stress value is minimized, other stress values become higher. With this segregation concept, although the number of the stress constraints is increased to the number of the split domains, a stable optimization process can be achievable.Based on the above observations, we can conclude that it is better for the magnitudes of the stress norms at subdomains to be as uniform as possible during optimization process and we slightly modified the segregation scheme based on the sorting algorithm. First, the finite elements are sorted according to the magnitude of the stress measure and the kth segregated domain in the RN regions is defined as(52)Present:Ωk≡{ek,eRN+k,…,eNE/2−(RN−k),eNE/2+(RN−k)+1,…,eNE−(RN+k)+1,eNE−k+1}(k=1,2,…,RN)For the case with RN=3 and NE=12, the three regions are defined with the present approach as follows:(53)Ω1≡{e1,e4,e9,e12}Ω2≡{e2,e5,e8,e11}Ω3≡{e3,e6,e7,e10}The pictorial comparison of the present aggregation scheme and the existing scheme is given inFig. 6. Note that the sums of the sorted element indices are (22,26,30) for the previous aggregation scheme whereas those of the present aggregation scheme are (26,26,26). With multiple stress evaluation points, the maximum value of the normalized von Mises stress is used for the sorting algorithm. For example, with the stress evaluations at the nodal points for two materials, the maximum value among(σe,1,1/σ1⁎,…,σe,4,1/σ1⁎,σe,1,2/σ2⁎,…,σe,4,2/σ2⁎)is used for the sorting algorithm where σe,j,iis the jth von Mises stress among the stress evaluation points of the eth element for the ith material.To show the performance of the present segregation scheme in detail and in practice, let us compare the p-norm stress values of the subdomains split by the three segregation schemes for the simple cantilever beam structure shown inFig. 7(a). Fig. 7(b) and (c) shows the two separated domains (RN=2) by each method and the summed p-norm stress values by each method. As observed, the segregation algorithms based on the sorting algorithm show the smoother stress norm distributions where the segregation algorithm based on the geometrical location shows a larger difference in the magnitudes of the sumed p-norm stresses. In the next seciton, the effects of the present segregation scheme in optimization results are illustrated and discussed.To show the validity of the present stress-based topology optimization with multiple materials, this section provides optimal layouts for the two benchmark problems (L-shape bracket and cantilever beam). Also, the tunnel reinforcement problem to prevent heave phenomenon is solved. The method of moving asymptotes is combined with the developed codes in the framework of the Matlab [39]. For the convergence criteria, the following absolute change of design variables of two sequential optimization iterations is considered and the maximum optimization iteration is set to 1000. The limit value of difference between two sequential optimization iterations for the convergence criteria is set to 0.01.Example 1L-bracketFor the first numerical example, the STOMM for an L-shape beam with a fixed upper edge with two materials is considered [28–32]. Because this type of structure has been considered in many previous researches, a thorough study of this structure with the present STOMM can show some potential and limitations. Without the loss of generality, we choose carbon steel 1018 and stainless steel 303 [40]. The detailed geometry and material properties are listed inFig. 8. The bilinear plane stress QUAD elements (1.0mm by 1.0mm) are used to discretize the domain. In order to consider the stress constraints, the stress norms at the nodal points are calculated and used for the optimization. For the regulation of the design process, a density filter with three times of the element size for the filter radius is adopted. In Fig. 8, the layout with the two materials minimizing compliance which can be used as guidelines is obtained. Note that for the employed material bounds (β1=0.155, β2=0.115), the bounds from the result of the STOMM design inFig. 9(c) are used. As shown, minimizing the compliance, some stress concentrations above 800MPa are observed at the corner of the L-bracket. For the sake of illustration, the strong material is rendered in black while the weak material is rendered in gray. The STOMM is then considered by solving the following optimization formulation in Fig. 9(c):(54)MinimizeγV(γ˜)=∑k=1NM∑e=1NEγ˜e,kve(γ˜:Filtereddensity)subjectto〈σ1,max〉1≤σ1⁎⋯〈σ1,max〉RN≤σ1⁎〈σ2,max〉2≤σ2⁎⋯〈σ2,max〉RN≤σ2⁎g2(γ˜)=∑e=1NEγ˜e,2ve−β2∑e=1NEve≤0Fig. 9 shows the obtained layouts with several schemes. Note that, β2=0.3 is used for the volume constraint in (54). The two stress-based layouts with either materials are presented in Fig. 9(a) for references. Similar results with some differences in detail can be obtained. As shown, the layouts are similar to the designs shown in other references for stress-based topology optimization. Fig. 9(b) and (c) shows the layouts with the two materials by the extended SIMP scheme and the present STOMM with the SSI scheme. With the SIMP interpolation function for multiple stress evaluation, the physically unacceptable results are obtained in Fig. 9(b). As explained in the previous section, with the extended SIMP scheme, some finite elements having ones for the design variables appear to minimize the stress norm value. But with the present STOMM, it seems that the physically accepted design in Fig. 9(c) can be obtained. Also the stress distributions of Fig. 9(c) are recalculated with the SIMP interpolation function for multiple materials. As shown when the design variables converge to either one of the materials, the stress values of the present SSI scheme and the SIMP scheme are almost same; with 1 for only one design variable among several design variables for the material property interpolation of one element, the SIMP approach for multiple materials becomes not problematic for the stress evaluation while the SIMP approach for multiple materials causes the side effect in the stress based topology optimization. The stress bounds(σ1⁎:241MPa,σ2⁎:358MPa)are all satisfied for each material. At the right tip of the design with the distributed load, the strong material appears. The two legs at the left side and the corner area subjected to major tension are constructed with the strong material too. The internal areas which relatively are subjected to lower load are filled with the weak material. From the numerical result, we found that the present STOMM distribute strong material approximately in the same regions “reinforced” by the compliance-based procedure. Because the magnitude of von Mises stress in the reinforced regions generally higher than the remained regions, the strong material distribute approximately in the “reinforced” regions of compliance-based design. However, some detail layout is different between two approaches such as the stress concentration region. The right side of Fig. 9(c) shows the stress distributions of the right design. In order to give some insights of the design evolutions, the several intermediate designs during the 1000 iterations are presented inFig. 10. Due to the non-differential heuristic filter, some oscillations in the objective function are observed. From a layout point of view, it seems that the design of the 500th iteration is converged.InFig. 11, the effects of the stress evaluation points are tested for the L-shape structure. As shown, by considering the stress values of Gauss's quadrature points or the nodal points, it seems that the complexity of the detail designs near at the sections of the main beams is increased. Because the stress norms at the element centers become same as the average values of the stress values of the Gauss integration points or the stress values of the nodal points for the square elements with constant Jacobian values, the design constraining the stress values at the element centers naturally violates the stress bound constraints when the stress values of the structure are evaluated at these points as shown in Fig. 11. The layout with the center stress values in Fig. 11 does not have the reinforcement at the bottom side but this is due to the local optima issue; seeFig. 12. In Fig. 12, the effects of the aggregation schemes are tested. As expected, with a different number of regions, the different local optimum layouts can be obtained. In our numerical test, the present aggregation scheme with RN=4 provides the best result in terms of the objective function. Note that although the optimized layout with the present aggregation scheme is better than the others from an object point of view, it may be due to the local optima issue. For different optimization problems with different boundary conditions, the performances of each aggregation scheme will be different. Therefore, it is recommended to use all the aggregation schemes and select the best result among them.Cantilever beam exampleFor the second numerical example,Figs. 13 and 14 consider the cantilever beam optimization problem that minimizes the usage of mass subject to the stress constraints. Note that this problem is also one of the benchmark problems for TO. The design domain with the fixed left side is a 200mm by 100mm rectangular box. The load of 900N is distributed at the five right center nodes as shown in Fig. 13(a). As we did for the first numerical example, the compliance minimization problem with the two materials (E1=190GPa, E2=210GPa) is solved to obtain Fig. 13(b) with the mass usages of the result of STOMM in Fig. 14(b) for a reference. It is likely that in order to minimize the compliance, the strong material rendered in black color is distributed at the clamped side and the load side. The calculated maximum stress norms above 600MPa mainly due to the bending moment contributing to the stress value in the x-direction and the shear force contributing to the stress value in the y-direction are observed at the top and bottom regions of the left side. By applying the present STOMM, the designs in Fig. 14(a) and (b) can be obtained with one material and with the two materials. To remove the stress concentrations at the left side observed in Fig. 13(b), it is likely that the left side areas for the bending moment and the shear force are increased in Fig. 14(a) and the left side areas are increased by introducing the internal bars in Fig. 14(b). Similar to the compliance minimization problem the strong material is appeared at the clamped side and the right-end region with the load.Tunnel reinforcement preventing heave phenomenonFor the last numerical example, the tunnel reinforcement problem to prevent failure due to the inward pressures toward a tunnel is considered inFig. 15[41–43]. To our knowledge, as so called the heave phenomena of floor or sidewall are known to be serious, there are some topology optimization researches mainly minimizing the compliance or the heave phenomena by distributing optimal reinforcing materials around a tunnel [41–43]. In this research, we propose to use the present topology optimization framework minimizing the heave phenomena of floor subject to the stress constraints and usage of reinforcement material for the semi-circle tunnel of Fig. 15. The semi-circle tunnel is placed at the center part of the design domain discretized by 4 node plane strain elements. The heights of the tunnel and the design domains are h and 8h, respectively and the ratio of the horizontal load to the vertical load is R=σh/σvwhere the horizontal stress and the vertical stress are denoted by σhand σv, respectively. For the sake of illustration, the ratio of Young's modulus of the rock material (Erock) to that of the reinforcement material (Ereinforcement) is set to Erock: Ereinforcement=3:10 and the ratio of the stress limit of the rock material(σrock⁎)to that of the reinforcement material(σreinforcement⁎)is set toσrock⁎:σreinforcement⁎=3:8. Their Poisson's ratios are set to 0.3. To our best knowledge, the floor heave phenomenon measured by the difference of the vertical displacements of the bottom corner and the middle floor often occurs than the sidewall heave phenomenon and becomes severe when R<1.4 [41]. Thus we compare the optimized layouts with 0.4, 0.7 and 1.2 for R for our numerical tests.For the topology optimization, the following new optimization formulation is used [41]. Unlike the other researches minimizing the floor heave subject to a mass constraint, the reinforcement material (5% of the design domain here) should be distributed to minimize the heave phenomenon subject to the stress and mass of reinforcement constraints(55)Minimizeγ(u2f−u2c)2subjectto∑e=1NEγ˜eve−β∑e=1NEve≤0〈σmax〉k,rock≤σrock⁎(k=1,…,RN)〈σmax〉k,reinforcement≤σreinforcement⁎(k=1,…,RN)〈σmax〉nondesignpart≤σreinforcement⁎Note that not to mention the stress constraints of the rock domain and the reinforcement domain, the stress constraint of the non-design domain is also considered in this optimization formulation. The material interpolation functions developed in the previous sections are employed and the stress values of each material are evaluated as follows:(56)σreinforcement=γnsCreinforcementε(57)σrock=(1−γns)CrockεThe p-norm stresses of each material are evaluated as follows:(58)〈σPN〉k,reinforcement=(∑eσe,reinforcementpγ˜e)1/p,e∈Ωk(59)〈σPN〉k,rock=(∑eσe,rockp(1−γ˜e))1/p,e∈ΩkFig. 16 presents the topology optimization results minimizing floor heave subject to a mass constraint and their stress distributions with the different load ratios of R. The maximum values of each material's von Mises stress value divided by its allowable stress value, i.e.,σe,rock/σrock⁎,σe,reinforcement/σreinforcement⁎, are used to represent their stress distributions. Thus the areas having ratios larger than 1 indicate that the stress constraints are violated.Fig. 17 presents the optimized layouts and their stress distributions by solving the present stress-based topology optimization problem of (55). Compared with the layouts of Fig. 16, it can be observed that there are significant differences and the stress constraints are satisfied. It is likely that the stress concentrations are removed by distributing the reinforcement material at the left and right sides of the tunnel. What we want to emphasize in this example is that the present stress-based topology optimization for multiple materials can be applied in designing geomechanical structures.

@&#CONCLUSIONS@&#
For stress-based topology optimization with multiple materials (STOMM), the separable stress interpolation (SSI) scheme is presented that is one of the main contributions of this research. In the present SSI scheme, the different polynomial functions for the material interpolation and the stress evaluation are devised to resolve the side effect, i.e., converging the design variables assigned to one element altogether ones to satisfy stress bound constraints. For the purpose of the enhancement of the existing regional scheme compromising the advantages and disadvantages of the global stress norm (the p-norm stress), a new aggregation scheme based on the sorting algorithm is also presented; what we want to emphasize here is that the present algorithm is an alternative to the existing sorting algorithms. Furthermore, with the help of the global stress norm, it is possible to efficiently consider the stress values at more than one point per each element, i.e., at Gauss's quadrature points or nodal points. To our opinion based on the estimated stress values of the obtained layouts for multiple materials, it is better to use the stress values at nodal points or Gauss's quadrature points that is due to the stress values at the centers of finite elements average and underestimate the maximum stress value of their stress evaluation points. By considering the stress values at more than one point per element, as expected the estimated stress values become higher and it affects the optimization results. By solving the three benchmark problems (L-bracket problem and cantilever beam) and the tunnel reinforcement problem, the validity and potential of the present STOMM method are investigated. In conclusion, this research solves the stress-based topology optimization with multiple materials for the first time based on a gradient based optimizer.