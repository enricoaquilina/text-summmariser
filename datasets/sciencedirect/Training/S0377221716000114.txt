@&#MAIN-TITLE@&#
Optimal operation of pumped-hydro storage plants with continuous time-varying power prices

@&#HIGHLIGHTS@&#
Efficient operation programs for storage plants in competitive markets are derived in a novel way.Optimal control theory provides consistent framework for plants with large and small reservoirs.Application shows that profit potential for German storage plants decreased 2008–2011.

@&#KEYPHRASES@&#
Pumped-hydro storage,Optimal control theory,Valuation,

@&#ABSTRACT@&#
Pumped-hydro storage plants are increasingly considered as a complement to intermittent renewable energy sources, hence a profound understanding of their underlying economics gains in importance. To this end, we derive efficient operation programs for storage plants which operate in an environment with time-varying but deterministic power prices. Optimal control theory thereby provides a consistent framework for analysis in continuous time, taking into account the different specifics of pumped-hydro setups with large (not restricting) and small (restricting) reservoirs. An empirical illustration discusses storage operation in the German market, showing that the profit potential for storage plants decreased significantly between 2008 and 2011, affecting both large- and small-reservoir plants.

@&#INTRODUCTION@&#
The exploitation of renewable energy sources ranks high on political agendas in order to meet emission reduction commitments and to reduce the dependency on primary energy imports. In contrast to thermal power plants, most renewable energy sources depend on weather conditions and cannot be controlled to keep supply and demand balanced at every point in time. To reconcile intermittent generation with the largely inelastic demand, additional electricity storage plants are therefore taken into consideration in Europe and the United States, with pumped-hydro storage being the dominant technology (BPA, 2010; European Commission, 2011; NERC, 2009). Accordingly, about 15 GW of new pumped-hydro storage plants are currently under construction or in the planning stage (Deane, O Gallachoir, & McKeogh, 2010; Steffen, 2012).In line with the increased commercial interest in storage plants, economic theory emerges to describe efficient setup, dispatch and valuation. Generally, the storage of commodities such as oil can be modeled as inventory management problem: e.g., Secomandi (2010) extends the classical warehouse problem by limiting the reservoir size and the injection/withdrawal capacity; Sourd and Rogerie (2005) discuss continuous reservoirs in a constraint-based scheduling framework. By the physical nature of power markets and the functioning of pumped-hydro storage, though, electricity storage economics are different compared to the storage of oil or other commodities: inventory costs are largely negligible; instead, round-trip losses occur when electric energy is converted into potential energy during pumping and then back to electric energy when the water is released driving turbines. In addition, the need to instantaneously balance supply and demand leads to electricity spot prices that are characterized by a pronounced intra-day and intra-week seasonality, such that the optimal operation given certain shapes of price development over time (i. e. the price curve)22Following power market terminology, we use the term price curve to describe the development of power prices over time—as opposed to a price-volume curve in micro-economic settings where prices depend on the volume delivered.is of particular interest for pumped-hydro storage plants. Finally, the reservoir size restriction is of vital importance for the intra-day operation of small-reservoir-plants. Therefore, a specific literature addresses pumped-storage plants.A first stream of literature on electricity storage plants considers their economics in a system context: A mixed-integer linear programming problem including pumped-storage has been presented by Oliviera, McKee, and Coles (1993), followed by many others (cf. the literature cited by Steffen and Weber, 2011). Taking an analytical approach, Crampes and Moreaux (2010) derive the frontier of efficient storage operation between two periods with high and low demand. Sioshansi (2010) discusses the welfare effect of storage capacity in different ownership setups, and Steffen and Weber (2011) employ a peak-load-pricing framework to derive the cost-efficient storage capacity based on a load duration curve. These models contribute to a fundamental understanding of the trade-offs between different storage setups and utilizations from a system point of view. In practice, though, many electricity markets are liberalized such that individual operators are responsible for power plant investment and dispatch decisions. In those market setups, storage operators optimize their plants against an electricity wholesale price curve, which means that they buy electricity when prices are low and sell it when prices are high (time spread arbitrage). In thermal-dominated power markets, this rationale often translated to the simple rule “pump at night, turbine at noon”; with increasing shares of intermittent generation, however, the optimal dispatch is less obvious.A second stream of literature therefore addresses the optimization of pumped-hydro storage plants from an individual plant perspective, applying stochastic optimization: Thompson, Davison, and Rasmussen (2004) present an algorithm based on real option theory to derive the optimal operation of a pumped-storage plant; a similar model is applied to the German market by Muche (2009). Kim and Powell (2011) and Harsha and Dahleh (2011) derive analytic rules for storage operation for the case in which a storage plant is linked to a renewable plant, and Felix, Woll, and Weber (2012) derive valuation rules for the case that storage plants have the alternative to bid into reserve power markets.33The electricity storage literature also relates to several studies addressing the stochastic valuation of gas storages based on Monte Carlo methods (Boogert & de Jong, 2008), factor price processes (Bjerksund, Stensland, & Vagstad, 2011; Boogert & de Jong, 2011) and recombining trees (Felix & Weber, 2012).These models are all based on wholesale power prices modeled to follow stochastic processes; this allows for a straightforward application for valuation given a spot price model. At the same time, results on optimal storage control reflect the complexity of the stochastic power price models: The basic relationship between the shape of price curves and optimal storage operation is typically not evident. The same is true for empirical studies using a linear optimization problem with storage operation in every hour as separate control variables such as Sioshansi, Denholm, Jenkin, and Weiss (2009).Hence, a third stream of literature addresses the optimal operation of an individual plant given time-varying but deterministic price curves, to explore storage operation rationales along different types of price curves—as will be done in this article. Horsley and Wrobel (2002) rely on a continuous, deterministic price curve and use duality methods of convex programming to derive valuation rules for pumped-storage plants. They focus on the separability of marginal values for pump/turbine capacities on the one hand and the size of the reservoir on the other hand under the strong assumption of perfect round-trip efficiency. Lu, Chow, and Desrochers (2004) develop pumped-storage bidding strategies against a weekly price curve. They apply a multistage looping optimization algorithm to a discrete, deterministic price curve, allowing for round-trip efficiency losses and also considering the possibility to bid into reserve markets. A similar approach is used by Kanakasabapathy and Swarup (2010), who also provide a case study for a storage plant optimizing against NYC region power prices in 2008. From a different angle, Zhao and Davison (2009a) consider sinusoidal time-varying, deterministic prices, and optimize pumped-storage operation in a setup where turbine efficiency depends on the reservoir fill level and chosen flow rate. To this end, a dynamic programming optimization algorithm based on discretized time is presented; the algorithm is also used by Zhao and Davison (2009b), which studies the impact of random inflow into the upper reservoir.This paper extents the understanding of pumped-hydro storage economics using a continuous, deterministic price curve to highlight storage operation rationales along different types of price curves. As compared to Horsley and Wrobel (2002), the presented approach is less technical; instead of the existence of separable margins under most general conditions, this article aims at the derivation of ground rules for storage operation; round-trip losses are a key parameter for such rules and hence must be considered.The main difference to the approach by Lu et al. (2004); Zhao and Davison (2009a); Zhao and Davison (2009b); and Kanakasabapathy and Swarup (2010) is that our focus is to derive optimality conditions in continuous time analytically (as compared to the development of an optimization algorithm in discrete time). We follow the structure of Lu et al. (2004) by differentiating between (unconstrained) large reservoir and (constrained) small reservoir plants—our analytical approach allows for a discussion of optimal operation in terms of shadow prices for pumping and turbining in each case. We also analyze optimization periods longer than one week, which gains in importance with longer-cycle fluctuations for instance of wind power generation.Compared to the sinusoidal price processes used by Zhao and Davison (2009a) and Zhao and Davison (2009b), the optimization approach presented in this paper allows for more general and irregular price curves, a situation which gains in importance if renewable feed-in variations overlay the day/night supply patterns. To allow for closed-form solutions, the model in this article is reduced to the most essential characteristics of pumped-storage plants, neglecting some of the complexities that have been addressed in the literature (such as natural inflows, or reserve markets)—but providing an intuitive understanding of pumped-hydro storage economics in competitive markets.Beyond the theoretical contribution, we present a case study on pumped-hydro economics in Germany. Due to the rapid growth of intermittent renewable energy sources, the extension of storage capacity is postulated time and again by policy makers, but potential investors seem hesitant (Steffen, 2012). The case study highlights why: owing to diminishing price variations, profit from time spread arbitrage decreased by up to 70 percent during 2008–2011; the ‘new reality’ of high PV feed-in around noon can increase the number of storage cycles, but comes with a smaller delta between base and peak prices. This should be considered by policy makers aiming to increase the capacity of merchant storage plants.The analytical discussion of optimal storage operation in this article draws primarily on optimal control theory, which allows to solve continuous-time optimization problems that use control variables as the instrument of optimization. We apply Pontryagin’s Maximum Principle in a reduced form using the following notation:Consider the problemmaxu(t)V=∫0TF(t,x(t),u(t))dts.t.x˙(t)=f(t,x(t),u(t))x(0)=x0u(t)∈U∀t∈[0,T]Here x(t) describes the state of the system at a certain point in time. The state is changed by the control variable u(t) in a way described by the equation of motionx˙(t)=f(.). Define the Hamiltonian asH(t,x(t),u(t),λ(t))=F(t,x(t),u(t))+λ(t)f(t,x(t),u(t))with λ(t) called the costate variable. Then the optimal x*(t) and u*(t) fulfill the following conditions:(1a)u(t)*=argmaxH(t,x*(t),u(t),λ*(t))∀t∈[0,T](1b)λ˙(t)=−∂H(t,x*(t),u*(t),λ(t))∂x(t)(1c)λ(T)=0The transversality condition (1c) requires the costate variable to reach zero at the end of the period (as long as no target value for the state variable is defined). In addition to the maximum principle, this article uses standard nonlinear programming methods to allow for restrictions on the control and state variables.The remaining part of this article is structured as follows: After the optimization problem is described in Sections 2–4 discuss analytical results for storage plants with large and small reservoirs. The method is applied to illustrate storage operation based on historical power prices in Germany in Section 5; Section 6 concludes. Longer proofs and details on the empirical implementation are provided in an appendix.Before setting up the general optimization problem, we briefly describe the characteristics of the price curve and storage technology under study.The analysis takes the point of view of a single storage plant that is optimized against a known price curve P(t) > 0 over the optimization period [0, T]. The price curve is assumed to be continuous—prices in markets where electricity is traded in hourly blocks come close to this idealized assumption.44With increasing shares of intermittent generation, the liquidity in short-term trading is likely to increase (cf. Weber (2010)).We consider the storage plant to be a price taker, which reflects the structure of electricity markets where storage plants are small compared to the overall capacity bidding into the market (for instance, Schill and Kemfert (2011) argue that pumped-hydro storage plants are not a relevant source of market power in Germany).Concerning the chronology of operation, the basic logic of time spread arbitrage is to buy energy during low price periods and to sell it later when prices are high. We therefore assume a strictly monotonic increasing price curve, ∂P(t)/∂t > 0, for t ∈ [0, T] for parts of the discussion, which allows the derivation of basic principles in a lucid way and relates to the two-period models in the literature. In a second step, the analysis is extended to allow for price curves with several ups and down.We consider a pumped-hydro storage plant that is used for the sole purpose of time spread arbitrage. The plant consists of two water reservoirs at different altitudes connected by a penstock. As it is typically the case, the maximum pumping and turbine capacity is equal and given by Ks. Water pumps and turbines are characterized by very short ramp times; for simplicity, we assume that the pumping powers−(t)and the turbining powers+(t)can be changed instantaneously. The signs ofs−(t),s+(t)are defined according to the flows to/from the energy system:s−(t)≤0measures the input into the storage plant,s+(t)≥0the output from the storage plant.The potential energy that is stored in the upper reservoir, x(t) ≥ 0, is measured in energy units. During pumping, energy is transformed from electric to potential energy with an efficiency factor η ∈ (0, 1). We assume that no additional losses occur during turbining, hence η is the round-trip efficiency. The “billing” of all efficiency losses to the pumping side is common practice in the relevant literature (cf. Section 1.1)—it potentially leads to slightly overestimating the profit of reservoir-size restricted plants, as the rising reservoir level might hit the top of the reservoir more often if part of the efficiency losses are “billed” to the turbining phase. However, the effect is negligible in practical settings. Neither evaporation losses from nor natural inflows into the upper reservoir are considered.Concerning the ratio of pumping/turbining capacity Ks[MW] and reservoir size Kx[MWh], two basic types of pumped-hydro storage plants exist: The first type consists of annual storage plants, typically large dams (e.g., in the Alps) that have been built to commercialize the potential energy of snow melt inflows over the course of a year (or several years). In light of increased balancing needs, pumps and additional turbines are added to these existing dams, creating pumped-storage plants that are not limited by reservoir size restrictions in daily operation. The same applies to the much-considered idea to add pumps and turbines to multi-annual reservoirs in Scandinavia (e.g., in schemes linked to the Blåsjø, Møsvatn or Svartevatn lakes in Norway).55For example, the Blåsjø reservoir has a reservoir capacity of 7,800 GWh, which equals the natural inflow over 3 years. Cf. Solvang, Harby, and Killingtveit, 2012 for a list of potential projects, and Moser, 2015 for an assessment of the value of Norwegian pumped-storage flexibility for the European power system.Given that a non-binding reservoir size restriction simplifies the analysis considerably, we discuss the optimization of such “large-reservoir-plants” first in Section 3.The second type of pumped-storage plants are situated in less mountainous regions and typically have an artificial upper reservoir with a very limited storage volume.66For example, the most recently built German pumped-hydro storage plant Goldisthal has a reservoir capacity of 8.5 GWh, which equals 8 full load hours (cf., Bogenrieder, 2002).In this case of “small-reservoir-plants”, the reservoir size Kxis a relevant restriction for daily operation, which will be discussed in Section 4.Assume that the reservoir is filled by x0 ≥ 0 att=0,and let π be the profit over the time period [0, T]. Then the optimal operation of pumps and turbiness−(t),s+(t)is determined by the optimization problem:(2a)maxs−(t),s+(t)π=∫0TP(t)[s+(t)+s−(t)]dt(2b)s.t.x˙(t)=−s+(t)−ηs−(t)(2c)s+(t)∈[0,Ks]∀t∈[0,T](2d)s−(t)∈[−Ks,0]∀t∈[0,T](2e)x(0)=x0(2f)x(T)≥x0(2g)x(t)∈[0,Kx]∀t∈[0,T]The integrand of the objective function (2a) covers the fact that cash flows occur for the purchase of pumping energy and the sales of generation at market prices. The equation of motion (2b) describes the changes to the state variable x(t), while the capacity constraints (2c)–(2d) ensures that the control variables for pumping and turbining power do not exceed the installed capacity. Eq. (2e)–(2f) defines the start and end value for x(t). As we want to study the profit a storage plant can generate by time spread arbitrage within the optimization period, it is required that the fill level at the end of the period does not fall below the starting value (in the optimum, it will always equal the starting value). Finally, the state space constraint (2g) prevents the reservoir from overflowing and covers the physical constraint that the water fill-level must remain non-negative.We start with the optimization of pumped-hydro storage plants with a reservoir sufficiently large such that the reservoir-size restriction is not binding in daily operation.77This is also the type of storage plants considered by Steffen and Weber (2011).We also assume that the reservoir is sufficiently filled at the beginning of the optimization period to prevent the upper basin from running dry, as long as used energy units are restored in the same optimization period (which is always the case if x0 > KsT/2). Note that the following propositions also hold if a natural inflow into the large reservoir is considered.88The natural inflow may be included into the problem by adding a (time-varying) parameter to the right-hand side of Eq. (2b). The natural inflow will lead to a lower threshold price λ (cf. below), but the general properties of the problem remain unchanged.The application of optimization problem (2) without condition (2g) leads to the operation program:Proposition 1The optimal operation of a pumped-storage plant without binding reservoir-size restriction is described by(3)s+(t)*={0P(t)<λKsP(t)≥λs−(t)*={−KsP(t)≤ηλ0P(t)>ηλwhere the threshold prices λ, ηλ are constant over the optimization period.The Hamiltonian corresponding to problem (2) writes as(4)H(s−(t),s+(t),λ(t))=P(t)[s+(t)+s−(t)]+λ(t)[−s+(t)−ηs−(t)]=s+(t)[P(t)−λ(t)]+s−(t)[P(t)−ηλ(t)]By (1a), the optimal operation program has to maximize the Hamiltonian. Given a constant λ,s+*(t)ands−*(t)follow immediately from (4) together with (2c) and (2d), respectively. The constancy of λ is given by (1b):λ˙(t)=−∂H(.)/∂x(t)=0□The optimal operation in case of a monotonic increasing price curve is shown in Fig. 1, along with the corresponding development of the stock variable x(t). Independent of the shape of P(t), a number of ground rules can be observed from Proposition 1: First, the optimal operation program for the pumps and turbines are bang–bang strategies, with the machines either running at full power or resting idle, based on threshold prices. This makes intuitively sense as the role of storage as price taker gives no reason to run at partial load: Either the price is attractive for pumping/turbining or it is not.Second, the threshold price for turbining is constant and equal to the costate variable λ, which can be interpreted as the shadow value of the energy stock in the reservoir. If the price rises above this level, it is efficient to sell the energy to the market. The threshold price for pumping is given by the turbining threshold times the round-trip efficiency.Third, it is evident that ηλ < λ as long as the round-trip efficiency is less than 100 percent, hence the operation of pumps and turbines is mutually exclusive—which also confirms intuition. Between pumping and turbining periods, both machines rest idle.Finally, the threshold prices shed light on the prerequisite for storage operation. Let pminand pmaxdescribe the lowest and highest price in the optimization period [0, T], respectively. The pump is only operated if pmin< ηλ, while for turbine operation it is required that pmax> λ. Together these conditions reformulate to the basic criterion for efficient storage use(5)η>pminpmaxThis criterion for efficient storage usage is intuitive: It is clearly only worth to pump and turbine water if, the cost for buying a unit of power pminis below ηpmax, as only η units “survive” the round trip and can be sold for pmax.To describe the storage operator’s profit from optimal operation (the value of the storage plant over the optimization period), we turn to the case of a monotonic increasing price curve as depicted in Fig. 1. The path fors−(t)*,s+(t)*can then be expressed in terms of the point in time where the plant discontinues to pump water up, τp, and the moment where the plant starts to generate power, τg:(6)s+(t)*={0t<τgKst≥τgs−(t)*={−Kst≤τp0t>τpwhere τgand τpare defined byP(τg)=λandP(τp)=ηλ,respectively. Hence in case of a monotonic increasing price curve, the value of the overall storage plant is(7)π*=∫0TP(t)[s+(t)*+s−(t)*]dt=Ks(∫τgTP(t)dt−∫0τpP(t)dt)The shadow value of pump and turbine capacity can be derived by an explicit inclusion of the control constraints (2c), (2d) into a nonlinear programming formulation:Proposition 2The shadow value of pumping capacity,θ−,and turbine capacity,θ+of a pumped-storage plant without binding reservoir-size restriction is described by(8)θ+(t)*={0P(t)<λP(t)−λP(t)≥λθ−(t)*={ηλ−P(t)P(t)≤ηλ0P(t)>ηλwhere the threshold prices λ, ηλ are constant over the optimization period.The Lagrangian for a maximization of the Hamiltonian (4) subject to the control constraints may be written asL=H(.)+θ+(t)[Ks−s+(t)]+θ−(t)[Ks+s−(t)]For the turbining side of the problem, the Kuhn–Tucker conditions are99For clarity of exposition, we writes+instead ofs+(t),λ instead of λ(t) etc.(9a)∂L∂s+=P(t)−λ−θ+≤0(9b)s+≥0(9c)s+∂L∂s+=0(10a)∂L∂θ+=Ks−s+≥0(10b)θ+≥0(10c)θ+∂L∂θ+=0By (9b),s+can only be positive or zero. Ifs+>0,it is required by (9c) thatP(t)−λ−θ+=0,henceθ+=P(t)−λ. Ifs+=0thenKs−s+>0andθ+has to be zero by (10c). The pumping side of the problem may be solved in a similar manner.□The path ofθ+,θ−is illustrated in Fig. 2. For the pumping period, the shadow value of Ksis the difference between the threshold price for pumping ηλ and the current market price—which is the price spread that an additional MW of pumping capacity could realize in each moment. Likewise, the shadow value of turbining capacity is the amount by which market prices exceed the stock value.For the case of a monotonic increasing price curve, the marginal value of capacity Ksover the optimization period (shaded area in Fig. 2) is given by(11)Θs=ηλτp−∫0τpP(t)dt+∫τgTP(t)dt−(T−τg)λ=∫τgTP(t)dt−∫0τpP(t)dtwhich is equivalent to the derivative of the plant value (Eq. 7) with respect to Ks.While it has been shown that the threshold prices ηλ, λ are constant over the optimization period, their determination requires a specification of P(t). An important special case are optimization intervals during which the price curve can be approximated by a linear function.Proposition 3Assume that P(t) is a strictly monotonic increasing, linear function. Then the threshold prices for turbining and pumping of a pumped-storage plant without binding reservoir-size restriction are given by(12)λ=11+η2pmax+η1+η2pminηλ=η1+η2pmax+η21+η2pminSee A.1.□Hence in case of a linear price curve, the threshold prices for turbining λ and pumping ηλ can be expressed as weighted average of the highest and lowest price during the interval under study with the weighting factors depending on the round-trip efficiency only. Using triangle formulae, a corresponding expression for the marginal value of pumping/turbining capacity can be derived from (11):(13)Θs=(η−pminpmax)(ηpmax−pmin)(T211+η2pmaxpmax−pmin)The first factor expresses by how much the round-trip efficiency exceeds the minimum level from Eq. (5), the second factor is the “usable” price spread and the third factor an adjusted expression for the run time of pump and turbine.In sum, it should be emphasized that while some of the interpretations focused on increasing price curves for illustrative clarity, Propositions 1 and 2 hold also for non-monotonic price curves—for large-reservoir-plants, hence, general rules are available, irrespective of the shape of price curves. This does not hold true for storage plants with small reservoirs, as will be discussed in the next section.The economics of pumped-hydro storage plants with a small reservoir are distinct from those discussed before in that the possibility for the reservoir to run dry (i.e.,x(t)=0) or to reach its maximum fill level (x(t)=Kx) must be considered. Consequently, the chronological order of pumping and turbining is relevant—as before, we therefore start with the analysis of an optimization interval with increasing prices where it is clear that a period of pumping is followed by a turbining period (with some idle time in between).For the case of strictly monotonic increasing prices, i.e. ∂P(t)/∂t > 0 for t ∈ [0, T], the discussion fits well into the optimal control framework. We therefore stick to the formulation of the optimization problem (2), including the state space constraint (2g).Looking at an increasing price curve, restriction (2f) implies that the reservoir fill level will not fall below the start value, hence x(t) ≥ 0 is always fulfilled. To ensure that the reservoir size restriction x(t) ≤ Kxis maintained, we reformulate condition (2g) by requiring that the stock x(t) cannot increase if the reservoir is fully filled:(2g′)x˙(t)≤0wheneverx(t)=KxIn these terms, the operation program can be summarized as follows:Proposition 4Assuming a monotonic increasing price curve, the optimal operation of a pumped-storage plant with reservoir-size restriction is described by(14)s+(t)*={0P(t)<max{λ;λ˜}KsP(t)≥max{λ;λ˜}s−(t)*={−KsP(t)≤min{ηλ;ηλ˜−ηθ¯x}0P(t)>min{ηλ;ηλ˜−ηθ¯x}where λ,λ˜,θ¯xare constant over the optimization period with(15)λ˜=P(τ˜g)(16)θ¯x=λ˜−P(τ˜p)η(17)τ˜g=T−Kx−x0Ks(18)τ˜p=Kx−x0Ks1ηSee A.2.□The optimal operation of a small-reservoir-plant is shown in Fig. 3. If the reservoir-size restriction becomes binding before the price reaches the threshold ηλ, the fill level defines the moment where the pumps are stopped—hence the new threshold price(ηλ˜−ηθ¯x)does not depend on the characteristics of the price curve, but on the point in timeτ˜pwhen the reservoir-size restriction Kxis reached. Unlike large-reservoir-plants, the optimal operation of small-reservoir-plants therefore depends on the pump/turbine capacity Ks: The higher Ks, the smallerτ˜p. Similarly, the threshold price for turbining, is defined byλ˜=P(τ˜g)where(T−τ˜g)is the time required to turbine the energy amount (Kx−x0).Some key results, though, carry over from the discussion above. Independent of the reservoir size, the operation program consists of bang–bang strategies for pumps and turbines with pumping and turbining being mutually exclusive.The marginal value of capacity Ks, Θsis defined as in Eq. (11), where the possibly restricted operation givenτ˜p<τphas to be taken into account. The marginal value of additional reservoir size isΘx=θ¯xwhereθ¯xis as described in (16): A unit of additional reservoir capacity volume allows to sell another energy unit at a price ofλ˜,while accordingly 1/η units have to be procured at a price of(ηλ−ηθ¯x).So far, the discussion of small-reservoir-plants assumed a monotonic increasing price curve. Before considering non-monotonic price curves with several ups and downs, it should be mentioned that—given a positive start value x0—Proposition 4 can be easily adapted to monotonic decreasing price curves, where the binding state space constraint is not x(t) ≤ Kx, but x(t) ≥ 0. The derivation is similar to Proposition 4 and omitted here.Likewise, the analysis easily extents to the case that a target fill-level other than x0 is required: Consider an increasing price curve with condition (2f) changed to x(T) ≥ XT(with XT> x0). Then the hours with the lowest prices [0,τ], whereτ̲=XT−x0ηKsare used to pump the required additional terminal energy amount and optimization problem (2) applies to the remaining time interval [τ, T]. The other way round, a target fill-level XT< x0 is optimally achieved by commercializing the energy amount(xo−XT)in the interval[τ¯,T]withτ¯=x0−XTKsand optimize the remaining interval[0,τ¯]along Proposition 4. The optimization of monotonic intervals with a terminal reservoir content XTother than the start content x0 is an essential part of the optimization in case of non-monotonic price curves as discussed next.The dependence of optimal operation at time t on the fill level—and thereby on historical operation—is an important characteristic of small-reservoir-plants. Consequently, the chronology of operation matters. As discussed above, the order of pumping and turbining periods is evident for intervals with monotonic increasing or decreasing prices. Looking at general price curves, we therefore propose to optimize the storage plant section-wise by dividing the time horizon into intervals Iiduring which prices are either increasing or decreasing. Formally, let {Ii} be consecutive intervals of [0, T] such that(19)∂P(t)∂t≥0∀t∈Iior∂P(t)∂t≤0∀t∈IiHence, the optimization intervals Iiare disjoint subsets of the overall optimization period characterized by their constant direction of slope. If intervals are chosen to be as long as possible, intervals with positive and with negative price slopes alternate.1010Unlike the discussion above, the formulation of the optimization problem in this section does not require the price curve P(t) to be continuous. For discontinuous price curves, consecutive intervals with slope in the same direction are possible in case the interval section coincides with a discontinuity.For each interval Iiit holds true that given a start fill levelXi−1and a terminal fill level Xi, the operation of pumps and turbines is mutually exclusive, and both run either at full capacity or rest idle (cf. Proposition 4). Consequently, the optimal operation within interval Iican be described in terms of τpi, τgi:•For increasing price intervalss−(t)={−KsTi−1<t<Ti−1+τpi0otherwises+(t)={KsTi−1+τgi<t<Ti0otherwiseFor decreasing price intervalss−(t)={−KsTi−1+τpi<t<Ti0otherwises+(t)={KsTi−1<t<Ti−1+τgi0otherwiseThe operation of a pumped-hydro storage plant given a price curve with 3 monotonic intervals is shown in Fig. 4. It should be noted that τpi, τgiare defined within each interval, while the interval termination points Tiare on the timeline of the overall optimization period. The intervals Iican be of different lengthsIi; their operation paths are connected by the fill-level that is handed over from one interval to the next: The terminal fill level Xiof interval Iiequals the start fill level of intervalIi+1. Storage operation is subject to reservoir size-restrictions in each interval—consequently, optimal threshold prices for pumping and turbining possibly vary between the intervals if x(t) reaches its upper or lower bound. As stored energy can be transferred between the intervals, the determination of τpi, τgifor a given interval Iidepends on the price level in other intervals—it might even be optimal to pump or turbine during the whole interval. To determine the optimal operation program, {τpi, τgi} therefore have to be optimized jointly.Letui=1{P(Ti)>P(Ti−1)}indicate whether Iiis an interval with increasing prices (upward slope). Then the optimal operation program of a small-reservoir-plant facing a piecewise-monotonic price curve is determined by the optimization problem(20a)maxτpi,τgiπ=Ks∑i(Pgi−Ppi)withPgi=ui∫Ti−1+τgiTiP(t)dt+(1−ui)∫Ti−1Ti−1+τgiP(t)dtPpi=ui∫Ti−1Ti−1+τpiP(t)dt+(1−ui)∫Ti−1+τpiTiP(t)dt(20b)s.t.τpi,τgi≥0(20c)τpi,τgi≤IiwithIi=Ti−Ti−1(20d)uiτpi≤τgi(20e)(1−ui)τgi≤τpi(20f)X0,XI=x0(20g)Xi=Xi−1+ηKsIpi−KsIgiwithIpi=uiτpi+(1−ui)[Ii−τpi]Igi=ui[Ii−τgi]+(1−ui)τgi(20h)Xi−1+ηKsIpi−(1−ui)KsIgi≤Kx(20i)Xi−1−KsIgi+uiKsηIpi≥0We maximize the sum of cash flows over all intervals, with the operating time of pumps and turbines described in terms of τpiand τgi(for abbreviation, the pumping/turbining time is denoted asIpi/Igi). Constraints (20b)–(20c) limit the pumping/turbining borders to the respective interval, while conditions (20d)–(20e) reflect the requirement that the pumping and turbining periods are disjunct both in increasing and decreasing intervals. The definition of the overall start and terminal value in (20f) is similar to the formulation in problem (2); the new constraint (20g) links the different intervals by transferring the energy stock in the reservoir. Finally, conditions (20h)–(20i) ensure that the reservoir size restriction is maintained.Apparently, the formulation of problem (20) differs from the problems discussed earlier in that it directly optimizes the τpi, τgi, as compared tos(t)−,s(t)+. However, it closely relates to the formulation in Proposition 4: Consider the optimization of a storage plant over a single interval Iiwith monotonic increasing prices (ui=1), for simplicity assume that conditions (20c)–(20d) are satisfied. IfXi−1,Xiare fixed, the optimization of the isolated interval reduces to(21a)maxτpi,τgiπ=Ks(∫Ti−1+τgiTiP(t)dt−∫Ti−1Ti−1+τpiP(t)dt)(21b)s.t.τpi,τgi≥0(21c)Xi=Xi−1+ηKsτpi−Ks[Ii−τgi](21d)Xi−1+ηKsτpi≤KxProposition 5If the optimal solutionsτpi*,τgi*to problem(21)are nonzero, they satisfy the equations(22)P(Ti−1+τgi*)=λiP(Ti−1+τpi*)=ηλi−ηθixwhere λi andθixare the Lagrange multipliers to restrictions(21c)and(21d), respectively. If(21d)is nonbinding,θix=0. If in contrast the reservoir size restriction is binding, it holds true that(23)τpi*=Kx−Xi−1ηKsSee A.3.□Clearly, expressions (22) and (23) relate directly to (14) and (18), underlining that the optimization of monotonic price curves in the last section is a special case of the more general formulation here. Specifically, the threshold price for pumping depends on the price curve-driven shadow value of the reservoir stock as well as on the available space in the reservoir.Extending the optimization from an isolated interval to a set of monotonic intervals, the threshold prices for any two adjacent intervals are related as follows:Proposition 6Consider an increasing price interval Ii followed by a decreasing intervalIi+1. Assuming thatτpi*,τgi*,τpi+1*,τgi+1*are nonzero, it holds true that(24)P(Ti−1+τgi*)=P(Ti+τgi+1*).Likewise, if a decreasing price interval Ijis followed by an increasing intervalIj+1andτpj*,τgj*,τpj+1*,τgj+1*are nonzero, it holds true(25)P(Tj−1+τpj*)=P(Tj+τpj+1*).See A.4.□The case in Eq. (24) describes the optimal operation around a local price maximum, as illustrated in Fig. 4 at the junction of the first and second interval: The threshold price from which on water is turbined in interval 1 equals the price until which turbines are running in interval 2. This makes intuitive sense, as any operation strategy with different threshold prices could be improved by shifting turbining time to the end with the higher threshold price. The same applies for pumping thresholds around a local price minimum (Eq. (25)).Looking at more than two intervals, many different cases are possible concerning the question whether the reservoir size restriction becomes binding in a given interval, which in turn depends on the pumping/turbining strategies in previous intervals. Consequently, general closed-form solutions reach their limits—given a specific price curve, though, problem (20) is easily solved computationally, as demonstrated in the next section.To illustrate the optimization for general price curves, we consider two stylized pumped-hydro storage plants that are operated against historical German power prices. On the EEX/EPEX spot market, electricity is traded in an hourly resolution on the day before delivery—for our illustration, we divide the time span into monotonic intervals (about 50 intervals per week) and construct a continuous-time power price curve by fitting a linear function to each interval. Depending on the shape of the step function of hourly prices, a polynomial of higher degree could fit the observed prices even closer—however, a piecewise-linear fit has the great advantage that problem (20) can be re-formulated as a quadratic optimization problem, as described in detail in Appendix B.To relate to the theoretical discussion, we distinguish between a (sufficiently filled) large-reservoir-plant and a small-reservoir-plant. Both plants are equipped with a pump/turbine capacity ofKs=200MW at a typical round-trip efficiency ofη=80%. While the large-reservoir-plant is not subject to a binding reservoir-size restriction, the small-reservoir-plant can only store up toKx=1,000MWh (i.e., it has a maximum run-time of 5 full load hours). At the beginning of the optimization period, the reservoir is half-full.To start with, we look at power prices from 2008—a year that was characterized by a high variation in intra-day power prices creating favorable market conditions for storage plants (cf. Steffen (2012)). Fig. 5 shows the price curve over three consecutive weekdays in spring 2008 chosen for their illustrative nature. Power prices vary between 14.97 euro and 104.93 euro in a pronounced day-night pattern.For the large-reservoir-plant, the optimal path of reservoir fill level x(t) is given by the blue/dashed curve. During the three-day-period, its maximum is 2724 MWh above its minimum, hence fill level variations clearly exceed the capacity of the small-reservoir-plant. For the large reservoir, plant operation principally follows the day–night-pattern of the price curve, although the duration of pumping and turbining periods varies between days. If the optimal operation is described in terms of threshold prices for generation and pumping (blue/dashed frontiers in Fig. 5), water is turbined at prices starting from 76.28 euro and pumped at prices not exceeding 61.02 euro—which is 80 percent of the turbining frontier, as predicted by Proposition 1.For the small-reservoir-plant, the optimal x(t) is given by the red/solid curve. It is operated in clear-cut day–night cycles which are limited by its reservoir size. Consequently, the fill level oscillates between 0 and Kx, resulting in threshold prices for generation and pumping (red/solid frontiers in Fig. 5) that are set by the fill level (cf. Proposition 4). They are different for each cycle, and depart significantly from the uniform threshold prices in case of a large reservoir.In recent years, additional generation capacity has been added to the German market, both conventional and renewable. Consequently, base-peak spreads decreased significantly. To illustrate storage operation in case of a flatter price curve, Fig. 6 shows the price curve for three weekdays in spring 2011. Prices vary in a comparably narrow corridor between 36.68 € and 77.10 €. In contrast to the 2008 pattern with a clear peak around noon, the 2011 prices reflect the impact of photovoltaics on a sunny day (German PV capacity rose from 6.1 GWpin 2008 to 24.4 GWpin 2011): Power prices peak in the morning, are low around noon and peak again after sunset.This pattern translates lucidly to the optimal path x(t) for the storage plants. There are typically two turbining phases in the morning and in the evening. Especially for the small-reservoir-plant (red/solid curve in Fig. 6), water is also pumped up around noon—hence, optimal fill levels no longer oscillate between full and empty. Due to the flatter price curves and the midday pumping, the small-reservoir-plant is less impacted by its reservoir size restrictions such that threshold prices are close to those of the large-reservoir-plant (red/solid and blue/dashed frontiers in Fig. 6, respectively). Consequently, the small-reservoir-plant can achieve a higher share of the profit realized by the large-reservoir-plant, keeping in mind that the overall profit is much lower compared to the days with wide price variations.Overall, the differences between small- and large-reservoir-plants emerge even more clearly if storage operation is optimized over longer periods. Fig. 7summarizes the annual profits that could be achieved by large- and small-reservoir-plants over the course of a year 2008–2011.1111For computational reasons, both plants are optimized over the course of one quarter (i.e. ca. 650 intervals) and results are added up for each year. Consequently, the profit of large-reservoir-plants are slightly underestimated as arbitrage between the quarters is excluded.The impact of reduced price variations is clearly visible: Profits in 2011 are about two thirds lower than in 2008 for both plant types; the largest descend thereby occurs between 2008 and 2009. The small-reservoir-plant can reach between 56% and 64% of the profit that would be possible without reservoir size restrictions.Consequently, the small-reservoir-plant is significantly less valuable than the large-reservoir-plant, even though it disposes of the same pump/turbine capacity and efficiency. This stems from the fact that the small-reservoir-plant has much less flexibility due to the fact that constraints on minimum and maximum fill levels are often binding, as illustrated for the three-day-period in Figs. 5 and 6. Hence, in the design of new pumped-hydro storage plants, there is a trade-off between the increased flexibility of a larger reservoir, and the additional investment cost related to higher dams (Steffen, 2012). An important driver of those trade-offs is the extent by which reservoir size restrictions potentially hinder plant operation and put the plant idle.The distribution of each year’s time between the different operation modes ‘generation’, ‘pumping’ and ‘idle’ for the years under study is shown in Fig. 8. In line with lower price variations, the large-reservoir-plant is less operated in recent years, with idle time growing from 22% of 2008 up to 40% of the year 2011. In contrast, the operating time of the small-reservoir-plant decreases only slightly. This stems from the fact illustrated by the discussion of daily operation above: Even in 2008, the small-reservoir plant already operated for only a fraction of each price cycle due to its limited reservoir size, so the shortening of price cycles in subsequent years allowed it to run a higher number of cycles. For the small-reservoir-plant, the decreasing profit therefore primarily stems from lower price spreads within each storage cycle.Finally, the optimization approach allows to analyze the threshold prices for pumping and turbining. As discussed, threshold prices vary between storage cycles if the reservoir size restriction is binding, which is the case for the small-reservoir-plant looked at in this section. Fig. 9shows the distribution (CDF) of the maximum price up to which pumps are operated, as well as the tail distribution (CCDF) of minimum prices from which on turbines are running. Between 2008 and 2009, a sharp reduction in threshold prices for both pumping and turbining can be observed, reflecting an overall lower price level. More importantly for storage plants, though, the distribution functions of pumping and turbining thresholds also get closer, hence the average spread that can be commercialized by the small-reservoir-plant is much smaller. In addition, the distribution functions of 2009 thresholds are much steeper than in 2008, which means that the variation in price levels over the year has reduced significantly. From 2009 to 2011, the general price level gradually increases and the threshold distributions become even steeper, although at a lower rate.Interpreting the absolute value of the profit potential, it should be kept in mind that we approximated the hourly price curve by a piecewise-linear function, leading to a slight underestimation of arbitrage gains as the price maxima and minima are reduced from the duration of one hour to a single point in time. At the same time, the modeling based on perfect foresight implies that actual storage operators will not be able to realize all of the profit potential. In any case, though, the empirical analysis clearly illustrates that the model proposed in Section 4.2 can be easily applied. For historical German price data, a sharp reduction of profit potential between 2008 and 2011 has been shown to affect both large- and small-reservoir-plants.

@&#CONCLUSIONS@&#
