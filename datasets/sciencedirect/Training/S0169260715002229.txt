@&#MAIN-TITLE@&#
Assessing interactions among multiple physiological systems during walking outside a laboratory: An Android based gait monitor

@&#HIGHLIGHTS@&#
We developed a smart-phone based gait monitor.The proposed device records several physiological signals simultaneously.ECG, skin conductance, respiration, strides and gait acceleration signals were measured.The devices enable us to understand physiological interactions during walking.

@&#KEYPHRASES@&#
Gait monitoring,Gait accelerometry signals,Stride intervals,Electrocardiogram,Skin conductance,Respiratory rate,

@&#ABSTRACT@&#
Gait function is traditionally assessed using well-lit, unobstructed walkways with minimal distractions. In patients with subclinical physiological abnormalities, these conditions may not provide enough stress on their ability to adapt to walking. The introduction of challenging walking conditions in gait can induce responses in physiological systems in addition to the locomotor system. There is a need for a device that is capable of monitoring multiple physiological systems in various walking conditions. To address this need, an Android-based gait-monitoring device was developed that enabled the recording of a patient's physiological systems during walking. The gait-monitoring device was tested during self-regulated overground walking sessions of fifteen healthy subjects that included 6 females and 9 males aged 18–35 years. The gait-monitoring device measures the patient's stride interval, acceleration, electrocardiogram, skin conductance and respiratory rate. The data is stored on an Android phone and is analyzed offline through the extraction of features in the time, frequency and time–frequency domains. The analysis of the data depicted multisystem physiological interactions during overground walking in healthy subjects. These interactions included locomotion-electrodermal, locomotion-respiratory and cardiolocomotion couplings. The current results depicting strong interactions between the locomotion system and the other considered systems (i.e., electrodermal, respiratory and cardiovascular systems) warrant further investigation into multisystem interactions during walking, particularly in challenging walking conditions with older adults.

@&#INTRODUCTION@&#
Mobility disabilities in older adults is a major factor in the loss of independence and contributes to higher rates of morbidity and mortality [1] and are considered to be a predictor of other disabilities that restrict independent living [2]. Unfortunately, the clinical identification of impaired gait function is not straightforward. The locomotor function and its associated parameters, including gait speed, are traditionally assessed under ideal conditions without distractions in a well-lit, unobstructed walkway. In patients with subclinical physiological abnormalities, these ideal conditions may not provide enough stress on their ability to adapt to walking. A challenging walking environment can provide a more realistic assessment in the early detection of alterations in walking and in the characterization of subclinical physiological abnormalities. Patients walking on challenging environments have previously been used to detect subclinical risk in aging research. Fall risks were predicted more accurately by gait characteristics on irregular and challenging surfaces when compared to smooth and non-challenging surfaces [3]. The fear of falling (FOF) is highly prevalent for all older adults [4,5], and is known to negatively impact gait parameters (e.g., reduced gait velocity or higher stride-length or stride-time variability) [6]. Fear also induces significant change in physiological signals, heart rate and skin conductance, associated with cardiovascular and autonomic control systems (e.g., [7–9]). The interaction between cardiovascular systems, autonomic control systems and their impact on gait function have not been sufficiently quantitatively linked due to the lack of computational methods and instrumentation for the reliable assessment of these systems in real-life scenarios.Prior gait assessment systems have centered on a single transduction method. Analysis of multiple physiological modalities during gait often required interfacing multiple acquisitions systems together [10]. A widely accepted approach for such interfacing is the use of a stationary system that provides gait temporal–spatial parameters. The GaitMat, a typical representative of the stationary system, consists of a long array of pressure sensitive switches that detect foot strikes upon participant ambulation [11]. These systems provide accurate and reliable measures of temporal–spatial gait parameters during free walking but the limited size and the high cost associated with larger mats are a deterrent in the widespread use. VICON is another type of stationary system that captures three-dimensional data of gait through the use of video motion capture systems. These video capture systems can accurately and precisely capture gait kinematics [12] but the systems are expensive and require multiple cameras arrangements that must be calibrated in the constrained volume [13]. Although it is possible to extend a video capture system to larger volumes, the cost of the system would scale with the increase in volume. Due to the limited number of steps that can be taken on these stationary systems, concerns exist about the limited analysis of these systems due to the small window lengths in detrended fluctuation analysis [14].In response to these shortcomings, a number of solutions to gait monitoring have been developed in recent years that aim to assess older adults and patients with walking problems. In addition to these rehabilitation devices, the LOCOMAT [15], active ankle foot orthosis [16] and sensor-embedded shoes have been used to assess the human locomotor function. Examples of this include the ACHILLE system [16], GaitShoe [17], the Intelligent-Shoe [18], and a sensor-embedded shoe measuring ground contact [19]. Devices for the assessment of physiological signals have also been developed that include wrist worn heart rate monitors and wrist worn activity monitors [20]. Additional devices include the FRWD [21], a sport computer that measures heart rate, distance, speed, and altitude, or the SenseWear armband from Bodymedia, a measurement device worn near the biceps [22] capable of measuring skin temperature, galvanic skin response, three-axis accelerations, and heat flux from body. Also, devices such as the Delsys Tringo wireless system have been used to assess electromyography and accelerometry signals during walking (e.g., [23]). Clothing-based physiological monitors such as a LifeShirt from Vivometrics [24], the adiStar Fusion products [25], the VTAMN [26], and the Wealthy measurement system [27] have been developed. Similarly, smartphones have become a popular platform for gait monitoring in recent years (e.g., [28,29]). However, none of the devices have incorporated the interactions between various physiological systems to understand their impact on the locomotor function. Assessing only gait parameters is not sufficient for the early prediction of falls due to a number of factors that cause gait instabilities. By assessing multisystem interactions, we will be able to make early predictions about falls and warn patients about their instability.There is a need for a screening instrument that can accurately detect impaired locomotor function outside of controlled settings. In this paper, an Android-based system is proposed for the simultaneous acquisition of temporal gait parameters including force sensitive resistors (FSR) placed on the heel and forefoot, an electrocardiogram (ECG), electrodermal response (EDR), respiration via a strain gauge transducer, and a tri-axial accelerometer placed on the lumbar region of the spine during ambulation. The proposed system was tested using 15 healthy subjects, and data was collected for verification and preliminary analysis. Our goal was to test the reliability of the system, specifically, to understand whether the system was capable of collecting physiological signals reliably. Therefore, from the data collected and extracted to an external workstation, a number of features, previously considered in other publications, were extracted in time, frequency and time–frequency domains to conduct a preliminary analysis of the interaction between multiple physiological systems and locomotor function.This paper is organized as follows: in the next section, an overview of the data collection system is provided. Section 3 illustrates the data collection procedure with the data analysis steps outlined in Section 4. Our results and discussions are given in Sections 5 and 6, respectively. Finally, conclusions are drawn in Section 7, followed by a list of references.The mobile data collection system is comprised of three main components:•Multiple biosignal transducers attached to the participants with signal conditioning circuitry;A microcontroller unit (MCU) that digitizes each biosensors' output; andAn Android smartphone that receives data from the MCU and stores it for post-processing.A high-level overview of the system concept is shown in Fig. 1. A phablet computer running the Android operating system is used as the hub for receiving the sensor signals and logging the data. The Android device communicates with a MCU via a USB interface. The MCU essentially provides a bridge to collect and multiplex the sensor signals for communication and storage on the Android device. For many of the sensors, custom signal conditioning circuitry was designed to accept and multiplex the analog signals into the MCU.In our particular design, we used a Samsung Galaxy Nexus Android phone to function as the data-logging hub. A Microchip PIC24 (PIC24FJ256GB106) functioned as the MCU. An on-board Hitachi H48C tri-axial accelerometer was connected to the MCU via a serial peripheral interface (SPI) digital bus. The remaining analog transducers were all discrete components external to the MCU and included electrocardiography electrodes, electrodermal activity electrodes, strain gauges, and force sensitive resistors. The final design was realized using a PCB to integrate the discrete components.The remainder of this section describes the implementation of the three major components including the design of the signal conditioning circuitry for the analog transducers, the design of the microcontroller code to accept the input sensor signals and relay them to the Android phablet computer, and the data logging software on the Android phablet computer.As described in Fig. 1, with the exception of the accelerometer whose output is read digitally, the sensors are designed to deliver analog input to the MCU with an attenuation of at least 30dB at the Nyquist frequency (i.e. half the sample rate). All considered sensors are commercially available sensors, and they are typically used in clinical examinations. In this section we describe the peripheral signal conditioning circuitry to allow the signals to effectively interface with the MCU. The analog transducers and accelerometer sampling was performed using time-division multiplexing. We considered first the sampling of analog transducers. As shown in Fig. 2, each sensor was sampled successively at a rate of 949Hz, the sampling duration being 150.5μs for each of them. The accelerometer channels were sampled at a rate of 1kHz, the sampling duration being 250μs for each accelerometer channel as well as a reference voltage measurement required to convert accelerations in g units. Since both transducers and accelerometer channels were sampled successively, the total sample rate is 487Hz.The Hitachi H48C three-axis accelerometer is designed with an anti-aliasing filter, and is connected to a Microchip MCP 3204 12-bit ADC. Samples are retrieved through SPI, a serial protocol, at a rate of 1kHz. The signal is oversampled to ensure that this filter is past the stopband and as such provides an improved noise floor. Force sensitive resistors (FSRs), produced by Interlinx FSR406, are used to measure gait temporal characteristics. The FSRs are placed on the heel and forefoot of the participant. The output of the FSR forms a voltage divider with a 1kΩ resistor, whose output connects to a second order anti-aliasing low-pass filter that attenuates frequencies above 232.15Hz.The electrodermal response (EDR) is measured across two electrodes placed on the index and ring finger. The EDR signal is filtered through a band pass filter with a passband between 0.5 and 1.5Hz [30,31]. The filter helps remove the shifting DC offset and higher frequency noise [30,31]. The reference ground used for the non-measuring electrode has a current limit of 100nA, in an attempt to reduce the risk of electrical shock. The conditioned EDR signal is filtered by a second order, anti-aliasing low-pass filter that attenuates frequencies above 61.17Hz.A piezoelectric respiratory belt, produced by ADInstruments MLT1132, measures the respiration rate during ambulation through the volumetric change of the thoracic cavity. The respiratory signal is bandpass filtered by a voltage mode amplifier whose filter is designed with a passband between 0.13 and 0.5Hz [32,33]. The conditioned respiratory signal is filtered using an anti-aliasing filter that reduces frequencies above 1Hz.A three-lead ECG connected to the patient is measured during ambulation through the use of an instrumentation amplifier with a high common mode rejection ratio. An instrumentation amplifier is required to amplify the microvolt ECG signal. The output of the instrumentation amplifier is cascaded into a filter with a passband between 1 and 150Hz to eliminate potential ADC saturation caused by a floating baseline and higher frequency noise. Lastly, an anti-aliasing filter reduces frequencies above 232.15Hz.The conditioned sensor output is connected to the ADC pins on the PIC24F that transmits the converted data to the Android Phone. The processing unit is powered via a 2000mAh lithium-ion polymer (LiPo) battery, which is capable of an output voltage between 2.5V and 3.7V. The LiPo voltage is regulated to 5V, −5V and 3.3V in order to properly bias the biosensors, the conditioning circuitry and PIC24F. The current draw of the processing unit is approximately 900mA allowing for a continuous run time of 1h and 30min, which is sufficient for the data collection in this paper, but may be too short for more extensive protocols. In the next section we describe the MCU software design to distinguish each sensor input and communicate them to Android device.The embedded software was designed to continuously sample the conditioned biosignals through a 10-bit analog-to-digital converters (ADC) integrated with the PIC24F and through SPI when accelerations were measured. As outlined by the software architecture in Fig. 3, the embedded software consists of several states.The first state taken by the machine is the RESET state, in which timers, the 10-bit ADC and the modules required to communicate with the accelerometer are reset. Next, the machine enters immediately the IDLE state. In this one, the program waits for the smartphone to be connected to the processing unit. Once the former is attached, the machine enters the WAITING state, during which the processing unit waits for the phone to send a command. The latter consists of a single character x. If the phablet is detached, the program goes back to the IDLE state. Otherwise, the program enters the MEASUREMENT pseudo-state, composed of a SAMPLING state in which the wearable device samples data, and a DATA TRANSFER state, where data is transferred to the smartphone.In the SAMPLING state, the device samples data and stores it in a transfer buffer that is later sent to the Android phone. The microcontroller alternates between the analog transducers and the accelerations sampling. Two interrupt service routines (ISR) are triggered in each case. ISRs are executed when special events are detected by the microcontroller. For our processing unit, the first routine is executed when all of the analog transducers have been sampled. Every sample is associated to a channel so as to identify the origin of the measurement, and is placed into the transfer buffer mentioned earlier. The second ISR is designed to generate the signals required to retrieve data from the accelerometer. The data received from the SPI of the accelerometer is stored in the transfer buffer as well.An arbitrary design choice was to limit the number of samples the transfer buffer can hold to 32 samples. Once this buffer is full, the program switches to the DATA TRANSFER state, during which the collected samples are transmitted to the smartphone as it provides a larger data storage capacity. A Microchip supplied Android USB Accessory Stack was used to allow the PIC24F to do so. ISRs can still be triggered during the DATA TRANSFER state. As a result, the data sampling does not stop even if the microcontroller is considered to be in a transfer state. Since the transfer buffer is full, another sample buffer, that is able to contain up to 1024 samples, stores measurements in the meantime. Before switching back to the SAMPLING state, the content of the sample buffer is moved to the the transfer buffer until the latter becomes full again.The program alternates between the SAMPLING and the DATA TRANSFER states until either the phone sends a command (a single character s) that stops the sampling process, the phone is disconnected from the processing unit, or an overflow of the large sample buffer occurs. In that case, the program enters the CLOSING state: data sampling is stopped, and samples remaining in the buffers are transmitted to the phone if it is still attached. The program then enters the RESET state again.As it can be seen in Fig. 4, a field in an Android application allows one to specify the amount of time during which the device attached to the smartphone should perform measurements. Data sampling will stop automatically after the specified duration. Below, the list of connected USB devices is displayed, although Fig. 4 only shows an empty list since no devices were connected when the screenshot was taken. Finally, pressing the button under the list starts or stops data sampling.The application uses the Accessory mode so as to exchange data with the processing unit. The Android operating system (OS) provides abstraction layers which allow one to receive data sent by the processing unit, by merely reading a file. In order to keep the user interface responsive, the Android application creates a background service that polls the phone's USB receive buffers and stores the sampled data onto the phone's internal storage. The application keeps track of the service status, and updates the user interface accordingly. To avoid buffer overruns on the Smartphone CPU, the custom Android Application requests a CPU Wake Lock for the Android OS. A CPU Wake Lock prevents the Android OS from entering a low-power state.The study was approved by the University of Pittsburgh's Institutional Review Board. Data was collected from 15 healthy participants (6 females, 9 males; 1.76±0.11m; 68.3±9.68kg; 20.2±1.90 years; BMI: 22.1±2.23). The participants were screened prior to testing for neurological and physiological conditions that would affect their gait. The anthropometric measures of height, weight, age and gender were obtained from the participants prior to the experiment. After consenting to the study, participants were fitted with the device around the lumbar region, in order to position the accelerometer near the center-of-mass as suggested in previous studies (e.g., [34,35]). Following the sensor fitting step, participants performed two, 15-min walking sessions around a closed corridor with a 10-min break in-between. The placement of the Processing Unit was chosen to facilitate the collection of accelerometer signals for the exploration of non-linear stability analysis. During each session, the participant was instructed to focus strictly on the ambulation through the closed corridor. An investigator followed the participant and recorded any external stimuli that may have affected the gait. The investigator maintained a safe distance, approximately 35ft, behind the participant so as not to modulate the participant's stride interval with the sound of periodic footfall [36]. No other external pacers were used in the study, but also no sources of pacing were noticed during walking. Participants were asked to wear comfortable footwear (e.g., running shoes). Sensor placements used in this study is shown in Fig. 5.Although analog signal conditioning had greatly narrowed the frequency characteristics of the signals, various disturbances and noise were still present within the signals. To alleviate these issues, the collected data was pre-processed prior to further analysis. Some signals, such as the force sensitive resistors, required pre-processing in order to obtain relevant time series.Stride interval time series: The purpose of the FSRs is to provide information concerning the stride interval time series from the heel impact and toe impact on each foot. We used a stride interval extraction algorithm proposed in [37], which is based on initially identifying potential strides, and then using probabilistic modeling and post-extraction filtering to determine stride interval time series from force sensitive resistor data. Stride intervals that were physiologically long or short (i.e., falling outside 0.01% and 99.99% of a gamma distribution fit) were removed. Ultimately, the average number of stride intervals across all participants per session was equal to 783 strides.Heart rate variability (HRV): During the participant sessions, the ECG signal often exhibited motion artifacts [38,39]. To alleviate the presence of these artifacts, a 15th-order low-pass Butterworth filter with the cut-off frequency equal to 40Hz followed by a 23rd-order high-pass Butterworth filter with cutoff frequency equal to 1Hz [40] was implemented. To extract the heart rate variability (HRV), we utilized a wavelet based algorithm to extract R peaks from ECG recordings [41]. We subsequently eliminated points that fell outside 5% and 95% of a gamma distribution fit, considering these peaks as physiologically not relevant.Respiratory rate (RR): To recover the respiratory rate from conditioned signals acquired, we first utilized an 18th-order low-pass Butterworth filter with the cut-off frequency equal to 1.5Hz [42]. Using the filtered signal, we found subsequent local maximal points under the following constraints: (a) successive points should be at least separated by 1s; and (b) the detected maximal points should be greater than half of the standard deviation value of the filtered signal. These two constraints eliminate the detection of physiologically irrelevant points.Electrodermal reactivity (EDR): To isolate the phasic response of the electrodermal reactivity signals, we utilized an 86th-order low-pass Butterworth filter with the cut-off frequency equal to 1.51Hz followed by a 6th-order high-pass Butterworth filter with the cut-off frequency equal to 0.02Hz [43,44].The main purpose of the proposed system is to infer about various physiological systems during walking and the interactions among these systems. In order to do so, the proposed system should be able to extract certain features from each considered physiological system, and relate them to other features to infer about the walking condition of each person. As a preliminary step, we processed these signals offline, and in here, we extract features considered in previous contributions dealing with each of the considered physiological systems (e.g., [45–52]). Not all features are not considered for all acquired signals, and presented results will make evident the considered features for each type of signals.Assuming that a signal, x(n), is represented by a set of N values, then using those values typical statistical features such as mean (μx), standard deviation (σx), the coefficient of variation (ξx), kurtosis (γx) can be calculated [53]. To assess the similarity between time structures of two signals, x(n) and y(n), we utilized the cross-correlation coefficient, CCx−y, at the zeroth lag [53]. Variants of these statistical measures were further adopted to heart rate variability time series. Here, we considered SDNN, RMSSD, NN50, PNN50 which are typical statistical features used in the analysis of the HRV time series. For a thorough description of these variables, one should refer to [45,46]. Here, we will only provide brief definitions of them. If we consider NN intervals (the so-called normal-to-normal intervals, that is, intervals between adjacent QRS complexes), then SDNN is defined as the standard deviation of NN intervals [45]. RMSSD is the square root of the mean squared differences of successive NN intervals [45]. NN50 is defined as the number of successive NN intervals greater than 50ms [45]. PNN50 equals the number of NN50 divided by the total number of NN intervals [45].Stride interval dynamics incorporate temporal information into the analysis of the stride interval time series and reveals statistical persistence. Here, we utilized the spectral exponent, β, to characterize the stride interval dynamics as described in [49]. β=0 indicates random, uncorrelated behavior (e.g. white Gaussian noise). β=1 denotes a 1/f process, while β=2 indicates a Brownian process [54]. It should be pointed that β was also used in the analysis of heart rate time series [55] and respiratory rate time series [56].In this paper, we also considered various information-theoretic features [47,48,50]. The Lempel–Ziv complexity (LZC) measures the predictability of the signal [50,57]. The entropy rate (ρ) measure quantifies the extent of regularity in a signal [48]. A variant of the entropy rate known as the sample entropy (SampEn) is often used in the analysis of HRV time series [51,52]. Extending the entropy rate measure, the cross-entropy rate, ΛX∣Y, quantifies the entropy rate between two stochastic processes [47]. This measure describes the predictability of a data point in one signal given a sequence of current and past data points in the other signal.When considering features in the frequency domain, we considered the following three features [58]: the peak frequency, fp, the spectral centroid,fˆ, and the bandwidth, BW. Variants of these features known as very low frequency (VLF), low frequency (LF) and high frequency (HF) were also applied to the HRV time series [45].Lastly, we considered a typically used time–frequency feature such as the wavelet entropy, Ω, for the analysis of acquired biomedical signals [59,60].We used paired samples t-tests to examine whether there are any systematic differences between sessions in gait, skin conductance, respiration and heart rate measures; and used intraclass correlation coefficients (ICC) to quantify test–retest reliability between sessions. Next, we fit a series of multivariable linear mixed models using data from both sessions, with each measure as the dependent variable; sex, age, height and weight (simultaneously) as independent variables of interest; and a participant random effect to account for the correlation between sessions in the measurements from the same participant. We repeated modeling with BMI instead of height and weight. Associations were quantified as fixed effect regression coefficients corresponding to gender differences, and rates per unit for age (years), height (cm), weight (kg) and BMI (kg/m2). To account for the large number of features considered, and the resulting number of hypothesis tests, we used false discovery rate methodology [61] to make multiplicity corrections to our p-values. Finally, using means across sessions, we computed Pearson correlation coefficients between gait features and other measures of skin conductance, respiration and heart rate. We used SAS version 9.3 (SAS Institute, Inc., Cary, NC) for all statistical analyses.

@&#CONCLUSIONS@&#
