@&#MAIN-TITLE@&#
Operations research models for coalition structure in collaborative logistics

@&#HIGHLIGHTS@&#
MIP models are proposed to decide coalition structure in cooperative games.The models are tested in forest transportation and in inventory for oil operations.Results show a stable structure under strong equilibrium may become infeasible.Maximum cardinality bound on coalitions has important effects in the structure.Savings of adding one more player significantly decrease with the cardinality bound.

@&#KEYPHRASES@&#
Game theory,Group decisions and negotiations,Collaborative logistics,Forest transportation,Inventory sharing,

@&#ABSTRACT@&#
Given a set of players and the cost of each possible coalition, the question we address is which coalitions should be formed. We formulate mixed integer linear programming models for this problem, considering core stability and strong equilibrium. The objective function looks for minimizing the total cost allocated among the players. Concerned about the difficulties of managing large coalitions in practice, we also study the effect of a maximum cardinality constraint per coalition. We test the models in two applications. One is in collaborative forest transportation and the other one in inventory of spare parts for oil operations. In these situations, collaboration opportunities involving significant savings exist, but for several reasons, it may be better to group the players in different sub-coalitions rather than in the grand coalition. The models we propose are thus relevant for deciding how to partition the set of players. We also prove that if the strong equilibrium model is feasible, its optimal cost is equal to the optimal cost of the core stability model and, consequently, a coalition structure that solves one problem also solves the other problem. We present results that illustrate this property. We also present results where the core stability problem is feasible and the strong equilibrium problem is infeasible. Setting an upper bound on the maximum cardinality of the coalitions, allows us to study the marginal savings of enlarging the cardinality of the coalitions. We find that the marginal savings of allowing one more player significantly decreases as the bound increases.

@&#INTRODUCTION@&#
Collaboration among different agents is an effective way to improve logistic operations. Evidence has been provided in many industries. For instance, Nagarajan and Sŏsić (2009) and Nagarajan and Bassok (2008) refer to a variety of contexts where different suppliers create coalitions to achieve the benefits of collaboration, including complementary component-suppliers for car assembly systems, the health-care industry and various service sectors. Other examples arise in inventory management (Chen, 2009; Özen, Fransoo, Norde, & Slikker, 2008) and transport (Frisk, Göthe-Lundgren, Jörnsten, & Rönnqvist, 2010; Lozano, Moreno, Adenso-Díaz, & Algaba, 2013). In order to implement collaboration, there needs to be an agreement among the agents with respect to how to share the benefits. A growing body of literature in Operations Research and Management Science has applied principles of cooperative game theory to resolve this sharing issue. One of the main streams in this literature aims at defining allocation rules to predict or prescribe how rational players will distribute the gains they obtain from cooperation, assuming in general that the grand coalition will be formed, in line with the classical approach to transferable utility games (Meca-Martínez, Sánchez-Soriano, García-Jurando, & Tijs, 1998). The formation of the grand coalition may find support in the assumption of superadditive games, i.e., where the value of a coalition is at least as good as the sum of the values of its members acting separately. This would mean that the more agents collaborate, the better is the outcome they achieve (or at least “not worse” than if only some of them or none of them collaborate). In practice, however, several reasons might exist for the grand coalition not to be formed. Some of these reasons, for example, are the managerial complexity of conforming large coalitions and the political issues that can affect the decision of changing from a non-collaborative to a collaborative solution. For example, in transport operations, collaboration usually involves just a few partners, because as the number of partners grows coordinating the cooperation becomes more problematic and/or costly (Lozano et al., 2013). Then, given a set of players and the cost of each possible coalition, the relevant question arises of which coalitions should be formed. The formed coalitions define a partition of the set of players, which in game theory is called a coalition structure (Aumann & Dreze, 1974). In contrast to a vast body of game theory literature dealing with coalition structure and coalition formation issues (see e.g. Greenberg, 1994), the OR/MS literature is more sparse in this stream. Some of the exceptions addressing issues related to coalition structures in OR are Axelrod, Mitchell, Thomas, Bennett, and Bruderer (1995), Leng and Parlar (2009), Nagarajan and Sŏsić (2009) and Sŏsić (2006, 2010). Other recent works have acknowledged the relevance of the coalition structure issues, although without addressing them (Chen, 2009; Kim & Jeon, 2009; Lozano et al., 2013).In this article, we propose mixed integer linear programming formulations to simultaneously approach the coalition structure and cost allocation problems. Our formulations aim at deciding which coalitions should be formed and the cost allocation to the players in each of them, subject to stability conditions. These stability conditions are of two types. First, we formulate constraints to model internal stability, i.e., the core constraints for the members within a coalition. Second, we formulate constraints to model the strong stability, i.e., where no group of players, whether from the same coalition or from different ones, can get together and form new coalition(s) in such a way that they are all better off (Aumann, 1959; Hart & Kurz, 1983). Concerned about the complications of implementing large coalitions in practical situations, we also incorporate conditions on the maximum number of players that can form a coalition. We test our models in two applications. The first is a collaborative forest transportation problem presented by Frisk et al. (2010), which includes eight companies operating in Sweden. As the companies operate in similar regions, the opportunities for collaborative transportation represent important savings, in the range 5–15%. The second is a problem on collaboration in inventory of spare parts for oil operations, where risk pooling represents an important source of savings of about 20% of the inventory costs (Guajardo, Rönnqvist, Halvorsen, & Kallevik, 2014).Our work contributes in both practical and theoretical aspects. In the practical aspects, we approach two cases motivated in forestry and oil operations, where collaboration in transport and inventory operations improve the non-cooperative case. Since we do not assume any particular form of the cost functions, the potential for applications may also be extended to other industries using collaborative logistics. In the theoretic aspects, we introduce model formulations for a relevant problem in the interface of Game Theory and Operations Research. The models consist of a set partitioning problem subject to stability constraints. Because of the combinatorial structure of this problem and its relevance in theory and practice, we believe our work opens a rich source of challenges where OR solution methods can play an important role.The remainder of this article is organized as follows. In Section 2, we summarize concepts of stability in cooperative games. In Section 3, we formulate models for coalition structure and cost allocation. In Section 4, we apply the models in collaborative problems in the forestry and oil industries, and also discuss its applicability in larger scale problems. Our conclusions are presented in Section 5.A growing body of literature has incorporated concepts from cooperative game theory in collaborative logistics. Fiestras-Janeiro, García-Jurado, Meca, and Mosquera (2011) review a number of references on collaborative inventory management. In other areas of operations management, however, the use of cooperative game theory is much less prevalent (Hu, Caldentey, & Vulcano, 2013). In the following, we introduce some notation and summarize the concepts on stability in cooperative games that are relevant for our article.We consider a game consisting of a set of players N. We refer to the cardinality of this set byn=|N|. Players can form coalitions, in order to take advantage of collaboration opportunities. The set N is the grand coalition. We refer byCZto the cost incurred by coalition Z, whereZ⊆N. We assumeCZ⩾0for all Z. The cost function C is called the characteristic function of the game. We refer byujto the cost allocated to player j, for each playerj∈N. We assumeuj⩾0for all j. A cost allocation vectoru=(u1,u2,…,un)is said to be in the core of the game (Gillies, 1959) if it satisfies the following constraints:(1)∑j∈Zuj⩽CZ∀Z⊂N(2)∑j∈Nuj=CNConstraints (1) correspond to the rationality conditions, which state that there is no subset Z of players such that should they form a coalition separately from the rest they would perceive less total cost than the total cost allocated to them in u. In the case of Z containing only one player, the constraint corresponds to the individually rational condition, which states that the cost allocated to each player j must not be greater than its stand-alone cost. Constraint (2) corresponds to the efficiency condition, which states that the sum of the costs allocated to all the players must be equal to the optimal expected cost of the grand coalition. The core of the game is the set of all vectors u satisfying constraints (1) and (2). An allocation that belongs to the core is said to be stable. In order to differentiate this type of stability from a following concept, we will refer to it as core stability.As mentioned in the introduction, several reasons might exist for the grand coalition not to be formed. Therefore, it becomes relevant to study the stability of cooperative situations where different group of players may form different coalitions. The formed coalitions define what in game theory is called a coalition structure (Aumann & Dreze, 1974). Following the notation of Sŏsić (2006), a coalition structure£is a partition on N, that is,£={Z1,…,Zr},⋃i=1rZi=N,Zi∩Zj=∅,i≠j.We assume the cost of all coalitions are given parameters. This in practice does not necessarily mean that the costs and the information needed to compute them are known by all the players, but it is enough if there would be a decision maker who could gather this information. Then, this decision maker needs to find the coalitions that should be formed, aiming at minimizing the total allocated cost while satisfying the constraints. In the two cases that primarily motivated our work, this decision maker emerges in two different ways. In the forestry case, there is a consulting team that gathers the information from the companies and conduces the analysis, in order to come up with a suggestion on how to implement the collaboration among the companies. It is crucial that this third party manages the information under confidentiality, since part of the information is sensitive to the companies. In fact, this has been the only viable way for them to provide the information. The third party also needs to be impartial and, therefore, the minimization of total cost is an appropriate overall objective when making the suggestion on how to implement the collaboration. This objective is also convenient from an environmental point of view, as usually the savings in transportation cost are associated to a reduction of emissions from the trucks. In the oil case, the suggestion is made by a main company which has the operational responsibility for all the warehouses that hold inventory of spare parts, despite some different ownership structures involving other companies and stakeholders. The data from all these warehouses are managed in the same enterprise resource planning system SAP. The operational responsible acts with impartiality and a cost efficient criterion, therefore the solution is also driven by an overall cost minimization objective.Although in both cases all players are willing to conform to the suggested coalitions, we would like to prevent deviations that can affect the stability of the coalition structure. We quote Hart and Kurz (1983) to emphasize that “forming a coalition does not eliminate the individual players as decision makers. In all interactions with the other players, coalition members act as one unit (it may be useful to think of a ‘representative agent’ taking their place); however, this arrangement will continue only as long as each player finds it desirable to act this way”. For this purpose, they refer to the notion of strong equilibrium introduced by Aumann (1959). This refers not only to the stability within the formed coalitions, but also in the whole structure, so that for all players there would be no incentives to form a coalition that is not contained in the structure. For example, let us assume a structure£contains coalitionsZ1andZ2. The coalition structure£together with a cost allocation vector u is not strongly stable if coalitionsk1⊆Z1andk2⊆Z2exist such that the sum of the costs allocated to the players ink1∪k2is greater than the costCk1∪k2.Given the set of players N, the cost parameter valuesCZfor all coalitions and a positive integer m, we are interested in two version of the coalition structure problem: the core stability problem and the strong stability problem. The first one consists of finding a coalition structure£={Z1,…,Zr}and a cost allocationu=(u1,…,un)such that:(i) the maximum cardinality per coalition constraint is satisfied, i.e.,|Z|⩽m∀Z∈£;(ii) the core stability constraints are satisfied within each Z, i.e.,∑j∈Z‾uj⩽CZ‾∀Z‾⊂Z,Z∈£and∑j∈Zuj=CZ∀Z∈£;(iii) the cost of the structure,C(£)=∑i=1rCZi, is the minimum cost that can be achieved by a structure that satisfies conditions (i) and (ii).The strong stability problem is the same as the first problem, but it also requires that the coalition structure£together with the cost allocation vector u satisfies for all coalition Z (|Z|⩽m) not contained in£the condition∑j∈Zuj⩽CZ. The set of solutions(£,u)to this strong stability problem composes the core of a game in the coalition structure sense defined by Aumann and Dreze (1974).To our knowledge, no general optimization model has been proposed for these problems. The few works in OR/MS addressing related issues have rather focused in more particular settings. Also, they have adopted a predictive perspective on how the agents will group rather than a decision making perspective on how the agents should group. Such predictive perspective is presented by Axelrod et al. (1995), in a setting of alliances forming to develop and sponsor technical standards. Nagarajan and Sŏsić (2009) focus on a dynamic setting where different suppliers can create alliances for selling components to an assembler. They assume the coalition members divide the profit equally, unlike our case where the allocations are decision variables of the problem and, therefore, may differ from one to another member. Sŏsić (2006, 2010) incorporates the notion of farsighted stability, proposed by Chwe (1994), in an inventory sharing setting and in an information sharing setting firstly approached by Leng and Parlar (2009). In the dynamic of these games, the outcomes are described by a set of possibilities within several time periods and the relevant information is common knowledge for all players. In contrast, we focus on single-period games with side payments, i.e., where the outcome to a coalition can be captured by just one real number, namely the characteristic function (Kaneko & Wooders, 2004), and this function is not necessarily known by all the players.In the following, we formulate mixed integer programming models for the core stability and the strong stability versions of the coalition structure problem. First, let us introduce the notation on sets, parameters and decision variables.SetsN: set of players.K: set of coalitions.ParametersCk: Total cost of coalition k.αj,k=1ifplayerjbelongstocoalitionk0∼βk¯,k=1ifcoalitionk¯isasub-coalitionofcoalitionk(i.e.,allplayersink¯belongtok)0∼Variablesxk=1ifcoalitionkisformed0∼uj,k: Cost allocated to player j in coalition k.The following mixed integer linear programming model looks for a structure£such that all coalitionsk∈£are stable and the total allocated cost is minimized.Objective function(3)min∑j∈N∑k∈Kuj,kConstraints(4)∑j∈Nαj,k¯·uj,k⩽Ck¯·xk∀k¯,k∈K:βk¯,k=1(5)∑j∈Nαj,k·uj,k=Ck·xk∀k∈K(6)∑k∈Kαj,k·xk=1∀j∈N(7)xk∈{0,1},uj,k⩾0∀j∈N,k∈KWe refer to this model by M1. Objective function (3) minimizes the total allocated cost among the players. Constraints (4) correspond to the rationality conditions, which state that in the resulting coalition structure there is no set of playersk¯⊂ksuch that should they form a coalition separately from the rest they would perceive less total cost than the total cost allocated to them in the allocation u. Constraints (5) correspond to the efficiency condition, which states that the sum of the costs allocated to all the players in a formed coalition equals the optimal cost of such coalition. Constraints (6) state that each player is assigned to one and only one coalition, thus the solution to the model, if such exists, defines a partition of set N. Constraints (7) state the binary nature of variables x and the non-negativity of variables u.Note that constraints (4) and (5) recover the stability and efficiency constraints (1) and (2) for any coalition k such thatxk=1, so that they provide the allocationsuj,kare core-stable within each formed coalition k. Since the objective function minimizes the total allocated cost, the optimal value of variableuj,kis zero for all(j,k)such that coalition k is not formed and also for all(j,k)such that player j does not belong to coalition k.Model M1 is a mixed integer programming model that solves a set partitioning problem, subject to the stability constraints. A solution to this model exists (in the worst case where collaboration does not achieve any savings, the structure of all players standing alone is stable). If we knew beforehand that the core of each coalition (or at least the core of each of those coalitions that minimize cost) is not empty, an equivalent approach to solve the problem could be given by the following two-stages procedures. In the first stage, a pure set partitioning problem is solved, for instance, through an integer programming model in the binary variablesxk, defined by the objective functionmin∑k∈KCkxksubject to constraints (6). In the second stage, a stable allocation must be determined for each coalition k such that in the optimal solution to the set partitioning modelxk∗=1. However, the information on the non-emptiness of the core in our setting is not known beforehand, since we do not make any related assumption on the cost parameter valuesCZ. That is why it is important to consider the coalition structure and the cost allocation problems simultaneously in the same model. Then, if a solution (£,u) to this model is found, it assures the cost allocation vector u satisfies the stability conditions within each coalition in the structure£. Then, the implementation of the structure could re-allocate the cost within each formed coalition through any other desirable allocation rule.The coalition structure resulting from model M1 assures that players from the same coalition that is formed have no incentives to deviate and create their own coalition. However, the structure does not assure that players who belong to different coalitions have no incentive to conform a new coalition. This needs incorporating the notion of strong equilibrium, in order to assure not only stability within the formed coalitions, but also in the whole structure, so that for players who were assigned to different coalitions there would be no incentives to form a different coalition. We formulate a mixed integer linear programming model for this problem in a similar way to model M1, maintaining objective function (3) and constraints (5)–(7), but replacing constraints (4) by the following constraints:(8)∑j∈Nαj,k·∑k¯∈Kuj,k¯⩽Ck∀k∈K.We refer to this model by M2. Constraints (8) correspond to a strong stability condition, assuring that no players, either from the same or different coalitions in the structure, have incentive to form their own coalition. Notice∑k¯∈Kuj,k¯is the actual allocation to player j in the coalition it will belong to. In fact, for all the other coalitions, its costuj,kwill be zero because of the objective function (using another objective function may require addition of the following constraint to assure that:uj,k⩽L·xk∀j∈N,k∈K, where L is a sufficiently large number). Then, the sum∑j∈N(αj,k·∑k¯∈Kuj,k¯)represents the sum of all costs allocated to players of coalition k. For the structure to be strongly stable, we need this sum to be less than or equal toCk, for allk∈K, even if coalition k is not formed.Concerned about the complications of managing large coalitions in real-world situations, an interesting question is how to structure the players in sub-coalitions such that a maximum cardinality constraint is satisfied. That is, each structured coalition must contain at most m players, where m is a positive integer parameter that represents the maximum number of players allowed in each coalition. The size of a coalition has been identified by D’Amours and Rönnqvist (2010) as an important aspect in collaborative logistics. In practice, the upper bound on the coalitions’ size might be motivated for several reasons. For example, Lozano et al. (2013) point out that although transportation costs are always reduced through collaboration, as the number of partners grows coordinating the cooperation becomes more problematic and/or costly, which is one of the reasons why in practice cooperation in transport usually involves just a few partners. Other reasons are argued by Stein (2010), who remarks that the formation of coalitions might be restricted due to structural issues, laws and culture ideology. He refers to some other references in restrictive cooperative game theory (so called “network games”), and remarks that although some of them date from early times, the literature in this field is still sparse and fragmentary. As another reason, in one of the cases that primarily motivated our work, we have observed that managers are subject to some political issues which do not allow the implementation of a grand coalition, but only of smaller sub-coalitions. For example, in our inventory management case, it might be clear that because of the risk pooling effect, a completely centralized solution performs better in terms of costs than the decentralized solution where there is no collaboration. However, in order to change a previously implemented decentralized solution, the managers’ decision needs to consider that a centralized solution would perhaps need significantly less staff. In some organizations this might involve some difficult issues.In general, all these reasons affecting the maximum cardinality of a coalition may not be easy to reflect in the cost functions. Therefore, it becomes relevant to analyze the coalition structure problem subject to a maximum cardinality constraint. An obvious alternative to incorporating this condition in models M1 an M2 is to simply re-define the set K including only coalitions of cardinality less than or equal to m (or just to setxk=0∀k:Sk>m, whereSkis a parameter indicating the cardinality of coalition k). For an upper bound m, we will refer byfmandf¯mto the optimal objective value of models M1 and M2, respectively.Note that the coalition structure problem subject to the maximum cardinality constraint presents similarities with k-partitioning problems, which arise in multiprocessor scheduling of jobs on machines at minimum makespan (Babel, Kellerer, & Kotov, 1998, Kellerer and Kotov, 2011). These problems also look for a partition into subsets subject to a cardinality limit. However, while in k-partitioning problems the weight (processing time or cost) depends only on the item and not in the subset (machine) it is assigned to, in the coalition structure problem the cost is associated to the subset rather than the sum of the costs of its members. Also, the coalition structure problem includes the stability constraints and the allocation variables which do not appear in k-partitioning problems.In the following, we present a proposition that relates the solutions of models M1 and M2.Proposition 1If the strongly stable coalition structure model (M2) is feasible, then its optimal objective value is equal to the optimal objective value of the core-stable coalition structure model (M1). Likewise, if model M2 is feasible, a coalition structure that solves any of the two models, also solves the other model.This relationship between the solutions to the two models is fairly intuitive because the strong stability condition is more restrictive than the core stability condition. In fact, since constraint (8) must hold for allk∈K, in particular it must hold for anyk¯for which constraint (4) is formulated. This gives the inequality∑j∈Nαj,k¯·∑kˆ∈Kuj,kˆ⩽Ck¯. Sinceuj,k=0for all j and k such thatxk=0, then the left-hand side of this inequality is equal to∑j∈Nαj,k¯·uj,k, where k is such thatxk=1. Then, it follows that if a coalition structure together with a cost allocation vector satisfies constraints (8), then it also satisfies constraints (4). Since all the other constraints and the objective function are the same in both models, the optimal objective valuef¯∗in M2, if such exists, cannot be lower than the optimal objective valuef∗in M1. This proves thatf∗⩽f¯∗. Now, to prove the equality, let us argue by contradiction. Let(£,u)be an optimal solution to model M1 and(£¯,u¯)an optimal solution to model M2. Then,f∗=∑j∈N∑k∈Kuj,k=∑Z∈£CZandf¯∗=∑j∈N∑k∈Ku¯j,k=∑Z∈£¯CZ. Iff∗<f¯∗, then∑Z∈£CZ<∑j∈N∑k∈Ku¯j,k. Then, at least one coalitionZ∈£exists such thatCZ<∑j∈Zu¯j,Z. That is, constraint (8) is violated for coalition Z, but then model M2 would be infeasible. We conclude that if model M2 is feasible, then the optimal objective value of model M1 is equal to the optimal objective value of model M2.A straightforward implication is that if the structure£∗={Zk:xk=1}solves model M1 for some cost allocation vector u, then this same structure must solve model M2 for some cost allocation vectoru¯(if model M2 is feasible). This does not need the allocation u to be the same asu¯. Note that, given the coalition structure is fixed, a cost allocation vector u which solves model M1 does not necessarily solves model M2, but an allocation that solves model M2 must also solve model M1.Let us consider an example consisting of three players, with a characteristic function defined as follows:C{1}=50,C{2}=65,C{3}=70,C{1,2}=100,C{1,3}=115,C{2,3}=130,C{1,2,3}=180. The optimal structure obtained by model M1 in this problem is£∗={{1,2},{3}}, with objective function valuef∗=170. The allocation vectoru=(49,51,70)for this structure solves model M1, since the coalitions{1,2}and{3}with this allocation satisfy the core stability constraints within each of these two coalitions. However, this allocation does not satisfy the strong stability condition, becauseu1+u3=119>C{1,3}=115. Therefore, there would be incentives for players 1 and 3 to form their own coalition. For example, they could agree on allocationsu1=48andu3=67to split the cost of coalition{1,3}and leave player 2 alone. The resulting structure£={{1,3},{2}}is sub-optimal, with objective valuef=180, 10 units more expensive than the optimal. There exist infinite other allocations that can overcome this problem. For example, the allocation vectoru¯=(44,56,70)together with the same structure£∗solve both models M1 and M2. In fact, this allocation satisfies the core stability constraints within each formed coalition and the strong stability condition, while minimizing the total cost.In this section we present two examples of applications of the MIP models presented in the previous section. The first one corresponds to a problem in forest transportation, where different players can collaborate by means of backhauling and wood bartering. The second one corresponds to a problem of inventory of spare parts for oil operations, where different players can collaborate by means of inventory pooling. In order to find optimal coalition structures and cost allocations, we proceed in two stages. First, we solve the corresponding cost minimization problem (transportation or inventory) for each possible coalition k. This cost minimization problem provides an optimal plan for each coalition and the characteristic functionCkof the cooperative game. In the second stage we use such cost as parameters in the MIP models and solve them to find the coalition structure and cost allocation. Then, the coalitions contained in the structure implement the collaboration according to the corresponding plan, which was obtained when solving the cost minimization problem.Frisk et al. (2010) studied a problem of cost allocation in collaborative forest transportation, motivated by a real-world case. The case study was done by the Forest Research Institute of Sweden and included eight companies with operations in southern Sweden. In this context, collaboration among companies creates opportunities to better utilize their overlaps and distances to mills. The authors studied a number of instances of this problem and found that savings of up to 14.2% can be achieved by implementing collaboration. This can be done by wood bartering and/or backhauling. Wood bartering can be used in such a way that destinations between supply and demand nodes are changed. This means that one company may send some of its own supply to another company’s mill, and in return get the same volume back to its own mill but from another company. This can be achieved when the supply areas of the companies cover each other as this lowers the overall average transportation distances. The flows can be direct flows between a supply and a demand point or more complex routes where backhauling possibilities are included. Backhauling can be used to find better routes by combining two or several destinations (combination of supply and demand points) to reduce the proportion of empty driving. All computations were done in the decision support system Flow-Opt (Forsberg, Frisk, & Rönnqvist, 2005). This system was used to solve a transportation model for each possible coalition of companies. The transportation model is a column based model, where the decision variables represent the flows in routes or backhauls. The model to find the coalition costsCkcan be written as follows:(9)minCk=∑p∈Pkcpwp(10)s.t.∑p∈Pkaijpwp⩽sij,∀i∈Ij,j∈Jk(11)∑p∈Pkdljpwp=dlj,∀l∈Lj,j∈Jk(12)wp⩾0,∀p∈PkThe variablewpdenotes the flow in backhaul route p andcpthe corresponding unit cost. The set of routes for each coalition is given by the setPk. The coefficientsaijphave value 1 if route p picks up at supply point i at company j and 0 otherwise. In the same waydljphas value 1 if route p delivers at demand point l at company j and 0 otherwise. The setJkdenotes the set of companies in coalition k, andIjandLjthe set of supply and demand points, respectively, at company j. Constraint sets (10) and (11) represent the supply and demand respectively at each company j in coalition k, and (12) the non-negativity conditions. We note that direct flow variables are represented using columns including only 2 nonzero elements (i.e. one pick up and one delivery). There is often a huge number of potential backhaul routes (often several hundred millions) and they can typically not be used explicitly in a solver. Instead, they are generated in a column generation approach (Carlsson & Rönnqvist, 2007). The restrictions imposed on the backhaul routes are e.g. driving time or the number of pick ups and deliveries. In tactical planning, there is often a practical limit for using backhaul routes consisting of two direct flows.After having computed the costsCkfor all coalitionk∈K, we use them as parameters in the MIP models of Section 3. We implement these models in AMPL and solve them using the software CPLEX 12.5 on an Intel Core 2 Duo 2.26gigahertz processor with 8gigabyte of RAM. The solutions to models M1 and M2 in these instances are quickly obtained, in a matter of a second. Note, since there are eight companies, there are 255 coalitions, and consequently 255 binary variablesxk. In addition, there are 2040 continuous variablesuj,kand 6050 rationality constraints.The results of solving the models for different values of the maximum cardinality bound m are shown in Table 1.From these results we can observe that the optimal valuefm∗of model M1 is strictly decreasing in m. This means that the structure of stable coalitions that minimizes total cost always include at least one coalition of the maximum cardinality allowed by the upper bound m. This suggests that the more companies are allowed to collaborate, the less total cost, as expected in this case. However, the relative cost savings of including an additional company decreases in most cases when increasing the upper bound from m tom+1(except whenm=6). These relative cost saving values, calculated as|fm+1∗-fm∗|/fm∗×100%, are shown in the fourth column of Table 1 and plotted in Fig. 1. Note fromm=7tom=8the relative savings amount to only 0.08%.The effect of increasing the maximum cardinality allowed for a coalition is very important in the lowest interval and decreases with higher m. Fig. 2shows the cumulative savings with respect to the base casem=1, i.e.,(|fm-f1|/|f8-f1|)×100%. It can be observed that the cumulative savings of allowing coalitions of cardinality up tom=3already account for more than a half of the total savings achieved by the grand coalition. And when settingm=6, more than 90% of these savings are achieved.This analysis provides insights about the marginal savings of allowing one more player into the coalitions. These marginal savings becomes considerably less significant when m approaches the total number of players. In consequence, the decision maker in practice should analyze whether these savings overwhelm or not the managerial complexities of forming larger coalitions.In order to illustrate how the structures change from one to another value of m, we have included Fig. 3. This figure shows the coalition structures resulting form∈{2,…,7}(form=1the optimal coalition structure obviously consists of all players standing alone, while form=8it consists of the grand coalition). The driver to create a coalition depends on the participating companies, geographical distribution and their assortment distribution. If the companies have more geographical overlap, it creates better potential savings. In the case study, there are close to 40 assortments based on specie, diameter, length and quality. Any delivery between companies must be balanced for each assortment.Changing fromm=2tom=3makes playerP3to joinP2andP5, and playerP4to joinP1andP6. This leaves playersP7andP8alone. In this instance, these two player have no savings when acting in coalition (moreover, they would incur more costs by implementing the coalition because in this instanceC{P7,P8}>C{P7}+C{P8}). Changing fromm=3tom=4involves three deviations. Form⩾4, the collaboration relations vary less, with only one deviation when increasing the upper bound by one. It can also be observed that only playersP2andP5remain together in the same coalition for allm∈{2,…,7}. These observations illustrate that the upper bound on the cardinality may have important implications.Another observation from the results in Table 1 is that model M1 always had a solution, which is not surprising because a coalition structure satisfying the core stability within each coalition formed always exists. Also, for allm≠6, model M2 was feasible and, consistently with Proposition 1, the optimal objective value was the same as the optimal objective value of model M1. Interestingly, whenm=6there exists no strongly stable coalition structure, thus if the upper bound would be fixed to a maximum of six companies per coalition, there will always be incentives for some of them to deviate from their coalition to join with other players. For example, the solution we obtained by running model M1 to this instance results in the structure£∗={Z1,Z2}, whereZ1={P1,P2,P3,P5,P6,P7}andZ2={P4,P8}. This structure reaches the optimal objective valuef∗=39.52. In the obtained allocation, we verify thatu3+u4=4.69+2.07=6.76>C{P3,P4}=6.73. That is, playersP3andP4would have incentives to form their own coalition. However, should we add a constraint for this example requiring that playersP3andP4must belong to the same coalition, the resulting structure reaches a sub-optimal objective value equal to 39.53 cost units and playersP1andP4would have incentives to form their own coalitions. These types of features are not easy to identify beforehand, especially since the characteristic function is a sort of black box with no particular properties. Therefore, the modeling approach we present can serve as a useful support tool for the decision maker.When the strong equilibrium does not exist, it is worthy to explore the possibilities for some of the players to conform coalitions. It can be argued that the goal of any individual player is to minimize his own cost while keeping stability for all the players who conform his coalition. We tackle this problem by introducing some modifications to model M1. Without lost of generality, let playerj=1be the one for which we minimize the cost. Letwjbe a binary decision variable, which takes the value 1 if player j joins the coalition of playerP1, and zero otherwise. In order to minimize the total cost ofP1, we replace the objective function (3) by the following one:(13)min∑k∈Ku1,kAs for the constraints, we keep constraints (4)–(7) from model M1 and, in addition, we incorporate the following constraints:(14)uj,k⩽M·xk∀j∈N,k∈K,M≫0(15)∑i∈N(αi,k·∑k¯∈Kui,k¯)⩽Ck·wj+M·(1-wj)∀k∈K,j∈N,j≠1,αj,k=1,M≫0(16)αj,k·xk+α1,k·xk⩽1+wj∀k∈K,j∈N,j≠1(17)wj⩽∑k∈Kαj,k·α1,k·xk∀j∈N,j≠1Constraints (14) assure thatuj,kis greater or equal than zero only if coalition k forms (M is a sufficiently large number, e.g.M=Ck). Constraints (15) provide strong stability for the players who join the coalition of player 1. Constraints (16) and (17) are logical relationships assuring thatwjtakes value 1 if and only if player j joins the coalition conformed by player 1. Note that the strong stability condition in this model is not formulated for player 1, but only for those players he collaborates with. Table 2shows the allocations obtained when using the individual cost minimization for each player in the instance withm=6.It can be seen that the solution to the problem of a given player j may result in a costujgreater than the cost for this same player j in the solution to the problem of another player i. Moreover, this is even possible when the coalition of player j is the same in both problems. For example, when solving the model forP1, he gets allocatedu1=3.76, which is more costly for him than the solution obtained when solving the model for playerP4, despite for both problems the optimal structure is conformed byZ1={P1,P2,P3,P5,P6,P7}andZ2={P4,P8}. As in farsighted coalitional stability (Chwe, 1994; Sŏsić, 2006), this is rational in order for playerP1to keep stability of the coalition it conforms, despite being opportunities for him to collaborate with players who are left out of his coalition. While such opportunities may be better forP1from a myopic perspective, if he breaks out then some other moves would trigger and the overall situation becomes instable, which is worse for him. In fact, if constraint (15) is formulated forj=1, the model turns infeasible. When the model is solved forj=4, the best alternative for playerP4is to form a coalition with playerP8. Assuming this coalition{P4,P8}forms first (and does not break), the remaining universe of players is such thatP1can get a better (lower) allocation because the opportunities for the players to collaborate withP4andP8are not longer possible. This suggests that in a game where a single player motivates the formation of a coalition, the final structure may strongly depend on who is this player. Note, however, that the individual cost minimization problem may require this player to have the information from all players, which in practice can turn to be inviable as we pointed out in Section 2.In their case study, Frisk et al. (2010) discussed the suitability of traditional cost allocation methods for sharing the costs in collaborative forest transportation, such as the Shapley values and the nucleolus. When it came to the acceptance of the cost allocation among the companies participating in the case study, the authors found some disadvantages of using these traditional methods, because of the large difference in size among the companies. In order to overcome this problem, they proposed a new method called Equal Profit Method (EPM). This method looks for a stable allocation such that the relative savings are as similar as possible for all participants. Such allocation solves a linear programming model, whose objective function is to minimize the maximum difference in pairwise relative savings between the players. Being g a continuous variable, such a linear programming model minimizes g subject to the core stability constraints and tog⩾uiC{i}-ujC{j}∀i,j∈N. A similar principle of fairness can be extended to our problem, by considering the difference in pairwise relative savings between coalitions instead of players. However, the minimization of the maximum of these differences would lead to a coalition structure where all player stand alone, because in this fully non-cooperative structure all coalitions save zero and, therefore, the difference among their relative savings is also zero (which is the minimum that can be achieved). Therefore, we rather keep the objective function (3) that minimizes the total allocated cost, and introduce a parameterφas an upper bound on this difference. We also introduce a binary variableyk,k¯, which takes the value 1 if coalitions k andk¯form and 0 otherwise. Together with these variables, we incorporate the following constraints to the models:(18)yk,k¯Ck∑j∈Nαj,kCj-Ck¯∑j∈Nαj,k¯Cj⩽φ∀k,k¯∈K(19)yk,k¯⩽xk∀k,k¯∈K(20)yk,k¯⩽xk¯∀k,k¯∈K(21)xk+xk¯⩽1+yk,k¯∀k,k¯∈KConstraints (18) restrict the difference between the relative savings among the formed coalitions to be no greater than the upper boundφ. Constraints (19)–(21) are logical relationships linking variables x and y, that provide variableyk,k¯being 1 if and only ifxkandxk¯are 1.Table 3shows the results obtained in this forestry case using five different values ofφranging from 0.1% to 10%.It can be observed that relatively low values ofφoften leaves the strong stability problem without any feasible solution. This can be explained because the coalition structure of minimum cost does not necessarily fulfill the constraint on the boundφ. In fact only forφ=10%do the results match with the minimum cost solutions (which were reported in Table 1). Comparing the optimal objective values with those obtained by the original core stability model gives a sort of price of fairness, understanding by fairness the EPM’s notion of equality in relative savings among coalitions. This price of fairness obviously turns to be higher for lower values ofφ, where the space of feasible solutions becomes smaller, while lower for higher values ofφ. A comparison of the values offm∗in Table 3 with those in Table 1, reveals the solutions form∈{2,…,7}whenφ=0.1%are on average3.7%more expensive than the minimum cost solution. Whenφ=7.5%the results are on average only 0.3% more expensive than the minimum cost solutions. Whenφ=10%the solutions coincide, because the minimum cost solution satisfies the upper bound constraint on the relative savings’ difference.Looking for the maximum number of players in a game for which the core exists is mentioned by Frisk et al. (2010) as an alternative to the EPM’s objective function. How this subgroup of players should be selected was, however, left for further research in their article. We can easily answer this question by using model M1 with the following two modifications. First, the following objective function is used:(22)maxfˆ=∑k∈KSk·xk,whereSkis a parameter defined as the cardinality or number of players of coalition k, for allk∈K.Second, the following constraint is added:(23)∑k∈Kxk=1Constraint (23) states that only one coalition will be formed, while objective function (22) maximizes the number of players in it.When running the resulting model for this instance, we obtainfˆ=|N|=8. This is not surprising, since it was known from Frisk et al. (2010) that the core of the game considering the grand coalition in this instance was not empty.Adding a cost on the coalition cardinality might be useful for reflecting the issues of managing large coalitions. How this cost should be calculated is, however, a tough task. As we discussed earlier, these issues are not easy to translate into a cost function. In order to illustrate the effects that this type of cost could have, we introduce an additional costζon each coalition. We assume thatζcan be modeled as a convex increasing function of the cardinality of the coalition. This cost does not affect the structure of the models, but just modifies the cost parameter values C in constraints (4), (5) and (8). Namely, the new cost parameter value for coalition Z isC^Z=CZ+ζ(Z).In our numerical runs, we utilize the functionζ(Z)=α|Z|(|Z|-1)(|Z|+1), where|Z|is the cardinality of coalition Z andαis a positive parameter. Table 4shows the results obtained using five different values ofα.Since the cost on the cardinality of the coalitionsζincrease withα, the relative savings of allowingm+1players with respect to m players decrease withα. Whenζis relatively small, savings are still realized for the largest values of m; for example, whenα=0.1, settingm=7leads to savings of 0.40% with respect to the case wherem=6. Whenζis relatively high, the large coalitions do not form, thus increasing the upper bound on the number of payers per coalition has no impact. For example, whenα=0.5any boundm⩾4leads to the same solutions, so coalitions of cardinality greater than 4 are not part of the optimal coalition structure.When considering the costζ, the strong stability model has solution for all values of m in the four instances whereα⩾0.2. This happens still in the case wherem=6, which without this cost had turned to be infeasible.As for the optimal structures, for relatively small values of m, we observe the most convenient coalitions tend to form despite the increase in costζ. For example, whenm=2we find four coalitions take part in the optimal structure for all values ofα. However, when m increases, the impact of changingαin the optimal structure is more notorious. For example, when fixingm=8, forα=0.1the optimal structure contains only two coalitions, while forα=0.5it contains five coalitions.These results illustrate that a cost on the cardinality of the coalitions may have an important effect in the resulting coalition structure.Guajardo et al. (2014) studied a case of inventory of spare parts in an oil and gas company headquartered in Norway. The operations at the platforms offshore involve sophisticated equipment, usually expensive and subject to long lead times. Therefore, the inventory of spare parts plays an important role to facilitate operating conditions. Since some identical pieces of equipment are used at different platforms, pooling inventory presents important opportunities for savings. The authors estimated cost savings of about 20% from risk pooling in comparison to the case where inventory is carried separately for each platform. The spare parts are held at inventory plants or licenses located along the Norwegian coast. Some of these plants lie right next to each other, within a same warehouse. Although the company is the majority owner of the licenses, there is also a set of other companies owning a share of them. Given the important consequences of stock out in oil operations, in terms of safety and downtime costs, an approach divided in stages as in Anupindi and Bassok (1999) and Granot and Sŏsić (2003) where the stage of collaboration is agreed after demand is realized, is not appropriate in this case. The coalitions rather need to be formed beforehand. On the other hand, due to several reasons, including political, operational and managerial difficulties, it is not straightforward to implement an inventory pool of spare parts to cope centrally with the demand from all the platforms.For each coalition, we consider a single-item problem under continuous review (S-1,S) policy with fixed lead time, Poisson distributed demand and backorders. The optimal base-stock S for each coalition k is found through a procedure aimed at minimizing ordering plus holding cost subject to a fill-rate constraint, that is, S is the positive integer number that solves the following inventory control problem:(24)minCk=Aμk+h·[S-μkL+Bk(S)](25)s.t.∑j⩽S-1(μkL)je-μkLj!⩾λ(26)S∈Z+In the cost function (24), A is the fixed cost per order,μkis the average demand of coalition k per unit of time, h is the carrying cost, L is the lead time andBk(S)is the expected number of backorders given by∑j=S∞(j-S)(μkL)je-μkL/j!. Constraint (25) states a service level constraint, where the left-hand sideISis the fill-rate as a function of S andλ∈[0,1)is a parameter expressing the target service level. All these expressions come from standard formulae in inventory control literature (see e.g. Hadley & Whitin, 1963). The solution to this inventory control problem is simply the minimum positive integerS∗that satisfies the service level constraint (25). This optimal base-stock levelS∗can be computed by evaluating the fill-rate starting fromS=1and consecutively increasing S by one, until the targetλis fulfilled. This procedure tends to finish quickly in inventory control of spare parts, where the optimal base-stock levels are relatively low quantities. It not rarely happens that the optimal base-stock level for a coalition is lower than the sum of the optimal base-stock levels of its players standing alone and, therefore, the potential for collaboration appears. We implement and solve this inventory control problem by using Matlab. The solution to each instance is obtained in a matter of a second. More details about this case can be found in Guajardo et al. (2014) and Guajardo and Rönnqvist (2014).We test our models in an instance including 16 players (each representing an inventory plant), 19 spare parts and 53 possible coalitions. These coalitions result from limiting the possibilities to only those where at least one item is used by all the players in the same coalition. The resulting coalitions include 2 sets of 4 players, 13 sets of 3 players, 22 sets of 2 players and 16 single-player coalitions. All players in this instance are somehow related with each other, either because they can directly collaborate in a same coalition or because another coalition includes one of its collaborator or another descendent in the collaborative relations. Therefore, the problem of finding the best structure cannot be separated in sub-problems for some players beforehand.After having computed the costsCkfor all coalitionk∈K, we use them as parameters in the MIP models of Section 3. The coalition structure resulting from the optimal solution to model M1 without cardinality constraints (equivalently, whenm=4), includes eight coalitions as illustrated in Fig. 4. This structure also solves model M2. What we believe is interesting from this instance is that only one of the two coalitions of four players (the largest cardinality of the possible coalitions) are part of the optimal solution. In fact, coalition{P1,P3,P4,P5}is not formed. AlthoughP3contributes to coalition{P1,P4,P5}(because the cost parameters are such thatC{P1,P3,P4,P5}=83,424<C{P3}+C{P1,P4,P5}=90,984), more savings can be achieved ifP3leaves this coalition to join withP2only. In fact, the cost parameters giveC{P2,P3}+C{P1,P4,P5}=105,089<C{P2}+C{P1,P3,P4,P5}=133,818. In contrast, the other coalition of largest cardinality,{P12,P13,P15,P16}, is formed. Other players are left alone in this solution, namelyP6,P11andP14. These do not form any coalition among themselves, because they do not use a same item, from the 19 items in this instance. On the other hand, these players could have formed coalitions with other players, but these other players are better forming coalitions with some others.Table 5shows the results of imposing an upper bound on the maximum number of players that can form a coalition.Allowing coalitions of up to two players leads to savings which represent 91% of the savings achieved when allowing coalitions of up to four players. Note here that the optimal coalition structure obtained through model M1 is not strongly stable. In fact, model M2 is infeasible. As can be seen in Fig. 4, the optimal coalition structure of model M1 whenm=2consists of seven two-player coalitions, and playersP5andP6stay alone (note these two players cannot collaborate between themselves, because they have no common item). We have verified that such structure with the allocation vector found for model M1, violates the strong stability in five cases. The individual cost minimization model of Section (4.1.1) can be run for each player j, requiring the strong stability constraints only for the player who joins j. Similarly as in the forestry case, the structure and allocations so obtained may strongly depend on j.PlayersP6andP11are also left alone in the solution for the instance wherem=3andm=4, while playerP14is left alone whenm=4. These three players do not have any item in common, and that is why they do not form any coalition among themselves. Players who could collaborate with them are better joining other coalitions.The number of common items and their value is a main driver for the players to conform a coalition. Another driver is given by average demand values which complement each other, in the sense that the target service level for a coalition between players i and j can be satisfied by a base-stock level lower than the sum of the base-stock levels for the separate players. Because of the discrete nature of the base-stock level, the solutionS∗to the inventory control problem often provides some slack in constraint (25), that is,lS∗>λ. This encourages some players to find collaborators to share the inventory costs with, while conforming to the target service levels. These drivers explain that some of the players are especially good collaborators between each other. For example, playerP1withP4,P2withP3,P7withP8andP9withP10, who as can be seen in Fig. 4 remain together in the solution to all the instances.

@&#CONCLUSIONS@&#
Motivated by the context of collaborative logistics, we have formulated mixed integer linear programming models for coalition structure and cost allocation. The models consist of a set partitioning problem together with stability constraints. These stability constraints come from game theoretic principles, and consider both core stability and strong stability. We have tested the models in two applications; one in collaborative forest transportation and one in inventory pooling of spare parts for oil and gas operations. By running the models, we were able to determine coalition structures that satisfy the stability constraints at minimum cost, or, in the strong stability problem, to determine whether the problem has or not a feasible solution. If the latter is feasible, we have proved that a same structure solves both the core stability and the strong stability problems. The consideration or not of the strong stability conditions can have important effects. In some instances of the cases we have studied, it was verified that while the core stability problem is solved, the strong stability problem turned to be infeasible. This certainly can have practical implications, thus highlighting the notion of strong equilibrium in addition to the traditional core stability concept.Our approach also allowed us to study the effects of restricting the maximum cardinality of the coalitions contained in a structure. We reported results where most of the savings from collaboration are achieved by allowing a certain number of players in the coalitions. Still if the grand coalition achieved more savings than the coalition structure subject to the maximum cardinality constraint, in practice a decision maker should analyze whether these savings overwhelm or not the managerial complexities of forming large coalitions. In the forestry case, for example, we found that increasing the upper bound on the cardinality of the coalitions from 7 to 8 companies provided only 0.08% of relative savings.Although previous literature in OR has incorporated game theoretic principles into collaborative problems, most of it has paid attention to problems assuming the grand coalition is formed. Instead of making this assumption, we approached the cost allocation problem simultaneously with the problem of finding an optimal coalition structure. A vast source of opportunities derives from this research. First, although the coalition structure problem has been studied in game theory for several decades, there appear to be no particular solution methods to deal with the core stability and strong stability problems with general characteristic functions. Since this is basically a set partitioning problem subject to additional constraints, a direction for further research is to formulate solution methods that could efficiently find the optimal structures and cost allocation vectors. This is specially challenging in large-scale problems, because the number of coalitions increases exponentially with the number of players. We have reported examples where the models can be directly solved in short time including up to 17 players and about 131,000 coalitions. Any further dimension remains worthy of exploration. Second, it might be interesting to set conditions for the uniqueness of the solution to these problems, since beforehand there is no guarantee that the optimal structure and the cost allocations are unique. Also, since the costs have been assumed as parameters of the models, a natural extension is to study the case where these parameters are exposed to some type of uncertainty or where some data are missing. We have also assumed a fully cooperative behavior of the players. Another extension could consider the case where they can adopt non-cooperative or partly cooperative strategies. Finally, the implementation in practice of these types of models appears to be one of the challenges for achieving the benefits of collaboration. As referred by Chen (2009), getting all players to agree on how to share costs and benefits was identified as one of the major barriers to collaboration in practices on logistics and commerce. We believe our article has pointed in the correct direction to break these barriers.