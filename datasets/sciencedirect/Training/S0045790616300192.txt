@&#MAIN-TITLE@&#
A remote electrocardiogram monitoring system with good swiftness and high reliablility

@&#HIGHLIGHTS@&#
A Two-level Load-balance Monitoring Strategy (TLLBMS) is proposed.Parallel PCA-ICA Algorithm is realized to fulfill quick preprocessing and feature extraction.Only eigenvectors are transmitted at a Dynamically Variable Time Interval (DVTI).MD5 hash algorithm is realized to ensure the correctness of communication.

@&#KEYPHRASES@&#
Two-level Load-balance Monitoring Strategy,Parallel PCA-ICA Algorithm,Dynamically Variable Time Interval,A2F500,MD5,

@&#ABSTRACT@&#
Graphical abstractImage, graphical abstract

@&#INTRODUCTION@&#
Cardiovascular disease has become a major disease that seriously threatens people's health and life. The attacks of cardiovascular disease are not only paroxysmal and occasional, but also the time for treatment is critical, thus patients need a real-time and round-the-clock monitoring service. Electrocardiogram (ECG) can accurately reflect the situation of cardiovascular disease, and has become main diagnostic basis of cardiovascular disease. Therefore, we are in sore need of a remote monitoring system that can conveniently and reliably obtain ECG signals of patients, timely analyze ECG signals, and give quick diagnosis and rescuing measures.With rapid development of wireless technology, mobile phones are gaining acceptance to become an effective tool for cardiovascular monitoring. Based on mobile communication, a number of remote ECG monitoring systems have been developed in latest decades [1–3]. These systems can give a long-term and ambulatory ECG monitoring. The overall structure of these systems is pretty similar, as shown in Fig. 1. The monitoring system consists of a quantity of portable monitoring terminals, monitoring center and mobile network. Monitoring terminals acquire raw ECG signals of patients, and periodically transmit them to monitoring center via mobile communication. Along with the assistance of doctors and ECG database, monitoring server accomplishes preprocessing, feature extraction and classification of ECG signals, realizes automation diagnosis, and gives rescues when emergencies happen.However, a kind of continuous wireless ECG monitoring solution needs frequent communication and big ECG data packages, because of the requirement of data analysis. Large amounts of data transmission over a long time could eventually cause transmission bottlenecks, which increase time delay, and reduce the reliability and the robustness of communication. Furthermore, massive data analyses bring a huge burden to monitoring server, which will lead to low speed and accuracy. The problem is prominent greatly with the increase of monitoring capacity. Therefore, for decreasing the amount of data transmission, data compression technique is proposed in the [4,5]. In these applications, ECG data are compressed with a reasonable complexity of the implementation, while maintaining clinically acceptable signal quality. Data compression reduces the size of ECG signals, however, compressed ECG data must be decompressed before performing analysis and diagnosis. The additional step brings a significant processing delay for identification task. This will become an obvious burden if millions of compressed ECG segments need be decompressed by monitoring center. A novel method directly analyzing compressed ECG data is proposed in the [6,7]. The method performs faster than current methods, but its results have a low accuracy, especially because of signal distortion during ECG data compression.The main focus of the paper is on the swiftness and the reliability of remote ECG monitoring system on the basis of maintaining a high accuracy. According to the drawbacks of existing ECG monitoring systems, a Two-level Load-balance Monitoring Strategy (TLLBMS) is proposed. In monitoring terminal level, through the method of realizing parallel Principal Component Analysis and Independent Component Analysis (PCA-ICA) algorithm with Field Programmable Gate Array (FPGA), monitoring terminals can not only complete acquisition, preprocessing, and feature extraction of raw ECG signals quickly, but also give an effective pre-classification and alarming mechanism to achieve a quick rescue. After the completion of these tasks, monitoring terminals transmit only a small size of eigenvectors to monitoring center at a Dynamically Variable Time Interval (DVTI). Depending on the degree of ECG abnormality, time interval of transmitting is variable dynamically. The less ECG abnormality is, the longer time interval is. Hence, the amount of communication data reduces greatly and the problem of transmission bottlenecks is solved. It leads to short time delay, high reliability and robustness of communication, and large monitoring capacity. In monitoring center level, monitoring server can process eigenvectors directly, get diagnostic results and take corresponding measures quickly. When sudden heart attacks are detected and immediate medical rescues are needed, monitoring center will dispatch emergency personnel quickly based on Global Position System (GPS) information of patients, and doctors can guide patients to do self-rescue via mobile communication. To ensure the correctness of data transmission and protect data from being falsified, Message Digest Algorithm MD5 is realized to verify the integrity of data. When the verification fails, monitoring center returns the error flag that means retransmission. Furthermore, based on diagnostic results, monitoring center can adjust time interval of data transmission compulsorily or require the transmission of raw ECG data. These measures can avoid false process and pre-classification of monitoring terminals, and get diagnostic results with high accuracy. Thereby, proposed remote ECG monitoring system has very good swiftness, high reliability and accuracy.The rest of paper is organized as follows. Section 2 describes hardware design of system. Section 3 presents software design of monitoring terminal, involving FPGA implementation of Parallel PCA-ICA Algorithm and MD5 hash algorithm, and software design of ARM CortexTM_M3. Section 4 presents software design of monitoring center. Section 5 shows results. Section 6 discusses results and finally Section 7 concludes the paper.Hardware design includes design of monitoring terminal and design of communication module in monitoring center. Except having no acquisition circuits of ECG signals and adding a serial communication interface to monitoring server, other parts of communication module are same as monitoring terminal. Therefore, hardware design of monitoring terminal is introduced in detail only.In order to meet stringent requirements of portable devices for size, power consumption and processing speed, main components of monitoring terminal select the A2F500 and the SIM508. The A2F500 is an intelligent mixed signal FPGA with a hard ARM CortexTM-M3 microcontroller and three high-performance and programmable Analog to Digital Converter/Digital to Analog Converter (ADC/DAC) circuits. Although there are only three analog ADC/DAC circuits, up to 32 analog inputs can be obtained by means of programmability. The SIM508 is a wireless engine supporting GPS function.Block diagram of monitoring terminal is shown as Fig. 2. Monitoring terminal is made up of twelve lead poles, ECG signal conditioner, A2F500, SIM508 and its accessory circuits, Trans Flash (TF) card, power source, Liquid Crystal Display (LCD), keyboard, buzzer, etc. Worn on the body of patients, lead poles sample ECG signals. ECG signal conditioner modulates ECG signals and transmits them to ADC channels of A2F500. SIM508 connects with A2F500 via two serial interfaces. One serial interface is dedicated to receiving GPS information. Another is used to transmit ECG and GPS data, and receive diagnostic results. Secure Digital Input and Output (SDIO) interface communicates with TF card, designed for long period ECG data recording. General Purpose Input/Outputs (GPIO) control LCD, keyboard, buzzer, etc.Mircosemi's SmartFusion Intelligent mixed signal FPGA family is a customizable System-on-Chip (cSoC). It integrates abundant FPGA fabrics, a hard ARM core, some programmable analog ADC/DAC circuits and common digital circuits. Unlike traditional FPGA, flash-based SmartFusion offers sleep mode that has power draws measured in the microamperes and startup time measured in the microseconds, both of which are critical for low-power operation. Moreover, SmartFusion gives more flexibility than traditional FPGA, because of having no the excessive cost of soft processor cores.A2F500 is a member of SmartFusion Intelligent mixed signal FPGA family. Its FG484 packaging is the size of 23×23×2.23mm. It integrates 500,000 programmable gates, 11520 D-flip-flops, a hard 100MHz 32-bit ARM CortexTM-M3 core, 512kB flash, 64kB Random-Access Memory (RAM), three 12-bit ADC/DAC channels with up to 500Ksps conversion rate, and abundant peripherals such as two Universal Asynchronous Receiver and Transmitters (UART), two Inter-Integrated Circuits (I2C), two Serial Peripheral Interfaces (SPI), two Phase Locked Loops (PLL), two Timers, one watchdog, large amounts of GPIOs, etc. A2F500 can meet requirements of monitoring terminal for sufficient resources, small size, low power consumption and high performance. Because of programmability of ADC inputs and high conversion rate, three analog ADC circuits can acquire more than three-channel ECG signals in a short period. Depending on patient's conditions, ECG signals may be selected dynamically from twelve lead poles.The ECG signal of body is normally in 0.05–5mV and its frequency range is from 0.05Hz to 100Hz, which is weak, vulnerable and low-frequency. It cannot be utilized directly and must be modulated by signal conditioner. As shown in Fig. 3, ECG signal conditioner includes pre-amplifier, band-pass filter, main amplifier and notch filter of 35Hz and 50Hz [8].The ECG pole collects the ECG signal of body. Pre-amplifier chooses AD623, which has characters of high input resistance, low input bias current, low noise and high common-mode rejection ratio [9]. Band-pass filter is shown as Fig. 4. It includes a high-pass filter and a low-pass filter consisted of OP2177, capacitances and resistances. The Cut-off frequency of high-pass filter is given in Eq. (1). The Cut-off frequency of low-pass filter is given in Eq. (2).(1)fhigh=1/(2πR16R17C35C36)≈0.03Hz.(2)flow=1/(2πR18R19C41C42)≈110Hz.Hence, its frequency range is 0.03Hz–110Hz. Main amplifier is composed of OP1177 and amplification coefficient resistances. It enlarges output signal of band-pass filter to 100 times to achieve the requirement of ADC converters. The 50Hz power frequency noise and the 35Hz Electromyography (EMG) interference are all in the coverage of ECG signals, so the 50Hz and 35Hz filter must be designed. The 50Hz filter circuit adopts twin-T trap circuit that notch frequency is 50Hz. Its signal attenuation capability to 50Hz signals is −35dB. The 35Hz filter is similar to the 50Hz filter.Designed by SIMCOM Company, SIM508 is a Tri-band wireless engine that works on Global System for Mobile Communication (GSM) 900MHz, Data Communication System (DCS) 1800MHz and Personal Communications Service (PCS) 1900MHz, and supports also GPS technology for satellite navigation. SIM508 provides General Packet Radio Service (GPRS) multi-slot class 10/ class 8(option) capabilities and supports GPRS CS-1, CS-2, CS-3 and CS-4 coding schemes. SIM508 is designed with power saving technique. Current consumption of its GSM part maintains as low as about 3mA in SLEEP mode. With a tiny size of 55mm×34mm×3.0mm, it is suitable for low-power and size-constrained applications very much. SIM508 and its accessory circuits are shown as Fig. 5. SIM508 connects with A2F500 via two serial communication interfaces. Serial communication interface A transmits GSM/GPRS data. It is seven-line, and supports auto-baud rate detection ranging from 1200bps to 115,200bps. Two-line serial communication interface B connects with the GPS receiver, and its baud rate supports 1200–115,200bps, but 4800–38,400bps is a common rate range. Its accessory circuits mainly include Subscriber Identity Module (SIM) card, microphone and speaker. Both 1.8V and 3.0V SIM cards are supported. In the microphone and speaker circuits, Electro-Static Discharge (ESD) circuits are designed to protect them against the damage of human electrostatic.To order to obtain good swiftness, high reliability and accuracy, this system adopts a Two-level Load-balance Monitoring Strategy (TLLBMS). According to TLLBMS, the monitoring terminal needs to complete acquisition, pre-processing and feature extraction of raw ECG signals quickly. It also needs to give an effective pre-classification and alarming mechanism, and transmit eigenvectors at a Dynamically Variable Time Interval (DVTI). In addition, MD5 hash algorithm is implemented to verify the integrity of data transmission.Taking advantage of high-performance ADC circuits of A2F500, raw ECG signals can be acquired quickly. With respect to ECG preprocessing and feature extraction, abundant methods have been developed, such as Wavelet Transform (WT) [10], Independent Component Analysis (ICA) [11], Principal Component Analysis (PCA) [12], Mean Shift Algorithm [13], Fourier Transform [14], Artificial Neural Networks [15], Lyapunov Exponents [16], Fuzzy Wavelet and Fuzzy C-means Clustering [17]. The system adopts a PCA-ICA algorithm to realize preprocessing and feature extraction of ECG signals. By PCA, noise and artifacts contained in ECG signals are cancelled to a great extent by decorrelation and dimension reduction process. After PCA preprocessing, ICA can effectively separate independent components from noise free ECG signals, and complete feature extraction. The PCA-ICA algorithm helps for redundant data reduction as well better feature extraction. It has a high accuracy.Utilizing FPGA resources of A2F500, a Parallel PCA-ICA Algorithm is realized. FPGA hardware implementation provides not only an optimal parallelism environment, but also a fast and real-time solution. Hence, FPGA resources of A2F500 are very suitable for realizing Parallel PCA-ICA Algorithm and MD5 hash algorithm, which have huge computing demands. As the center controller of monitoring terminal, ARM CortexTM-M3 manages and harmonizes other parts, and accomplishes the rest of tasks.Internal block diagram of A2F500 is shown as Fig. 6. The interior of A2F500 contains IP cores of CortexTM-M3 processor, Parallel PCA-ICA Algorithm and MD5 hash algorithm realizing with programmable logic resources of A2F500, serial interface A to GSM/GPRS module of SIM508, serial interface B to GPS module of SIM508, ADC, SDIO and GPIO. CortexTM-M3 processor, Parallel PCA-ICA Algorithm and MD5 hash algorithm are interconnected via high-bandwidth Advanced High performance Bus (AHB) complying with Advanced Microcontroller Bus Architecture (AMBA) 3 AHB-Lite Specification. By the conversion of AHB to Advanced Peripheral Bus (APB) Bridge, high-speed CortexTM-M3 processor can access two serial interfaces, ADC, SDIO and GPIO via low-bandwidth APB bus complying with AMBA 3 APB Specification.Because of rapid progressing technology, high densities and performances, FPGA is feasible for the implementation of PAC and ICA algorithm in hardware [18]. In virtue of computational parallelism mechanism, FPGA can realize very complex algorithms with a high speed. In recent decades, many parallel algorithms are implemented in FPGA [19,20]. In the system, Parallel PCA-ICA Algorithm is modeled and realized with Very High Speed Integrated Circuit Hardware Description Language (VHDL). Its block diagram of FPGA realization is presented in Fig. 7.It consists of PCA Preprocessing Module, PCA Output Buffer, ICA Blind Signal Separation (BSS) Module, ICA Feature Extraction Module, state machines, some input and output registers. Differing from sequential execution of embedded processors or Personal Computers, Parallel PCA and ICA algorithms run simultaneously in FPGA. The transference of data from PCA to ICA is accomplished via a buffer. After PCA Module completes the preprocessing of a group of ECG signals, intermediate results are cached in PCA Output Buffer. Under the control of state machines, ICA Module will read intermediate results from PCA Output Buffer, and begin ICA BSS and feature extraction. Meanwhile, PCA Module will begin the preprocessing of next grouping without waiting for the end of ICA feature extraction. Consequently, PCA and ICA algorithms work simultaneously, giving a quick analysis of ECG data for a long-term monitoring.Hash algorithms are widely used to ensure authentication and integrity. Among all Hash algorithms, MD5 hash algorithm is the most critical one because of its high processing speed and low resource occupation [21]. Its specification is given in [22]. The grouping length of MD5 algorithm is 512 bit, and each grouping divides into sixteen 32-bit son groupings. Every four 32-bit son groupings is compressed into a 32-bit sub-result. Four 32-bit sub-results are cascaded to generate 128-bit hash output of MD5 algorithm. Block diagram of its FPGA realization is presented in Fig. 8.The program includes preprocess module, storage module, algorithm operation module, state machine control module and output module [23]. The clock frequency of implemented MD5 hash Algorithm is 65.76MHz. Processing a 512-bits message packet needs go through 67 clocks, so the speed of its FPGA realization reaches up to 500Mbps.ARM CortexTM-M3 is the center controller of monitoring terminal, which manages and harmonizes other parts. Based on embedded operating system μC/OS-II, software of ARM CortexTM_M3 is designed. The μC/OS-II is a portable, real-time, preemptive and clipping multi-tasking kernel. It is easy to be transplanted and supports up to 56 tasks of user. It also supports semaphores, message mailboxes, message queues and other inter-process communications used commonly [24]. The program flow chart of ARM CortexTM-M3 is shown as Fig. 9.According to the conditions of patients, analog ADC circuits sample ECG signals from different channels at a corresponding conversion rate. After sampled ECG data are preprocessed and extracted by Parallel PCA-ICA Algorithm, eigenvectors can be obtained. ARM CortexTM-M3 will give a pre-classification based on eigenvectors. In the [25], a quick and effective Cardiac Arrhythmias Classification is proposed. It is a self-diagnosis expert system. Diagnostic rules of the expert system rely on experiential rules estimated from self-learning of system and definitions of cardiologists. Many cardiac arrhythmias can be classified, such as Premature Ventricular Contraction (PVC), Ventricular Tachycardia (VT), Ventricular Fibrillation (VF), Supraventricular Tachycardia (SVT), Premature Atrial Contraction (PAC), etc. These abnormalities will trigger the alarming. In order to get a quick rescue, GPS position information of patients will be transmitted to monitoring center. Doctors in monitoring center can guide patients to do self-rescue via GSM audio communication. That means a real-time monitoring and quick rescue can be completed, and the monitoring in monitoring terminal level is realized. Moreover, for further diagnosis, monitoring terminals transmit eigenvectors to monitoring center at a Dynamically Variable Time Interval. The time interval of transmitting varies with the degree of ECG abnormality dynamically. The more ECG abnormality is, the shorter transmitting interval is. Patients with serious illnesses get more monitoring. To ensure high reliability, MD5 hash algorithm is realized to verify the correction and integrity of data. When the verification fails, monitoring center returns the error flag to monitoring terminals for retransmission.Monitoring center realizes the rest of tasks such as reception and storage of ECG signals, further analysis and diagnosis, emergency treatment and management of patients. To obtain good swiftness and high accuracy, this system takesadvantageof automation diagnosis technology. Diagnosis technology on computers can be roughly classified into two types. Firstly, using high-level natural language problem symptom description and Information Retrieval (IR) system helps system diagnosis. Secondly, using low-level system static information achieves automatic diagnosis. However, the first approach still involves a lot of human interventions, and the second approach has unsatisfactory accuracy in many cases. In this system, monitoring server combines both high-level symptom description and low-level system static information to achieve automation diagnosis. This method has improved the accuracy on many real life problems [26]. Along with the assistance ofdoctors, monitoring server can complete data mining of ECG data and realize automation diagnosis quickly. Because only eigenvectors are transmitted to monitoring server, the amount of communication data reduces greatly and the problem of transmission bottlenecks is solved. This will decrease time delay, enhance reliability and robustness of communication, and increase monitoring capacity of system. At the same time, computational burden of monitoring server decreases hugely. This will lead to marked improvement of the swiftness.The program flow chart of monitoring server is shown as Fig. 10. After receiving ECG data, the correctness and integrity of data transmission is verified by MD5 hash algorithm. If transmission error happens, the error flag will be returned. If transmission is correct, monitoring server will complete data mining and realize automation diagnosis quickly. When emergency circumstances happen, doctors can guide patients to do self-rescue via GSM phone, and quickly dispatch ambulances according to GPS position information of patients. Moreover, in order to avoid false process and pre-classification of monitoring terminal, the server can adjust time interval of data transmission or require the transmission of raw ECG data based on diagnostic results. ECG database accomplishes the storage of ECG signals and the management of monitoring equipment.

@&#CONCLUSIONS@&#
