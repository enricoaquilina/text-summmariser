@&#MAIN-TITLE@&#
Multi-server accumulating priority queues with heterogeneous servers

@&#HIGHLIGHTS@&#
The first to obtain waiting time distributions for the heterogeneous server queue.Results are for head-of-line, non-preemptive & accumulating priority disciplines.We derive a conservation law for average waiting times for multi-server systems.Contrary to intuition, the degree of heterogeneity in the system can be optimized.

@&#KEYPHRASES@&#
Queuing,Multi-class accumulating priority queue,Heterogeneous servers,Conservation law,Waiting time distributions,

@&#ABSTRACT@&#
In the present work, we develop a multi-class multi-server queuing model with heterogeneous servers under the accumulating priority queuing discipline, where customers accumulate priority credits as a linear function of their waiting time in the queue, at rates which are distinct to the class to which they belong. At a service completion instant, the customer with the greatest accumulated priority commences service. When the system has more than one idle server, the so-called r-dispatch policy is implemented to determine which of the idle servers is to be selected to serve a newly-arriving customer. We establish the waiting time distribution for each class of customers. We also present a conservation law for the mean waiting time in M/Mi/c systems, and study a cost function in relation to the conservation law to optimize the level of heterogeneity among the service times in M/Mi/2 systems. Numerical investigations through simulation are carried out to validate our model.

@&#INTRODUCTION@&#
Multi-server, multi-class queues (or service systems) have been used to model waiting times in areas as diverse as call centres, emergency departments, grocery stores, and other situations arising in daily life where randomly-arriving customers compete for limited resources. In a grocery store, a long waiting time is merely a matter of inconvenience, but in an emergency department, it might precipitate a change in a patient’s acuity, or even be life-threatening. For these reasons of continuing importance, such queues remain an area of ongoing research interest and importance.Most queuing models of multi-server systems make the assumption that all servers are equally capable, so that it does not matter which server is selected when several of them are idle. In reality, however, often it is not reasonable to assume every server can render service at the same speed. This reality is equally prevalent in health care systems as it is elsewhere, except the consequences can be more severe, in that an unanticipated long wait due to inaccurate modelling might impact a patient’s health status markedly. One example would be that different doctors may treat patients at different speeds in an endoscopy suite, as they are distinct human servers. Another example would be two imaging machines in a hospital working at significantly different speeds, simply because one is based upon older technology than the other. Appropriate queuing models which explicitly model the heterogeneity among service speeds are particularly called for in such multi-server settings, so as to better reflect the reality of many health care (and other) systems.Efforts to operate a heterogeneous multi-server system more efficiently fall into one of two broad strategies. The first strategy deals with the choice of server whenever there are multiple servers available to serve a newly-arriving customer. In these situations, various policies may be enforced so as to dictate the choice of server, among all of the idle servers, in a fashion that optimizes system performance. Such policies are known as “server dispatch” policies (e.g. the Randomly Chosen Server dispatch policy). The second strategy addresses the choice of customer whenever there are multiple customers waiting to be served by the next available server. Various queuing disciplines can be applied in these situations. In particular, for systems where certain types of customers require faster access to the servers, priority queuing disciplines are appropriate. The goal of this paper is to make novel contributions in both types of strategies. With respect to the former, we develop a conservation law for the average waiting time, which depends upon the server dispatch policy. With respect to the latter, we determine the waiting time distributions for each class of customers, under a unifying model called the “Accumulating Priority Queue” (APQ) which we define below. In particular, we can recover the waiting time distributions both for the first-come first-served (FCFS) queue and for traditional priority queues from this model.There have been numerous advances in both areas in the literature. Efforts to determine who is to be selected for service among distinct classes of waiting customers originally resorted to what we call the “classical” priority queuing discipline (Kesten & Runnenberg (1957)), in which a customer belonging to a given priority class is selected for service only when there are no waiting customers from higher priority classes. Customers from low priority classes in such a situation can be repeatedly overtaken by customers from higher priority classes whenever any are present in the queue. (By “overtaken”, we are referring to those customers from higher-priority classes who arrive later than, yet enter service prior to, the specified customer from the low-priority class.) Thus, it can appear as if the customers from the lower-priority class are not making any progress towards entering service.A further development that addressed this phenomenon occurred in 1964, when Kleinrock (1964) first proposed a priority queuing discipline which he named the “time-dependent priority queue”. In this discipline, waiting customers earn priority credits while they wait, at a rate that depends upon their priority class. Whenever a server becomes available, it selects the waiting customer with the greatest accumulated priority to that instant. In such a situation, a customer from a low priority class progressively earns more and more priority credits, thereby making it harder and harder to be overtaken as time progresses by customers from higher priority classes. For such a model, Kleinrock (1964) obtained a recursive set of formulas to obtain the average waiting time for each class of customers, in the single-server case.Recently, Stanford, Taylor, and Ziedins (2014) reconsidered the time-dependent priority queuing model, which they renamed the “Accumulating Priority Queue” (APQ). They derived the waiting time distributions for different priority classes in a single-server system. Stanford et al. (2014) were motivated by applications in health care systems. As a specific example, they considered the Canadian Triage and Acuity Scale (CTAS) Canadian Association of Emergency Physicians, which classifies patients according to the Key Performance Indicators (KPIs) described in Table 1. Despite being a clinical standard, as the acuity of the patient classes diminishes, so too does the clinical need.It is clearly appropriate to assign absolute priority for severely ill patients (for example, KPI-1 & KPI-2). However, for the other classes where the potential for severe health degradation is not evident, it is more appropriate to reflect the incurred waiting time of a patient when assigning its current priority. (Furthermore, these respective groups of severely ill and less urgent patients are often treated in different areas of a hospital, which justifies modelling each at its own queue.) The APQ discipline provides a more balanced approach to select customers for service, and consequently better regulates wait times for various classes of customers. Under the APQ, a patient from a lower priority class who goes through an extraordinarily long waiting time will eventually accumulate enough priority to enter service before recently-arriving patients from some higher priority class.Sharif, Stanford, Taylor, and Ziedins (2014) extended the work of Stanford et al. (2014) to the multi-class multi-server APQ with Poisson arrivals and a common exponential service time. They established the waiting time distributions for various classes of customers in such a homogeneous multi-server system. They also commented on how to select the accumulation rates to meet a specific goal for each priority class.Returning to the issue of server dispatch policies, work in this area was initiated by Morse (1958), who in 1958 was the first to consider the analysis of multi-server systems (although his main focus was on homogeneous cases). Saaty (1960) found the Laplace–Stieltjes transform (LST) of the transient probabilities of multi-server FCFS queues with Poisson arrivals and exponential service times at a common rate, where the explicit expressions for the stationary probabilities were derived for the two-server case. Subsequently, he discussed the LST of the transient probabilities in the two-server system with two different exponential service distributions operating under a specific server dispatch policy (i.e., when both servers are idle, the server is chosen by an arriving customer according to the proportion of its service rate to the total service rate).Gumbel (1960) discussed an M/Mi/c queue with c heterogeneous servers under the Randomly Chosen Server (RCS) dispatch policy. He derived expressions in closed form for the stationary probabilities and the expected queue length. He also pointed out that there is no equivalent system with homogeneous servers present. (By “no equivalent system”, we mean there exists no homogeneous system which simultaneously has the same probability of all servers being busy, and the same aggregate service rate.) He then analyzed the degree of error incurred from the assumption that each server is working at an equal rate which is the average of all the service rates. Krishnamoorthi (1963) studied an M/Mi/2 queue with two heterogeneous servers under a general server dispatch policy, where a newly-arriving customer chooses server 1 with probability p1 and server 2 with probability1−p1when both servers are idle. The LST of the transient state probability distribution of the queue length was derived.Singh (1970) considered an M/Mi/2/N/(β) queue with two heterogeneous servers operating under the following two rules: (i) when both servers are idle, customers always choose the fast server and (ii) when both servers are busy, a customer joins the system with probability β and starts to wait. A cost model was discussed in his paper, and various tables and graphs representing the average characteristics of both the homogeneous and heterogeneous systems were given. Sharma and Dass (1989) considered an M/Mi/2/N queue with two heterogeneous servers under the general server dispatch policy considered in Krishnamoorthi (1963) to derive the probability density function of the busy period. More recently, Mokaddis and Matta (1998) studied an M/Mi/3 queue with three heterogeneous servers under the general server dispatch policy in Krishnamoorthi (1963), where they used the Gauss-Jordan elimination method to solve the stationary probabilities. Grassmann and Zhao (1997) studied a queuing system with multiple heterogeneous servers and general inputs, where the stationary probabilities were calculated using different rules to allocate the arriving jobs and computational issues were discussed.All of the cited papers focus on the queue length distributions. However, it is possible to obtain the FCFS waiting time distribution from the queue length distribution. A newly-arriving customer’s waiting time comprises one exponentially-distributed interval between successive service completions for every waiting customer found upon arrival. By conditioning upon the number of such waiting customers, and the fact that the queue length is geometric, it is possible to show that the waiting time distribution has an exponential tail.In the present work, we investigate a multi-class multi-server queue with Poisson arrivals and heterogeneous exponentially-distributed service times under the APQ and related disciplines, where different server dispatch policies are considered. We extend the APQ approach to our heterogeneous multi-server, multi-class queue, obtaining the waiting time distribution for each class of customers. By taking various limits of the ratios of the accumulation rates involved, we are able to recover the waiting time distributions for each class under both the FCFS and classical priority queuing disciplines as well.The rest of this paper is organized as follows. The model is introduced in Section 2, along with our notational conventions and relevant definitions. A conservation law for M/Mi/c systems is presented in Section 3. The probability of all servers being busy under different dispatch policies is discussed in Section 4. An optimization problem of finding the optimal level of heterogeneity in an M/Mi/2 system to minimize a particular cost function is investigated in Section 5. The waiting time distributions under the APQ and related disciplines are derived in Section 6. Numerical investigations are carried out in Section 7, and we conclude with some suggestions for future research directions in Section 8.We consider a multi-class multi-server queue with Poisson arrivals and heterogeneous servers, each with its own exponentially distributed service times. There areK∈Nclasses of customers. Customers of classk,k=1,2,⋯,Karrive independently to the queue according to a Poisson process with rate λk. A class-k customer accumulates priority while waiting at rate bk, where b1 ≥ b2 ≥ ⋅⋅⋅ ≥ bK≥ 0. A class-k customer arriving at time t will have accumulated prioritybk(t′−t)by time t′. At a service completion instant, the next waiting customer to be served is the one with the greatest accumulated priority at that instant. We observe that by settingb1=b2=⋯=bK,the FCFS case is obtained. Similarly, by settingbK=1andbk=bk+1*Mfork=K−1,K−2,…,1,the classical priority queue is obtained in the limit as M → ∞. Thus, the APQ discipline itself provides a unifying framework for all three queuing disciplines.Let A(k) denote the inter-arrival time random variable (r.v.) for class-k customers,k=1,2,…,K. Hence, A(k) has an exponential distribution with rate λk, which we simply write as A(k) ∼ Exp(λk). Furthermore, if we let A denote the aggregate inter-arrival time r.v., then by the aggregation property of Poisson processes (see, for instance, Conway, Maxwell, & Miller (2003)), it follows that A ∼ Exp(λ), whereλ=∑k=1Kλk. Conversely, from another well-known property of independent Poisson processes, we understand the probability that a randomly chosen customer belongs to class k to be λk/λ.There arec∈Nservers in the system, whose service times are independent and exponentially distributed with heterogeneous service ratesμi,i=1,2,⋯,c.We letμdenote the service rate vectorμ={μ1,⋯,μc}and assume, without loss of generality, that μ1 ≥ μ2 ≥ ⋅⋅⋅ ≥ μc≥ 0. We define the cohort inter-completion time to be the time between service completions when the full cohort of c servers is working in parallel. Whenever all servers are busy, the cohort inter-completion times are exponentially distributed at the sum of the ratesμa=∑i=1cμi.The utilization levels, overall and by class, are defined byρ=λ/μaandρk=λk/μa,so thatρ=∑k=1Kρk. To ensure the system is stable we assume that ρ < 1, thereby ensuring that the system becomes idle occasionally, with probability one.When a customer arrives during an idle period, it commences service with one of the idle servers based on the employed server dispatch policy. The family of server dispatch policies which we consider in this paper are those covered by the so-called “r-dispatch policy”, introduced by Doroudi, Gopalakrishnan, and Wierman (2011). Specifically, if we let C denote the set of idle servers for the current state, then, under the r-dispatch policy, the probability that server i ∈ C is chosen to serve the newly-arriving customer is given by(1)pi(C;r)=(μi)r∑j∈C(μj)r,r∈R.The principle advantage of this approach is that it enables us to recover four popular server selection strategies by an appropriate choice of r. Settingr=0leads to the Randomly Chosen Server (RCS) policy; as r → ∞, it approaches the Fastest Server First (FSF) policy; asr→−∞,it approaches the Slowest Server First (SSF) policy; and settingr=1results in the Rate Balancing Selection (RBS) policy.Consider the case when all servers are idle. For simplicity, we write fori=1,2,⋯,c,pi=pi({1,2,⋯,c};r). The RCS implies thatp1=p2=⋯=pc=1/c,whereas the FSF implies thatp1=1,andpi=0fori=2,3,⋯,c,the SSF implies thatpc=1,andpi=0fori=1,2,⋯,c−1,and RBS implies thatpi=μi/μa,fori=1,2,⋯,c.With multiple heterogeneous servers, we require a measure of the level of heterogeneity when comparing otherwise similar systems. The Gini index arose in the field of econometrics, as a measure of disparity in income distributions. Alves, Yehia, Pedrosa, Cruz, and Kerbache (2011) suggested the application of the Gini index in the multi-server queuing system to measure the degree of disparity (i.e., level of heterogeneity) in server speeds. We define a vector of Gini-like coefficients denoted byGto evaluate the level of heterogeneity in the multi-server system, so that,G={Gi,i=1,⋯,c.}. The ith such index Giis defined by(2)Gi=μ1−μiμ1+μii=1,⋯,c.As the level of heterogeneity increases, it is reflected in an increased Gi: with μ1 ≥ μ2 ≥ ⋅⋅⋅ ≥ μc, it is readily seen that0=G1≤G2≤⋯≤Gc≤1. (When no subscript appears for G, it is to be assumed thatG=Gc,the largest level of heterogeneity in the system.)Whenever all the values inGare zero, we are dealing with a homogeneous system of identical server speeds. If any value Gj∈G;j=2,⋯,capproaches one, it means that the fastest server is orders of magnitude faster than the jth server, which implies that for the slower servers l > j, Glalso approaches one.In this section, we derive a conservation law for the mean waiting times associated with any non-preemptive and work-conserving M/Mi/c system such as the one considered in this paper. Note that our conservation law builds upon the well-known conservation law pertaining to the M/G/1 case which was first established by Kleinrock (1965, 1976). To obtain this conservation law, one deals with the unfinished workload process U(t), defined to be the total amount of work present in the system at time t still to be completed by the server. Specifically, if we letU¯=limt→∞E{U(t)},then Kleinrock’s conservation law can be expressed as(3)∑k=1KρkWqk=U¯−W0where W0 denotes the average residual service time, ρkrepresents the long-run fraction of time that the server is occupied with work from class k, andWqkdenotes the class-k mean waiting time, fork=1,2,…,K. In the M/G/1 case, Kleinrock (1965, 1976) is able to establish thatU¯=W0/(1−ρ)andW0=(∑k=1KλkE{Sk2})/2whereE{Sk2}denotes the second moment of the service time distribution for class-k customers. All work-conserving queuing disciplines satisfy these results.Turning to the multi-server heterogeneous case, our extension of the unfinished workload is the release time at time t, denoted by V(t), which we define as the amount of time until a server can become idle, given the work present at time t. It is readily seen that in a single-server system, the release time and the unfinished workload are the same. A typical sample path of the release time is shown in Fig. 1.The proof which follows requires the system to be work-conserving, so that Fig. 1 applies. This means that servers never become idle when there is work to be done, customers do not renege, and the release time process only increases at arrival instants by the amount of work the arriving customer brings into the system. For clarity of exposition, we assume that the system is non-preemptive, but this can in fact be relaxed to allow for preemptive resume systems. The resulting theorem can be stated as follows:Theorem 3.1For any stable M/Mi/c system operating under any non-preemptive work-conserving queuing discipline, we have(4)∑k=1KρkWqk=V¯−V0whereV¯=limt→∞E{V(t)}represents the limiting expected value of V(t) over time, and V0denotes the expected residual cohort inter-completion time.Paralleling Kleinrock’s derivation in Kleinrock (1976), section 3.4, we can express V(t) as(5)V(t)=x0+∑k=1K∑i=1Nqk(t)xikwhere x0 denotes the residual cohort inter-completion time if all servers are busy at time t,Nqk(t)represents the number of waiting customers present from class k at time t, and xikrepresents the cohort inter-completion time from when the ith waiting customer from class k commences service until the subsequent service completion instant by any server. The xik’s are non-overlapping and independent of each other, with each being exponentially distributed at rateμa=∑l=1cμl. Therefore, lettingNqk=limt→∞Nqk(t)denote the limiting number of class-k customers in the queue, by taking expectations on both sides of Eq. (5) we obtain(6)limt→∞E{V(t)}=V0+limt→∞∑k=1KE{Nqk(t)}/μa=V0+∑k=1KE(Nqk)/μa=V0+∑k=1KλkWqk/μa,where the latter equation arises as a result of Little’s Law Little (1961). Therefore(7)V¯=V0+∑k=1KρkWqkand by rearrangement, Eq. (4) is obtained.□In order to proceed further, we need to determine the probability that all servers are busy, which in turn depends upon the server dispatch policy. We therefore defineπ(μ, c; r) as the probability that all c heterogeneous servers are busy under the particular r-dispatch policy in effect. Two facts facilitate the following analysis. In a multi-server work-conserving system:(1)The dispatch policy only affects the state transitions when at least two servers are idle, which in turn affects the global probability that all servers are busy. It has no effect once all servers are busy.The APQ mechanism affects who is selected for service when a choice needs to be made. However, it does not affect the total number of customers present, as the service distributions depend upon the specific servers, but not upon any customer characteristic.Once all servers are busy, aggregate customer arrivals to the system occur according to a Poisson process at rate λ, while the cohort inter-selection times are exponentially distributed at rate μa. Thus, when the system is busy, transitions between adjacent such states follow the classical birth-and-death behaviour (as seen from the rightmost part of Fig. 2) in Section 4. Forn=0,1,2…,let πnbe the stationary probability of n customers in the system. The portion of the state transition diagram pertaining to busy states, when solved according to the birth-and-death equations, gives rise to a geometric tail relative to the state πcwhen all servers are busy but no one is waiting, yieldingπn=πcρn−c;n≥c,so that(8)π(μ,c;r)=∑n=c∞πn=πc1−ρ.The probability of c customers present in the system, πc, depends on the dispatch policy in the system. Thus, the probability of all servers being busy is affected by the dispatch policy, but not by the APQ discipline.Corollary 3.2In any M/Mi/c system and any non-preemptive work-conserving queuing discipline, for a given r-dispatch policy, we have(9)∑k=1KρkWqk=π(μ,c;r)μa·ρ1−ρ,ρ<1.Since the cohort inter-selection time is only positive once all servers are busy, it follows that(10)V0=π(μ,c;r)(1μa).As Poisson arrivals see time averages (see Wolff (1982)), the average release time will be the same as the mean waiting time for the aggregated class of all customers, which can be computed using Little’s Law in Little (1961) as(11)V¯=1λ∑i=1∞iπc+i=1λ∑i=1∞iρiπc=πcμa(1−ρ)2=π(μ,c;r)μa(1−ρ)=V01−ρ.Substitution forV¯and V0 in Eq. (4) using Eqs. (11) and (10) leads to Eq. (9).□In an M/Mi/c queue, as Gi→ 1, μ1 → μaand μi→ 0 fori=2,3,⋯,c,thenπ(μ,c;r)→ρ,⇒π(μ,c;r)μa·ρ1−ρ→ρ2μa(1−ρ),which means that the conservation law for M/Mi/c queues approaches the conservation law for M/M/1 queues as the level of heterogeneity increases to one in the heterogeneous system.Kleinrock and Finkelstein (1967) derived the expressions for the average waiting times for different classes in a single-server APQ. By direct parallel in the multi-server case, the average waiting time for class-k in a multi-class APQ with heterogeneous servers, fork=1,2,⋯,K,is readily found to be given by(12)Wqk=π(μ,c;r)/(μa−λ)−∑j=k+1Kρj(1−bj/bk)Wqj1−∑j=1k−1ρj(1−bk/bj).Having determined the conservation law in terms ofπ(μ, c; r), we turn in the next section to how to determine this probability in terms of the specified dispatch policy.An arriving customer in our model may find that:•At least one server is idle, in which case it will be assigned to a server according to the r-dispatch policy in effect (whenever two or more servers are idle).All servers are engaged, in which case it starts to wait and accumulate priority.In what follows, we focus on the calculations of the stationary probabilities,πn;n=0,1,…,c,when no one is waiting, where the dispatch policy can matter. The remaining state probabilitiesπn;n=c+1,c+2,…are related to πcviaπn=πcρn−c,regardless of the server dispatch policy.In 1960, Gumbel (1960) derived the stationary probabilities under the assumptions of Poisson arrivals and exponentially distributed service times, with a different service rate for each server under RCS. The RCS policy satisfies the local-balance equations, and as such, it was possible for Gumbel to come up with an explicit product form solution for the stationary distribution, for all c. The stationary probabilityπ(μ, c; 0) can be directly calculated from his work:(13)π(μ,c;0)=πc1−ρ=(11−ρ+∑j=1cj!Cjc)−11−ρ=11+(1−ρ)∑j=1cj!CjcwhereCjc=1λj∑a1=1c−j+1∑a2=a1+1c−j+2⋯∑aj−1=aj−2+1c−j+j−1∑aj=aj−1+1cμa1μa2⋯μaj.For example,C23=1λ2∑a1=12∑a2=a1+13μa1μa2=(μ1(μ2+μ3)+μ2μ3)/λ2. Note thatCcc=Πi=1cμiλ,C1c=∑i=1cμiλ=1/ρandC0c=1.As for non-RCS dispatch policies, in 1963, Krishnamoorthi (1963) studied the Poisson queue with two heterogeneous servers, where the stationary probabilities were solved via differential-difference equations. The stationary probabilities can also be obtained from the global balance equations. Let states (1, 0) and (0, 1) denote the states where one server is busy in the system, with the position of the 1 indicating which server is busy, as well as π1, 0 and π0, 1 be their stationary probabilities respectively, whereπ1,0+π0,1=π1. When a customer arrives to an idle system, it can be served by server 1 with probability p1 or by server 2 with probability p2. By the properties of the Poisson distribution, the transition rate from state 0 to state (1, 0) is p1λ and the transition rate from state 0 to state (1, 0) is p2λ. Then, the stationary probability πncan be solved from the following global balance equations (i.e., probability flow into the state equals the flow out of the state):(14)λπ0=μ1π1,0+μ2π0,1,(λ+μ1)π1,0=p1λπ0+μ2π2,(λ+μ2)π0,1=p2λπ0+μ1π2,πn+1=ρπn,n≥2.The results of πn; n ≥ 0 are consistent with the ones in Krishnamoorthi (1963). By Eq. (2),G=(μ1−μ2)/μain the two-server case, which impliesμ1=μa(1+G)/2andμ2=μa(1−G)/2. Thus, from Eq. (8), we are able to express the stationary probabilityπ(μ, 2; r) in terms of the particular r-dispatch policy as(15)π(μ,2;r)=2λ2(1+2ρ−G(p1−p2))μa2(1−G2)−λμa(G2+2G(p1−p2)−3)+2λ2(1+G2).Subsequently, Mokaddis and Matta (1998) derived the stationary probabilities of a Poisson queue with three heterogeneous servers. They used the Gauss–Jordan elimination method to solve for the probabilities. As the results involved 52 variables, the expressions are already marginally tractable in terms of being able to interpret the impact of various parameters on the performance measures of interest, so we do not replicate their results here. Interested readers are directed to Mokaddis and Matta (1998) for the details.While it would be of interest to extend this to a system with an arbitrary number c > 3 of heterogeneous servers, one can anticipate that the expression forπ(μ, c; r) would be even more complicated than the three server case. Thus, we need to find a suitable numerical method to compute the probabilityπ(μ, c; r) for an arbitrary number of servers under non-RCS policies. In Grassmann (2000), several numerical methods are introduced, such as the state reduction method and other block-elimination methods. Grassmann and Zhao (1997) also discussed several numerical methods for the solution of the heterogeneous systems and concluded that the state probabilities can be computed efficiently for up to 10 servers; however, all methods become problematic for a system with more than 20 servers. Interested readers are directed to Grassmann and Zhao (1997) for the details.When extended to a Poisson queue with c heterogeneous servers assuming exponential service ratesμ1≥μ2≥⋯≥μc,there are 2cboundary states of interest. The structure of the state transition diagram is shown in Fig. 2. In order to understand the relationships among the 2cstates, we chose three neighboring states (denoted by the three rectangular-shaped states in Fig. 2) to describe the transition process between adjacent levels.We define ijto be an indicator function, such thatij={1:serverjisbusy.0:serverjisidle.Furthermore, leti→mrepresent the collection of state vectors(i1,⋯,ic)such that∑j=1cij=m. An arrival findingm−1busy servers where m < c, causes the system to transit to a new system state, in which m servers are busy. In other words, the system changes from being in statei∈i→m−1to a statej∈i→msuch thatj−iis a vector whose entries are all zero except for the one corresponding to the server that attends to the newly-arriving customer. Similarly, if there is a service completion in a state with(m+1)busy servers, then the system changes from a statei∈i→m+1to a statej∈i→m,such thatj−iis a vector of zeros except for the entry corresponding to the server that had just become idle. Moreover, the state vectorj∈i→mindicates the set of idle servers at the current state, i.e.,Cj={s:is=0,is∈j}. We choose to write the probability that idle server s ∈ Cjis chosen under the r-dispatch policy as ps(Cj; r).To illustrate, in Fig. 2, we consider the cases for which the fastest servers are the ones that are busy during the statesi→m−1,i→mandi→m+1. In particular, if we letin*,n<c,denote the vectori∈i→nwhose first n entries are all equal to one, then the transition rate from stateim−1*to stateim*isλpm(Cim−1*;r). Similarly, the transition rate from stateim*to stateim+1*isλpm+1(Cim*;r). The transition rates from stateim+1*to stateim*and from stateim*to stateim−1*areμm+1and μmrespectively.Then, we can write the global balance equation of stateim*as follows: foris∈im*,(16)(λ+∑s:is=1μs)πim*=∑s:is=1λps(Cim−1*;r)πim−1*+∑s:is=0μsπim+1*.The left hand side of the equation represents the rate of flow from stateim*,whereλπim*is the rate of transition to stateim+1*due to an arrival, and∑s:is=1μsπim*is the rate of transition to stateim−1*due to a service completion. The right hand side of this equation presents the rate of flow into stateim*,where∑s:is=1λps(Cim−1*;r)πim−1*is the sum of arrival rates causing a transition to stateim*,and∑s:is=0μsπim+1*is the rate of transition to stateim*due to a service completion.The global balance equations for all the 2cboundary states can be written out in the form of Eq. (16). To solve forπ(μ, c; r) requires one to solve 2csuch equations in as many variables. Thus, an increase of one server doubles the number of boundary states to be solved. Since solving n equations in n variables requires O(n3) operations, this implies that the computational effort increases by a factor of 8 as a result of increasing c by 1 (see Grassmann & Zhao (1997)). This underscores even further our intent to resort to a numerical method when dealing with cases of c > 3. However, this is not the focus of this paper, so that in what follows, we consider only cases where c ≤ 3.In this section, we focus on finding the optimal level of heterogeneity G to minimize an appropriately defined cost, and an optimal range of G in which the r-dispatch policies have lower cost than the homogeneous system. We consider the following cost function:(17)F(c,r,G)=π(μ,c;r)·ρ1−ρ,where G is the decision variable. In light of Eq. (9), we can interpret F(c, r, G) as the conservation law’s right-hand side constant (scaled in units of 1/μa). Since μais fixed, as a result of the specified service rates, any overall system improvement gained in terms of a lower F(c, r, G) will be as a result of its particular r-dispatch policy.We have previously observed when discussing Mokaddis and Matta (1998) that the analytic expressions for the case of three or more servers are too complicated to ascertain the influence of specific parameters. However, in the two-server case, we are able to establish some analytical results about optimal levels of heterogeneity.Intuitively, one might anticipate that greater heterogeneity leads to greater congestion. This is certainly true under the SSF and RCS dispatch policies, but we shall see that, in fact, there exists a range of G values in the two-server case for which our cost function in fact decreases under the FSF dispatch policy. We will postpone discussion of the RBS case to the end of the section.Lemma 5.1In a two-server queue under any work-conserving queuing discipline, for r ≤ 0 (i.e., p1 ≤ p2), the minimum value of function F(2, r, G) occurs in the homogeneous case. For r > 0 (i.e., p1 > p2), the optimal value of G that minimizes the function F(2, r, G), denoted by G*, is given by(18)G*=2ρ+1−(2ρ+1)2−(p1−p2)2p1−p2,and the range of values of G for which the function F(2, r, G) is an improvement upon the homogeneous case is(19)G∈(0,p1−p21+2ρ).Consider the probabilityπ(μ, 2; r) as given by Eq. (15), where we have arbitrarily setμa=2. We choose to make explicit the dependence of the cost function upon G; this yields(20)F(2,r,G)=2ρ3(2ρ+1−G(p1−p2))(1−ρ)(2(G2+1)ρ2+(3−G2+2G(p2−p1))ρ+1−G2).Taking the first partial derivative of F(2, r, G) with respect to G, we get(21)∂∂GF(2,r,G)=2(2ρ+1)ρ3(4ρG+(G2+1)(p2−p1)+2G)((2(G2+1)ρ2+(3−G2+2G(p2−p1))ρ+1−G2))2.It is readily seen that when r ≤ 0, Eq. (21) is nonnegative for all ρ ∈ (0, 1) and G ∈ [0, 1]. Thus, no improvement can be gained over a homogeneous system when r ≤ 0.Turing to the case where r > 0, we compute the second partial derivative(22)∂2∂G2F(2,r,G)=8ρ3(2ρ+1)(2(G2+1)ρ2+(3−G2+2G(p2−p1))ρ+1−G2)3·(2(1−3G2)ρ3+(4+(p1−p2)G(G2+3))ρ2−12((p1−p2)G(G2+3)−9G2+2(p1−p2)2−5)ρ−12(p1−p2)G(G2+3)+12(1+3G2))≥4ρ3(4ρ2(ρ+2)−ρ(2(p1−p2)2−5)+1)(2ρ+1)2(ρ+1)3>0.Thus, the second partial derivative of F(2, r, G) is positive for all ρ ∈ (0, 1) and G ∈ [0, 1]. (We note that the second last line above corresponds to the curvature in the homogeneous case.) To find the optimal value of G in this case, we set Eq. (21) equal to zero, and solve for G*, obtaining Eq. (18). In particular, the optimal level of heterogeneity that minimizes the function F(2, ∞, G), the FSF policy, occurs atG*=1+2ρ−2ρ(1+ρ).When r is sufficiently large (as discussed in Corollary 5.2), it is possible to find a lower cost function F(2, r, G) than the one in the homogeneous case which is2ρ3/(1−ρ2). The optimal range of G obtained for which the function F(2, r, G) is an improvement upon the homogeneous case is given by(23)F(2,r,G)<2ρ31−ρ2,⇒0<G<p1−p21+2ρ.□Eq. (19) shows that the optimal range of the level of heterogeneity decreases as ρ increases.Lemma 5.1 shows that under the RCS and SSF cases where p1 ≤ p2, the SSF and RCS dispatch rules have higher cost than the homogeneous case. The second half of the lemma establishes FSF has a range of values of the level of heterogeneity in the system which can result in a lower cost then the homogeneous case. While this would seem at first glance to be true as well for RBS since p1 > p2, in fact under RBS, it is seen thatG=p1−p2which exceeds the upper limit. A modification to RBS which attenuates sufficiently the probability of selecting the faster server could lead to improvement over the homogeneous case.Consider a two-server queue operating under a work-conserving queuing discipline, and define(24)r*=ln(μ1+ρ(μ1−μ2))−ln(μ2−ρ(μ1−μ2))ln(μ1)−ln(μ2).Then an improvement can be gained over the homogeneous system with the same aggregate rate if and only if r > r*.In order to find the range of r which can lead to a lower cost than the homogeneous case, we take the difference, for simplicity denoted as DG, between the Gini-like coefficient G from the definition in Eq. (2) and the upper bound of G in Eq. (19).(25)DG=G−p1−p21+2ρ=μ1−μ2μa−μ1r−μ2r(μ1r+μ2r)(1+2ρ).When DG≥ 0, the corresponding r-dispatch policy may have a higher cost than the homogeneous case; while, when DG< 0, a lower cost can be found. As G ∈ [0, 1] andp1−p2∈[−1,1],−1/(1+2ρ)≤DG≤2(1+ρ)/(1+2ρ). Moreover, DGis decreasing with r. Thus, there is a single point of r to separate the case of DG≥ 0 and DG< 0, and we denote this point by r*. Clearly, r* is the solution whenDG=0,as shown in Eq. (24). So, when r > r*, DG< 0, which means that an improvement can be gained over the homogeneous case.□Having obtainedπ(μ, c; r) and the mean waiting times in terms of the dispatch policy, in the next section we turn to the determination of waiting time distributions for the APQ discipline in the multi-server heterogenous setting.We seek the waiting time distribution before service commences under the APQ discipline in terms of its LST for each customer class. From these results, we will obtain the corresponding distributions under the FCFS and classical priority disciplines by appropriate choices of the accumulation rates. The numerical examples to follow in the next section will be obtained via numerical inversion of the corresponding LSTs.Fork=1,2,…,K,letW˜(k)(s;μ,c,r)denote the LST of the stationary class-k waiting time distribution in an M/Mi/c APQ under the r-dispatch policy and with service rate vectorμ. LetW˜+(k)(s;μ,c)be the LST of the corresponding conditional waiting time distribution of a delayed class-k customer. Then fork=1,2,…,K(26)W˜(k)(s;μ,c,r)=(1−π(μ,c;r))+π(μ,c;r)W˜+(k)(s;μ,c).Lemma 6.1The LST of the conditional waiting time distribution for class-k operating under the APQ discipline in the M/Mi/c queue can be related to the comparable measure in an M/M/1 APQ as follows:(27)W˜+(k)(s;μ,c)=W˜+(k)(s;μa,1);k=1,2,⋯,K.When the cohort is fully busy, the cohort inter-completion times are exponentially distributed with parameterμa=∑j=1cμj. The same is true of a busy single exponential server working at rate μa. Thus, given the same arrival classes and distributions operating under the APQ discipline, the conditional waiting time distributions must be the same.□The same idea applied here was also used for the multi-server APQ with a common service rate in Sharif et al. (2014).The foregoing lemma enables us to invoke the conditional waiting time results of Stanford et al. (2014) for the single-server case with service rate μa, which allows for class-dependent service time distributions. The various conditional waiting time distributions therein were obtained in a recursive fashion, starting with the lowest priority class. Likewise, we start from that perspective in the heterogeneous c-server case.One further concept is needed in order to state the relevant result. It is possible for customers of a given class (say, class k), or higher, to eventually accumulate enough priority to exceed the maximum possible credit of a class-(k+1)customer by that given point in time. Such customers are said to have gained “accreditation relative to class-(k+1)” (see Stanford et al. (2014)). LetΓ˜k(s),k=1,2,⋯,Kbe the LST of the duration of a busy period during which customers gain accreditation relative to class-(k+1). In other words, it represents the LST of the time interval required to clear the system of those customers who have gained accreditation relative to class-(k+1). Its duration is the same as the duration of the busy period of an M/M/1 queue with arrivals ratesΛk=∑i=1kλi(1−bk+1/bi)and service rate μa. It is well-known (Conway et al. (2003)) that the solution to the implicit equation for the busy period LST in this case is given by(28)Γ˜k(s)=(μa+Λk+s)−(μa+Λk+s)2−4Λkμa2Λk.Theorem 6.2The waiting time distribution for the lowest priority class, conditional on it being positive, has LST(29)W˜+(K)(s;μ,c)=μa(1−ρ)μa(1−ρ)+g(s)whereg(s)=s+ΛK−1(1−Γ˜K−1(s)).The waiting time for a delayed class-K customer can be viewed as consisting of two components. The first component is the virtual workload present upon their arrival, whose distribution is the same as the stationary waiting time of delayed customers in the equivalent M/M/1 queue with service rate μa. The second is the additional delay introduced by the customers of higher classes who overtake the marked class-K customer. This portion of the delay represents a “delay busy period” in the sense of (Conway et al. (2003), page 151). When appropriate substitutions are made, Eq. (29) is obtained. The interested reader is directed to Stanford et al. (2014) for further details on this approach.□Under the FCFS discipline, the waiting time distribution for all classes, conditional on it being positive, is exponentially distributed with parameterμa(1−ρ).The result follows directly from Theorem 6.2. First of all, note that by settingb1=b2=⋯=bK,the APQ discipline becomes exactly the FCFS discipline. Furthermore, under this setting, it is readily observed thatΛK−1=0. Therefore, it follows from Eq. (29) that(30)W˜+(K)(s;μ,c)=μa(1−ρ)μa(1−ρ)+s,which is the LST of an exponential distribution with parameterμa(1−ρ). The extension of the above result to the remaining classes is due to the fact thatW˜+(1)(s;μ,c)=W˜+(2)(s;μ,c)=⋯=W˜+(K)(s;μ,c)under the FCFS discipline.□Returning to the general case, the recursion we employ to obtain the waiting time distributions for the higher priority classes proceeds in sequence fork=K−1,K−2,…,1on account of Eq. (27) and the corresponding result in Stanford et al. (2014) as follows:(31)W˜+(k)(s;μ,c)=(bk+1bk)W˜+(k+1)(bk+1bks;μ,c)+(1−bk+1bk)W˜acc(k)(s)whereW˜acc(k)(s)is defined as the LST of the waiting time of a class-k customer who is served “at accreditation level k”. A discussion of accreditation and the related formulas needed to determine the waiting time distributions can be found in the Appendix, as well as the waiting time expressions for the classical priority queue.Our first numerical example is loosely drawn from the CTAS model, assuming servers working at heterogeneous rates. We mainly focus on CTAS-3 (urgent) and CTAS-4 (less urgent) patients with the APQ model. From Table 1, the KPI-3 suggests that CTAS-3 patients should be seen within 30 minutes at least 90 percent of the time; and the KPI-4 suggests that CTAS-4 patients be seen within 60 minutes at least 85 percent of the time.We use the Gaver–Stehfest (GS) algorithm (Abate & Whitt (2006)) withM=5to invert the LSTs of the waiting time distributions, which can provide four significant digits of accuracy. Simulation experiments were carried out to verify the results from GS. Each simulation run consisted of one million customers.We start with the results for a two-class, two-heterogeneous-server APQ model with 4 types of dispatch policies (RCS, FSF, SSF and RBS) comparing the class-1 (CTAS-3) with class-2 (CTAS-4) patients, based on the following parameters: the arrival rates areλ1=0.9andλ2=0.8for class-1 and class-2 patients, respectively, while the service times are exponentially distributed withμ1=1.9andμ2=0.1(resulting inG=0.9) for server 1 and server 2 respectively. Thus, the resulting occupancy level ρ is 85  percent with the assumed parameters. In all of our examples, we setb1=1and let b2 ≡ b which assumes one of the three values in {0, 0.5, 1}.Fig. 3shows the waiting time distributions of class-1 and class-2 under RCS. We note that the Gaver–Stehfest evaluation and the simulation result forb=0.5,which was run as a check, overlap each other, thereby confirming the accuracy of the results. In Fig. 3(a) , we notice the cumulative distribution function (c.d.f.) of the waiting time for class-1 is stochastically smallest whenb=0(i.e., classical priority) and stochastically largest whenb=1(i.e., FCFS), as expected. To ensure class-1 patients meet their CTAS requirement, the maximum value of b is 0.1531. Similarly, in Fig. 3(b) , the c.d.f. of the waiting time for class-2 is stochastically smallest whenb=1and stochastically largest whenb=0. A minimum value of b ≥ 0.9069 is required in order for class-2 patients to meet their target. Thus, there is no common value of b so that both classes can simultaneously meet their KPIs for the given arrival and service rates.We also have tested our model in the homogeneous case with a common service rateμ1=μ2=1(G=0), where the parameters used are the same as Sharif et al. (2014). We remark that our results are in agreement with theirs. In the homogeneous case, the maximum value of b to allow class-1 patients to meet their requirement is 0.1647, and the minimum value of b for class-2 to meet their target is 0.825, so we can see that heterogeneity makes it harder to comply with the KPIs.Next we address the impact of the level of heterogeneity on the chosen cost function F(2, r, G) for the two-server case, as a measure to compare the system under different dispatch policies. We present a series of graphs with G to represent different levels of heterogeneity among the servers on the x-axis and the values of the cost function on the y-axis, under the assumption ofλ1=λ2andμa=2. For the first scenario, we setρ=81percent,which is the maximum ρ to comply with the KPIs in the two-server case as shown in Table 2. The second scenario is forρ=90percent,which can be considered as an example of the heavily loaded case. In Fig. 4, the dark grey horizontal line indicates the cost function of the homogeneous system. Several facts can be observed based on Fig. 4:•As the level of heterogeneity increases, the value of the cost function increases and the system performance decreases.The performance of the heterogeneous system can be better than the homogeneous system at some levels of heterogeneity, under FSF. The optimal areas are bounded by the dark grey horizontal line and the red dashed curve on Fig. 4.The system performance can be ranked, with FSF being best, followed by RBS, and then RCS, and lastly SSF, as anticipated. RBS is more likely to select a faster server than RCS.When the utilization level increases, the optimal area for which FSF outperforms the homogeneous system is diminished in size.We next explore the effect of the level of heterogeneity on the value of b for which both KPI targets can be met. To answer this question, we have plotted the extremal values of b against G for each class in the two-server case withλ1=λ2,μa=2andρ=ρmax=81percent. In the case of Fig. 5(a), and (b), these correspond to the maximal values of b for which the class-1 and class-2 KPI targets are met, respectively. From Fig. 5 we observe that•The maximal values of b for the class-1 KPI target is decreasing as the level of heterogeneity increases, and the range of maximal values is bounded by FSF and SSF, while the minimal values of b for the class-2 KPI target is increasing with the level of heterogeneity.The FSF dispatch policy gives the greatest range of b values for which both classes meet their targets. In Fig. 5, b needs to be less than 0.298 for class-1 patients, while b needs to be greater than 0.256 for class-2 patients. For both classes to meet their KPI targets whenG=0.19,b must satisfy 0.256 ≤ b ≤ 0.298, which is the greatest range of b under the utilization levelρ=81percent. When G approaches one, the values of b for class-1 KPI is less than 0.264, and for class-2 KPI is greater than 0.387, which means that there is no region of b for which both classes meet their targets. This is consistent with the results from Table 2.The optimal range of the level of heterogeneity that promises the maximum range of b for the KPI targets is the same for both classes of patients, and the same as the one for the cost function in Fig. 4(a) .As we noted above withρ=85percent,we cannot find a common b so that both classes of customers can meet their KPI targets. It is therefore a matter of interest to wonder what values of b and utilizations ρ enable both classes to meet their KPIs. In order to answer this question, we illustrate a “feasible region” for such a goal by plotting the total utilization ρ on the x-axis and the values of b along the y-axis. The feasible region which contains the permissible combinations of b and ρ is the doubly-shaded area bounded by the maximal rate b for which the class-1 KPI can be met (black curve) and the minimum rate of b for which the class-2 KPI can still be met (red curve).We compare the two-class two-server case and three-server case with equal arrival ratesλ1=λ2and a fixed sum of service ratesμa=2withG=0.9under FSF, that is,μ1=1.9andμ2=0.1. Sinceρ=λ/μawhereμa=2andλ1=λ2=λ/2,thenλ1=λ2=ρ. To be noted, the stationary probabilityπ(μ, 3; r), forr={−∞,0,1,∞}, are calculated by solving the global balance equations. As the expressions are very complicated, we choose not to present them in this paper. The interested readers are directed to (Li, 2015, Appendix A.3).Fig. 6(a) presents the two-server case. We found that when ρ > 80.4 percent, no value of b can allow both classes of customers to meet their KPI targets simultaneously; when ρ ≤ 80.4 percent, there is at least one b value for which both classes simultaneously meet their KPIs. Thus, we call the specific utilization level that distinguishes the single permissable value of b for which both classes meet their KPI targets as the maximum ρ, and the corresponding b as the optimal b. In this case, the optimal b is 0.288. Fig. 6(b) presents the three-server case with equal arrival rates,μa=3andG={0,0.31,0.9},that is,μ1=1.9,μ2=1andμ3=0.1. The two graphs appear similar; however, the values of the maximum ρ increased to 86.9 percent and optimal b increased to 0.34 as the number of servers increased.Table 2 presents the maximum ρ and optimal b for the two-class two-server case and three-server case with equal arrival rates and a fixed sum of service rates at different levels of heterogeneity under four dispatch policies: SSF, RCS, RBS, FSF. We observe that the value of ρmaxdecreases as the level of heterogeneity increases. Furthermore, the differences in the optimal b values for the various dispatch rules under a given level of heterogeneity occur at the third decimal place.

@&#CONCLUSIONS@&#
We have addressed two distinct aspects when studying a heterogeneous multi-server queue. In the first instance, we considered the queuing systems operating under the so-called “r-dispatch policy” to determine which of the available servers is to be used to serve a newly arriving customer. This policy is quite flexible and is able to capture several traditional server dispatch policies including RCS, FSF, SSF and RBS. We then ponder the question of how to determine the optimal server dispatch policy, among the four popular server dispatch policies above, in order to improve the system performance relative to the corresponding homogeneous system. To answer this question, we first presented a conservation law for a heterogeneous multi-server system, under any non-preemptive work-conserving queuing discipline, with a given server dispatch policy. Then, we were able to find an optimal level of heterogeneity to minimize an appropriate cost which arises as a result of this conservation law.In the second instance, we addressed the question of who to select next for service when there are different classes of customers present. The accumulating priority queue is the modern name for the “delay dependent queue discipline” introduced by Kleinrock in 1964. This model allows customers to accumulate priority while they wait, at a rate that reflects their class’s relative importance. The customer with the greatest accumulated priority at service completion epochs is the one selected for service. The principle advantage of the accumulating priority queuing discipline is that it balances the advantages of the FCFS and the classical priority queuing disciplines — priority matters, but long waiting times do as well. Further, we can regain each of these limiting cases by appropriate choices of the accumulation rate parameters. We then derived the waiting time distributions for all customer classes under the accumulating priority queue, and obtained the waiting times for the two other cases as a by-product. We concluded by carrying out several numerical experiments for validating our model and investigating the impact of the level of heterogeneity under different server dispatch policies.We anticipate two major directions for future extensions of M/Mi/c APQs. First, one may consider some optimization problems, such as, how to select the parameter set{bk;k=1,⋯,K}to minimize an appropriately defined cost or meet certain waiting time targets. Second, one may consider the situation where the service time distributions are non-exponential. Such a problem is non-trivial, although some results might be possible in the case of the service time distributions built upon the exponential. Other types of server dispatch policies can be considered in such systems, for instance, the idle-time-based dispatch policies including Longest Idle Server First (LISF), and Shortest Idle Server First (SISF). Another extension for the multi-server systems we are currently studying is a multi-class multi-server APQ where the service rate depends on the customer’s class type, rather than the server. However, this problem is complicated by the possible combinations of customer types in service at the beginning of an accreditation interval, which is an aspect we hope to resolve in the near future.