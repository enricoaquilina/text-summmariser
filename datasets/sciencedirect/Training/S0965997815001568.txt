@&#MAIN-TITLE@&#
Optimum topological design of negative permeability dielectric metamaterial using a new binary particle swarm algorithm

@&#HIGHLIGHTS@&#
Using of a binary version of PSO adapted to topology optimization.Application on electromagnetic metamaterials.Obtention of frequential cloaking devices.

@&#KEYPHRASES@&#
Electromagnetic metamaterials,Topology optimization,Binary Particle Swarm Optimization,Finite Element Method,Cloaking device,Negative permeability,

@&#ABSTRACT@&#
This paper presents a Particle Swarm Optimization-based topology optimization method for the design of negative permeability dielectric metamaterials.As the electromagnetic metamaterials have some physical properties not available in nature, they have attracted a huge scientific research interest for decades. In fact, electromagnetic metamaterials can exhibit simultaneously negative permeability and negative permittivity. The aim of this work is to find an optimal topology of a dielectric metamaterial that achieves negative permeability at a given frequency. A binary Particle Swarm Optimization is developed and applied to a negative permeability dielectric metamaterial topology design problem. The optimization process is achieved using a developed numerical model of the studied metamaterial, which is solved by the Finite Element Method.First, the governing equations and the weak formulation of the electromagnetic problem are presented. Then, the optimization problem to be solved is formulated. The developed binary Particle Swarm Optimization method, and the developed interfacing method are explained. Some numerical examples are presented to demonstrate that the binary Particle Swarm Optimization is adapted to the topology optimization of negative permeability dielectric metamaterials, at given frequencies, to demonstrate the utility and validity of the presented method.

@&#INTRODUCTION@&#
As the metamaterials have some physical properties not available in nature, they have attracted huge scientific research interest for decades. In fact, many studies have proved that the metamaterials can exhibit some extraordinary electromagnetic properties, like the negative permittivity and permeability, both due to the possibility to obtain the negative refractive index and impedance [1]. In mechanics, some research works [2] have shown the possibility to obtain negative Poisson’s coefficient with metamaterials.In general, the metamaterials have a periodic form [3]. Each unit cell is composed of a background material, along with another material which is included in the background. Even if the two materials are not extraordinary, the inclusion of the second one in the background material exhibits the physical properties of the metamaterial [4] when it is impacted by a periodic wave. The possibility to obtain these extraordinary electromagnetic properties was first proposed by Veselago [5] in 1968. He demonstrated that an original arrangement of the materials in a periodic sequence could exhibit the negative permeability and permittivity. Later, Pendry et al. [6] and Smith et al. [7,8] showed that arrangements of split-ring resonators and metalic wires can exhibit a negative refraction index at a certain frequency. They have also stated that the permeability and the permittivity can be determined knowing the scattering parameters. Furthermore, the possibility to obtain simultaneously negative permittivity and permeability by new types of metamaterials that utilize the magnetic and electric resonance phenomena of dielectric materials, rather than effects primarly derived from metallic inclusions has been shown in [9–12]. As they are isotropic, and made of dielectric materials, these new types of metamaterials could be very effective, and could be used easily in engineering systems. Holloway et al. [10] showed theoretically that designed dielectric spheres embedded in a host material can achieved negative effective permeability and negative effective permittivity simultaneously. Therefore, more practical structures have been proposed, such as spheres with different radii [11] , structures using spheres with the same radii, but with different dielectric parameters [12], and structures using cylindrical dielectric materials embedded in a host material [13]. Experimental results proposed in Zhao et al. [14], Peng et al. [15] and Shibuya et al. [16] have confirmed the obtaining of the negative effective permeability and permittivity. Therefore, Chen et al. [17], Cotuk [18], Smith et al. [7], Feng [19] and Hasar et al. [20] developed the efficient matrix methods to retrieve the effective parameters of the complete metamaterial from the scattering parameters, which can be easily be implemented.In the field of electromagnetic applications, the metamaterials are generally impacted by an electromagnetic field, and react modifying the field lines path. In fact, with a negative refraction index, and a negative impedance, the impacting field lines are able to get around the metamaterial, as can be seen in Fig. 1. Kanellopoulos et al. [21] and N’Guessan [22] demonstrated that the finite element method can be adapted and used for the electromagnetic problems at high frequencies. The aim of their work was to determine an adapted numerical modeling, a method to discretize the Maxwell laws in two and three dimensions, and the precise definition of the boundary conditions to be used. In fact, three typical techniques for the truncation of the finite element computational domain [23] have been developed and used:–First, the absorbing boundary conditions (ABC) [21] have been proposed to truncate the computational domain in the nonperiodic directions of electromagnetic structures [24]. This formulation is efficient and applicable both for scattering and radiation analysis, and can be used for the numerical implementations of infinitely periodic structures models.Secondly, a perfectly matched layer has been developed to absorb without reflection the electromagnetic waves in a structure modeled with the finite-difference time-domain method [25–28]. The perfectly matched layers have been used as some absorbing boundary conditions in the finite-element method [29] to solve the three-dimensional electromagnetic scattering problems.And thirdly, the boundary integral equations which can provide a truly perfect reflectionless boundary condition for mesh truncation at higher computational cost have been developed [24]. This method was originally implemented to truncate the computational domain [30–33] and provided exact results, although the computational cost was significantly increased. A preconditioner was also presented to accelerate the convergence to solve the equations obtained from the application of the hybrid finite-element boundary-integral (FE-BI) method to three-dimensional electromagnetic scattering problems [34]. In the developed model, the Perfectly Matched Layers (PML) elements have been used to decrease the computational cost, and obtain some the approximative results of the scattering parameters. In this way, many applications have been proposed to benefit from the extraordinary physical properties of metamaterials, such as cloaking devices [35], waveguides [36], leaky wave antennas [37], acoustic cloaking devices [38], and mechanical applications [39].Then, the research focused on the possibility to optimize the metamaterials in order to obtain the best physical properties. First, Zhou et al. [40] used a level set method for the design of electromagnetic metamaterials, by a topology optimization. The objective of the work was to obtain some double negative metamaterials, with both negative permeability and permittivity, finding an optimized layout of metallic inclusions. In this case, the objective function was formulated using current flow. Subsequently, Zhou et al. [41] proposed a second level-set-based method to optimize the electromagnetic properties of metamaterials. The aim was to express the permeability of the studied metamaterial in function of the scattering parameters, and then be able to use the permeability as the objective function in the optimization process.Therefore, Otomori et al. [42] applied the level-set method to the topology optimization of a metamaterial, in order to obtain the best electromagnetic properties. The aim of their research was to optimize especially the negative permeability of dielectric metamaterials. They used the scattering parameters to determine the effective permeability and then, the imaginary part of the effective permeability was minimized. Secondly, using the obtained results during the first optimization process, the real part of the effective permeability was minimized.Moreover, in the work of Boltasseva et al. [43], some fabrication methods of optical negative-index metamaterials were developed. Combining the works concerning the optimization of metamaterials, and the work of Boltasseva et al. [43], one can think about the possibility to use the metaheuristic methods to optimize the physical properties of electromagnetic metamaterials, such as the effective permeability. In fact, for many optimization problems, there are no deterministic methods reliable enough to obtain the satisfying results. Indeed, these optimization methods can converge to local optima, calculating the sensibilities. So, even if there is no mathematical proof of the global convergence of the metaheuristic methods, they can be used to very efficiently solve the difficult optimization problems [44].The population-based metaheuristic methods (such as PSO and the genetic algorithms) have the ability to converge to the global optimum, because they consider a population of potential solutions, instead of just one solution. As they use some stochastic parameters, these methods can avoid the combinatorial explosion of the number of solutions. These methods are inspired by physical or biological phenomena. For example, the Ant Colony Optimization [45] draws its inspiration from the foraging behavior of some ant species. The genetic algorithms mimic the process of natural evolution, using processes such as inheritance, mutation, selection and crossover. In this work, the Particle Swarm Optimization (PSO) is considered to optimize a metamaterial model. This method is due to the observation of some flocks of birds by Reynolds [46] in 1987, and has been developed by Keneddy and Eberhart in 1995 [47]. Understanding how the birds can achieve their complex and optimal motion, a new optimization method which could use a swarm of potential solutions has been proposed. Due to stochastic parameters, these solutions can follow the best particles and converge together to the global optimum. To optimize the metamaterials, a modified binary PSO algorithm is developed, that adapts the concept of genotype-phenotype representation [48] presented by Luh et al. in 2011. In the developed method used to solve the optimization problem, the governing equations are solved by the Finite Element Method (FEM) with the software ANSYS® which calculates also the scattering parameters. The optimization problem is solved by the developed PSO algorithm using MATLAB®. The software programs have been interfaced to efficiently solve the problem.In this paper, a binary particle swarm optimization algorithm is developed for negative permeability dielectric metamaterials topology optimization. Section 2 gives the governing equations of the electromagnetic problem, as well as the statement of the problem. In Section 3, the optimization problem to solve is formulated. Section 4 describes the developed methods, such as the binary algorithm of the particle swarm optimization, previously proposed by Luh et al. [48], and the interfacing method between ANSYS® and MATLAB® developed to perform the efficient calculations. Section 5 presents the parameters used and the results obtained with both the FEM using ANSYS® and the PSO using MATLAB®. These results confirm the validity of the possibility to apply the binary PSO to the topology optimization of the negative permeability dielectric metamaterials. This paper is based upon Di Cesare et al. [49], but the current paper includes more informations about the research, especially concerning the mathematical and physical background on the electromagnetic metamaterials.Most electromagnetic metamaterials have a periodic structure. Then, a macroscale model can be proposed by assembling some identical unit cells composed of a layer dielectric material, with or without metallic inclusions. The periodicity of the structure can be seen in Fig. 2. The individual unit cell does not exhibit the extraordinary electromagnetic properties which are exhibited globally by the metamaterial. The physical behavior of a unit cell can be studied, but some special boundary conditions have to be implemented to specify the periodicity of the structure. Then, a numerical model of the unit cell was developed, and can be seen in Fig. 3. The unit cell is repeated in the E and H directions. The boundaries Γ1 and Γ2 are defined as Perfect Electric Conductors (PEC). A Perfect Electric Conductor boundary (or Electric Wall) is a surface on which the tangential component of the vector electric field E vanishes. The cell sidewalls are assigned as master and slave boundaries, and they are bound together by the periodic boundary conditions. The slave and master boundaries are defined as Perfect Magnetic Conductors (PMC). A perfect magnetic conductor boundary is a surface where the tangential component of the magnetic field H vanishes.The electromagnetic wave in the periodic volume radiates into infinity or is absorbed in the k direction. For this reason, Perfect Matched Layers (PML) elements are used to truncate the open space. These elements were first proposed by Berenger et al. [25] in 1994, and developed for 3D electromagnetic problems in 1996 [26]. The security elements are situated between the excitation ports and the PML elements, on each side of the model. They truncate the domain, to hold off the plane wave ports from the PML elements. The aim of an absorbing boundary condition is to absorb the outgoing electromagnetic wave so that the reflections back into the design domain are attenuated. PML elements are the absorbing elements which truncate the open domain in a harmonic or modal analysis.Excitation ports define the excitation source which impacts the metamaterial. To model and perform a scattering analysis of a periodic structure, a plane wave port is used. The impacted electric field isE=E0yand normal incident angle is (ϕ, θ) = (0, 0). Finally, the PML and security elements are not present in the design domain. These elements are just elaborated to define the design domain and correctly establish all the boundary conditions on this domain.The electric permittivity defines how an electromagnetic environment reacts to an electric field. If the electric displacement field D [C/m2] represents how the electric field E [V/m] influences the organization of the electric charges in this environment, the following constitutive law can be established(1)D=ϵEwhere ϵ [C/Vm] is the dielectric permittivity of the material.The magnetic permeability defines how this material modifies a magnetic field B [T], that is its capacity to change the magnetic lines path defined by the magnetizing field H [A/m]. Then, the following constitutive law can be written(2)B=μHwhere μ[H/m] is the magnetic permeability of the material.The permittivity and the permeability are generally used with their relative form, that is(3)ϵ=ϵ0ϵrand(4)μ=μ0μrwhere μrand ϵrare, respectively, the relative magnetic permeability and the relative dielectric permittivity of the studied material. The coefficients μ0 and ϵ0 are, respectively, the magnetic permeability in vacuum and the dielectric permittivity in vacuum, and are given by the following constantsϵ0=8,85418710−6pF μm−1andμ0=4×π10−25TH μm−1.The propagation of the electromagnetic field in the metamaterials is a wave phenomenon and is governed by the Helmholtz wave equation. Then, the following wave propagation equation is derived from Maxwell’s laws, and from the Helmholtz equation in which the state variable is the electric field E.(5)∇×(∇×E)−k02ϵr×E=0withE=Ei+Erwhere Eiis the impacted field defined by the plane wave port on the design domain, E is the total electric field, and Eris the reflected field,k0=ωϵ0.μ0is the wave number and ω is the angular frequency.The boundary conditions are described as follows(6)n×(∇×E)−jk0n×(E×n)=−2jk0Eion the boundary where the impacted field is defined by the plane wave port. The second member of the equation represents the impacted field.The following equation(7)n×(∇×E)−jk0n×(E×n)=0is valid on the boundary where the field goes out the domain. There is no term in the second member, because there is not any excitation on this boundary.On the boundaries defined as the Perfect Electric Conductors, the following equation must be satisfied(8)n×E=0And on the boundaries defined as Perfect magnetic Conductors, the following equation is stated(9)n×H=0In these equations, n is the normal vector to the considered surface, E is the electric field, and H is the magnetic field.The Finite Element Method is used to calculate the scattering parameters (S-parameters) of electromagnetic high frequency devices. The calculations have been performed according to the weak formulation given in the literature [42,50] as follows(10)∫D(∇×E˜)·(∇×E)dΩ−k02∫DϵrE˜·EdΩ+jk0∫D(n×E)·(n×E˜)dΓ=2jk0∫Γ1E˜·EidΓwhereE˜is a test function. It is noted that the boundary integrals of the boundaries ΓPMCbecomes zero, because of the intrinsic definition of the Perfect Magnetic Conductor boundaries.The aim of this work is to minimize the effective permeability of a metamaterial at a given frequency. So, the effective permeability of the studied metamaterial has to be calculated numerically.The various approaches can be used to determine the effective permeability. The first approach was proposed by Bensoussan et al. [51] and Sanchez-Palencia et al. [52], and consists in a method based on the asymptotic expansion, and can be used only when the unit cell dimensions can be considered as infinitely small compared to the wavelength. The second approach proposed by Smith et al. [53] is to average the electric and the magnetic fields in a unit cell. It has been proved that this approach becomes less efficient when the complexity of the metamaterial increases. The third approach is to compute numerically the effective S-parameters, which are the complex transmission and reflexion coefficients [7,8,17,54].This approach can be calculated easily with the Finite Elements Method, and then it is really adapted for the solving of the topology optimization problem of metamaterials [32].The S-parameters-based approach to calculate the effective permeability was first proposed by Smith et al. [7]. Then, an extended approach was developed by Smith et al. to be able to deal with inhomogeneous cases [8]. As the optimized metamaterial in this work has an inhomogeneous structure, the extended method is used to calculate the effective permeability.The reflexion coefficient R is the complex proportion between the amplitude of the reflected wave and the amplitude of the incident wave, and is given in the following equation(11)R=∥Er∥∥Ei∥The transmission coefficient T is the complex proportion between the amplitude of the transmitted wave and the amplitude of the incident wave, and is given as follows(12)T=∥Et∥∥Ei∥where Eiis the incident electromagnetic field, Eris the reflected electromagnetic field and Etis the transmitted electromagnetic field.As these three fields are complex values, the scattering parameters can be calculated with the following formulas(13)S11=∫Γ1(E−Ei)dΓ∫Γ1EidΓ=∫Γ1(E−Ei)Ei¯dΓ∫Γ1Ei·Ei¯dΓ(14)S21=∫Γ1(E·Ei¯)dΓ∫Γ1Ei·Ei¯dΓ(15)S22=∫Γ1(E−Ei)Ei¯dΓ∫Γ1Ei·Ei¯dΓwhereEi¯is the complex conjugate of the field Ei.The effective refractive index neffand the effective impedance zeffcan be calculated by the following equations(16)zeff=(1+S11)(1+S22−S212(1−S11)(1−S22)−S212(17)neff=arccos(1+S11S22−S2122S21)·(λ2πd)where λ is the wavelength, and d is the unit cell length.Knowing the effective impedance and the refractive index, the effective permeability can be obtained by the following relationship(18)μeff=zeff·neffThen, the effective permeability calculation has to be established in several steps, as follows:1.Numerical calculation of the S-parameters.Calculation of the effective refractive index and impedance.Calculation of the effective permeability.Numerically, the S-parameters are computed by sequencing through a series of harmonic solutions with different port excitation over the desired frequency range.The aim of the topology optimization of negative permeability dielectric metamaterials is to obtain highly negative permeability values. The objective of the optimization problem is also to find a distribution of dielectric material in the design domain that exhibits these values of permeability.Topology optimization is a mathematical approach that optimizes material layout within a given design space, for a given set of loads and boundary conditions such that the resulting layout meets a prescribed set of performance targets. Using topology optimization, engineers can find the best design concept that meets the design requirements. Topology optimization has been developed through the use of the FEM for the analysis, and optimization techniques based on the method of moving asymptotes, genetic algorithms, optimality criteria method, level set methods, and topological derivatives. Topology optimization allows the control of not only the geometry but also of topology of a structure. It involves the determination of the type of structural elements (location, number, shape of holes) and their connectivity within the design space available when the loads and the boundary conditions are supposed known. Indeed, its flexibility leads to original and innovative solutions to engineering problems. Topology optimization really increases the performance of structures. For traditional problems, the gain in the objective functions could be very significant compared to size and shape optimization.The aim of this section is to formulate the optimization problem. As the effective permeability has to be minimized, the purpose of the optimization problem is to minimize the real and the imaginary parts of the effective permeability given by(19)μeff=μ′+j×μ′′where μeffis the effective permeability, μ′ represents its real part, while μ′′ is its imaginary part. Otomori et al. [42] showed that, as the real part of the effective permeability exhibits an antiresonance point and the imaginary part does not, the minimization process has to be divided into two stages. During the first one, the imaginary part is minimized. During the second one, the real part is minimized, and the final state of the obtained topology during the first step is used as an initial state. The typical evolution of the real part and the imaginary part are respectively shown in Fig. 4.Then, the optimization problem of the first stage of the optimization process is described as follows(20)minμ′′SubjecttoGoverningequationsoftheprobleminEqs.(1)--(5)Boundaryconditionsineq.(6)--(9)The optimization process of the second stage of the optimization process is described as follows(21)minμ′SubjecttoGoverningequationsoftheprobleminEqs.(1)--(5)BoundaryconditionsinEqs.(6)--(9)There is no constraint on the objective function because the global minimal value is searched. Moreover, one can note that these two stages are completely independent and applied one after the other. The resulting topology of the first stage is used as an initial topology for the second stage.The population-based metaheuristic optimization methods are very useful to solve the problems called ”difficult to solve”. Using a population of potential solutions instead of just one, these methods have the ability to converge to the global optimum. In this work, the method used to solve the optimization problem is the Particle Swarm Optimization (PSO) algorithm. This method was first developed by Reynolds [46] at the end of the 1980s. Observing the bird flocks, he determined the way these animals influence their trajectories, without determining a leader. Then, they have the ability to quickly and naturally converge to the best direction for their survival.Thus, the PSO method is a numerical transformation of these observations. In fact, Reynolds thought that the animals must have some memory capacities to converge like that: each individual can evaluate the quality of its position, and memorize its own best performance. Then, each individual can ask and follow some of the individuals in its neighborhood. At each time step, each individual chooses the best performance it has in its memory, and modifies its trajectory according to the performances he had memorized. Then, based on these observations, the PSO algorithm defines several particles. Each particle is a potential solution of the optimization problem, and moves in the solution space to follow the best particle, and finally converge to the best solution.Then, in the standard version of PSO, the position of a particle noi at iterationt+1,notedXit+1is given as a function of:•Xit: the position of the particle at the iteration t,Vit: the velocity of the particle i at the iteration t,Gbestt: the position of the best particle found so far by the algorithm at iteration t,Pi,bestt: the position of the best personal performance of the particle found at the iteration t.The position change of each particle n°i of the swarm is given in the following manner [47,48]:(22){Vit+1=ω×Vit+c1×rand1×(Pi,bestt+1−Xit)+c2×rand2×(Gi,bestt+1−Xit)Xit+1=Xit+Vit+1where c1 and c2 are acceleration factors, ω is the inertia weight defined to control the influence of the previous velocity on the next one [48], and rand1 and rand2 are some random real numbers distributed in [0, 1].The speed of the particles has to be constrained for the calculaton to converge. The speed of the particles in then defined in[−Vmax;Vmax]where Vmaxdepends on the solution domain, such asVmax=Xmaxwhere Xmaxis the maximum position of the particles in the domain.As the finite element method is used to calculate the S-parameters, the design domain is discretized in elements. Each element can have the material defined as the background material, or the material defined as the dielectric material.Then, the topology optimization consists in the modification of the material distribution in the design domain. In two dimensions, and on a very simple problem, a particle could be the mesh represented in Fig. 5. Blue elements represent the elements where there is the dielectric material. White elements represent the elements where there is the background material.Thus, the solution domain is composed of discrete particles, each element of which is binary: it can only have the value 1 (which corresponds to the presence of dielectric material) or the value 0 (which corresponds to the absence of dielectric material). Each time, each particle is defined in the solutions-space by the following information:•Its position in the solutions space.Its speed.The value of the objective function for its actual position.Each particle is linked with some particles, considered as the neighborhood, which are:•Itself.Two of the other particles (this is the famous LBEST population topology developed by Eberhart et al. [47,55,56]),The best particle found so far since the beginning of the calculation (this particle of the neighborhood has to be updated at each iteration of the algorithm).At each iteration of the PSO algorithm, each particle calculates its speed and its future position in the solutions space, in terms of the values given by the particles linked with it. The moving behavior of each particle combining the known positions, such as its best performance and the best performance of the neighborhood, is illustrated in Fig. 6. The sum of the concerning terms used in the calculation of the new position of the particle is represented in this figure by the red vector sum.To increment the topologies from an iteration to the following, Luh et al. [48] proposed an algorithm to switch from the continuous variables of standard PSO, to the discrete binary variables of the topology optimization. To adapt the PSO algorithm to our solutions space, that is a space with particles discretized in binary elements, the variables known as genotypic, and the variables known as phenotypic have to be distinguished from each other.In genetic studies, the genotypic character corresponds to coding of the visible characters. Thus, a gene, which is a sequence of nitrogenous bases in a precise order, is the coding: it is the genotypic character. Then, this gene implies a physical character, such as eye color: it is the phenotypic character. In the same way, each particle has a genotypic character and a visible phenotypic character. The genotype corresponds to the binary coding of the materials in the elements of each particle. The phenotype corresponds to the values of the objective function and the speed of the particle at each moment. Thus, to modify the phenotype, the genotype has to be modified as well, transforming the genotypic speed in a phenotypic speed. This phenotypic speed is, in fact, a probability of each element to change its position following the information of the neighborhood.Then, the variables associated at each particle are the following:•Xp,ik: the phenotypic position of the particle n°i at the iteration n°k: That is the value of the objective function of this particle at the iteration n°k.Vp,ik: the phenotypic speed of the particle n°i at the iteration n°k.Gp,bestk: the best phenotypic position found by the neighborhood particles. That is the best value of the objective function since the beginning of the calculation.Pp,best,ik: the best phenotypic position known of the particle n°i at the iteration n°k. That is the best value of the objective function known for this particle.proba: the genotypic speed of the particle n°i at the iteration k. It is a probabilistic translation of the genotypic speed which allows the probability of each element to change its genotype.Vp, min: the minimum phenotypic speed possible for a particle.Vp, max: the maximum phenotypic speed possible for a particle.Xg,ik: the genotypic position of each element of the particle n°i at the iteration n°k. That is the best binary vector defining the materials distribution on the elements of the particle’s mesh.Pg,best,ik: the best genotypic position of the particle n°i at the iteration n°k. That is the binary vector defining the materials distribution in the elements of the particle’s mesh.Gg,bestk: the best genotypic position found since the beginning of the calculation. That is the binary vector defining the materials distribution in the elements of the best particle’s mesh.And the constants of the algorithm are defined as following:•The maximum phenotypic speed which could be reached by the particles Vmax.The minimum phenotypic speed which could be reached by the particles Vmin.The inertia of the particles w, that is their capacity to follow their own path.The maximum number of iterations.As explained above, it is important to note that the phenotypic parameters are scalars, not vectors. Then, the phenotypic speed is the same scalar for all the elements of a particle, but the binary values of elements are different, because of the transformation of the speed into a probability.The translation of the phenotypic speed in the genotypic speed transposes the displacement of a particle to the state changing of the elements which are in the particle. The developed PSO method is then a double-PSO-method: The following scheme shows that the two steps fit into each other, as one can see in Algorithm 1.The constants c1 and c2 represent trust parameters indicating how much confidence the current particle has in itself and how much confidence it has in the swarm, respectively. These acceleration constants c1 and c2 indicate the stochastic acceleration terms which pull each particle towards the best position attained by the particle or the best position attained by the swarm.The role of inertia weight ω is considered important for the convergence behavior of PSO algorithm. The inertia weight is employed to control the impact of the previous history of velocities on the current velocity. Thus, the parameter ω regulates the tradeoff between the global and the local exploration abilities of the swarm. A proper value for the inertia weight provides balance between the global and local exploration ability of the swarm, and, thus results in better solutions. Then, a low value of ω allows the particles to stay in the same area, and favors the exploitation capacities of the swarm, while a high value pulls the particles in the solutions space to discover new areas.The numerical calculations of the S-parameters have been realized with the finite element method, implemented in the software ANSYS Classic®. The model developed is detailed in Fig. 3. The dimensions of the global model are a × a × 405 μm3, wherea=60is a parameter defining both the geometric dimensions of the global model and the frequencies of the impacted electromagnetic waves, as one can see in the remarks below. The dimensions of the design domain are 40 × 40 × 100 μm3. The thicknesses of the PML zones are 87 μm. The thicknesses of the security zones are 65 μm.The material parameters are detailed in Table 1.The impacted electric field isE=E0·yand normal incident angle(ϕ,θ)=(0,0),andE0=1. The element used to model the system is a high-frequency tetrahedral element which models 3-D electromagnetic fields and waves governed by the full set of Maxwell’s equations in linear media, such as the metamaterials. It is based on a full-wave formulation of Maxwell’s equations in terms of the time-harmonic electric field F (exponent jωt dependence assumed). It is defined by up to 10 geometric nodes with AX degree of freedom (DOF) on element edges and faces. The physical meaning of the AX DOF in the element is a projection of the electric field E on the edges and faces of the element (for more details about this element, which is the only one developed in ANSYS based on the Maxwell’s equations, please refer to [57,58]). Fig. 7shows the geometry and the nodes of this element.There are some remarks about the units used for the modelling of the numerical model. The frequencies for which the calculations of the S-parameters are done are given in terms of the geometric dimensions of the model. Then, let a be a geometric dimension of the model. The frequencies, discretized from freq1 to freq2 by freqinc, are given by formulas (23–28).(23)λ1=a0.3(24)λ2=a1.1(25)λinc=a0.05(26)freq1=1e9λ1(27)freq2=1e9λ2(28)freqinc=1e9λinc2Then, as the unit systems are not well defined in the FEM software ANSYS, it is important to be coherent with the used units. We chosea=60μm, and the frequencies are thus given in Table 2.Then, as the dimension a is defined as 60 without any unit, it is implicit in the software that a is given in μm and the frequency is then given in THz.Because of the presence of the anti-resonance point on the evolution of the real part of the effective permeability, the optimization process has to be implemented in two steps. During the first one, the imaginary part of the effective permeability is minimized, and during the second one, the real part of the effective permeability is minimized. The parameters of the PSO algorithm are detailed in Table 3.Minimizing the imaginary part of the effective permeability, the convergence history of the objective function, that is the imaginary part of the effective permeability, is given in Fig. 8. Then, the evolution of the permeability, calculated from the S-parameters is given in Fig. 9. Minimizing the real part of the effective permeability, the convergence history of the objective function, that is the real part of the effective permeability, is given in Fig. 10. Then, the evolution of the permeability, calculated from the S-parameters is given in Fig. 11. The obtained results are detailed in Table 4. The topology of the optimal design domain is given in Fig. 12.To examine a case where the target frequency is higher than that of the anti-resonance point of the initial configuration, the target frequency is now set to 15THz in this second optimization problem. The numerical model of the metamaterial and the numerical parameters of the PSO method are the same as in the first optimization case. Minimizing the imaginary part of the effective permeability, the convergence history of the objective function, that is the imaginary part of the effective permeability, is given in Fig. 13. The evolution of the permeability, calculated from the S-parameters is given in Fig. 14. Minimizing the real part of the effective permeability, the convergence history of the objective function, that is the real part of the effective permeability, is presented in Fig. 15. Then, the evolution of the permeability, calculated from the S-parameters is given in Fig. 16.The obtained results are detailed in Table 5and the topology of the optimized design domain is shown in Fig. 17. One can see that both the imaginary and real parts of the effective permeability have been minimized, and are negative. The optimization process using PSO has been efficient finding in the two test cases, the topology that exhibits the expected results that minimizes the effective permeability of the considered metamaterial to a high negative value, at a given frequency.

@&#CONCLUSIONS@&#
This work presents a new developed binary Particle Swarm Optimization algorithm for the negative permeability metamaterials at the frequencies 10 THz and 15 THz. The optimization problem is to minimize the global effective permeability of the studied metamaterial. To solve this optimization problem, an interfacing method has been developed using MATLAB® and ANSYS®. The electromagnetic theory of the Scattering parameters has been used to calculate the effective permeability. The electromagnetic 3-D wave problems were solved by ANSYS® using a high-frequency tetrahedral element. A PSO algorithm has been developed and programmed in MATLAB®. Finally, the optimization of 3-D structures has been realized minimizing the imaginary part, and the real part of the effective permeability, in a two steps process. Two numerical examples have been presented. The developed method successfully finds the optimal topology configurations of the metamaterials by minimizing their effective permeability. The obtained results can be successfully compared, in a qualitative way, to the results of Zhou [41] and Otomori [42]. The optimal topology configurations are not smooth because the developed method is based on the binary PSO approach and the element used in ANSYS to model the electromagnetic field is a tetrahedral element. The obtained topologies are not manufacturable in their present form. But this work is a first attempt to test the performances of the binary version of PSO in topology optimization of electromagnetic metamaterials. The future work could concern the using of a more refined mesh with ANSYS or using a smoothing algorithm to obtain manufacturable topologies.The main advantage of this work is the possibility to adapt quickly a version of PSO (or other population-based metaheuristic optimization method) to topology optimization. To swith from the continuous equations to the binary repartition of the materials in the domain, only the six equations defined in Algorithm 1 are added. Moreover, the optimization calculation is quiet quick (even if the Finite Element simulation can be expensive in terms of CPU time), and the results are good.The future work could also consist in the development of a continuous approach based on a level-set-method interfaced with the PSO algorithm. Moreover, a multiobjective optimization process will be applied on the problem to optimize simultaneously the real and imaginary parts of the effective permeability.