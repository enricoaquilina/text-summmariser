@&#MAIN-TITLE@&#
Improving an interior-point approach for large block-angular problems by hybrid preconditioners

@&#HIGHLIGHTS@&#
Interior-point method for block-angular problems based on hybrid approach.Hybrid preconditioner combining power series and splitting preconditioners.New switching criteria between preconditioners based on Ritz values.Computational results provided for three classes of problems.The hybrid approach resulted more efficient for most instances.

@&#KEYPHRASES@&#
Interior-point methods,Large-scale optimization,Preconditioned conjugate gradient,Structured problems,

@&#ABSTRACT@&#
The computational time required by interior-point methods is often dominated by the solution of linear systems of equations. An efficient specialized interior-point algorithm for primal block-angular problems has been used to solve these systems by combining Cholesky factorizations for the block constraints and a conjugate gradient based on a power series preconditioner for the linking constraints. In some problems this power series preconditioner resulted to be inefficient on the last interior-point iterations, when the systems became ill-conditioned. In this work this approach is combined with a splitting preconditioner based on LU factorization, which works well for the last interior-point iterations. Computational results are provided for three classes of problems: multicommodity flows (oriented and nonoriented), minimum-distance controlled tabular adjustment for statistical data protection, and the minimum congestion problem. The results show that, in most cases, the hybrid preconditioner improves the performance and robustness of the interior-point solver. In particular, for some block-angular problems the solution time is reduced by a factor of 10.

@&#INTRODUCTION@&#
Many important large-scale optimization problems exhibit a block-angular structure. Applications are found in fields such as control and planning, network flows, stochastic linear programming, and statistical data protection. Several interior-point methods have been devised to solve these structured problems [5,7,12,16,25]. These specialized algorithms exploit the particular structure of the constraints matrix, and some were implemented for parallel environments [5,25]. The efficiency of interior-point methods critically depends of the linear system solver used at each iteration to compute the Newton direction. Such systems are often written in a symmetric indefinite form, known as the augmented system. They can also be reduced to a smaller positive definite form, the normal equations. Techniques based on direct and iterative solvers can be applied for their solution. For some classes of large scale problems the use of direct methods becomes prohibitive due to storage and time limitations, whereas iterative linear solvers with appropriate preconditioners may be more efficient.The efficient interior-point algorithm for primal block-angular problems of [15] solved the normal equations in two stages: Cholesky factorizations for the block constraints and a Preconditioned Conjugate Gradient (PCG) for the linking constraints. The purpose of PCG is to avoid solving the system associated to the complicating linking constraints by Cholesky factorizations, in an attempt to make the problem block separable. The preconditioner is obtained by truncating an infinite power series that approximates the inverse of the system to be solved. For some difficult primal block-angular problems this approach outperformed state-of-the-art commercial solvers [16]. However, in some problems, systems become very ill-conditioned as the optimal solution is reached, and then PCG provides slow and inaccurate solutions. It was shown [16] that the efficiency of this approach depends on the spectral radius—in [0,1)—of a certain matrix which appears in the definition of the preconditioner (which is itself related to the Schur complement of the normal equations). Spectral radius close to 1 degrades the performance of the preconditioner. When PCG gives inaccurate solutions, the code implemented in [15] switches to the solution of the normal equations by a Cholesky factorization, which may be prohibitive for large-scale problems.In order to yield a reliable and efficient interior-point method based just on iterative solvers we introduce a hybrid and adaptive scheme for solving the normal equations. On the first interior-point iterations the normal equations are solved using the Cholesky-PCG approach of [15] outlined above. When the system associated to linking constraints becomes ill-conditioned, the normal equations are solved by a PCG using the splitting preconditioner of [29,30], instead of switching to a direct solver. The splitting preconditioner is a generalization of the tree preconditioner of [33] for large-scale minimum cost network flow problems. Based on a LU factorization, the splitting preconditioner was specially tailored for the last interior-point iterations, when the systems are ill-conditioned. We developed a new and efficient criterion to identify when (i.e., at which interior-point iteration) to switch between iterative solvers. This criterion is based on both the Ritz values of the matrix that appears in the definition of the power series preconditioner, and the number of PCG iterations needed at each interior-point iteration. The Ritz values are approximations of the eigenvalues of a matrix; they will be used to estimate the spectral radius, which measures the efficiency of the power series preconditioner. An implementation of this new approach, combining the power series and the splitting preconditioners, was applied to three classes of primal block-angular instances [15]: multicommodity flows (oriented and nonoriented), minimum-distance controlled tabular adjustment for statistical data protection, and the minimum congestion problem. As it will be shown, the hybrid approach was more efficient than the power series preconditioner in many block-angular problems. Other hybrid approaches combining interior-point and combinatorial algorithms have been used for some type of networks flows problems [21].This paper is organized as follows. In Section 2 we recall the basic ideas of interior-point methods for primal block-angular problems using the power series preconditioner. The new hybrid approach is described in Section 3, together with an outline of the splitting preconditioner, and a description of the switching criterion between preconditioners. Numerical experiments are shown in Section 4. The effect of different regularization parameters for the splitting preconditioner are also discussed in Section 4. Finally, in Section 5 the conclusions are drawn and further developments are suggested.One of the most efficient interior-point methods for some classes of block-angular problems was initially developed for multicommodity flows [12] and later extended for general primal block-angular problems [15]. This method considers the following general formulation of a block-angular problem:(1)min∑i=ok(ciTxi+xiTQixi)s.t.N1N2⋱NkL1L2…LkIx1x2⋮xkx0=b1b2⋮bkb00⩽xi⩽uii=1,…,k.MatricesNi∈Rmi×niandLi∈Rl×ni,i=1,…,k, define, respectively, the block and linking constraints, k being the number of blocks. Vectorsxi∈Rni,i=1,…,k, are the variables for each block.x0∈Rlare the slacks of the linking constraints.bi∈Rmi,i=1,…,kis the right-hand-side vector for each block of constraints, whereasb0∈Rlis for the linking constraints. The upper bounds for each group of variables are defined by ui, i=1,…,k. This formulation considers the general form of linking constraintsb0-u0⩽∑i=1kLixi⩽b0.ci∈RniandQi∈Rni×ni, i=1,…,k, are the linear and quadratic costs for each group of variables. We also consider linear and quadratic costsc0∈RlandQ0∈Rl×lfor the slacks. We restrict our considerations to the separable case where Qi, i=0,…,k, are diagonal positive semidefinite matrices.Problem (1) can be written in standard form as(2)mincTx+12xTQxs.t.Ax=b0⩽x⩽uwhereA∈Rm×n(m=l+∑i=1kmi,n=l+∑i=1kniand m⩽n),Q∈Rn×n,b∈Rmandc,x,u∈Rn. Replacing inequalities in (2) by a logarithmic barrier with parameter μ>0, we obtain the logarithmic barrier problem(3)minB(x,μ)≜cTx+12xTQx-μ∑i=1nln(xi)-μ∑i=1nln(ui-xi)s.t.Ax=b.The first order KKT optimality conditions for the logarithmic barrier problem—or equivalently, the perturbed KKT-μ conditions for (2)—are(4)Ax=b,ATy-Qx+z-w=c,XZe=μe,(U-X)We=μe,(z,w)>0,u>x>0,wherey∈Rm,z∈Rn,w∈Rnare, respectively, the Lagrange multipliers of constraints Ax=b, x⩾0 andx⩽u,X,Z,U,W∈Rn×nare diagonal matrices made up of vectors x, z, u, w, ande∈Rnis a vector of 1’s. The first two sets of equations of (4) impose, respectively, primal and dual feasibility, while the remaining two impose perturbed complementarity. The set of primal–dual solutionsC={(xμ,yμ,zμ,wμ),μ>0}of (4) is known as the central path. Primal–dual path-following interior-point algorithms approximately follow the central path by applying Newton’s method to the nonlinear system of Eq. (4), reducing the barrier parameter μ at each iteration. When μ→0 these solutions converge to the optimal solution of the original problem. Full details can be found in [37]. The Newton direction is obtained by solving a linear system in variables Δx, Δy, Δz and Δw. In practice, variables Δz and Δw are eliminated and the system reduces to the indefinite augmented system form(5)-Θ-1ATAΔxΔy=rrb,where Θ and r are defined as(6)Θ=(Q+S-1W+X-1Z)-1r=rc+S-1rsw-X-1rxz,and S=U−X. Eliminating Δx from the first group of equations system (5) is reduced to the smaller positive definite normal equations(7)(AΘAT)Δy=rb+AΘr=g.For separable quadratic optimization problems Q and Θ are diagonal, and normal equations are usually the preferred choice for computing the Newton direction.The performance of interior-point methods relies on the efficient solution of either (5) or (7). For block-angular problems (1) matrices A and Θ have a special structure. The interior-point algorithm used in this work [12,15] solves the normal Eq. (7) by exploiting the block decomposition of AΘAT:(8)AΘAT=N1Θ1N1TN1Θ1L1T⋱⋮NkΘkNkTNkΘkLkTL1Θ1N1T…LkΘkNkTΘ0+∑i=1kLiΘiLiT.Considering the blocks ofAΘATand partitioning appropriately the dual variables direction Δy and the right-hand-side vector g, the normal equations system (7) can be written as(9)BCCTDΔy1Δy2=g1g2.whereB∈Rm̃×m̃m̃=∑i=1kmi,C∈Rm̃×landD∈Rl×lare the blocks of AΘAT, and Θi, i=0,…,k, are the submatrices of Θ, i.e.,Θi=(Qi+Si-1Wi+Xi-1Zi)-1. By eliminating Δy1 from the first group of equations of (9), we obtain(10)(D-CTB-1C)Δy2=(g2-CTB-1g1)(11)BΔy1=(g1-CΔy2).The solution of (10) by a direct method is computationally prohibitive because (i) computing the matrix of the system means solving l—the number of linking constraints—systems with matrix B; and (ii) the symmetric and positive definite Schur complement matrixD-CTB-1C∈Rl×lwill be very dense in general [12]. Therefore, unless l is small, the Cholesky factorization of the Schur complement is impractical, and (10) is best solved by PCG using the power series preconditioner described below. System (11) is solved by a Cholesky factorization for each diagonal blockNiΘiNiT,i=1⋯k, of B.The power series preconditioner for the Schur complement matrix was initially applied to multicommodity flows [12] and later extended to any general primal block-angular problem [15]. This preconditioner uses the relation [12](D-CTB-1C)-1=∑i=0∞(D-1(CTB-1C))iD-1to compute an approximation of the inverse of the Schur complement. This approximation is obtained by truncating this series at some term h. Clearly, the more terms h, the better the preconditioner, at the expense of increasing the execution time of each PCG iteration. In practice, performances are best for h=0 and, in some cases, for h=1. The preconditioner M−1 for these choices areM-1=D-1ifh=0,M-1=(I+D-1(CTB-1C))D-1ifh=1.The value h=0 was used for the computational results of Section 4. The effectiveness of this preconditioner depends on the spectral radius of D−1(CTB−1C), which is always in [0,1) [12, Theorem 1]. The farther away from 1, the closer M−1 is to (D−CTB−1C)−1. In the last interior-point iterations matrix Θ is very ill-conditioned: some values of matrix Θ go to zero whereas others tend to infinity. This results in spectral radius of matrix D−1(CTB−1C) very close to 1, which hinders the efficient solution of (7).Motivated by the observed better behavior of this specialized interior-point algorithm for separable quadratic than for linear instances, a quadratic regularization term was added to the logarithmic barrier to improve the quality of the power series preconditioner [16]. The logarithmic barrier problem for linear problems (3) (considering Q=0) was replaced by the alternative regularized version(12)BQ(x,μ)≜cTx+μ12xTQx-∑i=1nlnxi-∑i=1nln(ui-xi),where Q is a diagonal positive semidefinite matrix and dom BQ={x:0<x<u}. Unlike other approaches [3], the reduction to zero of the regularization term is governed by the barrier parameter μ. This regularized barrier problem only changes the dual feasibility equations of (4), which become(13)ATy+z-w=c+μQx,and the matrix Θ defined in (6) which is replaced by(14)Θ=(μQ+S-1W+X-1Z)-1.When μ→0, (13) and (14) converge to the expressions of the non-regularized algorithm. The quadratic regularization was shown to reduce the spectral radius of the power series preconditioner [16, Theorem 1, Proposition 1], improving the overall performance of the interior-point method in some classes of instances.The hybrid approach works as follows. Initially, the normal equations are solved by the procedure described in Section 2.1, i.e., solving (11) by Cholesky factorizations and (10) by PCG with the power series preconditioner. When the power series preconditioner becomes inefficient, then the method switches to the solution of the normal Eq. (7) by PCG with the splitting preconditioner [30]. The splitting preconditioner and the efficient criteria developed to identify the switch between preconditioners are described in next two subsections.The splitting preconditioner was introduced in [29,30] for solving the augmented systems in general linear programming problems. This preconditioner is a generalization of the tree preconditioner introduced in [32,33], and extended in [19,20], for minimum cost network flow problems. Alternative splitting preconditioners for indefinite systems and diagonally-dominant matrices were presented, respectively, in [9,2]. An important feature of this preconditioner is the option to reduce the preconditioned indefinite system to the positive definite normal equations allowing the use of CG. The main appeal of this class of preconditioners is that they work better near a solution of the linear programming problem. This is a very welcome feature since the linear system is known to be very ill-conditioned close to the optimizer, making difficult its solution by iterative methods. However, since the preconditioner is specially tailored for the final iterations of the interior-point method, it may fail in the initial ones. Hybrid approaches with Cholesky controlled preconditioners on early iterations have been successfully used in large-scale linear programming [8,23,35]. A version of the splitting preconditioner for normal equations can be obtained as follows.Let AP=[B N] be a basic-nonbasic partition of the matrix A, i.e.,B∈Rm×mandN∈R(n-m)×(n-m), where P is a permutation matrix such that B is nonsingular. Considering the same partitioning for Θ, the normal equations matrix can be rewritten as(15)AΘAT=BΘBBT+NΘNNT.The symmetric application of the preconditionerM-1=ΘB-12B-1to matrix (15) gives:(16)M-1(AΘAT)M-T=ΘB-12B-1(BΘBBT+NΘNNT)B-TΘB-12=I+ΘB-12B-1NΘN12ΘB-12B-1NΘN12T=I+WWT.Sufficiently close to an optimal solution at least n−m entries of Θ are small. Thus, with a suitable choice of the columns of B, the diagonal entries ofΘB-1and ΘNare very small close to a solution. In this situation, W approaches the zero matrix and the preconditioned matrix (16) approaches the identity. The preconditioner requires to find and to solve linear systems with B. Identifying a suitable basis matrix B is a nontrivial task. In [30], the first m linearly independent columns of AΘ with smallest 1-norm are selected for B. However, 1-norm has a tendency to diminish the effect of outliers, a feature not desirable in this context since the goal is to split the columns in two sets of size m and n−m, respectively. The use of the 2-norm instead has improved the performance of the splitting preconditioner for most problems [35]. In this work we are using the 2-norm criterion.The techniques developed in [30] for determining the subset of columns B from A for the splitting preconditioner are rather costly and sophisticated. Fortunately, a nice property of the splitting preconditioner is that it can be reused for some iterations. It is important to notice that keeping the matrix B from previous iterations does not mean to keep the same preconditioner since Θ will be different. In this work the matrix B is recomputed if the PCG iterations exceeds 2% of the matrix size. This heuristic worked fine for the instances tested.The criterion to identify the switch between preconditioners is instrumental for the performance of this approach. As shown in [12, Theorem 1], the effectiveness of the power series preconditioner depends on the spectral radius of matrix D−1CTB−1C. We developed a heuristic based on Ritz Values to estimate the spectral radius of this matrix. It is based on the following relation between the eigenvalues of D−1CTB−1C and those of the preconditioned matrix of (10), the system solved by the power series preconditioner. The proof is omitted since it is a well-known linear algebra result.Proposition 1Let v be the eigenvector of matrixI-D-1(CTB-1C)associated with the eigenvalue λ. Then, v is eigenvector of D−1(CTB−1C) associated to eigenvalue 1−λ.Note that I−D−1(CTB−1C) is the matrix of (10) preconditioned in asymmetric form (i.e., premultiplied) by D−1. From Proposition 1 it is thus possible to obtain the spectral radius of D−1(CTB−1C) as follows:Corollary 1Let λmin⩾0 be the minimum eigenvalue of I−D−1(CTB−1C). Therefore, the spectral radius of D−1(CTB−1C) is 1−λmin.The conjugate gradient method is based implicitly on the Lanczos three-term recurrence relations (see for example [24, Chapter 9], [26]). For a symmetric matrixM∈Rl×l, the Lanczos method looks for a tridiagonalization VTM V=T, where V is orthogonal and T is tridiagonal. The eigenvalues θi, i=1,…,l, and eigenvectors of T are known as the Ritz values and Ritz vectors, respectively. The column vectors of V are known as the Lanczos vectors; the first column vector v1 determines the tridiagonalization performed. At iteration k of the Lanczos method, Tkis defined by(17)Tk=γ1η2η2γ2η3⋱⋱⋱ηk-1γk-1ηkηkγk,where the coefficients γiand ηjcan be computed from the CG algorithm. Consider the following generic CG algorithm to solve the linear system Mx=b.Givenx0,r0=b-Mx0,ρ0=r0,k=1whilerk≠0andk<kmaxαk-1=‖rk-1‖2(ρk-1,Mρk-1)xk=xk-1+αk-1ρk-1rk=rk-1-αk-1Mρk-1βk-1=‖rk‖2‖rk-1‖2ρk=rk+βk-1ρk-1k≔k+1end_while.The coefficients in matrix Tkcan be obtained from the following relations (see, for instance, [24, Chapter10] or [18, Chapter 5]):γk=1αk-1+βk-1αk-2,β0=0,α-1=0,ηk+1=-βkαk-1.The first Lanczos vector v1 is the unit vector that points in the direction of the initial residual of the CG algorithm, i.e., v1=r0/∥r0∥.It is known from Lanczos theory that the eigenvalues of Tk(Ritz values) converge to those of the original matrix M. In general, the extreme eigenvalues of M are well approximated already during early GC iterations [27,31]. We then used the extreme Ritz values to estimate the smallest eigenvalue λmin of the preconditioned matrix I−D−1(CTB−1C). From Corollary 1, as λmin approaches zero, the spectral radius of D−1(CTB−1C) tends to one, and, consequently, the power series preconditioner becomes less efficient. Ritz values were computed using the SSTEQR LAPACK routine [4].High quality estimates of λmin depend on the rate of convergence of the Ritz values θiof Tkto the true eigenvalues λi, i=1,…,l, of I−D−1CTB−1C. There is a variety of results about this rate of convergence, which constitute what is known as the Kaniel-Paige theory [24, Chapter 9], [26, Chapter 1]. However, some of these results are either not conclusive or difficult to apply in our context. For instance, the initial Lanczos vector v1=r0/∥r0∥ is instrumental, and it affects the convergence of the Ritz values to λi. As stated in [26, Section 1.6], this initial vector can be chosen to delay the convergence as much as needed. In practice it is not easy to compute a good initial residual r0=b−Mx0 according to this criteria; in our implementation, the previous solution of (10) was considered as the starting point x0 for CG.Some a priori bounds have been computed for the Ritz values. At iteration k of the Lanczos method, the Ritz valueθ1k(i.e., the smallest eigenvalue of Tk) satisfies the inequality(18)λ1⩽θ1k⩽λ1+(λl-λ1)tan(ϕ1)2ck-11+2λ2-λ1λl-λ2,where λ1=λmin, ϕ1 is the angle between v1 and the eigenvector associated to λ1, and ck−1(x) is the Chebyshev polynomial of order k−1 (details can be found in [24, Section 9.1.4] or [26, Section 1.7]). From (18) we see that the proximity ofθ1kto λmin depends again on v1, and also on the remaining eigenvalues ofI-D-1(CTB-1C)(in particular, λland λ2). It is worth noting that Ritz values provide in practice higher quality estimates of (mainly extremal) eigenvalues than other techniques. For instance they are considered an acceleration strategy to the QR method for the symmetric eigenvalue problem [24, Section 8.3.6].Another result shows that the speed of convergence of the Ritz values depends on how well the eigenvalues are separated from the others [31]. However, in practice it is difficult to know the distribution of eigenvalues of I−D−1(CTB−1C). From a practical point of view, an interesting result is that the similarity between CG errors and Ritz errors has been noticed and analyzed in [10,34]. These authors showed that CG errors can be considered as Ritz errors and vice versa. To evaluate the proximity between the Ritz values and the eigenvalues, we performed computational experiments with three small instances of the test problems (m32-32-12, PDS-10, Tripart1), which are described in Section 4.1. The results are shown in Figs. 1–3. For each experiment we used two different PCG tolerances at each interior-point iteration i: the tolerance of the original implementation (εi=max{0.95εi−1,minε}, where minε=10−8, and ε0=10−2) and a more restrictive tolerance (εi=10−12). Using the original PCG tolerances, few PCG iterations are needed for convergence at the first interior-point iterations in general, since the PCG tolerances are not tight. The PCG error can be higher and hence the approximations of the eigenvalues by Ritz values are poor. As the interior-point iterations evolve the PCG tolerances become tighter, more iterations are required for convergence and the quality of Ritz values tends to be better. On the other hand, the tighter PCG tolerance εi=10−12 always provides very close approximations, as shown in Figs. 1b, 2b and 3b. Fig. 4shows the absolute difference between minimum eigenvalue and minimum Ritz value at each interior-point iteration, using the original PCG tolerance. At the last interior point iteration plotted on these graphs (iteration at which the switch criterion described below is satisfied), the absolute difference is less than 10−4.Supported by the previous results, the following heuristic criterion was developed. The switch between the power series and the splitting preconditioner is performed when all the following three criteria occur:1.The minimum Ritz value of I−D−1(CTB−1C) is less than 0.001.The number of PCG iterations with the power series preconditioner reaches 0.05l, where l is the dimension of I−D−1(CTB−1C).The centrality parameter μ is less than 0.5.The first two criteria verify whether the power series preconditioner is becoming less efficient. The last one guarantees enough progress of the interior-point method. The satisfaction of the three criteria is a good indicator that the splitting preconditioner will work better. In practice, this criterion provided good computational results. Note that in the implementation of Section 4 the centrality parameter is computed with the usual formulaμ=σxTz+(u-x)Tw2n, where σ=0.1. The stopping criterion for the PCG is described in Section 4 below.The hybrid approach described in the previous section has been added to a MATLAB implementation of the specialized algorithm for general block-angular problems, named BlockIP [15]. BlockIP implements a standard infeasible primal–dual path-following algorithm, which solves the normal equations by either the specialized procedure described in Section 2.1 or a Cholesky factorization. The code uses the Ng-Peyton sparse Cholesky package [22,28] for the solution of (11) and (7); the Ng-Peyton sparse Cholesky package was hooked to MATLAB for the LIPSOL interior-point solver [38]. System (10) associated to the linking constraints is solved by PCG, using the power series preconditioner. PCG may give inaccurate solutions when the matrix of this system becomes ill-conditioned. When this happened, the original version of BlockIP switched to the solution of the full normal Eq. (7) by a Cholesky factorization. The switch is performed when we are close enough to the optimal point (gapi<0.5) and gapiincreases from one iteration to the next (gapi>1.05gapi−1), where gapi=∣pi−di∣/(1+∣pi∣), piand dibeing the primal and dual objective functions at iteration i, respectively.The splitting preconditioner, initially coded in C, has been hooked to the MATLAB BlockIP implementation. The new version of the BlockIP package is thus able to solve the normal equations by either a Cholesky factorization or PCG using the power series or the splitting preconditioner. The default parameters of BlockIP described in [15] have been adopted, but for the stopping criterion of the interior-point method and the PCG. Since the splitting preconditioner may provide more accurate solutions than the power series preconditioner near the optimal solution, we allowed a more restrictive stopping criterion for the interior-point algorithm: it stops when, at a primal–dual feasible solution, gapi<10−6. This stopping criterion will be used for both the original version (i.e., power series preconditioner followed by Cholesky) and the hybrid approach (unlike in the code of [15], where the stopping criterion was gapi<10−4). The stopping criterion for the PCG in the original code was based on the angle rule suggested in [33], and the PCG tolerance at the interior-point iteration i was updated as εi=max{0.95εi−1, minε}, where minε=10−8, and ε0=10−2 or ε0=10−3 for, respectively, linear and nonlinear problems [15]. The stopping criterion of the PCG solver has been tightened in the new code when either gapi<10−4 or the code switches from the power series to the splitting preconditioner: it is stopped when at iteration j of PCG the relative residual norm satisfies ∥rj∥/∥r0∥<minε. The precision minε=10−8 is also required for PCG if no switch of preconditioner is performed but we are close to the optimal solution (μ<10−4) and the gap increases (gapi> 1.1gapi−1). Table 1shows the main differences of parameters between the original and the new hybrid approach.Three classes of primal block-angular problems have been considered for testing the hybrid approach: multicommodity network flow problems (oriented and nonoriented), minimum congestion problems and minimum distance controlled tabular adjustment.Multicommodity flow problems attempt to route a set of commodities at a minimum cost over a capacitated oriented or nonoriented network. We considered three kinds of oriented instances. The first two correspond to a subset of the PDS [11] and Mnetgen [1] instances. These instances are widely used in the literature, and they can be retrieved from http://www.di.unipi.it/optimize/Data/MMCF.html. The last set corresponds to instances obtained with the Tripartite generator, which can be retrieved from http://www-eio.upc.edu/jcastro/mmcnf-data.html. We are not aware of any standard set of nonoriented multicommodity flow problems, thus nonoriented instances were generated from the oriented Mnetgen ones.The minimum congestion problem (also known as the maximum concurrent flow problem) [6,36] arises in practical applications on telecommunications networks. The purpose of this problem is to compute the maximum concurrent flow (or throughput) that can be transported through a network. Equivalently, it can be seen as the problem of finding, in an infeasible multicommodity flows network, the minimum of the maximum relative increments in arc capacities, for each arc of the network, that makes the problem feasible, i.e., all multicommodity flows can be sent from sources to destinations. The formulation used here is described in [15]. The infeasible multicommodity instances were generated from the oriented Mnetgen ones by increasing supplies and demands by a factor of two.Minimum-distance controlled tabular adjustment (CTA for short) is a technique for the protection of statistical tabular data [13,14,17]. This is a major concern for National Statistical Institutes, which must guarantee that individual information cannot be disclosed from released data. For some classes of tables (three-dimensional tables) and using the Euclidean distance, this problem can be formulated as a quadratic multicommodity flow problem with saturated linking constraints [13,16]. If the L1 distance is used, the formulation no longer corresponds to a multicommodity flow problem, but it exhibits a block-angular structure. Several formulations for this problem are reported in [17]. In this work we considered some of the instances derived from the most efficient observed formulation of the L1-CTA problem.Table 2summarizes the dimensions of these instances: number of blocks k; number of constraints and variables for each block, m′ and n′, respectively; number of linking constraints l; and overall number of constraints and variables of the resulting problem, m and n respectively. For minimum congestion instances columns m′ and n′ show the overall number of constraints and variables for all the diagonal blocks, since not all the blocks have the same dimension, i.e.,m′=∑i=1kmiandn′=∑i=1kni.As stated in SubSection 2.3, the power series preconditioner is improved by considering a quadratic regularization term in the barrier problem. However, this quadratic term may complicate the computation of the basic-nonbasic partition of the constraints matrix needed by the splitting preconditioner, which was developed for linear problems. The straightforward approach would be to inactivate the regularization term when switching to the splitting preconditioner. Instead, some numerical experiments were carried out to evaluate the impact of different regularization parameters in the performance of the splitting preconditioner. The regularization Q matrix of (12) is computed as(19)Q=tδμ0I,wheret∈Z+is the number of interior-point iterations,μ0∈Ris the value of the barrier parameter at the first interior-point iteration, andδ∈Ris a parameter to be provided by the user for initializing the regularization matrix Q. The value δ=10−6 was always fixed for the power series preconditioner, and different values δ∈{10−2,10−4,10−6,0} were considered for the splitting preconditioner. When δ=0, the standard non-regularized algorithm is being used.Results are illustrated in Table 3. For each δ, columns PCG and CPU report the number of PCG iterations and CPU time required by the hybrid approach, but only for the interior point iterations after the switch from the power series to the splitting preconditioner. Information is only reported for the subset of the instances where the switch to the splitting preconditioner is performed (as it will be shown later in Table 4).From Table 3 it is clear that the different regularization parameters affect the PCG and CPU time required by the splitting preconditioner. Note that in some cases (e.g., Tripart3) executions with a smaller number of PCG iterations provide larger CPU times; this may be due, first, to inaccuracies of the operating system timing routines, and second, to different sparsity patterns of the LU factorization of the splitting preconditioner. There is no regularization parameter providing the best performance for all problems. For multicommodity flow instances, the best results, in number of PCG iterations, were obtained with δ=10−2 (oriented problems) and δ=10−4 (nonoriented instances). The value δ=10−4 also guaranteed the best results for the CTA instances. However, the hybrid approach failed for the M128-64-12 minimum congestion instance when δ=10−2 and δ=10−4. As expected, in general, the small regularization parameters, i.e., δ=10−6 and δ=0, performed well for most instances and reported the maximum number of best executions. The value δ=10−6 will be used for the computational results of next subsection.We compared the original version of the BlockIP code (power series preconditioner followed by Cholesky factorization if ill-conditioning is found) against the new version implementing the hybrid approach (power series followed by splitting preconditioner). The original version of BlockIP was considered with two switching criteria: original ((gapi<0.5) and (gapi>1.05gapi−1)) and the new criterion (described in SubSection 3.2). Table 4 shows the computational results obtained.Columns “original”, “original–new switch” and “hybrid” of Table 4 correspond to these three executions, respectively. For each test problem, columns “Iter”, “CPU” and “PCG” provide, respectively, the number of interior-point iterations, the CPU time in seconds and the number of PCG iterations. The numbers in brackets of columns “Iter” show the interior-point iteration at which the switch between linear solvers is performed (from power series preconditioner to Cholesky in the “original” and “original–new switch” columns, and from power series to splitting preconditioner in the “hybrid” columns). All runs were carried out on a Fujitsu Primergy RX300 server with 3.33gigahertz Intel Xeon X5680 CPUs (24 cores) and 144gigabyte of RAM, under a GNU/Linux operating system (Suse 11.4), without exploitation of parallelism capabilities. The fastest executions are marked in boldface.For the oriented multicommodity Mnetgen instances M32-32-12, M64-64-12 and M128-64-12 the new switch criterion significantly reduced the number of interior-point iterations performed. This is because the switch to the Cholesky Factorization (original–new switch) or to PCG with splitting preconditioner (hybrid) was performed very soon, avoiding some expensive iterations with the power series preconditioner. For PDS and Tripart there is no significant difference in the number of interior-point iterations among the three approaches. For Mnetgen and PDS (but PDS-10) instances the “hybrid” approach reduced the CPU time. In Tripart problems “original–new switch” produced the best results.Similar results are obtained for nonoriented multicommodity flow problems. All the runs with the “original” approach switched from the power series preconditioner to the Cholesky factorization. We observed that normal equations are nearly singular when the switch is performed; directions computed by the Cholesky factorizations are inaccurate, thus requiring a large number of interior-point iterations to converge. Since in the “original–new switch” and “hybrid” approaches the switch is done earlier, better directions were obtained, reducing the number of interior-point iterations. The CPU time is significantly smaller with the “hybrid” version.For CTA problems, “original–new switch” reported the best results for some instances. However, the “original” or “original–new switch” versions reached the maximum number of iterations for instances CTAL1-30-30-30, CTAL1-50-50-50, CTAL1-100-100-10 and CTAL1-100-100-50, without a solution with the required optimality tolerance. For these instances, when gapi<10−5 system (10) became very ill-conditioned and PCG reported a large residual error. Inaccurate directions were also obtained after switching to the Cholesky factorization. On the other hand, the “hybrid” approach converged to a solution in few iterations. Although “hybrid” reports larger CPU times than “original–new switch” for some instances, it is more robust since it found the optimal solution in all the runs performed.For CTAL1-500-500-50 and the minimum congestion instances M32-32-12 and M64-64-12 the switching criterion was never satisfied, since the power series preconditioner behaved well for all the interior-point iterations. In some instances (e.g., CTAL1-10-10-5 and minimum congestion M128-128-12) the “original” and “original–new switch” approaches switched to Cholesky, but the “hybrid” approach did no switch to the splitting preconditioner. This is because the tighter PCG termination criterion of the hybrid approach, which is used when there is no switch between preconditioners and gap gets worse, allowed the power series preconditioner to reach the optimal solution.

@&#CONCLUSIONS@&#
We have provided computational evidence that the hybrid approach combined with a new switch criterion significantly improved the performance of the specialized interior-point algorithm for some classes of primal block-angular problems. An estimate for the spectral radius of the matrix D−1(CTB−1C) was computed by using the Ritz values. This resulted in a criterion to switch between preconditioners that worked fine in the tested instances.Improving the efficiency of the PCG by an adaptive selection of the number of terms h in the power series preconditioner is among the future tasks to be done. This could be done by using the Ritz values to measure the efficiency of the preconditioner at each interior-point iteration. The performance of the specialized algorithm would be improved if the optimal term h∗ could be identified at each iteration.