@&#MAIN-TITLE@&#
Risk measures and their application to staffing nonstationary service systems

@&#HIGHLIGHTS@&#
We analyze risk measures for the infinite server queueing model.We analyze risk measures for the Erlang-A queueing model.We show how risk measures can be used for staffing such queues.We analyze performance measures of queues using risk measures.We extend our work to a non-Markovian setting and provide numerical examples.

@&#KEYPHRASES@&#
Queues and service systems,Risk measures,Healthcare,Time inhomogeneous markov processes,Staffing,

@&#ABSTRACT@&#
In this paper, we explore the use of static risk measures from the mathematical finance literature to assess the performance of some standard nonstationary queueing systems. To do this we study two important queueing models, namely the infinite server queue and the multi-server queue with abandonment. We derive exact expressions for the value of many standard risk measures for the Mt/M/∞, Mt/G/∞, and Mt/Mt/∞ queueing models. We also derive Gaussian based approximations for the value of risk measures for the Erlang-A queueing model. Unlike more traditional approaches of performance analysis, risk measures offer the ability to satisfy the unique and specific risk preferences or tolerances of service operations managers. We also show how risk measures can be used for staffing nonstationary systems with different risk preferences and assess the impact of these staffing policies via simulation.

@&#INTRODUCTION@&#
Time varying queueing models such as the Mt/G/∞ queue and theMt/M/kt+Mqueue are standard models for describing the dynamics of large scale service systems like telecommunication systems, call centers, and healthcare systems like hospitals. To get a good understanding of the wide variety of applications of nonstationary queueing models, see for example (Khudyakov, Feigin, & Mandelbaum, 2010) for applications to call centers with interactive voice response and Yom-Tov and Mandelbaum (2014) for application to healthcare systems. However, staffing these systems appropriately and stabilizing salient performance measures such as the probability of delay and waiting times for these stochastic systems has been a long standing problem in the queueing literature for many years.One of the first solutions for stabilizing the delay probabilities for multiserver queues without abandonment was developed by Jennings, Mandelbaum, Massey, and Whitt (1996). Jennings et al. (1996) develop a novel square root staffing algorithm that uses the offered load of an infinite server queue and the square root of the offered load for refinements to stabilize the delay probabilities in multi-server queues. In the case of exponential service times, it only requires the solution to a simple ordinary differential equation to find the appropriate staffing level. However, as noted in Feldman, Mandelbaum, Massey, and Whitt (2008) and Liu and Whitt (2012) and Massey and Pender (2013), this algorithm for stabilizing the delay probabilities does not stabilize the abandonment probabilities and other performance measures. Thus, Liu and Whitt developed a new approach that stabilizes the abandonment probabilities and mean delay using the combination of two infinite server queues.Nonetheless, these algorithms for performance stabilization are only useful for a few performance measures that are well-studied in the queueing literature and are especially tailored for applications in telecommunications where there is no extreme consequence if a customer waits a long time for service. For instance, in a call center it is considered good performance if 99 percent of customers are served within 2 minutes and we might not care about the 1 percent of customers who might have extremely long wait times. However, in a healthcare or emergency care setting, patients with extremely long waiting times can be very costly to the hospital, especially if their health deteriorates while waiting and subsequently they die before being seen, see for example (Castillo, 2014). Consequently, it is not sufficient to just make sure that waiting times are short, but it is also important to make sure that even excessive waiting times are short in the context of healthcare.To address the difference between application settings like telecommunications and healthcare, in this paper we propose analyzing the new problems in applications like healthcare with new ideas, namely using static risk measures from the mathematical finance literature. The advantage of using static risk measures over traditional approaches of performance analysis, is that the risk measure approach can be adapted to a manager’s risk preferences and the particular application context. The fact that the risk measure approach can be adapted to different applications and in different contexts within a particular application is quite useful for managers of service systems. One example in healthcare is that patients with shortness of breath might be less willing to tolerate long waits than patients with an ankle sprain so a different risk measure should be used for those patients. Thus, this risk measure approach allows the manager of a service center such as hospital to choose his or her own risk preferences for the overall performance of the system as well as the individual parts of the system.In order to develop this risk measure approach for general service systems, we need to specify a stochastic model for the dynamics of our service systems. In this paper, we begin with the infinite server queueing model. This model is very natural as a start since its dynamics are tractable in the stationary and nonstationary setting. Not only are the mean and variance dynamics tractable, but also the entire distribution is known for the infinite server queue when initialized with a Poisson distribution or at zero. Besides the fact that the infinite server queue is a relatively simple model, it is also an offered load model. Thus, the infinite server dynamics represents the system when an unlimited number of resources are available and serves as an lower bound for the dynamics of finite server systems.In addition to the infinite server queue, we also analyze the canonical nonstationary Erlang-A queueing model. The nonstationary Erlang-A model assumes the customer arrival process is a non-homogenous Poisson process with nonstationary arrival rate λ(t). We also have k servers with i.i.d. service times that are exponentially distributed with mean 1/μ. Finally, all the customers have i.i.d. abandonment times that are also exponentially distributed with mean 1/β. Although the Erlang-A model is a simple model for some complex realities, it is also very hard to find closed form expressions for many of the performance measures of interest in the nonstationary setting. Thus, we must find approximations of the Erlang-A that are accurate and more tractable in terms of providing closed form expressions for performance measures of interest.One standard method would be to use the fluid and diffusion limits of Mandelbaum, Massey, and Reiman (1998). However, it is well known that for small values of the scaling parameter η, the fluid and diffusion limits are not warranted. Moreover, when the mean queue length is near the number of servers, the fluid and diffusion limits are not Gaussian. Thus, in this work, we use another approximation to accurately estimate the queue length process. This approximations is known as the Gaussian variance approximation (GVA) of Massey and Pender (2011) and uses a Gaussian surrogate distribution to approximate the queue length dynamics. With this approximation for the queue length dynamics, we then approximate various risk measures for the queue length process and illustrate their performance as tools for staffing the system. We are not the first to study staffing issues in queues, see for example (Engblom & Pender, 2014; Pender, 2015; Stolletz, 2008; Tirdad, Grassmann, & Tavakoli, 2016; Yarmand & Down, 2013), however, we are the first to use risk measures in this context.To the best of our knowledge our contributions in this work are the following.•We are the first to illustrate how static risk measures from the mathematical finance literature can be used in the context of server staffing and performance analysis in queueing theory.We derive explicit approximate staffing schedules for various risk measures that are widely used in the financial community and derive closed form expressions for the values of risk measures under Poisson and Gaussian distributional assumptions.We use the risk measures as staffing procedures and assess the results through comparing standard performance measures such as the probability of delay and abandonment probabilities.The rest of the paper is as follows. In Section 2, we introduce the concept of risk measures and provide several examples of risk measures. We also introduce the concept of functional risk measures, which will also be used throughout the rest of the paper. In Section 3, we start with the infinite server queue and derive closed form formulas for several risk measures for the queueing process. In Section 4, we introduce the Erlang-A model and several approximations for it. In Section 5, we use the approximations for the Erlang-A model queueing model and derive closed form expressions for the risk measures of the queueing model. In Section 6, we give numerical results and describe the impact of using the risk measures for staffing the system. We give examples of some extensions and conclude with final remarks in Section 7.One of the central goals in mathematical finance is to assess the risk of financial positions. The risk of a financial position may be seen as the capital reserves that a bank should hold in response to the risk it exposes itself to. Inspired by this notion of risk as a minimal capital reserve and by the shortcomings of V@R, Artzner et al. (1997,1999) introduced an axiomatic approach to coherent risk measures. The goal of a coherent risk measure is to quantify the risk of X by a number ρ(X). It is our goal in this paper to introduce this notion of risk measures into the world of queueing theory where there are analogous notions of risk and reserves. In fact, in the context of queueing theory and staffing, the notions of risk and reservers can be viewed as the number of staff needed to maintain a specific quality of service level. Before we describe how various risk measures are related to various performance quantities in the service systems literature, we give a brief overview of risk measures to make the paper self-contained for the reader’s convenience.Definition 2.1A mapping ρ :X→R∪{+∞}is called a monetary risk measure if ρ(0) is finite and if ρ satisfies the following conditions for X,Y∈X.Monotonicity: If X ≤ Y , then ρ(X) ≥ ρ(Y).Cash Invariance: If m∈R,thenρ(X+m)=ρ(X)−mThese two conditions are very necessary to define risk measure. It is clear that if X is always smaller than Y under every scenario (∀ω), then the risk associated with X should be higher than the risk associated with Y. Moreover, if we add cash to our position, it should reduce the risk of that position because cash is not a risky asset.Definition 2.2A monetary risk measure ρ is called a convex or quasi-convex risk measure if ρ satisfies the following condition for X,Y∈X.Convex: Ifρ(λX+(1−λ)Y)≤λρ(X)+(1−λ)ρ(Y)for all λ ∈ [0,1].Quasi-Convex: Ifρ(λX+(1−λ)Y)≤max{ρ(X),ρ(Y)}for all λ ∈ [0,1]From a financial perspective this is an important property for a risk measure since, it agrees with the theory of diversification in portfolio theory. Thus, if you invest in different assets that are not perfectly positively correlated, then you should naturally lower the risk of your overall portfolio.Definition 2.3A convex risk measure ρ is called a coherent risk measure if ρ satisfies the following condition for X,Y∈X.Positive Homogeneity: Ifρ(λX)=λρ(X)for all λ ≥ 0.Note that when we assume that the convex risk measure is positive homogenous, we get for free that the risk measure is sub-additive. Moreover, positive homogeneity and sub-additivity imply that the risk measure is convex. We now give some examples of more common risk measures that are used frequently in the finance literature.One of the most important and widely used risk measures is the Value at Risk risk measure (V@R).The Value at Risk (V@R) is defined as:(2.1)V@R(X,ϵ)=inf{y|P{X≤y}≥ϵ}.The V@R(X, ϵ) is interpreted as the minimal amount of money that an agent must add to a position X such that, with probability not greater than ϵ, he will not become bankrupt. However in the context of queueing theory and optimal server staffing the V@R(X, ϵ) can be interpreted as the number of agents you need to staff your system to keep the probability of waiting for service below some pre-specified tolerance value ϵ. Thus, there are important interpretations of risk measures from a queueing theory perspective.Unfortunately, V@R(X, ϵ) does not satisfy sub-additivity and therefore is not a coherent risk measure unless the distributions involved are jointly elliptically distributed. One typical example of a coherent risk measure is the Average Value at Risk (also called Tail-V@R or AV@R).The Average Value at Risk (AV@R) is defined as:AV@R(X,ϵ)=11−ϵ∫ϵ1V@R(X,ν)dνand when the distribution of X is continuous, we have thatAV@R(X,ϵ)=11−ϵ∫ϵ1V@R(X,ν)dν=11−ϵ∫ϵ1inf{y|P{X≤y}≥ν}dν=E[X|X≥V@R(X,ϵ)]Hence, AV@R takes the average over all Values at Risk between 1 and1−ϵ. If the distribution of X is continuous, this is equivalent to conditional expectation of a drop in the market and then taking the average over all these bad scenarios. In this respect, the AV@R is more robust than V@R to changes in the distribution since the V@R is a point value of a quantile and AV@R is the average of the tail behavior of the V@R. It can also be shown that the AV@R is greater than V@R for the same value of ϵ and the same random variable. Moreover, AV@R can be seen as a compromise between the V@R risk measure and the maximal loss of the random variable since it is larger than the V@R, but smaller than the maximal loss.Like the V@R, AV@R has important meaning in the context of queueing theory. In queueing theory, it is an important goal to understand the behavior of the queueing process when the queue length exceeds the currently available number of servers. The AV@R allows one to compute the mean of the queue length when the queue is overloaded. Understanding this risk measure for queueing processes will allow us to staff our system when it is overloaded with customers. Unlike V@R the AV@R is a convex risk measure. This means for queueing theory that adding two different queues together should only lower the total staffing needed to properly staff both. In finance, the convexity is motivated by diversification, which is meant to lower risk, however, for the perspective of a manager of a queueing system, it can be interpreted as economies of scale. As we add more queues to the network, we would hope that our optimal staffing would be no worse than staffing the two queues separately.The Entropic risk measure is defined as:(2.2)ρ(X,γ)=1γlog(E[e−γX]).The Entropic risk measure also has a dual representation as(2.3)ρ(X,γ)=supP˜∈M1{EP˜[−X]−1θH(P˜|P)}where(2.4)H(P˜|P)=E[dP˜dPlogdP˜dP]is the relative entropy of measuresP˜and P and whereP˜is absolutely continuous with respect to P. This dual representation of the Entropic risk measure can be view as the worst case of the expected loss under measureP˜,corrected by a penalty term, where the probabilistic modelP˜is penalized proportional to the deviation ofP˜from P, measured by the relative entropy. Moreover, in the realm of mathematical finance the Entropic risk measure can be viewed as the indifference price of an investor with the constant risk aversion utility functionu(x)=1−e−xand is also widely used when there is incomplete information or uncertainty about the models for the market dynamics. See for example (Rudloff, Sass, & Wunderlich, 2008). Although we do not see an immediate analogous connection to queueing systems like the other risk measures, it is nonetheless important since the Entropic risk measure is a scaled version of the cumulant generating function, which is an important probabilistic quantity to understand.Another important risk measure that is popular in the financial literature is the Mean-Variance risk measure. The Mean-Variance risk measure is defined as:(2.5)ρ(X,γ)=E[X]+γ·Var[X].The Mean-Variance risk measure is quite popular since it is made up of the first two cumulants of the distribution of the random variable. It is also most notably used in the capital asset pricing model known as the (CAPM). It allows one to trade off expected return with the variance of that return in a simple and elegant manner. A slight modification of the Mean Variance risk measure leads to the following risk measure.The last risk measure that we describe here is the Mean-Deviation risk measure of order p. The Mean-Deviation risk measure of order p is defined as:(2.6)ρ(X,γ,p)=E[X]+γ·(E[|X−E[X]|p])1/p.This is somewhat of a generalization of the Mean-Variance risk measure since it allows different values of p other than 2. Whenp=2,we have a similar risk measure like the Mean-Variance risk measure i.e.(2.7)ρ(X,γ,2)=E[X]+γ·(E[|X−E[X]|2])1/2(2.8)=E[X]+γ·Var[X].We will demonstrate later in the paper that this risk measure is important for staffing nonstationary systems. Currently, we limit the number of risk measures that we explain in detail, however, see (Cheridito & Li, 2009) for more examples of risk measures. To find out more about risk measures and their applications in finance or optimization, see (Cheridito & Li, 2008; 2009; Ruszczyński & Shapiro, 2006).In addition to understanding the performance of risk measures with respect to random variables, it is also important to understand the performance with respect to functions of those random variables. When we consider a risk measure with respect to a function of a random variable, we call these functional risk measures.The functional Value at Risk (V@R) is defined as:(2.9)V@R(f(X),ϵ)=inf{y|P{f(X)≤y}≥ϵ}V@R(f(X), ϵ) is interpreted as the minimal amount of money that an agent must add to a position f(X) such that, with probability not greater than ϵ, he will not become bankrupt. However in the context of queueing theory and optimal staffing the V@R(f(X), ϵ) can be interpreted as the number of agents you need to staff your system to keep the probability of delay below some pre-specified tolerance value ϵ at a particular time t.The functional Average Value at Risk (AV@R) is defined as:AV@R(f(X),ϵ)=11−ϵ∫ϵ1V@R(f(X),ν)dν=11−ϵ∫ϵ1inf{y|P{f(X)≤y}≥ν}dν=E[f(X)|f(X)≥V@R(f(X),ϵ)]The functional mean-variance risk measure is defined as:(2.10)ρ(f(X),γ)=E[f(X)]+γ·Var[f(X)]The functional mean-variance risk measure of order p is defined as:(2.11)ρ(f(X),γ,p)=E[f(X)]+γ·(E[|f(X)−E[f(X)]|p])1/pThe functional entropic risk measure is defined as:(2.12)ρ(f(X),γ)=1γlog(E[e−γ·f(X)])Now that we have define a general class of risk measures that may be applicable it is our hope that these risk measures can give insight into the performance of queueing systems under different types of management since each management style has a different appetite for risk. As an example, in healthcare it may not be sufficient for a manager to control the average time that customer is delayed for emergency care. In fact it is more reasonable to control average time that a customer is delayed given that they are delayed. This quantity is more realistic for hospitals because it is not a concern if a customer is taken into the ER immediately. It is only a concern of the manager how long customers will wait, given that they have to wait and there is no room for them when they are admitted. In this particular case, a manager would choose to staff the hospital using the AV@R since this risk measure has the ability to condition on the customers being delayed when they arrive to the ER. In the same context, a manager also may choose a different risk measure for different times as well. For instance, during a terrorist attack or catastrophic event, hospital managers may want to staff for a worse case scenario. In this case, one would use the entropic risk measure with a high value of γ. As we have seen the entropic risk measure has the interpretation of being the worst case scenario as γ → ∞.In this section, we give a brief introduction to queueing theory, its applications, and also describe some of the simple queueing models that we will analyze in this paper. Queueing theory has the beginnings of its history in the context of telecommunications. Queueing theory was invented by a Danish engineer, Agner Erlang, who worked for the Copenhagen Telephone Exchange. He published the first paper on what would now be called queueing theory in 1909 and this work developed stochastic models for callers that dropped due to frustration from waiting for an operator. Simple queueing models are often denoted by Kendall notation A/B/C/D/E, where A stands for the distribution of arrivals, B stands for the distribution of service times, C stands for the number of servers, D stands for the waiting room capacity of the queue, and finally E stands for the service discipline. For example, the M/G/1/∞/FIFO queue represents Poisson arrivals, general service times, one server, an infinite waiting room, and the first in first out service discipline. More recently, some queueing models include customer abandonment and these are often denoted by a+Gafter the number of servers. Queues have a variety of application areas such as telecommunications, healthcare, finance (limit order books), transportation, and data centers just to name a few. Thus, queueing theory is an important area of research and we intend to connect this literature with the risk measure literature.To begin our analysis of stochastic queueing models, we start with the Mt/G/∞ queueing model. There are two main reasons to start with the Mt/G/∞ queueing model. The first is that the Mt/G/∞ queue is very tractable since the distribution is known in closed form. The second reason is that the Mt/G/∞ queue is the best type of queue one can hope for where everyone is served immediately and no one ever waits for service. In this regard, the Mt/G/∞ infinite server queue is a lower bound for queueing models with a finite number of servers and without abandonment since it represents the dynamics if the manager had access to an infinite amount of resources and is not resource constrained.In this section, we derive closed form formulas for risk measures for the Mt/G/∞ queueing model, which exploits the results of Eick, Massey, and Whitt (1993) for the time varying infinite server queue. In the paper of Eick et al. (1993), they use the properties of the Poisson arrival process and use Poisson random measure arguments to show that the Mt/G/∞ queue Q∞(t), has a Poisson distribution with time varying mean q∞(t) . The exact analysis of the infinite server queue is often useful since it represents the dynamics of the queueing process if there were an unlimited amount of resources to satisfy the nonstationary demand process. As observed in Eick et al. (1993), q∞(t) has the following integral representation(3.13)q∞(t)=E[Q∞(t)](3.14)=∫−∞tG¯(t−u)λ(u)du(3.15)=E[∫t−Stλ(u)du](3.16)=E[λ(t−Se)]·E[S]where λ(u) is the time varying arrival rate and S represents a service time with distribution G,G¯=1−G(t)=P(S>t),and Seis a random variable with distribution that follows the stationary excess of residual-lifetime cdf Ge, defined by(3.17)Ge(t)≡P(Se<t)=1E[S]∫0tG¯(u)du=1E[S]∫0tP(S>u)du,t≥0.When the service time distribution is exponential, we know that the mean queue length, q∞(t), solves the autonomous differential equation(3.18)q•∞=λ(t)−μ·q∞(t),which is very easy to solve numerically. Moreover, from the standard theory of infinite server queues, the distribution of the queue length process is Poisson with mean q∞(t) when initialized with a Poisson distributed number customers or initialized at zero. Using this fact, we now compute several risk measures for the infinite server queue to get a better understanding of the impact of these risk measures in a relatively simple context.Theorem 3.1The solution to the mean and variance of the Mt/Mt/∞ queue with initial values of Q0 and V0 is given by(3.19)E[Qt]=Q0·exp{−∫0tμ(s)ds}+(exp{−∫0tμ(s)ds}·(∫0tλ(s)exp{−∫0sμ(r)dr}ds))(3.20)Var[Qt]=E[Qt]+(V0−Q0)·exp{−2∫0tμ(s)ds}.ProofUsing the functional forward equations for the mean and variance as in Pender (2014a), we know that the mean and variance of the infinite server queue with a time varying arrival rate and service rate solves the following non-homogeneous differential equationsE•[Qt]=λ(t)−μ(t)·E[Qt]Var•[Qt]=λ(t)+μ(t)·E[Qt]−2·μ(t)·Var[Qt].Thus, since the mean is independent of the variance, we can solve the mean equation by standard ordinary differential equation theory. Since there is a uniqueness theory for simple first order equations, it only follows to show that the solution above actually solves the differential equation. Although integrating factors are standard in any text on ordinary differential equations, we sketch the solution for E[Qt] using the integrating factor method for ordinary differential equations. From the functional forward equations, we know the mean satisfies the following equationddtE[Qt]+μ(t)·E[Qt]=λ(t).Now multiply both sides by an integrating factor e∫μ(u)duto get thate∫μ(u)du(ddtE[Qt]+μ(t)·E[Qt])=λ(t)e∫μ(u)du.Now using the product rule and chain rule of differentiation, we can write the left hand side ase∫μ(u)du(ddtE[Qt]+μ(t)·E[Qt])=ddt(λ(t)e∫μ(u)du)whereddt(λ(t)e∫0tμ(u)du)=λ(t)e∫0tμ(u)du.Now by integrating both sides, we have that∫e∫μ(u)du(ddtE[Qt]+μ(t)·E[Qt])=∫ddt(λ(t)e∫μ(u)du).Finally, using the fundamental theory of calculus and dividing by the integrating factor, we have thatE[Qt]=Q0·exp{−∫0tμ(s)ds}+(exp{−∫0tμ(s)ds}·(∫0tλ(s)exp{−∫0sμ(r)dr}ds)).For the variance, we observe the fact thatVar•[Qt]−E•[Qt]=λ(t)+μ(t)·E[Qt]−2·μ(t)·Var[Qt]−λ(t)+μ(t)·E[Qt]=2·μ(t)·E[Qt]−2·μ(t)·Var[Qt]=2·μ(t)·(E[Qt]−Var[Qt])=−2·μ(t)·(Var[Qt]−E[Qt]).Since the last equation describes a first order linear differential equation forVar[Qt]−E[Qt],we know that its solution isVar[Qt]−E[Qt]=(V0−Q0)·exp{−2∫0tμ(s)ds}.Moving the mean to the righthand side yields the solution for the variance asVar[Qt]=E[Qt]+(V0−Q0)·exp{−2∫0tμ(s)ds}.□From this theorem, it is immediately clear that the mean is very close to the variance and when the queue is initialized at zero or with a Poisson distribution, then the mean and variance are equal for all times. Moreover, the Poisson assumption in this case is not unrealistic when the initial mean and initial variance are close or when the time is large enough and μ(t) is bounded away from zero.However, before we prove the results, we provide a lemma that shows that the tail distribution of a Poisson distribution can be expressed in terms of the incomplete gamma function.Lemma 3.2(3.21)Γ(c,x)=∑m=c∞e−x·xmm!=1Γ(c)∫0xe−yyc−1dy(3.22)Γ¯(c,x)=∑m=0c−1e−x·xmm!=1Γ(c)∫x∞e−yyc−1dy.where(3.23)Γ(c,x)=1Γ(c)∫0xe−yyc−1dyandΓ¯(c,x)=1Γ(c)∫x∞e−yyc−1dyare the lower and upper incomplete gamma functions respectively. Moreover, we defineΓ−1(x,ϵ,k)andΓ¯−1(x,ϵ,k)to be the functional inverses ofΓ(c+k,x)andΓ¯(c+k,x)respectively.ProofSee (Janssen, Van Leeuwaarden, Zwart et al., 2008) or Pender (2014c).□Moreover, the Chen–Stein method can aid us in our computation of various quantiles and expectations related to the risk measures. We include the Chen–Stein theorem below for the convenience of the reader.Theorem 3.3Chen–SteinLet Q be a random variable with values inN. Then, Q has the Poisson distribution with mean rate q if and only if, for every bounded functionf:N→N,(3.24)E[Q·f(Q)]=q·E[f(Q+1)]ProofSee (Peccati & Taqqu, 2011).□The Value at Risk, Average Value at Risk, Mean-Variance Risk, and Entropic Risk for the nonstationary infinite server queue with mean q is given by the following formulas(3.25)V@R(Q,ϵ)=Γ¯−1(q,ϵ)(3.26)AV@R(Q,ϵ)=q·Γ(q,νϵ−1)]Γ(q,νϵ)(3.27)Mean−Variance(Q,γ,p)=q+γ·q(3.28)Entropic(Q,γ)=q·(e−γ−1)γProofFor the Value at Risk, we have that(3.29)V@R(Q,ϵ)=inf{y|P{Q≤y}≥ϵ}(3.30)=inf{y|Γ¯(q,y)≥ϵ}(3.31)=Γ¯−1(q,ϵ).For the Average Value at Risk, we first letνϵ=V@R(Q,ϵ)and thus we obtain the following(3.32)AV@R(Q,ϵ)=E[Q|Q>νϵ](3.33)=E[Q·{Q>νϵ}]P(Q>νϵ)(3.34)=E[Q·{Q>νϵ}]Γ(q,νϵ)(3.35)=q·E[{Q+1>νϵ}]Γ(q,νϵ)Chen−SteinIdentity(3.36)=q·Γ(q,νϵ−1)]Γ(q,νϵ).For the Mean-Variance Risk, we exploit the fact that the Poisson distribution has all of its cumulant moments equal to its mean. Thus,(3.37)Mean−Variance(Q,γ,p)=E[Q]+γ·Var[Q](3.38)=q+γ·qLastly, for the entropic risk measure, we have that(3.39)Entropic=1γlog(E[e−γ·Q])(3.40)=1γlog(∑k=0∞e−γ·k·qkk!·e−q)(3.41)=1γlog(eq·(e−γ−1))(3.42)=q·(e−γ−1)γ.□One thing to observe is that the Mean-Deviation of order 2 risk measure, which is similar in spirit to the Mean-Variance risk measure, is similar to the staffing level derived from the square root staffing formula of Jennings et al. (1996). Recall that in the paper of Jennings et al. (1996), they use the infinite server queue as the mean offered load and provide a square root safety factor, which turns out to be the square root of the mean queue length since they exploit the fact that the Poisson distribution has the unique property of having all of its cumulant moments equalling the mean. Thus, this implies that the mean is equivalent to the variance. Furthermore, ifqt∞is sufficiently large, then we can use a normal approximation to the Poisson distribution to gain insight in staffing. Using the infinite server approximation and then the normal approximation implies that(3.43)P(Q(t)≥c(t))≈P(Q∞(t)≥k(t))(3.44)≈=P(qt∞+qt∞·X≥k(t))(3.45)=P(X≥k(t)−qt∞qt∞)(3.46)=Φ¯(k(t)−qt∞qt∞)where X denotes a Gaussian random variable with mean 0 and variance 1 andΦ¯(x)is the complement of the standard Gaussian cdf. Using this approximation, one can generate the following square root staffing formula(3.47)k∞(t)=⌈qt∞+β·qt∞⌉,which should yield stable delay probabilities for our original system. Thus, in order to stabilize the delay probabilities of a multiserver queue at probability ϵ, one must replace γ in the risk measure expression with the inverse Gaussian cdf at ϵ orΦ¯−1(ϵ).On the left of Fig. 1we plot the V@R for the infinite server queue for different values of ϵ. We see that our explicit formulas are quite accurate for estimating the value at risk for the Mt/M/∞ queueing model. On the right of Fig. 1, we plot the AV@R for the Mt/M/∞ queueing model and for different values of tolerance level ϵ. Like in the case of the V@R, we see that our explicit formulas are also quite good at estimating the simulated AV@R risk measure for the queueing model. On the left of Fig. 2, we plot the Entropic risk measure for different values of γ. We also see that our explicit formulas are accurate at estimating the appropriate risk for the infinite server queue. We see however, that the case whereγ=.05or where γ is closest to 0, seems to be the least accurate case. On the right of Fig. 2, we plot the Mean-Variance risk measure for the queueing process and different values of γ. We also see that our explicit formulas accurately capture the dynamic behavior of the risk measure over time.It is clear that the explicit formulas for the infinite server queue are quite accurate for the queue length process itself. However, in some settings is also interesting to derive risk measures for non-linear functions of the queue length process. In the sequel, we will derive explicit formulas for several functions of the queue length, which are important to the queueing and financial mathematics communities.In this section, we now derive some functional risk measures for the Mt/G/∞ and Mt/Mt/∞ queues. Two of the most important functions that appear in both the financial and queueing literature aref(X)=(X−k)+andf(X)=(k−X)+. In the financial literature these functions respectively represent call and put option payoffs with respect to the random variable X and have strike price equal to k. In the infinite server queue context, k is viewed as a fictitious buffer where we can see how much the buffer is either being exceeded whenf(X)=(X−k)+or how much the buffer is being underutilized whenf(X)=(k−X)+.In the multi-server queueing literature, if k represents the number of servers that are providing service for the system then the two functionsf(X)=(X−k)+andf(X)=(k−X)+respectively represent the number of customers that are waiting to engage in service with an agent and the number of agents that are currently idle and are not currently serving a customer. Moreover, from a manager’s perspective, both of these functions represent inefficiencies in the system. When the functionf(X)=(X−k)+is positive customers are waiting for service and the quality of service is perceived to be low. However, when the functionf(X)=(k−X)+is positive, this means that the manager is staffing the system with too many agents and this is not cost effective from the manager’s perspective.Proposition 3.5The Functional Value at Risk, Functional Average Value at Risk, Functional Mean-Variance Risk, and Functional Entropic Risk for the nonstationary infinite server queue with mean q and functionf(Q)=(Q−k)+is given by the following formulasFunctionalV@R(f(Q),ϵ)=Γ¯−1(q,ϵ,k)FunctionalAV@R(f(Q),ϵ)=q·Γ(q,νϵ+k−1)−k·Γ(q,νϵ+k)Γ(q,νϵ+k)FunctionalMean−Variance(f(Q),γ,p)=E[(Q−k)+]+γ·Var[(Q−k)+]FunctionalEntropic(f(Q),γ)=1γ·log(Γ¯(q,k)+eγ·k−q·Γ(e−γ·q,k))whereE[(Q−k)+]=q·Γ(q,k−1)−k·Γ(q,k)Var[(Q−k)+]=q2·Γ(q,k−2)+q·Γ(q,k−1)−2·k·q·Γ(q,k−1)+k2·Γ(q,k)2·q·k·Γ(q,k−1)·Γ(q,k)−k2·Γ2(q,k)−q2·Γ2(q,k−1).Moreover, for the functionf(Q)=(k−Q)+we have thatFunctionalV@R(f(Q),ϵ)=Γ−1(q,ϵ,k)FunctionalAV@R(f(Q),ϵ)=k·Γ¯(q,νϵ+k)−q·Γ¯(q,νϵ+k+1)Γ¯(q,νϵ+k)FunctionalMV(f(Q),γ,p)=E[(k−Q)+]+γ·Var[(k−Q)+]FunctionalEntropic(f(Q),γ)=1γ·log(Γ(q,k)+eγ·k−q·Γ¯(e−γ·q,k))whereE[(k−Q)+]=k·Γ¯(q,k)−q·Γ¯(q,k−1)Var[(k−Q)+]=k2·Γ¯(q,k)−2·k·q·Γ¯(q,k−1)+q·Γ¯(q,k−1)+q2·Γ¯(q,k−2)−k2·Γ¯2(q,k)+2·Γ¯(q,k)·Γ¯(q,k−1)−q2·Γ¯2(q,k−1).ProofSee Appendix.□Now that we have addressed the infinite server queue, we would like to extend our risk measures to a more general queueing model that takes into account that most queues have a finite number of servers and that most customers are not infinitely patient when waiting for service from an agent. The Erlang-A model is the canonical choice when considering these new features of the queueing model. Since the Erlang-A has these new features, it is not as tractable as the infinite server queue. Thus, we will exploit new approximations for this queueing system that are accurate and derive risk measures for these approximations. However, now we give a brief overview of the Erlang-A model for the reader’s convenience.In this section we introduce theMt/M/kt+Mqueueing model that serves to describe the dynamics of our hospital dynamics. Mandelbaum et al. (1998), showed that the queueing system process {Q(t)|t ≥ 0} is represented by the following equationQ(t)=Q(0)+Π1(∫0tλ(s)ds)−Π2(∫0tμ·(Q(s)∧c(s))ds)−Π3(∫0tβ·(Q(s)−c(s))+ds),where Πi≡ {Πi(t)|t ≥ 0} fori=1,2,3are i.i.d. standard (rate 1) Poisson processes. The deterministic time change for Π1 transforms it into a non-homogenous Poisson arrival process with rate λ(t). Subjecting Π2 to random time change causes it to count the number of service departures from c servers and exponentially distributed service times function of mean 1/μ. Finally the random time changes of Π3 cause it to count the number of abandonments from c servers and exponentially distributed abandonment times of mean 1/β. With this representation of our queueing dynamics, this model is an example of a Markovian service network, which were extensively studied in Mandelbaum et al. (1998).In Mandelbaum et al. (1998) it was shown that a Markovian service network always has a fluid and diffusion limits i.e.(4.49)1ηQη=qa.sandη·(1ηQη−q)⇒Q^where the fluid mean is governed by the one dimensional dynamical system(4.50)q•=λ−μ·(q∧c)−β·(q−c)+and if the set{t|q(t)=c}has measure zero thenQ^is a Gaussian diffusion whose variance combines with the fluid mean to form a 2-dimensional dynamical system given by (2.2) and(4.51)Var[Q^]•=λ+μ·(q∧c)+β·(q−c)+−2·Var[Q^]·(μ·{q<c}+β·{q≥c}).where {q < c} denotes an indicator function equaling one if, q < c, and zero otherwise. However, for small systems like in hospitals, it was shown in Ko and Gautam (2013), Massey and Pender (2011, 2013), Pender (2014a,b) that these fluid and diffusion limits do not do a great job of characterizing the correct moment behavior. Therefore, we will use approximations for our queueing process that will serve to estimate the transient dynamics.The first approximation, which we call the Gaussian variance approximation was first developed by Ko and Gautam (2013) and further simplified and explained in Massey and Pender (2011). This approximation assumes a Gaussian distribution for the queueing model i.e(4.52)Q(t)=dq(t)+X·v(t).for all t ≥ 0, where {q(t), v(t)|t ≥ 0} is some two-dimensional dynamical system where the v process is always positive and X is a standard Gaussian random variable. We call this the Gaussian variance approximation (GVA). The forward equations for the mean and variance of Q are(4.53)E•[Q]=λ−(μ·E[Q∧c]+β·E[(Q−c)+])(4.54)Var•[Q]=λ+μ·E[Q∧c]+β·E[(Q−c)+]−2(μ·Cov[Q,Q∧c]+β·Cov[Q,(Q−c)+])Now if we define the following variableχ=c−qv,we get the following differential equations for the mean and variance of the queueing process under the distributional assumptions of GVAE•[Q]=λ−(μ·v·E[X∧χ]+β·v·E[(X−χ)+])Var•[Q]=λ+μ·v·E[X∧χ]+β·v·E[(X−χ)+]−2(μ·v·Cov[X,X∧χ]+β·v·Cov[X,(X−χ)+])Thus, in order to understand the dynamics, it only remains to compute the expectations and covariance. Like Massey and Pender (2011), we resort to using Stein’s lemma to derive the expectations and covariance terms. To do this we use the following Hermite polynomial generalization of Stein’s lemma.Lemma 4.1If X is a standard Gaussian random variable and E[f(n)(X)] < ∞, thenE[f(X)·hn(X)]=E[f(n)(X)]where f is any generalized function and f(n)is the nth derivative of the function f.The use of Stein’s lemma yields the following equations for the mean and variance dynamics of our queueing process:E•[Q]=λ−μ·q+v·(μ−β)·(φ(χ)−χ·Φ¯(χ))Var•[Q]=λ+μ·q−v·(μ−β)·(φ(χ)−χ·Φ¯(χ))−2·v·(μ·Φ(χ)+β·Φ¯(χ))where we define φ and Φ to be the density and the cumulative distribution functions, respectively, for X ∼ Normal(0, 1), i.e.,(4.55)φ(x)≡12πe−x2/2,Φ(x)≡∫−∞xφ(y)dy,andletΦ¯(x)≡∫x∞φ(y)dy.In the sequel, we will show how to use the Gaussian variance approximation in order to approximate various risk measures of the Erlang-A queueing model.In this section, we show that the GVA can be used to approximate various risk measures of the Erlang-A queue. However, we should mention that whenc=∞orμ=β,the Erlang-A queueing model reduces to the infinite server queue and we have already given exact results for this case in the previous sections of the paper.Proposition 4.2Under the assumptions of the GVA for the queue length, then the Value at Risk, Average Value at Risk, Mean-Variance Risk, and Entropic Risk have the following expressionsV@r(Q,ϵ)=q+v·Φ−1(ϵ)AV@r(Q,ϵ)=q+v·φ(νϵ−qv)Φ¯(νϵ−qv)Mean−Variance(Q,γ)=q+γ·vEntropic(Q,γ)=−q+γ·v2.From the definition of the Value at risk, we have that(4.56)V@r(Q,ϵ)=inf{y:P{Q≤y}≥ϵ}.Thus, we we assume that the queue length is approximated by GVA, we get thatV@r(Q,ϵ)=inf{y:P{Q≤y}≥ϵ}=inf{y:P{q+v·X≤y}≥ϵ}=inf{y:P{X≤y−qv}≥ϵ}=inf{y:Φ(y−qv)≥ϵ}=q+v·Φ−1(ϵ).Now we show the exact formula for the AV@R. From the definition of the AV@R, we have that(4.57)AV@r(Q,ϵ)=E[Q|Q>νϵ]where we defineνϵ=V@r(Q,ϵ). Thus, when we approximate the queue length distribution with the GVA and defineχ=νϵ−qv,we have thatAV@r(Q,ϵ)=E[Q|Q>νϵ]=E[q+v·X|q+v·X>νϵ]=E[(q+v·X)·{q+v·X>νϵ}]E[{q+v·X>νϵ}]=q·P{q+v·X>νϵ}+v·E[X·{q+v·X>νϵ}]P{q+v·X>νϵ}=q·P{X>χ}+v·E[X·{X>χ}]P{X>χ}=q·Φ¯(χ)+v·φ(χ)Φ¯(χ)=q+v·φ(χ)Φ¯(χ).Remark 4.3Note thatq+v·φ(χ)Φ¯(χ)>q+χ·v,which implies that the AV@R is larger than the V@R for the same value of ϵ.For the Mean-Variance risk measure, which is defined as(4.58)Mean−Variance(Q,γ)=E[Q]+γ·Var[Q],we use the standard properties of the Gaussian distribution to conclude that(4.59)Mean−Variance(Q,γ)=q+γ·v.Lastly, we derive the exact expressions for the Entropic risk measure. For the Entropic risk measure we have that(4.60)ρ(Q,γ)=1γ·log(E[e−γ·Q]).Thus, when we assume that the queue length is approximated by GVA, we get that1γ·log(E[e−γ·Q])=log(E[e−γ·(q+v·X)])=1γ·log(E[e−γ·q]·E[e−γ·v·X])=1γ·log(e−γ·q)+1γ·log(E[e−γ·v·X])=−q+γ·v2□On the left of Fig. 3we plot the V@R for the Erlang-A queue for different values of ϵ. We see that our approximate formulas are quite accurate for estimating the V@R for the Erlang-A queueing model. On the right of Fig. 3, we plot the AV@R for the Erlang-A queueing model and for different values of tolerance level ϵ. Like in the case of the V@R, we see that our explicit formulas are also quite good at estimating the simulated AV@R risk measure for the queueing model. On the left of Fig. 4, we plot the Entropic risk measure for different values of γ. We also see that our Gaussian approximations are accurate at estimating the appropriate risk for the Erlang-A queue. We see however, that the case whereγ=.05or where γ is closest to 0, seems to be the least accurate case. On the right of Fig. 4, we plot the Mean-Variance risk measure for the queueing process and different values of γ. We also see that our approximate formulas accurately capture the dynamic behavior of the risk measure over time.It is clear that the explicit formulas for the Erlang-A queue are quite accurate for the queue length process itself. However, in some settings is also interesting to derive risk measures for non-linear functions of the queue length process. In the sequel, we will derive explicit formulas for several functions of the queue length, which are important to thequeueing literature.Proposition 4.4Under the GVA and whenf(Q)=(Q−k)+,the Functional Value at Risk, Functional Average Value at Risk, Functional Mean-Variance Risk, and Functional Entropic Risk have the following expressionsFunctionalV@r((Q−k)+,ϵ)=q−k+v·Φ−1(ϵ)FunctionalAV@r((Q−k)+,ϵ)=v·φ(χk,c)Φ¯(χk,c)−v·χk,cFunctionalMean−Var((Q−k)+,ϵ)=E[(Q−k)+]+γ·Var[(Q−k)+]FunctionalEntropic((Q−k)+,ϵ)=1γlog(Φ(χk)+eγ2·v/2+γ·v·χk·Φ¯(χk+γ·v))whereE[(Q−k)+]=v·(φ(χk)−χk·Φ¯(χk))Var[(Q−k)+]=v·(−χk·φ(χk)+(χk2+1)·Φ¯(χk)−φ(χk)2)+v·(−χk2·Φ¯(χk)2+2·χk·φ(χk)·Φ¯(χk)).Moreover, whenf(Q)=(k−Q)+,the Functional Value at Risk, Functional Average Value at Risk, Functional Mean-Variance Risk, and Functional Entropic Risk have the following expressionsFunctionalV@r((k−Q)+,ϵ)=k−q+v·Φ¯−1(ϵ)FunctionalAV@r((k−Q)+,ϵ)=k−q+v·φ(χk,c)Φ¯(χk,c)FunctionalMean−Var((k−Q)+,ϵ)=E[(k−Q)+]+γ·Var[(k−Q)+]FunctionalEntropic((k−Q)+,ϵ)=1γlog(Φ¯(χk)+eγ2·v/2−γ·v·χk·Φ(χk−γ·v)).whereE[(k−Q)+]=(k−q)·Φ(χ)+v·φ(χ)Var[(k−Q)+]=v·(χ2+1)·Φ(χ)+χ·v·φ(χ)−((k−q)·Φ(χ)+v·φ(χ))2.See Appendix.□In addition to the fact that the risk measures provide performance measures for queueing models, the risk measures derived for these nonstationary queues can also be used as staffing procedures. On the left of Fig. 5, we use the V@R as a staffing procedure for the Erlang-A queueing model. We see that the V@R somewhat stabilizes the probability of delay near the value of ϵ that is used for the V@R calculation. This is partly because the staffing level given by the V@R is similar to the offered load approach of Jennings et al. (1996). Moreover, on the right of Fig. 5, we use the AV@R as a staffing procedure for the Erlang-A queueing model. We also see this time that staffing with the AV@R also somewhat stabilizes the probability of delay. It should be noted that the probability of delay using AV@R is lower than the probability of delay when using V@R. This is because the staffing level derived from AV@R is larger since AV@R is the average of the tail values of the V@R. However, we should also mention that the variation that one sees for the probability of delay is due to the addition or removal of one server. This is partially observed when ϵ is the smallest since the variation is the smallest and the largest number of servers is used for staffing. Thus, the impact of adding or removing one server is much smaller.On the left of Fig. 6, we use the V@R as a staffing procedure for the Erlang-A queueing model. We see that the V@R does not stabilizes the abandonment probability. This is consistent with Liu and Whitt (2012) where they show that it is impossible to stabilize both using the same staffing procedure, except when the probabilities are very small. Moreover, on the right of Fig. 6, we use the AV@R as a staffing procedure for the Erlang-A queueing model. We also see this time that staffing with the AV@R does not stabilizes the abandonment probability. Similar to the previous figure, we also observe that noted that the resuting abandonment probability using AV@R as the staffing procedure is lower than the abandonment probability when using V@R.This method of using the mean and variance of the queueing model can be used beyond the Erlang-A model. There are fluid and diffusion limits for queues with more general arrival, service times, and abandonment times. See for example , Liu and Whitt (2011); 2012); Liu, Whitt et al. (2014) and Jelenković, Mandelbaum, and Momčilović (2004); Mandelbaum and Momcilovic (2012); Zeltyn and Mandelbaum (2005) . The mean and variance of these fluid and diffusion models can be used as Gaussian approximations of the underyling stochastic process in the risk measure formulation. Using the same formulas, one can also derive approximations to the risk measures for more general queueing models. Although we do not consider these queueing models in this paper, it is perhaps interesting to see if the Gaussian fluid and diffusion approximations help in providing good approximations for the risk measures of the original queueing model.

@&#CONCLUSIONS@&#
We have analyzed the problem of staffing queueing systems with risk measures. We have shown that many of the traditional staffing procedures like square root staffing and the modified offered load procedure can be derived from some of the standard risk measures. This paper introduces the concept of risk measures to the queueing theory community and shows how they can be relevant, especially in the context of healthcare systems. One extension worth pursing, is to extend our analysis to a multi-dimensional setting. To pursue this requires extensions of the approximations of the queueing systems to multi-dimensional settings and also extending the notion of risk measures to a multi-dimensional setting. Some progress has been made on the risk measure side see for example (Klyman, 2011). It would be of particular interest to apply it to variants of the Erlang-R model of Yom-Tov and Mandelbaum (2014). Moreover, it is also possible to analyze many other risk measures that are not presented in this work, see for example the list of risk measures in Cheridito and Li (2008); 2009). Lastly, the concept of a conditional risk measure has been developed recently in the work of Detlefsen and Scandolo (2005) and these types of risk measures are worth study given new applications such as queueing theory.Another area of interest is to use the fluid and diffusion limits of Mandelbaum and Momcilovic (2012) to approximate the risk measure performance of more general queueing systems. This would allow managers to approximate risk measures for more general systems that model reality well. Another extension would be to construct risk measure approximations for the single server queue as well. In the stationary case, this analysis would involve the geometric distribution. Like the Chen–Stein theorem and Stein’s lemma, the geometric distribution also has a characterizing operator and it is of the form(5.61)Af(k)=(1−p)·(f(k+1)−f(k))−p·f(k)+p·f(0).The same analysis used earlier can also be used to calculate risk measures for the single server queueing model and yield performance measures for managers with different risk profiles.