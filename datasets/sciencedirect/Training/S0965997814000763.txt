@&#MAIN-TITLE@&#
An equivalent multiscale method for 2D static and dynamic analyses of lattice truss materials

@&#HIGHLIGHTS@&#
A multiscale computational method is developed.A new coarse element is proposed to describe the more complex deformations.Mode base functions are added into the original multiscale base functions.

@&#KEYPHRASES@&#
Multiscale computational method,Dynamic analysis,Lattice truss materials,Multiscale base functions,Continuum model,Mode base function,

@&#ABSTRACT@&#
A uniform multiscale computational method is developed for 2D static and dynamic analyses of lattice truss materials in elasticity based on the extended multiscale finite element method. A kind of multi-node coarse element is proposed to describe the more complex deformations compared with the original four-node coarse element and the mode base functions are added into the original multiscale base functions to consider the effects of inertial forces for the dynamic problems. The constructions of the displacement and mode base functions are introduced in detail. In addition, the orthogonality of the displacement and mode base functions are also proved, which indicates that the macroscopic displacement DOF and modal DOF are irrelevant and independent of each other. Finally, some numerical experiments are carried out to verify the validity and efficiency of the proposed method by comparison with the reference solution obtained by the standard finite element method on the fine mesh.

@&#INTRODUCTION@&#
Over the past few decades, more and more ultra-light materials are applied to the industrial design because of the advantages such as high stiffness, high strength and light weight. Meanwhile, these materials have also been used in automobile, aerospace and aircraft industries. Among various ultra-light materials, the truss materials have received increasing attentions due to its high stiffness-weight and strength-weight ratios in recent years. The photographs of the 3D lattice truss structures are depicted in Fig. 1[1,2]. Wallach and Gibson [1] studied the mechanical properties of a particular geometry of 3D truss materials as a function of the aspect ratio of the unit cell. In addition, comparisons of the results between the numerical prediction and experiment have been carried out by Wallach. Deshpande et al. [2] investigated the effective mechanical properties of the octet-truss lattice structure material both experimentally and theoretically. Hutchinson and Fleck [3] applied matrix methods of linear algebra to analyze the structural mechanics of the periodic Kagome lattice and triangular–triangular (T–T) lattice truss based on the Bloch’s theorem.It is unrealistic to solve the large lattice truss structure problems by using the direct numerical method such as finite element method (FEM) because of the limitations of computer memory and computing time. A variety of multi-scale methods and equivalent models are proposed by many researchers to save computational resources for the lattice truss structures. Fan and Yang [4] developed an equivalent continuous method to investigate the effective stiffness of three-dimensional stretching dominated lattice materials. The predicted properties were consistent with the experimental results and this indicated that the proposed continuum model can be used to predict the mechanical properties of the lattice structures. Yan et al. [5] compared the representative volume element (RVE) method based on the homogenization method for predicting the effective elastic property of truss materials with periodic microstructure. Moreau and Caillerie [6] developed a continuum model based on the homogenization method to analyze the geometric large deformation problems of the large periodic beam-like lattice truss structures. Burgardt and Cartraud [7] presented a general procedure based on the energy equivalence to determine the equivalent beam properties of beam-like lattice trusses. Gonella and Ruzzene [8] investigated the equivalent in-plane properties of hexagonal and re-entrant (auxetic) lattices through the analysis of partial differential equations associated with their homogenized continuum models. The general static and dynamic mechanical properties of the lattice structures are estimated by the presented continuum model based on the homogenization technique. Furthermore, Gonella and Ruzzene [9] also proposed a multiscale formulation for one-dimensional spring-mass system and two-dimensional truss lattice structure based on the homogenization technique and applied this formulation to investigate the elasto-dynamic properties of the periodic lattice truss structures. Vigliotti and Pasini [10] presented a multiscale procedure for the linear analysis of the structure with lattice material. Elsayed and Pasini [11] discussed the design of the microstructure of a lattice material with regular octet-truss cell topology and the multiscale design of an axially loaded member manufactured of this type of cellular solid. Zeman et al. [12] studied the mechanical behaviors of statistically non-uniform two-phase elastic discrete lattice structures based on the methodology proposed by Luciano and Willis [13]. Vigliotti and Pasini [14] recently presented a multiscale procedure for the linear analysis of the stiffness and strength of open and closed three-dimensional cell lattices with arbitrary topology.Similarly, several other multiscale methods which were developed to save the computing resources are presented recently. Fish and Yuan proposed a multiscale enrichment method based on the partition of unity (MEPU) [15] and then extended this method to the nonperiodic fields and nonlinear problems successfully [16]. By employing the generalized variational principles, Xu et al. [17] developed a Green-function-based multiscale method to decompose the boundary value problem with random microstructure into a slow scale deterministic problem and a fast scale stochastic one. Then, Shen and Xu [18] discussed the computational aspects of this method in detail. Liu and McVeigh [19] derived a general multiscale theory for modeling heterogeneous materials via a nested domain based virtual power decomposition. Lim et al. [20] proposed a kind of variable-node finite element with smoothed integration for the multiscale mechanics problems.The multiscale finite element method (MsFEM), which can be traced back to the work presented by Babuska et al. [21,22], has been used by Hou et al. [23,24] to solve the boundary value problems with high oscillating coefficients. This multiscale method has been widely used to simulate the multiscale problems [25,26]. To study the problems in solid mechanics, Zhang et al. [27] developed a coupling multiscale finite element method (CMsFEM) for consolidation analysis of heterogeneous saturated porous media. Furthermore, an extended multiscale finite element method (EMsFEM) was proposed by Zhang et al. for the elastic and elasto-plastic static analysis of periodic lattice truss materials [28,29]. In EMsFEM, the multiscale base functions are numerically constructed and can capture the heterogeneous properties at the microscopic level effectively. Particularly, the additional coupling terms of the multiscale numerical base functions among different directions in multi-dimensional problems are taken into consideration, which can improve the computational accuracy significantly.In this paper, a uniform multiscale computational method is developed based on EMsFEM for 2D static and dynamic analyses of the lattice truss materials on elasticity. As we all know, for the static problems, the displacement of the structure is associated with the stiffness of the structure and the external force directly. While for the dynamic problems, the inertial force of the structure also needs to be considered. Therefore, the multiscale numerical base functions in EMsFEM should reflect the effect of the inertial force of the structure for the dynamic analysis. Just because of this, the mode base functions are introduced into the original multiscale base functions to improve the computational accuracy for the dynamic problems. On the other hand, the coarse element used in EMsFEM is usually the four-node coarse element which can only accurately describe the simple deformations, and this four-node coarse element would be powerless for the more complex deformations in the dynamic analysis. In this context, one will have to refine the coarse-scale meshes when calculating the 2D dynamic problems with the four-node coarse element, and this will reduce greatly the computational efficiency and advantages of EMsFEM. Therefore, in order to ensure the computational accuracy without increasing too much amount of computational cost, it is necessary to modify the four-node coarse element to describe the more complex deformations. For this reason, a kind of multi-node coarse element is proposed in this paper.The research significances of this multiscale method in the practical engineering are very clear. For the large and complex truss structures, the traditional numerical methods in current commercial software can only simulate their mechanical behaviors by refining the mesh to the size of a single truss element. This is bound to spend huge computer memory and CPU time. Moreover, for some extra large problems, the current commercial software even cannot obtain a valid solution under the present circumstances due to the restrictions of the computer memory and computation time. By comparison, this multiscale method can not only obtain a relatively accurate result, but also reduce a large amount of computer memory and computing time. Therefore, it has practical engineering significances to study this multiscale method.The contents of this paper are as follows. In Section ‘Brief review of the extended multiscale finite element method (EMsFEM)’, a brief review of the extended multiscale finite element method (EMsFEM) is given. Then, some fundamental principles of the proposed multiscale computational method are introduced in Section ‘Basic principles of the uniform multiscale computational method’. The static analysis, generalized eigenvalue analysis and dynamic response analysis are presented in Sections ‘Static analysis’, ‘Generalized eigenvalue analysis’ and ‘Dynamic response analysis’, respectively. Finally, some conclusions are given in Section ‘Conclusions’.The implementation of the EMsFEM mainly consists of two parts [30]. One is the microscopic computation in which the multiscale base functions of each coarse element are constructed independently by solving the local static equilibrium equations on the micro-structure (unit cell). Then the equivalent stiffness matrix and the equivalent force vector for each coarse element can be obtained naturally. The other part is the macroscopic computation in which the global stiffness matrix and external force vector of the structure with the coarse element mesh are assembled and then the static equilibrium equations can be solved at the macroscopic scale which will save many computational resources and much computing time.For the vector field analysis, the multiscale base functions must be constructed separately in each direction to consider the heterogeneities within the coarse element. In addition, the additional coupling terms have a great impact on the calculation results. So it is significant to consider the coupling effect among different directions due to the Poisson effect when constructing the base functions of each coarse element. Several kinds of the boundary conditions are proposed to construct the multiscale base functions in EMsFEM [30], for example, linear boundary conditions, oversampling boundary conditions, periodic boundary conditions and generalized periodic boundary conditions.In this section, the basic principles of the proposed uniform multiscale computational method will be introduced in detail. In order to describe the complex deformation in the dynamic analysis, a kind of multi-node coarse element is developed. Similarly, to consider the effect of the inertial force in the dynamic problems, the mode base functions are added to the original multiscale base functions. This is to say that the new multiscale base functions will include two parts: the displacement and mode base functions. These two parts are obtained by solving the static equilibrium equations and the generalized eigenvalue equations on the micro-structure (unit cell), respectively. The generation processes of these two kinds of base functions will be elaborated as follows.There are two sets of the meshes which are used in this paper (see Fig. 2). One is the discrete fine truss element mesh (marked by the thin black line in Fig. 2) for the reference solution by using FEM. The other is the equivalent continuous coarse element mesh (marked by the thick blue line in Fig. 2) for the multiscale solution by using the proposed uniform multiscale computational method.The original four-node coarse element [29,30] and the new multi-node coarse element are shown in Fig. 3where there are greater than or equal to two macronodes (marked by the black spots in Fig. 3) on each boundary of the multi-node coarse element. In addition, the number of the macronodes on each boundary can be different. However, to make the matter simple, the multi-node coarse elements with a uniform distribution of the macronodes are employed in this paper.From our previous work, one can find that the displacement base functions with oscillating boundary conditions of the original four-node coarse element can provide more accurate results. For the four-node coarse element, the oversampling technique [23] is a frequently-used approach to obtain the oscillating boundary conditions. However, this technique will be invalid for the multi-node coarse element. Thus a new approach is proposed here to generate the specific boundary conditions to construct the displacement base functions of the multi-node coarse element.Generally speaking, the construction process of the displacement base functions of the multi-node coarse element can be divided into three steps. Firstly, the oscillating boundary values of the micro-structure (unit cell) are obtained by applying the oversampling technique to the corresponding four-node coarse element. Then the piecewise oscillating boundary values of the multi-node coarse element can be evaluated by the linear combination of the oscillating boundary values which are obtained in the previous step. Finally, the numerical displacement base functions of the multi-node coarse element can be calculated by solving the static equilibrium equations on the micro-structure with the specific boundary conditions which are the combinations of the piecewise oscillating boundary values.It should be mentioned that the displacement base functions are separately constructed in each direction for the 2D vector field problems. Here, we will describe each step in detail.Consider a larger oversampling domain Ωothat covers the coarse element domain Ωcas illustrated in Fig. 4, where Δ1234 is the corresponding four-node coarse element (target coarse element) and Δ1′2′3′4′ is the oversampling element. The temporary base functionsψj′of the node j′(j′=1′,2′,3′,4′) of the oversampling element are constructed with linear boundary conditions. Since the additional coupling terms are not taken into consideration in the temporary base functions,ψj′can be written as(1)ψj′=ψj′xx00ψj′yywhereψj′xx(orψj′yy) is the temporary base function of the node j′ of the oversampling element in the x direction (or y direction).Takenψ1′xxas an example to illustrate the linear boundary conditions imposed on the oversampling element (see Fig. 4), unit displacement is applied at node 1′ in the positive x direction, and the values of the displacements which are applied to the other boundary nodes vary linearly along the boundaries 1′2′ and 1′4′, just as the boundary values of the standard bilinear base functions of the four-node bilinear rectangular element in FEM. In addition, to avoid rigid displacement, the displacements of the node 3′ are set to zero in the x and y directions. Furthermore, the other micronodes on the boundaries 2′3′ and 3′4′ are fixed in the x direction. Through the imposition of this linear boundary condition, the temporary base functionsψ1′xxcan be obtained by solving the static equilibrium equations on the oversampling domain Ωoby using the standard FEM. Similarly, the rest temporary base functions of the other macronodes of the oversampling element can also be obtained by using the same approach. Finally, the temporary base function matrix ψ of the oversampling element can be given as(2)ψ=ψ1′xx0ψ2′xx0ψ3′xx0ψ4′xx00ψ1′yy0ψ2′yy0ψ3′yy0ψ4′yywhereψj′xxandψj′yyare no×1 matrices where nois the total number of the micronodes within the oversampling element. Note that each oversampling element includes 3×3 micro-structures in this paper.Then the temporary base functionsφi=φixx00φiyyof the macronode i of the corresponding four-node coarse element can be obtained by the linear combination ofψj′, i.e.(3a)φixx=∑j=14cijxψj′xx(3b)φiyy=∑j=14cijyψj′yywherecijxandcijyare the linear combination coefficients determined by the Kronecker delta properties:φixx(xj)=δijandφiyy(xj)=δijwhere xjrepresents the coordinates of the macronode j (j=1,2,3,4) of the corresponding four-node coarse element. It can be proved that the temporary base functionsφican satisfy the normalization conditions, i.e.∑i=14φixx=1and∑i=14φiyy=1. Without considering the additional coupling terms, the temporary base function matrixφof the corresponding four-node coarse element can be given as(4)φ=φ1xx0φ2xx0φ3xx0φ4xx00φ1yy0φ2yy0φ3yy0φ4yywhere the dimensions ofφixxandφixxare nc×1 where ncis the number of the micronodes in the sub-grids.Thus, the oscillating boundary values of the corresponding four-node coarse element can be expressed asφixx|sjin the x direction andφiyy|sjin the y direction where sjdenotes the jth (j=1–4) boundary of the coarse element.It is worth mentioning that each oversampling element contains 3×3 coarse elements in this paper. The effects of the size ratio between the oversampling element and the target coarse element have been discussed in our previous work (Refs. [28,30]).Taking an 8-node coarse element as an example to illustrate how to get the piecewise oscillating boundary values (see Fig. 5). The number of the macronodes on the boundary siof the multi-node coarse element is denoted by ni. Generally speaking, we have2≤ni≤niswherenismeans the number of the micronodes located on the boundary siof the multi-node coarse element. For ni=2, the multi-node coarse element degenerates into the four-node coarse element.Since the approach to get the piecewise oscillating boundary values is similar in different directions, here we only take the construction process in the x direction as an example. For the boundary s1 (i.e. the boundary from the node 1 to the node 2), the oscillating boundary values can be given as(5)ℓ1x1=φ1xx|s1,ℓ2x1=φ2xx|s1,ℓ3x1=φ3xx|s1,ℓ4x1=φ4xx|s1.whereℓixj=φixx|sjrepresents the values of the temporary base functionφixx(i=1, 2, 3, 4) on the boundary sjwhereφixxis the temporary base function for the macronode i of the corresponding four-node coarse element in the x direction. From the normalization condition, i.e.∑i=14φixx=1, we have(6)ℓ1x1+ℓ2x1+ℓ3x1+ℓ4x1=1To make the displacement base functions of the multi-node coarse element satisfy the rigid displacement conditions, two temporary oscillating functionsL1x1andL1x2are defined as follows(7)L1x1+L1x2=1whereL1x1=ℓ1x1+ℓ4x1(orL1x1=ℓ2x1+ℓ3x1), and another functionL1x2can be determined by Eq. (7), i.e.L1x2=1-L1x1=ℓ2x1+ℓ3x1(orL1x2=ℓ1x1+ℓ4x1).Generally, the temporary oscillating functionsLix1andLix2of the boundary sican be given as(8a)Lix1=ℓixi+ℓkxi=φixx|si+φkxx|si,(k=i-1)(8b)Lix2=1-Lix1whereLix1is the summation of the values of the functionsφixxandφkxxon the boundary siwhere k=i−1. If k=0, then let k=4.Then, the piecewise oscillating functionshk,ixmin the x direction can be obtained by the linear combination ofLixl(l=1, 2), i.e.(9)hk,ixm=∑l=12aklLixlwhere m denotes the serial number of the segments divided by the macronodes on the boundary si, and m=1–2 for the 8-node coarse element (see Fig. 5). The serial number of the segments is sorted by counterclockwise. For the boundary s1, m=1 stands for segment 15 (from node 1 to node 5) and m=2 stands for segment 52. Similarly, for the boundary s4, m=1 and m=2 represent segment 48 and segment 81, respectively. In addition, k (k=1, 2) denotes the trend of the functionshk,ixmon the segment m. k=1 denotes that the values ofhk,ixmare varying from 1 to 0 along the segment m. On the contrary, k=2 represents the values ofhk,ixmvarying from 0 to 1 along the segment m. aklare the linear combination coefficients and are determined by the conditionshk,ixm(xlm)=δklwherexlmrepresent the macronode coordinates of the segment m on the boundary siof the multi-node coarse element, in whichx1mandx2mare the first and second macronode coordinates of the segment m, respectively. For the boundary s1, the schematic diagram of the calculation process of the piecewise oscillating functionshk,ixmis shown in Fig. 6.Then, the piecewise oscillating functions of the other boundaries (s2,s3,s4) of the multi-node coarse element can also be calculated by using the same approach. Similarly, the piecewise oscillating functions of the boundary siof the multi-node coarse element in the y directionhk,iymcan also be determined by the same approach as mentioned above.For the 2D mechanical problems, the displacement base functionsNdiof the macronode i of the multi-node coarse element are composed of two parts, i.e.Ndi=NdixNdiy, whereNdixdenotes the base function matrix used for the displacement interpolation in the x direction andNdiyis the interpolation function matrix used in the y direction. The dimensions ofNdix,NdiyandNdiare 2nc×1, 2nc×1 and 2nc×2, respectively, where ncis the number of the micronodes in the sub grids within the coarse element. Since the additional coupling terms are taken into consideration here, the displacement function matrixNdixcan be expressed asNdix=NdixxNdiyx, whereNdixxandNdiyxare the values ofNdixin the x and y directions, respectively. In addition,Ndiyxrepresents the additional coupling term and means the displacement field in the y direction which is induced by imposing the specific displacement conditions Γion the boundaries of the multi-node coarse element. TakingNd1xas an example, the construction process of the displacement base functions of the 8-node coarse element (see Fig. 5) will be expatiated as follows.The displacement base function matrixNd1xcan be calculated by imposing the specific displacement conditions Γ1xxin the x direction and Γ1yyin the y direction on the boundaries and solving the following static equilibrium equations on the sub grids (micro-structure), i.e.(10)LNd1x=0,inΩcNd1xx∂Ωc=Γ1xx,Nd1yx∂Ωc=Γ1yy=0,on∂Ωcwhere L is the elasticity operator and satisfiesLu=div(D:12(∇u+(∇u)T))where D is a fourth order tensor representing the material properties; Γ1xxand Γ1yyare the values of the specific displacement conditions Γ1 in the x and y directions, respectively, i.e.Γ1=Γ1xxΓ1yy.The specific displacement conditions Γ1xxin the x direction are the combination ofh1,1x1for segment 15,h2,4x2for segment 81 and zeros for the other segments on the boundaries of the 8-node coarse element. On the other hand, the values of the specific displacement conditions Γ1yyin the y direction are equal to zero for all the segments on the boundaries of the 8-node coarse element, i.e. Γ1yy=0. It should be noted that only the specific displacement conditions are imposed on the boundaries of the multi-node coarse element and the body forces are not taken into account when calculating the displacement base functions.By solving Eq. (10), the displacement base function matrixNd1x=Nd1xxNd1yxcan be obtained numerically. Similarly, the rest displacement base functions can also be constructed by solving the static equilibrium equations on the micro-structure with the specific displacement conditions. Thus the numerical displacement base functions Ndof the multi-node coarse element can be given as(11)Nd=Nd1Nd2⋯Ndn=Nd1xNd1yNd2xNd2y⋯⋯NdnxNdny=Nd1xxNd1xyNd2xxNd2xy⋯⋯NdnxxNdnxyNd1yxNd1yyNd2yxNd2yy⋯⋯NdnyxNdnyywhere the dimensions of Nd,Ndi,NdixandNdixxare 2nc×2n, 2nc×2, 2nc×1 and nc×1, respectively, where ncis the number of the micronodes on the sub grids within the coarse element and n is the number of the macronodes of the multi-node coarse element;NdiyxandNdixyare the additional coupling terms.In addition, it is obvious that the displacement base functionsNdixx(orNdiyy) constructed above can satisfy the Kronecker delta properties, i.e.(12)Ndixx(xj)=δij=1J=i0J≠i,(i,j=1∼n)where xjdenote the coordinates of the macronode j of the multi-node coarse element, i.e.Ndixx(orNdiyy) is equal to 1 at the macronode i, while equal to 0 at the other macronodes. Furthermore, these displacement base functions of the multi-node coarse element can also satisfy the normalization conditions, i.e.∑i=1nNdix=1and∑i=1nNdiy=1.It is worth mentioning that there are both similarity and dissimilarity between the multi-node coarse element and the classical substructure method. Both of them eliminate the internal nodal degrees of freedom (DOFs) and take the boundary nodes as the outlet nodes. However, they are essentially different. In the classical substructure method, the internal nodal DOFs are eliminated by the static condensation technique and naturally all the boundary nodal DOFs are reserved in the final equations. By comparison, for the multi-node coarse element, the internal nodal DOFs are eliminated by solving the elliptic equations in the subdomain. Thus, only a small portion of the boundary DOFs are retained finally.As mentioned above, for the static problems, the displacement of the structure is only associated with the external force and the stiffness of the structure. The multiscale numerical base functions in the original EMsFEM are obtained by solving the static equilibrium equations on the micro-structure (unit cell). Thus the original EMsFEM is effective and efficient for the static problems because of the multiscale base functions can effectively capture the heterogeneities of the micro-structure. However, for the dynamic problems, the displacement of the structure is also associated with the inertial force. The multiscale numerical base functions in the original EMsFEM do not take the dynamic effect of the micro-structure into consideration. Thus, this will give rise to a significant calculation error inevitably for the dynamic problems. In order to reduce this error and improve the computation accuracy for the dynamic problems, the effect of the inertial force of the structure should be taken into account during the multiscale calculation and the mode base functions are introduced into the multiscale base functions. The construction processes of the mode base functions are presented as follows.The mode base functions Nmare constructed by solving the generalized eigenvalue problems on the micro-structure with fixed boundaries (see Fig. 7). The generalized eigenvalue equations can be expressed as(13)KsΦi=ωi2MsΦi,inΩcΦi=0,on∂Ωc,where Ksand Ms, obtained by using the standard FEM, are the overall stiffness and mass matrices of the micro-structure; Φiand ωiare the ith order mode and circular frequency of the micro-structure.After solving Eq. (13), the mode base functions Nmcan be obtained by the combination of the first p modes of the micro-structure, i.e.(14)Nm=Φ1Φ2…Φpwhere Nmis the normalized matrix and satisfies(15)NmTMsNm=INmTKsNm=Λwhere I is an identity matrix and Λ is a diagonal matrix which is consisted of the squares of the first p circular frequencies, i.e.(16)Λ=ω12ω22⋱ωp2It is worthwhile to mention that the values of p can be various for the different coarse elements. However, to make the matter simple, the same value of p is chosen for all the coarse elements in this paper.Then the multiscale base function matrix N will include two parts: the displacement base function matrix Ndand the mode base function matrix Nm, i.e.N=NdNm. Therefore, the relationship between the microdisplacements and the macrovariables can be expressed as(17)us=NdUdc+NmUmc=NdNmUdcUmc=NUcwhere Ndand Nmare the displacement and mode base function matrices of the multi-node coarse element, respectively; usdenotes the microdisplacement vector corresponding to the micronodes of the micro-structure;Udcis the macrodisplacement vector corresponding to the macronodes of the multi-node coarse element;Umcis the generalized modal coordinate vector (generalized coordinate vector) andUc=UdcUmcis the vector of the generalized macroquantities.The stiffness and mass matrices of the truss element (see Fig. 8) can be given as(18a)ke=EAlcos2θcosθsinθ-cos2θ-cosθsinθcosθsinθsin2θ-cosθsinθ-sin2θ-cos2θ-cosθsinθcos2θcosθsinθ-cosθsinθ-sin2θcosθsinθsin2θ(18b)me=ρAl62010020110200102where E, ρ, A and l are the elastic modulus, density, cross-sectional area and length of the truss element, respectively.Then the overall stiffness and mass matrices of the micro-structure can be obtained by using FEM, i.e.(19a)Ks=Ae=1Neke(19b)Ms=Ae=1NemewhereAe=1Neis the matrix assembly operator of the standard FEM; Neis the number of the truss element in the micro-structure; Ksand Msare the overall stiffness and mass matrices of the micro-structure.Thus the dynamic equations without considering the damping of the micro-structure can be given as(20)Msu¨s+Ksus=Fswhere Fsis the force vector applied to the micro-structure.Substituting Eq. (17) into Eq. (20) leads to(21)McU¨c+KcUc=Fcwhere Kc, Mcand Fcare the equivalent macrostiffness matrix, mass matrix and external force vector of the multi-node coarse element, respectively. They can be expressed as(22)Kc=NdTKsNdNdTKsNmNmTKsNdNmTKsNm(23)Mc=NdTMsNdNdTMsNmNmTMsNdNmTMsNm(24)Fc=NTFs=NdTNmTFssubstituting Eq. (15) into Eqs. (22) and (23) results to(25)Kc=NdTKsNdNdTKsNmNmTKsNdΛ(26)Mc=NdTMsNdNdTMsNmNmTMsNdIThe dimensions of Ms, Mc, Ks, Kc, Fsand Fcare 2ns×2ns, 2nc×2nc, 2ns×2ns, 2nc×2nc, 2ns×1 and 2nc×1, respectively, where ncand nsare the number of the macronodes of the multi-node coarse element and the number of the micronodes of the micro-structure, respectively. Generally speaking, we have ns>>nc.It should be mentioned that the displacement base function matrix Ndand the mode base function matrix Nmare orthogonal on the overall stiffness matrix Ksof the micro-structure, i.e.NdTKsNm=0andNmTKsNd=0. This orthogonality will be proved as follows.The mode base function matrix Nmis obtained by solving the generalized eigenvalue problems on the micro-structure with fixed boundaries (see Fig. 7). Thus, the values of the mode base function matrix Nmon the boundaries are equal to zero, i.e.(27)Nm=NmiNmb=Nmi0where the superscripts ‘i’ and ‘b’ represent the internal and boundary DOF of the micro-structure, respectively.On the other hand, the displacement base function matrix Ndis calculated by solving the static equilibrium equations on the micro-structure with specific boundary conditions. This is to say that only the boundary tractions are applied to the boundary of the micro-structure and the body forces are not taken into consideration when computing the displacement base functions. Therefore, we have(28)KsNd=R=RiRb=0Rbwhere R is the load matrix which is induced by imposing the specific boundary conditions on the boundaries of the micro-structure.From Eqs. (27) and (28), we have(29)NmTKsNd=(Nmi)T00Rb=0In addition, due to the symmetry of the stiffness matrix, i.e. (Ks)T=Ks, we also haveNdTKsNm=0. Finally, the stiffness matrix Kcof the multi-node coarse element in Eq. (25) becomes(30)Kc=NdTKsNd00ΛThis orthogonality demonstrates that the macroscopic displacement DOF and the mode DOF of the multi-node coarse element are irrelevant and independent of each other for the static analysis. Since the mode base functions are the dynamic effects of the micro-structure, it is not necessary to consider them for the static problems. Thus, only the displacement base functions of the multi-node coarse element are taken into account for the static problems in this paper.Once the equivalent macroscopic matrices and vector of the multi-node coarse element are obtained, the global stiffness matrix, mass matrix and external force vector of the structure at the macroscopic scale can be calculated by assembling, i.e.(31a)KC=Ai=1MCKic(31b)MC=Ai=1MCMic(31c)FC=Ai=1MCFicwhere MCis the number of the multi-node coarse elements;Kic,MicandFicare the stiffness matrix, mass matrix and force vector of the multi-node coarse element i, respectively.After obtaining the global matrices and vector, one can use them to analyze the static problems (see Section ‘Static analysis’), the generalized eigenvalue problems (see Section ‘Generalized eigenvalue analysis’) and the dynamic response problems (see Section ‘Dynamic response analysis’) at the macroscopic scale. Thus the generalized macroquantities Uccan be obtained for each multi-node coarse element. Then, according to the determination of the multiscale base functions in Eq. (17), the microscopic displacement vector usof each micro-structure can be calculated naturally by Eq. (17). The strain and stress of each truss element in each micro-structure can also be obtained easily. The process to obtain the microscopic information from the macroscopic results is regarded as the downscaling technique.For all of the numerical examples in this paper, ‘FEM’ represents the solution on the fine-scale meshes which is obtained by FEM and regarded as the reference solution. ‘EMsn’ denotes the solution computed by the proposed multiscale method without the mode base functions for each multi-node coarse element. ‘EMsn-Hm’ is the solution calculated by the proposed multiscale method with the mode base functions for each multi-node coarse element. In the solutions of ‘EMsn’ and ‘EMsn-Hm’, n and m are the numbers of the macronodes of the coarse element and the modes of the micro-structure, respectively. On the other hand, all of the quantities in this paper are non-dimensional.The relative error of the calculated results is defined as follows(32)Er=Vcal-VrefVref×100%where Vcalis the calculated solution and Vrefrepresents the reference solution.Without considering the mode DOF of each multi-node coarse element, the static equilibrium equations of the structure with the coarse element mesh can be given as(33)KCUC=FCwhere KCand FCare the global stiffness matrix and force vector of the structure with the coarse element mesh (see Eqs. (31a) and (31c)). After solving Eq. (33), the macroscopic displacement UCcan be obtained. Furthermore, the microscopic information can also be calculated by the downscaling technique.In this section, some numerical experiments are implemented to test and verify the effectiveness and efficiency of the proposed multiscale method for the static problems.Example 1For the first example, a lattice truss cantilever with 20×4 micro-structures is considered as shown in Fig. 9. The left edge of the cantilever is fixed in the x and y directions and the right edge is subjected to a surface forceFwith a magnitude of 10,000. Two micro-structures shown in Fig. 10are taken into account. Micro-structures (a) and (b) represent the homogeneous and heterogeneous truss materials, respectively. The geometric sizes of the micro-structures are shown in Fig. 10. The cross-sectional areas, the Young’s moduli and the densities of the truss elements in the two micro-structures are 1.0, 1.0e6 and 1.0, respectively.For the micro-structure (a), the displacements in the y direction of the midline are plotted in Fig. 11, where the relative errors of Point A are 3.0% and 1.5% for EMs4 and EMs12, respectively. In order to investigate the convergence with increasing the number of the macronodes of the multi-node coarse element, the coarse elements with different macronodes are employed here, such as EMs4, EMs8, EMs12, EMs16, EMs24 and EMs32. The relative errors of the displacements in the y direction of Point A are shown in Fig. 12, from which one can see that the errors are gradually reduced and reach a stable value eventually with the increase in the macronodes of the multi-node coarse element. For the micro-structure (b), the similar conclusions can be drawn as shown in Fig. 13, where the relative errors of Point A are 3.5% and 2.1%, respectively. In addition, the comparisons of computational efficiency between FEM and EMsn are listed in Table 1, from which one can see that the proposed multiscale method will take up less computer memory and spend less computing time under the promise of ensuring the calculation accuracy by comparison with the traditional finite element method.Example 2In this example, we will verify the convergence of the same model as described in Example 1 with different micro-structures. Four square micro-structures are taken into consideration here (see Fig. 14). In Fig. 14, the micro-structures are composed ofnsf2elementary cells, where nsfis called the scale factor. The cross-sectional areas, Young’s moduli and densities of the truss elements in the micro-structures are the same with those of Example 1.The displacements in the y direction of the midline of the beam with different scale factor nsfare shown in Figs. 15–18. It is obvious that the maximum relative errors are reduced significantly with increasing the scale factor nsfas shown in Fig. 19. It has been found that the unbalanced nodal forces will be generated at the boundary nodes and this is the main factor causing the errors in the EMsn. This similar phenomenon has also been discussed in Refs. [5,28,31–34], from which one can see that the influence of these unbalanced forces will become smaller with increasing the scale factor. Thus, we will be easy to understand why the maximum relative errors can be improved by increasing the scale factor.The generalized eigenvalue equations of the lattice truss structure with the coarse element mesh can be given as(34)KCUCi=ωi2MCUCiwhere KCand MC, obtained by Eqs. (31a) and (31b), are the global stiffness and mass matrices of the coarse element mesh; ωiandUCiare the ith order circular frequency and generalized eigenvector. After solving Eq. (34), ωiandUCican be obtained, then the downscaling technique can be used to get the microscopic information on the fine element mesh.Example 3A generalized eigenvalue numerical example is investigated here. The structure with 80×5 coarse elements is shown in Fig. 20, where the left edge of this structure is fixed in the two directions. Two kinds of square micro-structures are considered as shown in Fig. 21. The cross-sectional areas, Young’s moduli and densities of the truss elements in the micro-structure (a) are 1.0, 1.0e6 and 1.0, respectively. For the micro-structure (b), the cross-sectional areas are 0.2 and 1.0 for the upright thin black and the diagonal thick red truss elements, respectively. In addition, the Young’s moduli and densities of the truss elements in the micro-structure (b) are also 1.0e6 and 1.0, respectively. Furthermore, the geometric sizes of the micro-structures are also shown in Fig. 21.We investigate the first 200 frequencies of the computational model. In order to more clearly show the calculation relative errors, only the order of the frequency bands 100–200 are displayed here. The comparisons of these frequencies with the micro-structures (a) and (b) are depicted in Figs. 22 and 25, respectively. In addition, the convergences with increasing the number of the macronodes and the number of the retained modes in the mode base functions of the multi-node coarse element are also discussed based on the micro-structure (a) and shown in Figs. 23 and 24. From these figures, it can be found that both the number of the macronodes and the number of the retained modes in the mode base functions have a great influence on the calculation accuracy for the dynamic problems. This also indicates that the computational results can be improved by increasing the macronodes and the retained modes. On the other hand, this also demonstrates that the construction of the multi-node coarse element and adding the mode base functions are meaningful for the dynamic problems. In addition, the comparisons of the computational efficiency of the generalized eigenvalue analysis for the model with micro-structure (a) are listed in Table 2. It is obvious that the computational efficiency of the proposed multiscale method is extremely good.Moreover, the comparisons of the modes of the structure are shown in Fig. 26, from which one can see that the results obtained by the proposed method agree well with the reference solutions. This indicates the validity and effectiveness of the proposed method once again.The dynamic equations without damping of the structure with the coarse element mesh can be presented as(35)MCU¨C(t)+KCUC(t)=FC(t)where t represents the time.The external force vector at the initial momentFC0can be calculated by Eq. (31c). Then the dynamic response equations can be solved by using the numerical integration algorithms. In this paper, the Newmark algorithm is employed. In this algorithm, we have the assumptions during the time t∼Δt as follows, i.e.(36)U̇Ct+Δt=U̇Ct+(1-β)U¨Ct+βU¨Ct+ΔtΔt(37)UCt+Δt=UCt+U̇CtΔt+12-αU¨Ct+αU¨Ct+ΔtΔt2where α and β are the parameters to control the integration accuracy and stability. α=1/4 and β=1/2 are used in this paper.In addition, the initial generalized accelerationU¨C0is calculated by(38)U¨C0=(MC)-1(FC0-KCUC0)whereUC0is the initial known generalized displacement vector.By Eqs. ()()()(36)–(38), the generalized displacement UC(t), velocityU̇C(t)and accelerationU¨C(t)can be solved easily. Afterwards, the corresponding microscopic information on the fine element mesh will be also obtained by using the multiscale base functions, i.e. Eq. (17).Example 4In this example, we will consider the dynamic response problem of the structure as shown in Fig. 27, where the left edge is fixed in the two directions and the right edge is only fixed in the x direction. Two micro-structures in Example 1 (see Fig. 10) are taken into account, but the Young’s moduli of the truss elements in the two micro-structures are different here. They are 1.0e9 and 1.0e7 for micro-structures (a) and (b), respectively. The displacements in the y direction of three representative points are investigated. Point B is the center of the corresponding coarse element. In addition, two loading conditions are considered here, i.e. the impact loading and the sinusoidal loading are applied to the right edge of the structures with micro-structures (a) and (b), respectively. These two loading conditions can be given asFor the structure with micro-structure (a) and the impact loading, the displacement responses in the y direction of Points A, B and C are shown in Figs. 28–30, respectively. By comparing with FEM, we can find that the solutions of FEM, EMs4-H8 and EMs12-H8 are almost exactly the same during the time period 0⩽t<0.025s. In the time period 0.025s⩽t<0.1s, the solutions of FEM and EMs12-H8 are also very similar, while the result of EMs4-H8 has a large difference with the reference solution. This is because higher-order modes almost do not participate in the superposition of the motion of the system during the time interval 0⩽t<0.025s, while in 0.025s⩽t<0.1s the external force becomes zero and the higher-order modes have greater impact on the motion of the system.For the structure with micro-structure (b) and the sinusoidal loading, Figs. 31–33show the displacement responses in the y direction of Points A, B and C, respectively. In this case, higher-order modes have smaller impacts on the movement of the system. Thus, the solution of EMs4-H8 has small difference with the results of FEM and EMs12-H8. In addition, it can be found that increasing the number of the macronodes of the multi-node coarse element can improve the computation accuracy. Besides, the comparison of the computational efficiency are shown in Table 3, from which we can see that the proposed multiscale method has extremely good computational efficiency.

@&#CONCLUSIONS@&#
In this paper, a uniform multiscale computational method is developed for 2D static and dynamic analyses of the lattice truss materials in elasticity based on EMsFEM. To describe the more complex deformations, a kind of multi-node coarse element is proposed in this method. For the dynamic problems, the effects of inertial forces are taken into account and the mode base functions are introduced into the original multiscale base functions. In this context, the new multiscale base functions consist of two parts, i.e. the displacement and mode base functions. At the same time, the new approaches to construct the displacement and mode base functions of the multi-node coarse element are also presented in detail. In addition, the orthogonality of the displacement and mode base functions on the overall stiffness matrix of the micro-structure has also been proved theoretically.Numerical examples in the static analysis show that the number of the macronodes of the multi-node coarse element has a great impact on the computation accuracy and the maximum relative error will be reduced by increasing the scale factor. Numerical experiments in the generalized eigenvalue analysis indicate that both the number of the macronodes and the number of the retained modes in the mode base functions of the multi-node coarse element can affect the computation accuracy greatly. For the dynamic response problems of the system which is greater affected by higher-order modes, the proposed multiscale method can also obtain the solution with high accuracy. Overall, the presented method in this paper can be used to solve the static and dynamic problems of the lattice truss materials uniformly.It should be mentioned that the proposed multiscale method in this paper can also be for the structures with non-periodic micro-structures, for which the multiscale base functions should be constructed once for each micro-structure. Furthermore, parallel computing can also be easily implemented in this method because of the independence between each coarse element.