@&#MAIN-TITLE@&#
Surgical planning for horizontal strabismus using Support Vector Regression

@&#HIGHLIGHTS@&#
This work investigates computational methods for horizontal strabismus surgeries.Our approach used Support Vector Regression to estimate the surgical plan.We used data from the records of 114 patients with horizontal/vertical strabismus.For the medial rectus muscles, the mean error was 0.5mm for recoil and 0.7 for resection.For the lateral rectus muscles, the mean error was 0.6 for recoil and 0.8 for resection.

@&#KEYPHRASES@&#
Surgical planning,Horizontal strabismus,Support Vector Regression,Machine learning,

@&#ABSTRACT@&#
Strabismus is a pathology which affects about 4% of the population, causing esthetic problems (reversible at any age) and irreversible sensory disorders, altering the vision mechanism. Many techniques can be applied to settle the muscular balance, thus eliminating strabismus. However, when the conservative treatment is not enough, the surgical treatment is adopted, applying recoils or resections to the ocular muscles affected. The factors involved in the surgical strategy in cases of strabismus are complex, demanding both theoretical knowledge and experience from the surgeon. So, the present work proposes a methodology based on Support Vector Regression to help the physician with decision related to horizontal strabismus surgeries. The efficiency of the method at the indication of the surgical plan was evaluated through the average difference between the values that it provided and the values indicated by the specialists. In the planning of medial rectus muscles surgeries, the average error was 0.5mm for recoil and 0.7 for resection. For lateral rectus muscles, the mean error was 0.6 for recoil and 0.8 for resection. The results are promising and prove the feasibility of the use of Support Vector Regression in the indication of strabismus surgeries.

@&#INTRODUCTION@&#
Strabismus is an anomaly of the eyes in which the eyes lose alignment with each other. While one of the eyes fixates on a frontal point, the other eye turns either inward or outward, or even upward and downward. In this way, the brain receives two images that have different focuses instead of two images that should merge into a single image. Strabismus appears in various forms: the affected eye can deviate horizontally, either inward (convergent strabismus) or outward (divergent strabismus), and upward or downward (vertical strabismus). The horizontal and vertical deviations can appear to be combined in the same patient, for example, a deviation that is both inward and upward.In general, the esthetic aspect of strabismus can be treated at any time of life. However, sensory disorders are more serious and can only be treated during a short period in life, the plasticity phase of the visual system, which lasts until nine years of age. The main sensory complication of a deviation is strabismic amblyopia. Thus, the treatment must start as soon as a strabismus case with amblyogenic characteristics is detected [1,2].Most cases of strabismus demand surgery when the symptoms are substantial. In most situations, the goal of surgery is solely esthetic; this goal, however, is not less important because the elimination of any physical flaw, especially in the eyes, is directly connected to emotional health. Nevertheless, in many cases, surgery is intended to establish or recover binocular vision,11Binocular vision is the capability of perceiving visual stimuli with both eyes, which enables the perception of the distances of objects.allowing the deviated eye, formerly with amblyopia, to be used with all of its capabilities, including stereopsis22The human capability of perceiving depth and three-dimensional space in the images acquired and processed in the brain.and fusion reflection, which grants stability to the surgical results.The factors that are involved in the planning of the surgical strategy in strabismus cases are complex, which demands both theoretical knowledge and experience from the surgeon [1,2]. Several formulas and tables, which are built with a basis on various cases, supply values for the surgical planning according to the degree of deviation observed [1,2]. The use of formulas and tables has the disadvantage of supplying average values, which are often inappropriate for individual use [2], considering that there is a large variability in the surgical correction obtained in terms of prism diopters33Prism diopters are quantities for the measurement of the diffraction of the light that passes through a prism. A prism diopter is equal to a deviation of one centimeter in a distance of 1m.(Δ) per millimeter of recoil and/or resection [1].The field that is concerned with the use of computational tools to assist or monitor the medical diagnosis of strabismus is still considered to be recent. However, some tools were or have been developed for health professionals in such a way that they can make reliable decisions with respect to pathologies of the eyes.Simons et al. [3] developed a solution that is based on software and hardware to manage the conduct of two clinical tests, namely the covertest and the prism test. The records of eye movements are segmented by the program in the modular test frames to ease the handling and graphical analysis. The eye movement is analyzed with respect to the latency, mean speed, maximum speed, and maximum acceleration/deceleration.The authors in [4] developed a specialized system (StrabNet), which was intended to help in the differential diagnosis of vertical strabismus (deviations upward and downward) by means of artificial neural networks (ANN). Perceptron Backpropagation networks were used to classify the types of vertical strabismus. The magnitude of the deviation was manually supplied by the specialist physician to the neural network and was measured by means of alternating the cover test and prism test. StrabNet achieved a rate of 100% correct diagnosis and>94%using artificial data and 99% using clinical data.In [5], the authors used selective wavelength filters and infrared cameras to measure the binocular alignment. The images of 90 patients were analyzed with the help of 3D Strabimus Photo Analyzer, which resulted in a rate of correct diagnoses of 95%, which was later compared with the alternating cover test and prism test performed by two ophthalmologists.Almedia et al. [6] presents a methodology to aid in the diagnosis of syndromic strabismus using such techniques as image processing, geostatistical functions, and Support Vector Machines for strabismus automatic diagnosis in digital images through the Hirschberg method. Two hundred images that belong to 40 patients who were previously diagnosed by a specialist were tested. The method was demonstrated to be 88% accurate in esotropias identification (ET), 100% for exotropias (XT), 80.33% for hypertropias (HT), and 83.33% for hypotropias (HoT).Almedia et al. [7] proposed a computational method for the automatic detection of strabismus by means of the Hirschberg test. The image database that was used was formed from images of 45 patients without strabismus, with deviations that were smaller than or equal to 15Δ. The images were acquired with patients in the primary gaze position (PGP). Strabismus was detected using the measurement of the deviation in pixels and through the definition of cutoff points or thresholds. To be considered normal, patients should have, at most, 1 pixel for vertical deviations and 2 pixels for horizontal deviations. The method achieved an accuracy of 94% for the classification of individuals with or without strabismus.Looking for computational techniques to assist ophthalmologists at strabismus surgeries, Souza et al. [8] modeled a backpropagation artificial neural network for planning the surgical strategy of patients with a horizontal deviation. The study was conducted with 95 patients, and all of them had an indication of surgery that was restricted to recoil and resection of the horizontal rectus muscle, in only one of the eyes. In the patients with exotropia, the mean error was 0.4mm for the recoil of the lateral rectus muscle and 0.3mm for the recoil of the medial rectus muscle. In the cases of esotropia, the mean error was 0.2mm for the recoil of the medial rectus muscle and 0.5mm for the recoil of the lateral rectus muscle.Backpropagation neural networks were also used by Chandna et al. [9] to make the differential diagnosis44Differential diagnosis occurs when distinguishing between two disorders that look similar.of vertical strabismus (deviations upward and downward). The magnitude of the deviation that was manually supplied by the specialist to the neural network was measured by alternating the cover test and the prism test. The diagnosis achieved an accuracy of 100%.In contrast to the proposal in Souza et al. [8], which plans surgery for one eye only, the present study proposes surgical planning by means of several regressors, which are used to estimate the recoil of the medial rectus muscle (RcMR), resection of the medial rectus muscle (RsMR), recoil of the lateral rectus muscle (RcLR) and resection of the lateral rectus muscle (RsLR), for both eyes. Instead of the neural network proposed by Souza et al. [8], we use the Support Vector Machine for Regression (SVR) [10]. We also use new features in the training and testing of the SVR: values of the versions and deviations in the primary and secondary gaze positions.The remainder of this work is organized in four sections. In Section 2, we present the theoretical background that is needed for understanding this study. Section 4 describes the stages that form the methodology that is used to suggest the surgical planning for horizontal strabismus. In Section 5, we present and discuss the results that are achieved at each stage of the proposed methodology. Finally, Section 6 presents the conclusions, analyzing the efficiency of the techniques used.Many techniques can be used to correct strabismus. These techniques establish the muscular balance and solve the problem of amblyopia. The typical conservative treatment is the prescription of glasses, execution of orthoptic exercises, and obstruction of the fixating eye, alternating with the other eye. When the conservative treatment is not sufficient, the option is the surgical treatment.Surgical intervention is indicated for most cases with deviations above 15Δ, due to the presence of symptoms such as diplopia,55Double vision, which occurs when the image of an object is formed at mismatching points of the two retinas.asthenopia,66Eye fatigue, which occurs when we must fixate at one point within a fixed distance; there is an uncomfortable ocular sensation.ocular torticollis, nystagmus,77Nystagmus consists of rhythmic, repeated and involuntary oscillations of one or both eyes, in some or all of the gaze positions.decreased field of view, stigmatizing esthetic impairment and sensory changes [11].The factors that are involved in the planning of the surgical strategy in strabismus cases are complex, demanding both theoretical knowledge and experience from the surgeon [1,2]. Several formulas and tables, built based on various cases, supply values for the surgical planning according to the degree of deviation observed [1,2]. The use of formulas and tables has the disadvantage of supplying average values, which are often inappropriate for individual use [2], and it is well known that there is a large variability in the surgical correction obtained in terms of prism diopters per millimeter of recoil and/or resection [2].The surgery involves a reduction in the muscular strength, an increase in the muscular tension and realignment of the muscular action. Two basic types of surgical procedures are available: muscular weakening by a reduction in the muscle torque, which can be understood as the capability of converting muscular contractions into rotational movement; and increasing the muscular tension with surgery, through the resection of the muscle.In the first type of surgery, the following procedures can be adopted: recoil of the original position of the muscle, hang-back, and muscular expanders (silicon tape or tendon autograft). In the second type, we have resections of the muscular length, anterior repositioning of the insertion and folding of the muscle tendon. Fig. 1(A) and (B) presents the realization of recoil and resection of the lateral muscles, respectively.As a rule, the following points must be accounted for before deciding to perform surgery on a certain ocular muscle:(a)Every muscle that is too weak or too tense must be included in the surgical plan, for performing a resection (strengthening) or recoil (weakening).When both eyes have good vision, the surgery must be divided between them.If the vision is bad, then the surgery must concentrate, to the extent that is possible, on one of the eyes. This strategy is also valid for exotropia and when the patient has a neuropsychomotor development delay (NPMDL).In planning the surgery, the physician usually analyzes the patient to obtain the following information: age; deviation type88Deviation type: esotropia (ET), exotropia (XT), hypertropia (HT) or hypotropia (HoT).; previous strabismus surgery99The eyes that are to be operated on must be checked to consider the extent of deviation already operated on in the surgery plan.; Visual Acuity (VA)1010This type of exam is important because it allows the surgery to be divided between the two eyes, for the case in which the patient presents good vision.refraction exam1111Refraction exam measures the optical adequacy of the retina with respect to the axial length of the eye, providing the best visual acuity corrected for each patient. This exam also provides information about the spherical equivalent of the patient.; Binocular fixation (BF)1212The binocular fixation exam tells the specialist which of the eyes is the fixating eye. However, in some cases, the patient can fixate with both eyes.; Fundoscopic exam (FOI)1313Fundoscopic exam allows the visualization of the retina and its components: vessels, optical disc and macula. Ocular disorders are commonly found in the fundoscopic exam, including diabetic retinopathy, vascular occlusions, hypertensive retinopathy and horioretinitis lesions.; measurement of the deviation in the primary (PP) and secondary gaze positions of upward gaze (SUPRA), downward gaze (INFRA), right side gaze (DEXTRO), and left side gaze (LEVO), and in the measurement of versions1414Version movements are simultaneous movements of both eyes in the same direction.and ductions.The surgical instrument used by the specialists to measure, in millimeters, the recoil or resection markings is the Castroviejo speculum [12]. It is a type of compass that measures from 0 to 20mm. One of the difficulties reported by the specialists is the lack of precision in the measurements, which is on the order of 0.5mm, because the precision of the instrument is 1mm.The patient can present either primary or secondary deviations.1515Primary strabismus has no apparent cause and is one of the genetic characteristics of each person. Secondary strabismus, however, is the result of another problem, such as severely decreased vision, muscular paralysis, neurological aspects, thyroid disorders, or other factors.In the primary cases, the image is fixated using the normal eye, while in the secondary cases, the fixation occurs through the deviated eye. Magramm and Schlossman [13] studied surgical cases of strabismus in patients above 60 years of age, in the Manhattan Eye Ear & Throat Hospital (USA), between the years of 1981 and 1986. It was verified that from the 106 procedures that were conducted, 74% were related to horizontal deviations, which according to the same authors, present the highest prevalence.Curtis et al. [14] conducted an epidemiological study on strabismus surgeries in Saudi Arabia, between 1982 and 1996, with 4886 patients in a hospital in the city of Riyadh. They found that 96.2% of the patients had horizontal deviations, where 69.3% corresponded to esotropia, and 26.9% were exotropia. In the present work, we studied the surgical planning for cases of horizontal strabismus because they have higher prevalence. It is very rare to have a purely vertical strabismus. To perform the planning, however, we first need to understand the way that a specialist plans surgeries for such deviations.The specialist physician can address horizontal deviations through surgery on up to four muscles, the medial rectus and lateral rectus. A physician rarely chooses to operate on one or four muscles. Normally, two or three muscles are operated on. The same situation occurs in the treatment of exotropia. To decide which muscles should be operated on, the physicians evaluate the versions. For example, a muscle that has a +4 version should probably be weakened by means of a recoil. Another parameter that is evaluated is the extent of the deviation. If the patient has a large deviation(ET≥45Δ), then normally three muscles are operated on. The decision also depends on the experience or the trend followed by the surgeon [15]. The physicians experience is a decisive factor because high variability in apparently similar clinical situations can be observed [2].Some trends prefer to divide the surgery between the two eyes, while others prefer to focus on a few muscles only. The followers of the division trend believe that the division results in slight changes in many of the muscles. Conversely, those who prefer to focus on fewer muscles believe that if there is any chance of the deviation appearing again, it is better to keep some muscles unchanged in case there will be new surgery.To correct primary esotropias, the physician must be aware of the visual acuity (VA) of the patient. If the patient has normal VA, then both eyes should be operated on, in other words, a binocular surgery based on the Parks table [16]. According to the information that is present in that table, a patient who presents an ET of 30Δ must undergo a 4.5-mm double recoil of the medial rectus muscles (RcMR).For patients with abnormal AV, only the eye with the worse vision is operated on; in other words, monocular surgery is performed. Based on the Parks table for monocular surgeries [16], a patient with an ET of 20Δ will pass through a monocular surgery that involves two muscles. In this case, it is possible to apply a 3.5-mm recoil of the medial rectus muscle (RcMR) and a 4.5-mm resection of the lateral rectus muscle (RsLR).After checking the VA, the specialist must check the versions of each ocular muscle. Muscles with the hyperfunction of +2, +3 or +4 must be included in the plan, to be weakened through a recoil according to the Parks table. Nevertheless, in cases of hypofunctions of −2, −3 or −4, the muscle should be strengthened, and thus, the muscle is included in the plan for resection according to the Parks table.In Table 1, we show the possible decisions that the specialist could make during surgical planning for the treatment of esotropia (ET). These decisions involve the extent of the deviation, the number of eyes to be operated on (monocular or binocular) and how often the procedures occur in the workday of the ophthalmologic surgical centers. ET deviations below 25Δ are considered to be small; deviations between 25Δ and 45Δ are said to be medium; from 45Δ to 70Δ are large; and above 70Δ, very large. Large deviations usually require surgery on three muscles. In small deviations, only one muscle is operated on. Conversely, in median deviations, 2 muscles are operated on. The cases with very large deviations require an operation on 4 muscles.For the surgical planning of primary exotropia surgeries (XT), regardless of the visual acuity, recoil and resection of the non-fixating eye (monocular surgery) is applied according to the Parks table [16]. The versions are also changed the same way as in the citations for the correction of esotropias.Based on the Parks Table [16], a patient with XT of 25Δ will undergo a monocular surgery that involves two muscles, for example, a 6-mm recoil of the lateral rectus (RcLR) and a 4-mm resection of the medial rectus (RsMR).Table 2shows the possible decisions that the specialist must make at the moment of surgical planning for the treatment of exotropia (XT).The SVR algorithm is an adaptation of the Support Vector Machine (SVM) classification algorithm. The SVM was improved with the inclusion of the loss function [10], enabling the use of SVM for regression. The loss function can be of the following types: quadratic, Laplace, Huber, ϵ-insensitive and ϵ-Quadratic. The first three usually do not produce sparse support vectors. Thus, Vapnik et al. [17] proposed the ϵ-insensitive functions.Different from the approach used for binary classification problems, to address regression, the SVR forces the samples to be positioned as close as possible to the optimal hyperplane, regardless of the side that the sample is on. Even when distinct optimization purposes are present, for both classification and regression, SVMs have the objective of maximizing the generalization capability. Thus, in regression, the SVR seeks to construct a hyperplane that best fits the given points with the definition of the loss function.The regression function can be calculated by means of the algorithm used by the SVC during the classification. The objective of SVR is to find a function f(x) that returns a maximum deviation value ϵ with respect to the target values. In other words, it looks for a function that has an error margin ofyi−ϵ,yi+ϵ. The loss function ϵ-insensitive introduces non-negative loss variablesξi,ξi⁎, to penalize data that are outside the margin|f(x)−yi|≤ϵ. This approach is described by the following:(1)|ξ|ϵ={0if|ξ|≤ϵ|ξ|−ϵotherwiseFig. 2represents Eq. (1), where the points outside the shaded region contribute to the value of the cost function.Normally, the problems to be solved are found in a non-linear space. Thus, the regression function is defined as follows:(2)f(x)=∑i=1l(αi−αi⁎)K(x,xi)+bwherek(x,xi)=Φ(x).Φ(xi), and the coefficientsαi,αi⁎and b are solutions of the following equations:(3)minw,b,ξ,ξ⁎12‖w‖2+C∑i=1l(ξi+ξi⁎)subject to(4)yi−(w·xi)−b≤ϵ+ξi(w·xi)+b−yi≤ϵ+ξi⁎ξi,ξi⁎≥0,∀i=1…lThis section describes the procedures that were adopted for the computational planning of horizontal strabismus surgeries. First, we present the patient database that was used in the tests. Then, we describe the sequence of stages that were conducted to achieve the objectives of the methodology.After the diagnosis by the specialist physician, the patients with deviations above 15Δ can be treated by surgical procedure. As presented in Section 2, this study addresses the surgical planning for the horizontal deviations. For this reason, we consider only the patients who have esotropia or exotropia.The specialist informs the deviation measured in prism diopters in the primary and secondary gaze positions, the deviation type, the fixating eye, data about the visual acuity, binocular fixation, refraction, versions and fundoscopic exam results. These data are clustered and submitted to the regressors for estimation of the recoil or resection, in millimeters, which must be operated in each lateral/medial muscle of each eye. Fig. 3presents the proposed methodology, which uses multiple regressors to suggest the surgical plan.We used data from the records of 88 patients with horizontal/vertical strabismus, who were submitted to surgical treatment from November 2005 to March 2013. All of the surgical procedures were conducted by the same physician. Because this study is concerned with only the surgical planning for horizontal deviations, we used information about the surgeries on this type of deviation. From the set of patients with horizontal and vertical deviations, we used the data about recoil and/or resection of the lateral/medial rectus muscles. Out of these 88 patients used in the training of the multiple SVR regressors, 53 presented esotropia and 35 presented exotropia (with maximum deviations of 90Δ).We extracted the following features from the records of each patient in order to form the database: binocular fixation, left and right spherical equivalence; deviations in the five diagnostic positions; deviation type, fixating eye, visual acuity and the 12 version measurements of the left and right eyes, which resulted in a total of 23 features, in addition to the information about recoil/resection, in millimeters, applied to each one of the muscles.In the surgical planning of the horizontal deviations, the specialist physician can apply the recoil or resection to each horizontal muscle. Thus, the physician can choose from one to four procedures, which results in eight possibilities: recoil of the medial rectus muscle of the right eye (RcMRR); resection of the medial rectus muscle of the right eye (RsMRR); recoil of the lateral rectus muscle of the right eye (RcLRR); resection of the lateral rectus muscle of the right eye (RsLRR); recoil of the medial rectus muscle of the left eye (RcMRL); resection of the medial rectus muscle of the left eye (RsMRL); recoil of the lateral rectus muscle of the left eye (RcLRL); and resection of the lateral rectus muscle of the left eye (RsLRL). Each one of these possibilities corresponds to a regressor.The prediction of the surgical plan occurs in two stages: training and testing. In the training stage, we create regressors to estimate new data inputs, while in the testing stage, the surgical plan of the new patients is estimated by the multiple regressors created in the training stage.Each dataset used in the training is formed by the 23 features extracted from the patients׳ records, and the value, in millimeters, of the recoil/resection made in the surgical procedure. For example, a surgical plan that foresees the double recoil of 7mm in the medial rectus muscles would be represented byRcMRR=7.0mmandRcMRL=7.0mm. In this example, the other six regressors are created with the features plus the value zero for the recoil/resection. In this way, the method estimates the type (recoil or resection), measurement, muscle (lateral/medial rectus) and eye (left or right) that will be operated on.The features pass through a normalization process, in such a way that they lie in the range of −1 to 1. The final stage consists of estimating the surgical plan for each diagnosis of the patient by means of regression techniques. This stage uses the LIBSVM [18] and WEKA [19] libraries. The SVR regressors that are used are radial basis function kernels (RBF). Three parameters must be set up: C, γ and ϵ. These parameters were estimated with “grid-search” using v-fold cross-validation [18]. In this work, we use v=10 [20]; in other words, the training data are organized into 10 groups. Each experiment was repeated 10 times. We used cross-validation leave-one-out [18] in the elaboration of the training model, to evaluate its discrimination power.The surgical plan is complete with the surgical prediction for the patient. The data coming from the patients׳ records are submitted into the eight regressors that were previously trained. The output of each regressor supplies a value, in millimeters, of the recoil/resection that must be made. Analyzing all of the outputs, it is possible to identify the lateral and medial muscles that should be operated on in each eye.

@&#CONCLUSIONS@&#
