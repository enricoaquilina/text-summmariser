@&#MAIN-TITLE@&#
Evaluation of handwriting kinematics and pressure for differential diagnosis of Parkinson's disease

@&#HIGHLIGHTS@&#
Handwriting movements can be used to assist in the diagnosis of Parkinson's disease.The pressure exerted on the surface during handwriting contributes to the diagnosis of PD.A handwriting database containing samples from 75 PD and healthy subjects is presented.

@&#KEYPHRASES@&#
Decision support system,Support vector machine classifier,Handwriting database,Handwriting pressure,Parkinson's disease,PD dysgraphia,

@&#ABSTRACT@&#
ObjectiveWe present the PaHaW Parkinson's disease handwriting database, consisting of handwriting samples from Parkinson's disease (PD) patients and healthy controls. Our goal is to show that kinematic features and pressure features in handwriting can be used for the differential diagnosis of PD.Methods and materialThe database contains records from 37 PD patients and 38 healthy controls performing eight different handwriting tasks. The tasks include drawing an Archimedean spiral, repetitively writing orthographically simple syllables and words, and writing of a sentence. In addition to the conventional kinematic features related to the dynamics of handwriting, we investigated new pressure features based on the pressure exerted on the writing surface. To discriminate between PD patients and healthy subjects, three different classifiers were compared: K-nearest neighbors (K-NN), ensemble AdaBoost classifier, and support vector machines (SVM).ResultsFor predicting PD based on kinematic and pressure features of handwriting, the best performing model was SVM with classification accuracy of Pacc=81.3% (sensitivity Psen=87.4% and specificity of Pspe=80.9%). When evaluated separately, pressure features proved to be relevant for PD diagnosis, yielding Pacc=82.5% compared to Pacc=75.4% using kinematic features.ConclusionExperimental results showed that an analysis of kinematic and pressure features during handwriting can help assess subtle characteristics of handwriting and discriminate between PD patients and healthy controls.

@&#INTRODUCTION@&#
Parkinson's disease is a complex neurodegenerative disease that affects a large portion of the worldwide population [1]. With current prevalence rates, ranging from 10 to 800 people per 100,000, PD is one of the most common neurodegenerative disorders [2]. PD is a movement disorder characterized by resting tremor, rigidity, slowness of movement (bradykinesia), and loss of postural reflexes. The disturbances of motor control in PD involve processing of motor planning, motor programming, motor sequencing, movement initiation and movement execution [3].There is currently no objective method for diagnosing PD. It can take months to get a reliable PD diagnosis, and symptoms need to be carefully monitored. Even then the probability of an inaccurate diagnosis is approximately 25% [4]. The diagnosis can be confirmed only by a pathological analysis at autopsy; this further highlights the complexity of the diagnosis. Decision support tools for accurate diagnosis would be beneficial for early diagnosis and for the development of treatment strategies for PD patients [5,6]. Identifying biomarkers is an important goal of the research on neurodegenerative diseases [7].One typical hallmark of PD is disruption in the execution of practiced skills such as handwriting [8,9]. People with PD frequently have severe difficulties in coordinating of the components of a motor sequence movement. They tend to perform sequential movements in a more segmented fashion. Hesitations and pauses are often observed between the components of the sequence [10,11]. Continuous handwriting and similar motor tasks occur more slowly than in a healthy person. Some recent studies have suggested that handwriting can be used as a biomarker for diagnosing PD [12,13]. The reasoning behind this suggestion is that handwriting is no longer an automated process for PD patients and their handwriting depends on a visual closed loop [14].Several handwriting tasks were proposed for use in analyzing the handwriting of PD patients and for obtaining insight into the motor disruption caused by PD. Probably the most popular handwriting exercise for tremor assessment is currently the Archimedean spiral. Spiral drawing has been frequently used for evaluating of the motor performance in various movement disorders, including PD [4,8,15–17]. Words containing one or more repetitions of the cursive letter “l” are the second-most common exercises in handwriting assessment [10,18]. In addition to these established tasks, we proposed new ones consisting of writing simple words and short sentences. The words used in these handwriting tasks were selected for their simple orthography and easy syntax.It has been shown that the absolute positioning of the pen during handwriting is relevant for PD diagnosis, as are pen movements above the writing surface (when the pen does not leave the trajectory) [12,13,19]. Pressure exerted on the surface during handwriting plays a significant role too [13].In this paper, we extend our previous work [12,20] by providing a more detailed analysis of the pressure modality of handwriting and by introducing novel pressure features. Moreover, we introduce the Parkinson's disease handwriting (PaHaW) database, which can be used for developing predictive models for PD diagnosis. The PaHaW database contains recorded in-air/on-surface trajectories and pressure, i.e. modalities that have been shown to be significant for PD classification. The results confirmed that handwriting is relevant in diagnosing and monitoring PD. We also compared three frequently used classifiers on the PaHaW database: SVM, Adaboost and K-NN.We believe that the PaHaW database can encourage further research and provide additional information to other available databases related to PD such as Parkinson's disease speech datasets [21,22].In the next section, the database of handwriting samples is introduced and described in detail. Section 3 presents our methods and obtained results. We provide a discussion and conclusions in the last section.We created a handwriting database of 37 PD patients (19 men) and 38 sex- and age-matched healthy controls (20 men). The database was acquired in cooperation with the First Department of Neurology, Masaryk University and St. Anne's University Hospital in Brno, Czech Republic.Subjects were rested and seated in front of the table in comfortable position. Each subject was asked to complete a handwriting task according to the prepared pre-filled template at a comfortable speed. Subjects were allowed to repeat the task in case of some error or mistake during handwriting. The pre-filled template is depicted in Fig. 1[23]. The pre-filled template was shown to the subjects; no restrictions about the number of repetitions of syllables/words in tasks or their height were given.A tablet was overlaid with an empty paper template (containing only printed lines and square box specifying area for Archimedean spiral), and a special ink pen was held in a normal fashion, allowing for immediate full visual feedback. The signals were recorded using the Intuos 4M (Wacom technology) digitizing tablet.Digitized signals were acquired during the movements executed while exerting pressure on the writing surface (on-surface movement) and during the movement above the writing surface (in-air movement). The perpendicular pressure exerted on the tablet surface was also recorded. The recordings started when the pen touched the surface of the digitizer and finished when the task was completed. The tablet captured the following dynamic features (time-sequences): x-coordinate, x[t]; y-coordinate, y[t]; time stamp, s[t]; button status, b[t]; pressure, p[t]; and discrete time t. Button status is a binary variable, being 0 for in-air movement and 1 for on-surface movement.The tablet sampling rate was 100 samples per second; the acquisition software was developed by the research team. Subsequent analysis was performed using Matlab and Python programming language.Altogether, 75 subjects (37 PD patients and 38 healthy controls) participated in the study. The participants were enrolled in the First Department of Neurology, St. Anne's University Hospital in Brno. A complete list of all participants is provided in Appendix A, with information about sex, age, disease duration, UPDRS-part V score11Unified Parkinson's Disease Rating Scale (UPDRS) is a rating scale used to follow the longitudinal course of PD [24].and levodopa equivalent daily dose.22Levodopa equivalent dose (LED) of a drug that produces the same anti-parkinsonian effect as 100mg of immediate-release levodopa.Mean and standard deviation of age, UPDRS-Part V – Modified Hoehn and Yahr staging score [24] and disease duration are summarized in Table 1. No significant differences related to gender or age were found between the PD and healthy control groups.All the subjects had completed at least ten years of education and reported Czech as their native language. All subjects used their dominant right hand. None of the subjects had a history or presence of any psychiatric symptoms or any disease affecting the central nervous system (other than PD in the PD cohort). All PD patients completed the tasks under L-DOPA medication.Prior to handwriting acquisition, each patient was evaluated by a clinical neurologist. The healthy controls were examined by a clinician in order to make sure that there was no movement disorder or injury present that could significantly affect handwriting. We removed subjects whose handwriting was apparently affected by another diseases or who were not in the suitable physical condition. Basic information and instructions regarding the upcoming task were provided for each subject, and they were allowed to practice the task before the recording.The template consisted of eight different handwriting tasks. Based on a survey of the literature, we included drawing of an Archimedean spiral and repetitively writing cursive a letter “l”, or a syllable “le”, respectively.The Archimedean spiral is an established task used in assessing of akinesia in PD and essential tremor [16,18]. During this task, the template was shown to the subject for visual guidance. Subjects drew the spiral from inside to out, but were not asked to draw spiral within particular boundaries or to follow a pre-drawn line.In tasks 2, 3, and 4 participants wrote the cursive letter l, bigram le or the trigram les. Similar tasks (writing the letter l – or its variations) are frequently used for handwriting analysis [10,17].Tasks 5, 6, and 7 were to write words lektorka – female teacher, porovnat – to compare, and nepopadnout – to not catch (written in Czech –, the native language of all participants). These words are characterized by simple orthography and quite easy syntax. The common characteristic is that they can be written continuously, without lifting the pen above the surface, i.e. they can be written in one continuous movement.Task 8 was to write a longer sentence: Tramvaj dnes už nepojede (The tram won’t go today). Use of the whole sentence allowed us to acquire also movements above the writing surface, i.e. in-air movements, during transitions between individual words in the sentence.The handwriting features were computed from on-surface movements (in the form of Cartesian coordinates) and pressure. The kinematic features used in this study are listed in Table 2[12]. The term stroke represents single connected continuous component of trace, i.e. on-surface movement between two successive pen lifts. According to this definition spiral or letter l are usually drawn as one stroke. Strokes were used only to calculate stroke speed.Novel pressure handwriting features were computed to take advantage of all tablet functionalities. The typical pressure profile during writing is depicted in Fig. 2for Archimedean spiral and Fig. 3for tasks 2, 4 and 6.The fundamental pressure features are the value of pressure as captured by the tablet during the particular task and the rate at which pressure changes with respect to time. Similarly to the concept of the number of changes in velocity [25] we proposed a number of changes in pressure (NCP) and relative NCP. Since there can be rapid changes in pressure that lead to incorrect NCP, we smoothed the data using a local regression using weighted linear least squares and a first degree polynomial model33We used Matlab's built-in function smooth.. Relative NCP is NCP normalized by the whole length of writing. We introduced correlation coefficients to capture the relationship between pressure and kinematic features. In particular, we computed correlation between pressure and (horizontal/vertical) velocity/acceleration. Altogether, six correlation coefficients ρ(horizontal/vertical),vel/accwere computed.Figs. 2 and 3 show that the main trend of the typical pressure trajectory starts with a rising edge, continues with a slowly increasing main movement, and finishes with a falling edge. The progress of the main trend is similar for all tasks. On the other hand, there is visible difference in smoothness of the main part of the signal for different tasks. As can be seen from Fig. 3, the main part is relatively smooth for the second task, however, as the performed task become longer the main part is more rough. The exterted pressure varies with the length of the word and complexity of the drawn letter. This may indicate why are some tasks more useful for classification than others.The drawing of the spiral is different from the other tasks used in our study. Handwriting features are generally more stable for writing of the words, whereas, when drawing the spiral features change from beginning to the end of the task. This can be seen in Fig. 2 where the pressure trajectory is continuously increasing. In this study, we focus on the analysis of the handwriting and we did not introduce any spiral specific features. Therefore we extracted the same features from signals from all tasks.We expected that there would be indicators for particular parts of the pressure signal, therefore we calculated the above mentioned pressure features separately for rising edge, main movement, and falling edge. The features corresponding to the different parts of the signal are denoted by superscript rise, main or fall. The boundary between the edges and the main movement is given by a median of signal pressure. Additionally, the range (maximal value–minimal value) between the rising edge and falling edge time duration(Rtimefall/rise)and the range of the rising edge and falling edge pressure(Rpressfall/rise)were included in the analysis. The final included feature was the pressure overshoot, providing the distance between the pressure maximum and pressure median.Additionally, six basic statistical functionals (mean, median, standard deviation, 1st percentile, 99th percentile, 99th percentile−1st percentile) were computed. Features were normalized before classification on a per-feature basis to have a zero mean and a standard deviation of one.Our aim was to build a discriminative model to differentiate between people with PD and healthy subjects. It is a binary classification task that can be resolved by statistical machine learning algorithms.We compared three frequently used machine learning techniques: SVM [26], AdaBoost classifier with a decision tree base estimator [27] and K-NN algorithm. We used Python implementation of scikit-learn library [28].The underlying idea of SVM classifiers is to calculate a maximal margin hyperplane separating two classes of the data. To learn non-linearly separable functions, the data are implicitly mapped to a higher dimensional space by means of a kernel function, where a separating hyperplane is found. New samples are classified according to the side of the hyperplane they belong to. We used radial basis function (RBF) kernel [26]. The RBF kernel is defined as(1)K(x,xi)=e−∥x−xi∥22γ2where γ controls the width of RBF function.The parameters kernel gamma γ and penalty parameter C were optimized using grid search of possible values. Specifically, we searched over the grid (C, γ) defined by the product of the sets C=[2−8, 2−5, …, 27, 28], γ=[2−9, 2−4, …, 28, 29].AdaBoost is one of the important ensemble methods known as boosting. The key idea behind boosting techniques is to use ensemble methods to combine weak classifiers in order to build a strong learner. AdaBoost is an iterative boosting algorithm constructing a strong classifier as a linear combination of weak classifiers, each performing at least above chance level (50% correct classification). We used decision trees classifiers as weak classifiers [29]. The maximum number of estimators at which boosting is terminated was set to 500. Settings used for decision trees were as follows. The number of features to consider when looking for the best split was the square root of the number of features and the maximum depth of the tree was set to 3.In the K-NN algorithm, k-the nearest samples in a reference set are found, by taking a majority vote among the classes of these k samples. The goal is to determine the true class of an undefined test pattern by finding the nearest neighbors within a hyper-sphere of predefined radius. For the K-NN classifier, the best results were obtained with k=3.Classifier validation was conducted using stratified 10-fold cross-validation. The data was divided into ten mutually exclusive and exhaustive equal-sized subsets. For each subset, the union of all other subsets was considered as training data and the error rate was determined. Errors over different subsets were averaged to obtain the classification error. The process was repeated a total of ten times; the original dataset was randomly permuted in each repetition prior to splitting into training and testing subsets. The results were averaged over all ten runs.The classification test performance was determined by the classification accuracy Pacc, sensitivity Psenand specificity Pspe[30].From all computed features we kept only those that passed the Mann–Whitney U test, i.e. those that showed a statistically significant (p<0.05) difference between the PD and control groups. Table 3shows 20 most relevant features and median of their values for PD and healthy control group. Features are sorted according Spearman's correlation coefficient ρ.At first, we evaluated the prediction potential of different handwriting tasks considering both conventional kinematic features and pressure features. The classification accuracies for all tasks are depicted in Table 4. We did not find any statistically significant kinematic features for the tasks 1 and 4; therefore, for these two tasks we considered only pressure features. The highest classification accuracy using pressure features Pacc=74.2% was obtained for data from the task 6. The slightly lower classification accuracy of 73.2% was achieved for the task 8. The best results for kinematic features were provided by data from the task 8. Similarly, task 8 was the most discriminative for merged kinematic and pressure features. Both modalities, i.e. pressure and kinematic features showed relatively similar classification accuracies for all tasks. Interestingly, the fusion of pressure and kinematic features33Only tasks 2–8 were merged. Task 1 contained data from only 69 subjects and did not show any significant discrimination potential, therefore we did not include this task.did not result in any improvement in terms of classification accuracy. The only exception was the most predictive task 8.Merging all of the tasks together noticeably improved the classification accuracy, probably due to the different nature of the handwriting tasks. The results presented in Table 4 were obtained using an SVM classifier. To obtain more confidence in our results and to compare different classifiers we also employed the AdaBoost classifier and K-NN classifier. Overall classification accuracy (Pacc), sensitivity (Psen), and specificity (Pspe) for all tasks and merged kinematic and pressure features are provided in Table 5. Comparing all three classifiers, it is clear that the best results in terms of accuracy, specificity, and sensitivity were obtained using the SVM classifier.

@&#CONCLUSIONS@&#
