@&#MAIN-TITLE@&#
Bunkering decisions for a shipping liner in an uncertain environment with service contract

@&#HIGHLIGHTS@&#
We model total operating cost for an ocean liner with service contracts.A dynamic programming model is formulated to minimize the total operating cost.Gradient of the cost-to-go function is estimated by Monte Carlo simulation.

@&#KEYPHRASES@&#
Bunkering,Fuel price,Service contract,Liner shipping,Dynamic programming,

@&#ABSTRACT@&#
As bunker fuel cost constitutes a major portion of the shipping liners’ operating cost, it is imperative for them to minimize the bunkering cost to remain competitive. Service contract with a fuel supplier is a strategy they venture on to reduce this cost. Typically, liner operators enter into a contract with fuel suppliers where the contract is specified by a fixed fuel price and amount, to mitigate the fluctuating spot prices and uncertain fuel consumption between the ports. In this paper, we study such bunkering service contracts with known parameters and determine the liner's optimal bunkering strategy. We propose to use bunker up to level policy for refueling, where the up to level is dynamic based on the observed spot price and determine the bunkering decisions (where to bunker and how much to bunker) at the ports. A dynamic programming model is formulated to minimize the total bunkering cost. Due to the inherent complexity in determining the gradient of the cost-to-go function, we estimate it by Monte Carlo simulation. Numerical experiments suggest that all the contract parameters must be considered together in determination of the optimal bunkering strategy. Contracting an amount lesser than the average consumption for the entire voyage, at a contract price lesser than the average spot price is found to be beneficial. The insights derived from this study can be helpful in designing these types of service contracts.

@&#INTRODUCTION@&#
As ocean shipping is relatively cheaper compared to the other modes of shipping like air freight, the seaborne trade has increased by 67 percent in terms of weight since 1980 (Christiansen, 2007). The demand for liner shipping service has increased significantly during recent decades. The liners generally follow the same cyclical route comprised of a fixed number of ports. With the global macro environment becoming increasingly more challenging for consumer-related industries and the expansion of the super post-panamax fleets, shipping liners need to be more cost-effective and efficient in order to maintain their competitive advantage. To be cost-effective they need to reduce the total cost of operations. Since bunkering fuel cost constitutes about three quarters of the operational cost of a container ship (Ronen, 2011), reducing the total bunkering fuel cost can bring in substantial cost saving. The price of bunkering fuel remains uncertain as the price of crude oil fluctuates. Fig. 1 shows the bunker fuel price (IFO380) at four different ports – Fujairah, Houston, Rotterdam and Singapore from January 2013 to November 2013. The general trend for bunker fuel price is fluctuating and uncertain. The fuel price can vary significantly at different ports, even on the same day. During this period, the price was lowest at Rotterdam from January to June, but jumped to the highest in August, again falling back to the lowest from September to November.As fuel consumption largely depends on the cruising speed (Ronen, 1982, 2011), operators sometimes use slow steaming techniques to reduce the cost; but slow steaming increases the total travelling time and can hamper the schedule of the liner service. Speed selection is, thus, very important and needs to be decided based on the objective of the operator. The operator also needs to decide where to bunker and how much to bunker as prices vary dramatically at different ports. Service contract with a bunkering fuel supplier can be a strategy to reduce the fuel cost under these uncertain conditions. Service contracts are, generally, specified by the price, quantity and port of bunkering. Contracts help in reducing both the price risk (volatility of spot prices) as well as the supply risk. By entering into a contract, the liner gets guaranteed supply of fuel and also gets a discount on price by leveraging on the large quantity committed (Plun, Jensen, & Pisinger, 2014). Since contracts are designed for a longer time period, these parameters should be decided beforehand. In marine industry, there are several types of service contracts available (BP Marine, 2012). The most common type of contract specifies the total amount of fuel to be refilled during a certain period of time from the supplier at a pre-determined fixed price. Sometimes, the price of the fuel is not fixed in advance; but may fluctuate within a range that is agreed upon by the supplier and the liner operator. Typically, when the total amount of fuel required exceeds the contracted amount, the liner has to buy the extra amount at spot price, though the supply of the extra amount is not guaranteed, whereas a service contract ensures guaranteed supply of contracted amount of fuel. If the liner does not fulfill its commitment of buying the contracted amount of fuel from the supplier within the stipulated period, it has to pay damage charges on the unconsumed amount to the supplier. These types of contracts are also found in airline industry (e.g. AVCARD contract fuel program). Therefore, it is important to study marine service contracts and understand their role in designing an effective bunkering strategy. In this paper, we model service contracts with known parameters and determine bunkering decisions, i.e. the ports to bunker and bunkering quantities at each port, which minimize the total bunkering cost. The study also helps to understand the impact of the contract parameters on the bunkering decisions and the total bunkering cost. The insights from this study can be quite useful in designing a service contract but that is outside the scope of this study.Researchers have shown immense interest in maritime transportation during the recent decades as the importance of ocean shipping has increased many folds. The initial work in the area of tanker routing and scheduling was by Flood (1954). Later Jameson (2008) and Christiansen, Fagerholt, and Ronen (2004) also considered ship routing and scheduling. Ronen (1983) provided a review of literatures related to ship routing and scheduling problems. Later Ronen (1993) also reviewed the available literature on ship scheduling and routing during the last decade. It was found that ship routing and scheduling problems have become increasing relevant and important for the ship operators. However, Christiansen, Fagerholt, Nygreen, and Ronen (2007) found out that relatively little research has been done regarding optimizing the ship speed and bunkering cost. A string of papers appeared following the oil crisis in 1970s for optimizing ship speed and routing decisions. Ronen (1982) analyzed three closed-form analytical models to determine the optimal speed of a single vessel with a single engine operating under different types of legs, namely income generating, positioning and mixed. As this work focused mainly on trampers and industrial shipping, it did not consider service frequency. Subsequently, Brown, Graves, and Ronen (1987) presented a model to optimize the fuel consumption of ship with multiple engines. Perakis and Papdakis (1987a) proposed a non-linear optimization model to explicitly determine the fleet deployment and associated speed with the objective of minimizing the total fleet cost including the lay-up costs for the unutilized ships. Perakis and Papdakis (1987b) extended this model to incorporate uncertain cost components. Notteboom and Vernimmen (2009) presented a descriptive model to determine the bunker fuel costs at various speeds for different ship sizes on the Europe-Far East route.Recently, Fagerholt, Laporte, and Norstad (2010) considered bunker fuel optimization problem for a fixed given route with discrete arrival time and determined the ship speed by shortest path method. Ronen (2011) studied the effect of fuel price on containership speed and fleet size. He developed a cost model to analyze the trade-off between speed reduction and increasing the fleet size. Yao, Ng, and Lee (2012) developed an empirical formula to express the relationship between ship speed and fuel consumption and developed an optimization model to minimize the bunker fuel cost for deterministic fuel prices.The bunkering problem we study here can also be viewed as an inventory management problem. The fuel consumption between two ports resembles the demand for the fuel and refueling decision can be treated as the ordering decisions to the suppliers. If the fuel is not sufficient to cover the fuel consumption to the next port, a huge penalty cost is imposed, similar to the lost sale cost in inventory management problem. The up to level for the bunkering problem is dynamic and dependent on the cost of the product (fuel). We now discuss the literature related to inventory management which is relevant to our problem. Kalymon (1971) extended the classical inventory problem by allowing product prices to follow a Markov process. Song and Zipkin (1993) considered an infinite-time inventory model where demand rate varies with an underlying ‘state-of-the-world’ variable. ‘State-of-the-world’ defines that if the world is in state i, the demand follows Poisson process with rate λi. The fuel price model considered in our research is based on the work by Hamilton (1989). He presented a tractable approach to model ‘regime’ changes in a Markovian setting. Besbes and Savin (2009) used this approach to develop the fuel price model. They presented a profit maximization problem for routing and refueling decisions for tramper and liner services. Neel and Gooding (1997) discussed the impact of service contracts and price discount within the shipping liner conferences, but did not consider contract with fuel suppliers. Though service contracts are relevant in today's shipping industry and many oil companies, like BP, are offering service contracts to the liners; it has never been considered by the researcher in maritime transportation.The rest of the paper is organized as follows: Section 2 describes the bunkering fuel management problem with service contracts and the objectives of the study as well as the assumptions made. Section 3 develops a dynamic programming model for the total bunkering cost. Section 4 provides the solution of the dynamic programming model. Numerical results are presented in Section 5 and finally Section 6 discusses conclusions and possible extensions.We consider a bunker fuel cost optimization problem where the operator of the liner has a service contract with a supplier for a fixed amount of fuel at a pre-determined fixed price. The supplier has refueling stations at several ports of call and the liner can refuel at any of these stations at the same fixed price. The spot fuel price at a port is not known in advance and the fuel consumption between two ports is also not fixed and depends on several factors like weather, route etc. We use a bunker up to level policy (or base stock policy) for refueling i.e. the liner bunkers (refuels) an amount to raise the fuel inventory to the bunker up to level (or base stock level), irrespective of the current inventory. After consuming the entire contracted amount, the liner can buy any extra amount at the spot price prevailing at that port. The liner also has the option of not using its contract and refuels at the spot price. But if the liner does not fulfill its commitment and consumes less than the committed amount, it has to pay a damage charge to the supplier for unconsumed amount. These types of contracts are often found in the marine fuel industry (e.g. BP Marine, 2012). The damage charge is imposed on the unconsumed amount at a fixed rate, and is specified in the contract. This rate is, sometimes, calculated as a multiple of the fixed contract price. This damage charge forces the operator to fulfill its commitment of refueling the agreed amount. Without this charge, the service contract would be more advantageous to the operator as it would not have any compulsion to execute the contract and would buy fuel from the market if spot price is less than the contract price. Therefore, when spot price is low, the operator has to take a call whether to forgo the contract and incur damage cost or to take advantage of the lower spot price.We assume that the service route and the number of ports of call of the liner as well as the ports with contracted supplier's service stations are known. The fuel consumption between two ports is uncertain and depends on sea conditions and/or the route. To capture this uncertainty of fuel consumption, we assume that it follows a probability distribution with known parameters. Ronen (2011) and other researchers have shown that the fuel consumption is dependent on the ship speed but ignores the random component which is dependent on the route of travel. We, therefore, consider that the mean fuel consumption is dependent on the speed of the ship and assume that the random fluctuation follows some General distribution.The bunkering management strategy involves deciding where to bunker and how much to bunker and minimize the cost of doing so. As the fuel price is uncertain, the liner has to decide whether to fulfill the commitment of the service contract or pay the damage charges. In addition, as the fuel consumption is random, it may happen that the ship runs out of fuel midway through its journey. In that case, special arrangements have to be made to supply fuel to the liner in mid-sea. Feeder services can be used for this purpose, but as this service is very expensive, ships always try to avoid this situation. In the model, we assign a large penalty cost for running out of fuel midway between two ports. Other than the fuel cost, there are other costs that the liner service incurs, e.g. capital cost, port usage charge, operating cost etc. As these costs are not dependent on bunkering decisions and remain constant, they are not included in the model. The objective of this study is to minimize the total bunkering cost, consisting of fuel cost (including refueling at contract price as well as at spot price), penalty cost of running out of fuel and damage cost for not fulfilling the committed amount, and determine the optimal bunkering parameters, when the liner follows order-up-to policy. The notations used are shown in Table 1.The following assumptions apply•The liner visits n ports, A = {1, 2, …, n}.The liner has a fuel contract with a supplier for refueling C units per year with a fixed price of pc.The contracted supplier has service stations at ports n1, n2, …, nm, Ac = {n1, n2, …, nm}, m ≤ n.When speed ship is known, the fuel consumption between two ports follows a General distribution with known parameters mean, μiand variance σi2∀i=1,n. The randomness (parameters of the distribution) of the fuel consumption changes with the ship speed.If the liner runs out of fuel during its travel, it incurs a very large penalty cost of π per unit of fuel required to reach the next port.The liner has to pay a damage charge to the supplier, based on the unconsumed amount and the cost is imposed only at the last port. If the total amount of fuel consumed from the supplier at the end of the contract is q, then the damage charge would be dc*pc*(C − q), where dcis a positive real number, termed as damage cost multiplier.The cost model considers only one single voyage or loop i.e. travel starting from port 1 and then traveling to port 2 and finishing at port 1. The model can be easily extended for multiple numbers of voyages by running repetitively (Section 2.1).We assume that each voyage starts with initial fuel inventory I0.We assume that the price of fuel at any port i, pican only take L possible values{p1,p2,…,pL}and is denoted by Pi. We also assume that any price state follows a Markov process and can be reached from any other price state with a positive probability. This is similar to the assumption made by Besbes and Savin (2009).In the work of Besbes and Savin (2009), they found that the liner's optimal refueling policy has an order-up-to level form, and so in this paper we consider an order-up-to level policy for refueling.Typically, a service contract lasts for one year and there is more than one voyage for the ship or for the operator with a fleet of ships. The single voyage model can be easily extended for multiple numbers of voyages by running the model repetitively. For a single voyage problem, I0 would be zero, but when multiple voyages are considered, I0 for each voyage would be equal to the ending inventory for the last voyage. Similarly, the contract amount at the start of a voyage is equal to the contract amount left after refueling (using the contract) during the last voyage. This can be modelled as follows: if CAbe the annual contract and there are t number of voyages in a year with n ports of call, the bunkering decisions at each port during a voyage can be determined by solving the model for n*t number of ports and making C = CAand I0 = 0 (assuming the ship starts with zero inventory) where porti≡port(i+n)≡⋯≡port(i+(t−1)*n).To determine the optimal parameters of the bunker up to level policy (Si) which minimize the total bunkering cost incurred by the liner during a voyage, we develop a dynamic programming model. The bunker up to level at port i, Si, is dynamic in nature as the cost incurred at that port depends on the spot price at ith port as well as the unconsumed contracted amount with which the liner enters the port. The model considers only a single voyage (or loop) of the service, but it can be easily extended to a multiple voyage problem as discussed in Section 2.1. When a liner arrives at a port, it incurs the bunkering cost (if it refuels) and a penalty cost if it runs out of fuel while traveling to the next port. If there is any contracted amount left unconsumed after bunkering at the last port, a damage cost is also charged at the last port. Suppose, Ji(⋅) denotes the optimal total cost incurred between port i to the last port n (both inclusive). When a liner arrives at port i with a fuel inventory of Ii, remaining contract amount ofqicand observes a spot pricepij, the Bellman equation for total cost can be expressed as(1)Ji(Ii,pij,qic.Si,Fi)=minSi{gi(Ii,pij,qic,Si,Fi)+EFi+1,Pi+1∣pij[Ji+1(Ii+1,Pi+1,qi+1c,Si+1,Fi+1)]}where(2)Ii+1=[Si−Fi]+and(3)qi+1c={[qic−(Si−Ii)]+ifrefuelsatpcqicifrefuelsatpijJi(⋅) is a function defined on the state space of the problem. gi(⋅) denotes the cost incurred only at port i and the joint expectationEFi+1,Pi+1|pij, is calculated with respect to Pi+1(vector of price states at port i + 1) taken conditional to present price realizationpijand future fuel consumption, Fi+1. The second term in Eq. (1) is called cost-to-go function. As n is the last port, there would be no cost-to-go function for this port and Jn(.) can be expressed as(4)Jn(In,pnj,qnc,Sn,Fn)=minSn{gn(In,pnj,qnc,Sn,Fn)}The cost functions gi(⋅) and thus Ji(⋅) are dependent on whether port i is under contract i.e. i ∈ Acor not. If i∉Ac, then the liner does not have any option but to refuel at spot price if required. But when i ∈ Ac, the liner has to decide whether to use contract price or spot price.Wheni∈AcThe liner has two options for refueling.(1)Use the contract: it can use the contract provided the contracted amount left is sufficient to fulfill its requirement. If it is not sufficient, it has to buy the extra amount at spot price and the gi( · ) is given by(5)gi(Ii,pij,qic,Si,Fi)={pcqic+pij(Si−Ii−qic)+πEFi>Si(Fi−Si)ifqic≤Si−Iipc(Si−Ii)+πEFi>Si(Fi−Si)otherwiseThe cost involves refueling cost plus the penalty cost of running out of fuel. As the fuel consumption to the next port is not known in advance, we calculate the expected shortage of fuel to determine the penalty cost.(2)Use spot price: the liner decides to refuel at spot price and does not use the contract. The cost, gi( · ) is given by(6)gi(Ii,pij,qic,Si,Fi)=pij(Si−Ii)+πEFi>Si(Fi−Si)Wheni∉AcThe liner can only buy the fuel at the spot price and the contracted amount is carried over to the next port. Like Eq. (6), gi( · ) is given by(6a)gi(Ii,pij,qic,Si,Fi)=pij(Si−Ii)+πEFi>Si(Fi−Si)The cost incurred at the last i.e. nth port is bit different from the other ports as damage cost is imposed only at the last port.Whenn∈AcLike before, the liner can avail the contract or can use the spot price(1)Use the contract: gi( · ) is the aggregate of fuel cost, penalty cost and damage cost. If the contracted amount is not enough to refuel up-to level (i.e.qnc≤Sn−In), it has to refuel the extra amount at spot price, but in this case there would not be any damage charges as the liner fulfills its commitment. But when there is still some contract amount left after the refueling i.e. whenqnc>Sn−In, the liner has to pay damage charges at the rate of dc*pcfor the unutilized amount. The gi( · ) can be calculated as(7)gn(In,pnj,qnc,Sn,Fn)={pcqnc+pnj(Sn−In−qnc)+πEFn>Sn(Fn−Sn)ifIn+qnc≤Snpc(Sn−In)+dcpc(qnc−(Sn−In))+πEFn>Sn(Fn−Sn)otherwiseUse spot price: the liner decides to refuel at spot price. It does not use the contract and incurs damage cost for the remaining contracted amount. The cost, gi( · ) is given by(8)gn(In,pnj,qnc,Sn,Fn)=pnj(Sn−In)+dcpcqnc+πEFn>Sn(Fn−Sn)Whenn∉AcThe liner has to refuel a spot price and incur damage cost for the remaining contracted amount.gi( · ) value is same as the last case(8a)gn(In,pnj,qnc,Sn,Fn)=pnj(Sn−In)+dcpcqnc+πEFn>Sn(Fn−Sn)To design an optimal bunkering policy, we need to determine the order-up-to level, Siwhich minimizes the total cost incurred at each port i, as given in Eq. (1). The optimal Si*can be determined by KKT condition given by(9)∂Ji(Ii,Pi,qic,Si,Fi)∂Si|Si=Si*=0The optimal bunker up to level for the last port,Sn*can be derived straightforwardly as the Ji(⋅) does not involve any cost-to-go function and can easily be differentiated. But for (n − 1)th port and other ports, Ji(⋅) involves gi(⋅) function as well as cost-to-go function and optimal Si*is computed by Eq. (10).(10)|∂gi(Ii,pij,qic,Si,Fi)∂Si+∂EFi+1,Pi+1|pij{Ji+1(Ii+1,Pi+1,qi+1c,Si+1,Fi+1)}∂Si|Si=Si*=0wherei=1,2,…,n−1As the number of possible states are numerous and no closed form is possible, it is impossible to determine the second term in the above equation, not even for the (n − 1)th port (when there is only one port to go). Therefore, we need to settle for suboptimal schemes which are easier to compute and also provide adequate performance. For this, we will estimate the gradient of the cost-to-go function to determine an approximate optimal solution for the problem. The method of gradient estimation is provided in Section 4.2.Sn*can easily be solved by equating(11)∂gn(In,pnj,qnc,Sn,Fn)∂Sn|Sn=Sn*=0The cost incurred at the last port depends on the fuel inventory and commitment when the ship enters the port, as shown by Eqs. (7) and (8). Since the inventory and commitment depend on the bunkering decisions at the previous ports; bunkering decision at the last port also depend on them. Now, using Eq. (7) in Eq. (11), we can determine theSn*when port n ∈ Acand the liner decides to exercise its contract at the port (option 1)(12)⇒Sn*(pnj)=CDF−1(π−pnjπ,μn,σn)ifqnc≤Sn−In(13)⇒Sn*(pnj)=CDF−1(π+(dc−1)pcπ,μn,σn)otherwisewhere fuel consumption Fnfollows a General distribution with parameters μnand σnand CDF(x,μn, σn) is the cumulative distribution function and CDF−1(x,μn, σn) is the inverse of CDF(x,μn, σn).Similarly using Eq. (8) in Eq. (11), we can determine theSn*when port n∉Acor n ∈ Acbut the liner decides not to exercise its contract and refuels at the availing spot price (option 2)(14)Sn*(pnj)=CDF−1(π−pnjπ,μn,σn)As the gradient of the cost-to-go function cannot be determined easily, we have to estimate the gradient. Let us denote the gradient of the cost-to-go function for a given price statepij(j = 1, 2,…, L), initial state(Ii,qic), Siand Fiat port i as(15)∂EFi+1,Pi+1|pij{Ji+1(Ii+1,Pi+1,qi+1c,Si+1,Fi+1)}∂Si=λi(Ii,pij,qic,Si,Fi)where Ii+1andqi+1care given by Eqs. (2) and (3). The value ofEFi+1,Pi+1|pij{Ji+1(Ii+1,Pi+1,qi+1c,Si+1,Fi+1)}depends on Ii+1andqi+1cwhich in turn depend on Siand Fi. AsJi+1cannot be expressed in a closed form, we need to estimate it by Monte Carlo simulation. It must be mentioned that we are only interested in the value of λi(⋅) at a given value of Siand therefore we will approximate λi(⋅) only at the point of interest Si. We estimate it by the following procedure.Step 1:Generate N sets of samples for fuel consumption at each port, Fi, based on the given probability distribution with parametersμiandσi. The kth sample is expressed as(F1kF2k⋯Fn−1kFnk).Compute the sample gradient for the cost-to-go function for kth sample, k = 1 to N. The sample gradient for the kth sample is denoted byλik(⋅) (Section 4.2.1).The gradient, λi(⋅) can then be approximated as(16)λi(Ii,pij,qic,Si,Fi)≈1N∑k=1Nλik(Ii,pij,qic,Si)As the above gradient is dependent on Si, we need to devise an iterative algorithm to determine the optimal Si. We describe this algorithm in detail in Section 4.3.In the next section, we present the approach to compute the sample gradient.The computation of Step 2 is as follows: letACik*(Ii,pil,qic,Si*(pil),Fik)be the optimal value ofgi(Ii,pij,qic,Si,Fi)for the kth sample (i.e. known realization of Fi’s) with initial inventory, Ii, realized fuel price,pil, committed amount left,qic, order-up-to level SiBy definition (Eq. (15)), the sample gradient is given by(17)λik(Ii,pij,qic,Si)=∂∂Si{EPi+1|pij{Ji+1k(Ii+1,Pi+1,qi+1c,Si+1)}}Note that for a sample, the fuel consumption realizations are known, the expectation of the cost-to-go function is only over the price states. The above expectation calculated based on the available future price states conditional to the present price statepij, as shown next.As the probability of reaching price statepi+1l(l = 1, 2, …, L) at (i + 1)th port from price realizationpilat port i is denoted by prj,l, expectation can be rewritten as∑l=1Lprj,l{ACi+1k*(Ii+1,pi+1l,qi+1c,Si+1*(pi+1l))+EPi+2|pi+1lJi+2k(Ii+2,Pi+2,qi+2c,Si+2)}and the sample gradient becomes(18)λik(Ii,pij,qic,Si)≈∂∂Si{∑l=1Lprj,l{ACi+1k*(Ii+1,pi+1l,qi+1c,Si+1*(pi+1l))+EPi+2|pi+1lJi+2k(Ii+2,Pi+2,qi+2c,Si+2)}}Similarly, the termEPi+2|pi+1lJi+2k(Ii+2,Pi+2,qi+2c,Si+2,Fi+2)can be expressed as∑m=1Lprl,m{ACi+2k*(Ii+2,pi+2m,qi+2c,Si+2*(pi+2m))+EPi+3|pi+2mJi+3k(Ii+3,Pi+3,qi+3c,Si+3)}and the sample gradient becomes(19)λik(Ii,pij,qic,Si)=∂∂Si×{∑l=1Lprj,l{ACi+1k*(Ii+1,pi+1l,qi+1c,Si+1*(pi+1l))+∑m=1Lprl,m{ACi+2k*(Ii+2,pi+2m,qi+2c,Si+2*(pi+2m))+EPi+3|pi+2mJi+3k(Ii+3,Pi+3,qi+3c,Si+3)}}}andIi+1=[Si−Fik]+∀i=1,2,…,n−1qi+1c={[qic−(Si−Ii)]+ifi∈Acqicifi∉AcUsing the value of the sample gradient given by Eq. (19) in Eq. (16), we can determine the gradient for a price statepijand initial inventory, Iiand commitment left,qicfor ith port and a given Si.Now, the sample gradient for (n − 1)th port for realized fuel pricepij(j = 1, 2, …, L) can be calculated by Eq. (19) and is given by(20)λn−1k(In−1,pn−1j,qn−1c,Sn−1)≈∂∂Sn−1{∑l=1Lprj,l{ACnk*(In,pnl,qnc,Sn*(pnl))}}The minimum cost at the last port for the kth sample,ACnk*(In,pnl,qnc,Sn*(pnl))is the cost obtained by the optimal Snand is given by(21)ACnk*(In,pnl,qnc,Sn*(pnl))=gnk(In,pnl,qn,Sn*(pnl),Fnk)Using Eq. (21) into Eq. (20), we get(22)λn−1k(In−1,pn−1j,qn−1c,Sn−1)=∂∂Sn−1{∑l=1Lprj,l*gnk(In,pnl,qn,Sn*(pnl))}=∑l=1Lprj,l∂gnk(In,pnl,qn,Sn*(pnl))∂Sn−1Inandqncas well gn(⋅) can be calculated using Eqs. (2)–(9) depending on bunkering by contract price or spot price at port n and port (n − 1). Using the value of the sample gradient for given price state pjand Sn−1, initial stateIn−1andqn−1c, we can calculate the optimal order-up-to-level for port (n − 1),Sn−1*by the iterative algorithm discussed later. The iterative algorithm uses the following Sn−1 value as the starting value ofSn−1*(Sn−10) which is calculated as follows:|∂gn−1(In−1,pn−1j,qn−1c,Fn−1)∂Sn−1|Sn−1=Sn−1*=0when port (n − 1) ∈ Acand exercise its contract (option 1)⇒Sn−10(pn−1j)={CDF−1(π−pn−1jπ,μn−1,σn−1)ifqn−1c>Sn−1−In−1CDF−1(π−pcπ,μn−1,σn−1)otherwisewhen port (n − 1) ∉ Acor n − 1 ∈ Acbut avail the spot price (option 2)⇒Sn−10(pn−1j)={CDF−1(π−pn−1jπ,μn−1,σn−1)The sample gradient for the (n − 2)th port can be determined as follows:(23)λn−2k(In−2,pn−2j,qn−2c,Sn−2)=∂∂Sn−2{∑l=1Lprj,l{ACn−1k*(In−1,pn−11l,qn−1c,Sn−1*(pn−1l))+∑m=1Lprl,m{ACnk*(In,pnm,qnc,Sn*(pnm))}}}=∑l=1Lprj,l{∂ACn−1k*(·)∂Sn−2+∑m=1Lprl,m∂ACnk*(·)∂Sn−2}=∑l=1Lprj,l{∂ACn−1k*(·)∂Sn−2+∑m=1Lprl,m∂ACnk*(·)∂Sn−1*×∂Sn−1*∂Sn−2}The optimal order-up-level for any port depends only on the next ports but does not depend on the preceding ports and so∂Sn−1*∂Sn−2=0. Eq. (23) becomes(24)λn−2k(In−2,pn−2j,qn−2c,Sn−2)=∑l=1Lprj,l{∂ACn−1k*(·)∂Sn−2}The value of∂ACn−1k*(·)∂Sn−2depends on the initial inventory level,In−2and commitment remaining,qn−2cat port n − 2. It also depends on whether (n − 2)th port uses spot price or contract price. The sample gradient can be calculated using the same iterative algorithm as the (n − 1)th port. After calculating the sample gradient at point Sifor initial states and a given price state we can determine the order-to-to level for the ith port.The sample gradient for the other ports can be determined as follows:λik(Ii,pij,qic,Si)=∂∂Si×{∑l=1Lprj,l{ACi+1k*(Ii+1,pi+1l,qi+1c,Si+1*(pi+1l))+∑m=1Lprl,m{ACi+2k*(Ii+2,pi+2m,qi+2c,Si+2*(pi+2m))+EPi+3|pi+2mJi+3(Ii+3,Pi+3,qi+3c,Si+3)}}}The optimal order-up-level for (i + 1)th port depends only on the next ports but does not depend on the preceding port and so∂Si+1*∂Si=0. Proceeding as before we get(25)λik(Ii,qic,Si)=∂ACi+1k*∂SiAfter calculating the sample gradients, we can approximate the gradient, λi( · ) by Eq. (16), for a given value of Si. We need to use some iterative technique to determine the optimal Si. The starting value of Siis obtained by minimizing the cost functionJi(Ii,pij,qic,Si,Fi), assuming no cost-to-go function. Then Sican be given as(26)∂gi(Ii,pij,qic,Si,Fi)∂Si|Si=Si*=0This value of Siis taken as the initial value ofSi*(Si0) and is used to compute the gradient, λi( · ). This gradient value is updated by smoothing and then the new gradient value is used to compute the newSi*by Eq. (14). This newSi*value is also updated with its previous value by smoothing. Again, we re-compute the gradient using the new value ofSi*. This procedure is repeated and the values are updates until the value ofSi*converges. The iterative algorithm performs as follows:Step 1:Setλ¯i0=0andS¯i0=Si*whereSi*is given by Eq. (26)Set m = 1Calculateλm,i=λi(Si=S¯im−1)Updateλ¯imbyλ¯im=λ¯im−1+β(λm,i−λ¯im−1)CalculateS¯imby|∂gi(Ii,pij,qic)∂Si+λ¯im|Si=S¯im=0UpdateSimbySim=Sim−1+α(S¯im−Sim−1)Make m = m + 1 until it converges.Using this iterative algorithm we can determine the optimal order-up-to level of port i,Si*.In Section 4.3, we determine the optimal order-up-to level at port i for a given price realization asSi*(pij). To determine the optimal total cost for the ship, we first determine the total expected cost for a sample first and then approximate the optimal cost. Since we know the initial inventory and commitment at the start of the voyage, the optimal cost incurred at the first port for a price realizationp1jis given byg1(I1,p1j,q1c,S1*(p1j),F1)whereI1andq1care known and F1 ∼ G(μ1, σ1). The cost incurred at the second port depends onI2andq2cwhich in turn depend on realization of F1 and optimal order-up-to levelS1*. Therefore, for kth sample the cost incurred at port 2 is given byg2k(I2,p2l,q2c,S2*(p2l),F2)for price realization ofp2lat port 2 and price realization ofp1jat port 1, whereI2andq2care given byI2=[(S1*(p1j)−F1k]+andq2c={[q1c−(S1*(p1j)−I1)]+ifport1refuelsatpcq1cifport1refuelsatp1jSince the probability of reaching price statep2lat port 2 from price statep1jat port 1 is prj, l, the total expected cost incurred at port 1 and port(27)TC2k(I1,p1j,q1c)=g1k(I1,p1j,q1c,S1*(p1j),F1)+∑l=1Lprj,l*g2k(I2,p2l,q2c,S2*(p2l),F2)whereTCik(I1,p1j,q1c)denotes the optimal cost for port 1 to port i for a given sample k, with the inventory at the start of the voyage is I1 and total commitment for the voyage isq1cand realized price of the fuel at the first port isp1j.Similarly we can add on cost for all the other ports and the optimal cost for n ports is given by(28)TCnk(I1,p1j,q1c)=g1k(I1,p1j,q1c,S1*(p1j),F1)+∑l=1Lprj,l{g2k(I2,p2l,q2c,S2*(p2l),F2)+∑m=1Lprl,m{g3k(I3,p3m,q3c,S2*(p3m),F3)+⋯}}Since there is equal probability of realizing any price state out of L possible states at the first port, the optimal cost can be calculated as(29)TC*(I1,p1j,q1c)=∑k=1N∑j=1LTCnk(I1,p1j,q1c)In this section,we present some numerical experiments to show the effect of service contracts on the bunkering decisions. Firstly, the impact of service contract parameters, like contract price, contract amount and damage cost multiplier, on bunkering decisions are presented. Secondly, we study the impact of contract parameters on the total bunkering cost. Finally, we provide a case study for AEX service and compare the total bunkering cost with and without service contract.First, we consider a 3-port problem for the sake of understanding. As the order-up-to level at any port depends on the spot price it faces at that port, we consider several possible price states and investigate their impact on the order-up-to level. We assume the spot prices at any port can only take any of the 6 possible values. The probability of moving from one price state at one port to another price state at the next port i.e. the transition probability from one port to another port is assumed to be known. We assume that the fuel consumption is normally distributed (as determined by Sheng, Lee, & Chew, 2014). The price states and other parameters are given in Table 2. The transition probability of having the same price state at the last port is assumed to be 0.5 and all the other possibilities have equal probability. This implies that there is high probability that price remains same and all other possible states have the equal chance to be realized.It is assumed that the fuel supplier has refueling stations at all the ports and the liner can exercise its contract at any of these stations, if it wishes. Fig. 2 shows the impact of spot prices on the optimal up to level for a given initial state. The initial condition isIi+qic=1000for all i (so that the ship can exercise its contract at every port and we can determineSi*values when there is a contract). The optimal order-up-to level without a contract(Sinc)decreases with increasing fuel price and the order-up-to level at every port under contract (Sic) is higher than or equal toSinc. When the fixed contract price (pc) is lower than fuel price (pj),Sicis always higher thanSinci.e. the liner bunkers more with service contract. If the spot price is lower than the contract price, it tries to make advantage of the lower price. Though these results are intuitive, the optimal S for the 3rd and final port does not behave similarly as the damage cost comes in play. For the last port, it may be more economical to refuel at contract price if there is still some contracted amount available as the unconsumed amount carry a heavy damage cost. To reduce the damage cost, the liner may refuel an amount which is more than the amount when there is no contract. These can be evident from Fig. 3.The order-up-to level is also dependent on the total contract amount. To determine the effect of contract amount on optimal S, we carry out some experiments keeping the contract price fixed at $600. It was observed that if there is sufficient contract amount available, the ship always tried to refuel more thanSincas long as fuel price is less than contract price. But for the final port, the ship refuels as much as possible to minimize the damage cost, similar to the last case. These are shown in Figs. 4and 5.The order-up-to level is also dependent on the spot price volatility. By volatility, we mean that wider the spot price range more is the variability. We generated 6 different price states for different ranges and S*are determined for each state for every range. It was found that average S*value (over the 6 price states) increases with increasing variability, though the increase is not much. It is also found that when there is more contract amount available, average S*is higher than the case when there is no contract. The average S*increases faster with increasing price variability. Fig. 6shows the impact of price variability on average S*for port 3. Similar observations are made for port 1 and 2.The expected total cost for a given contract price and amount can be easily computed by the algorithm presented in Section 4.4. The impacts of contract price as well as the contract amount on the total cost are presented in Figs. 7and 8. These experiments are conducted for 5 ports of call. The price states and transitions probabilities are same at the last experiment, but the prices are assumed to follow uniform distributed between 600 and 800. All the other parameters for the experiments are shown in Table 3. From Fig. 7, we can see that cost increases with increasing contract price, which is intuitive but it can be noticed that even for the same contract price the cost varies based on the contract amount. Higher contract amount does not always mean lower total cost. From Fig. 8, it can be seen that for a low contract price, the total cost initially decreases with increasing contract amount but, after a point, the cost starts increasing. But for a higher contract price, the cost increases slowly initially but increases with a faster pace after a particular contract amount.From these figures, we can infer that increasing the contract amount does not always reduce the total cost. It can be seen that even for the same contract price, cost difference between contract amount 1500 and 2000 is almost $3.7 × 105 and it increases with increasing contract price. Since the unused amount incurs a heavy damage cost, the cost is much higher for higher amount. For our experiments, we assumed that damage charge multiplier is 2. The steepness of the lines in Fig. 7 increases with increasing dc.We now investigate the impact of penalty cost of running out fuel, M, on the total cost. The parameters used for these experiments are same as used in the last section and are presented in Table 3. The total cost for the liner without a service contract can easily be determined by keeping C = 0. From the experiments it was found that the penalty cost of running out of fuel does not have much impact on the cost difference as it affects both the cases (contract and without contract) similarly, though the impact is not same for both the cases. These can be evident from Fig. 9where costs for both the scenarios are compared for different contract amount. For these experiments, the contract price is fixed at $700/mts.We now show the impact of service contracts on the total bunkering cost with the help of a case study. We choose an existing liner service i.e. AEX service. Fig. 10illustrates only the eastbound route of AEX. The complete AEX service starts and finishes at Hamburg and has 15 different ports of call, but it visits 5 ports (Hong Kong, Singapore, Kaohsiung, Old Hickory and Suhindol) twice. We apply our model for this service to determine the total bunkering cost with and without service contract. Table 4provides the relevant parameters for the AEX service considered for these experiments.It must be noted that fuel consumption is dependent on ship speed and ship speed is dependent on ship size. This study is conducted for a 6000 TEU ship steaming at 20 knots. Table 5shows the expected total cost for different combination of contract price and amount, as well as the expected cost when there is no contract. As the cost without service contract does not depend on contract price or amount, the cost remains same across all the combinations. The cases where cost with a contract is lower than the cost without a contract are italicized in Table 5. At every port, spot fuel prices are generated from U($600, $800). The contract price ranges from $500/unit to $900/unit. It can be seen that the cost of contracting at a price lesser than the mean spot price ($700) is lower than the cost without contract. The cost with contract decreases with contract amount until a certain amount, and thereafter starts increasing. It can be seen that the cost starts increasing when the contract amount is more than 8000 units, which is the average fuel consumption for the entire voyage. The liner incurs damage cost for unconsumed units when total contract amount is more than 8000 units. As the damage cost is calculated at a rate twice (dc= 2) that of contract price, damage cost increases faster for higher contract prices and thus, the contracting can only be cost effective with lesser contract amount and higher contract price. For lower contract price, the liner can opt for more contract amount and can still be cost effective. Similar results are found for few more experiments which are included in Appendix A (Tables A.1–A.4). Based on these experiments, we can conclude that contracting an amount less than the average fuel consumption for the entire voyage, at a contract price which is lesser than the average spot price, is always beneficial than having no contract. Though determination of contract parameters is not the objective of this study, the above results may be useful in designing similar service contracts.In this paper,we considered an ocean shipping liner which has entered into a service contract with a fuel supplier with a fixed fuel price and a committed amount and determined the optimal bunkering decisions (where to bunker and how much to bunker). We proposed a dynamic programming model to optimize the total bunkering cost when both fuel consumption and fuel prices are uncertain. We considered an order-up-to base stock policy to formulate the model. Since the model has high dimensionality and it is impossible to determine the gradient of the cost-to-go function, we estimated the gradient using Monte Carlo simulation. Numerical experiments suggest that (i) the contract amount, contract price and damage charge multiplier (contract parameters) must be considered together in determining the optimal bunkering decisions (shown clearly from Section 5.2), (ii) amount to contract must be less than the mean consumption for the entire voyage planned for (as seen from Section 5.3), (iii) contract price should be less than the expected average spot price (as seen from Sections 5.1 and 5.3). This work and its results/insights are the first step in understanding the effects of service contracts on the operational behavior of liners, and can lead to further work in the design of service contracts.

@&#CONCLUSIONS@&#
