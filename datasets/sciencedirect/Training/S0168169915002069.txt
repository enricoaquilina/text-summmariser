@&#MAIN-TITLE@&#
A real-time plant discrimination system utilising discrete reflectance spectroscopy

@&#HIGHLIGHTS@&#
We present an advanced real-time green-from-green plant discrimination system.Uniform power multi-spot beams are used to illuminate the target vegetation.Spectral reflectance measurements are captured using a line scan sensor.Three laser diodes are used to compute dual NDVI discrimination parameters.Reliable plant detection and discrimination is attained for a 3km/h vehicle speed.

@&#KEYPHRASES@&#
Precision agriculture,Spectral reflectance,Optoelectronics,Embedded systems,Sensing,Real-time weed discrimination,

@&#ABSTRACT@&#
An advanced, proof-of-concept real-time plant discrimination system is presented that employs two visible (red) laser diodes (635nm, 685nm) and one near-infrared (NIR) laser diode (785nm). The lasers sequentially illuminate the target ground area and a linear sensor array measures the intensities of the reflected laser beams. The spectral reflectance measurements are then processed by an embedded microcontroller running a discrimination algorithm based on dual Normalised Difference Vegetation Indices (NDVI). Pre-determined plant spectral signatures are used to define unique regions-of-classification for use by the discrimination algorithm. Measured aggregated NDVI values that fall within a region-of-classification (RoC) representing an unwanted plant generate a spray control signal that activates an external spray module, thus allowing for a targeted spraying operation. Dynamic outdoor evaluation of the advanced, proof-of-concept real-time plant discrimination system, using three different plant species and control data determined under static laboratory conditions, shows that the system can perform green-from-green plant detection and accomplish practical discrimination for a vehicle speed of 3km/h.

@&#INTRODUCTION@&#
To maximise crop yield, blanket spraying of herbicides and insecticides is commonly used for weed and pest management. The application of such chemicals is often done terrestrially using an appropriately configured tractor or aerially, using a crop duster. A cost effective system for weed control, using spot-spraying of herbicides at appropriate periods during the cultivation cycle, is of interest to farmers due to the associated benefits of managed costs, reduced herbicide application and crop yield optimisation.In recent years, the collective application of new technological advancements and improved management practices to farming has given rise to the field of Precision Agriculture (PA) (Zhang et al., 2002), of which a major aspect is Site-Specific Crop Management (SSCM) for optimised, efficient field-crop production. The management of weeds through an agricultural crop’s growth cycle, is one such area that has attracted considerable research interest. Reviews by Zwiggelaar (1998) and Noble et al. (2002) have concluded that weed/soil (green-from-brown) and crop/weed (green-from-green) discrimination, utilising spectral reflectance and hyperspectral/multispectral imaging techniques, has achieved varying levels of success. In particular, spectral analysis has been used as a method for discriminating plants from soil (green-from-brown discrimination) (Felton and McCloy, 1992; Brownhill, 2006). Fundamental work presented by Wang et al. (2001) quantifies plant spectral characteristics by using five feature wavelengths and four normalised colour indices for crop/weed (green-from-green) discrimination. The work led to the development of an optical weed sensor capable of detecting wheat from specific weeds under controlled laboratory conditions. More recently, Deng et al. (2014) have investigated the application of Support Vector Machine (SVM), Artificial Neural Network (ANN) and Decision Tree (DT) based classifiers to compare the classification rates for plant spectral measurements taken in the 350–760nm visible wavelength range and the 350–2500nm visible and NIR wavelength range. Experimentally, spectral irradiance measurements for the test crop (corn) and weeds (Dchinochloa crasgalli and Echinochloa crusgalli) were performed in the field, using a handheld spectroradiometer, with results showing that the visible light range proved adequate to meet discrimination requirements for the given test plants. An innovative approach presented by Sahba et al. (2006) and Paap et al. (2008) demonstrated generalised green-from-green discrimination using a novel optical architecture, with the eventual objective of practical application of the technology to weed treatment, using spot spraying in field-crop production. The application of hyperspectral measurement techniques to the problem of crop/weed discrimination has also been reported on in the literature. Shapira et al. (2010) have investigated using ground based hyperspectral imaging to detect grasses and broadleaf weeds among cereal and broadleaf crops. The proximity based hyperspectral camera yielded hyperspectral resolution with high spatial resolution, enabling considerable spectral and spatial separation between crop and weed. In a different approach, Eddy et al. (2013) have investigated the feasibility of using reduced hyperspectral bandsets and ANN classification for discriminating between crop-field pea (Pisum sativum), spring wheat (Triticum aestivum), canola (Brassica napus) and weed-wild oat (Avena fatua), redroot pigweed (Amaranthus retroflexus). Reduced sets of narrow wave bands were created using Principal Component Analysis and Stepwise Discriminant Analysis with experimental results showing that plant discrimination using an ANN classifier was feasible and could provide considerable computational savings due to the reduced data dimensionality. The drawback however, was the high overhead required to train the classifier for successful operation.This paper reports on recent results obtained from research into the development of an advanced proof-of-concept real-time plant discrimination system based on discrete spectral reflectance measurements for green-from-green plant discrimination. The developed system is tested for the discrimination of Anthurium (Anthurium andraeanum) from Sunkisses (Ipomoea batatas var. sunkisses) and Dandelion (Taraxacum officinale).Experimental results show that practical green-from-green discrimination at a farming vehicle speed of 3km/h can be achieved. At higher speeds, due to identified hardware limitations, the discrimination capability and accuracy declines.The real-time Plant Discrimination Unit (PDU) is comprised of two 3-wavelength laser modules, two coated optical cavities, a high-speed linear photodetector array in the form of a line scan camera and an electronic circuit board housing six sub-modules, Fig. 1. These are a laser driver, analogue and digital power supply units, a temperature controller, a central processing unit, a spray nozzle activator and a line scan camera driver. The PDU is robustly packaged, using a rigid base plate and an accompanying light weight dust cover, to overcome harsh operation conditions such as shocks, vibrations and high temperatures.The optoelectronic architecture of the PDU, as presented, has the following benefits:1.The collimated, split laser beams enable spectral reflectance measurements to be taken from a small area of leaf of the target plant.The laser module beam combiner/optical cavity design enables the laser beams to illuminate the same spot on the leaf, for all wavelengths, making the measured spectral reflectance spatially accurate with regards to different leaf morphologies.The high dynamic range of the line scan sensor, when compared with area scan sensors of the type used in multi-spectral imaging, gives a better precision and a higher accuracy of the measured spectral properties.The low complexity of the discrimination algorithm means that it is not computationally intensive, therefore providing true real-time performance.Fig. 2shows the layout of the plant discrimination unit and illustrates how laser beams are generated to illuminate the vegetation.Each laser module uses three 4mm collimated laser sources, two red (635nm and 685nm) lasers and one near-infrared (785nm), with output power levels of 30mW, 50mW and 50mW, respectively. Within a module, each laser is independently mounted onto an alignment stage using alignment screws, so that all laser beams are aligned along the same optical axis. Two fixed, thin-film beam combiners are used to combine the laser beams, as reported by Askraba et al. (2013). Once all laser beams emerging from the laser module are collinear, overlapped and their polarisation directions are aligned, all laser stages are secured with locking screws to prevent the lasers from moving during dynamic tests.The collimated beams emerging from the laser module enter a multi-spot beam generator, which consists of an optical cavity coated with a reflective top (back) surface and non-uniform transmissive bottom (front) surface (Askraba et al., 2011, 2013). The beam spot field of view coverage was improved, in comparison to previously reported beam spot generators (Paap, 2014) by using a longer cavity inclined at a greater angle of 23°. This configuration increased the linear beam spacing from 12mm in earlier prototypes to 15mm in the final prototype and also reduced the gap between the two beams that are the closest to both sides of the line scan sensor. The non-uniform transmissive front surface was a fundamental improvement that enhanced overall system performance, leading to 4mm wide collimated beams of almost similar intensities.The stability of the measured reflected laser intensities was crucial to ensuring low false alarm rates as well as reliable and repeatable system performance. Accordingly, responsivity and switching speed were critical parameters in the choice of line scan sensor. A Hamamatsu S9227-03 CMOS linear image sensor, comprising a single line of 512 photodiodes, was used in the PDU shown in Fig. 1. In comparison to previously used sensors (Paap, 2014), the S9227-03 exhibited much lower variation in pixel response, Fig. 3, which yielded robust and repeatable measurements of spectral properties.System tests revealed that the outdoor performance of the line scan sensor was noticeably degraded by ambient light, which, if bright enough, caused the sensor to saturate, negating any form of reliable spectral measurement. To address this problem and to remove much of the broadband solar noise, a dual band-pass optical filter (Fig. 4) with pass-bands specified at 648±43nm and 783±29nm for the red (635nm, 685nm) and NIR (785nm) wavelengths respectively, was designed and fitted to the front of the sensor (Askraba et al., 2013; Paap, 2014).Experimental outdoor tests with and without the solar filter, show an average reduction of ambient light in the order of 65–75%, as shown in Fig. 5.From a system perspective, the solar filter effectively increased the sensor dynamic range, which in turn improved the optical signal-to-noise ratio (OSNR) of the measured spectral reflectance signal levels. For captured unfiltered/filtered measurements, the difference in the noise bandwidths of the data prevents direct comparison of signal-to-noise ratio improvements. A relative measure of the improvement in dynamic range is possible by defining the figure-of-merit (ρ):ρ[i]=S[i]S[i]+NAmbient[i]fori=1..512where S[i] is the raw 10-bit signal value at pixel i and NAmbient[i] is the raw 10-bit background noise value at pixel i. Defining ρUnfilteredand ρFilteredas the figures-of-merit for unfiltered and filtered spectral reflectance measurements respectively, a measure of the relative improvement in the dynamic range is given by:ΔDR=ρFilteredρUnfilteredExperimental results illustrating the relative dynamic range improvement obtained on using the solar filter are presented in Figs. 6–8. The data was captured on an overcast day with a measured ambient light level of 4000lux and an S9227-03 exposure time of 0.25ms. The PDU, mounted on a static holding frame, captured reflectance levels from a uniform green test card placed 950mm vertically beneath the PDU, with the card sequentially illuminated by the individual 635nm, 685nm and 785nm lasers.It is important to point out that the relative improvement of dynamic range is dependent upon the measurement conditions – laboratory, with artificial lighting; outdoors full shade, part shade, overcast or full sun with clear skies. Real-world statistical characterisation of the improvement in dynamic range is therefore complex.The control unit of the PDU encompasses the modules and functionality that allow for intelligent control of the optics unit, targeted spraying and external communications with the PDU.To perform successful discrimination and targeted spraying in real-time at adequate farming vehicle speeds, all requisite data acquisition and calculations must be completed within a fixed time frame. Failure to do so would mean that the system could inadvertently spray crops and not detected weeds.For a collimated beam diameter of 4mm, the processing time was constrained by the fact that on performing a measurement, the microcontroller must complete all calculations before the platform moves forward by 4mm to the next measurement position. Fig. 9shows the constrained processing time versus vehicle speed, for a 4mm collimated beam diameter. It is clear from Fig. 9 that, for an initial target vehicle speed of 10km/h, a processing time of 1.440ms per discrimination cycle is required.The microcontroller chosen to meet the processing time requirement was the Microchip dsPIC33F, which is a 16-bit, 40 MIPS digital signal controller with a modified Harvard architecture and direct support for both integer and Q15/Q30 fractional arithmetic. Theoretically, the microcontroller was capable of executing 57,600 instructions in 1.440ms, which proved adequate for the low overhead discrimination algorithm, written in the C programming language.The line scan data was acquired through a single channel of the multiplexed 13-channel on-chip analogue-to-digital converter, configured for 10-bit, 500ksps operation. At 500ksps operation, a single sensor read of 512-pixels took a time of 1.024ms and this was a hardware-related limitation for operating the PDU at higher speeds. This is because four sensor reads are performed on a per scan basis amounting to a total sensor access time of 4.096ms, which, after factoring in the processing time required by the discrimination algorithm, effectively limits the current vehicle speed at which the prototype PDU can operate, to around 3.5km/h (Fig. 9).Reliable and repeatable classification performance for real-time plant discrimination, using discrete spectral reflectance measurements, requires the identification of a set of spectral reflectance features for the target crops/weeds.The line scan sensor captures the diffuse, reflected light intensity from illuminated targets at the wavelengths (λ) 635nm, 685nm and 735nm. The inferred target reflectance (Holland et al., 2012) for the individual beam-spots i, denoted as Rλ[i], is calculated using the expression:Rλ[i]=Vλ[i]Nλ[i]fori=1..512where Vλ[i] is the measured sensor response, in digital numbers of the ith beam and Nλ[i], a normalisation factor for each beam, calculated as:Nλ[i]=PrefPλ[i]The value Prefis a reference beam optical power (BOP) and Pλ[i], the optical power of the ith beam at wavelength λ.With reference to a typical reflectance spectrum for a healthy plant leaf shown in Fig. 10, it is possible to define a set of features that, collectively, can be used for plant discrimination.Various identified features are defined as follows:1.Slopes S1 and S2: These measurements provide for green-from-green discrimination (Sahba et al., 2006; Paap et al., 2008) and are defined as:S1≜R635-R685λ685-λ635andS2≜R785-R685λ785-λ685Normalised Difference Vegetation (or Vegetative) Index (NDVI): The NDVI is a dimensionless quantity that provides a measure of whether the target under observation contains live vegetation or not. Healthy, living plants absorb most of the visible light that falls on them and reflect the NIR portion. In particular, the most defining information on vegetation is given by the difference in measured reflectance between the visible red and NIR wavelengths, as illustrated by the “red edge” of Fig. 10. Using these two bands, the NDVI is defined as:NDVI≜RNIR-RREDRNIR+RREDFor the two red lasers of 635nm and 685nm wavelengths, it is possible to define the following NDVIs:NDVI635≜R785-R635R785+R635andNDVI685≜R785-R685R785+R685On an individual basis NDVI685 can be used for green-from-brown discrimination (Paap, 2014).Red Difference Index (RDI): This index is similar to the NDVI but is defined for the two red wavelengths as follows:RDI≜R635-R685R635+R685Note that not all of the identified parameters are necessarily suitable for green-from-green discrimination. The slope values S1 and S2 provided reliable green-from-green discrimination under static conditions in a controlled laboratory environment. However, in a dynamic outdoor environment it was found that platform dynamics and factors affecting reflection, such as the distance of the sensor from the leaf, the orientation of the leaf and the exposure time of the line scan sensor, collectively resulted in varying reflected laser intensities, which thwarted the usefulness of these two parameters. Data normalisation was able to remove many of the aforementioned factors and the NDVI635 and NDVI685 parameters were more reliable discriminants than the RDI parameter. It was experimentally found that, when an incident beam was illuminating a leaf, the variability in the red laser peak values led to errors in the measured spectral properties. With low red peak values, the variance of the RDI parameter was significantly larger than those of the NDVI parameters. This discovery discounted the use of the RDI parameter as a discriminant.Fig. 11shows a functional block diagram that details the data processing stages of the discrimination algorithm on a per scan basis, where, as illustrated, a single scan consists of:1.Ambient light level measurement, with all lasers turned off.635nm red laser reflectance measurement.685nm red laser reflectance measurement.785nm NIR laser reflectance measurement.On a per scan basis, the individual measured reflectance levels were then adjusted by subtracting the measured background to produce three independent 512 element data vectors denoted byV→635,V→685andV→785. Using a defined peak threshold, Tpeak, peak detection on the adjustedV→785values was performed. The peak detection algorithm scanned theV→785data for values above Tpeak, performing two operations, namely, (1) single peak identification, representative of either a full leaf strike or ground strike, and (2) dual peak identification, representative of a partial leaf strike. For detected peaks corresponding to full leaf or ground strikes, the start pixel index, end pixel index and local maximum value were stored. Detected dual peaks corresponding to partial leaf strikes were flagged, as the peak information could not be used further by the discrimination algorithm. On completion, the output of the peak detection algorithm was a 1×30 vector denoted byV→785PKs. Using the valid located peaks stored inV→785PKsthe corresponding peak values in theV→635,V→685andV→785vectors were extracted and the inferred target reflectance values calculated using measured BOP values stored in a lookup table (LUT). Finally, using the measured reflectance values, the corresponding 30 element NDVI635 and NDVI685 vectors, denoted byX→NDVI635andY→NDVI685, were calculated.A green-from-brown test eliminated non-plant NDVI measurements, with subsequent plant discrimination achieved by classifying the calculated bivariate NDVI values for detected green plant material according to a predetermined Region-of-Classification (RoC) LUT. Depending upon the number of plant species N to be discriminated, the RoC LUT contained N parallelogram co-ordinate values that defined unique non-overlapping regions in NDVI635 and NDVI685 space. The discriminator output was an N×30 vector denoted byZ→Classified, that contained all of the NDVI635 and NDVI685 data pairs allocated to one of the N possible predetermined regions-of-classification, where the vector length was determined by the maximum possible number of measurements on a per scan basis.Z→Classifiedwas then processed for plant strikes, where a strike was deemed to have happened when measured NDVI values from an unwanted plant fell within a specified RoC. To reduce the false alarm rate of the algorithm and to improve the PDU’s robustness and reliability, the strike detection algorithm was based on a running strike aggregate counter, which averaged the NDVI measurements of all of the individual beam strikes for a particular RoC. If a specified detection threshold Taggregate was exceeded, the strike was deemed valid and a plant spray signal generated.The performance of the developed PDU was evaluated under static and dynamic conditions with three broad leafed, potted plant species Anthurium (Anthurium andraeanum), Sunkisses (Ipomoea batatas var. sunkisses) and Dandelion (Taraxacum officinale).For static tests, a vertically adjustable frame, shown in Fig. 12, was built to hold the PDU under test. Control data for determining the three regions-of-classification were captured under laboratory conditions using the 15 beams from one side of the PDU (Fig. 2). Experimentally, to reduce the measured reflectance of the scattered NIR wavelength, each sample leaf was placed on a 4mm thick clear acrylic stage located on the floor. By adjusting the height of the PDU, the sample leaves were positioned at a distance of 900mm above the sensor. To ensure that the reflectance measurements made were dominated by diffuse reflection and not biased by specular reflection captured by the line scan sensor, each leaf was tilted 25° with respect to the incident light. A single measurement trial, consisting of NDVI measurements for each of the individual 15 beams, was recorded for three different locations on the sample leaves, with care taken to avoid leaf midrib measurements. This generated a total of 45 static (NDVI635, NDVI685) measurement sets per sample leaf.Dynamic outdoor tests were conducted with the PDU mounted on a frame attached to a motorised quad bike (Fig. 13). An aluminium shroud with plastic brushing down to the ground on the sides was used to block the ambient light level. The three test plants were placed in the ground along a defined test circuit and the quad bike driven around the circuit at an average speed of 3km/h. On each pass of a detected test plant, the measured NDVI values were recorded.Regions-of-classification defined using control data measured under laboratory conditions, offered a worst case test scenario for evaluating the dynamic performance of the experimental proof-of-concept system. The capability of the system to discriminate the test plants outdoors, under different ambient lighting using NDVI values, calculated in real-time from dynamic spectral reflectance measurements, directly tests the practical validity of the dual NDVI discrimination approach.

@&#CONCLUSIONS@&#
