@&#MAIN-TITLE@&#
Homomorphic image watermarking with a singular value decomposition algorithm

@&#HIGHLIGHTS@&#
Information embedding and retrieval in digital images.Digital Watermarking.Image processing.

@&#KEYPHRASES@&#
Image watermarking,Homomorphic transform,SVD,Wavelet transform,

@&#ABSTRACT@&#
In this paper, a new homomorphic image watermarking method implementing the Singular Value Decomposition (SVD) algorithm is presented. The idea of the proposed method is based on embedding the watermark with the SVD algorithm in the reflectance component after applying the homomorphic transform. The reflectance component contains most of the image features but with low energy, and hence watermarks embedded in this component will be invisible. A block-by-block implementation of the proposed method is also introduced. The watermark embedding on a block-by-block basis makes the watermark more robust to attacks. A comparison study between the proposed method and the traditional SVD watermarking method is presented in the presence of attacks. The proposed method is more robust to various attacks. The embedding of chaotic encrypted watermarks is also investigated in this paper to increase the level of security.

@&#INTRODUCTION@&#
The spreading of digital multimedia nowadays has made copyright protection a necessity. Authentication and information hiding have also become important issues. To achieve these security requirements, watermarking technology can be used. Watermarking means embedding a piece of information into a cover signal or image in such a way that it is imperceptible to a human observer, but is easily detectable by a computer or a detector (Cox, Miller, & Bloom, 2002). Several researchers have worked in the field of watermarking for its importance (Cox et al., 2002; Podilchuk & Delp, 2001). The work in this field has led to several watermarking techniques such as the correlation-based techniques, the frequency-domain techniques, and the wavelet-domain techniques (Shoemaker & Rudko, 2002).Before the emergence of digital image watermarking, it was difficult to achieve copyright protection, authentication, and data hiding, but now it is easy to achieve these goals using watermarking techniques. Each watermarking technique consists of an embedding algorithm and a detection algorithm. An embedded watermark must achieve some requirements such as robustness, fidelity, and tamper resistance (Cox et al., 2002). Robustness means that the watermark must be robust to the transformations that include common signal distortions such as digital-to-analog conversion, analog-to-digital conversion, and lossy compression. Fidelity means that the watermark must be neither noticeable to the viewer nor degrading for the quality of the content. Tamper resistance means that the watermark is often required to be resistant to signal processing algorithms. The importance of these requirements depends on the application. The watermark can be embedded in the spatial domain or in a transform domain (Shoemaker & Rudko, 2002).The SVD mathematical algorithm provides an elegant way for extracting algebraic features from an image. The main properties of the Singular Values (SVs) matrix of an image can be exploited in image watermarking. This matrix has a good stability. When a small perturbation affects the image, no large variations occur in its SVs (Chandra, 2002; Liu & Tan, 2002). Using this property, the watermark can be embedded to this matrix without large variations in the obtained image. Liu et al. have proposed an SVD image watermarking scheme, in which the watermark is added to the SVs of the whole image or to a apart of it (Liu & Tan, 2002). The watermark used in this scheme may be lost due to attacks.The main idea of homomorphic image processing is based on modeling the image as a product of a constant illumination and a varying reflectance (Chang, Tsai, & Lin, 2005; Srinivas Kumar, Chandra Mohan, & Chatterji, 2007). The product is dealt with as a summation using the logarithmic operation. The reflectance component can be separated using a High-Pass Filter (HPF), while the illumination component can be separated using a Low-Pass Filter (LPF). Most of the image details lie in the reflectance component with low energy, while the illumination component is approximately constant with high energy. We can carry out the watermarking process in the homomorphic domain on the reflectance component. Our objective is to achieve invisibility of the watermark, robustness, fidelity and tamper resistance. Invisibility is achieved by watermark embedding in the low-energy reflectance component. Robustness, fidelity, and tamper resistance are guaranteed with the properties of the SVD algorithm.The paper is organized as follows. Section 2 briefly explains the traditional SVD image watermarking scheme. Section 3 introduces the proposed SVD watermarking method in the homomorphic domain. Section 4 introduces a block-by-block implementation of SVD watermarking in the homomorphic domain. Section 5 discusses SVD watermarking in the homomorphic domain with encrypted watermarks. Section 6 gives the experimental results. Finally, Section 7 gives the concluding remarks.The SVD of an image is computed to obtain two orthogonal matrices U and V, and a diagonal matrix S. In the approach proposed by Liu et al., the watermark W is added to the matrix of SVs S, and then a new SVD process is performed on the resulting matrix S+kW to get Uw, Sw, and Vw(Liu & Tan, 2002). k is a scale factor that controls the strength of the watermark embedded to the original image. The watermarked image Fwis obtained by multiplying the matrices U, Sw, and VT. The steps of watermark embedding are summarized as follows:1.The SVD is performed on the original image (F matrix).(1)F=USVTThe watermark (W matrix) is added to the SVs of the original matrix.(2)D=S+kWThe SVD is performed on the new modified matrix (D matrix).(3)D=UwSwVwTThe watermarked image (Fwmatrix) is obtained using the modified matrix (Swmatrix).(4)Fw=USwVTTo extract the possibly corrupted watermark from the possibly distorted watermarked image, given Uw, S, Vwmatrices, and the possibly distorted imageFw∗, the above steps are reversed as follows:1.The SVD is performed on the possibly distorted watermarked image (Fw∗matrix).(5)Fw∗=U∗Sw∗V∗TThe matrix that includes the watermark is computed.(6)D∗=UwSw∗VwTThe possibly corrupted watermark is obtained.(7)W∗=(D∗-S)/kThe * refers to the corruption due to attacks.In general, an image can be regarded as a 2-D function of the form f(n1, n2), whose values at the spatial coordinates (n1, n2) are positive scalar quantities (Li, Zheng, Mou, & Cai, 2002). Assuming that we are dealing with gray-scale images, we can say that when an image is generated from a physical process, its values are proportional to the energy radiated by a physical source. In other words, an image is an array of measured light intensities and is a function of the amount of light reflected from the objects in the scene. The intensities of pixels are the product of the incident illumination and objects reflectance. The illumination is approximately constant, while the reflectance holds most of the image details. The reflectance results from the way the objects in the image reflect light, and it is determined by the intrinsic properties of the objects. So, it is expected that a watermark embedded in the reflectance component can survive several attacks, because watermarks are generally required to be inserted in details or edges of the images (Chandra Mohan & Srinivas Kumar, 2008). In the following sub-sections, the steps of watermark embedding in the reflectance component of an image and watermark detection are presented.1.The image intensities can be represented as follows (Ghazy, El-Feshawy, Hadhoud, Dessouky, & Abd El-Samie, 2007; Gonzalez & Woods, 2002):(8)f(n1,n2)=i(n1,n2)r(n1,n2)where i(n1, n2) is the light illumination and r(n1, n2) is the reflectance of the object to be imaged.The homomorphic transform is performed(9)ln[f(n1,n2)]=ln[i(n1,n2)]+ln[r(n1,n2)]An LPF and an HPF are applied to ln[f(n1, n2)] to separate the illumination component I from the reflectance component R, in the form of matricesThe SVD is performed on the (R matrix)(10)R=USVTThe watermark (W matrix) is added to the SVs of the reflectance matrix.(11)D=S+kWThe SVD is performed on the new modified matrix (D matrix).(12)D=UwSwVwTThe watermarked reflectance matrix Rwis obtained using the Swmatrix.(13)Rw=USwVTAn inverse homomorphic transform is performed on I and Rwto obtain a matrix Xw.(14)Xw=Rw+IThe watermarked image is obtained as follows:(15)Fw=exp(Xw)We can notice from Eqs. (13)–(15) that the watermark affects the watermarked image in a multiplicative manner, which is expected to make this watermarking scheme more resistant to traditional signal processing techniques. It is well-known in signal processing that multiplicative effects on signals are difficult to remove. So, traditional signal processing techniques like filtering, JPEG, AWGN will have a smaller effect on the proposed technique that their effect on the SVD watermarking only.To extract the possibly corrupted watermark from the possibly distorted watermarked image, given Uw, S, Vwmatrices, and the possibly distorted imageFw∗, the above steps are reversed as follows:1.The homomorphic transform is performed on the possibly distorted watermarked imageFw∗.An HPF similar to that used in the embedding process is used to get the possibly corrupted reflectance componentRw∗.The SVD is performed on theRw∗matrix.(16)Rw∗=U∗Sw∗V∗TThe matrix that includes the watermark is computed.(17)D∗=UwSw∗VwTThe possibly corrupted watermark is obtained.(18)W∗=(D∗-S)/kGenerally, watermark embedding on a block-by-block basis increases the ability of the watermark to survive attacks (Basso, Bergadano, Cavagnino, Pomponiu, & Vernone, 2009). The block-by-block SVD watermarking is employed by dividing the original image into blocks, and then the watermark is embedded in the SVs of the reflectance component of each block, separately. The steps of watermark embedding and detection on a block-by-block basis are presented in the following sub-sections.The same steps from 1 to 4 in Section 3.1 are applied, and then:5.The matrix S is divided into non-overlapping blocks Sb.The watermark matrix W is added to each block.(19)D=Sb+kWThe watermarked blocks are combined back into a single matrix to build the Swmatrix.The same steps from 8 to 10 in Section 3.1 are applied.The same steps from 1 to 4 in Section 3.2 are applied but on blocks and then:5.The possibly corrupted watermark is obtained.(20)W∗=(D∗-Sb)/kWatermark embedding and detection are shown in Figs. 1 and 2, respectively.We study the process of embedding an encrypted watermark to an image to increase the level of security. The same steps of the method of Liu and the proposed SVD watermarking in the homomorphic domain are used with encrypted watermarks. The watermark is first encrypted with a 2-D chaotic Baker map and then embedded to the image and the extracted watermark is decrypted.The discretized Baker map randomizes a square matrix by assigning each pixel another position in a bijective manner. The discretized Baker map will be denoted byB(n1,…,nl), where the sequence of l integers, n1,n2,…,nl, is chosen such that each integer nidivides N, andNi=n1+⋯+ni. The pixel at (r,s), withNi⩽r<Ni+niand0⩽s<Nis mapped to (Fridrich, 1998):(21)B(n1,…,nk)(r,s)=Nni(r-Ni)+smodNni,niNs-smodNni+NiThe steps of randomization can be summarized as follows:1.An N×N square matrix is divided into l vertical rectangles of height N and width niwith n1+n2+…nl=N).Each vertical rectangle is divided into niblocks, and each block contains N points.Each of these blocks is mapped to a row of pixels.An example of the randomization of an 8×8 matrix is shown in Fig. 3. The secret key is [2, 4, 2], hence N=8, n1=2, n2=4, and n3=2.Several experiments have been carried out to compare between the method of Liu, and the proposed SVD watermarking in the homomorphic domain for the whole image and on a block-by-block basis. The 512×512 Airplane and color Baby images have been used in the simulation experiments. The RGB color space is highly correlated, and hence it is not suitable for watermarking applications, except for the blue channel used by some researchers because of its low effect on human perception (Gilani, Kostopoulos, & Skodras, 2002). So, we have to transform the RGB color space to the Y Cb Cr color space. In this color space, most of the information is concentrated in the luminance (Y component) and little information is in the chrominance (Cb and Cr components). The experiments demonstrate that watermark embedding in the luminance component (Y) has a larger effect on the human vision than embedding in the Cb or Cr components, but due to the robustness to JPEG compression; we have performed watermark embedding in the Y channel.Fig. 4shows the original image, the watermark, the watermarked image, and the extracted watermark using the method of Liu. Fig. 5shows the original image, the watermark, the watermarked image, and the extracted watermark using the proposed homomorphic method. It is clear that there is no visual difference between the original image and the watermarked image, ensuring the fidelity of the proposed homomorphic method. We can see that the Peak Signal-to-Noise Ratio (PSNR) of the watermarked image in the method of Liu is 62.65dB, and in the proposed method, the PSNR is 65.7dB. The correlation coefficient (cr) values between the original watermark and the extracted watermarks for SVD watermarking and SVD watermarking in the homomorphic domain are 0.9 and 0.9993, respectively.Fig. 6shows the original image, the watermark, the watermarked image, and the extracted watermarks using the block-by-block SVD method in the homomorphic domain. It is clear that there is no visual difference between the original image and the watermarked image, ensuring the fidelity of the block-by-block SVD watermarking in the homomorphic domain. We find that the PSNR in this method is 66.58dB. The maximum correlation coefficient between the original watermark and any of the extracted watermarks is crmax=0.9997.Some attacks such as adding Gaussian noise, cropping, compression, rotation and resizing have been applied on the watermarked images. Figs. 7–9show the watermarked images and the extracted watermarks under attacks for all watermarking methods. The first attack applied is the JPEG compression with quality factor 50%. The second attack is resizing from size 512×512 to 256×256 and back to 512×512. The third attack is addition of Gaussian noise with zero mean and 0.1 variance. The fourth attack is cropping. The fifth attack is rotation with −3°.Fig. 7 shows the extracted watermarks for the different attacks and the correlation coefficient between each extracted watermark and the original watermark for the method of Liu. The results reveal that the value of crlies between 0.1 and 0.8 for each attack except for the cropping attack, which gives cr=0.0317. Fig. 8 shows the extracted watermarks for the proposed SVD watermarking in the homomorphic domain after applying similar attacks. In all cases, the extracted watermarks have values of crhigher than 0.5 and better than those of the method of Liu, which ensures the existence of the watermark and the superiority of the proposed SVD watermarking in the homomorphic domain.Fig. 9 shows the extracted watermarks for the block-by-block SVD method in the homomorphic domain under similar attacks. In all cases, there are extracted watermarks with crhigher than 0.8, which ensures the existence of the watermark. The results show that the detectability of the watermark has been greatly enhanced with the proposed block-by-block SVD watermarking method in the homomorphic domain. Watermark repetition has increased the probability that at least one watermark survives the attack.The experimental results on the 512×512 color Baby image with the method of Liu, the SVD watermarking in the homomorphic domain, and the block-by-block SVD watermarking in the homomorphic domain are shown in Figs. 10–13. Tables 1 and 2give correlation coefficient values for the Airplane and Baby images with all methods under different attacks. The obtained results reveal the superiority of watermarking in the homomorphic domain.Some other experiments have been carried out to show the results of SVD watermarking and block-by-block SVD watermarking in the homomorphic domain with an encrypted watermark. The Baker map has been used for encryption. To measure the quality of encryption, we estimate the correlation coefficient between the encrypted watermark and the original watermark ce. The lower the value of ce, the better the degree of encryption. Also, to evaluate the quality of watermarking, we estimate the correlation coefficient between the extracted decrypted watermark and the original watermark cr. The higher the value of the correlation coefficient, the better the quality of watermarking. The results of watermarking with encrypted watermarks are shown in Figs. 14–16and Table 3. From these results, we notice that the watermarks can be decrypted and extracted successfully for both SVD and block-by-block SVD watermarking in the homomorphic domain. Thus, we can conclude that the proposed SVD watermarking and block-by-block SVD watermarking in the homomorphic domain can be used successfully with permutation-based encryption algorithms.

@&#CONCLUSIONS@&#
This paper presented a homomorphic image watermarking method using the SVD algorithm. By embedding a watermark with the SVD algorithm to the reflectance component of an image, we guarantee that the effect of the watermark on the image is multiplicative not additive. That is why watermarking in the homomorphic domain survive digital signal processing attacks. Simulation results have shown that the block-by-block SVD watermarking in the homomorphic domain has high fidelity, robustness, and detectability under attacks. Simulation results have also shown that the utilization of encrypted watermarks is possible with SVD and block-by-block SVD watermarking in the homomorphic domain. We have come to the conclusion that permutation-based algorithms can be used efficiently for this purpose to increase the level of security.