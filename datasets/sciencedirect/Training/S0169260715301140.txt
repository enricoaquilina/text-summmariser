@&#MAIN-TITLE@&#
Bayesian network modeling: A case study of an epidemiologic system analysis of cardiovascular risk

@&#HIGHLIGHTS@&#
An epidemiologic system analysis of cardiovascular risk is presented through a Bayesian network model.The Bayesian network model can serve as a generic tool for application oriented activities: explanation, prediction, monitoring and prevention.Due to cardiovascular disease is multifactorial, the application of this kind of model is of special interest, both from theoretical and practical point of view.The induced Bayesian network was used to make inferences taking into account three reasoning patterns: causal reasoning, evidential reasoning, and intercausal reasoning.

@&#KEYPHRASES@&#
Bayesian networks,Model averaging,Cardiovascular lost years,Cardiovascular risk score,Metabolic syndrome,Causal dependency discovery,

@&#ABSTRACT@&#
An extensive, in-depth study of cardiovascular risk factors (CVRF) seems to be of crucial importance in the research of cardiovascular disease (CVD) in order to prevent (or reduce) the chance of developing or dying from CVD. The main focus of data analysis is on the use of models able to discover and understand the relationships between different CVRF. In this paper a report on applying Bayesian network (BN) modeling to discover the relationships among thirteen relevant epidemiological features of heart age domain in order to analyze cardiovascular lost years (CVLY), cardiovascular risk score (CVRS), and metabolic syndrome (MetS) is presented. Furthermore, the induced BN was used to make inference taking into account three reasoning patterns: causal reasoning, evidential reasoning, and intercausal reasoning. Application of BN tools has led to discovery of several direct and indirect relationships between different CVRF. The BN analysis showed several interesting results, among them: CVLY was highly influenced by smoking being the group of men the one with highest risk in CVLY; MetS was highly influence by physical activity (PA) being again the group of men the one with highest risk in MetS, and smoking did not show any influence. BNs produce an intuitive, transparent, graphical representation of the relationships between different CVRF. The ability of BNs to predict new scenarios when hypothetical information is introduced makes BN modeling an Artificial Intelligence (AI) tool of special interest in epidemiological studies. As CVD is multifactorial the use of BNs seems to be an adequate modeling tool.

@&#INTRODUCTION@&#
Bayesian Networks (BNs) [1,2] also referred to as Belief Networks or probabilistic causal networks are an established framework for uncertainty management in Artificial Intelligence (AI). They constitute a tool which combines graph theory and probability theory to represent relationships between variables (nodes in the graph) [3]. Contrary to deterministic understanding of the causality phenomenon [4], BN modeling has its origins within data mining and machine learning research [5,6] and captures probabilistic influences induced out of big data sets. They constitute a powerful knowledge representation and an efficient reasoning tool under conditions of uncertainty [7]. The network structure is a directed acyclic graph (DAG) where each node represents a random variable [8,9] and the arcs are suitable for representing causality [10].BNs have been proven to be a strong tool to discover the relationships between variables that attempts to separate out direct and indirect dependencies [11,12], and can capture the way an expert understands the relationships among all the features [13]. BN modeling is widely used in fields like clinical decision support [14], systems biology [15,16], human immunodeficiency virus (HIV) and influenza research [17,18], analyzes of complex disease systems [19–21], interactions between multiple diseases [22], and also in diagnostic diseases [23–27].The metabolic syndrome is a set of risk factors that include abdominal obesity, insulin resistance, dyslipidemia and hypertension leading to increased risk of developing cardiovascular diseases and type 2 diabetes [28–31]. Cardiovascular disease (CVD) epidemiology is a worldwide public health problem [32]. The economic burden of CVD is already affecting the economies of the world's wealthiest countries. However, in the next decades developing countries will be more affected due to the great increase in CVD prevalence expected in these countries [33]. It is estimated that in 2015, more than 20million people may die worldwide because of CVD. This number is expected to increase in the upcoming decades, that every 5s in the world a myocardial infarction would occur [34,35].CVDs are closely related to the well-known cardiovascular risk factors (CVRF). The concept of CVRF appeared in 1961, when the group of Kanned defined CVRF as biological traits or behaviors that increased the chance of developing or dying from CVD [36,37]. The high prevalence of certain risk factors to which we are exposed is the cause of this situation, in which the prevalence of CVD is increased every year. It is necessary to control the factors that influence the development of CVD, such as smoking, hyperlipidemia, hypertension, diabetes, obesity, a diet high in saturated fats, alcohol abuse, a sedentary lifestyle, and stress [38]. In fact, WHO (World Health Organization) estimates that 80% of premature deaths from cardiovascular disease and diabetes could be prevented by efficient controlling these risk factors [39].There are some scores that numerically quantify cardiovascular risk (CVR). One of the most widely used is Framingham score, with its calibrated form for the Spanish population, the Framingham-REGICOR [35]. This scale estimates the global CVR to 10 years and it is expressed as a percentage. Recently, a new score has been proposed, the so-called Heart Age tool (HA), which is based on Framingham score, and supposes a simple and graphic way to communicate the CVR because it expresses the CVR as an age. If the HA value is older than chronological age the term “lost years”, defined as the HA minus the chronological age, could be used. The HA is a novel concept designed specifically to help people to understand their own cardiovascular disease risk and implement changes into their lifestyles to prevent the incidence of CVD [40].Development and analysis of models to examine the relationships between different CVRF could be not only of theoretical interest, but can serve as a generic tool for application oriented activities: explanation, prediction, monitoring and prevention. It enables both theoretical analysis of the relationships between numerous variables, and having in mind the probabilistic nature of the causal dependencies, BNs seem to be an adequate tool. Moreover, BN models are capable of creating different scenarios based on hypothetical cases when new observations are instantiated.The paper is organized as follows. Section 2 introduces BNs and some basic concepts for inference flow. Section 3 presents the materials and methods for the epidemiologic study and the process of inducing a BN from a data set. Section 4 shows different reasoning patterns to analyze the BN. Section 5 presents a discussion. Finally, Section 6 concludes the paper.A BN consists of [41]: (i) a set of variables and a set of directed edges between these variables, where (ii) each variable has a finite set of mutually exclusive states, and (iii) the variables together with the directed edges form a DAG. BN models estimate the joint probability distribution P over a vector of random variables X =(X1, …, Xn). The joint probability distribution factorized as a product of several conditional distributions denotes the dependency/independency structure by a DAG:(1)P(X1,…,Xn)=∏i=1nP(Xi∣Pa(XiG))Eq. (1) (wherePa(XiG)denotes the parent nodes of Xi) is the main reason for the formulation of a multivariate distribution by BNs; this equation is also called the chain rule for Bayesian networks.As BNs are used to make inference [8], it is necessary to understand the flow of influence when new information is introduced in a BN. Below we introduce some basic concepts.Two variables X and Y in a BN are d-separated if, for every possible path between X and Y, there is an intermediate variable Z such that either: (i) the connection is serial (X→Z→Y or X←Z←Y) or diverging (X←Z→Y) and Z is instantiated, or (ii) the connection is converging (X→Z←Y) and neither Z nor any of Z's descendants have received evidence. When influence flows from a node X to another node Y via a node Z, it is said that the trail X⇌Z⇌Y is active. A causal trail X→Z→Y (serial connection), an evidential trail X←Z←Y (serial connection) or, a common cause trail X←Z→Y (diverging connection) is active if and only if Z is not observed. A common effect trail X→Z←Y (converging connection) is active if and only if either Z or one of Z's descendants is observed.Let P be a joint probability distribution of the random variables in some set of features F, the set of arcs is denoted by A, and a DAG G=(F, A); then (G, P) satisfies the local Markov condition if for each variable (feature) X ∈ F, X is conditionally independent of the set of all its non-descendants given the set of all its parents. The global Markov property states that any node X is conditionally independent of any other node given its Markov blanket, i.e., I(X, non−markov−blanket(X)∣markov−blanket(Xi)); the Markov blanket of a node includes its parents, its children, and the children's other parents (spouses). Any node in the BN would be d-separated of the nodes belonging to the non-Markov blanket given its Markov blanket.This section presents some methodological issues concerning data acquisition. Reliability of data was assured due to standard medical procedures. A brief description follows.All participants were workers from the public sector of the Balearic Islands (Spain). Subjects in the study were invited to participate during their annual work health assessment. Any worker attending the work health assessment could be included in the study. 4300 workers were invited to participate. Among them, 3993 subjects (Men=1758, Women=2235) agreed to participate. Participants signed informed consent prior to enrollment. After acceptance, a complete family and personal medical history was recorded. The project of the study was in accordance with the Declaration of Helsinki and received approval from the Balearic Islands Clinical Research Ethical Committee.All anthropometric measurements were made in the morning after an overnight fast, and according to the recommendations of the International Standards for Anthropometric Assessment [42]. Body weight (electronic scale Seca 700; Seca, Hamburg, Germany), height (stadiometer Seca 220cm), and abdominal waist circumference (Lufkin Executive Thinline W606, precision 1mm) were determined according to recommended techniques mentioned above. Body mass index (BMI) was calculated as weight (kg) divided by height (m) squared. BMI values were categorized following the criteria from WHO [39].Blood samples were collected during the same session and in the same place after an overnight fast of 12h. Serum was obtained and total cholesterol, HDL cholesterol, glucose, and triglycerides were measured using an automated analyzer (Technicon DAX system). Blood pressure was measured with a calibrated automatic sphygmomanometer (Omron M3). Measurements were repeated three times with a pause of 1min between measurements and the average value was recorded. To calculate physical activity practice, self-reported number of sessions of physical activity per week was obtained.The presence of metabolic syndrome (MS) was ascertained by using the criterion suggested by the National Cholesterol Educational Program Adult Treatment Panel III (NCEP ATP III). The Framingham equation calibrated for the Spanish population (Framingham-REGICOR) was used to determine the cardiovascular risk at 10 years (software tool calcumedplus, available at http://www.fisterra.com). Classification of the participants in the study according to cardiovascular disease (CVD) risk was the Framingham-REGICOR guidelines:>10% High risk CVD, 5–9.9% Moderate risk CVD, <5% Low risk CVD [43].The heart age was calculated using the Heart Age Calculator, available at http://www.heartage.me. Cardiovascular lost years (CVLY) is defined as the difference between the heart age and the chronological age [44]. CVLY takes the values: First Quartile [−20, −4], Second Quartile [−3, 3], Third Quartile [4, 12], and Fourth Quatile [13, 20].With slight differences between them, the parameters required for calculating the Framingham-REGICOR score and the heart age are: age, sex, height (in centimeters), weight (in kilograms), waist circumference (in centimeters), familiar history of cardiovascular diseases, the presence or absence of diabetes, smoking habit, total cholesterol and HDL-cholesterol levels, and systolic pressure or antihypertensive treatment [45].To obtain a BN, it is necessary to determine a structure (defined by a DAG) and the conditional probabilities assigned to each node of the DAG. Therefore, to learn a BN implies two tasks: (i) structural learning, that is, the identification of the topology of the BN, and (ii) parametric learning, that is the estimation of numerical parameters (conditional probabilities) given a network topology.The problem of discovering the causal structure increases with the number of variables [46–48]. Table 1shows a description of the variables considered.We are interested in obtaining a DAG, so only three possible connections are considered. The number of different structures, f(n), grows more than exponentially in the number of nodes, in [49] the following efficiently computable recursive function is given in Eq. (2):(2)f(n)=∑i=1n(−1)i+1n!(n−1)!n!2i(n−1)f(n−1)There are two approaches to structure learning that could basically be considered [50]: (i) search-and-score structure learning, and (ii) constraint-based structure learning; combination of both gives a hybrid learning framework. Search-and-score search algorithms assigns a number (score) to each BN structure, and then the structure model with the highest score is chosen. Constraint-based search algorithms establish a set of conditional independence analysis on the data [51]. Using this analysis an undirected graph could be generated. Taking into account additional independence test, the network is transformed into a BN. Hybrid algorithms combine aspects of both constraint-based and score-based algorithms, they use conditional independence test to reduce the search space and network score to find the optimal network in the reduced space.In order to obtain the DAG, we used the bnlearn package [52,53] of R language [54]. As there are many structures that are consistent with the same set of independencies, prior knowledge of the system under study was taken into account in model selection process; to choose a structure that reflects the causal order and dependencies, that is those causes are parents of the effects, are considered structures that tend to work well [1], causal graphs tend to be sparser. Causality would be in the world, not in the inference process.We included our prior knowledge of the system under study into the model selection process, thus variables were divided into four blocks: (1) background variables={Gender, Age}, (2) conditional variables={Smoking, PA}, (3) intermediate variables={BMI, TG, WC, HDL, BP, Glucose}, and, 4) diagnostic variables={CVLY, CVRS, MetS}. We restricted the model selection process by blacklisting arrows that point from a later to an earlier block [55]. To obtain the structure, two options either select a single best model or obtain some average model, which is known as model averaging[56]. Our model was learnt by hill-climbing (hc) algorithm. The final model was obtained repeating several times structure learning, a large number of network structures were explored (500BNs) to reduce the impact of locally optimal (but globally suboptimal) networks on learning. The networks learned were averaged to obtain a more robust model. The averaged network structure was obtained using the arcs present in at least 85% of the networks, which gives a measure of the strength of each arc and establishes its significance given a threshold (85%) (see Fig. 1).Parameters were obtained again with the bnlearn package in R language by performing a Bayesian parameter estimation using the Dirichlet distribution [57].A conditional probability distribution is obtained for each node. In Table 2an example of conditional probability distribution is shown.Although the bnlearn package in R allows us to make inference, in order to have a clear graphical representation from the structure and parameters obtained with bnlearn in R language the BN was implemented in Netica [58]. The compiled network is represented in Fig. 2. The joint probability distribution of the BN in Fig. 2 requires the specification of 13 conditional probability tables, one for each variable conditioned to its parents’ set.As we can observe in Fig. 2, CVLY and CVRS variables have a direct connection, and both are connected to MetS variable through different trails, e.g., MetS variable is connected to CVLY variable through BP variable (BP is a common cause), once BP is instantiated the connection via this trail is broken), and MetS variable is also connected to CVRS variable through TG variable (it is also a common cause, once TG variable is instantiated the connection via this trail is broken), however there are other possible trails such as: MetS ← HDL ← Gender → CVLY, MetS ← WC ← Gender → CVLY → CVRS, etc.The final BN obtained from the data set shows a High likelihood in Low value of CVRS variable, a High likelihood in No value of MetS variable, a High likelihood in normal value of Glucose variable, a High likelihood in Normal value of TG variable, a high likelihood in Normal value of BP variable, a high likelihood in Normal value of HDL variable, a high likelihood in Normal weight values of BMI variable, a high likelihood in Normal value of WC variable, a high likelihood in Never value of Smoking variable, and similar likelihoods in the different labels of CVLY and PA variables.The BN was validated using a 10-fold cross-validation for BN, using a log-likelihood loss function, obtaining an expected loss of 9.3895. In Table 3, the area under the ROC curve (AUC), and the percentage correctly classified for the different features is shown.In order to provide reference benchmarks about how our BN classifies, we also report other classification performances (see Table 4) obtained by the widely used Naïve Bayes (NB), Tree Augmented Naïve Bayes (TAN), Multilayer Perceptron (MLP), and the C4.5 decision tree algorithm integrated in WEKA [59]. Only the diagnostic features (CVLY, CVRS, MetS) were considered as a comparative example. Performance of each classification model is evaluated using three statistical measures: accuracy, sensitivity and specificity.Learning a BN from data is a form of unsupervised learning, in the sense that the learner does not distinguish the class variable from the attribute variables in the data [60]. We compare our BN with several supervised learning algorithms: NB, TAN, MLP, and the C4.5 decision tree.NB and TAN classifiers are special types of BN, where a supervised learn is performed. NB is a probabilistic graphical classifier based on Bayes theorem which uses very strong assumptions on the independence between the predictor variables. The NB model assumes that instances fall into one of a number of mutually exclusive classes, and it is the simplest BN classifier, where the predictive variables are assumed to be conditionally independent given the class. The performance of NB is surprising, since this assumption is unrealistic. The TAN classifier [60] extends the NB model with a tree-shape graph across the predictor variables. TAN model is similar to NB except that each predictor variable is allowed to depend on other predictor variable in addition to the class. This model provides more information than the NB model as it is included information about the relationship among all predictor variables. MLP is a feedforward artificial neural network model which consists of multiple layers of nodes in a directed graph, with each layer fully connected to the next one. C4.5 algorithm is a decision tree induction method develop by Quinlan [61].The major advantage of BN is the ability to represent and hence understand knowledge. Our BN model gives the best classification performances. Furthermore their graphical representation is very informative.BNs are used to calculate new probabilities when new information is obtained [8]. Given the evidence E=e, our goal is to find the most likely assignment to the variables in U=complementary(E), see Eq. (3):(3)MAP(U∣e)=argmaxuP(u,e)There are two main types of queries: (1) in a probability query, we try to find the most likely assignment to a single variable, i.e. to compute P(X∣e); (2) in a MAP query, we find the most likely joint assignment to the variables in U. In order to introduce evidence in the network we have selected three reasoning patterns: causal reasoning, evidential reasoning, and intercausal reasoning.Causal reasoning takes place when we predict effects from causes (an so we proceed from top to bottom). We instantiate one variable at each a single step. In step 1 Gender variable is instantiated either to Men or Women, in step 2 Smoking variable is instantiated to Current Smoker or Never Smoker, in step 3 physical activity (PA) variable is instantiated to Practice or No Practice, in step 4 Age variable is instantiated to 35–44, in step 5 Age variable is instantiated to 45–54, and in step 6 Age variable is instantiated to 55–64.In Fig. 3, a summary about how the different quartiles of CVLY variable changes at each step is shown. Taking into account the conditional variables (Smoking and physical activity) the one with greatest influence on cardiovascular lost years CVLY is the smoking habit, obtaining two clear patterns: (1) When Smoking is in the Never state, Fig. 3 shows that the highest probability is achieved for first quartile Women follow by the second and third quartiles in Men. Adding physical activity PA variable in the Practice state shows a decrease in the probability for fourth quartile in Men and Women, showing slower values in Women; and also, an increase in the probability for first quartile in Women and for second quartile in Men; and (2) When Smoking is in the Current state, Fig. 3 shows that the highest probability is achieved for fourth quartile Men followed by the third quartile Women. Fig. 3 also shows an improvement of the situation when physical activity is instantiated to Practice and if the group of the youngest population is considered, being the group of Men with the highest risk.From Fig. 4, we can differentiate two patterns taking into account whether the subjects practice physical activity or not (PA variable). When physical activity (PA variable) is instantiated to Practice we obtain the highest probability in the No state for Metabolic Syndrome (MetS variable), showing that Smoking variable does not have any influence and the group of Women were the most privileged (with the highest probability for Mets variable in the No state). However, when Physical Activity (PA variable) is instantiated to No Practice we observe that for Metabolic Syndrome (MetS variable) in the Yes state the probability increases, showing that the Smoking variable does not have any influence again. The group with the highest risk of getting MetS=Yes is the group of Men.From Fig. 5when physical activity is instantiated to Practice we obtain similar probabilities for CVRS variable independently of whether the subject smokes or not. Similarly when physical activity is instantiated to No Practice.Queries, where we reason from effects to cases (from bottom to up), are instances of evidential reasoning or explanation.Mets and CVRS variables are instantiated to values Yes and High respectively. We observe how the probability of the different variables changes. CVLY variable increases its Fourth quartile value from 22.4% to 90%. BP variable increases its Mild value from 16.1% to 44.5%, and decreases its Optimal value from 46.8% to 3.28%. TG variable achieve similar likelihoods for all its values: Normal, Limit and Hyper. HDL variable increases its High value from 16.8% to 69.1%. WC variable increases its Very High value from 26.6% to 68.8%. BMI variable decreases its Normal Weight value from 43.2% to 11.1%, and increases the probability of Overweight GII from 19.9% to 28.4%, and the probability of Obesity T1 from 12.6% to 33.7%. The PA variable increases the probability of the No Practice value from 52.3% to 89.7%. The Glucose variable increases its High value from 12.8% to 31.5%. The Gender variable increases its Men value from 44.0% to 78.5%. The Age variable increases its 55–64 value from 14.6% to 50.7%. Fig. 6shows the probability variations.In Shannon [62] theory, entropy of X is the lower bound on the average number of bits that are needed to encode values of X. Another way of viewing the entropy is as a measure of our uncertainty about the value of X, i.e., little uncertainty about X will produce a low entropy value.A natural question is what is the cost of encoding X if we are already encoding Y. The conditional entropy of X given Y is(4)HP(X|Y)=EPlog1P(X|Y)=∑P(X|Y)·log1P(X|Y)which captures the additional cost (in terms of bits) of encoding X when we are already encoding Y. Note that the maximum value of probability in P(X|Y) implies the lowest entropy value.For MetS, CVLY, and CVRS features we are interested in determining and ordering the state values for conditioned features such as we obtain the maximum probability value in some states, which will lead to achieve the minimum conditioned entropy.When different causes of the same effect can interact we talk of intercausal reasoning, which constitutes a very common pattern in human reasoning.Furthermore, BNs are able to produce probability estimates, in this sense we are interested in knowing the features with highest influence in maximizing MetS, CVLY, and CVRS in some of their states.We maximize MetS feature probability in a Yes state. To achieve it, we consider the Markov blanket of MetS variable, it is composed of the four following variables: WC, HDL, BP and TG. We choose from each step the variable and the state that induces the greatest increase in the conditional probability of MetS variable in a Yes state. A summary is shown in Table 5and Fig. 7. Given the Markov blanket of the MetS variable, the global Markov property states that the MetS variable is conditionally independent of any other variable.Again, we maximize the MetS variable probability in a No state. We choose at each state the variable and the state that most increases the probability of the MetS variable in a No state. A summary is shown in Table 6and Fig. 8.We maximize CVLY feature probability in First Quartile state. To achieve it, we consider the Markov blanket of CVLY variable, it is composed of the six following variables: CVRS, Gender, Age, Smoking, BP, and HDL. We choose from each step the variable and the state that induces the greatest increase in the conditional probability of CVLY variable in First Quartile state. Age feature has not been included, because it does not increase the probability of CVLY in First Quartile once BP, HDL, Smoking, Gender and CVRS features are instantiated. A summary is shown in Table 7. Given the Markov blanket of the CVLY variable, the global Markov property states that the CVLY variable is conditionally independent of any other variable.Again, we maximize CVLY feature probability in a Second Quartile state. The order of features is: Smoking, BP, HDL, Gender, CVRS, and Age. Achieving a maximum probability value of 68% for CVLY feature in Second Quartile value. A summary is shown in Table 8.Again, we maximize CVLY feature probability in a Third Quartile state. The order of features is: BP, HDL, Smoking, Gender, CVRS, and Age. Achieving a maximum probability value of 79% for CVLY feature in Third Quartile value. A summary is shown in Table 9.Finally, we maximize CVLY feature probability in a Fourth Quartile state. The order of features is: BP, and Smoking. Achieving a maximum probability value of 100% for CVLY feature in Fourth Quartile value. A summary is shown in Table 10.We maximize CVRS feature probability in a Low state. To achieve it, we consider the Markov blanket of CVRS variable, it is composed of the three following variables: CVLY, Age, and Gender. We choose from each step the variable and the state that induces the greatest increase in the conditional probability of CVRS variable in a Low state. The order of features is: CVLY, Age and, Gender. Achieving a maximum probability value of 100% for CRVS feature in Low value. A summary is shown in Table 11. Given the Markov blanket of the CVLY variable, the global Markov property states that the CVRS variable is conditionally independent of any other variable.Again, we maximize CVRS feature probability in a Moderate state. The order of features is the same that the case before: CVLY, Age and, Gender. Achieving a maximum probability value of 34.4% for CRVS feature in Moderate value. A summary is shown in Table 12.Finally, we maximize CVRS feature probability in a Low state. The order of features is the same that the cases before: CVLY, Age and, Gender. Achieving a maximum probability value of 11.9% for CRVS feature in High value. A summary is shown in Table 13.

@&#CONCLUSIONS@&#
BNs have been chosen in order to produce an intuitive, transparent, graphical representation of the investigated interdependencies. The obtained model helps us to easily identify the relationships of probabilistic causal dependencies and conditional independencies between features. As a result, we can then visualize the relationships between 13 features in the domain of cardiovascular risk. In this case, due to CVD is multifactorial, the application of this kind of networks is of special interest, both from theoretical and practical point of view.Furthermore, the implemented BN was used to make inferences i.e., to predict new scenarios when hypothetical information was introduced. Adding evidence like different CVRF values in the implemented BN may be of great interest in epidemiological studies. To make a BN analysis three reasoning patterns were considered: causal, evidential and intercausal reasoning. Combining the reasoning patterns together with local and global Markov properties and the concept of Markov blanket some features were optimized.