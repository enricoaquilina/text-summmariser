@&#MAIN-TITLE@&#
An exact algorithm for the static rebalancing problem arising in bicycle sharing systems

@&#HIGHLIGHTS@&#
A routing optimization problem arising in bicycle sharing systems is studied.The first exact algorithm for the problem is proposed.The underlying formulation is developed using a variable transformation from general integer to binary variables.The algorithm is a branch-and-cut algorithm that uses combinatorial Benders’ cuts.Instances with up to 60 stations are solved to optimality.

@&#KEYPHRASES@&#
Bicycle sharing systems,Pickup and delivery,Multiple visits,Branch-and-cut,

@&#ABSTRACT@&#
Bicycle sharing systems can significantly reduce traffic, pollution, and the need for parking spaces in city centers. One of the keys to success for a bicycle sharing system is the efficiency of rebalancing operations, where the number of bicycles in each station has to be restored to its target value by a truck through pickup and delivery operations. The Static Bicycle Rebalancing Problem aims to determine a minimum cost sequence of stations to be visited by a single vehicle as well as the amount of bicycles to be collected or delivered at each station. Multiple visits to a station are allowed, as well as using stations as temporary storage. This paper presents an exact algorithm for the problem and results of computational tests on benchmark instances from the literature. The computational experiments show that instances with up to 60 stations can be solved to optimality within 2 hours of computing time.

@&#INTRODUCTION@&#
Urban transportation is a critical issue in large cities due to the dramatic increase and agglomeration of citizens and services in city centers. Congestion is a frequent and major issue and the associated decision problems are highly complex. Since the Buchanan report (Buchanan, 1963), civil engineers proposed many effective techniques to mitigate the effects of urbanization on traffic. Shared mobility systems offer one of the most promising solutions and have the potential to reduce congestion in urban areas. In particular, bicycle sharing systems proved to be an effective solution to solve the “last mile” problem (Liu, Jia, & Cheng, 2012).De Maio (2009) surveys the development of bicycle sharing systems starting from the 1960s, when Witte Fiesten (white bicycles) were first introduced in Amsterdam. Although this first generation of shared bicycles did not prove to be successful, the second generation of bicycles introduced in Denmark in the early 1990s was more effective, due to stronger and dedicated bicycles and coin-based payment systems. The third generation was first introduced in 1996 at the University of Portsmouth in the UK, where students could rent a bicycle using a smart card. This generation of bicycles proved to be a success, drastically reducing the number of thefts and damaged bicycles. It quickly became clear that IT tools capable of tracking bicycles, storing information about their usage and data about the users were necessary to improve the quality of service and decrease the rate of stolen/damaged bicycles. De Maio (2009) reports about 120 bicycle sharing systems running as of 2009, some of which consist of tens of thousands of bicycles. Impressive results in terms of increased bicycle usage, reduced CO2 gas emissions, and consequent public health improvements are also reported. The efficiency of bicycle sharing systems largely depends on the effectiveness of operational strategies implemented by the network operators.One of the key requirements identified by De Maio (2009) for the fourth generation of bicycle sharing systems is a good redistribution system. Despite initiatives aimed at promoting users to redistribute bicycles, the most common technique implemented to relocate bicycles from areas of high supply/low demand to areas of low supply/high demand is using trucks. The use of large trucks can be expensive and have a heavy CO2 footprint, therefore many cities migrate to electric vehicles or start using vehicle routing optimization software to decrease the transportation costs and fuel consumption.In this paper, we study the Static Bicycle Rebalancing Problem (SBRP), introduced by Benchimol, Benchimol, Chappert, De La Taille, Laroche, Meunier, and Robinet (2011). The SBRP aims to find a minimum cost route for a vehicle that starts and ends its service at a depot, and restores the inventory level at every bicycle station to its target value by picking up and delivering bicycles as necessary. The vehicle may visit any station more than once, and may use stations as temporary storage for bicycles (i.e., preemption). The term static refers to the assumption that the number of bicycles at each station is known in advance and does not change during the pickup and delivery operations, as opposed to dynamic problems in which the number of bicycles may change during the operations due to users renting and returning bicycles. The SBRP is of interest for many bicycle sharing systems that rebalance the stations during the night. Although the SBRP has been studied by Chemla, Meunier, and Wolfler Calvo (2013), the authors succeeded in providing a strong lower bound and an effective heuristic solution method, but not an exact algorithm. In this study, we propose an exact algorithm for the SBRP and present extensive computational results on benchmark instances from the literature.The remainder of this paper is organized as follows. In Section 2, we provide a survey of the literature on bicycle rebalancing problems arising in bicycle sharing systems. In Section 3, we present the mathematical problem definition of the SBRP. In Section 4, elements of the exact algorithm for the SBRP are stated. In Section 5, we present a simple heuristic for generating upper bounds. In Section 6, we provide the results of our computational experiments. Finally, we give our concluding remarks in Section 7.There is an increasing interest in optimization problems arising in bicycle sharing systems. Among the problems studied are the integration of bicycle sharing systems with other transportation systems (Chow & Sayarshad, 2014), the problem of reserving parking spaces in one-way vehicle sharing systems (Kaspi, Raviv, & Tzur, 2014), the dynamics of bicycles usage during the day (Agatz, Erera, Savelsbergh, & Wang, 2011), and the effects of fuel price variations on the bicycles usage (Smith & Kauermann, 2011). Recently, bicycle rebalancing problems have received a significant amount of interest from the research community. Given the high degree of complexity, metaheuristics have been proposed to tackle larger instances and problems with multiple vehicles. We refer the interested reader to the heuristic papers by Rainer-Harbach, Papazek, Raidl, Hu, and Kloimüllner (2014), Papazek, Raidl, Rainer-Harbach, and Hu (2013), Gaspero, Rendl, and Urli (2013), and Schuijbroek, Hampshire, and van Hoeve (2013). In what follows, we will focus on the studies about exact methods for bicycle rebalancing problems.Nair and Miller-Hooks (2011) study the dynamic problem of rebalancing a shared mobility system by using stochastic programming, where the demand at each station is modeled using a set of scenarios. Their modeling approach uses chance constraints, which guarantee that a given percentage of scenarios will be satisfied by the redistribution plans. The objective is to minimize the redistribution costs. However, this model does not return any operational routing decisions. Contardo, Morency, and Rousseau (2012) solve the dynamic rebalancing problem that aims to minimize the overall unmet demand, using a flow formulation defined on a space–time network. The formulation is solved by means of a Benders decomposition embedded in a column generation framework. We refer the interested reader to Chemla, Meunier, Pradeau, Wolfler Calvo, and Yahiaoui (2013) for further reading on dynamic problems.Raviv, Tzur, and Forma (2013) study the multi vehicles static rebalancing problem, in which the objective is to simultaneously minimize the routing cost and the customer dissatisfaction. The latter is modeled using a piecewise linear convex function of the number of bicycles at stations. The customer dissatisfaction function for a station attains its maximum when the station is full (the customers would not be able to return their bicycles) or empty (the customers would not be able to rent a bicycle). It is assumed that stations are visited at most once, service times are taken into account and the overall trip duration of each vehicle is bounded. The authors present two mathematical formulations, dominance rules, and valid inequalities. Their formulations are tested on artificial instances with up to 60 stations and one or two vehicles. The authors also introduce instances inspired by the Capital Bikeshare in Washington DC with up to 104 stations. Both formulations struggle to solve instances with two vehicles with respect to a single vehicle. Moreover, the authors point out that the constraint of a single visit is restrictive and may considerably limit the quality of the solutions achieved.Chemla, Meunier, and Wolfler Calvo (2013) propose a mathematical formulation for the SBRP defined over a time-expanded graph, in which each station is replicated as many times as an upper bound on the number of visits possible to the station. The formulation uses four index variables and becomes intractable for medium-sized instances of SBRP. Therefore, the authors introduce two relaxations, the first of which uses two sets of two-index variables corresponding to the number of times each arc is traversed and the number of bicycles being carried on each arc, respectively. The second relaxation uses only variables representing the number of times an arc is traversed. The two relaxations are proven equivalent, but the linear relaxation of the second provides higher quality lower bounds, due to stronger capacity constraints. A Tabu Search algorithm is also developed and a set of benchmark instances is generated, with up to 100 stations to be visited. The authors report that the current number of stations visited in Paris by a vehicle with capacity Q = 20 bicycles is typically 50, with each station having capacity 30 bicycles. The gaps between the best upper bound solutions and lower bounds is roughly 2% for realistic-sized instances and up to 5% for instances with up to 100 stations.Erdoǧan, Laporte, and Wolfler Calvo (2014) extend the single vehicle static rebalancing problem by assuming that the number of bicycles at a station after the repositioning should lie within a given interval rather than a specific target number, and a station can be visited at most once. The authors solve the problem exactly using two methods, a Benders decomposition based branch-and-cut algorithm and a traditional branch-and-cut algorithm. Drawing upon the similarity of the problem with the One Commodity Pickup and Delivery Traveling Salesman Problem (1-PDTSP), they adapt valid inequalities studied in depth by Hernández-Pérez and Salazar-González (2004, 2007). Instances with up to 50 stations have been solved to optimality, and the Benders decomposition based branch-and-cut is observed to outperform the traditional branch-and-cut algorithm.Dell’Amico, Hadjicostantinou, Iori, and Novellani (2014) solve the multi vehicle static problem where the overall transportation cost is minimized and each station has to be visited exactly once. Four alternative mixed integer linear mathematical formulations are compared and inequalities are used to strengthen the formulations.We now provide a mathematical definition of the SBRP. We are given a complete directed graph G = (V, A). The vertex set V = {0, 1,…, n} consists of the depot (vertex 0, arrival and departure node for the vehicle) and the bicycle stations V∖{0}. The number of bicycles at a station i ∈ {1,…, n} is initially pi, the target number of bicycles is qi, and the capacity of station i is Ci. Note that the capacity is necessary because preemption is allowed. Therefore, stations that are initially balanced (i.e., pi= qi) could also be visited with the purpose of temporarily parking or collecting bicycles. Each arc (i, j) has an associated travel cost cij, which may represent the fuel consumption, the travel time, or the CO2 emission. The vehicle can carry at most Q bicycles at a time. The objective is to minimize the overall solution cost, ensuring that the vehicle departs and arrives at the depot and the target number of bicycles is allocated to each station at the end of the tour.The SBRP has been proven to beNP-hard by Benchimol et al. (2011), as well as its special cases for complete graphs and bipartite graphs with unit costs. The authors also propose a 9.5-approximation algorithm for the general case, a 2-approximation algorithm for the special case with a complete graph and unit costs, as well as lower bounding techniques. Chemla, Meunier, and Wolfler Calvo (2013) demonstrate that the problem of verifying if a sequence of vertices starting and ending at the depot for an instance of SBRP represents a feasible solution is a search problem (i.e., a polynomial time algorithm is capable of finding a feasible assignment of bicycles on the vehicle for each arc traveled, if any feasible assignment exists). On the other hand, if the only information available to represent a solution is the number of times each arc in the network is traversed, the problem of determining if this information corresponds to a feasible solution isNP-complete.We now present a simplified version of the second relaxation of SBRP by Chemla, Meunier, and Wolfler Calvo (2013), which will serve as a stepping stone to a complete formulation. The authors define the imbalance of station i ∈ V as di= pi− qi, the net imbalance of a subset of stations S ⊆ V∖{0} as d(S) = ∑i ∈ Sdi, and introduce a function μ(S) that is equal to 1 if there is at least one station i ∈ S such that |di| > 0, and 0 otherwise. Based on these definitions, they use two separate sets of constraints for connectivity and capacity. These two sets of constraints can be expressed as a single set by defining and using a single function to compute the minimal vehicle requirement of station set S ⊆ V∖{0} as(1)r(S)=max{⌈|d(S)|/Q⌉,μ(S)}.Furthermore, we share the definitions of δ+(S) = {(i, j) ∈ A: i ∈ S, j∉S} and δ−(S) = {(i, j) ∈ A: i∉S, j ∈ S}. Let xijbe equal to the number of times arc (i, j) ∈ A is traversed. We write x(S) to denote ∑(i, j) ∈ Sxij. Chemla, Meunier, and Wolfler Calvo (2013) prove that an arc between two stations with both positive or both negative imbalance values need not be traversed more than once. When the travel costs respect the triangle inequality, we observe that for arcs (i, j) ∈ A: di> 0, dj< 0 or di< 0, dj> 0, the maximum number of traversals is equal to the minimum of the absolute values of the imbalances (i.e., at least one bicycle is transported at each pass). Hence, we denote the maximum number of times an arc can be traversed as(2)uij={min{|di|,|dj|}di>0,dj<0ordi<0,dj>0,1otherwise.The resulting relaxation is:(SBRP-R)(3)minimize∑(i,j)∈Acijxij(4)subjecttox(δ−(i))=x(δ+(i))(i∈V),(5)x(δ+(0))≥max{⌈|d0|/Q⌉,1},(6)x(δ+(S))≥r(S)(S⊆V∖{0}),(7)xij∈{0,…,uij}((i,j)∈A).The objective function (3) minimizes the total travel cost. Constraint set (4) are the well-known flow conservation constraints. Constraint set (5) sets the minimum number of trips out of the depot. Constraint set (6) imposes the lower bounds for the number of times the vehicle must leave set S. Finally, constraint set (7) states the integrality constraints as well as the upper bounds on the variables.There are two shortcomings of (SBRP-R) that prevent it from being a complete formulation. Firstly, as stated in the previous section, proving that an integral solution for (SBRP-R) is feasible for the SBRP is an NP-complete decision problem. Secondly, There is no straightforward method to separate an integer solution that is found to be infeasible for the SBRP. To observe this, assume that we have such a solution x*. To separate this solution, the following constraint should be added to the constraint set.(8)∑(i,j)∈A|xij−xij*|≥1.Note that (8) is nonlinear, and there is no efficient method to linearize it for general integer variables. For binary variables, it is possible to linearize it by using|xij−xij*|=xijforxij*=0,and|xij−xij*|=1−xijforxij*=1. To utilize this linearization, we use the following transformation that converts general integer variables with finite upper bounds into a set of binary variables:(9)xij=∑k=0⌊log2(uij)⌋2kyijk,where yijk∈ {0, 1},  ∀(i, j) ∈ A, k ∈ {0,…, ⌊log2(uij)⌋}. Note that for uij: log2(uij) = ⌊log2(uij)⌋, the transformation allows for∑k=0⌊log2(uij)⌋2kyijk>uij,but the upper bounds uijare provided to speed up the algorithm rather than feasibility.Given an integer solution y*, let us defineI0(y*)={(i,j,k):yijk*=0},i.e. the set of indices for the variables equal to 0. Similarly, we defineI1(y*)={(i,j,k):yijk*=1},i.e. the set of indices for the variables equal to 1. Finally, we define the infeasibility indicator function If(y*) that returns 1 if y* is an integer solution that is infeasible for the SBRP, and 0 otherwise. Based on these definitions, it is possible to separate an integer solution that is infeasible for the SBRP with a combinatorial Benders’ cut (Codato & Fischetti, 2006):(10)∑(i,j,k)∈I0(y*)yijk+∑(i,j,k)∈I1(y*)(1−yijk)≥1,(y*:If(y*)=1).A similar approach has been independently developed and used by Chen, Hoàng Hà, Langevin, and Gendreau (2014), to linearize chance constraints for a model that optimizes road network daily maintenance operations with stochastic service and travel times. We are now ready to state the complete formulation for the SBRP.(SBRP1)(11)minimize∑(i,j)∈Acij∑k=0⌊log2(uij)⌋2kyijk(12)subjectto∑j:(j,i)∈δ−(i)∑k=0⌊log2(uji)⌋2kyjik=∑j:(i,j)∈δ+(i)∑k=0⌊log2(uij)⌋2kyijk(i∈V),(13)∑j:(0,j)∈δ+({0})∑k=0⌊log2(u0j)⌋2ky0jk≥max{⌈|d0|/Q⌉,1},(14)∑j:(i,j)∈δ+(S)∑k=0⌊log2(uij)⌋2kyijk≥r(S)(S⊆V∖{0}),(15)∑(i,j,k)∈I0(y*)yijk+∑(i,j,k)∈I1(y*)(1−yijk)≥1(y*:If(y*)=1),(16)yijk∈{0,1}((i,j)∈A,k∈{0,…,⌊log2(uij)⌋}).As in SBRP-R, the objective function (11) minimizes the total travel cost, constraint set (12) are the flow conservation constraints, constraint set (13) states the minimum number of trips out of the depot, and constraint set (14) imposes the lower bounds for the number of times the vehicle must leave S. Constraint set (15) separates integer feasible solutions that are not feasible for the SBRP. Finally, (16) state that all variables yijkare binary. To separate constraint set (14), we have used the separation algorithms described in Hernández-Pérez and Salazar-González (2007) for the 1-PDTSP. The separation algorithm for (15) is described in detail in the next section.In this section, we provide the algorithm for separating the combinatorial Benders’ cuts, and propose a modification of the separation algorithm that allows for the solution of the SBRP in which preemption is not allowed.The optimal solution of SBRP1 for the test instance n20q10C from the benchmark instance set of Chemla, Meunier, and Wolfler Calvo (2013) is depicted in Fig. 1, where the number of arcs from i ∈ V to j ∈ V is computed asxij=∑k=0⌊log2(uij)⌋2kyijk. Next to each vertex are the initial and target inventory levels corresponding to the vertex. Vertices 2, 10, 12, and 16 have an indegree of 2, whereas the rest of the vertices are visited only once. As stated in the previous section, checking if this solution corresponds to a feasible solution for the SBRP is an NP-complete decision problem. We now provide an algorithm for checking the feasibility of an integer feasible solution of SBRP1 for SBRP.The algorithm is based on two observations. Firstly, any solution for the SBRP that traverses the arcs of a solution of formulation SBRP1 corresponds to an Eulerian circuit starting and ending at the depot, on the graph defined by xij. Secondly, an Eulerian circuit starting and ending at the depot can be represented as a time-extended network, where the time dimension of the vertices are defined by the order they are visited in. The feasibility of the SBRP solution can be checked by solving a flow problem on this network. Based on these observations, we can conclude that an exact separation algorithm for constraint set (15) should enumerate (implicitly or explicitly) all Eulerian circuits for an SBRP1 solution and check the feasibility of each Eulerian circuit by solving a flow problem on the corresponding time-extended network. A solution is declared feasible if at least one Eulerian circuit it contains has a feasible solution for the corresponding flow problem. Otherwise, the solution can be separated by adding an inequality from the constraint set (15).We first present the method of constructing the time-extended network for the flow problem for a given Eulerian circuitC¯={0,v1,v2,…,0}. The reader can refer to the examples depicted in Fig. 2 corresponding to the SBRP1 solution in Fig. 1. In Fig. 2, there is one graph for every Eulerian circuit corresponding to the SBRP1 solution in Fig. 1. In each graph, the vertices are aligned to their indices presented on the left. A separate flow problem will be solved for each one of these graphs, and the feasibility of only one will suffice to prove feasibility of the solution. Denote the time-extended network of each graph in Fig. 2 asG^=(V^,A^1∪A^2). For the kth vertex inC¯,place a vertex j inV^,denote its parent vertex as π(j), and its sequence number as σ(j) = k. If a vertex i ∈ V occurs only once inC¯,set the supply/demand value of the corresponding vertex inj∈V^to bj= pi− qi. If vertex i ∈ V occurs twice or more in the circuit, set the supply/demand value of the first occurrence to bj= pi, the last occurrence to bk= −qi, and the remaining occurrences to bl= 0. Add an arc (i, j) of capacity Q toA^1,∀i,j∈V^:σ(j)=σ(i)+1. Finally, add an arc (i, j) of capacity Cπ(i) toA^2,∀i,j∈V^:π(i)=π(j),σ(j)=mink∈V^:π(k)=π(i),σ(k)>σ(i)σ(k). Defining zijas the amount of flow on arc(i,j)∈A^1∪A^2,the resulting flow problem can be stated as:(TEFP)(17)minimize0(18)subjecttoz(δ+(i))−z(δ−(i))=bi(i∈V^),(19)zij≤Q((i,j)∈A^1),(20)zij≤Cπ(i)((i,j)∈A^2),(21)zij≥0((i,j)∈A^1∪A^2).The objective function (17) is empty since TEFP is a feasibility problem. Constraint set (18) enforces the flow conservation for the bicycles at each station. Constraint sets (19) and (20) are the capacity constraints for the vehicle and stations, respectively. Finally, constraint set (21) consists of the nonnegativity constraints. Note that the size of the networkG^is determined by the supply/demand values as well as the number of vertices, which may be of exponential size, inhibiting a polynomial time complexity.The flow conservation constraints of SBRP1 ensure that an Eulerian circuit exists for every integral solution. However, there may exist an exponential number of Eulerian circuits in a given digraph (Tutte, 2001). We now provide the pseudocode of a search algorithm that solves the separation problem, by enumerating Eulerian circuits and testing their feasibility using TEFP.The global variable feasible should be initialized as false before the separation algorithm, and the algorithm should be invoked as Separation(0, 0, ∅, x*). The first step of the algorithm is to set the beginning of the Eulerian circuit as the depot, and compute the number of times each arc is traversed. Starting at the depot, the algorithm proceeds as a depth-first search, branching on the arcs leaving the current vertex. If a vertex with a positive indegree becomes unreachable from the current vertex i, the node of the search tree is fathomed due to infeasibility. Every time the algorithm traverses all the arcs (i.e. finds a Eulerian circuit), an instance of TEFP is solved and the search algorithm terminates upon finding a feasible solution. If no feasible TEFP solutions are found, the solution is declared infeasible and is separated with a combinatorial Benders’ cut. Else, the solution of the TEFP is recorded as the certificate of feasibility.We would like to emphasize that the branching order is important for the efficiency of the separation algorithm. In our computational experiments, we have found it useful to solve a network flow problem on G = (V, A), where arc capacities given by Qx*and vertex demands are given by d(i), ∀i ∈ V, to identify the feasible flow patterns. Based on the solution of the flow problem, we explore the branches in decreasing order of flow from supply vertices (di> 0), and in decreasing order of the destination vertices’ supply values from transshipment and demand vertices (di≤ 0).Thebenefits of preemptive pickup and delivery operations with respect to nonpreemptive operations are of particular interest to practitioners and academics alike. Although it is straightforward to see the advantage of using temporary storage, the trade-off between the monetary benefit and the added complexity of operations is hard to judge. In what follows, we describe a separation algorithm that identifies integral solutions that are not feasible with respect to nonpreemptive operations.Given an Eulerian circuitC¯={0,v1,v2,…,0},construct the time-extended networkG^=(V^,A^1∪A^2)as described above, along with the supply/demand values, and the capacities of all arcs. The nonpreemptive constraint requires the vertices with an imbalance of 0 not to be visited, the vertices with negative imbalance to have monotonically increasing amounts of inventory, and the vertices with positive imbalance to have monotonically decreasing amounts of inventory. Consequently, the following constraints should be added to SBRP1:(22)∑j∈V∖{i}xij=0((i,j)∈A^2,di=0).Let us denote the formulation obtained by adding constraints (22) to SBRP1 as SBRP2. In addition, the following constraints should be added to TEFP:(23)zij≥pi((i,j)∈A^2,dπ(i)<0),(24)zjk≥zij((i,j),(j,k)∈A^2,dπ(i)<0),(25)zij≤pi((i,j)∈A^2,dπ(i)>0),(26)zjk≤zij((i,j),(j,k)∈A^2,dπ(i)>0).Let us denote the formulation obtained by adding constraints (23)–(26) to TEFP as TEFP2. We now prove that although the constraints (24) and (26) impair the integrality property of TEFP2, this formulation can still be solved in polynomial time, since the existence of a fractional feasible solution implies the existence of an integer feasible solution.Proposition 1Every fractional feasible solution to TEFP2 corresponds to an integral feasible solution.Consider the graphG^=(V^,A^1∪A^2)defined in the previous subsection. To ensure that the nonpreemptive constraint is respected, we modify the graph by adding a copy of the verticesj∈V^that correspond to the visits other than the first or the last. The modification is depicted in Fig. 3, where we assume that more than two visits are taking place at station π(j) ∈ V. We name the copies as j1 and j2, and connect the associated arcs inA^1to j1 and the associated arcs inA^2to j2. For dπ(j) > 0, we place an arc from j2 to j1 that only allows flow out of the vertex π(j). Similarly, for dπ(j) < 0, we place an arc from j1 to j2 that only allows flow into the vertex π(j). We define the set of such arcs asA^3. The corresponding time-extended network flow problem has a larger number of vertices and arcs, respects the nonpreemptive constraint, but benefits from the integrality property. Consider the flow variable for an arc(j1,j2)∈A^3:dπ(j1)<0. This variable is present only in two flow conservation constraints and a nonnegativity constraint:(27)z(δ+(j1)∖{(j1,j2)})+zj1,j2−z(δ−(j1))=0,(28)z(δ+(j2))−z(δ−(j2)∖{(j1,j2)})−zj1,j2=0,(29)zj1,j2≥0.Applying Fourier–Motzkin elimination (Dantzig & Eaves, 1973) on the variablezj1,j2yields:(30)z(δ+(j2))+z(δ+(j1)∖{(j1,j2)})=z(δ−(j1))+z(δ−(j2)∖{(j1,j2)}),(31)z(δ+(j1)∖{(j1,j2)})≤z(δ−(j1)),(32)z(δ+(j2))≥z(δ−(j2)∖{(j1,j2)}.)It can be easily observed that (30) and (31) imply (32), which renders (32) redundant. Analysis of (30) and (31) shows that the Fourier–Motzkin elimination merges j1 and j2 back into j, since (30) corresponds to the original flow conservation constraint for vertex j. In addition, (31) corresponds to (24). The analysis for(j2,j1)∈A^3:dπ(j1)>0yields a similar result, showing that (26) is implied by the flow conservation and nonnegativity constraints. Due to the equivalence of the formulations, any fractional feasible solution for TEFP2 corresponds to an integral feasible solution. Hence, if the separation algorithm is executed on the integer solutions of SBRP2 by solving TEFP2 as a continuous problem, it successfully identifies integer solutions that do not satisfy the nonpreemptive constraint.□We would like to note that TEFP2 should be solved with integrality constraints for the final result of the branch-and-cut algorithm, to determine the amounts of pickup and delivery at each station.Theseparation algorithms presented in the previous section perform well for near-optimal solutions, but may perform poorly for low quality solutions. In particular, for “star-shaped” solutions, in which the degree of a vertex is much higher than the others, the branching order may not offer sufficient guidance to find a feasible solution: many infeasible solutions should be enumerated before the algorithm can conclude feasibility. To avoid this stalling behavior, we now present a greedy constructive heuristic that is slightly different from the greedy heuristic of Chemla, Meunier, and Wolfler Calvo (2013), which prioritizes exhausting the supply/demand of vertices.Starting from an empty solution, the constructive heuristic picks up/delivers the maximal possible amount at each vertex. If the vehicle is full, the next vertex is chosen as the closest vertex with negative imbalance. Else if the vehicle is empty, the closest vertex with supply becomes the next vertex to be visited. Else, the closest vertex with a nonnegative imbalance is visited. The heuristic successfully overcomes the stalling problem at the cost of less than 0.01 seconds of CPU time, and its result is feasible for both SBRP and nonpreemptive SBRP.The algorithm described in the previous section has been implemented using C++ and CPLEX 12.5, on IRIDIS 4 computing cluster consisting of 2.6 gigahertz cores with 4 gigabytes of memory per core. The result of the constructive heuristic was fed into CPLEX as a starting solution. The branch-and-cut algorithm of CPLEX was restricted to run on a single core, to enable a better analysis of the algorithm by excluding the parallel speedup.The instances used are identical to those of Chemla, Meunier, and Wolfler Calvo (2013). We replicate the details of the instance generation scheme for the sake of simplicity. Chemla, Meunier, and Wolfler Calvo (2013) adapt the instances of Hernández-Pérez and Salazar-González (2004) for the 1-PDTSP. The original instances consist of Euclidean coordinates for the vertices, and an integer demand valued˜i∈{−10,…,10}for every vertex i ∈ V. The resulting instances have pi= α × 10,qi=α×(10+d˜i),and Ci= α × 20. Chemla, Meunier, and Wolfler Calvo (2013) have experimented with α = 1 and α = 3, corresponding to small and large amounts to be relocated. The original instance set consists of 10 instances for each number of vertices |V| and vehicle capacity Q.The computational experiments have been carried out on sets of instances with |V| ∈ {20, 30, 40, 50, 60}. Due to space considerations, aggregate results are presented for α = 1 and α = 3 in Tables 1 and 2, respectively, where every row corresponds to the average results for 10 instances. Detailed results can be obtained from the authors. The column heading “Average Heuristic Gap” refers to the mean percentage deviation of the result of the constructive heuristic from the best known lower bound. Similarly, the column heading “Average Optimality Gap” refers to the mean percentage deviation of the best result of the branch-and-cut algorithm from the best known lower bound. It can be observed from Table 2 that the instances are harder for α = 3, in particular for |V| ≥ 50. This is due to the fact that more bicycles to carry result in more arcs traversed, and more Eulerian circuits. For α = 1, we were able to solve all but 1 instance with 40 vertices, 7 instances with 50 vertices, and 18 instances with 60 vertices. For α = 3, we were able to solve all instances up to 40 vertices, 69 out of 90 instances with 50 vertices, and 60 out of 90 instances with 60 vertices. The constructive heuristic consistently provided initial solutions that are 40–50 percent away from the best known lower bound, for both. We conclude that the computational reach of the algorithm is about 60 vertices.We have also solved the same set of instances for the nonpreemptive SBRP. The aggregate results are presented in Tables 3 and 4, respectively. The complexity increases significantly for |V| ≥ 40. In addition, the separation algorithm could not conclude feasibility or infeasibility for 3 instances with α = 1, and 20 instances with α = 3. We deduce that the computational reach for the nonpreemptive SBRP is approximately 40 vertices. The performance of the constructive heuristic is very similar for both SBRP and nonpreemptive SBRP. We have also compared the results of the SBRP and nonpreemptive SBRP, for |V| ∈ {20, 30, 40}. The results demonstrate that the added value of preemption is around 0.6 percent.We have also tested our algorithm on a subset of the real world instances used in the study of Dell’Amico et al. (2014), specifically the first 50 instances which involve up to 59 stations. This set of experiments have been performed on another computer with an Intel i7 CPU running at 3.60 gigahertz and 8 gigabytes of RAM. The software parameters are identical to the previous set of experiments. The demand values for this set of instances were not balanced (i.e. did not sum up to 0), so we have balanced the demand values by setting the demand of the depot to d0 = −∑i ∈ V∖{0}di. Finally, we have determined the initial level of inventory at the stations as maxi ∈ V|di|. The details of our results are provided in Tables 5–8. The performances of our algorithms are slightly better for this data set, and our observations for the previous data set are confirmed.As a final note, we observe that the longer runs for both variants are for the instances for which CPLEX fails to find a high quality solution in the early stages of the branch-and-cut algorithm. Hence, tight upper bounds supplied by a sophisticated metaheuristic algorithm may improve the performance of the exact algorithm.

@&#CONCLUSIONS@&#
