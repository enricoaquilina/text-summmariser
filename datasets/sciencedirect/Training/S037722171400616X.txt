@&#MAIN-TITLE@&#
An algorithm for moment-matching scenario generation with application to financial portfolio optimisation

@&#HIGHLIGHTS@&#
Mean, covariance, average marginal third and fourth moments are matched exactly.Scenarios and corresponding probability weights are produced without optimisation.The algorithm is used in a mean-CVaR portfolio optimisation model.Results show desirable in-sample and out-of-sample stability.Good solutions can be obtained with a relatively small number of scenarios.

@&#KEYPHRASES@&#
Scenarios,OR in banking,Finance,Stochastic programming,

@&#ABSTRACT@&#
We present an algorithm for moment-matching scenario generation. This method produces scenarios and corresponding probability weights that match exactly the given mean, the covariance matrix, the average of the marginal skewness and the average of the marginal kurtosis of each individual component of a random vector. Optimisation is not employed in the scenario generation process and thus the method is computationally more advantageous than previous approaches. The algorithm is used for generating scenarios in a mean-CVaR portfolio optimisation model. For the chosen optimisation example, it is shown that desirable properties for a scenario generator are satisfied, including in-sample and out-of-sample stability. It is also shown that optimal solutions vary only marginally with increasing number of scenarios in this example; thus, good solutions can apparently be obtained with a relatively small number of scenarios. The proposed method can be used either on its own as a computationally inexpensive scenario generator or as a starting point for non-convex optimisation based scenario generators which aim to match all the third and the fourth order marginal moments (rather than average marginal moments).One of the traditional approaches for decision-making under uncertainty and risk is stochastic programming. It has wide ranging applications such as financial planning, energy systems management, supply chain logistics, agricultural planning; an extensive discussion of these may be found in Wallace and Ziemba (2005).Stochastic programming involves optimisation problems in which (some of) the parameters are not certain, but are described by statistical distributions. In order for the stochastic programs to be numerically solved, the distributions involved are approximated by discrete distributions with a finite number of outcomes (scenarios). The approximation process, called “scenario generation”, is important for the quality of the solution obtained: using “poor” scenarios could only result in obtaining a “poor” approximation of the true optimal solution.One way to obtain scenarios is by sampling from an assumed distribution (or, simply, from historical data). As an example, future prices of financial assets may be assumed to follow a Geometric Brownian Motion, or a GARCH process (Bollerslev, 1986). Sampling methods have clear advantages; however, it may be argued that such distributional assumptions are too strong, or are only applicable to one domain, viz. finance.Other approaches to scenario generation with specific emphasis on operations research applications include principal component analysis-based simulation Topaloglou, Vladimirou, and Zenios (2002), stochastic approximation based on transportation metrics (Hochreiter & Pflug, 2007; Pflug, 2001) and hidden Markov models as in (Erlwein, Mitra, & Roman, 2012; Messina & Toscani, 2008; Roman, Mitra, & Spagnolo, 2010). A detailed survey of different scenario generation methods appears in Kaut and Wallace (2007).Another class of scenario generation methods are based on matching a small set of statistical properties, e.g. moments (e.g., see Høyland & Wallace (2001)). These methods can be broadly divided into two groups.Under the first approach, the statistical properties of the joint distribution are specified in terms of moments, usually including the covariance matrix. In Høyland, Kaut, and Wallace (2003), cubic transformation of univariate, standard normal random variables and Cholesky factorization of covariance matrix are used to produce a multivariate distribution which approximately matches a given set of marginal central moments and the covariance matrix. Similar moment matching approach is employed to generate probability weights and support points using non-convex optimisation in Gulpinar, Rustem, and Settergren (2004). In Smith (1993), entropy maximisation method is used to generate a discrete approximation to a given continuous distribution.In the second group, specified (parametric) marginal distributions are sampled independently and the samples are then used along with Cholesky factorization of the covariance matrix to generate the necessary multivariate distribution. An iterative procedure of this type in described in Lurie and Goldberg (1998), where specified marginal distributions and correlation matrix are used to produce the correlated vectors of random numbers.The moment-matching scenario generation methods have been successful in the practical applications of stochastic optimisation. They have several advantages: they are not specific to a particular field, they do not assume a specific parameterised family of distributions and allow for very different shapes of the marginals. It is only the moments that have to be specified – using historical data, predictions, specialist knowledge or a combination of these.However, the moment matching approaches described in the above papers have certain limitations.Firstly, they use non-convex optimisation to generate scenarios which match a specified set of statistical properties, in addition to a needed factorization of the covariance matrix. Given a univariate random variable with known first 12 central moments, the approach used in Høyland et al. (2003) and Høyland and Wallace (2001) finds a cubic polynomial function of this random variable which has the required four central moments. This requires a non-convex optimisation in terms of the coefficients of the polynomial. The procedure has to be repeated iteratively for each marginal distribution. Similarly, the algorithm in Lurie and Goldberg (1998) requires a non-convex optimisation over the space of lower triangular matrices.Secondly, the achieved moments of the generated samples match the target moments only approximately. There are two sources of error in these moment matching methods: one is due to the fact that only local optima are found for the non-convex optimisation problem and the other is the inexact starting moments of samples of univariate random variables. Since these procedures employ samples from a known, “simple” univariate distribution, the achieved moments usually depend on the sample moments of univariate random variables used.In Date, Jalen, and Mamon (2008), the authors developed a method which uses convex optimisation to match the given mean vector, covariance matrix exactly, and to minimise the mismatch between the marginal kurtosis across all the variables.In this paper, we propose a scenario generation method that modifies the algorithm in Date et al. (2008) to match the given mean vector, the covariance matrix, the average marginal skewness as well as average marginal kurtosis (thus catering for assymetric marginals) of each individual component of the random vector, without needing an optimisation procedure.A modified version of the same method in Date et al. (2008) was used in Ponomareva and Date (2013) in the context of nonlinear time series filtering. However, to authors’ knowledge, a moment-matching sigma point generation algorithm, which generates probability weights as well, has not been employed in the context of financial optimisation before. This algorithm may be used as a scenario generator on its own or its scalar version may be adopted to produce an initial guess for the optimisation routines proposed by other authors. Being able to match a small set of statistical properties exactly, possibly with a very small set of scenarios, may be preferable to generating a very large number of scenarios to model the entire distribution. This is especially true when the scenarios are to be used in stochastic optimisation procedures.Specifically, the proposed moment-matching scenario generation algorithm has two major advantages over the existing methods:(1)It is computationally inexpensive – generating scenarios does not involve optimisation. This is in contrast with all the other existing methods for moment matching which cater for moments higher than order two.It generates scenarios (i.e. support points of the multivariate distribution) together with corresponding probability weights, which are unequal in general. This represents a big advantage not only because it eliminates the need to attach user-defined probabilities, but also because the computational difficulty and time for solving the stochastic program can be much decreased – a relatively modest number of distinct scenarios is needed to capture the spacial properties of multivariate density surface, such as marginal tail weights and asymmetry.The significant reduction in computational complexity comes at the cost of matching only the average of third marginal moments and the average of fourth marginal moments exactly (instead of matching all third and fourth marginal moments approximately, as in Høyland et al. (2003)). However, the computational simplicity as well as stability of results demonstrated in this paper arguably outweigh this shortcoming. If better moment-matching is needed for higher order marginals, the proposed method can provide an inexpensive initial guess for another moment matching algorithm such as the one proposed in Høyland et al. (2003).We test the quality of the proposed scenario generator in a financial portfolio optimisation problem. We generate scenarios for the future asset returns and use them as parameters in an optimisation problem in which the portfolio’s CVaR (Conditional Value-at-Risk) is minimised (Rockafellar & Uryasev, 2002). We test the in-sample stability as well as out-of-sample stability of our scenario generator, using a variety of options as tuning parameters. The performance of scenario generator is also compared to using the historic returns as scenarios.The rest of the paper is organised as follows. Section 2 gives details of the algorithm for the scenario generation that matches the mean vector, the covariance matrix and the average marginal third and fourth moments. Section 3 describes the mean-CVaR model for portfolio optimisation. Computational set up, stability of the results and analysis of the optimal solutions are covered in Section 4. Conclusions are drawn in Section 5.We assume that the information about the distribution of an N-variate random vectorr=r1r2⋯rN⊤is available in terms of the following quantities being known:μtarget mean vectorΣtarget (positive definite) covariance matrixκjmarginal third central moment ofrj,j=1,2,…,Nζjmarginal fourth central moment ofrj,j=1,2,…,NLetrkjdenote the outcome ofrjunder scenario k. For notational brevity, denote the average marginal moments as1N∑j=1Nκj=κ‾,1N∑j=1Nζj=ζ‾.For example, r could represent the future returns of N assets,rkjbeing the return of asset j under scenario k. The algorithm is generic and not specific to financial portfolio applications; it is valid for generating scenarios of any random vector r with moment properties specified as above. In the light of the application considered in this paper, we will stick to notation prevalent in the financial optimisation literature.The outline of how the algorithm which follows works is as follows. An even number of scenarios,2Ns, proportional to the vector’s dimension, are generated such that they match the first and second moments. These scenarios are symmetrically distributed around the expected value such that the variance–covariance matrix is matched. Three additional scenarios are generated in order to match the average marginal skewness and the average marginal kurtosis of each individual component of the random vector r.The specific steps of the scenario generation algorithm are described next. The motivation behind these steps will be clear from the proof of Proposition 1 and the subsequent remarks later in this section.Step 1: Parameters for scenario generationScenario generation procedure has the following inputs: meanμof the random vectorr, vector’s covariance matrixΣ, dimension N and average marginal momentsκ‾andζ‾defined above. User needs to choose an arbitrary positive integer s, an arbitrary non-zero deterministic vector Z, such thatΣ-ZZ⊤>0, and a scalarρ∈(0,1). Once these are determined, the remaining parameters can be calculated as follows:α=12ϕ1+124ϕ2-3ϕ12,β=-12ϕ1+124ϕ2-3ϕ12,w1=1α(α+β),w2=1β(α+β),w0=1-1αβ,γ=2s2Nζ¯-34∑j=1NZj4Nκ¯∑j=1NZj32∑l,kLlk4,whereϕ1=Nκ‾ps+1∑j=1NZj3,ϕ2=ps+1Nζ‾-12s2∑l,kLlk4∑i=1s1pi∑j=1NZj4and where L is a positive definite matrix such thatΣ=LL⊤+ZZ⊤holds. Constraint γ is required in step 2 to ensure the expression under square root for α and β does not become negative. Given all the inputs and the calculated parameters, probability weights can now be generated.Step 2: Probability weights(1)Generate real scalarspi∈(0,1)for i=1,2,…,s, such that∑i=1spi<12Nand∑i=1s1pi<γ,ps+1=1-2N∑i=1spi.Probability weightspicorrespond to2Nssymmetric scenarios andps+1is associated with the three additional scenarios that match higher order moments. More details are provided in Proposition 1.Givenp1,p2…ps+1andw0,w1,w2from step 1, vector P of the2Ns+3probability weights is formed as follows:P={p1,p2,…,ps,p1,p2,…,ps,…,ps+1w0,ps+1w1,ps+1w2}.Note that Z can also be generated randomly, provided it satisfies the above mentioned constraint. In the numerical experiments, we usedZj=ρΣjj, whereρ∈(0,1)is a scalar. However, this is only one of many possible ways to generate Z vector.Also note thatpican be generated using a random number generator, and s is an arbitrary positive integer. Hence the number of scenarios generated is independent of the dimension of the random vector r. Note also that the distribution ofpiis of no consequence since the moment-matching is independent of howpiare generated.One way to generatepithat satisfy the constraints is to choose:pi=sNγ+12Ns-sNγU,whereU∈(0,1)is a uniformly distributed random variable. Another way is to generatepifrom a gamma distribution, for examplepi=-ln(U)withU∈1e,1. Note it is necessary to normalise the weights generated using this method, for examplepi′=piNs(2∑pi+max(pi)),to ensure that∑i=1spi′<12Nconstraint is satisfied. There are many more different ways to generatepiand Z while matching the moments, and a natural question to ask whether the results are sensitive to the choice of these parameters. We will investigate empirically the impact of the choice ofpion the generated moment-matching scenarios later in Section 4. In particular, in Section 4.2 the (admittedly limited) evidence provided by our numerical experiments indicates that this might not be the case.Step 3: Support pointsGenerateS=2Ns+3support pointsrkof the multivariate distribution of returns, with their probability weights given byPkfrom step 2 andk=1,…,2Ns+3, as follows:(1)Pr(i-1)N+c=μ+12spiLc=pi=Pi+s(c-1),(2)Pr(s+i-1)N+c=μ-12spiLc=pi=Pi+s(N+c-1),(3)Pr2Ns+1=μ=ps+1w0=P2Ns+1,(4)Pr2Ns+2=μ+αps+1Z=ps+1w1=P2Ns+2,(5)Pr2Ns+3=μ-βps+1Z=ps+1w2=P2Ns+3,wherei=1,2,…,s,c=1,2,…,NandLcis cth column of L.Note that there is no optimisation involved in generation ofrk.The output of the scenario generation algorithm are the2Ns+3support points{r1,r2,…,r2Ns+1,r2Ns+2,r2Ns+3}and the corresponding probability weightsP={p1,p2,…,ps,p1,p2,…,ps,…,ps+1w0,ps+1w1,ps+1w2}.The proposition below summarises the properties of the discrete distribution of the random variable r, based on the output support points and probability weights:Proposition 1Forrk,Pkdefined in(1)–(5), the following moment properties hold:(6)2N∑i=1spi+ps+1∑i=02wi=1,(7)Er=μ,(8)E(r-μ)(r-μ)⊤=Σ,(9)∑j=1N∑k=12Ns+3Erkj-μj3=Nκ‾,(10)∑j=1N∑k=12Ns+3Erkj-μj4=Nζ‾,where the expected values are taken with respect to the probability measure defined byPk.The first two equations are straightforward. The third follows since(11)E(r-μ)(r-μ)⊤=2∑i=1spi12spi∑j=1NLjLj⊤+ps+1w1α2ps+1+w2β2ps+1ZZ⊤=LL⊤+ZZ⊤=Σ,by definition ofLjandwi. For the two last equations, substituting expression forrkandPkfrom step 2 into left-hand side of Equations (9) and (10) we get:∑j=1N∑k=12Ns+3Erkj-μj3=∑j=1N∑k=12Ns+3Pk(rkj-μj)3=(α-β)∑j=1NZj3ps+1,∑j=1N∑k=12Ns+3Erkj-μj4=∑j=1N∑k=12Ns+3Pk(rkj-μj)4=(α2-αβ+β2)∑j=1NZj4ps+1+12s2∑l,kLlk4∑i=1s1pi,wherePkis the kth element of the probability weights vector P. Using definitions of α and β from step 2 provides the required result:(α-β)∑j=1NZj3ps+1=ϕ1∑j=1NZj3ps+1=Nκ‾,(α2-αβ+β2)∑j=1NZj4ps+1+12s2∑l,kLlk4∑i=1s1pi=ϕ2∑j=1NZj4ps+1Nζ‾-12s2∑l,kLlk4∑i=1s1pi=Nζ‾,which completes the proof. □To summarise, the above algorithm generates moment matching scenarios which match a given mean vector, covariance matrix, average marginal third central moment and average marginal fourth central moment. Average computational time for this algorithm ranges from 0.034seconds for 123 scenarios to 0.088seconds for 5043 scenarios. All the numerical experiments were performed using Matlab 7.2 on a desktop with a dual core Pentium IV processor, 2.40gigahertz and 3.24gigabytes RAM.Some remarks on the above proposition are in order.•Equation (11) makes the motivation behind the chosen structure of support points clear; due to12spiterm in the denominator of the support points defined by (1)–(5),picancels out while constructing a covariance matrix and we end up with known mean vector and covariance matrix irrespective of choice ofpi(provided they form a valid probability measure). This freedom of choosingpican then be partially exploited to match more moment properties. Matching two more scalar moment properties (in addition to the mean and the covariance) is feasible in closed-form, as we end up with only having to solve a quadratic equation. Technically, it is possible to match higher order moments, although it might require optimisation and it might hence defeat the whole purpose of this exercise, which is to provide a inexpensive moment-matching scenario generation method.The number of scenarios generated isS=2Ns+3, where s is an arbitrary integer and N is the dimension of r. The distribution of these scenarios is defined by the set of support points and their corresponding probability weights, as given by Equations (1)–(5). We do not have a function closed-form expression for this distribution. However, the purpose is to match the given moment properties, which is achieved (as shown by Proposition 1).The use of a similar algorithm in unscented Kalman filters reported elsewhere (e.g. in Ponomareva & Date (2013)) is unrelated to the application proposed here and is unrelated in general to applications within operations research.Technically, the choices made in generatingpiand Z affects the generated scenarios. In the admittedly limited number of numerical experiments reported here, it was found that the effect was marginal. In case a severe variation is observed in the generated scenarios or in decisions taken based on those scenarios, one can always use one of the choices ofpiand Z as an initial feasible solution to a more sophisticated scenario generation algorithm which uses optimisation.In Section 4, we evaluate the performance of this scenario generator for a real financial portfolio selection problem.In our numerical experiments, we generate scenarios for a one-period portfolio optimisation problem: given a set of N assets in which one may invest, how to divide now an amount of money between these assets, such that, after a specified period of time T, we obtain a return on investment as high as possible? Let us denote byr=r1r2⋯rN⊤the random vector representing the future returns of the assets.Letxjbe the proportion of capital invested in asset j and letx=(x1,…,xN)represent the portfolio resulting from this choice. This portfolio’s return is the random variable:rx=x1r1+⋯+xNrN; its distribution depends on the choicex=(x1,…,xN)and on the distribution ofr1,…rN.With the popular “mean-risk” theory, a portfolio’s return distribution is described by two statistics: the expected value and a “risk” value (desired to be kept low). The portfolio chosen for implementation should be “efficient”, meaning, it should have the lowest risk value for a given expected return. An efficient portfolio is found by solving an optimisation problem in which, for example, the risk of the portfolio is minimised, while a constraint on the expected return is imposed.In most cases, there are no closed form solutions for these optimisation problems. They have to be solved numerically, by approximating the distributions of the future asset returns with discrete ones with finite number of realisations; that is, by generating scenarios for the future asset returns.Traditionally, risk is measured by variance (Markowitz, 1952). In the mean–variance optimisation problem, we do not need scenarios for the future asset returns, but only their expected values and the covariance matrix. However, it has been pointed out that risk may be better quantified and several alternatives risk measures have been proposed. More recently, portfolio optimisation problems include more sophisticated risk measures, most notably those concerned with left tails of distributions. Risk measures in this category include Conditional Value-at-Risk (CVaR), which has good theoretical and computational properties and has gained wide acceptance among academics and practitioners (Pflug, 2000; Rockafellar & Uryasev, 2002).In our numerical experiments, we generate scenarios for future asset returns in a mean-CVaR optimisation model, which, unlike the mean–variance model, requires the full set of scenario returns.The definition of CVaR and the model formulation, are presented below.Letrxbe a random variable representing the return of a portfolio x over a given holding period andA∈(0,1)a percentage which represents a sample of “worst cases” for the outcomes ofrx(usually,A=1%,A=5%orA=10%).The definition of CVaR at the specified level A is the mathematical transcription of the concept “average of losses in the worst A of cases”. More formally, the CVaR at level A ofrxis defined as minus the mean of the A-tail distribution ofrx, where the A-tail distribution is obtained by taking the lower A part of the distribution ofrx(corresponding to extreme unfavourable outcomes) and rescaling it to span [0,1]. The A-tail distribution ofrxconsiders only losses above Value-at-Risk; for a detailed definition of CVaR, see Rockafellar and Uryasev (2002).An important result is that CVaR can be computed and optimised by solving convex optimisation problems. In (Rockafellar & Uryasev, 2002), an auxiliary function is used,F:X×R→R, where X is the set of feasible portfolios.FA(x,v)=1AE[-rx+v]+-v,where[u]+=uifu⩾0and 0 otherwise. It was proved that minimising CVaR over X can be done by minimisingFAoverX×R.When the random asset returns are represented as discrete random variables (via scenarios), the CVaR optimisation problem can be formulated as a linear program (LP) as below:(M-CVaR)minv+1A∑k=1SPk·yk,s.t.:v-∑j=1Nrkjxj⩽yk,∀k∈{1…S},yk⩾0,∀k∈{1…S},∑j=1Nμjxj⩾d;x∈X,where the parameters of the model are:•S=the number of scenarios (for example, with our proposed algorithm,S=2Ns+3),N=the number of assets,Pk=the probability of scenario k occurring,k=1…S,rkj=return of asset j under scenariok,k=1…S,j=1…N,μj=the expected return of assetj,j=1…N,d=the desired expected return of the portfolio (investor-specified).Here,Pkandrkjcan be obtained from scenario generation or sampling of historical data,μjare estimated prior to optimisation (possibly from historical data). The parameter d is decided by the investor. By not imposing the last constraint on portfolio’s expected return, we obtain the (absolute) minimum CVaR portfolio.The decision variables of the model are:•xj=the fraction of portfolio wealth invested in assetj,j=1…N,v=an A-quantile of the portfolio return distribution,yk=the magnitude of the negative deviations of the portfolio return from the A-quantile, for every scenariok∈{1…S}(they are 0 if the portfolio return∑j=1Nrkjxjis higher than the A-quantile).We investigate the behaviour of the proposed scenario generator, as used in conjunction with a mean-CVaR optimisation problem (M-CVaR). We are interested in:(a)the stability of the scenario generator, both in-sample and out-of-sample;how the number of scenarios considered affects the optimal solution and the optimum;quality of the solution as compared to the solution obtained using historical data as scenarios;testing the effect of different parameter selection on the scenario generation algorithm.We use a dataset drawn from FTSE 100, the share index of the stocks of the 100 companies listed on the London Stock Exchange with the highest market capitalisation. The dataset has N=20 stocks and prices monitored weekly over the period of over 14years from July 1997 until November 2011 (747 time periods of historical data). These 20 stocks were chosen in such a way that their combined market capitalisation was roughly over 60% of FTSE 100. Please see (http://www.londonstockexchange.com) for more information about the FTSE 100 index.We compute the corresponding historical returns and calculate the moments for these series; they are displayed in Tables A.1–A.3 in Appendix A.We generate scenarios for the future weekly returns of these stocks using the proposed moment-matching method, with the first four moments as above. We consider various number of scenarios:S=43,S=123,S=243,S=363,S=603,S=723,S=1083andS=5043. SinceS=2Ns+3=40s+3, this corresponds to generatings=1,3,6,9,15,18,27and 126 distinct probability weights respectively. A wide set of values is chosen in order to test the impact of choosing small or large number of scenarios on the achieved optimum.We solve (M-CVaR) using the generatedPkandrkj,k=1…S,dis fixed to 0.3%. We consider CVaR at confidence levelA=10%.It is common practice to use for comparison the “benchmark” scenario generator with the same optimisation model. In this study, we are using the historical returns as “benchmark” scenarios. Thus, we also solve (M-CVaR) usingPkandrkjas given by historical data, i.e.S=747,Pk=1/747,rkj=historical return of stock j at time periodk,k=1…S,j=1…N.The optimisation problems are formulated in AMPL (Fourer, Gay, & Kernighan, 1989) and solved with the FortMP solver (Ellison et al., 2008).Stability is a basic and very important requirement. Since any scenario generator has an element of randomness, the final outcome depends on the values drawn from the corresponding distributions. Stability guarantees that the optimum and the optimal solution of the optimisation problem of interest does not vary (but, possibly, only to a small extent) with the specific scenario set chosen.A scenario generator is said to manifest in-sample stability if, when generating several scenario sets of the same size and solving the optimisation problem on each of these scenario sets, the optimums are similar (here, the optimum is evaluated on the same scenarios used for obtaining the solution, see for example Kaut & Wallace (2007)).A scenario generator is said to manifest out-of-sample stability, if, when generating several scenario sets of the same size and solving the optimisation model on each of these scenario sets, the optimal solutions obtained yield similar “true” objective function values (i.e., the solutions obtained with in-sample scenarios and then they are evaluated using another scenario set, standing for the “true” distribution of the random variables involved).In Kaut and Wallace (2007) it is emphasised that, while it is straightforward to test in-sample stability (we only solve the scenario-based optimisation problems), it is difficult to test the out-of-sample stability – that would mean knowing the “true” distribution of the random vector involved. What is usually done in practice is to use a “benchmark” scenario tree: a large scenario set obtained exogenously, that is known to be stable; this scenario set will stand for the “true” distribution.In-sample stability does not imply the out-of sample one or vice versa. It is possible to have in-sample instability (of the objectives) but not stability of the solutions – in this case, it is likely to have out-of-sample stability, since, in this case, all the solutions are tested on the same scenario set, representing the “true” distribution.We test the in-sample stability of our scenario generator in the following way. For each number of scenarios S considered in our example, we generate 20 sets of scenarios and use them as input in the mean-CVaR optimisation problem (M-CVaR).As seen in Section 2, the choice ofpiand the choice of Z are free parameters in our algorithm. In our numerical experiments, we consider three different ways of generating moment matching scenarios:(1)case1:piare generated by sampling from a uniform distribution method andZj=0.7Σjj,case2:piare generated by sampling from a uniform distribution method andZj=0.45Σjj,case3:piare generated by sampling from a gamma distribution method andZj=0.45Σjj.For each scenario size, we obtain a set of 20 optimal objective values; their statistics are displayed in Tables 4.1–4.3.Tables 4.1–4.3 show that, whenpi’s are generated from the same distribution and the vector Z is fixed, the in-sample stability is very good, even with scenario sets of relatively small sizes. As expected, stability is increased with increasing number of scenarios. For example, in case 1 (pi’s generated using uniform distribution,Zj=0.7Σjj), when considering 123 scenarios, the optimal CVaRs range between 3.22% and 3.3%, while for 5043 scenarios, the optimum values range between 3.73% and 3.77% (Table 4.1). Also expected is the increase in optimal CVaR values as the number of scenarios increases. This is due to the fact that CVaR only takes into account a specified number of worst outcomes (left tail) and ignores the rest of the distribution; in this case, CVaR is the negative of the expected loss under the worst 10% scenarios, expressed as a percentage of investment value.Generating scenarios with different values of Z makes the procedure somewhat less stable; however, for large scenario sets, the differences between optimal CVaRs are marginal. For example, for 5043 scenarios andpi’s generated from the uniform distribution, the optimal CVaRs range between 3.73% and 3.77% whenZj=0.7Σjjand between 3.75% and 3.78% whenZj=0.45Σjj. Even whenpi’s are generated from the gamma distribution, the optimal CVaRs are between 3.89% and 3.92% which, for the practical purposes of the problem considered, represents only a minor difference: it tells the decision maker that, irrespective of the choice of parameterspi’s and Z, the expected loss under the worst 10% cases is between 3.7% and 3.9% of capital invested.Based on our numerical experiments we have found the following rangeρ∈[0.4,0.8]to provide stable results for our specific data set. However, differences upon using different choices for generating the free parameters should be tested with what seems more reasonable for the specific problem.For testing the out-of-sample stability, we use the historical data as the benchmark scenario set. Each of the optimal solutions obtained before are evaluated on the historical data, i.e. we use the portfolio weights previously obtained (using our scenario generator) and compute the corresponding CVaRs using historical scenarios. Thus, we obtain 20 “true” optimums (“historical CVaRs”) for each scenario size. Their statistics are displayed in Tables 4.4–4.6.The “true” optimums (i.e. the CVaRs of the portfolios obtained with our scenario generator, evaluated on historical data) are very close in value, irrespective of the waypiand Z are generated for running the optimisation: they range between 3.9% and 4.1% (Tables 4.4–4.6). We notice that the best out-of-sample stability and also the closest match between in-sample and out-of sample CVaRs are obtained whenpiare generated from the gamma distribution: with 5043 scenarios, the in-sample CVaRs range around 3.9% and 3.9% (Table 4.3) while the out-of-sample CVaRs range around 4%.The out-of-sample stability is also obvious, even for small in-sample scenario sets, particularly when using a consistent method for generatingpiand Z. For example, in case 1 (pi’s generated using uniform distribution,Zj=0.7Σjj), with 123 in-sample scenarios, the “true” CVaRs range between 4.03% and 4.16%. As expected, we get better solutions with increasing number of (in-sample) scenarios: not only even more stable, but also resulting in a better (i.e. smaller) out-of-sample CVaRs. Again we notice that, when increasing the number of (in-sample) scenarios, the difference between the out-of-sample CVaRs is small: an average “true” CVaR of 4.01%is obtained for 123 in-sample scenarios; the average “true” CVaR for 5043 in-sample scenarios is 3.96% (Table 4.4).Similar results are obtained for the other two cases (Tables 4.5 and 4.6). We notice that, in all three cases, for 5043 in-sample scenarios, the average “true” CVaR is in the range of 4%. The specific method used for generating the free parameters seems again to result in (only) marginal differences.Moreover, with increasing number of in-sample scenarios, the optimum (in-sample) CVaRs get progressively close in value to the out-of-sample CVaRs (evaluated on historical data). In the case of 5043 in-sample scenarios, the in-sample CVaRs are in the range of 3.8% whenpiare generated using the uniform distribution (cases 1 and 2; Tables 4.1 and 4.2) and and in the range of 3.9% whenpiare generated using the gamma distribution (case 3; Table 4.3); the out-of-sample CVaRs are in the range of 4%, in all three cases (Tables 4.4–4.6).We notice that the proposed scenario generator is not only stable in-sample and out-of-sample (with respect to the optimum CVaR), but also manifests “stability of optimal solutions” for the chosen problem. With a specified number of in-sample scenarios, the optimal portfolio weights obtained are very similar under different runs. This is valid even in the case of smallest scenario sets (123 scenarios). Table A.4 in Appendix A displays the optimal portfolio weights obtained in each of the 20 runs, when the scenario size is 5043 andpi’s are generated using the uniform distribution,Zj=0.7Σjj(case 1). Similar results are obtained for the other cases. The full set of results would considerably lengthen the paper without adding much value; they can be obtained upon request from the authors.Moreover, with increasing number of scenarios, the optimal portfolio weights change only marginally, i.e. the portfolio weights obtained by using 123 scenarios are similar to the portfolio weights obtained by using 5043 scenarios (please see Table 4.7).This supports the idea that stable solutions may be obtained with relatively small number of scenarios and increasing the number of scenarios leads only to a marginal change in the optimal solution.A natural question to ask is: how do these solutions compare with the portfolio solution obtained by using the historical data as in-sample scenarios?Table 4.7 displays a summary of optimal solutions obtained by using in-sample: (a) the proposed scenario generator withpigenerated using the uniform distribution,Zj=0.7Σjj(case 1), various scenario set sizes and (b) historical data. For a given scenario set size, the weights displayed are obtained by averaging the (very similar) optimal weights obtained for the 20 different runs. “HD” signifies the portfolio weights obtained using historical data as in-sample scenarios (747 scenarios equally probable scenarios). Note that “HD” solutions are included for comparison purposes only and not as part of stability analysis of our scenario generation methodology.The “HD” optimal portfolio is different from the solutions obtained via the proposed scenario generator – we notice however that assets with strictly positive weight are roughly the same in both cases; also, there are roughly the same assets with highest weights (e.g. assets 6, 8, 12, 15, 16).Another encouraging result is that the “true” CVaR of the portfolio obtained using historical data in-sample (that is, the optimisation and evaluation of CVaR is done on historical data) is 3.87%.Thus, as measured on the benchmark scenario generator, a solution obtained using our scenario generator in-sample gives a “true” CVaR of 3.96%, while the solution obtained using historical data in-sample gives a value only 0.09% lower.

@&#INTRODUCTION@&#


@&#CONCLUSIONS@&#
We proposed a moment-matching scenario generation method. Given a distribution of a random vector that is partially specified in terms of first four marginal moments and covariance matrix, this method generates scenarios and corresponding probabilities that match exactly the first two moments, the covariance matrix, the average marginal skewness and the average marginal kurtosis.The method presents several advantages over the existing approaches. First, it is computationally cheap; there is no optimisation involved in generating scenarios. Secondly, due to the (unequal) generated probabilities of the scenarios, this method may perform well even with a relatively small number of scenarios. In contrast, methods that would assume by default equal probabilities would need a larger number of scenarios.These assertions are supported by the numerical results. We tested the quality of the proposed scenario generator in a mean-CVaR portfolio optimisation model. Several observations were made. First, the method appears to be remarkably stable, both in-sample and out-of-sample. For the problem solved, it also demonstrates stability of optimal solutions, i.e. not only the optimums are similar, but also the optimal portfolio weights, representing the solution to implement. Secondly, the optimal solutions vary only marginally with increasing number of scenarios. That means, by using only a small number of scenarios, we may obtain a reasonably good solution. Since the method allows for some freedom for generating the probability weights and scenarios which match the given moments, we tested the algorithm for three different ways of generating the probability weights and scenarios. The results obtained by varying the underlying distribution ofpiand/or the value of the free parameter matrix Z appear to be qualitatively similar.In the numerical case presented here, direct comparison with solutions obtained via using historical data could be made. We comment that the proposed scenario generation method is applicable to cases where there is no (or not enough) historical data available, but only expert opinion on the statistical properties involved.This method may also present a big advantage when used with a computationally difficult optimisation model, requiring only a limited number of scenarios; stable and good quality solutions may be obtained with a relatively small number of scenarios. Intuitively, this may be attributed to the fact that unequal and random probability weights are generated along with the support points.The numerical results are very encouraging. Note that the single example chosen focuses on the tail behaviour of the distribution and is hence challenging from a scenario generation point of view. This scenario generation method may work well for multi-stage stochastic optimisation, where generally only a limited number of scenarios can be considered and there are scale-up issues; this is something we plan to investigate in the future.See Tables A.1–A.4.Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.07.049.