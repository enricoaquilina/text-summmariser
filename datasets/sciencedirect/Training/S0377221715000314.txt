@&#MAIN-TITLE@&#
Generalized analytic network process

@&#HIGHLIGHTS@&#
We develop generalized analytic network process (G-ANP).G-ANP eliminates the drawbacks of the ANP and F-ANP.We propose a prototype for a decision support system.G-ANP is specially useful for decision making problems with big data.

@&#KEYPHRASES@&#
Decision support systems,Decision analysis,Distribution,Simulation,

@&#ABSTRACT@&#
The analytic network process (ANP) is a methodology for multi-criteria decision making used to derive priorities of the compared elements in a network hierarchy, where the dependences and feedback within and between the elements can be considered. However, the ANP is limited to the input preferences as crisp judgments, which is often unfavorable in practical applications. As an extension of the ANP, a generalized analytic network process (G-ANP) is developed to allow multiple forms of preferences, such as crisp (fuzzy) judgments, interval (interval fuzzy) judgments, hesitant (hesitant fuzzy) judgments and stochastic (stochastic fuzzy) judgments. In the G-ANP, a concept of complex comparison matrices (CCMs) is developed to collect decision makers’ preferences in the multiple forms. From a stochastic point of view, we develop an eigenvector method based stochastic preference method (EVM-SPM) to derive priorities from CCMs. The main steps of the G-ANP are summarized, and the implementation of the G-ANP in Matlab and Excel environments are given in detail, which is also a prototype for a decision support system. A real-life example of the piracy risk assessment to the energy channels of China is proposed to demonstrate the G-ANP.

@&#INTRODUCTION@&#
In multi-criteria decision making, the analytic hierarchy process (AHP) (Saaty, 1980) is a popular methodology to derive priorities of compared elements (or objectives, alternatives etc.) to assist decision makers (DMs) to make decisions. It has been successfully applied in practice (Saaty, 1989, 2008). In the AHP, the DMs provide their preferences over paired comparisons of elements by a 1–9 scale in each level of a hierarchy. The hierarchy of the AHP is a linear top down form with clear independent levels, where the elements in each level are also independent.In the AHP, prioritization methods are necessary to derive priorities of the compared elements in each level of the hierarchy, such as the eigenvector method (EVM) (Saaty, 1977), the logarithmic least squares method (LLSM) (Crawford & Williams, 1985), and the logarithmic goal programming method (GPM) (Bryson, 1995). Due to the inherent difference of the DMs, their preferences can be inconsistent. As discussed by Saaty and Vargas (1987), only the EVM takes consistency of the preferences into account. The use of other prioritization methods may lead to wrong decisions by reversing ranks. Therefore, consistency checking and improving are significant in the AHP to guarantee meaningful results.The AHP has a limitation that it cannot deal with interactions and dependencies between the elements in the levels of the hierarchy. For example, to predict the market share of cell-phone providers, the elements that influence the market share of a company can be costs and services, where the services may also influence the costs. To overcome this limitation, Saaty (2001) considered the dependences and feedback of the elements, and then developed the analytic network process (ANP).In the ANP, the network allows clusters of elements influence each other, or has loops if the elements in the clusters have inner dependences. So the network spreads out in all directions and its cluster of elements are not arranged in a particular order (Saaty, 2004). The advantage of the ANP in dealing with dependences and feedback enables it to be very useful in many practical applications. For example, the ANP has been used for the interdependent information system project selection (Lee & Kim, 2000), the R&D project selection (Meade & Presley, 2002), the logistics service provider selection (Jharkharia & Shankar, 2007), the product mix planning (Chung, Lee, & Pearn, 2005), the SWOT analysis (Yüksel & Dagdeviren, 2007), the financial-crisis forecasting (Niemira & Saaty, 2004), and the multi-criteria analysis (Wolfslehner, Vacik, & Lexer, 2005).However, the preferences in the ANP are limited to crisp judgments based on the 1–9 scale. In many cases, the DMs may prefer to many other possible forms to represent their preferences. To overcome this limitation of the ANP, Mikhailov and Singh (2003) developed the fuzzy analytic network process (F-ANP) which allows multiple forms of preferences, such as crisp judgments, interval judgments, and fuzzy judgments. Moreover, the main difference between the F-ANP and the ANP is that the F-ANP uses a fuzzy preference programming (FPP) method as an alternative prioritization method to the EVM.The FPP is a linear programming method that maximizes the DMs’ satisfaction degree to consistency of the preferences, where a consistency index is also provided. However, this consistency index is a relative index varying with a so called “deviation parameter”, which cannot be used to measure whether the preferences are consistent or not. Therefore, similar to the LLSM and the GPM, the FPP also does not take consistency of the preferences into account. Although the FPP is convenient to be used to derive priorities, it may result in ineffective decisions in some cases if consistency of the preferences cannot be guaranteed.As complexity of the socio-economic environment is increased, more uncertainties are experienced by the DMs apart from crisp judgments, interval judgments and fuzzy judgments. For example, the DMs may be hesitant about several possible values for a judgment. This concept of hesitance of being used for describing the preferences in decision making is based on hesitant fuzzy sets originally introduced by Torra (2010). Based on a 0.1–0.9 scale, the judgments that each is characterized by several possible values are called hesitant fuzzy judgments. They have been widely used in decision making problems (Xia & Xu, 2011; Xia, Xu, & Chen, 2013; Xu & Xia, 2011). Based on the 1–9 scale, hesitant judgments were also proposed for decision making (Xia & Xu, 2013; Zhu & Xu, 2014a).The judgments can be also indicated by stochastic variables, which have been considered by some researchers as stochastic judgments. For example, Rosenbloom (1997) claimed that the subjective preferences with a continuous probability distribution is a standard requirement in the conventional decision analysis, so stochastic judgments should be used rather than crisp judgments and interval judgments. Moskowitz, Tang, and Lam (2000) recommended to use stochastic variables to account for inconsistency and imprecision in the preferences. Hahn (2003) claimed that the deterministic methods in decision making are special cases of their stochastic counterparts, and then proposed a stochastic formulation of the AHP with stochastic judgments.Based on the discussion above, so many possible forms of preferences are available for the DMs. In practice, different forms of preferences shall be useful in different situations. However, different forms of preferences also require different prioritization methods. Is there a general method can deal with all the possible forms of preferences mentioned above and produce meaningful results? In this paper, we develop a generalized analytic network process (G-ANP) method as an extension of the ANP. In the G-ANP, the DMs can provide their preferences over paired comparisons of elements in the network as crisp (fuzzy) judgments, interval (interval fuzzy) judgments, hesitant (hesitant fuzzy) judgments and stochastic (stochastic fuzzy) judgments, etc.Since the preferences in the G-ANP can be in multiple forms, we define them as complex judgments to construct complex comparison matrices (CCMs). An expected index is developed to measure whether or not a CCM is of the acceptable consistency. Then an automatic consistency improving method is proposed to repair inconsistent CCMs to guarantee meaningful results. Consistency checking and improving of the G-ANP also eliminate the drawbacks of the F-ANP that cannot take consistency into account. To derive priorities from CCMs, we develop an eigenvector method based stochastic preference method (EVM-SPM) as a new prioritization method. Based on these new developed methods, a step by step procedure of the G-ANP is proposed.The rest of the paper is organized as follows. Section 2 introduces all the possible forms of preferences in the G-ANP, and then defines complex judgments and CCMs. Section 3 focuses on consistency checking and improving of CCMs. Section 4 develops the EVM-SPM. In Section 5, the step by step implementation of the G-ANP is discussed in detail. Then a real-life example of the piracy risk assessment to the energy channels of China is given to illustrate the G-ANP in Section 6. Section 7 gives some concluding remarks.In this section, we introduce the judgments based on a 1–9 scale and a 0.1–0.9 scale respectively, then define complex judgments and complex comparison matrices (CCMs).Based on the 1–9 scale (Saaty, 1980), shown in Table 1, the DMs’ preferences can be clearly represented by crisp values to describe the relationships between paired comparisons of elements, where the preferences are called crisp judgments.A reciprocal comparison matrix consisting of crisp judgments, A = (aij)n × n, can be shown as follows:(1)A=[1a12a13…a1n1a23…a2n⋮1⋮⋮1/aij⋮⋱⋮…1]where the judgments satisfy the reciprocal property as aij= 1/aji, i, j = 1, 2, …, n.If a judgment is represented by an interval to indicate uncertainties, then it is called an interval judgment. An interval reciprocal comparison matrix (Saaty & Vargas, 1987) constructed by interval judgments,A˜=(a˜ij)n×n, is given as follows:(2)A˜=[1[a12l,a12u][a13l,a13u]…[a1nl,a1nu]1[a23l,a23u]…[a2nl,a2nu]⋮1⋮⋮[1/aiju,1/aijl]⋮⋱⋮…1]where the judgments satisfy the reciprocal property asaijl=1/ajiu,aiju=1/ajilandaijl≤aiju, i, j = 1, 2, …, n.In accordance with Saaty and Vargas (1987) of considering discrete judgments within the interval, we also use the integers and reciprocals of the integers between the upper and lower bounds of an interval. For example, the interval judgment [1/4,2] has 1/4, 1/3 and 1/2 as reciprocals of integers, and 1 and 2 as integers, for a total of five judgments. So the reciprocal comparison matrix is a special case of the interval reciprocal comparison matrix.If a judgment includes several possible values, then it is called a hesitant judgment, which can be represented by a set h = {a(l)|l = 1, …, |h|}. For example, a hesitant judgment {1/3, 1} has two possible values as 1/3 and 1. A hesitant reciprocal comparison matrix consisting of hesitant judgments, denoted by H = (hij)n × nwithhij={aij(l)|l=1,…,|hij|}, can be shown as follows:(3)H=[1{a12(1),…,a12(|h12|)}{a13(1),…,a13(|h13|)}…{a1n(1),…,a1n(|h1n|)}1{a23(1),…,a23(|h23|)}…{a2n(1),…,a2n(|h2n|)}⋮1⋮⋮{1/aij(1),…,1/aij(|hij|)}⋮⋱⋮…1]where the judgments satisfy the reciprocal property asaijρ(l)=1/ajiρ(l)(aijρ(l)is the ρth element in hij), i, j = 1, 2, …, n.The hesitant reciprocal comparison matrix can be also called a hesitant multiplicative preference relation (Zhu & Xu, 2014a). Since we consider discrete values in interval judgments, the interval reciprocal comparison matrix can be considered as a special case of the hesitant reciprocal comparison matrix.If a judgment is a stochastic variable following a probability function, then it is called a stochastic judgment. For example, let ζijbe a stochastic variable satisfying ζij∈ hijand the reciprocal property as ζij= 1/ζji, and F(ζij) be the probability function of ζij, then Z = (ζij)n × nis called a stochastic reciprocal comparison matrix for all i, j = 1, 2, …, n. As usual, the possible values in hesitant judgments are assumed to be uniform distributed. So the hesitant reciprocal comparison matrix can be considered as a special case of the stochastic reciprocal comparison matrix. According to practice, more possible distributions can be used to describe the judgments.Based on the discussion above, we conclude that the stochastic reciprocal comparison matrix encompasses the reciprocal comparison matrix, the interval reciprocal comparison matrix, and the hesitant reciprocal comparison matrix as special cases.The 0.1–0.9 scale is uniformly and symmetrically distributed around 0.5. Using the judgments based on the 0.1–0.9 scale to indicate the DMs’ preferences is another natural way to represent uncertainties, which incorporates the vagueness of human thinking. The judgments represented upon the 0.1–0.9 scale are called fuzzy judgments. The judgments between the 1–9 scale and the 0.1–0.9 scale have close relationships, which are shown in Table 2.Similar to interval judgments, hesitant judgments and stochastic judgments, we also have interval fuzzy judgments (Zadeh, 1975), hesitant fuzzy judgments (Torra, 2010) and stochastic fuzzy judgments (not formally defined in previous literature). Particularly, fuzzy judgments are used to construct complementary comparison matrices or called fuzzy preference relations (Tanino, 1984). With respect to interval fuzzy judgments and hesitant fuzzy judgments, we have interval fuzzy preference relation (Xu, 2004b) and hesitant fuzzy preference relation (Zhu & Xu, 2013) respectively.With respect to Table 2, many transformation formulas have been developed for the transformation of the judgments between the two scales. For example, for a fuzzy preference relation B = (bij)n × nconsisting of fuzzy judgments, Xu (2002) gave a transformation formula as(4)aij=bij/bji,i,j=1,2,…n,to transform B into a reciprocal comparison matrix A = (aij)n × n.To encompass crisp (fuzzy) judgments, interval (interval fuzzy) judgments, hesitant (hesitant fuzzy) judgments and stochastic (stochastic fuzzy) judgments as special cases of complex judgments, we define a complex judgment as cp, where c represents the value(s) of the judgment with a probability interpretation. The probability interpretation is to use a probability function to specify the distribution of the values in c.For example, assume c = [1, 5]p, then the probability function, denoted by F(ζk) = pk(ζk∈ c), can be shown as a distribution table in Table 3.Since crisp (fuzzy) judgments, interval (interval fuzzy) judgments and hesitant (hesitant fuzzy) judgments do not require the probability interpretations or the values follow uniform distribution, it is not necessary to explicitly give the probability functions. So cpis written as c in such cases.Constructed by complex judgments, a CCM is defined as follows.Definition 1Let X = {x1, x2, …, xn} be a fixed set, then a complex comparison matrix (CMM) is represented byC=(cijp)n×n∈X×X, wherecijpis a complex judgment indicating the preference degree(s) of the alternative xiover xj.It is clear that the reciprocal comparison matrix, the interval reciprocal comparison matrix, the hesitant reciprocal comparison matrix and the stochastic reciprocal comparison matrix are special cases of the CCM.Generally, we assume that the complex judgments in a CCM satisfy the reciprocal property associated with the forms of preferences. For example, if a complex judgment in C is an interval judgment, denoted by cij= [2, 4], then the corresponding diagonal element should be cji= [1/4, 1/2]; if a hesitant judgment c'ij= {3, 5}, then c'ji= {1/3, 1/5}.Remark 1In this paper, we transform fuzzy judgments into the judgments based on the 1–9 scale for the purpose of developing a new prioritization method.Sine we mainly deal with reciprocal comparison matrices, reciprocal comparison matrices are called comparison matrices in brief in the rest of the paper. It is also the interval reciprocal comparison matrix, the hesitant reciprocal comparison matrix and the stochastic reciprocal comparison matrix.Consistency checking and improving are of vital importance for comparison matrices to guarantee meaningful results. Saaty (1977) developed an eigenvector method (EVM) to provide a consistency index to measure the consistency degrees of comparison matrices. Then the consistency thresholds are established to define whether the comparison matrices are with the acceptable consistency.With respect to inconsistent comparison matrices, some consistency improving methods have been developed (Cao, Leung, & Law, 2008; Ergu, Kou, Peng, & Shi, 2011; Li & Ma, 2007; Xu & Wei, 1999). For interval comparison matrices, hesitant comparison matrices and stochastic comparison matrices, there are very few research results focus on this topic. In this paper, to deal with CCMs, we develop a new expected index for consistency checking and a stochastic method for consistency improving, respectively. This index and the stochastic method can also be used for interval comparison matrices, hesitant comparison matrices and stochastic comparison matrices respectively.The eigenvector method (EVM) (Saaty, 1977) gives a consistency index, CR = CI/RI, to measure consistency of a comparison matrix A = (aij)n × n, where CI = (λmax  − n)/(n − 1), λmax  is the maximum eigenvalue of A, and RI is a random index. The reference values of RI for different values of n are shown in Table 4.If CR < 0.1, then A is said to be with the acceptable consistency; otherwise unacceptable.For a comparison matrix A = (aij)n × n, if(5)aij=ωiωj,i,j=1,2,…,n,where ω = (ω1, ω2, …, ωn) is the priority vector of A, satisfying∑i=1nωi=1, ωi> 0, i = 1, 2, …, n, then A is consistent (Saaty, 1980), where its consistency index CRA= 0.For a CCMC=(cijp)n×n, assume that the stochastic variablesζij∈cijp, and ζijare specified by the probability function F(ζij), i, j = 1, 2, …, n. Then following F(ζij), we can get a stochastic comparison matrix Z = (ζij)n × n. According to the EVM, we obtain the corresponding consistency index denoted by CRZ(ζ). Then in the judgment space of C, denoted by C(ζ), an expected index can be defined to measure consistency of C:(6)E(CRC)=∫C(ζ)CRZ(ζ)dζBeing in accordance with the consistency thresholds of CR, if E(CRC) < 0.1, then C is said to be with the acceptable consistency. Otherwise, unacceptable.The expected index can be obtained by Monte Carlo simulation (Milton & Arnold, 1995). Since each iteration contributes to the result, to achieve the accuracy d with 95 percent confidence level for the expected index, the required number of iterations is(7)K=1.9624d2If the error limit is d = 0.01, then the number of iterations should be 9604.Remark 3We let d = 0.01, and the number of iterations be 10,000 in the rest of the paper to calculate the expected index.Assume a CCM with five elements xi(i = 1, 2, …, 5) to compare:C1=[1[2,5]{1,3}[2,6][3,5][1/2,1/5]1{2,3,5}[1/5,1/3][3,7]{1,1/3}{1/2,1/3,1/5}1[5,7]4[1/2,1/6][5,3][1/5,1/7]1[1/3,5][1/3,1/5][1/3,1/7]1/4[3,1/5]1]By Monte Carlo simulation operated in the Matlab environment, we haveE(CRC1)=0.4778. SinceE(CRC1)>0.1, C1 is not with the acceptable consistency.In each iteration of Monte Carlo simulation of calculating the expected index, there exists a stochastically obtained comparison matrix A = (aij)n × nand a corresponding consistency index, denoted by CRA. If CRA> 0.1, we improve consistency of A until it is of the acceptable consistency. For the consistency improving method of A, we refer to the iteration method proposed by Xu and Wei (1999). The step by step algorithm is given in Algorithm 1Algorithm 1Step 1:LetA(k)=(aij(k))n×n, and k = 0.Calculate the maximal eigenvalue λmax (A(k)) of A(k) and the normalized principal right eigenvectorω(k)=(w1(k),w2(k),…,wn(k))T.CalculateCRA(k).IfCRA(k)<0.1, then go to step 6; otherwise, continue the next step.LetA(k+1)=(aij(k+1)), whereaij(k+1)=(aij(k))1−λ(ωi(k)/ωj(k))λ, λ ∈ [0, 1]. Let k = k + 1 and return to step 2.Output A(k),CRA(k).End.In step 5, λ is the parameter indicating the accuracy in each iteration. The bigger the value λ, the more consistent the improved A, but the less the original preferences are preserved. Generally, we set λ = 0.01 to preserve the original preferences as many as possible.In order to prove the convergence of Algorithm 1, Xu and Wei (1999) modifiedCRA(k)=0in step 4 of Algorithm 1, which is called Algorithm 2. Then they gave a theorem to prove the convergence of Algorithm 2 as follows.Theorem 1(Xu & Wei, 1999) Let A = (aij)n × nbe an inconsistent comparison matrix. Let {A(k)} be the matrix sequence generated in Algorithm 2 andλmax(k)be the maximal eigenvalue of A(k). Then for each k, λmax (A(k + 1)) < λmax (A(k)) and limk → ∞λmax (A(k)) = n.Based on Algorithm 1, for a CCMC=(cijp)n×n, we now develop a stochastic consistency improving method shown in Algorithm 3 to improve consistency of C until E(CRC) < 0.1.Algorithm 3Step 1:LetC(s)=(cijp)n×n(s), and s = 0.CalculateE(CRC(s)), ifE(CRC(s))<0.1, go to step 6; otherwise go to the next step.Stochastically get a comparison matrix A = (aij)n × nfrom C(s), then let A(k) = A, and k = 0.Obtain the comparison matrix A(k) with the acceptable consistency by Algorithm 1.Return A(k) to C(s) to replace A(0). Let s = s + 1 and return to step 2.Output C(s) andE(CRC(s)).End.In order to prove the convergence of Algorithm 3, we letE(CRC(s))=0in step 2 of Algorithm 3. Then the modified Algorithm 3 is called Algorithm 4.Theorem 2Let C be a n × n positive comparison matrix, and{E(CRC(s))}be the sequence of the expected index of C generated in Algorithm 4. Then, for each s, we haveE(CRC(s+1))<E(CRC(s))andlimk→∞{E(CRC(s))}=0.The proof of Theorem 2 is shown in the Appendix.Example 2Continued with Example 1, by Algorithm 3, we output an improved CCM of C1, denoted by C'1, asC1′=[1{1.8702,1.8045,2.2083,3.9548}{1.1122,1.9240}{0.5347,0.5542,0.4528,0.2529}1{1.8550,1.0439,1.5314}{0.8991,0.5198}{0.5391,0.9579,0.6530}1{0.5489,0.3760,0.4059,0.2176,0.1667}{1.3755,1.3047,2.2896}{0.3043,0.4060,0.4150}{0.3023,0.2378,0.1979}{0.3326,0.2825,0.3703,0.1858,0.1553}0.2875{1.8217,2.6594,2.4634,4.5965,6}{3.3081,4.2047,5.0529}{0.7270,0.7664,0.4368}{3.0067,3.5393,2.7006,5.3810,6.4386}{3.2863,2.4628,2.4097}3.47821{0.9571,1.2283,1,2,3.0158,3.7978,4.3584}{1.0488,0.8142,1,0.5,0.3316,0.2633,0.2294}1],and output the expected indexE(CRC′1)=0.097.The prioritization methods that aim to derive priorities from comparison matrices and preference relations have been studied extensively over last decades. Some related methods are listed in Table 5.Based on Table 5, for the comparison matrices and the preference relations, the prioritization methods can be roughly divided into four commons ones: (1) the classic EVM (Saaty, 1977), (2) the programming methods (Crawford, 1987; Gong, 2008; Mikhailov, 2000, 2004; Wang, 2006;Wang & Elhag, 2007; Wang, Fan, & Hua, 2007; Wang, Parkan, & Luo, 2008; Wang, Yang, & Xu, 2005a, 2005b; Xu, 2004a; Xu & Chen, 2008; Xu & Da, 2005), (3) the aggregation methods (Barzilai, 1997; Escobar, Aguarón & Moreno-Jiménez, 2004; Xu, 2006; Zhu, Xu & Xu, 2013), and (4) the stochastic methods (Hahn, 2003; Rosenbloom, 1997). Among these methods, the EVM, the programming methods, and the aggregation methods are deterministic methods which are the special cases of the stochastic methods.Since all the comparison matrices and preference relations listed in Table 5 can be considered as special cases of CCMs, we should develop a new prioritization method for CCMs from a stochastic point of view. In this section, we develop an eigenvector method based stochastic preference method (EVM-SPM) to derive priorities from CCMs.The EVM-SPM is motivated by a stochastic preference analysis method developed by Zhu and Xu (2014b). By analyzing the judgment space of numerical preference relations, Zhu and Xu (2014b) gave several outcomes to provides constructive suggestions for the DMs. Following the stochastic preference analysis method, we concentrate on a CCMC=(cijp)n×nassociated with a set of elements X = {x1, x2, …, xn}.Let Z = (ζij)n × nbe a stochastic comparison matrix, whereζij∈cijp, and let f(ζij) be the density function that specifies ζij. Then the joint probability distribution of ζij(i, j = 1, 2, …, n) can be specified by adensity function (Zhu & Xu, 2014b):(8)f(ζ)=∏i<jfij(ζij)By the EVM, we can get the priority vector of the elements from Z, denoted by ω = (ω1, ω2, …, ωn). For the element xi, a ranking function is defined to rank xias follows:(9)ranki(ω)=1+∑k=1nρ(ωk>ωi)=rwhere ρ(ture) = 1 and ρ(false) = 0.So the set of favorable judgments in Z, which makes xirank r, can be defined as(10)Zir(ζ)={ζ∈Z:ranki(ω)=1+∑k=1nρ(ωk>ωi)=r}The acceptable possibility of judgments which makes xirank r is defined as a percentage of the favorable judgments to the overall judgments as follows (Zhu & Xu, 2014b):(11)bir=∫Zir(ζ)f(ζ)dζwherebir∈[0,1],∑r=1nbir=1. The biggerbir, the higher acceptable possibility of xiranking r.To obtain the overall acceptable possibility of xi, it requires an additional process to aggregate the acceptable possibilities for each possible rank of xi. For this aggregation process to discern the elements, some possible so called meta-weights could be the linear weights αr= (n − r)/(n − 1), the inverse weights αr= 1/r, and the centroid weightsαr=∑i=rn1/i/∑i=1n1/i, where the linear weights give more weight to the mediocre ranks, while the inverse and centroid weights emphasize the best ranks (Lahdelma & Salminen, 2001). The overall acceptable possibility of xiis defined as follows:(12)oi=∑rαrbirThen we normalize the overall acceptable possibility of xias(13)pi=oi∑ioi=∑rαrbir∑i∑rαrbirwhich can be referred as the final priority of xi.As discussed above, to deal withC=(cijp)n×nby the EVM-SPM, we give the following algorithm based on Monte Carlo simulation.Algorithm 5Step 1:Stochastically get a comparison matrix A = (aij)n × nfrom C, then calculate the acceptable possibilitiesbir(i,r=1,2,…,n)of the elements xi(i = 1, 2, …, n) for each possible rank by Eq. (11).Determine the meta-weights, then according to Eq. (12) andbir(i,r=1,2,…,n), calculate the overall acceptable possibilities of xi(i = 1, 2, …, n).Calculate the final priorities of xi(i = 1, 2, …, n) by Eq. (13).We now give an example to illustrate the EVM-SPM.Example 3Continued with Example 2, according to Eq. (11), we get the acceptable possibilities of the elements for each rank shown in Table 6.A three dimensional column chart is helpful to show all the acceptable possibilities of the elements for each rank in a visual way. The results in Table 6 can be described in Fig. 1.Furthermore, we choose the centroid weights which can avoid zero weights to aggregate the acceptable possibilities. Then by Eq. (13), the final priorities for the five elements can be obtained, denoted by p1 = 0.4564, p2 = 0.1618, p3 = 0.2452, p4 = 0.0966 and p5 = 0.04 respectively. So x1 is with the highest overall acceptable possibility.In this section, we first summarize the main steps of the generalized analytic network process (G-ANP), then give the detail of the implementation of the G-ANP, which is a prototype for a decision support system.The generalized analytic network process (G-ANP) that includes the developed new methods in this paper mainly has the following steps.Step 1:Construct a control hierarchy with control criteria which serve as a basis for making judgments, and then construct a network hierarchy with clusters of elements.Identify dependences and feedback within and between the clusters and the clusters of elements.Construct CCMs in the network hierarchy according to the dependences and feedback identified in step 2.Check consistency of the CCMs. If they are not with the acceptable consistency, then we utilize Algorithm 3 to improve their consistency until acceptable.Derive priorities from the CCMs by the EVM-SPM.Construct an unweighted supermatrix.Adjust the unweighted supermatrix to a weighted supermatrix (or called a stochastic matrix).Calculate limiting priorities of all the elements from the stochastic matrix.Calculate final priorities of the elements according to the limiting priorities.The related methods in steps 3, 4 and 5 have been discussed in Sections 2, 3 and 4 respectively. The other steps are similar to the traditional analytic network process (ANP), which can be found in (Saaty, 2001) in detail. When the uncertainties of judgments in G-ANP tend to zero, the G-ANP reduces to the ANP.To implement the G-ANP step by step, Excel and Matlab are adopted as the main development environments, because of their good visualization capabilities, powerful computation capabilities, and programming interfaces.Step 1:(Implemented in Excel): Use a network table of clusters and a network table of elements to list all the dependences and feedback within and between the clusters and the clusters of elements, respectively.(Implemented in Excel): According to the network table of clusters and the network table of elements, we compare the clusters and the clusters of elements to construct CCMs, respectively.(Implemented in Excel and Matlab): Send all the CCMs to Matlab by Excel Link, then check and improve (if necessary) their consistency, and then return the results to Excel. The flowchart of step 4 is shown in Fig. 2.(Implemented in Excel and Matlab): Send the improved CCMs with the acceptable consistency to Matlab by Excel Link, then utilize the EVM-SPM to obtain priorities of the clusters and priorities of the clusters of elements, and then return the priorities to Excel by Excel Link.(Implemented in Excel): Construct an unweighted supermatrix by the macros of Excel worksheets filled with the priorities of the clusters of elements.(Implemented in Excel and Matlab): Send the unweighted supermatrix and the priorities of the clusters to Matlab by Excel Link, then construct a stochastic matrix whose columns sum to unity, and then return the stochastic matrix.(Implemented in Excel and Matlab): Send the stochastic matrix obtained in step 7 to Matlab by Excel Link, then obtain limiting priorities of all the elements, and then return the limiting priorities to Excel by Excel Link.(Implemented in Excel): Calculate final priorities of the elements by the macros of Excel worksheets based on the limiting priorities.For a country, energy channels are significant for its development by transporting power, oil and gas etc. However, the security of the energy channels is often challenged by hostile forces, where piracy is one of them. Supported by Institute of Meteorology, PLA University of Science and Technology, 100 military experts are invited to participate this project of the piracy risk assessment to the energy channels of China.Since this problem can be hierarchically constructed, and elements in the levels of the hierarchy influence each other, we use the G-ANP to get final priorities of the elements. Then by aggregating normalized property values and the final priorities of the elements, we can get the risk scores of the energy channels to assess piracy risk of the energy channels.The military experts are required to determine the related elements that influence the energy channels of China with respect to piracy risk, and provide judgments over paired comparisons of the elements. By analysis, it is concluded that there are five main clusters of elements influencing the energy channels, where some of the elements also influence each other resulting in a network.Considering the large quantity of judgments provided by the military experts, we use a statistic method to collect these judgments, which can better represent the original judgments without aggregation. So the judgments are with probability interpretations. Moreover, the reason why we use the G-ANP instead of the ANP in this example is that some military experts prefer to use the 0.1–0.9 scale as a basis to provide their judgments, and many judgments cannot be aggregated due to the divergent opinions among the experts. As required by the military experts to allow more flexible methods to represent their preferences, and fully consider their original judgments, we develop the G-ANP to enhance the modeling abilities of the ANP in practice.As discussed by the military experts, the structure of this problem is described by a network consisting of five clusters regarding the piracy risk assessment as the control criterion, where connections between them are shown in Fig. 3. The connections of the clusters indicate the flow of influence between them.The five clusters, i.e. the energy channels, the sea control capability, the island chain blockade capability, the risk elements, and the piracy, consist of several basic elements respectively. We list them below.(1)The energy channels: South Sea (E1), Strait of Malacca (E2), Indian Ocean (E3), Gulf of Aden (E4), East Africa (E5), Cape of Good Hope (E6), Arafura Sea (E7) and Okhotsk (E8).The sea control capability: Military bases (C1), the number of garrison (C2), reconnaissance capabilities (C3), military support capabilities (C4) and logistical capacity (C5).The island chain blockade capability: Strategic position (B1), geographical features (B2), stationed conditions (B3), diplomatic relations (B4) and support capabilities (B5).The risk elements: Geography (R1) economic conditions (R2) political situation (R3) ethnic and religious (R4) international checks and balances (R5).The piracy: The number of pirates (P1) weaponry (P2) event location (P3) casualties/kidnapping (P4) and property damage (P5).Following the step by step implementation of the G-ANP in Section 5.2, we give the detail below to illustrate the G-ANP of solving this piracy risk assessment problem.Step 1. The influence relationships between the clusters of elements in the network are identified in a network table of elements shown in Table 7, where the symbol “√” indicates that a top row element is influenced by a left-column element.Similarly, the influence relationships between the clusters in the network can be shown in Table 8.Step 2. The military experts provide their judgments over paired comparisons of the elements that have relationships identified in Table 7. There should be 75 CCMs according to Table 7, and five CCMs according to Table 8. For simplicity, we only give one CCM for illustration.For example, according to Table 7, South sea (E1) is influenced by the cluster of elements as the sea control capability, i.e. C1, C2, C3, C4 and C5. With respect to the piracy risk assessment, and set E1 as the control criteria for making paired comparisons of C1, C2, C3, C4 and C5, the judgments provided by the military experts can be represented by a CCMC=(cijp)5×5as follows:C=[1[1/2,2]p[1,3]p[1/6,1/4]p[1/3,3]p[2,1/2]p1[4,6]p[3,6]p{2,3}p[1,1/3]p[1/4,1/6]p1[7,9]p[1/3,1]p[6,4]p[1/3,1/6]p[1/7,1/9]p1[4,6]p[3,1/3]p{1/2,1/3}p[3,1]p[1/4,1/6]p1].According to the statistic method, the probability functions, denoted by F(ζijk) = pijk(ζij∈cijp;i,j=1,2,…,n), that specify the distributions of the values in cij(i, j = 1, 2, …, n) are shown in Table 9.Step 3. Follow the flowchart in Fig. 2, all the CCMs are sent to Matlab by Excel Link to check and improve consistency, and then return improved CCMs to Excel. ForC=(cijp)5×5, according to Eq. (6), we get the expected index of C as E(CRC) = 0.7618. Since E(CRC) > 0.1, we use Algorithm 3 to improve its consistency. Then we have the improved C, denoted by C' asC′=(1{0.4515,0.7378,1.0895}p{1,1.1304,2.1792}p{2.215,1.3554,0.9178}p1{1.9996,5,4.0901}p{1,0.8846,0.4589}p{0.5001,0.2,0.2445}p1{1.7151,5,3.3228}p{0.4877,0.5562,0.2,0.1667}p{1.1868,0.125,0.1111}p{3,2,0.763,0.5,0.4358}p{0.3233,0.3617}p{2.0649,1.2159,0.5229}p{0.5831,0.2,0.301}p{0.3333,0.5,1.3106,2,2.2947}p{2.0505,1.7979,5,6}p{3.0933,2.7645}p{0.8426,8,9}p{0.4843,0.8225,1.9124}p1{4,2.6143,3.6675}p{0.25,0.3825,0.2727}p1),where E(CRC') = 0.0873.Steps 4 and 5. Utilize the EVM-SPM to get priorities of the clusters of elements from the improved comparison matrices related to Table 7, then construct an unweighted supermatrix, shown in Table 10. Particularly, the obtained priorities of C1, C2, C3, C4 and C5 against E1 are as follows:pC1E1=0.1152,pC2E1=0.4525,pC3E1=0.1391,pC4E1=0.2432,andpC5E1=0.0502Similarly, the priorities of the clusters can also be obtained, shown in Table 11, which are used to weight the clusters of elements in the block of the unweighted supermatrix.Step 6. According to the priorities of the clusters and the unweighted supermatrix, we can construct a stochastic matrix, shown in Table 12.Step 7. For a stochastic supermatrix, limiting priorities of all the elements depend on its reducibility, primitivity, and cyclicity (Saaty, 2004). Since the stochastic matrix in step 7 is irreducibility, and the eigenvalue λ = 1 is single, we develop an iterative method shown in Algorithm 6 to output the limiting priorities from the stochastic matrix.Algorithm 6Step 1:Input the supermatrix M = (mij)n × n, and let d' = 0.00005 be the accuracy.Let k = 0, output the initial eigenvector ω(k) by the EVM.Calculate ω(k + 1) = Mω(k), then normalizeω(k+1)=ω(k+1)/∑i=1nωi(k+1).If|ωi(k+1)−ωi(k+1)|<d′(i = 1, 2, …, n), output ω(k + 1) and then go to step 5; else let k = k + 1, and then go to step 2.End.According to Algorithm 6, the limiting priorities of all the elements can be obtained after 24 iterations listed as followsE1=0.0350,E2=0.0281,E3=0.0345,E4=0.0231,E5=0.0246,E6=0.0195,E7=0.0266,E8=0.0233C1=0.0504,C2=0.0555,C3=0.0381,C4=0.0502,C5=0.0493,B1=0.0546,B2=0.0578,B3=0.0307,B4=0.0505,B5=0.0415,R1=0.0269,R2=0.0392,R3=0.0267,R4=0.0220,R5=0.0443,P1=0.0284,P2=0.0329,P3=0.0225,P4=0.0295,P5=0.0342.Step 8. Apart from the energy channels, we normalize the limiting priorities to get the final priorities, denoted as follows:C1′=0.0642,C2′=0.0706,C3′=0.0485,C4′=0.0639,C5′=0.0628,B1′=0.0695,B2′=0.0736,B3′=0.0391,B4′=0.0644,B5′=0.0529,R1′=0.0343,R2′=0.0499,R3′=0.0340,R4′=0.0281,R5′=0.0564,P1′=0.0362,P2′=0.0419,P3′=0.0287,P4′=0.0376,P5′=0.0435.With respect to each energy channel, the property values of the elements are obtained by some public resources and National Administration of Surveying, Mapping and Geoinformation. Since the process of data acquisition is not related to our topic, we directly list the normalized property values in Table 13.Then by aggregating the normalized property values and the final priorities, we can get the risk scores of the eight energy channels, denoted as follows:S(E1)=0.5812,S(E2)=0.5141,S(E3)=0.4863,S(E4)=0.5731,S(E5)=0.5051,S(E6)=0.1001,S(E7)=0.3025,S(E8)=0.1131.The bigger value the risk scores, the higher level of risk the energy channels have. We use regions in different colors to show the risk levels of piracy for the eight energy channels in Fig. 4.It is clear that South Sea and Gulf of Aden have high risk levels of piracy. So they deserve more protection from piracy.

@&#CONCLUSIONS@&#
In this paper, we have developed a generalized analytic network process (G-ANP) as an important extension of the analytic hierarchy process (ANP) to improve its modeling abilities in practice. In the framework of the ANP, the contribution of this study is the development of a systematic concepts and methods to deal with multiple forms of preferences which are called complex judgments. Another contribution is the implementation of the G-ANP in Matlab and Excel environments as a working prototype for a decision support system. The G-ANP also eliminate the drawbacks of the fuzzy analytic network process (F-ANP) that cannot take consistency into account.In the G-ANP, as a new prioritization method, an eigenvector method based stochastic preference method (EVM-SPM) has been developed to derive priorities from complex comparison matrices (CCMs). As comparison matrices, interval comparison matrices, hesitant comparison matrices, and stochastic comparison matrices can be considered as special cases of CCMs, the EVM-SPM can straightforwardly be applied to them for deriving priorities.We have applied the G-ANP to a piracy risk assessment problem. By a statistic method, the preferences provided by 100 military experts are collected and specified by probability functions. Following a step by step procedure of the G-ANP, we show the detail to demonstrate the G-ANP in dealing with this problem. The G-ANP is specially useful for decision making problems with large data sets, or even big data. In the future work, more studies can focus on CCMs related to consistency checking, consistency improving, and prioritization, etc.