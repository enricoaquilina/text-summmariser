@&#MAIN-TITLE@&#
The multicriteria p-facility median location problem on networks

@&#HIGHLIGHTS@&#
This paper discusses the multicriteria p-facility median location problem on networks with positive and negative weights.Demand is located at the nodes with a variable weight according to the criterion under consideration.We obtain the set of non-dominated objective values as well as the set of Pareto-optimal locations.This paper provides an efficient algorithm to solve the bicriteria 2-facility problem.The general problem is also solved by a polynomial algorithm provided the number of facilities is fixed.

@&#KEYPHRASES@&#
Network location,Multicriteria optimization,p-Facility location,

@&#ABSTRACT@&#
In this paper we discuss the multicriteria p-facility median location problem on networks with positive and negative weights. We assume that the demand is located at the nodes and can be different for each criterion under consideration. The goal is to obtain the set of Pareto-optimal locations in the graph and the corresponding set of non-dominated objective values. To that end, we first characterize the linearity domains of the distance functions on the graph and compute the image of each linearity domain in the objective space. The lower envelope of a transformation of all these images then gives us the set of all non-dominated points in the objective space and its preimage corresponds to the set of all Pareto-optimal solutions on the graph. For the bicriteria 2-facility case we present a low order polynomial time algorithm. Also for the general case we propose an efficient algorithm, which is polynomial if the number of facilities and criteria is fixed.

@&#INTRODUCTION@&#
Many real-world applications are concerned with finding an optimal location for one or more new facilities on a network (road network, power grid, etc.) minimizing a function of the distances between these facilities and a given set of existing facilities (clients, demand points), where the latter typically coincide with vertices. For a recent book on location theory the reader is referred to Nickel and Puerto (2005) and references therein. Since the first seminal paper by Hakimi (1964), an ever growing number of results have been published in this field.The majority of research focuses on the minimization of a single objective function that is increasing with distance. However, in the process of locating a new facility usually more than one decision maker is involved. This is due to the fact that often the cost incurred with the decision is relatively high. Furthermore, different decision makers may (or will) have different (conflicting) objectives. In other situations, different scenarios must be compared due to uncertainty of data or still undecided parameters of the model. One way to deal with these situations is to apply scenario analysis. Another way of reflecting uncertainty in the parameters is to consider different replications of the objective function. Hence, there exists a large number of real-world problems which can only be modeled suitably through a multicriteria approach, especially when locating public facilities.An additional difficulty is that we are usually dealing with conflicting criteria and a single optimal solution does not always exist (which would be an optimal solution for each of the criteria). Therefore, an alternative solution concept has to be used. One possibility is to determine the set of non-dominated solutions. That is, solutions such that there exists no other solution which is at least as good for all decision makers and strictly better for at least one of them. These solutions are often called Pareto-optimal. For an overview on multicriteria location problems the reader is referred to Nickel, Puerto, and Rodríguez-Chía (2005).In contrast to the practical needs described above, network location research involving multiple criteria has received little attention, especially when it comes to multiple facilities. In this paper, we consider the p-facility median location problem with several objective functions. Hereby, each objective function is representing the goal of one decision maker and the aim is to locate p facilities in order to minimize the total weighted distance from the clients to their closest facility. The weights assigned to clients vary from one decision maker to another, yielding different objective functions. It might even happen that one of the facilities is desirable for some decision makers and, at the same time, undesirable for others. Undesirable facilities are usually modeled using negative weights. See Eiselt and Laporte (1995) for more details on these problems. Before we discuss the literature, we present a practical example for this model. Suppose we want to locate two garbage dumps and we have a set of residential and recreational areas and a set of industrial sites where garbage has to be collected. There are two decision makers involved: the “Business economist” who has to keep the costs in check and the “Politician” who is concerned about the nuisance of the garbage dumps and the garbage trucks on the population. The business economist wants the dumps to be close to all sites to minimize travel times and costs. To that end he associates positive weights with the residential and industrial areas that are proportional to the average number of required garbage collections. In contrast to that, the politician wants to minimize the nuisance of the garbage dumps and of the trucks frequenting the garbage dumps for the population. Therefore, he assigns to each site a second, negative value. The smaller the weight is, the more likely it is that the residential area is far away from the dumps and the less likely it is that trucks that are not bound for these areas are simply passing through them on their way to the dumps. Formulating this problem in mathematical terms results in a bi-criteria 2-facility location model.There are many other applications of multicriteria multifacility location problems. Bitran and Lawrence (1980) consider the multicriteria location of regional service offices in the expanding operating territories of a large property and liability insurer. These offices serve as first line administrative centers for sales support and claims processing. Another application of multiobjective optimization in the context of location theory can be found in Johnson (2001) that discusses a spatial decision making problem for housing mobility planning. Ehrgott and Rau (1999) present an analysis of a part of the distribution system of BASF SE, which involves the construction of warehouses at various locations. The authors evaluate 14 different scenarios and each of these scenarios is evaluated with the minimal cost solution obtained through linear programming and the resulting average delivery time at this particular solution. For more applications see Schöbel (2005), Carrano, Takahashi, Finseca, and Neto (2007), and Kolokolov and Zaozerskaya (2013).Concerning the methodological aspects of multicriteria network location problems, Hamacher, Labbé, and Nickel (1999) discuss the network 1-facility problem with median objective functions. They show that for Pareto-optimal locations on undirected networks no node dominance result can be proven. Hamacher, Labbé, Nickel, and Skriver (2002) provide a polynomial time algorithm for the 1-facility problem when the objectives are both weighted median and anti-median functions. The method is generalized for any piecewise linear objective function. Zhang and Melachrinoudis (2001) develop a polynomial algorithm for the 2-criteria 1-facility network location problem maximizing the minimum weighted distance from the service facility to the nodes (maximin) and maximizing the sum of weighted distances between the service facility and the nodes (maxisum). Skriver, Andersen, and Holmberg (2004) introduce two sum objectives and criteria dependent edge lengths for the 1-facility 2-criteria problem. Nickel and Puerto (2005) solve the 1-facility problem when all objective functions are ordered medians. Colebrook and Sicilia (2007a, 2007b) provide polynomial algorithms for solving the cent-dian 1-facility location problem on networks with criteria dependent edge lengths and facilities being attractive or obnoxious.Concerning the single criterion multifacility location problem on networks, Kalcsics (2011) derives a finite domination set for the p-median problem with positive and negative weights. For the 2-facility case, the author presents an efficient solution procedure using planar arrangements. Based on this approach, Kalcsics, Nickel, Puerto, and Rodríguez-Chía (2012) solve the 2-facility case for different equity measures.Many of the previous papers study the problem on trees as a particular case of generalized networks. The first work dealing with several objectives and facilities is provided by Tansel, Francis, and Lowe (1982) who develop an algorithm for finding the efficient frontier of the biobjective multifacility minimax location problem on a tree network. This problem involves as objective functions the maximum of the weighted distances between specified pairs of new and existing facilities.Despite its intrinsic interest as discussed above, to the best of our knowledge there are no papers discussing the multicriteria p-facility median location problem on networks and no results are known until the moment to obtain the set of Pareto-optimal solutions.The remainder of this paper is organized as follows. Section 2 introduces the notation and concepts used throughout the paper. Section 3 presents some properties of the k-criteria p-facility median problem on networks. Section 4 is devoted to the development of a polynomial algorithm for the 2-criteria 2-facility version of the problem. A solution procedure for the general case is proposed in Section 5. Finally, Section 6 contains some conclusions and possible extensions of the analyzed problems.LetG=(V,E)be an undirected connected graph with node setV={v1,…,vn}and edge setE={e1,…,em}. Each edgee∈Ehas a positive lengthℓ(e), and is assumed to be rectifiable. LetA(G)denote the continuum set of points on edges of G. We denote a pointx∈e=[u,v]as a pairx=(e,t), where t (0⩽t⩽1) gives the relative distance of x from node u along edge e. For the sake of readability, we identifyA(G)with G andA(e)with e fore∈E. Letk⩾1be the number of criteria of the problem and defineQ={1,…,k}. Each vertexvi∈Vhas a real-valued weightwiq∈R,q∈Q. LetJ={1,…,p}, where p is the number of facilities to be located. We denote byX=(x1,…,xp)the vector of locations of the facilities, wherexj∈G,j∈J. (Note that in order to allow co-location, which is quite common in location problems with negative weights, we have to represent the facility locations using a vector.) In the remainder, we use the notions location vector and solution synonymously.We denote byd(x,y)the length of the shortest path connecting two pointsx,y∈G. Letvi∈Vandx=([vr,vs],t)∈G. The distance fromvito x entering the edge[vr,vs]throughvr(vs) is given asDi+(x)=d(vr,x)+d(vr,vi)(Di-(x)=d(vs,x)+d(vs,vi)). Hence, the length of a shortest path fromvito x is given byDi(x)=min{Di+(x),Di-(x)}. Asd(vr,x)=t·ℓ(e)andd(vs,x)=(1-t)·ℓ(e), the functionsDi+(x)andDi-(x)are linear in x andDi(x)is piecewise linear and concave in x, cf. Drezner (1995). The distance fromvito its closest facility is finally defined asDi(X)=minj∈JDi(xj)=minj∈J{Di+(xj),Di-(xj)}. In the following, we call the functionsDi+/-(x)andDi(X)distance functions of nodevi. Moreover, we say thatDia(xj),a∈{+,-}, is active for X, ifDia(xj)=Di(X).We consider the objective functionF(X)=(F1(X),…,F|Q|(X)), where eachFq(X),q∈Q, is a median function defined as:Fq(X)=∑i∈VwiqDi(X).We assume the usual definition of Pareto-optimality or efficiency (Ehrgott, 2005). That is, a solution X is called efficient or Pareto-optimal, if there exists no solutionX′which is at least as good as X with respect to all objective function values and strictly better for at least one value, i.e.,∄X′:Fq(X′)⩽Fq(X),∀q∈Q, and∃q∈Q:Fq(X′)<Fq(X). If X is Pareto-optimal,F(X)∈Rkwill be called a non-dominated point. IfFq(X)⩽Fq(X′)∀q∈Qand∃q∈Q:Fq(X)<Fq(X′)we say X dominatesX′in the decision space andF(X)dominatesF(X′)in the objective space.The k-criteria p-facility median location problem on networks, denoted by(k,p)-MLPN, is now defined as the problem of determining the set of all Pareto-optimal solutions on the graph:(1)v-minX∈G×…p×GF(X),wherev-minstands for vector minimization. We denote byX̃the set of all Pareto-optimal solutions of (1). As mentioned in the introduction, we are interested in obtaining a description of the complete sets of Pareto-optimal solutions (in the decision space) and the non-dominated points (in the objective space). Hereby, the set of Pareto-optimal solutions comprises all alternative location vectors for the p facilities that are suitable candidates to choose from, because no other point can give rise to objective values that dominate them component-wise.Leth=(eh1,…,ehp)be a p-tuple of not necessarily distinct edges, whereehj∈E,j∈J. Then, the(k,p)-MLPN can be equivalently formulated as:v-min{F(X)|X∈eh1×⋯×ehp,h∈E×⋯×E}.Note that because of symmetry it is sufficient to consider only p-tuples h for whichh1⩽⋯⩽hp.Leth=(eh1,…,ehp)be a p-tuple of edges andX∈eh1×⋯×ehpwithxj=(ehj,tj),0⩽tj⩽1. In the following, we derive a subdivision ofeh1×⋯×ehpinto maximal subsets such that the distance function of each node is linear over such a subset, i.e., each node is allocated to the same facility for all location vectors in the subset and each node reaches its closest facility via the same vertex of the edge that contains this facility. This subdivision will be a building block of our solution approach.Letvi∈V. As the functionsDi+(xj)andDi-(xj)are linear forxj∈ehj, the distance functionsDi(X)are piecewise linear and concave forX∈eh1×⋯×ehp. Moreover, a breakpoint ofDi(X)occurs if:•there are either two distinct facilitiesxjandxj′at the same closest distance fromvi, i.e.,Di(X)=Dia(xj)=Dia′(xj′)fora,a′∈{+,-}, or ifthe shortest paths fromvito its closest facilityxj=([vr,vs],tj)viavrand, respectively,vshave the same length, i.e.,Di(X)=Di+(xj)=Di-(xj).It is noteworthy that the breakpoints ofDi(X)for anyvi∈Voccur only for active functionsDia(·). See Example 1 for an illustration.Example 1Letp=k=2and consider the graph depicted in Fig. 1. The node weightswi=(wi1,wi2)and the edge lengths are shown in the figure.Consider the pair of edgesh=([v2,v3],[v4,v5]). In Fig. 2we depict the resulting sets of breakpoints of the distance functions over[v2,v3]×[v4,v5](bold lines). The thin dashed lines indicate sets of intersection points between pairs of distance functionsDia(·)where at least one of the functions is not active.The breakpoints for all other edge pairs are depicted in Appendix A.To derive the desired subdivision, we identify each edge of the network with the unit interval[0,1]. Hence, the cartesian producteh1×⋯×ehpof the edges of h corresponds to the unit hypercube[0,1]p. For the ease of notation, we identifyxjwithtjin the remainder. The sets of location vectors that fulfill the breakpoint conditionsD(X)=Dia(xj)=Dia′(xj′)andD(X)=Di+(xj)=Di-(xj)define hyperplanes in[0,1]p. The set of all these hyperplanes induces a subdivision of the hypercube into subsets such that each distance functionDi(X)is linear over each subset of this subdivision. Such a subdivision is also called an arrangement and the subsets are called cells, see de Berg, Cheong, van Krefeld, and Overmars (2008). As these hyperplanes resemble the breakpoints, each cell of the subdivision is maximal in the sense that all distance functionsDi(X),vi∈V, are linear over the cell. As the subdivision is induced by hyperplanes, all cells are convex polygons. For more details see Kalcsics (2011). In the following, we denote byChthe set of all cells of the subdivision for h. Moreover, for a setD⊆Rn,ch(D)denotes the convex hull ofD,ext(D)the set of extreme points of D, and|D|the cardinality of D.Example 1 (cont.).Fig. 2 shows the subdivision of[0,1]2into cells induced by the breakpoints for the edge pair h. In the following, we identify a solutionX=(([v2,v3],t1),([v4,v5],t2))on the graph with the corresponding pointx=(t1,t2)on the unit square. Then, the two cellsC1andC2of the subdivision are given byC1=ch({(0,0),(1,0),(1,1),(0.5,1),(0,0.5)})andC2=ch({(0,0.5),(0.5,1),(0,1)}).For any location vector X in the relative interior of a cell we either haveDi(x1)<Di(x2)orDi(x1)>Di(x2), i.e., each node will be served by the same facilityx1orx2. Moreover, for each nodevithe shortest path from the node to its closest facilityxjwill always pass through the same endpoint of the edge containing the facility, i.e., we either haveDi+(xj)<Di-(xj)orDi+(xj)>Di-(xj).To determine the set of Pareto-optimal solutions in the graph, we have to compute all non-dominated points of the set{F(X)|X∈G×…p×G}in the objective space. To that end, using the subdivision introduced in the previous section for a given p-tuple h of edges, it will be necessary to compute in a first step the images of all cells of this subdivision. Given these images for all p-tuples h, we are then able to derive the set of non-dominated points. In a last step, we have to identify the set of location vectors on the graph whose image corresponds to the non-dominated points. These location vectors then comprise the set of Pareto-optimal solutions of our problem. In this section we discus how to compute images of cells and preimages of sets of points in the objective space. Moreover, we present some properties of the objective function of the(k,p)-MLPN. The determination of the set of non-dominated points is described in the next sections.Leth=(eh1,…,ehp)be a p-tuple of edges,Chthe subdivision of[0,1]pinto cells, andCbe a cell inCh. Recall thatF(X)=(F1(X),…,Fk(X))is a mapping fromG×…p×GtoRk. We first show how to compute images of cells.Lemma 1Image of a cellThe function F is an affine mapping overC∈Ch, i.e.,F:C→Rq,F(X)=At+b,A∈Rk×p,b∈Rk, andt∈[0,1]p. Moreover, the imageF(C)of the cell has dimensionrank(A)with0⩽rank(A)⩽min{p,k}and can be represented in the objective space as the convex hull of the images of the extreme points ofC.LetX=((eh1,t1),…,(ehp,tp))∈C. As each distance functionDi(X)is linear overC, so will beFq(X),q∈Q. Hence, we can writeFq(X)=a1qt1+⋯+apqtp+bqwhereajq,bq∈R,q∈Q. Therefore,F(X)=F1(X)⋮Fk(X)=a11t1+…+ap1tp+b1⋮a1kt1+…+apktp+bk=a11…ap1⋮⋮⋮a1k…apkt1⋮tp+b1⋮bk≕At+bis an affine mapping. Moreover,F(C)is a polytope of dimensionrank(A), with0⩽rank(A)⩽min{p,k}.As F is an affine mapping overC, it preserves collinearity and ratios of distances. Letext(C)={vc|c=1,…,|ext(C)|}. SinceCis convex,F(C)is a convex set given byF(C)=Fch({ext(C)})=F∑c=1|ext(C)|λcυc|λc⩾0,∑c=1|ext(C)|λc=1=∑c=1|ext(C)|λcF(υc)|λc⩾0,∑c=1|ext(C)|λc=1=ch({F(vc)|vc∈ext(C)}).□If a proper subsetUof the imageF(C)of a cellCbelongs to the set of non-dominated points of{F(X)|X∈G×…p×G}in the objective space, we have to derive the set of points ofCwhose image corresponds toU. The next result provides a characterization of the preimage of a convex setU⊊C. Its proof follows directly from the properties of affine mappings. We will see in the next sections why it is sufficient to restrict ourselves to convex setsU.Lemma 2Preimage of a setLetC∈Chbe a cell andUbe a convex subset ofF(C)with extreme pointsz1,…,zϑ,ϑ⩾1. The preimageF-1(U)ofUis given byF-1(U)=ch({t∈[0,1]p|zc=At+bfor somec∈{1,…,ϑ}}).In this way,F-1is well defined.Note thatF-1(U)depends on the cellC. Therefore, we have to store for each pointt∈Rkin the objective space the cell(s) who “generated” this point, i.e., to whose imageF(C)the point t belongs to.The next example illustrates the computation of images and preimages.Example 1 (cont.). Consider again the graph depicted in Fig. 1, and the edge pairh=(eh1=[v2,v3],eh2=[v1,v4]). The subdivisionChcontains a single cell that coincides with the whole unit square, i.e.,Ch={[0,1]2}. LetX=(x1,x2)withx1=(eh1,t1)andx2=(eh2,t2).1.Using the weightsw1=(3,3)andw2=(2,1)for nodesv1andv2instead of the ones depicted in Fig. 1, we obtainF1(X)=4t1+4(1-t1)+3t2+(1-t2)+2(2+(1-t2))=11F2(X)=2t1+2(1-t1)+3t2+(1-t2)+2(2+(1-t2))=9.Hence,F(X)=0000t1t2+119.Sincerank(A)=0, the imageF(C)ofC=[0,1]2is a single point, namely(11,9). Furthermore,F-1(F(C))=C∩R2=C. Fig. 3showsC, its imageF(C)and the preimage ofF(C).Using now the alternative weightsw1=(3,2)andw5=(1,2)for nodesv1andv5, we obtainF1(X)=2t1+4(1-t1)+3t2+(1-t2)+(2+(1-t2))=8-2t1+t2F2(X)=4t1+2(1-t1)+2t2+(1-t2)+2(2+(1-t2))=9+2t1-t2.Hence,F(X)=At+b=-212-1t1t2+89.Sincerank(A)=1, the image ofCis now a line segment given bych({(6,11),(9,8)}). For computing the preimage, letU=ch({(8.5,8.5),(7.5,9.5)})⊊F(C). Then,F-1(U)=C∩cht1t28.58.5=At+bor7.59.5=At+b=C∩cht1t2|2t1-t2+0.5=0or2t1-t2-0.5=0.Hence,F-1(U)is the set of all points of the square[0,1]×[0,1]between the two parallel lines defined by2t1-t2+0.5=0and2t1-t2-0.5=0. Fig. 4depictsC, its imageF(C), and the preimage ofU⊆F(C).Using the alternative weightw1=(1,2)for nodev1, we obtainF1(X)=2t1+4(1-t1)+t2+(1-t2)+2(2+(1-t2))=11-2t1-2t2F2(X)=4t1+2(1-t1)+2t2+(1-t2)+2(2+(1-t2))=9+2t1-t2.Hence,F(X)=At+b=-2-22-1t1t2+119.Sincerank(A)=2, the image ofCis now a polygon with vertices(7,10),(9,8),(11,9), and(9,11). For computing the preimage, letU=ch({(9,11),(8,10),(9,9)})⊊F(C). Then,F-1(U)=C∩cht1t2911=At+b,810=At+b,or99=At+b=C∩ch({(1,0),(5/6,2/3),(1/3,2/3)}),which is again a triangle. Fig. 5showsC, its imageF(C), and the preimage ofU⊆F(C).In this section we first discuss the(2,2)-MLPN to explain the main ideas of our solution approach, before we turn to the general case in Section 5. In the following, we present the different steps of the approach. For a given pair of edgesh=(eh1,eh2), we first compute the setChof cells of the subdivision of[0,1]2into maximal domains of linearity of the distance functionsDi(X). Afterwards, we compute the imageF(C)of each cellC∈Ch. Depending on the rank of the mapping F with respect toC, the image is either a point, a line segment, or a two-dimensional polygon, see Lemma 1. We store for each image a reference to the cellC. To determine the set of non-dominated pointsZ∼of the images of all cells in the objective space, we adapt the approach in Hamacher et al. (1999) for the single facility bi-criteria problem. The idea of their approach is to determine the set of non-dominated points in the objective space by means of the lower envelope. To facilitate that approach, they add to the rightmost point of each image a right-open horizontal halfline (asp=1, all images are points or segments). Then, each point in the objective space that is not on the lower envelope will obviously be dominated by a point on the envelope. At the end, they delete all parts of the lower envelope that belong to horizontal halflines that have been added before. The remaining points then comprise the set of all non-dominated points. Coming back to our problem, to compute the set of all non-dominated points in the objective space, we compute the imageF(C)of each cellC∈Chfor all edge pairs h (where it is sufficient to consider only pairs withh1⩽h2). If the image is a point or a segment, we add it to a setLtogether with a reference to the respective cell. IfF(C)is a polygon, all interior points will be dominated by points on the boundary. Thus, we only add the bounding edges of the polygon toL, again with a reference to the respective cell. Note that each polygon has at most eight bounding edges (Kalcsics, 2011). In view of the general case to be discussed in Section 5, we generalize the approach in Hamacher et al. (1999) as follows. We add to the bottommost point of each image a horizontal and a vertical halfline extending to+∞. Then, we first determine the lower envelope in y-direction and afterwards the lower envelope of the remaining points in x-direction. In this way, all dominated points will be eliminated. Formally, letle1,le2denote the lower envelope functions of a set with respect to the directions of the two components of the canonical basis ofR2. Given a collectionL⊂R2of points and segments, Procedure 1 summarizes the steps to obtain the set of non-dominated points in the objective space.Procedure 1Computing the non-dominated set of a collectionL⊂R21.For each connected component ofLfind the point(z1,z2)of the component which has the smallestz2value and augment the horizontal halfline{(z1+s,z2)|s∈R+}and the vertical halfline{(z1,z2+s)|s∈R+}toL.ComputeZ̃=(le1∘le2)(L).The outputZ∼of Procedure 1 is a collection of segments and points. Note that by applying both lower envelope functions, all horizontal and vertical halflines added in Step 1 are deleted at the end. Each elementℓofZ∼is a point or a subset of a segment ofLand contains a reference to the set of elements ofLin which it is contained. Therefore, we can immediately determine the setC(ℓ)of all cells whose image containsℓ. As, in turn, each element ofLcontains a reference to the cell generating this element, we can readily compute the preimage ofℓwith respect to each cellC∈C(ℓ)using Lemma 2. The union of all these preimages yields the set of Pareto-optimal solutions. Algorithm 1 gives a complete description of our approach to compute the sets of non-dominated points and Pareto-optimal solutions.Algorithm 1Solution method for the(2,2)-MLPNConcerning Step 6, the setLhasO(n2m2)elements. Hence, we have to addO(n2m2)horizontal and vertical lines, which can be done inO(n2m2)time. The lower envelope can be computed inO(n2m2log(nm))and containsO(n2m2α(n2m2))number of elements (Hershberger, 1989), whereα(·)is the inverse of the Ackerman’s function. Hence, the overall complexity for Step 6 isO(n2m2log(nm)).As for the computation of preimages of elements in the set of non-dominated points, Step 8 can be done in constant time since it is part of the output of the lower envelope algorithm. Step 10 can be carried out in constant time since the preimage of a point or segment has at most eight bounding segments. Thus, the overall complexity of Steps 7–10 is equal to the number of components ofZ∼, that isO(n2m2α(n2m2)). With this, the overall complexity of Algorithm 1 isO(n2m2log(nm)).Remark 2Speed-up improvementIf the image of a cell is a polygon it is not necessary to add all bounding segments ofF(C)toLsince some of them will be dominated. To compute the set of all locally non-dominated bounding segments ofF(C), we first find the verticesu1andu2ofF(C)with the smallestF1andF2value, respectively. Then, starting atu1we add toLall bounding segments ofF(C)when walking fromu1alongbd(F(C))in clockwise direction towardsu2. Although this does not improve the worst case complexity, the actual time required to compute the lower envelope will decrease.LetCh={C1,C2}be the subdivision into cells obtained in Fig. 2 forh=([v2,v3],[v4,v5]). Denoting a pointX=(([v2,v3],t1),([v4,v5],t2))of the unit square asX=(t1,t2), the cellsC1,C2can be described byC1=ch({(0,0),(1,0),(1,1),(0.5,1),(0,0.5)})andC2=ch({(0,0.5),(0.5,1),(0,1)}). The description ofF(X)forX∈[v2,v3]×[v4,v5]depends on the cell under consideration and is given by:Fig. 6shows in dashed and dotted lines the image ofC1and, respectively,C2. The set of non-dominated pointsZ∼obtained by using Procedure 1 is given by:Z∼={(6,8)}∪{(9-2t1,7+2t1),0.5<t1⩽1,0⩽t2⩽1},and is depicted in Fig. 6 by the black segments and filled dots.Computing the preimages of the setZ∼we obtain the following set of Pareto-optimal solutions:X∼=(v2,v5)∪([v2,v3],t1),([v4,v5],t2):0.5<t1⩽1,0⩽t2⩽1Remark 3The(2,2)-MLPN on treesIf the underlying graph is a tree, the complexity of Algorithm 1 reduces by a factor of n since the number of cells of a subdivision of[0,1]2into linearity domains is at mostO(n), see Kalcsics (2011).In this section we show how to extend the previous results in order to derive an algorithmic approach to solve the general problem with p facilities and k criteria, i.e., the(k,p)-MLPN. Note first that the(k,p)-MLPN is NP-hard (if p is part of the input) because it generalizes the (1,p)-MLPN (Hakimi, 1965). Thus, there does not exist a polynomial algorithm to solve the(k,p)-MLPN (unlessP=NP).The outline of the approach for the general case is the same as forp=k=2. For a given p-tuple of edgesh=(eh1,…,ehp)we first compute the setChof cells of the arrangement that gives us the subdivision into linearity domains (Kalcsics, 2011). For each cellC∈Chwe then compute the imageF(C)ofC. IfF(C)has dimension lower than k, we add it to a setL. IfF(C)has dimension k we just add the facets of the induced polytope toL. Moreover, we store for each element augmented toLa reference to its respective preimage (a cellC∈Ch). We repeat this for all p-tuples h (where it is sufficient to consider only p-tuples withh1⩽…⩽hp). To compute the set of Pareto-optimal solutionsX∼, we adapt Procedure 1 to the general case with p facilities and k criteria as follows. Again we denote byleqthe lower envelope function of a set with respect to the direction of the qth component of the canonical basis ofRk(see Sharir (1994) for details on the lower envelope procedure).Procedure 2Computing the non-dominated setZ∼of a collectionL⊂RkGiven a collectionL⊂Rkof polytopes (of dimension lower than or equal tok-1) the setZ∼⊆Lof non-dominated points ofLcan be obtained as follows:1.For each elementθ∈Lcompute the convex hull of the domination cones attached to each pointc∈θ. Then add toLthe set of all facets of this set.Compute(le1∘…∘lek)(L).Algorithm 2 now gives a description of the necessary steps required to compute the set of Pareto-optimal solutions and non-dominated points.Algorithm 2(k,p)-MLPNConcerning Step 6, for each elementθ∈Lwe have to compute the union of the domination cones attached to each pointc∈θ, i.e., the setT={c+R⩾k|c∈θ}. Asθis convex, this set is identical to the convex hull of the domination cones attached to each extreme point ofθ, i.e.,T=ch({c+R⩾k|c∈ext(θ)}). To compute T for eachθ∈L, we restrict the domination cones to[0,M]kwhere M is sufficiently large. Then T=ch({c∪{a∣a=c+Meq, eq=(0,…q-1,0,1,0,…,0), q∈Q}: c∈ext(θ)}) is the convex hull ofO(ηp+kηp)points. Since the convex hull ofτpoints inRkcan be computed inO(τ⌊k2+1⌋), the convex hull of the domination cones attached to the extreme points of a cell can be computed inO((kηp)⌊k2+1⌋). Next, Step 2 in Procedure 2 computes the lower envelope of the setL. Sharir (1994) shows that the complexity of the lower envelope (in one direction) inRkofδsurfaces or surface patches (all algebraic of constant degree, and bounded by algebraic surfaces of constant degree) isO(δk+∊)for any∊>0with the constant of proportionality depending on∊,k,s(the maximum number of intersections among any k-tuple of the given surfaces) and on the shape and degree of the surface patches of their boundaries. The number of facets of a polytope withτextreme points inRkisO(τ⌊k2+1⌋)(Gale, 1963). Thus, for each elementθ∈Lthe above convex hull construction generates at mostO((kηp)⌊k2+1⌋)facets. Since each choice of a p-tuple of edges generates a subdivision withO(ηp)cells, the input size of the lower envelope algorithm isO(mpηp(kηp)⌊k2+1⌋). Hence, the complexity for computing the lower envelope in each direction of the canonical basis isO((mpηp(kηp)⌊k2+1⌋)k+∊)and the overall complexity isO(k(mpηp(kηp)⌊k2+1⌋)k+∊). This implies that Step 6 can be computed inO(k(mpηp(kηp)⌊k2+1⌋)k+∊). Note that, in the worst case, the output of the lower envelope algorithm contains as many elements as the cardinality of the input, that is,O(mpηp(kηp)⌊k2+1⌋).Regarding Step 9, the number of facets (of dimensionp-1) of a cell belonging to an arrangement ofβhyperplanes inRp(recall that there areη=2np2hyperplanes of the typeDia(xj)=Dia′(xj′),i∈V,a,a′∈{+,-},j,j′∈{1,…,p}) is bounded byO(β)since each hyperplane can appear at most once on each cell. Then,ℓ=F(C)∩Z∼can be computed inO(mpη2p(kηp)⌊k2+1⌋)time, given that we have to processO(η)facets ofF(C)withO(mpηp(kηp)⌊k2+1⌋)elements in the non-dominated setZ∼. Adding one preimage ofF-1(ℓ)requires first to computeS={F-1(c),c∈ext(ℓ)}for all extreme points c ofℓinO(kpηp). Later, we compute the convex hull of S inO((kpηp)⌊p2+1⌋), and intersect the result with[0,1]pinO(2p(kpηp)⌊p2+1⌋)time. Thus, considering all cells in all p-tuples of edges, Steps 7–10 can be computed inO(mpηpmax{mpη2p(kηp)⌊k2+1⌋,2p(kpηp)⌊p2+1⌋}). Finally, the overall complexity of the complete algorithm isO(max{k(mpηp(kηp)⌊k2+1⌋)k+∊,mpηp2p(kpηp)⌊p2+1⌋})for the casek⩾3.For the bicriteria problem (2,p)-MLPN it is of interest to analyze the complexity since the lower envelope can be computed efficiently using Procedure 1. Steps 1–5 can be computed inO(pη2pmp)time as described in Algorithm 2. The remaining steps are done as in Algorithm 1. As|L|=O(pη2pmp), Step 6 requiresO(pη2pmplog(pηm))time (recall that the complexity of the lower envelope ofτelements inR2isO(τlogτ)). The difference with respect to the complexity computed in Section 4 comes from the fact that in this case we cannot exploit that the number of extreme points of each cell is bounded by a constant (eight).As for the computation of preimages of elements in the set of non-dominated points in the objective space, Step 8 can be done in constant time since it is part of the output of the lower envelope algorithm. Adding one preimage ofF-1(ℓ)requires first to computeS={F-1(c),c∈ext(ℓ)}for every extreme point c ofℓinO(pηp). Later we compute the convex hull of S inO((pηp)⌊p2+1⌋), and intersect the result with[0,1]pinO(2p(pηp)⌊p2+1⌋). Thus, considering all cells in all p-tuples of edges, Steps 7–10 can be computed inO(ηpmp2p(pηp)p2). Finally, the overall complexity of the complete algorithm isO(ηpmp2p(pηp)p2).Next, we illustrate Algorithm 2 with an example of a 3-facility 3-objective problem.Example 2LetG=(V,E)be the graph depicted in Fig. 7and letp=k=3. Weightswi=(wi1,wi2,wi3)and edge lengths are shown in the figure. Observe that nodesv2andv4contain negative weights.As before, we identify a solutionX=((e1,t1),(e2,t2),(e3,t3))on the graph with the corresponding pointx=(t1,t2,t3)of the unit cube. Choosing, for example, the edgese1=[v2,v3],e2=[v4,v5]ande3=[v2,v1], we obtain the following three hyperplanes:D2+(x1)=D2+(x3),D1-(x3)=D1+(x2),D4-(x3)=D4+(x2). Fig. 8depicts these hyperplanes and shows the resulting subdivision into linearity domains as described in Section 2.2. In this case, we obtain six cells that correspond with the different possible allocations when we place a facility on each selected edge. Consider now the cellCdelimited by the points(1,0.5,1),(1,1,1),(1,1,0.5),(0.5,1,0.5)depicted in grey in Fig. 8. In this cellv1andv2are allocated to the facility placed ine3,v3to the one placed ine1andv4,v5to the one placed ine2. For this cell, the affine linear representation of F is given byF(X)=F1(X)F2(X)F3(X)=-4-4-2-2-4+2-2-2-4t1t2t3+1517The image ofCin the objective space is depicted in Fig. 9.The resulting subset of non-dominated pointsZ∼with respect toCis given byZ∼=(7-2t3,-5+2t3,3-4t3),0.5⩽t3⩽1.Computing the preimages of the setZ∼, we obtain the following set of Pareto-optimal solutions with respect toC:X∼=(v3,v5,([v2,v1],t3)),0.5⩽t3⩽1Note that two facilities are located on the verticesv3andv5and the third facility along any point of the subedge([v2,v1],t3),0.5⩽t3⩽1.

@&#CONCLUSIONS@&#
In this paper we have provided a methodology to obtain a complete description of the set of Pareto-optimal solutions for the multicriteria p-facility median location problem on networks. It is noteworthy that this paper is the first attempt to characterize the solution set of this problem. Note that the single criteria p-facility median problem is already NP-hard and handling closest assignments makes more difficult to deal with the multifacility version.The main tools used to obtain the set of Pareto-optimal solutions is the characterization of the linearity domains of the distance functions and the lower envelope. Hence, this analysis can be easily extended to more general objective functions as long as we can again determine these domains and their image and preimage. In this sense, an open line of research is to obtain the characterization of Pareto-optimal solutions for the case of ordered median objective functions. Recall that this function includes as particular instances most classical objectives functions used in Location Theory, as for instance the median, center, k-center and cent-dian, see Nickel and Puerto (2005) for further details.