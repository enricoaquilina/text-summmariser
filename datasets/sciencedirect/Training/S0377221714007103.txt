@&#MAIN-TITLE@&#
A Lagrangian decomposition approach for the pump scheduling problem in water networks

@&#HIGHLIGHTS@&#
We propose a Lagrangian decomposition approach for the pump scheduling problem in water network.The proposed approach exploits the structure of the problem leading to smaller problems that are solved independently.A simulation based limited discrepancy search heuristic is proposed to provide high quality feasible solutions.The Lagrangian decomposition approach provides solutions with bound guarantees.Numerical testing is conducted on two real water networks.

@&#KEYPHRASES@&#
Large scale optimization,Lagrangian relaxation,Pump scheduling,Integer programming,

@&#ABSTRACT@&#
Dynamic pricing has become a common form of electricity tariff, where the price of electricity varies in real time based on the realized electricity supply and demand. Hence, optimizing industrial operations to benefit from periods with low electricity prices is vital to maximizing the benefits of dynamic pricing. In the case of water networks, energy consumed by pumping is a substantial cost for water utilities, and optimizing pump schedules to accommodate for the changing price of energy while ensuring a continuous supply of water is essential. In this paper, a Mixed-Integer Non-linear Programming (MINLP) formulation of the optimal pump scheduling problem is presented. Due to the non-linearities, the typical size of water networks, and the discretization of the planning horizon, the problem is not solvable within reasonable time using standard optimization software. We present a Lagrangian decomposition approach that exploits the structure of the problem leading to smaller problems that are solved independently. The Lagrangian decomposition is coupled with a simulation-based, improved limited discrepancy search algorithm that is capable of finding high quality feasible solutions. The proposed approach finds solutions with guaranteed upper and lower bounds. These solutions are compared to those found by a mixed-integer linear programming approach, which uses a piecewise-linearization of the non-linear constraints to find a global optimal solution of the relaxation. Numerical testing is conducted on two real water networks and the results illustrate the significant costs savings due to optimizing pump schedules.

@&#INTRODUCTION@&#
With the demand for water expected to double by the year 2035 (National Geographic, 2013), water utilities are facing unprecedented challenges to maintain a reliable infrastructure with sustainable costs.The expected population growth and the shrinking supply of fresh water are among the main reasons for the urgent need to optimize the cost effectiveness of water resources. Energy costs are a major operating expense for water utilities; approximately 4 percent of all electricity used in the United States is attributed to the operation of potable water and waste water networks (Denig-Chakroff, 2008). Besides the economic benefits, optimizing the operation of water networks could avoid unnecessary use of resources and minimize the ecological impact caused by pollution and greenhouse gas emissions.Over the last few decades, practitioners and researchers have addressed several problems in water networks, mainly in reliability (Sherali, Smith, and Kim, 1996), network expansion (Bragalli, D’Ambrosio, Lee, Lodi, and Toth, 2012; Sherali, Subramanian, and Loganathan, 2001), pipe sizing (Eiger, Shamir, and Ben-Tal, 1994), and network operations (Nitivattananon, Sadowski, and Quimpo, 1996). The problem of optimal pump scheduling has recently gained attention due to the increasingly complex electricity tariff schemes: energy utilities are providing incentives by offering cheaper electricity at low demand periods. For instance, the typical day-night pricing approach offers a night-time electricity price that is 50 percent cheaper than the day price. As renewable energy sources (i.e., wind and solar power) are being integrated into energy supply networks, electricity providers are beginning to offer dynamic electricity pricing, which varies in real time based on the realized supply and demand. Hence, forecasting electricity prices and optimizing pump schedules accordingly is becoming essential to capitalize on dynamic pricing and reduce operational costs.Several approaches have been proposed for the optimal pump scheduling problem. Zessler and Shamir (1989) proposed an iterative dynamic program that finds an optimal pump schedule for a 24-hour period given forecasted demands, the initial and final levels in the tanks, and the forecasted energy cost over the day. Brion and Mays (1991) described a methodology that combines a non-linear optimization model with a hydraulic simulation model to implicitly enforce the conservation of energy and flow equations. Jowitt and Germanopoulos (1992) presented a linear programming model where the constraints are linear approximations of the non-linear network equations; the parameters of the linear approximations are determined using simulation. Yu, Powell, and Sterling (1994) presented an optimization algorithm that uses the generalized reduced gradient method coupled with sensitivity analysis to find optimal schedules; this algorithm needs a feasible starting point and iterates so that all the interim points are feasible. Lansey and Awumah (1994) introduced simplified hydraulic and cost functions for the pumps and implemented a dynamic programming optimization algorithm. Sherali and Smith (1997) use the reformulation-linearization technique to construct a tight linear programming relaxation of the pump scheduling problem and then uses a branch-and-bound algorithm to obtain global optimal solutions. Sakarya and Mays (2000) include water quality constraints and use a simulation optimization approach that combines a non-linear optimization solver with a water network simulator. McCormick and Powell (2003) present a stochastic dynamic program that includes maximum demand charges by enforcing constraints and penalty costs on power use, which provides solutions for the case where a single maximum demand charge is considered. A pump scheduling problem similar to the one considered in this paper is presented by McCormick and Powell (2004), who proposed a two-stage simulated annealing heuristic that produces high quality solutions in relatively short computational time. A two-stage heuristic approach was also proposed by Ulanicki, Kahler, and See (2007), where the first stage optimizes the tank trajectories and the second stage attempts to find a schedule that tracks the optimal trajectories. Another metaheuristic based on ant colony optimization was presented in López-Ibáñez, Prasad, and Paechter (2008). Giacomello, Kapelan, and Nicolini (2012) also proposed a heuristic that is based on linear programming coupled with a greedy search algorithm and demonstrated the effectiveness of the method on water networks from the literature. Gleixner, Held, Huang, and Vigerske (2012) proposed problem-specific presolving techniques for the pump scheduling problem that are of interest in this paper, and demonstrated the effectiveness of the proposed approaches on water networks from industry. Most recently, de la Perrière, Jouglet, Nace, and Nace (2014) approximated the complicating hydraulic equations using a linear function leading to a mixed integer linear model for the pump scheduling problem and showed that good feasible solutions are reached in low computational time.The main challenge for the pump scheduling problem is the non-linearities in the hydraulic and energy conservation equations that define the way water flows through a network (D’Ambrosio, Lodi, Wiese, and Bragalli, 2014). These translate to non-linearities in the constraints and the objective of the optimization problem, which makes the problem difficult to solve, and there is no guarantee that any solution will be globally optimal. The problem is further complicated by multiple time periods (typically of 30 minutes each), which lead to a very large integer optimization problem that is often challenging to solve within reasonable computational time. This paper proposes a Lagrangian decomposition (Fisher, 2004; Geoffrion, 2010) approach to exploit the structure of the problem and alleviate the computational burden. The Lagrangian decomposition relaxes the constraint that links the time periods, decoupling the problem into smaller subproblems. The smaller problems are completely independent and thus can be solved individually and in parallel, because no interaction among them is present. This Lagrangian decomposition is implemented using a cutting plane approach. Similar approaches have been successfully applied to solve several challenging problems, such as Aykin (1994),Detienne (2014),Diabat, Abdallah, and Henschel (2013),Elhedhli, Li, Gzara, and Naoum-Sawaya (2011),Geoffrion (2010),Fisher (2004),Gzara and Erkut (2009),Wang and Huang (2013),Wang, Huang, and Yang (2012),Zheng, Sun, Li, and Cui (2012). Because the Lagrangian decomposition is a relaxation, the Lagrangian subproblem solutions may not be feasible for the original problem, and thus a neighborhood search based on Improved Limited Discrepancy Search (ILDS) (Korf, 1996) is proposed to explore the search space for high quality feasible solutions. Our proposed search algorithm couples ILDS with the EPANET (EPANET (v. 2), 2008) water network simulator, which is used to verify the feasibility of solutions. ILDS provides an upper bound on the optimal objective function value, while the Lagrangian relaxation provides a lower bound. Thus, the proposed approach provides solutions of guaranteed quality. The proposed Lagrangian decomposition approach is further evaluated by comparing its performance against a Mixed-Integer Linear Programming (MILP) formulation; this MILP is a relaxation of the MINLP formulation that uses a piecewise-linearization of the non-linear constraints, and is solved using CPLEX (IBM ILOG CPLEX Optimization Studio, 2013). Our results show that the proposed approach finds solutions that are close to optimal in only a fraction of the computational time of CPLEX. Furthermore, we show that dynamic pricing electricity tariff leads to a significant reduction in energy costs when compared to the day/night pricing. Finally, the numerical results show that the optimized pump schedules lead to a reduction in average tank levels thus reducing both pumping energy and pumping cost.The contributions of the paper are threefold: (1) to the best of our knowledge, the proposed approach is the first to exploit the structure of the pump scheduling problem using Lagrangian decomposition in order to alleviate the computational burden, (2) the application of the simulation-based ILDS is novel and is shown to find solutions that are close to optimal in relatively short computational time, (3) we evaluate the effect of various dynamic pricing schemes that are currently being used in practice.The rest of the paper is organized as follows. The problem formulation and the application of Lagrangian decomposition approach are detailed in Section 2. Computational results are presented in Section 3. Finally, Section 4 concludes and illustrates future research directions.A water network consists of a set of nodes connected by pipes (or links). The nodes consist of three subsets: reservoirs (or water sources), tanks used to store water, and junctions that connect nodes and may have a demand. Pumps are a subset of the pipes, which are used to increase the pressure within the network by generating sufficient water flow to satisfy the demand. Without loss of generality, we assume that a pipe may not contain more than one pump and the pumps have a constant speed. We also assume that the planning horizon is divided into equally-sized time periods, and the water demand must be satisfied at each time period. Below is the terminology that we will use throughout the paper.Parameters:Sets:Ct:ElectricitycostintimeperiodtN:Thesetofpipesγ:SpecificweightofwaterP:Thesetofpipesthatηij:EfficiencyofpumpinstalledonP:containpumpspipe(i,j)R:ThesetofreservoirsQijU:MaximumrateofflowthroughK:Thesetoftankspipe(i,j)J:ThesetofjunctionsDj,t:DemandatjunctionjinT:ThesetoftimeperiodsperiodtEi:ElevationofnodeiPjL:MinimumwaterlevelintankjPjU:MaximumwaterlevelintankjAj:SurfaceareaoftankjΔT:LengthofeachtimeperiodTo formulate the pump scheduling problem, we define the following decision variables:qij,t:Flowrateoflink(i,j)intimeperiodt,hij,t:Headlossinlink(i,j)intimeperiodt,pi,t:Pressureatnodeiintimeperiodt,sij,t={1ifthepumpoflink(i,j)isoninperiodt,0otherwise.The following section presents the MINLP formulation for the pump scheduling problem and the proposed Lagrangian decomposition approach.The mixed-integer non-linear programming formulation of the pump scheduling problem is as follows:(1)[OP]:min∑tT∑(i,j)∈PγCtΔTηijhij,tqij,t(2)s.t.qij,t≤QijU∀(i,j)∈N/P,t∈T(3)qij,t≤sij,tQijU∀(i,j)∈P,t∈T(4)∑iqij,t−∑kqjk,t=Dj,t∀j∈J(5)qij,t((pi,t+Ei)−(pj,t+Ej)−hij,t)≥0∀(i,j)∈N/P,∀t∈T(6)(pi,t+Ei)−(pj,t+Ej)−hij,t≤0∀(i,j)∈N/P,∀t∈T(7)sij,t((pi,t+Ei)−(pj,t+Ej)−hij,t)=0∀(i,j)∈P,∀t∈T(8)hij,t=(aijqij,t2+bijqij,t+cij)∀(i,j)∈N,∀t∈T(9)Pj,tL≤pj,t≤Pj,tU∀j∈K,t∈T(10)pj,t=pj,t−1+∑iqij,t−1−∑kqjk,t−1ΔTAj∀j∈K,∀t∈T(11)qij,t≥0,sij,t∈{0,1}.The objective function (1) minimizes the power consumption. Constraints (2) enforce an upper bound on the rate of water flow in each of the pipes, and constraints (3) ensure that a pump must be on for the water to flow in the corresponding pipe. Constraints (4) conserve the flow of water, and constraints (5)–(8) are conservation of energy constraints based on the hydraulic properties of water networks where hij, tmodels the head-loss which is the difference in heads between two nodes i and j that are connected by a pipe (i, j) containing a flow qij, t. Constraints (5) and (7) are only enforced when the corresponding qij, tvariables are positive and are otherwise redundant. As shown in Eq. (8), the pipe headloss equation is assumed to follow a quadratic function where aijand bijare the resistance coefficients and cijis the shutoff head (see Eck and Mevissen, 2013; Giacomello et al., 2012) for details regarding the quadratic approximation of the pipe headloss function). Constraints (9) set the minimum and the maximum tank levels, which are enforced to ensure a reliable water levels in the tanks. Constraints (10) are the tank mass balance equation. Finally, constraints (11) denote the binary and non-negativity conditions.Problem [OP] is a non-convex MINLP that is computationally expensive to solve using a standard optimization software, with no guarantee of global optimality. In the following section, we describe a Lagrangian decomposition approach that exploits the structure of the problem. The problem is decomposed by its time periods and smaller problems are solved iteratively in a cutting plane approach.Problem [OP] exhibits a special structure that is suitable for Lagrangian relaxation (Fisher, 2004), i.e., constraints (10) are the only constraints that link the time periods, and thus relaxing these constraints decomposes the problem into smaller problems that can be solved individually. Applying a Lagrangian relaxation to constraints (10) with a multiplier μ, we get the following subproblem:[FSP]:min∑tT∑(i,j)∈PγCtΔTηijhij,tqij,t+∑jK∑tTμjt(pj,t−pj,t−1−∑iqij,t−1−∑kqjk,t−1ΔTAj)s.t.(2)--(9),(11),which decomposes into T subproblems, each of the form:(12)[SP]t:min∑(i,j)∈PγCtΔTηijhij,tqij,t+∑j∈K(μjtpj,t−μjt+1pj,t−μjt+1∑iqij,t−∑kqjk,tΔTAj)(13)s.t.qij,t≤QijU∀(i,j)∈N/P,(14)qij,t≤sij,tQijU∀(i,j)∈P,(15)∑iqij,t−∑kqjk,t=Dj,t∀j∈J(16)qij,t((pi,t+Ei)−(pj,t+Ej)−hij,t)≥0∀(i,j)∈N/P,(17)(pi,t+Ei)−(pj,t+Ej)−hij,t≤0∀(i,j)∈N/P,(18)sij,t((pi,t+Ei)−(pj,t+Ej)−hij,t)=0∀(i,j)∈P,(19)hij,t=(aijqij,t2+bijqij,t+cij)∀(i,j)∈N,(20)Pj,tL≤pj,t≤Pj,tU∀j∈K(21)qij,t≥0,sij,t∈{0,1}.Each subproblem [SP]tis solved independently, and the solution of each [SP]tis a vector[qtℏ,ptℏ,htℏ,stℏ]ℏ=1,…,H¯tthat minimizes the cost and satisfies constraints (12)–(21) at time t, whereH¯tis the set of indices for feasible solutions to [SP]t. Hence, [SP]tcan be written as:Z[SP]t=minℏ=1,…,H¯t{∑(i,j)∈PγCtΔTηijhij,tℏqij,tℏ+∑j∈K(μjtpj,tℏ−μjt+1pj,tℏ−μjt+1∑iqij,tℏ−∑kqjk,tℏΔTAj)}.For a given value of the Lagrangian variables μ, it follows that∑t∈TZ[SP]tgives a lower bound on the optimal objective function of [OP]. The Lagrangian bound is the best lower bound that is given by the Lagrangian problemmaxμ∑t∈TZ[SP]t=maxμ∑t∈Tminℏ=1,…,H¯t{∑(i,j)∈PγCtΔTηijhij,tℏqij,tℏ+∑j∈K(μjtpj,tℏ−μjt+1pj,tℏ−μjt+1∑iqij,tℏ−∑kqjk,tℏΔTAj)}.The Lagrangian problem is a nondifferentiable optimization problem that can be solved by a cutting plane method. Thus, definingθt:=minℏ=1,…,H¯t{∑(i,j)∈PγCtΔTηijhij,tℏqij,tℏ+∑j∈K(μjtpj,tℏ−μjt+1pj,tℏ−μjt+1∑iqij,tℏ−∑kqjk,tℏΔTAj)},the Lagrangian master problem is:(22)[FMP]:max∑t∈Tθt(23)s.t.θt≤∑(i,j)∈PγCtΔTηijhij,tℏqij,tℏ+∑j∈K(μjtpj,tℏ−μjt+1pj,tℏ−μjt+1∑iqij,tℏ−∑kqjk,tℏΔTAj)∀ℏ∈H¯t,∀t∈T.SinceH¯tis not known beforehand, problem [FMP] is solved iteratively starting with a relaxation that ignores the unknown cuts (23). At each iteration, the relaxation of [FMP] is solved and the resulting optimal values of the Lagrangian multipliers μ are used to solve the subproblems [SP]t, thus leading to new inequalities of the form (23) that tighten the relaxation of [FMP]. Due to the relaxation, the optimal solutions [SP]t, ∀t ∈ T provide a lower bound on the optimal Lagrangian bound (optimal solution of [FMP]). Thus at every iteration r, the lower bound is the best lower bound found so far and is given bymaxr{∑t∈TZ[SP]tr},whereZ[SP]tris the optimal solution of [SP]tat iteration r. Furthermore, at every iteration r, the optimal solution of the relaxation of [FMP] provides an upper bound∑t∈Tθtr. The algorithm is stopped when the upper and lower bounds are within the desired ε gap. In the computational results, the stopping criterion ε is set to 0.1 percent. By relaxation, the Lagrangian bound is a lower bound on the optimal objective function value of [OP]. In Section 2.3.2, we describe a simulation-based heuristic that uses the Lagrangian solution to find a feasible solution to [OP] and hence an upper bound on the optimal objective function value of [OP]. We note that subproblem (12)–(21) is still a MINLP thus solving the subproblem is the main computationally expensive part of the algorithm.In the following section, we discuss additional operational constraints that are imposed for practical implementation.Our computational experiments showed that the optimal pump schedules often contain frequent pump switching that would be impractical to carry out. Moreover, frequent activation and deactivation of pumps in short time periods reduces the lifetime of pumps and adds little benefit in reducing the energy cost. Hence, operators often require that pump schedules conform to a set of operational constraints that make them applicable in practice. For example, the following operational constraints would be typical:•A pump should remain ON for a minimum amount of time τ1.A pump should remain OFF for a minimum amount of time τ2.A pump cannot be switched ON for more than a maximum number of timesmax_startsduring the planning horizon.The above conditions can be enforced by including new binary variables and constraints into problem (1)–(11). The following binary decision variables:yij,t={1ifthepumponlink(i,j)isturnedONatperiodt,0otherwise,zij,t={1ifthepumponlink(i,j)isturnedOFFatperiodt,0otherwise,and the following constraints:(24)−sij,t−1+sij,t−yij,t≤0,∀(i,j)∈P,∀t>0,t∈T,(25)−sij,t′+yij,t≤0,∀(i,j)∈P,∀t∈T,∀t′∈T:t≤t′≤t+τ1,(26)sij,t−1−sij,t−zij,t≤0,∀(i,j)∈P,∀t>0,t∈T,(27)sij,t′+zij,t≤1,∀(i,j)∈P,∀t∈T,∀t′∈T:t≤t′≤t+τ2,(28)∑tyij,t≤max_starts,∀(i,j)∈P,ensure that the operational constraints are met. Constraints (24) force yij, tto take a value of 1 if the pump on link (i, j) is turned ON at period t, and constraints (25) force the pump to remain ON for at least τ1 time periods after it is switched ON. Constraints (26) force zij, tto take a value of 1 if the pump on link (i, j) is turned OFF at period t, and constraints (27) force the pump to remain OFF for at least τ2 time periods after it is switched OFF. Finally, constraints (28) set an upper bound on the maximum number of times each pump can be switched ON during the planning horizon.We note that constraints (24)–(28) link the time periods together and incorporating them in the Lagrangian decomposition approach makes the subproblem non-decomposable. These operational constraints could be relaxed in a similar way to the relaxation of constraints (10), but this may lead to a large number of Lagrangian multipliers. Instead, we elect to fully relax constraints (24)–(28) and not include them in the computation of the Lagrangian bound; however, these constraints are enforced in the simulation-based heuristic that is described next. We note that the Lagrangian bound remains a valid lower bound.Due to the relaxation, the Lagrangian decomposition algorithm often yields solutions that are not feasible for the original constraints. For our problem, the operational constraints are not included in the Lagrangian subproblems, making it even more unlikely that the Lagrangian solution is feasible. Search algorithms and metaheuristics are often used to transform an infeasible solution into a feasible one. Limited discrepancy search (Harvey and Ginsberg, 1995) and its improved version, the ILDS (Korf, 1996), were introduced as solution approaches for constraint satisfaction problems, where a subset of a search tree is explored for a given amount of time. To the best of our knowledge, for the first time, ILDS is combined with a branch-and-bound algorithm and applied to solve a constraint optimization problem. ILDS starts from a given solution and explores branches of a search tree in order to find a feasible solution that satisfies the constraints, and potentially with a better objective function value. In the context of our approach, ILDS takes the solution of the Lagrangian decomposition and finds a feasible solution; the search tree is a set of nodes corresponding to the variables, and a branch of a node corresponds to assigning the variable a value of either 0 or 1. Although the Lagrangian solution might be infeasible, it can become feasible by flipping the value of a small number of variables. ILDS can do this task systematically. Additionally, the operational constraints and the current best feasible solution help ILDS avoid examining search spaces that are proven to contain only inferior solutions or no solution.Let xk, tbe a variable in the domain D = {0, 1}, which represents the ON/OFF status of pump k (1 ≤ k ≤ |P|) at time period t (1 ≤ t ≤ |T|). The variables are arranged in the search tree by increasing time, and then by the variables that increase in order of pump identifier. A depth first search is then conducted, where at each node the partial assignment (i.e., values of the variables that are currently selected by the search) is checked for feasibility of the operational constraints. When values are assigned to all the variables at time t, EPANET hydraulic simulator (EPANET (v. 2), 2008) is used to verify if the current schedule satisfies the demand and to calculate the power consumption. If the partial assignment is infeasible or if the power consumption exceeds the current lowest known power consumption, then the search backtracks without assigning any values to the remaining variables. Here, the ‘lowest power consumption’ denotes the power consumption associated with the lowest cost pump schedule that satisfies the operational constraints and meets the demand for all the periods.Given that the starting point is the solution of the Lagrangian decomposition, the ILDS approach is expected to find a feasible point after a small modification to the starting point. Let j denote the number of variables that have different values than the starting point. Starting with j = 1, the ILDS approach performs a depth first search by allowing re-assignments of the values of j variables. Upon completing the search, j is incremented and the search is repeated. If the algorithm finds a better solution, it immediately stops the current search and resets the starting point to the new better solution and j to 1. The search is then restarted. The algorithm terminates when a predetermined time limit is reached or when the search space is exhausted with j = |P||T|.Fig. 1illustrates how ILDS examines the search space with four variables. The right branch in the figure indicates an assignment for variables xithat is different than the starting point while the left branch indicates an assignment that is the same as the starting point. The number displayed in the square indicates the number of variables j that have been changed in each path in order to reach the current solution. In practice, ILDS terminates its search with small j. For example, ILDS finds feasible solutions with j = 4 in the Poormond network and j = 10 in the IND1 networks that are described in Section 3.The computational results presented in Section 3 show that the proposed Lagrangian decomposition approach coupled with the simulation-based ILDS yields solutions with tight optimality gaps. To further assess the computational performance, in the following section we present a mixed-integer linear programming formulation of the pumps scheduling problem which can be solved using CPLEX.To assess the performance of the proposed Lagrangian decomposition approach, we consider the MILP formulation of the pump scheduling problem. The MILP formulation is obtained by using a piecewise-linearization of the non-linear equations. This leads to a MILP that can be solved with well-established solvers, such as CPLEX (IBM ILOG CPLEX Optimization Studio, 2013).The non-linear energy conservation equations (5)–(8) can be approximated by:(29)(pi,t+Ei)−(pj,t+Ej)=H^ij(qij,t)∀(i,j)∈N,∀t∈T,whereH^ij:R→Ris a piecewise-linearization of the headloss function for a given pipe. Similarly, the non-linear objective function (1) is approximated with a piecewise-linearization. A sample of the piecewise-linearizations of the non-linear headloss and objective functions are shown in Fig. 2.Although, the formulation obtained by using piecewise-linearizations can be solved with commercial MILP solvers, the main computational challenge is due to the large number of additional binary variables that are used to model the piecewise-linear functions (there is one binary variable for each time period, for each pipe, for each piece of the piecewise-linear function). In order to reduce the number of binaries, we implement a pre-processing technique that uses the bounds on the flow rate values to eliminate unnecessary parts of the piecewise-linear functions.For each pipe, a piecewise-linear function with κ pieces is used to describe the headloss function. The headloss functionH^ij(·)relates the difference between the pressures in its two adjacent nodes to the flow rate. Because of the elevation and pressure bounds of the connected nodes, it is often the case that the actual headloss will lie within a range that is contained by fewer than κ pieces. That is, due to the bounds on the pressures and sinceH^ij(·)is an increasing function of qij, t, the feasible range of the flow can be explicitly calculated using the headloss equation (29), and the binary variables of the piecewise-linear pieces outside of this feasible flow range can then be eliminated. The solution time of the piecewise-linear formulation was greatly reduced when the pre-processing algorithm was implemented.This section presents results for numerical experiments that were conducted on two networks. We call the first network IND1 (Fig. 3). It consists of one reservoir, two pumps, and two tanks (four nodes and four pipes) and is based on a real network provided by one of our industry partners. We call the second network Poormond (Fig. 4). Poormond is a larger network that is also based on a real water distribution system in the United Kingdom. It consists of one reservoir, seven pumps, and five tanks (47 nodes and 44 pipes). The Poormond network is adapted from the Richmond water distribution network that is used in the literature (Giacomello et al., 2012). The Richmond network available online (Richmond Water Distribution Network, 2013) was modified to the Poormond network considered here by1.controlling pumps by time rather than tank level;removing Tank E to avoid use of an implied control valve;lowering the elevation of seven nodes having zero demand by 10 meters to avoid errors due to negative pressures;using the electricity price patterns of this paper.The scheduling horizon is 24 hours, and the decisions to turn a pump ON or OFF are made at 30-minute intervals. Although a scheduling decision can be made every 30 minutes, operational constraints are required in practice to avoid frequent pump switching that shortens the life of the pumps. For example, in our implementation, pumps are required to stay ON for at least 1 hour (two periods) when switched ON. We also require that each pump is switched ON a maximum of 6 times during the 24-hour planning horizon. The final water level in the tanks is required to be at least the starting level, to ensure terminal conditions. These conditions are based on discussions with our industry partners and the approach that they currently use for the operation of their pumps.The computations were performed on a Red Hat Linux blade server with a 3.5 gigahertz processor. The Lagrangian decomposition was implemented in AMPL (Ampl, 2011) and BONMIN (Bonami et al., 2008; Bonmin (v. 1.5), 2011), and IPOPT (Ipopt (v. 3.10), 2011) was used as a non-linear optimization solver. The simulation-based ILDS that is described in Section 2.3.2 was implemented in C++ and EPANET (EPANET (v. 2), 2008) is used as a hydraulic and water network simulator. After the first feasible solution is found by ILDS, the time limit for ILDS is set to 200 seconds for IND1 and 500 seconds for Poormond. Finally, the MILP problem is implemented in CPLEX 12.4 OPL.This section provides computational results comparing the proposed Lagrangian decomposition against the MILP formulation that is solved with CPLEX. A time limit of 5 hours was imposed on CPLEX. Table 1presents the results corresponding to the IND1 and Poormond networks. For each network, five different sets of energy prices are used. The prices are based on the real energy prices that occurred on May 21–25, 2013 and can be obtained from (Single Electricity Market Operator, 2013). The following results are reported in Table 1.Price:Energy prices.Lagrangian bound which provides a lower bound on the optimal solution of [OP].Number of iterations performed by the cutting plane algorithm.Total computational time in seconds for the cutting plane algorithm.Objective function value of the solution that is found by ILDS which provides an upper bound on the optimal solution of [OP].Percent Gap between the Lagrangian upper and lower boundsGAPa=100×UB−LBUB.Total computational time in seconds for ILDS.Total computational time for the Lagrangian decomposition and ILDS, CPUT = CPULR+CPUH.Objective function value for the solution that is found by CPLEX.CPLEX percent gap.CPLEX total computational time.The results show that the proposed Lagrangian decomposition approach is capable of finding better solutions than CPLEX in significantly less computational time. Furthermore, CPLEX is only capable of finding solutions for the small IND1 network while for the Poormond network CPLEX could not find a feasible solution within the 5 hours time limit. Even for IND1, CPLEX stopped at the 5 hours time limit with solutions that are within 3 percent gap on average. We note that for IND1, the feasible solutions that were found by the Lagrangian decomposition approach had better objective function value except for IND1 on May 25. For the Poormond network, the proposed Lagrangian decomposition found solutions with gaps ranging between 6 percent and 19 percent while CPLEX failed to find solutions for all the tested instances.In the following section, we evaluate two electricity tariffs, day/night pricing and dynamic pricing, in terms of energy costs in pump scheduling.This section compares two electricity tariff schemes available in Ireland based on the results that are obtained using the proposed Lagrangian decomposition approach. The day/night pricing scheme offers a 50 percent discount on the standard electricity rate during night hours (8:00 am–11:00 pm in winter and 9:00 am–12:00 am in summer). There is also a dynamic pricing scheme, where prices change every 30 minutes. Single Electricity Market (SEM) is the wholesale electricity market operating in the Republic of Ireland, which provides the forecasted and the realized electricity prices on their website (Single Electricity Market Operator, 2013). We refer to the prices forecasted one day-ahead as “D − 1 prices”. The actual prices that are realized are settled 4 days afterwards and hence we refer to the actual prices as “D + 4 prices”. Hence, the pump schedules are optimized assuming D − 1 prices for the energy cost, while the actual realized cost is computed based on the D + 4 prices. Fig. 5, illustrates the different prices for the period May 21–25, 2013, which are used for testing in this paper.In this section, we evaluate the two pricing schemes in terms of impact on the optimal pump schedules and the resulting costs. First, we compute the optimal pump schedules and associated costs using the day/night pricing scheme. We compare this to the cost of using the forecasted D-1 prices to find optimal schedules, and computing the actual realized cost with D + 4 prices. A summary of the results is given in Table 2. Note that the Poormond network contains a single set of demands and hence the daily costs are the same when assuming the day/night pricing. In contrast, IND1 was provided by our industry partner and contains different demands for each day, so the daily cost changes when using day/night pricing. The results indicate significant savings when dynamic pricing is used. Dynamic pricing leads to an average energy cost reduction of 24 percent for the IND1 network and 34 percent for the Poormond network. Thus, there is strong incentive for water utilities to adopt dynamic pricing, which further motivates the need for optimization methods that consider the changing electricity tariff and can find low-cost pump schedules.In this section, we illustrate the pump operation and the simulated tank levels for the pump schedules that were obtained using the proposed Lagrangian decomposition approach. A summary of the pump schedules is given in Table 3. Fig. 6also illustrates the computed pump schedules for May 21. As expected, we do not see a significant difference in the total number of hours that the pumps are ON, which is due to the fact that the system operator of IND1 network has put significant effort into matching the pumping schedules with the demands.In the schedules actually implemented in the IND1 network, the pumps are active for a total of 96.6 hours, while in the optimized schedules, the pumps are active for a total of 95.8 hours. However, the optimized schedules use Pump 1 more than in the existing schedules, which results in a significant decrease in cost. Moreover, as shown in Table 4and in Fig. 7, the optimized schedules allow the tanks to operate at lower levels than they would with the current schedules: the average tank level of Tank 1 over the five days (May 21–May 25) is 1.7 meters with the optimized schedules, compared to an average level of 2.3 meters with the current schedules; this is a 26 percent decrease in average tank level. Similarly, for Tank 2, the average level is 1.5 meters compared to 2.2 meters with the existing schedules, which represents a 32 percent decrease in average tank level (note that the existing schedules that are currently being used by our industry partner to operate IND1 lead to small violations of the desired maximum tank limits). Operating water tanks at lower levels reduces the energy required to fill the tanks, thus lowering the pumping cost. However, there is a tradeoff in system reliability because higher tank levels provide a buffer against changes in system demand. For this reason, an appropriate minimum and maximum tank levels should be selected for the system under consideration. Thus as recommended by our industry partners, the minimum and maximum tank levels are set to 0.8 meter and 2.8 meters, respectively.As shown in Table 3, similar results are observed for the Poormond network. However, we note that we do not know the actual pump schedules implemented in the Poormond network. Hence, we created an initial feasible pump schedule before applying the proposed optimization approaches. Therefore, the results for the existing schedule of the Poormond network refer to an initial feasible schedule that we created without any guarantees that it is a good schedule; although it may not be appropriate for a comparison, we provide the results as a benchmark for future research. The optimized schedule has the pumps ON for a total of 404 hours with a cost of € 693.18. The exact pump schedule for May 21 is shown in Fig. 8and the exact tank levels for May 21 are shown in Fig. 9.

@&#CONCLUSIONS@&#
