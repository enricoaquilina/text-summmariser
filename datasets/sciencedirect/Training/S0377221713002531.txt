@&#MAIN-TITLE@&#
Mathematical optimization ideas for biodiversity conservation

@&#HIGHLIGHTS@&#
We review representative optimization problems arising in biodiversity protection.They concern, e.g. nature reserves, landscape fragmentation and genetic diversity.Some of these problems come from the literature and others are new.For each problem we present one or several mathematical programming formulations.Some computational results are reported.

@&#KEYPHRASES@&#
Biodiversity protection,Mathematical optimization,Integer programming,Nature reserve,Landscape fragmentation,Genetic diversity,

@&#ABSTRACT@&#
Several major environmental issues like biodiversity loss and climate change currently concern the international community. These topics that are related to the development of human societies have become increasingly important since the United Nations Conference on Environment and Development (UNCED) or Earth Summit in Rio de Janeiro in 1992. In this article, we are interested in the first issue. We present here many examples of the help that using mathematical programming can provide to decision-makers in the protection of biodiversity. The examples we have chosen concern the selection of nature reserves, the control of adverse effects caused by landscape fragmentation, including the creation or restoration of biological corridors, the ecological exploitation of forests, the control of invasive species, and the maintenance of genetic diversity. Most of the presented models are – or can be approximated with – linear-, quadratic- or fractional-integer formulations and emphasize spatial aspects of conservation planning. Many of them represent decisions taken in a static context but temporal dimension is also considered. The problems presented are generally difficult combinatorial optimization problems, some are well solved and others less well. Research is still needed to progress in solving them in order to deal with real instances satisfactorily. Moreover, relations between researchers and practitioners have to be strengthened. Furthermore, many recent achievements in the field of robust optimization could probably be successfully used for biodiversity protection, a domain in which many data are uncertain.

@&#INTRODUCTION@&#
Biodiversity, short for biological diversity, represents the diversity of living organisms and ecosystems. It also incorporates the interactions between living organisms and the interactions between living organisms and their environments. It is now accepted that biodiversity – species, genetic and ecosystem – renders important services to human societies and that its preservation is essential. Thus the United Nations General Assembly has approved in late 2010, the creation of the Intergovernmental science-policy Platform on Biodiversity and Ecosystem Services (IPBES). Biodiversity is undergoing significant erosion and that erosion has consequences for the planet as serious, although less known, than those related to climate change. This decline of biodiversity disturbs ecosystem functioning and thus affects the quality of services they provide to human populations concerned. These include, for example, agriculture, food, housing, health, tourism and economy. Biodiversity loss is a particularly serious problem because it is irreversible. According to the latest update of the Red List of threatened plant and animal species established by the International Union for Conservation of Nature (IUCN), about 17,000 species on the 48,000 listed are threatened with extinction (http://www.iucn.org/). The Convention on Biological Diversity (CBD) adopted at the Earth Summit in Rio de Janeiro in 1992, and ratified by about 190 countries had identified five main factors causing biodiversity loss: fragmentation of spaces, overexploitation of species, pollution, invasive species and climate change. In 2002, the signatory countries of the CBD had adopted at the World Summit on Sustainable Development in Johannesburg, a strategic plan to achieve by 2010 a significant reduction in the rate of biodiversity loss. In 2010 the commission found that no country had managed to achieve this goal. At the 10th meeting of the CBD, held in Nagoya in October 2010, a new plan for biodiversity conservation for 2020 was adopted. Available resources to protect biodiversity are obviously limited and it is important to use them effectively. For this, two types of approaches are possible: a direct approach based on the properties and algorithms for mathematical optimization, and simulation approach. They each have their advantages and disadvantages. The approach by simulation, generally simpler to implement, has been widely used to address complex problems in ecology and sustainable development. The approach by mathematical optimization, more difficult to implement, has been less used, but unlike the simulation approach, it allows us to evaluate a large number of options. We illustrate in this article the help that using operational research – mainly mathematical programming – can bring to decision-makers in the implementation of key strategies to protect biodiversity. Among the many optimization problems involved in this area, we chose a few representative issues: the selection of nature reserves, the control of adverse effects caused by landscape fragmentation, the rational exploitation of forests, the fight against invasive species, and the maintenance of genetic diversity. The literature is very abundant on these subjects and, in this paper, we mainly limited ourselves to problems that can be formulated, more or less directly, by linear or nonlinear programming with integer or mixed-integer variables. The integer programming approach presents many advantages compared to specific algorithms: simplicity of implementation if an integer programming software is available, reliability of the method, exact or guaranteed approximate solution of the problem, and finally, possibility of easily modifying the model. Many of the considered problems are derived directly or inspired from the literature. Others are generalizations and finally, some of them are new. For problems of the literature, we present the formulations published and sometimes more interesting formulations. Carefully implemented, mathematical programming – also known as mathematical optimization – is a powerful tool that can be used to solve many problems of operational research. There are indeed very efficient algorithms for these problems and many software based on these algorithms are available. This should enable operational research to play an important role in the field of biodiversity conservation, as important as it plays in the fields of transport, energy, telecommunications and manufacturing. Finally, note that mathematical models are one small part of conservation planning. The management context, although important, is little addressed in this review the aim of which is to present mathematical optimization ideas widely applicable to biodiversity protection. Describing the management context and also assessing the utility and applicability of the models would be another work in itself. Regarding these issues, the reader may consult, for example, the following references: (Margules and Pressey, 2000) where six different stages are identified in systematic conservation planning, (Prendergast et al., 1999) where the utility of reserve selection algorithms is examined and the comments on this article by Pressey and Cowling (2001), (Lindenmayer et al., 2006) for a checklist of measures that reflects the multi-scaled nature of conservation approaches on forested lands, (Halkos and Jones, 2012) for an investigation of the influence of social factors on the decision of individuals to contribute an amount for improving environmental protection of biodiversity, (Bergseng and Vatn, 2009) for a discussion about the reasons for conflict in protection of biodiversity in forests, and (Wallace, 2012) for a planning framework in which the planning components are linked through cause-effect relationships and driven by human values.Many countries have pledged to halt biodiversity loss in the near future and have adopted different strategies for this including the protection of land and sea areas. These protected areas – or reserves – play a decisive role in maintaining biodiversity because they aim directly at the protection of elements which have the strongest risk of extinction. These elements relate to flora, fauna, rocks, minerals and fossils, or major geomorphological sites. The objective is to ensure each threatened species or site has a place where its future is guaranteed. Thus, many governmental and nongovernmental programs seek to restore and protect habitat in order to preserve the species. At the 10th meeting of the CBD, a plan for biodiversity conservation for 2020 was adopted. It contains 20 goals including the restoration of degraded habitats and the establishment of protected areas (terrestrial, marine and coastal). Commenting on the plan, the President of the environmental organization Conservation International, said that the problem is not only quantitative but also qualitative and that the most important areas in terms of biodiversity must be protected. The resources available for this protection being obviously limited, it is important to use them efficiently. Until the 1980s, the proposed methods mainly consisted to rank the potential sites in order of interest by using scoring methods. Smith and Theberge (1986) and Cocks and Baird (1989) were some of the first authors to propose the use of mathematical optimization techniques for solving the problem of selecting which sites should ideally be included in a reserve network. Subsequently, many optimization models have been proposed in the literature of operational research and conservation biology to help select sites for designing reserves. These publications are usually theoretical, they are modeling realistic problems and propose algorithms – often heuristics – to solve them. Some authors discuss the applicability of these models (see e.g., Cabeza and Moilanen, 2001). Many objectives can be considered in selecting nature reserves. For example, Juutinen and Mönkkönen (2007) compare the obtained results with two different objectives, the presence of species and species abundance, while varying the relative weights of different species. They carry out their study using actual data for the boreal forest in Finland. Some articles are based on multi-objective mathematical programming (see e.g., Memtsas, 2003). Although many publications present applications of their models to real data (see e.g., Poulin et al., 2006; Toth et al., 2009; Fiorella et al., 2010; Groeneveld, 2010), few of them concern the actual use of these models by an organization to make decisions. Some articles discuss the gap in this field between theory and practice (see e.g., Prendergast et al., 1999; Pressey and Cowling, 2001; Knight et al., 2008; Schindler et al., 2011; Braunisch et al., 2012; Jolibert and Wesselink, 2012). Several software for selecting nature reserves are currently available. Marxan (http://www.uq.edu.au/marxan/) finds good solutions to a mathematically well-specified problem. Different optimization techniques are used to drive the optimization phase of this software: integer linear programming to obtain exact optimal solutions and metaheuristics such as genetic algorithms and simulated annealing to obtain approximate solutions. The reader can refer to (Ball et al., 2009) for a comprehensive description of this software including an example of its application to a conservation prioritization for the entire Australian continent. Other valuable software are also available: Zonation (http://www.helsinki.fi/bioscience/consplan/software/Zonation/index.html) and C-Plan, (http://www.edg.org.au/free-tools/cplan.html).With regard to Zonation and C-Plan, the reader may refer to Moilanen et al. (2009) and Pressey et al. (2009), respectively. The reader may also refer to Sarkar et al. (2006), a comprehensive survey on the biodiversity conservation planning tools presented in the conservation biology literature. Among other things this survey reviews the various software tools for conservation planning that have been developed over the past 20years. Four other interesting references are (Pressey et al., 1996), (Rodrigues and Gaston, 2002b), (Fischer and Church, 2005) and (Vanderkam et al., 2007). In these articles the authors compare exact and heuristics approaches to solve some reserve selection problems.We present below some selection reserve problems and their formulation by mathematical programming. We first consider the basic problem and some variants. This problem is to select a set of areas, of minimum cost, to protect a set of predefined species. A variant consists in determining, under a budget constraint, a set of areas to protect a maximum number of species. These problems can be modeled easily by 0–1 linear programs and can be solved efficiently by commercial solvers. We then illustrate consideration of spatial constraints. These constraints may affect the compactness of the reserve, its connectivity or its shape. They can also impose a specific role to different areas of the reserve (central zone and buffer zone, for example). Taking into account these spatial constraints often complicates the models because they generate nonlinearities in the associated mathematical programs. The connectivity constraint, common to many operational research problems, is particularly difficult to take into account. We then focus on the definition of reserves taking into account the population of each species that needs protection. In this case, we consider that a species can survive only if the size of its population exceeds a certain threshold. Another objective, also taking into account the population size of each species, is to define a reserve which maximizes the species diversity. Again, the optimal solutions can be difficult to obtain. We also consider the realistic case, where for each species we only know its survival probability in a protected area. The associated problems are often difficult to solve because the expression of the survival probability of a species in a given set of protected areas is generally complicated. In some cases, one should be satisfied with sub-optimal solutions. Finally, we illustrate the temporal dimension which may occur in the design of a reserve. Consideration of time does not necessarily introduces great difficulties in modeling. However it increases the size of the associated programs.We are interested in a set of species to be protected, E={e1,e2,…,ep}, living on a set of parcels – or sites –, S={s1,s2,…,sn}, spread over a territory. For each parcel, we know all the species that live there and it is assumed that these species will survive in this parcel if it is protected. The basic problem is to determine the smallest subset of parcels in order to protect all species considered (see e.g., Margules et al., 1988; Possingham et al., 1993; Underhill, 1994; ReVelle et al., 2002). Associate with each parcel sia Boolean variable xithat equals 1 iff this parcel is selected to be protected. Let P={1,…,p} and N={1,…,n}. The determination of an optimal reserve, i.e. of an optimal subset of parcels can be formulated by the mathematical program(P1):minx∈{0,1}n∑i∈Nxi:∑i∈Skxi⩾1(k∈P)where Skis the set of indices of parcels that protect the species ek. The objective function corresponds to minimizing the number of parcels used and the p inequality constraints express that for each species considered, at least one parcel containing it should be retained. The 0–1 linear mathematical program (P1) is known in operational research as the set covering problem (see e.g., Caprara et al., 2000). There are many variants of (P1). We can try to minimize the total area of the reserve or the total cost when costs are allocated to each parcel, rather than the number of parcels. The objective function to minimize becomes∑i∈Naixiwhere aiis the area or the cost of the parcel si. The definition of an optimal reserve may also be addressed by seeking to identify a subset of parcels that maximizes the number of protected species (see e.g., Camm et al., 1996; Church et al., 1996; Arthur et al., 1997; Csuti et al., 1997; Rosing et al., 2002). In this case, the number of parcels of the reserve or its area or its cost is limited. This gives the mathematical program(P2):maxx∈{0,1}n,y∈{0,1}p∑k∈Pyk:yk⩽∑i∈Skxi(k∈P),∑i∈Naixi⩽B.In an optimal solution of (P2), the Boolean variable yktakes the value 1 iff the species ekoccurs in at least one of the parcels of the reserve. The constraints of (P1) and (P2) can be adjusted to require that each species is represented in at least r parcels rather than in one. In (P1), the right hand side of the constraints becomes r and in (P2) the constraintsyk⩽∑i∈Skxibecomeryk⩽∑i∈Skxi. Polasky et al. (2001) used this model to study the protection of 415 species of terrestrial vertebrates spread over 289 parcels of the state of Oregon in the United States.A slightly different problem is to consider, as McBride et al. (2010) do, that the parcels are divided into q disjoint clusters C1,C2,…,Cq. A cost ciis associated with the parcel siand a cost dlis associated with the cluster Cl. Thus, the protection of a subset, T, of parcels of Clcostsdl+∑i:si∈Tci. The cost dlis a fixed cost associated with the cluster Clthat corresponds, for example, to the moving of equipment, personnel, to the acquisition of the cluster, etc. As in (P1), we try to select a subset of parcels that protects all species considered, at least cost. Using the Boolean variable zlthat is equal to 1 iff at least one of the parcels of Clis retained and setting Q={1,…,q}, the problem can be formulated by the linear program in 0–1 variables(P3):minx∈{0,1}n,z∈{0,1}q∑i∈Ncixi+∑l∈Qdlzl:∑i∈Skxi⩾1(k∈P),zl⩾xi(l∈Q,si∈Cl).According to the last constraint of (P3) and since the objective function is to be minimized, the variable zlwill take the value 1 if at least one of the parcels of Clis retained and 0 otherwise. Previous models take into account neither the spatial aspect of the reserve nor the population sizes of the species present in the reserve. The solution depends only on the presence or absence of species in the parcels. The spatial aspect of the reserves and the populations sizes are discussed in the sections below.There are many ways to take into account the spatial aspect of reserves (see e.g., Williams et al., 2005). One might be interested, for example, in the maximum or minimum distance between two sites of the reserve (see e.g., Williams, 2008) or in its total perimeter (see e.g., spsacctoremoveAPAÖnal and Briers, 2002; McDonnell et al., 2002; Fischer and Church, 2003 and Section 4 of this article). The latter criterion allows for groups of sites relatively close, the shape of which approaches a square or circle, but does not control the distance between the groups. One can also look for a reserve forming a convex space, but the obtained reserve can be relatively large to ensure the protection of all species considered (see e.g., Williams, 2003). The proximity between the sites of the reserve can also be measured by the sum of the distances between all pairs of selected sites (see e.g., Nalle et al., 2002; spsacctoremoveAPAÖnal and Briers, 2002). Note that two sites can be considered as close for certain species and distant for others (Cerdeira et al., 2010). The area of the selected parcels can also be an important criterion in the definition of a reserve (Marianov et al., 2008). The reader may consult (Moilanen et al., 2009b), a comprehensive book on the subject, and also (Baskent and Keles, 2005) for a discussion of the inclusion of spatial constraints in forest management. We present below some reserve selection problems with spatial constraints.The problem is to select a subset of parcels to protect as many species as possible while respecting a compactness constraint and a budget constraint. As noted above, the compactness constraint can be expressed in many ways. One way consists in imposing to the ratio total perimeter of the reserve to total area of the reserve to be less than or equal to ρ (see e.g., spsacctoremoveAPAÖhman and Lämas, 2005). Denote respectively by liand aithe perimeter and the area of the parcel siand by lijthe length of the common border between siand sj. The total perimeter of the reserve isL(x)=∑i=1nlixi-2∑i=1n-1∑j=i+1nlijxixjand the total area of the reserve isA(x)=∑i=1naixi. The problem can then be formulated by the nonlinear 0–1 program(P4):maxx∈{0,1}n,y∈{0,1}p∑k∈Pyk:yk⩽∑i∈Skxi(k∈P),L(x)⩽ρA(x),∑i∈Ncixi⩽B.(P4) can be easily linearized by replacing the products xixjin L(x) by the variables zijand by adding the linearization constraints zij⩽xiand zij⩽xj.Another way to express the constraint of compactness is to minimize the diameter of the reserve, i.e. the maximum distance between two parcels of the reserve (see e.g., spsacctoremoveAPAÖnal and Briers, 2002). The result is a subset of parcels which the external contour approaches a circle. The problem of defining a compact reserve to protect all species can then be formulated by the mathematical program(P5):minx∈{0,1}n,α⩾0α:α⩾dijxixj((i,j)∈N2,i<j),∑i∈Skxi⩾1(k∈P)where dijdenotes the distance between the parcels siand sj. The first constraint expresses that if the parcels siand sjare retained, then the diameter α is greater than or equal to the distance between these two parcels. On the contrary, if at least one of these two parcels is not retained, then the constraint is inactive. The second constraint expresses that for each species, a parcel containing it must be selected. In (P5), the objective function is linear but the constraints are quadratic. A classical linearization of (P5) is given by(P6):minx∈{0,1}n,α⩾0α:α⩾dij(-1+xi+xj)((i,j)∈N2,i<j),∑i∈Skxi⩾1(k∈P).The compactness of a reserve can also be measured by the sum of the distances separating each pair of parcels. The problem consists in minimizing a quadratic function of 0–1 variables subject to linear constraints and can then be stated as(P7):minx∈{0,1}n∑(i,j)∈N2,i<jdijxixj:∑i∈Skxi⩾1(k∈P).There are several ways to solve (P7). It can be submitted directly to a solver such as CPLEX (2007). One can also use one of the several linearization methods designed for quadratic 0–1 programs (see e.g., Boros and Hammer, 2002; Billionnet, 2010c). One can also reformulate (P7) as the minimization of a convex quadratic function of 0–1 variables subject to linear constraints (Billionnet et al., 2008; Billionnet et al., 2009; Billionnet et al., 2012). An alternative approach would be to reformulate (P7) using the technique proposed by Burer (2009) to model any nonconvex quadratic program having a mix of binary and continuous variables as a linear program over the dual of the cone of copositive matrices. Regarding the recent developments and applications of copositive optimization the reader may consult the survey of Bomze (2012). Note that we can also apply to the resolution of (P7) semidefinite relaxation techniques that are often effective for 0–1 quadratic programs (see e.g., Poljak et al., 1995; Roupin, 2004). Another way to impose a reserve to be compact is to limit, by appropriate constraints, the diameter of the reserve. One can use, for example, the constraints xi+xj⩽1((i,j)∈N2, i<j, dij>dmax) or∑i:dij>dmaxxi⩽M(1-xj)(j∈N)where M denotes a constant large enough.Functional connectivity of a reserve involves the notion of proximity between two parcels and a connected reserve is a set of parcels such that for any couple (si,sj) of this set, it is possible to go from sito sjby progressively moving from a parcel to another one that is close. Note that this notion of proximity between two parcels depends on the species. In other words, in a connected reserve an animal must be able to move throughout the reserve without too much deviation from this reserve (see e.g., Williams, 2002; Cerdeira et al., 2005; spsacctoremoveAPAÖnal and Briers, 2005; spsacctoremoveAPAÖnal and Briers, 2006; Groeneveld, 2010). In the example of Fig. 1, two parcels are considered as close if they are adjacent.Note that the only connectivity criterion does not control the contour of the reserve obtained. Suppose the area under consideration is represented by a matrix of m×n identical square parcels sij. Here, we consider that two parcels are functionally close from each other if they are adjacent (share a common side) and we know the species present in each parcel. Specifically, the Boolean coefficient aijkequals 1 iff the species ekis present in the parcel sij. We consider here that the species ekis protected if it is present in at least bkparcels of the reserve. The problem is to determine an optimal connected reserve to protect all species. As in the other problems, the optimality criterion can be the number of sites making up the reserve, the cost of the reserve or its area. Associate the symmetric directed graph G=(X,U) to the matrix of the m×n parcels. The vertices of the graph are the couples of indices (i,j) associated with the parcels sijand there is an arc between two parcels iff they are adjacent (share a common side). The problem may then be stated as follows: find a subset of vertices S⊂X such that each species is present in at least bkvertices of S and such that the sub-graph induced by S is connected or, equivalently, such that every couple of vertices of S can be linked by a path of G going only through vertices in S. This last point can also be formulated by imposing to the sub-graph induced by S to contain a vertex-spanning rooted tree. Let xijbe the Boolean variable that is equal to 1 iff the parcel sijis retained in the reserve and yijrsbe the Boolean variable that is equal to 1 iff the arc ((i,j),(r,s)) is chosen to form the rooted tree on the vertices of S. Let M={1,…,m} and N={1,…,n}. We propose in (Billionnet, 2012) a slight improvement of the model proposed by spsacctoremoveAPAÖnal and Briers (2006). This improvement consists in formulating the problem by the mathematical program(P8):minx∈{0,1}mny∈{0,1}|U|t∈R+mn∑(i,j)∈M×Nxij:∑(i,j)∈M×Naijkxij⩾bk(k∈P),yijrs⩽xij((i,j),(r,s))∈U,∑(i,j)∈Ars-yijrs⩽xrs((r,s)∈M×N),∑((i,j),(r,s))∈Uyijrs=∑(i,j)∈M×Nxij-1,trs⩾tij+1-C(1-yijrs)((i,j),(r,s))∈UwhereArs-={(i,j)∈M×N:((i,j),(r,s))∈U}. The real nonnegative variables tij((i,j)∈X) are used in the constraints trs⩾tij+1−C(1−yijrs), which prohibit the formation of a circuit. Indeed, it is impossible to satisfy such inequalities by assigning tijvalues to the vertices of a circuit. Given a subset S of vertices and x its characteristic vector, a vector y of {0,1}∣U∣ defines a rooted tree on the subgraph induced by S iff the constraints of (P8) are satisfied. The last set of constraints, where C is a large enough constant, is similar to that used in some formulations of the traveling salesman problem to eliminate sub-tours using a polynomial number of constraints (see e.g., Garfinkel, 1985). To return to the model proposed by spsacctoremoveAPAÖnal and Briers (2006) we should replace in (P8), the second set of constraints by∑(r,s)∈Aij+yijrs⩽4xij((i,j)∈M×N)whereAij+={(r,s)∈M×N:((i,j),(r,s))∈U}and the last set of constraints, by zijrs⩾tij+1−C(1−yijrs) ((i,j),(r,s))∈U) andtij=∑(r,s)∈Aij-zrsij((i,j)∈M×N)where zijrsis a nonnegative real variable. The resulting formulation is slightly less effective than (P8) in terms of computation time. Experiments have shown that the size of instances that can be solved by (P8) is limited to a hundred species spread over a hundred of parcels.A large class of decision and optimization problems consists of finding a connected subgraph of a larger graph satisfying certain cost and revenue requirements. For example, Conrad et al. (2012) present a mixed-integer linear programming model for the connected subgraph problem. This model that they use for optimally design corridors for grizzly bears in the U.S. Northern Rockies is based on a network flow approach. It would be interesting to compare this approach with (P8). Dilkina and Gomes (2010) investigate mathematical formulations and solution techniques to find a connected subgraph that contains a subset of distinguished vertices. They propose several mixed-integer formulations for enforcing the subgraph connectivity requirement. Note that there is a close relationship between the connected subgraph problem and the optimal design of corridors (Section 3.2).Now we present the heuristic method for this problem proposed in (Billionnet, 2012) that is also based on integer linear programming. The method consists in solving the program (P9) obtained by replacing, in (P8), the constraints prohibiting the circuits by the constraints (C):(P9):(P8)in whichtrs⩾tij+1-C(1-yijrs)((i,j),(r,s))∈Uis replaced by(C):yijrs+yrsij⩽1((i,j),(r,s))∈U,r>iors>j(C.1)yi-1,j,i,j+yi,j,i,j-1⩽1(i,j)∈M×N,i⩾2,j⩾2(C.2)yi-1,j,i,j+yi,j,i,j+1⩽1(i,j)∈M×N,i⩾2,j⩽n-1(C.3)Constraints (C.1) prohibit the circuits of length 2 and constraints (C.2)–(C.3), specific to a grid, forbid the circuits of length greater than or equal to 2. Indeed, the selected graph does not contain circuits if we forbid, in addition to circuits of length 2, the paths of length 2 of type {(i−1,j),(i,j),(i,j−1)} or {(i−1,j),(i,j),(i,j+1)}. The first type corresponds to the clockwise circuits and the second type, to the anti-clockwise circuits. Experiments have shown that the solutions of (P9) were obtained much faster than the solutions of (P8) and also that the solutions of (P9) were often very close to the optimal solutions. However, the size of instances that can be solved by (P9) in a reasonable time is limited to about a hundred species over two hundred parcels.The shape of a parcel strongly influences the proportion of interior and edge habitat and it is not the same species that live in these two habitat types. For example, the edge of a wooded area is influenced by environmental conditions of this site that are different from those of the interior (solar radiation, temperature, wind speed, human disturbance, etc.). Thus, for some species, it may be desirable to define reserves with a significant edge habitat (Sisk and Haddad, 2002). The mean shape index (MSI) is an indicator widely used in landscape ecology to measure the complexity of the mean contour of a parcel in comparison with a standard contour (McGarigal and Marks (1994)). It is equal to the perimeter of the parcel divided by the square root of its area, multiplied by 0.25. Thus, the index of a circular parcel is equal to about 0.89 and that of a square parcel is equal to 1. MSI is the average of these indices over all the parcels considered:MSI=(1/n)∑i=1n0.25pi/aiwhere piand aiare respectively the perimeter and the area of the parcel si. This ratio increases when the contours of the parcels become more irregular and is minimal when all the parcels are circular. An optimization problem, suggested by Vemema et al. (2005) and associated with this concept of contour, is to select, taking into account an area constraint, a subset of parcels optimal with regard to the MSI value. If S={s1,s2,…,sn} is a set of potential parcels of total area A, the problem can be formulated by the linear fractional program in 0–1 variables(P10):maxx∈{0,1}n∑i∈N0.25pixi/ai∑i∈Nxi:Amin⩽∑i∈Naixi⩽Amaxwhere xiis a Boolean variable that is equal to 1 iff the parcel siis selected, and Amin (resp. Amax) is the total minimum (resp. maximum) area of the reserve. Note that the objective function of (P10) corresponds to MSI since the quantity∑i∈Nxiis equal to the number of selected parcels. One way to solve (P10) is to apply Dinkelbach’s algorithm (Dinkelbach, 1967) that consists of solving a series of auxiliary problems associated with the fractional problem. In the case of (P10), the auxiliary problem is a linear program in 0–1 variables that consists in maximizing the linear expression∑i∈N0.25pixi/ai-λ∑i∈Nxi, where λ is a real parameter, under the same constraints as those of (P10). The reader can consult (Schaible, 1995; Radzik, 1998) for definitions, properties, and algorithms of fractional programming.We end this section on spatial considerations by discussing the selection of nature reserves with central area and buffer zone (see e.g., Williams and ReVelle, 1998; Clemens et al., 1999; Hamaide et al., 2009). In this case, there are two types of species to be protected, endangered and common species, and two types of protected areas, central areas and buffer zones that protect the central area of nuisances caused by human activities outside the reserve. To be protected, an endangered species must be present in a central area and a common species must be present either in a central area or in a buffer zone. It is considered that a selected parcel is part of a central area if all the parcels that surround it are also selected to be either in the central area or in the buffer zone (Fig. 2). The decision maker can define a buffer zone more or less important. Consider the Boolean variable zithat is equal to 1 iff the parcel siis selected to be part of the central area and the Boolean variable xithat is equal to 1 iff the parcel siis selected to be part of the buffer zone or of the central area. Denote by NC⊆N the set of indices of the parcels candidates for the central area and by Ni⊆N the set formed by the index i and the set of indices of the parcels surrounding the parcel siand that must be selected (in the central area or in the buffer zone) to give to parcel sithe status of central area.Decompose P into PR, the set of indices of rare species, and PC the set of indices of common species. The problem can be formulated by the linear program in 0–1 variables(P11):minz∈{0,1}|NC|x∈{0,1}|N|∑i∈Ncixi:∑i∈Skzi⩾1(k∈PR),∑i∈Skxi⩾1(k∈PC),zi⩽xj(i∈NC,j∈Ni).The last constraint of (P11) forces the variable zito take the value 0 if at least one of the parcels adjacent to siif not selected (to be part of the buffer zone or of the central area).The above models are well suited for species conservation in the short term but less well suited to long-term conservation. Indeed, the reserves determined by these models can be composed of many small parcels widely dispersed and the survival of a species in the long term, in this type of reserve, is not guaranteed, especially if the parcels are located in an inhospitable matrix as a highly urbanized area (see e.g., Crist, 2004).Some authors incorporate clusters of close parcels into the concept of nature reserve. These clusters must have a total area and populations of different species sufficiently large. This is the case of Toth et al. (2009) who propose a model that requires the listing of possible clusters. We present here a model that incorporates the concept of clusters in the mathematical program itself. Specifically, a cluster of parcels is a set of parcels such that the maximum distance between two parcels of the set is less than or equal to dmax. We assume that a species will persist in the reserve if the reserve involves a cluster of parcels with a total population of the considered species greater than a certain threshold. The objective is to select an optimal subset of parcels, for example of minimum area, to protect all species considered. Let pikbe the population of speciesekin the parcel si, bkbe the threshold for survival ofek, and aibe the area of the parcel si. Let xikbe a Boolean variable that is equal to 1 iff the parcel siis selected to ensure the survival of the speciesek. Note that a parcel is included in the reserve iff it is used to protect at least one of the species. The problem can be formulated by the program(P12):minx∈{0,1}npr∈{0,1}n∑i∈Nairi:xik⩽ri(i∈N,k∈P),∑i∈Npikxik⩾bk(k∈P),∑j∈N,j>i,dij>dmaxxjk⩽Bik(1-xik)(i∈N,k∈P).The objective function sums the areas of the selected parcels. The first constraint requires the Boolean variable rito take the value 1 iff the parcel siis used to protect at least one of the species. The second constraint expresses that the global population of ekin the parcels selected to protect ek– a cluster – must be greater than or equal to bk. The last constraint expresses that the maximum distance between two parcels in a cluster must be less than or equal to dmax. In this constraint, dijis the distance between parcels siand sj, and Bikis an upper bound on the number of sites selected to protectekin an optimal solution, whose subscript is greater than i, and located at more than dmax from the site si. For example, we can fix Bikto the maximum number of sites that a cluster may contain given the value of dmax. The experiments that we performed on (P12) showed that hypothetical instances with a hundred of sites and about fifty species could be handled quickly.As we saw in the previous sections a lot of reserve selection problems are based on the knowledge of all the species that survive in a parcel if it is protected. However, in reality, the information is not always so accurate and several publications take into account some uncertainty about the data (see e.g., Arthur et al., 2002; Haight et al., 2002; Drechsler, 2005; Strange et al., 2006; Haight and Travis, 2008). In this section, we consider that the survival of a species in a parcel is defined by a probability (rather than by presence/absence). One way to address the problem of reserve selection in this case is to transform probabilistic information into deterministic information (see e.g., Margules and Stein, 1989; Polasky et al., 2000) but this obviously has many drawbacks.Denote by pkithe probability that the species eksurvives in the parcel siif the parcel is protected. We assume that these events occur independently across species and that the probabilities satisfy 0⩽pki<1. Let qki=1−pki. We can consider the following two objectives (see e.g., ReVelle et al., 2002): (i) identify a subset of parcels of minimum cost and such that, for each species ek, the probability that this species is present in the reserve, i.e. in at least one selected parcels, is greater than or equal to a given value αkand (ii) determine, under a budget constraint, a subset of parcels such that the total expected number of species present in these parcels is maximal. Let xibe a Boolean variable that is equal to 1 iff the parcel siis selected. The probability that the parcel sidoes not contribute to the presence (and thus to the survival) of the species ekis equal to 1−pkixi. It is equal to 1 if the parcel is not selected and to 1−pkiif the parcel is selected. The probability that the species is absent from all selected parcels is therefore equal to∏i∈N(1-pkixi)and, ultimately, the probability that the species is present in the reserve is equal to1-∏i∈N(1-pkixi). In order to require this probability to take a value greater than or equal to αk(0≤αk<1), we introduce the constraint1-∏i∈N(1-pkixi)⩾αk. This nonlinear constraint, can be transformed, as for example Haight et al. (2000) do, in a linear constraint using the logarithmic function. The case (i) can be then formulated by the linear program in 0–1 variables(P13):minx∈{0,1}n∑i∈Ncixi:∑i∈Nxilogqki⩽log(1-αk)(k∈P).The case (ii) can be formulated by the nonlinear program in 0–1 variables(P14):maxx∈{0,1}n∑k∈P(1-∏i∈N(1-pkixi)):∑i∈Ncixi⩽Bwhich is difficult to solve. In case we try to select a subset of B parcels (ci=1), Polasky et al. (2000) describe a classic greedy heuristic in which a new parcel is added to the already selected set of parcels until B parcels are selected, in such a way that the marginal improvement of the objective function at each stage is maximized. The problem can also be treated by classic metaheuristics. We propose in (Billionnet, 2011a) another way to solve (P14) by first rewriting it as(P15):maxx∈{0,1}n0⩽vk<1(k∈P)∑k∈Pvk:log(1-vk)⩾∑i∈Nxilogqki(k∈P),∑i∈Ncixi⩽B.then by considering a linear relaxation of (P15), based on the following property:∀(θ,β)∈R+2,1θ(β-θ)+logθ⩾logβ. This property results from the fact that log x is a concave function of x and 1/θ is the value of the derivative of log x at the point θ. A relaxation of (P15) is given by the mixed-integer linear program(P16):xx∈{0,1}n0⩽vk⩽1(k∈P)∑k∈Pvk:1-vk-θrθr+logθr⩾∑i∈Nxilogqki(k∈P,r∈H),∑i∈Ncixi⩽Bwhere H={1,2,…,h} and θ is any vector of Rhsuch that 0<θ1<θ2<⋯<θh=1. An optimal solution of (P16) gives both a feasible solution of the initial problem, i.e. the selected parcels, and an upper bound of its optimal value. The feasible solution is given by the vector x and its value is∑k∈P(1-∏i∈N(1-pkixi)). The upper bound is given by the optimal value of (P16). We thus obtain by mixed-integer linear programming an approximate solution and an upper bound to the difference between the value of this approximate solution and the optimal value. The experiments, carried out on instances with 400 parcels and 300 species have shown that by choosing properly the vector θ, we obtained relatively quickly, using the software CPLEX 10.2.0 (CPLEX, 2007), an approximate solution at less than 0.4% from the optimum. Camm et al. (2002) propose for this problem an approach based on an approximation of the logarithmic function by a piecewise linear function, but their approach provides an approximate solution of the problem without any guarantee in relation to the optimum.A robust approach taking into account some uncertainty about the probabilities pkiis also possible for this problem. Following Bertsimas and Sim (2004), one could determine an optimal reserve ensuring a minimum probability of presence for each species whatever are the values of the probabilities pki(in a set of allowable values). The problems formulated by (P13) and (P16) are relevant if pkiis the probability that the species ekis present (and survives) in the parcel siwhen that parcel is protected.Some authors have focused on the uncertainty regarding the long-term survival of a species that is currently present somewhere in the reserve (see e.g., Margules et al., 1994; Williams and Araújo, 2000, 2002; Araújo et al., 2002). Some authors use metapopulation models to incorporate uncertainty into conservation decision-making processes by considering the extinction risk of the metapopulation of interest. The extinction risk is a function of the location, size and quality of the patches of habitat and the ecology of the species. For example, Nicholson and Possingham (2007) define the probability of extinction of a metapopulation of species ekas a function of the size and spatial arrangement of the reserves, the mean dispersal distance of species ek, the home range size of species ek, and emigration rate per unit area of species ek. They use information-gap decision theory to explore the impact of uncertainty in conservation decisions. McCarthy (2009) presents an overview of different types of spatial population viability analysis. Game et al. (2008) are interested in the optimal strategy for protection of marine habitats in the presence of uncontrollable disturbance. They propose an interesting probabilistic approach for this problem and apply it to a situation of cyclone disturbance of coral reefs on Australia’s Great Barrier Reef.We propose in this section a model for selecting parcels in order to maximize the species diversity in the reserve. There are several ways to measure the species diversity of a population composed of different species. We consider here that it is measured by the Simpson diversity index (Simpson, 1949; Couvet and Teyssèdre-Couvet, 2010), i.e. by the probability that two individuals drawn at random from the population belong to two different species. Species diversity of a population composed of species e1,e2,…,epis equal to1-∑k∈Pfk2where fkis the frequency of the species ek. As in previous cases, we consider a set of species E={e1,e2,…,ep} distributed over a set of parcels S={s1,s2,…,sn}. Let pkibe population of the species ekin the parcel si(pki=0 if the population of the species ekin the parcel siis not sufficient for the survival of this species in this parcel). The (global) frequency of the species ekin the set of parcels S isfk=∑i=1npki/∑r=1p∑i=1npri. Let cibe the cost associated with the selection of the parcel si, and B be the available budget. The problem is to identify a subset of parcels that respects the budget constraint and such that the species diversity of species present in the parcels is maximum. We can formulate this problem in several ways. Denoting by fkthe real variable representing the frequency of the species ekin the selected reserve, we get the mixed-integer nonlinear program(P17):minx∈{0,1}nf∈[0,1]P∑k∈Pfk2:∑i∈Npkixi=fk∑(r,i)∈P×Nprixi(k∈P),∑(r,i)∈P×Nprixi⩾1,∑i∈Ncixi⩽B.The objective function of (P17) is quadratic and convex, the first set of constraints is quadratic and the others are linear. One can easily linearize the quadratic constraints by replacing the product fkxiby the variable zkiand adding the usual linearization constraints zki⩽xi, zki⩽fk. Because of the objective function to minimize, constraints zki⩾fk−(1−xi) and zki⩾0 are useless. The resulting mathematical program consists in minimizing a convex quadratic function subject to linear constraints and can be therefore solved by classical solvers such as CPLEX (2007). Another formulation is given by the fractional program(P18):minx∈{0,1}n∑(i,j)∈N2αijxixj/∑(i,j)∈N2βijxixj:∑(r,i)∈P×Nprixi⩾1,∑i∈Ncixi⩽Bwhereαij=∑k∈Ppkipkjandβij=∑k∈Ppki∑k∈Ppkj. The auxiliary problem associated with (P18) consists in minimizing the quadratic function of Boolean variables∑(i,j)∈N2αijxixj-λ∑(i,j)∈N2βijxixj, where λ is a real parameter, under the same constraints as those of (P18) (see Section 2.3.3). Although (P18) is more effective than (P17) it only provides exact solutions for small instances (few tens of parcels and species).The programs (P17) and (P18), like the Simpson index, take into account the number and the frequency of the species but do not take into account the populations of each species. It is easy to overcome this drawback by introducing, for example, the constraints∑i∈Npkixi⩾bk(k∈P)that impose the minimum value bkto the population of the species ek. Another interesting problem is to select the reserve by using the phylogenetic diversity criterion (see e.g., Rodrigues and Gaston, 2002a; Pardi and Goldman, 2007 and Section 6.4 of this article).In the problems described above, the temporal dimension does not appear while it is of course very important. In this section, we first briefly describe an interesting model (P19), proposed by Toth et al. (2011) that maximizes the expected total biodiversity value of land in both preserved and undeveloped parcels within a competitive land market. This model considers several temporal aspects. For example, the conservation actions may have an impact on the price of the land and on the risk of development outside the reserves. It also takes account of the essential fact that once a land parcel is developed it cannot be purchased for conservation.Let us consider a set of parcels S={s1,s2,…,sn} and a planning horizon composed of q periods of one yearT={1,2,…,q}. For each parcel si, we know the area aiin hectares, the biodiversity value vimeasured in biodiversity hectares, and the set of adjacent parcels Si. The model uses the following Boolean variables: xitequals 1 iff parcel siis selected for conservation in year t, zitequals 1 iff parcel siis converted to development in year t, and yitequals 1 iff at least one parcel that is adjacent to parcel siis selected for conservation in year t−1. It also uses the positive real variable pitwhich is equal to the market value of parcel siin year t. At the beginning of the planning horizon, pi1 is equal to the current market value of parcel si.(P19):maxx∈{0,1}nqz∈{0,1}nqy∈{0,1}n(q-1)p∈R+nq∑i∈Naivi∑t∈Txit+α∑i∈Naivi(1-∑t∈T(xit+zit)):∑t∈T(xit+zit)⩽1(i∈N),∑i∈Npitxit⩽Bt(t∈T),pit=pi,t-1(1+r+qyit)+Ei∑j∈N-{i}ajxj,t-1,∑k∈Sixk,t-1⩾yit,∑k∈Sixk,t-1⩽|Si|yit,pit⩾(Ri+θit)zit,1-∑t′=1t(xit′+zit′)(Ri+θit-pit)⩾0(i∈N,t∈T-{1})The objective function of (P19) maximizes the total amount of land in preserved and undeveloped parcels weighted by each parcel’s biodiversity value. α is a biodiversity correction coefficient for unprotected but undeveloped parcels. The first constraint allows a parcel to be either developed or preserved at most once during the planning horizon. The second constraint is a budget constraint where Btis the available budget in period t. The third constraint expresses the expected market value of parcel siin year t as the sum of two parts: the first one is the market value of parcel siin the year t−1, pi,t−1, compounded by the expected increase (or decrease) in real estate value r as dictated by the general housing market, plus an amenity premium q that is taken into account only if at least one of the parcels that are adjacent to parcel sihas been purchased for conservation in year t−1 (i.e. if yit=1); the second partEi∑j∈N-{i}ajxj,t-1is a price increase associated with an increase demand for land resulting from the conservation purchases in year t−1. Ei=ai/(ηd+ηs) is a parameter associated with parcel siwhich depends on the price elasticities ηdand ηsof demand and supply, respectively, for housing development. The two constraints that follow control the value of the binary variables yit. The two last constraints set the value of the development indicator variable zit. θitis a cutoff value, i.e. an amount of money by which the market value of parcel si(pit) must exceed its open space value (Ri) in period t before the parcel is considered developed by the model. Some nonlinearities appear in (P19). They result from the product of the adaptative price coefficient pitby the Boolean variables x, y or z. The classical linearization techniques allow (P19) to be linearized (see linearization of (P17)). Toth et al. (2011) proved that this integer programming approach was computationally tractable for a large and complex problem instance in a real land market on Lopez Island, Washington.There are many other publications on the temporal dimension in reserve selections. The reader can consult, for example, the references (Costello and Polasky, 2004; Strange et al., 2006; Sabbadin et al., 2007; Rayfield et al., 2008; Dissanayake and Önal, 2011) where the proposed models are often based on dynamic programming.We now consider the model proposed by Haight et al. (2005) that involves both a temporal dimension and an uncertainty about parcel availability. This model has two objectives: maximize the expected number of species represented in protected parcels and maximize the expected number of people with access to protected sites. To simplify the presentation we shall consider here only the first objective. That is sufficient to illustrate the approach adopted to take account of uncertainty over a two-period horizon. The reader can refer to (Haight et al., 2005) for a comprehensive overview of the model. We consider a planning horizon composed of two periods and among the considered parcels, some are available for protection in the first period and others are not. Each site not protected in the first period has a probability of remaining undeveloped and being available for protection in the second period. This uncertainty is handled by defining a set of development scenarios Θ={1,…,ν}. Specifically, we know, for every possible scenario θ∈Θ, the probability pθit occurs and, for each site si, the Boolean parameter uiθwhich equals 1 iff the site siis available for protection in the second period when the scenario θ is realized. As in model (P1) we are interested in a set of species E={e1,e2,…,ep} to be protected and living on a set of parcels S={s1,s2,…,sn}. For each parcel si, we know its area ai, all the species that live there, and it is assumed that these species will survive in siif siis protected. As in (P1), Skis the set of indices of parcels that protect the species ek. Associate with each parcel sia Boolean variablexi1that equals 1 iff this parcel is selected to be protected in period one, and a Boolean variablexiθ2that equals 1 iff this parcel is selected to be protected in period two in scenario θ. Associate with each species ekand each scenario θ a Boolean variable ykθthat equals one iff species ekis represented in at least one protected parcel in scenario θ. Let P={1,…,p} and N={1,…,n}. The determination of a subset of parcels which maximizes the expected number of species represented can be formulated by the 0–1 linear program(P20):maxx1∈{0,1}nx2∈{0,1}nνy∈{0,1}pν∑θ∈Θpθ∑k∈Pykθ:xi1+xiθ2⩽1(i∈N,θ∈Θ),xiθ2⩽uiθ(i∈N,θ∈Θ),xi1=0(i∈L),∑i∈Naixi1+∑i∈Naixiθ2⩽B(θ∈Θ),ykθ⩽∑i∈Skxi1+xiθ2(k∈P,θ∈Θ)The objective function is the number of species represented under each scenario weighted by the probability of that scenario’s occurrence. The first constraint specifies that site sican be selected in either period one or period two, but not both, over all scenarios. The second constraint specifies that site sican only be selected in period two in scenario θ if site siis available for protection in that scenario. The third constraint specifies that site si(i∈L), where L is a subset of S, cannot be selected in period one. The fourth constraint places an upper bound B on the total area of selected sites in periods one and two under each scenario. The last constraint is similar to the first constraint of (P2) and defines the condition under which species ekis represented under scenario θ. Let (x1∗,x2∗,y∗) be an optimal solution of (P20). This indicates a need to acquire, in the first period, the parcels sisuch asxi1∗=1.Then one of the q scenarios occurs. Letθˆbe this scenario. It is then necessary to acquire in the second period the parcels sisuch thatxiθˆ2=1. Finally, the number of protected species is equal to∑k∈Pykθˆ.A lot of other work focused on dynamic selection of nature reserves. For example, Strange et al. (2011) study a dynamic spatial conservation prioritization problem where climate change gradually changes the future habitat suitability of a site’ current species. The problem is explored using heuristic approaches. Pressey et al. (2007) summarize ideas, techniques and unresolved issues in planning for biodiversity processes (local extinction, recolonization, predation, adjustment of the distribution of species to changing climate, etc.) in the context of dynamics threats (habitat conversion by agriculture, harvesting of timber, invasive plants and animals, etc.).Fragmentation of spaces has become a central issue in ecology because it is recognized as the main source of biodiversity loss in industrialized countries. It causes a decrease of the habitats and their division into separate fragments, thus affecting the populations of many species: extinction of rare species, increasing of common and sedentary species, mortality when moving between fragments, genetic erosion, etc. (see e.g., Harrison and Bruna, 1999; Collinge, 2000; Fahrig, 2003; Crist, 2004). An important part of this fragmentation is caused by road and rail infrastructure but is also due to urban development, agriculture and forestry.We present below several optimization problems related to landscape fragmentation. The first type of problem is to select, under constraints, a set of areas, among a set of candidate areas, in order to optimize some standard indicators of fragmentation. These problems can be formulated more or less easily as fractional combinatorial optimization problems for which there are efficient algorithms. For example, a classical iterative algorithm in which each iteration consists in solving a linear program with integer or mixed-integer variables quickly solves instances with hundreds of candidate areas. Note that the approaches that are used could be easily extended to other indicators. The second type of problem is to define and/ or restore biological corridors in order to reduce as far as possible adverse effects due to landscape fragmentation by reconnecting habitats that are no longer connected. The treatment of these problems involves both graph theory (optimal flows) and mathematical programming and are usually effective. We also consider the problem of restoring a network of existing corridors in order to increase as far as possible its permeability. The probabilities of the movements of species in the network are known and the model built in this framework is based on both Markov chains theory and mathematical programming. Instances of medium size can be solved optimally by this approach. One limitation of this model is the practical difficulty in assessing the movements probabilities.Landscape fragmentation, i.e. the breakup of large areas into smaller parcels must be evaluated and controlled because it influences many ecological processes (see e.g., Barrett and Peles, 1994). It can be measured by multiple indicators (see e.g., Hargis et al., 1998; McAlpine and Eyre, 2002; spsacctoremoveAPAÖhman and Lämas, 2005). Here, we consider as examples two common indicators, the mean nearest neighbor distance (MNND) and the mean proximity index (MPI), which estimate the relative isolation of the parcels. These indicators are among those that are used in FRAGSTATS (McGarigal and Marks, 1994), software well known in landscape ecology. Optimization problems associated with the notion of fragmentation include, for example, the selection of a subset of parcels optimal for these indicators. The selected parcels will be, for example, protected or restored as habitat patches and the others will be assigned to other uses (urban development, agricultural areas, logging, etc.). Now let us see precisely the two measures of fragmentation that we consider here, for a set S={s1,s2,…,sn} of parcels.MNND=(1/n)∑i=1nmin{dij:j=1,…,n;j≠i}where dijis the distance between the two parcels siand sj. Many studies have shown that the movements of individuals within a species between different parcels affect the dynamics of the population (see e.g., Fahrig, 2007) and it is clear that these movements are more difficult if the values of MNND are high. Minimizing the value of the indicator privileges the grouping of parcels that are not too far from each other. However, the distance between groups of parcels is not controlled. Although MNND is often used, the only consideration of the nearest parcel may not well represent, from an ecological point of view, the vicinity of a parcel. In addition MNND ignores the size of the parcels. To overcome this drawback, we can consider the indicator MPI (d) which takes into account all the parcels that are within a certain given radius d from the parcel considered, and their sizes. Setting Ri(d)={j∈{1,…,n}:j≠i, dij⩽d} and denoting aithe area of the parcel si, MPI (d) is equal to(1/n)∑i=1n∑j∈Ri(d)(aj/dij2).Now consider two problems of optimal selection of parcels, inspired from (Vemema et al., 2005). These authors use a genetic algorithm to solve such problems. A solution by mathematical programming is presented in (Billionnet, 2010b). Consider a set of parcels S={s1,s2,…,sn} of total area A and seek to select a subset of S that minimizes MNND under the constraint that the total area of the selected parcels is between Amin and Amax (Fig. 3). By associating with each parcel sithe Boolean variable xithat is equal to 1 iff the parcel siis selected, the problem can be formulated by the combinatorial optimization problem(P21):minx∈{0,1}n∑i∈N(x)minj∈Ni(x)dij/∑j∈Nxj:Amin⩽∑j∈Najxj⩽Amaxwhere N={1,…,n}, N(x)={i∈N:xi=1}, Ni(x)={j∈N:j≠i, xj=1} (i∈N). Let E={(i,j)∈N2, i≠j} and Ni={j∈N:j≠i}. For a given index i, the quantityminj∈Ni(x)dijis equal to the distance between the parcel siand its nearest neighbor among the selected parcels.∑i∈N(x)minj∈Ni(x)dijrepresents the sum of these distances for all the selected parcels. By dividing the latter quantity by the number of selected parcels, i.e.∑j∈Nxj, we obtain the desired MNND. (P21) can be rewritten as the 0–1 linear-fractional program(P22):minx∈{0,1}ny∈{0,1}|E|∑(i,j)∈Edijyij∑i∈Nxi:∑j∈Niyij=xi(i∈N),yij⩽xj((i,j)∈E),Amin⩽∑j∈Najxj⩽Amax.MNND is equal to the objective function of (P22) subject to the first two constraints. Indeed, according to the first constraint, for each index i, if xi=0 then all the variables yijtake the value 0 and if xi=1 then only one variable yijtakes the value 1. Moreover, the second constraint forces the variables yijto take the value 0 if xior xjis set to 0. The auxiliary problem (See Section 2.3.3) associated with (P22) is a linear program in 0–1 variables that consists in minimizing the expression∑(i,j)∈Edijyij-λ∑i∈Nxi, where λ is a real parameter, under the same constraints as those of (P22). Again, we refer to (Schaible, 1995; Radzik, 1998) for the treatment of fractional programs. One can also seek to minimize MNND while imposing a maximum value, v, to the mean shape index (MSI) presented in Section 2.3.3. To do this, simply add to (P22) the linear constraint0.25∑i∈Npi/aixi⩽v∑i∈Nxi.The second problem that we present here is to select a subset of parcels that maximizes the value of the indicator MPI (d) and which total area is between Amin and Amax. It can be formulated by the program(P23):maxx∈{0,1}n∑i∈N(x)∑j∈Ni(x,d)ajdij2/∑i∈Nxi:Amin⩽∑j∈Najxj⩽Amaxwhere Ni(x,d)={j∈N:j≠i, xj=1, dij⩽d}. (P23) is equivalent to the fractional program(P24):maxx∈{0,1}nv∈R+n∑i∈Nvi∑i∈Nxi:vi⩽∑j∈Ni(d)ajxjdij2(i∈N),vi⩽Cixi(i∈N),Amin⩽∑j∈Najxj⩽Amax.where Ciis a constant greater than the value of∑j∈Ni(d)ajxj/dij2at the optimum of (P23).MPI (d) is equal to the objective function of (P24) subject to the first two constraints. Indeed, according to these two constraints, viwill take the valuemin∑j∈Ni(d)ajxj/dij2,Cixiat the optimum since the objective function is to be maximized. The variable viwill therefore take the value∑j∈Ni(d)ajxj/dij2if xi=1, and the value 0 if xi=0. The auxiliary problem associated with (P24) is a mixed-integer linear program that consists in maximizing the expression∑i∈Nvi-λ∑i∈Nxiunder the same constraints as those of (P24). The solution of programs (P22) and (P24) is very fast since, for all values of the couple (Amin,Amax) we have considered, their solution requires less than three seconds for a hundred parcels, on a PC with an Intel Core Duo 2gigahertz processor. In these experiments, the solver CPLEX 10.2.0 (CPLEX, 2007) has been used to solve the auxiliary problems in the course of executing Dinkelbach’s algorithm (Dinkelbach, 1967).The formulations (P22) and (P24) were tested on sets of rectangular parcels. Note that these formulations remain valid in more realistic situations where the parcels are irregular polygons.As discussed above, landscape fragmentation is a major cause of biodiversity loss. The viability of the species involved in this fragmentation depends strongly on how the fragments are connected. The preservation and restoration of ecological continuity, i.e. of biological corridors, is a way to halt the decline of biodiversity. These corridors are routes used by the animal species to move, reproduce, escape, migrate, and so on. They depend on the species. This ability to move is essential (see e.g., Clergeau and Désiré, 1999; Ménard and Clergeau, 2001; Holzgang et al., 2001; Fahrig, 2007) and the restoration of these corridors is a key protection strategy for the species threatened by the fragmentation of their habitat. The reader can also consult the reference (Bond, 2003) which deals with principles for the design and evaluation of biological corridors, and the reference (Williams and Snyder, 2005) which addresses the question of where restoration should take place to efficiently reconnect habitat with a landscape-spanning corridor. Building upon findings in percolation theory, the authors develop a shortest-path optimization methodology for establishing such corridors.We present in this section a problem of restoration of corridors inspired by (Williams, 1998). Consider a landscape represented by a matrix of m×n identical square parcels. This landscape has a number of reserves R1,R2,…,RT, each reserve being formed by a connected subset of parcels and all pairs of reserves are not connected.Among the parcels that do not belong to a reserve, some can be restored and some cannot. The cost of restoration of the parcel sijis denoted by cij. In cases where sijis already a parcel habitat but not integrated in a reserve, this cost is zero. A large cost is assigned to a parcel that cannot be restored. The problem is to determine the parcels to restore in order to connect all reserves at least cost. Two reserves Riand Rjare considered as connected if an animal can move from Rito Rjpassing only in restored parcels (or belonging to a reserve) and moving gradually from a parcel to an adjacent parcel, two parcels being adjacent if they share a common side (Fig. 4). Associate with the matrix of parcels a graph G= (S,U). S={(i,j)∈M×N}, where M={1,…,m} and N={1,…,n}, is the set of vertices (corresponding to the parcels) and ((i,j), (k,l)) is an arc of G iff the parcels sijand sklare adjacent. For each reserve Rk, choose one of its parcels,sik,jk, to represent it. The problem can be formulated as follows: determine a subset of vertices of minimum costS¯⊂Sand a subset of arcs A⊂U such that the graphG=(S¯∪k=1,…,T(ik,jk),A)admits a path from the parcel representing the reserve Rrto the parcel representing the reserve RT, and this for all r∈{1,…,T−1}. This problem corresponds to the Steiner tree problem (see e.g., Hwang et al., 1992) which we give below a flow type formulation (Williams, 1998). Let xijklbe the Boolean variable that is equal to 1 iff at least one of the T-1 paths from Rr(r=1,…,T−1) to RTuses the arc ((i,j),(k,l)), andyijklrbe the Boolean variable that is equal to 1 iff the path from Rrto RTuses the arc ((i,j),(k,l)). Denoting by Aijthe set of vertices corresponding to the parcels adjacent to the parcel sijand settingdijr=1if the parcel sijrepresents the reserveRr,dijr=-1if the parcel sijrepresents the reserve RTanddijr=0otherwise, we obtain the formulation of the problem by the linear program in 0–1 variables(P25):miny∈{0,1}(T-1)×|U|x∈{0,1}|U|∑(i,j)∈Scij∑(k,l)∈Aijxijkl:xijkl⩾yijklr((i,j),(k,l))∈U,r=1,…,T-1),∑(k,l)∈Aijyijklr-∑(k,l)∈Aijyklijr=dijr((i,j)∈S,r=1,…,T-1).Note thatcij=0ifsijbelongs to one of the T reserves. The first constraint of (P25) expresses that if the path from Rrto RTuses the arc ((i,j),(k,l)) then the variable xijklmust take the value 1. The second constraint is a constraint of conservation at each vertex. For example, consider a vertex (i,j) which does not represent a reserve: if an arc of the path r reaches the vertex (i,j), then an arc of the same path must also start from this vertex. This type of model is used by Suter et al. (2008) to define a network of corridors suitable for grizzly bear movements in the U.S. Northern Rockies. To control corridor lengths for the couples of reserves (Rr,RT) (r=1,…,T−1), we can simply add the constraint∑((i,j),(k,l))∈U,sij∉Rr∪RTyijklr⩽LmaxrT,LmaxrTbeing the maximum length allowed for the corridor connecting Rrto RT(Williams, 1998). As mentioned in that article, a disadvantage of this model is that the other corridor lengths cannot be controlled. We propose below a slightly different formulation that does not have this disadvantage. We keep the variablesyijklrand we replace the Boolean variables xijklwith the Boolean variables wijthat are equal to 1 iff at least one of the T-1 paths from Rr(r=1,…,T−1) to RTgoes through the node (i,j). We get the program(P26):miny∈{0,1}(T-1)×|U|,w∈{0,1}|S|∑(i,j)∈Scijwij:wij⩾∑(k,l)∈Aijyijklr((i,j)∈S,r=1,…,T-1),∑(k,l)∈Aijyijklr-∑(k,l)∈Aijyklijr=dijr((i,j)∈S,r=1,…,T-1).(P26) has fewer variables and fewer constraints than (P25). By taking into account additional constraints, a limit can be imposed on the length of the corridor linking any two reserves. As in the previous model we can introduce a constraint on the length of the corridor between Rrand RT. To limit atLmaxstthe length of the corridor between two arbitrary reserves Rsand Rt, different from RT, we define a new Boolean variableyijklst, which is equal to 1 iff the path from Rsto Rtuses the arc ((i,j),(k,l)), and we introduce the additional constraints∑(k,l)∈Aijyijklst-∑(k,l)∈Aijyklijst=dijst((i,j)∈S)wheredijst=1if sijrepresentsRs,dijst=-1if sijrepresents Rtanddijst=0otherwise,wij⩾∑(k,l)∈Aijyijklst((i,j)∈S)and∑((i,j),(k,l))∈U,sij∉Rs∪Rtyijklst⩽Lmaxst. We tested (P26), with additional constraints to impose a maximum length to a certain set of corridors, on a hypothetical instance including 20×20 identical square parcels and seven reserves. For all additional constraints we considered, the corresponding version of (P26) has been solved in a few seconds of computation. In formulations (P25) and (P26), the parcel set is based on a grid of identical square cells. In more realistic situations, the land parcels are typically irregular polygons. In this case (P25) and (P26) remain valid but the corresponding graph G=(S,U) is different from that based on regular grids, particularly concerning the vertex degrees.Other authors examined this type of problem. For example, Alvarez-Miranda et al. (2013) consider the following problem: Given a connected node-weighted graph, with a root node r, and a (possibly empty) set of nodes R, find a connected subgraph rooted at r that connects all nodes in R with maximum total weight. They propose non-polynomial-sized integer linear programming formulations which are based on node variables only.We present in this section a problem of restoring a network of corridors inspired by references (Finke et al., 2008; Finke and Sonnenschein, 2008). The problem is to determine the developments to be made in the corridors of a network in order to increase its permeability as much as possible while taking into account a budget constraint. In the two references cited above, the problem is addressed by simulation methods. We present the solution we propose in (Billionnet, 2010a) and that is based on mixed-integer linear programming. Consider a network of corridors and a set of species having all the same behavior in the network. The network can be represented by a graph which the n vertices are the n parcels (or reserves) s1,s2,…,sncorresponding to habitats and which the m edges correspond to corridors connecting the parcels. The road and rail infrastructure, urbanization, agriculture and other phenomena have more or less degraded these corridors and the problem is to restore them as efficiently as possible. One can, for example, create wildlife crossings above or below the road and rail infrastructure (see e.g., Ng et al., 2004; Trocmé, 2005). The aim is to restore the corridors, under a budget constraint, to maximize the permeability of the network. This permeability is measured by the expected value of the distance traveled in the network by the species considered. When an animal lies in the parcel si, it is assumed that it chooses randomly and with equal probability one of the corridors leading to this parcel, i.e. the corridor [si,sj] with the probability 1/diwhere diis the degree of the node si. Then it tries to use this corridor with the probability qij. If it decides to use the corridor [si,sj], it is assumed that it managed to reach the other end, i.e. the parcel sjwith the probability rijand that it fails to reach it, getting killed before that happens, with the probability 1−rij. The restoration of a corridor [si,sj] increases the probabilities qijand rij, and the more resources devoted to the restoration, the higher the values of these probabilities will be. We assume that we know, for each corridor [si,sj], the possible values of the probabilities qijand rijtogether with the associated costs. This assumes that we knowqijk(resp.rijk), the value of the probability qij(respectively rij) if the investment of level k (k=1,…,K) is carried out in the corridor [si,sj]. We associate to the network a Markov chain which set of states consists of n parcels (n transient states) and a state (n+1) (absorption) for the death of the animal. The transition probabilities, pij, from state i to state j are the unknowns. LetΠ=ZD01be the transition probabilities matrix, Z corresponding to transient states and D, to the absorbing state. Let N be the matrix which general term, nij, is equal to the average number of passages by state j, before absorption, for an animal starting from state i. According to the Markov chains theory, N= (I−Z)−1 where I is the identity matrix of dimension n×n (see e.g., Grinstead and Snell, 1997). The choice of investments to make in each corridor to maximize the expected value of the total distance traveled by n animals, one animal being initially in each of the n parcels, can be formulated by the mathematical program(P27):maxΠ∈Π∼,w∈R+n∑(i,j)∈Rlij(wipij+wjpji):wi-∑j=1nwjpji=1(i=1,…,n)where R={(i,j)∈{1,…,n}2:[si,sj] is a corridor, i<j}, lijis the length of the corridor [si,sj], wiis a real variable that represents the expression∑j=1nnji, andΠ∼is a set of stochastic matrices, of general term pij, and feasible for the problem. Let S={(i,j)∈{1,…,n}2:[si,sj] is a corridor}. Using the Boolean variablexijk((i,j)∈S,k∈K)that is equal to 1 iff the investment of level k is made in the corridor [si,sj] and denoting bycijkthe cost of this investment, the problem can be formulated by the program(P28):maxx∈{0,1}2mK,w∈R+n∑(i,j)∈Rlij(eij+eji):∑(i,j)∈R,k∈Kcijkxijk⩽B,∑k∈Kxijk=1(i,j)∈R,eij=1diwi∑k∈Kqijkrijkxijk((i,j)∈S),xijk=xjik((i,j)∈R,k∈K),1diwi∑j:(i,j)∈S,k∈Kqijkxijk=1+∑j:(j,i)∈Seji(i=1,…,n)where eijrepresents the expected value of the total number of travels in the corridor [si,sj] going from the parcel sito the parcel sj. (P28) can be transformed into a mixed-integer linear program in a classic way by linearizing the quadratic expressionswixijk, products of a real variable by a Boolean variable. Some experiments have shown that (P28) can be solved in about two minutes of computing time for a network with 10 parcels and 15 corridors in which seven investment levels are possible (Billionnet, 2010a).Following the Food and Agriculture Organization of the United Nations, “sustainable forest management aims to ensure that the goods and services derived from the forest meet present-day needs while at the same time securing their continued availability and contribution to long-term development. In its broadest sense, forest management encompasses the administrative, legal, technical, economic, social and environmental aspects of the conservation and use of forests”. Publications on the subject that introduce the concept of optimization are numerous and the reader can refer to Martell et al. (1998), Weintraub and Murray (2006), and Bettinger et al. (2007) for an overview of such problems and also to the book of Weintraub et al. (2007) which contains a dozen chapters related to optimization problems in forestry. About half of these chapters take into account biodiversity protection at least to an extent. Among the problems presented in the literature, many of them have a spatial aspect. For example, Toth and McDill (2008) study a forest management problem aiming to produce habitat composed of mature large parcels taking into account the total perimeter of these parcels. The spatial constraint taken into account by Goycoolea et al. (2005) is to limit, for various environmental reasons, the area of the blocks of adjacent parcels cut at each period. These authors are interested in effective formulations of this problem by integer linear programming involving the notion of clique in a graph. Exact methods for this problem had already been proposed by McDill et al. (2002) and Crowe et al. (2003).We present below in more details several issues of sustainable use of the forest. The first problem concerns the choice of a strategy for forest use in order to ensure the best possible protection for some species. In this example, a first type of species prefers cut forest stands and a second type of species prefers the edges between cut and uncut stands. The optimal strategy is determined by integer linear programming. This problem allows us to illustrate the importance of the formulation in integer linear programming. We also present a dynamic version of this problem. We then present a similar problem but with a kind of species whose population expected in a stand depends on the connectivity of this stand with other stands. This problem also allows us to illustrate the approximate solution of a nonlinear program using the approximation of a nonlinear function by a piecewise linear function. In the last problem, which comprises a temporal dimension, two objectives are pursued: the first concerns the marketing of wood and the second is an environmental objective based on the spatial distribution of trees by age group. This problem can be formulated by a 0–1 linear program. The main modeling difficulty comes from the fact that the edges between two adjacent stands is taken into account only if the difference between the ages of the trees present in these two stands is greater than a certain threshold.We present in this section a forest management problem proposed by Hof and Joyce (1993), included in (Hof and Bevers, 1998), and aimed at protecting certain species as best as possible. Consider a set of identical square forest parcels represented by a m×n matrix and two types of species e1 et e2. The habitat of the species e1 is mainly in the cut parcels and the habitat of the speciese2consists mainly of edges between cut parcels and uncut parcels. We consider the area outside the matrix as a cut zone. The expected population of the speciese1in each cut (resp. uncut) parcelsijis equal totij(resp. 0), and the expected population of the speciese2is equal to gL where g is the population of the speciese2expected for each km of edge and L, the total length of the edge, given the cuts made. For example, the northern goshawk likes habitat in the vicinity of edges where there are open areas where it can hunt small mammals living in the same habitat (Hof and Bevers, 1998). The m×n parcels are assumed to be initially in old growth state. The problem is to determine the parcels to cut and the parcels to be left in old growth to maximize the weighted sum of the populations of both species. Associate with each parcel sijthe Boolean variable xijthat equals 1 iff the parcel is uncut. Hof and Bevers (1998) formulate the problem by the linear program in binary variables x and continuous variables d(P29):maxd∈R+mn,x∈{0,1}mnw1∑(i,j)∈M×Ntij(1-xij)+w2gl∑(i,j)∈M×N(4xij-dij):dij⩾∑(k,l)∈Aijxkl-|Aij|(1-xij)((i,j)∈M×N)where M={1,…,m}, N={1,…,n}, w1 and w2 are the weights associated with the two species, l is the length of the side of each parcel, and Aijdesignates the set of couples (k,l) such that the parcel sklis adjacent to the parcel sij. Since the objective function of (P29) is to be maximized, the variable dijtakes the smallest possible value: if xij=0 then, according to the constraint, dijtakes the value 0, and if xij=1, dijis equal to∑(k,l)∈Aijxkl, i.e. to the number of uncut parcels among the parcels adjacent to sij. We propose in (Billionnet, 2010d) to formulate the problem as the maximization of a 0–1 quadratic function without constraints(P30):maxx∈{0,1}mn∑(i,j)∈M×N(w1tij(1-xij)+w2glaijxij)+w2gl∑(i,j,k,l)∈S(xij+xkl-2xijxkl)where S={(i,j,k,l)∈(M×N)2: (k,l)=(i+1,j) or (i,j+1)}, aij=1 if (i,j) belongs to {{1,m}×{2,…,n−1}∪{2,…,m−1}×{1,n}}, aij=2 if (i,j) belongs to {(1,1),(1,n),(m,1),(m,n)} and aij=0 otherwise. Note that in the objective function of (P30), the quantity xij+xkl−2xijxklequals 0 if xij=xkl=1 or xij=xkl=0, and equals 1 if only one of the two variables xijor xklequals 1. The advantage of this formulation lies in the fact that the constraints matrix associated with its classical linearization is totally unimodular (TU), which is not the case of the constraints matrix associated with the program (P29). The classical linearization of (P30) consists in replacing the products xijxklby the variables yijkland in adding the linear constraints 1−xij−xkl+yijkl⩾0 and yijkl⩾0 to force the equality yijkl=xijxkl. We can prove that the constraints matrix of this linearization is TU, taking into account that the vertex-edge incidence matrix of a bipartite graph is TU (see e.g., Nemhauser and Wolsey, 1988). Large instances of the problem can therefore be easily solved by this formulation.It is easy to introduce a temporal dimension in the model (P30). Consider a planning horizon consisting of a set T of q periods. The problem is to determine the parcels to cut in each period to maximize the weighted sum of the populations of both species at the end of the planning horizon. Consider the Boolean variable xijtthat equals 0 iff the parcel sijis cut in period t and the Boolean variable zijthat equals 1 iff the parcel sijremains uncut at the end of the planning horizon. We assume in this problem that the available budget in period t is equal to Btand that the cost associated with cutting the parcel sijis equal to cij. The problem can be formulated by the quadratic program in 0–1 variables(P31):maxx∈{0,1}mnqz∈{0,1}mn∑(i,j)∈M×N(w1tij(1-zij)+w2glaijzij)+w2gl∑(i,j,k,l)∈S(zij+zkl-2zijzkl):zij=1-∑t∈T(1-xijt)((i,j)∈M×N),∑(i,j)∈M×Ncij(1-xijt)⩽Bt(t∈T)The objective function is similar to that of (P30). The fist constraint expresses the variables z in function of the variables x, and at the same time, the fact that a parcel can be cut at most once during the planning horizon. The last constraint is the budget constraint. Although the quadratic program (P31) can be linearized in the same way as (P30), the obtained constraints matrix is no longer TU. Computational experiences we have carried out on the linearization of (P31) showed that hypothetical instances built on a matrix of 50×50 parcels with a planning horizon of 10 periods could be solved very quickly. Note that if carry-over of funds between the periods is allowed, the budget constraint can be replaced by∑(i,j)∈M×Ncij(1-xijt)+Ft=B¯t(t∈T),B¯t=Ft-1+Bt(t=2,…,q), andB¯1=B1where Ftis a slack variable that represents the amount of unused funds in period t, whereasB¯tis a variable that represents the budget that is actually available in period t (Toth et al., 2011).Now consider the same problem as (P30), i.e. without temporal dimension, but replacing the species e2 by the species e3 which expected population is a little more complicated to calculate. If the parcel sijis cut, the population expected in this parcel is zero. Otherwise, it is equal to uijPRijwhere PRijis the connectivity of the parcel sijwith other uncut parcels. This connectivity is measured by the probability that the parcel sijis connected to the rest of the uncut parcels. Expected population of e3 in the uncut parcels sijis equal to uijif PRij=1. We assume that we know the probabilities pijkl(0⩽pijkl<1) that the parcel sijis connected to the parcel skland that all these probabilities are independent. They depend on a number of factors like for example the distance between the two parcels. We get thereforePRij=1-∏(k,l)∈M×N(1-prijklxkl)with prijij=0. Moreover, it is also assumed that a minimum number α of parcels must be uncut to ensure the survival of the species e3. The problem of determining what parcels must be cut to maximize the weighted sum of the expected species populations can be formulated by the mixed-integer mathematical program(P32):maxx∈{0,1}mny∈{0,1}s3∈R+w1∑(i,j)∈M×Ntij(1-xij)+w3s3:s3⩽∑(i,j)∈M×NuijPRijxij,s3⩽Cy,y⩽1α∑(i,j)∈M×Nxij,PRij=1-∏(k,l)∈M×N(1-prijklxkl)((i,j)∈M×N)where C is a constant large enough. When the probabilities prijklhave a particular form, Hof and Joyce (1993) propose a tight approximate solution of (P32) based on a linear approximation of the products PRijxij. In the event these probabilities are arbitrary, we show (Billionnet, 2011b) that by using the same technique as in Section 2.5, we obtain a relaxation of (P32), the mixed-integer linear program(P33):maxx∈{0,1}mny∈{0,1}s3∈R+vij∈R+mnw1∑(i,j)∈M×Ntij(1-xij)+w3s3:s3⩽∑(i,j)∈M×Nuijvij,s3⩽Cy,y⩽1α∑(i,j)∈M×Nxij,1θr(1-vij)+logθr-1⩾∑(k,l)∈M×Nlog(1-prijkl)xkl((i,j)∈M×N,r∈H),vij⩽xij((i,j)∈M×N)where the variable vijrepresents the product PRijxij. The last constraint of (P33) forces the variable vijto take the value 0 when xijis 0. Since the objective function of (P33) is to be maximized, the two fist constraints force the variable s3 to take, at the optimum, the valuemin∑(i,j)∈M×Nuijvij,Cy. The third constraint forces the variable y to take the value 0 if∑(i,j)∈M×Nxij<α, i.e. if the number of uncut parcels is less than α. The optimal value of (P33) provides a tight upper bound of the optimal value of the problem, and the values of xijin an optimal solution of (P33) give an approximate solution of the problem. Some experiments conducted with CPLEX (2007) on instances with 900 parcels have shown that (P33) provided, in a few minutes of computation on a PC with an Intel Core Duo 2gigahertz, approximate solutions at less than 0.5% from the optimum.We present in this section a forest management problem inspired from (Bertomeu and Romero, 2001). The considered forest is composed of n parcels, s1,s2,…,sn, the parcel siinvolving trees of age a(i). Horizon management is composed of h periods of t years. We seek to exploit the forest, i.e. to make one and only one cut of each parcel during the management period, in order to maximize the discounted benefit realized from the marketing of wood while taking into account an environmental objective. The environmental objective is to try to get at the end of the planning horizon, a forest where all ages are represented, where the number of parcels is the same for each age, and where the length of the edge between two parcels for which the age difference exceeds a certain threshold is maximum. To account for the first two aspects of the environmental objective, the same number of parcels are exploited at each period of the planning horizon. However, one can exploit a parcel if its trees have reached a certain maturity. Let xikbe the Boolean variable that is equal to 1 iff the parcel siis cut during the period k (in the middle of the period). The age of the trees of the parcel siat the end of the planning horizon is equal toFi=∑k=1h(0.5t+(h-k)t)xik. The constraint on the maturity of the trees is expressed by∑i=1n∑k∈K(i)xik=0where K(i) is the set of periods where the age of the trees of the parcel siis below the threshold. At the end of the planning horizon, the length of edge, lij, between two adjacent parcels siand sjis to consider if ∣Fi−Fj∣⩾δmin. To express the total length of edge, we use the two Boolean variables yijand zij, and seek to maximize the expression∑(i,j)∈Slij(yij+zij)under the constraints Fi+M(1−yij)⩾Fj+δmin and Fj+M(1−zij)⩾Fi+δmin, where M denotes a large enough constant and S, the pairs of indices of adjacent parcels. The economic objective is expressed by∑i=1n∑k=1hNVikxikwhere NVikis the discounted profit corresponding to the exploitation of the parcel siat the period k. More precisely NVikequals the area of the parcel si, in hectares, multiplied by the benefit obtained from one hectare of trees which age is that of the trees of the parcel siat the period k, multiplied by a discount factor. If this parcel siis cut at the period k, the age of the trees in this parcel is equal to Ii+t(0.5+k−1) where Iiis the initial age of the trees in the parcel. The problem can finally be formulated by the linear program in 0–1 variables(P34):maxx∈{0,1}nhy∈{0,1}|S|z∈{0,1}|S|w1∑(i,j)∈Slij(yij+zij)+w2∑i=1n∑k=1hNVikxik:Fi=∑k=1h(0.5t+(h-k)t)xik(i=1,…,n),∑i=1nxik=⌊n/h⌋(k=1,…,h),∑k=1hxik=1(i=1,…,n),∑i=1n∑k∈K(i)xij=0,Fi+M(1-yij)⩾Fj+δmin,Fj+M(1-zij)⩾Fi+δmin((i,j)∈S)where S={(i,j)∈{1,…,n}2:i<j, siand sjshare a common edge}, and w1 and w2 are weighting coefficients.Some species of plants and animals introduced are very invasive and it is now accepted that they have a significant impact on biodiversity (competition with other species, release of toxic substances, genetic disturbance, epidemics, etc.). Some optimization models were developed in the effective fight against invasive species. The reader can refer, for example, to the very good article written by Epanchin-Niell and Hastings (2010). The authors review studies that address economically optimal control of established invasive species. They describe three important components for determining optimal invasion management: invasion dynamics, costs of control efforts and a monetary measure of invasion damages. Another interesting reference in connection with this question is (De Lara and Doyen, 2008), where different biological models are reviewed.We present below a simple problem proposed by Hof (1998) to illustrate the help that operational research can provide to treat this type of phenomenon. Consider a forest area represented by a matrix of m×n identical square parcels and a parasite present in some of these parcels. This parasite disperses by neighborhood and its population is steadily increasing. It is possible to completely eliminate the parasite from a parcel by performing some management actions in this parcel (poisoning, burning, use of attractants, sanitation cutting). The problem is to identify the parcels to be treated so as to minimize the spread of the parasite during a planning horizon consisting of T periods. The number of parcels that may be treated at each period is limited to K. Denote by vijtthe population of the parasite in the parcel sijat period t. At period t+1, this population grew, became equal to vijt(1+r) where the rate r is a given positive coefficient, and has spread to the adjacent parcels. Denote by pklijthe proportion of the population of the parcel sklwhich diffuses into the parcel sijbetween t and t+1. We have therefore, for any parcel sijand for allt>1,vijt=∑(k,l)∈M×Npklij(1+r)vklt-1where vkl1 is the initial population of the parasite in the parcel skl. Let xijtbe a Boolean variable that is equal to 1 iff the parcel sijis treated at the period t. A parcel is treated only once, and once treated at time t, the parasite is definitely eliminated, that is to say that it is eliminated for period t and all subsequent periods. Hof and Bevers (2002) choose to minimize the total population of the parasite on the planning horizon, i.e. the expression∑(i,j)∈M×N,t=1,…,Tvijt. They formulate the problem by the mixed-integer linear program(P35):minx∈{0,1}mnTv∈R+mnT∑(i,j)∈M×Nt=1,…,Tvijt:∑(i,j)∈M×Nxijt⩽K(t=2,…,T),vijt+bijt∑k=2txijk⩾∑(k,l)∈M×Npklij(1+r)vklt-1((i,j)∈M×N,t=2,…,T)where bijtis an upper bound of the population of the parasite in the parcel sijat the period t, whatever the treatments carried out. Since the objective function of (P35) is to be minimized, the variable vijtwill take the smallest possible value at the optimum. If∑k=2txijk>0, i.e. if the parcel sijhas been treated during one of the periods 2, …, t, the second constraint is satisfied by setting vijtto 0. Otherwise vijtequals∑(k,l)∈M×Npklij(1+r)vklt-1. We propose a formulation slightly different from (P35) and that has proved to be more effective in terms of computation time for all the instances we considered. This formulation uses the Boolean variable yijtthat is equal to 1 iff the parcel sijis treated at period t or before period t, and can be stated as(P36):miny∈{0,1}mnTv∈R+mnT∑(i,j)∈M×Nt=1,…,Tvijt:∑(i,j)∈M×N(yijt-yijt-1)⩽K(t=2,…,T),vijt+bijtyijt⩾∑(k,l)∈M×Npklij(1+r)vklt-1((i,j)∈M×N,t=2,…,T),yij1=0((i,j)∈M×N),yijt⩾yijt-1((i,j)∈M×N,t=2,…,T).Now, we present a bit more elaborate model proposed by Büyüktahtakin et al. (2011). As in the previous model, the problem consists in determining which parcels will be treated in each of the T periods. The objective function is the total damage caused by the invasive species in the entire area during the entire time interval. The damage Dijtkcaused to the threatened resource k∈{1,…,R} in parcel sijin period t is equal to wkRijkvijt. The weight wkaffected to resource k depends on the management priority of this resource, Rijkrepresents the percentage of resource k in the parcel sijwhich is affected by the invasive species, and vijtis the population density of the invasive species in parcel sijin period t. So, the objective function to be minimized is∑(i,j)∈M×N∑t=1T∑k=1RDijtk. Using the Boolean decision variables xijtthat are equal to 1 iff the parcel sijis treated in period t, the change in population density in two consecutive periods can be formulated as(Eq.):vijt=(vijt-1+g(vijt-1,v¯ijt-1,Kij))(1-xijt)if(vijt-1+g(vijt-1,v¯ijt-1,Kij))⩽Vijvijt=(vijt-1+g(vijt-1,v¯ijt-1,Kij))(1-λxijt)otherwisewhere Kijis the carrying capacity (environment’s maximal load) in parcelsij,v¯ijt-1is the vector of the population densities of the considered species in the eight parcels surrounding parcel sijin period t−1, Vijis the value of the critical population density in parcel sij, and the function g has a logistic growth form. In both cases, without treatment(xijt=0)vijt=vijt-1+g(vijt-1,v¯ijt-1,Kij). If treatment is applied (xijt=1) then in the first case the parcel population is eradicated and in the second case the population decreases according to the kill rate λ. The land management faces budget and labor constraints:∑(i,j)∈M×Ncij1+cij2vijtxijt⩽Btwhere Btis the available budget in period t andcij1andcij2are two parameters depending of the parcel;∑(i,j)∈M×Nlij1+lij2vijtxijt⩽Ltwhere Ltis the maximum available labor in period t andlij1andlij2are two parameters depending of the parcel. In summary, by introducing the Boolean variables δijt, the problem can be formulated as(P37):minx∈{0,1}mnTv∈R+mnTδ∈{0,1}mnT∑(i,j)∈M×N∑t=1T∑k=1RwkRijkvijt:δijt(vijt-1+g(vijt-1,v¯ijt-1,Kij))⩽Vij((i,j)∈M×N,t=2,…,T),vijt=(vijt-1+g(vijt-1,v¯ijt-1,Kij))(1-xijt(δijt+λ(1-δijt)))((i,j)∈M×N,t=2,…,T),∑(i,j)∈M×Ncij1+cij2vijtxijt⩽Bt(t=1,…,T),∑(i,j)∈M×Nlij1+lij2vijtxijt⩽Lt(t=1,…,T)Because of the objective function to minimize, the first constraint requires the Boolean variable δijtto take the value 0 if(vijt-1+g(vijt-1,v¯ijt-1,Kij))>Vijand the value 1 otherwise. The second constraint expresses vijtas stated by (Eq.). This model is applied by Büyüktahtakin et al. (2011) for the case of control of the invasive grass, Pennisetum ciliare, in the Arizona desert. According to these authors, the large size of the problem makes the application of direct optimization methods impossible. Instead, they analyse and compare the most frequently suggested strategies and their consequences.Other publications deal with optimization models for controlling invasive species. For example, Hastings et al. (2006) develop simple approaches based on linear programming for determining the optimal removal strategies of different stage or age classes for control of invasive species that are still in a density-independent phase of growth. They illustrate the application of their method to the specific example of invasive Spartina alterniflora in Willapa Bay, WA. Wainger et al. (2008) present an extensive study applied to a weed, downy brome (bromus tectorum), which invades some mountainous areas of the western United States. Chalak et al. (2011) analyse a spatially explicit dynamic process of controlling invasive species in a stochastic setting. Epanchin-Niell and Wilen (2012) examines the spatial nature of optimal bioinvasion control. They develop a spatially explicit two-dimensional model (an integer program) of species spread that allows for differential control across space and time, and solve for optimal spatial-dynamic control strategies. Leung et al. (2002) approach the issue by stochastic dynamic programming.First recall some basic notions of genetics (see e.g., Griffiths et al., 2000; Petit et al., 2007). The gene is the unit of genetic inheritance. It is characterized by its precise location – or locus – on a chromosome. A well known example is the gene for eye color or blood type in humans. A gene also corresponds to a sequence of nucleotides, i.e. to unit fragments of DNA. An allele is a version of a gene. Eye color in humans depends on the alleles carried by the individual on the gene concerned. Genetic diversity is the existence of different alleles of a gene. In diploid cells (n pairs of chromosomes), i.e. in the cells of humans and most animals, each individual has two alleles – corresponding to the two chromosomes of a pair – for each gene and an individual received, at random, one of the two alleles of each parent, corresponding to one of two chromosomes of the parents. These alleles may be identical or not. Take the example of blood type with, for example, the following situation: an individual (A/B) randomly inherited the A allele from one parent who was (A/A) and the B allele from the other parent who was (B/O). An individual whose gene has identical alleles on both chromosomes is called homozygous for that gene. Otherwise, we say that the individual is heterozygous for this gene. In the latter case, there are two possibilities for the phenotype (observable state of a character): one allele is dominant and the other is recessive or it is not the case. If more than two alleles correspond to the same gene, the gene is said to be polyallelic. Genetic diversity is a factor allowing species to adapt to changes in their environment especially in the context of climate and global changes. Many articles in the conservation biology literature dedicated to species conservation programs deal with optimization problems arising in genetic diversity. A first type of problem is to determine in a given population, one or more sub-populations with certain properties and maximizing genetic diversity (see e.g., Glover et al., 1995; Allen et al., 2010; Caballero et al., 2010) or (Rodrigues and Gaston, 2002a; Moulton et al., 2007; Bordewich et al., 2009) regarding an important aspect of genetic diversity, phylogenetic diversity. A second problem concerns the management of breeding populations, usually in captivity, in order to maintain the greatest possible genetic diversity (see e.g., Fernandez and Toro, 1999; Fernandez et al., 2001; Fernandez et al., 2008; Vales-Alonso et al., 2003; Xu et al., 2011).We present below some of these problems. Both of these problems are to select among a set of individuals or species, a subset of maximum biological diversity. The diversity between individuals is measured either by differences between DNA sequences or by kinship coefficients. These problems are easily formulated as quadratic programs in 0–1 variables but large instances are difficult to solve despite the wealth of research on this topic conducted to date. The third problem concerns the maintenance of allelic diversity from one generation to the next in genetic conservation programs. The last problem is to determine the conservation policies to apply to a set of taxa in order to maximize the expected value of the phylogenetic diversity of the set. For these two problems, we show how to obtain very good approximate solutions, with guarantees with respect to the optimum, using a method similar to that used for the problems, despite the differences, discussed in Sections 2.5 and 4.1.We present in this section a relatively simple problem proposed by Glover et al. (1995) to select some species to be protected – from a variety of endangered species – in order to maximize biological diversity of the subset of protected species. Let E={e1,e2,…,ep} be a set of endangered species present in a certain region. The financial means available to protect these species being limited, it is impossible to protect all of them. It is assumed here that one has a total budget B and we know the cost ciof protecting the species ei. To select an optimal subset of species, it is necessary to measure the dissimilarity between two species and then to deduce the diversity of a group of species. The dissimilarity between two species eiand ejis measured here by a distance dijsatisfying the properties dij⩾0, dij=djiand dii=0. This distance is a function of the differences between the two species and in relation to a number of features. The diversity of a subset S of species is defined by the sum of the distances between each pair of species of this set:D(S)=∑i<j:(ei,ej)∈S2dij. The problem is to determine the subset, S, of species to be protected that checks some constraints and maximizes D(S). Associate with each species ei, the Boolean variable xithat is equal to 1 iff the species eiis retained to be protected. To determine under a budget constraint a subset S of maximum biodiversity can be formulated by the quadratic program in 0–1 variables(P38):maxx∈{0,1}n∑i=1n-1∑j=i+1ndijxixj:∑i=1ncixi⩽Bwhich is known as the quadratic 0–1 knapsack problem. Glover et al. (1995) apply this model to the protection of cranes. They consider 14 species of endangered cranes, mainly due to the destruction of wetlands. The hunt for the Nordic races, and pesticides in Africa, also contribute to their decline. There are several approaches to measure the dissimilarity between two species. Glover et al. (1995) use data on the differences between DNA sequences associated with the two species and obtained by a molecular biology technique, DNA hybridization. Regarding the 14 crane species considered, Glover et al. (1995) use genetic distances established by Krajewski (1989). There are several ways to solve (P38). The program can be directly submitted to a solver such as CPLEX (2007). One can also use one of several methods that have been proposed over the last thirty years for quadratic programming in 0–1 variables (see Section 2.3.1) or specific algorithms developed for the quadratic knapsack problem (see e.g., Kellerer et al., 2004). Glover et al. (1995) use a classical linearization of (P38). Lozano et al. (2011) propose an iterative greedy algorithm for this classical problem of combinatorial optimization that has proved to be effective compared to other metaheuristics.We present a common problem encountered in genetic conservation programs recalled by Vales-Alonso et al. (2003). It consists in determining the optimal contribution (number of offspring) from each parent to minimize the loss of alleles in the generated population. These authors deal the problem with a heuristic method based on a parallel simulated annealing. We propose an approach that provides an approximate solution with a very good guarantee. Consider a population consisting of P individuals, I1,I2,…,IP, belonging to a species and a set of M polyallelic genes g1,g2,…,gMto take into account. For each gene gi, the allelesai1,ai2,…,ait(i)are possible. We consider the case of diploid cells (humans and most animals) where, for each gene, all individuals have two alleles, each allele corresponding to a chromosome of the pair considered. These alleles may be identical or not. Each individual randomly received one of the two alleles from each parent (see Fig. 5). One seeks to determine the optimal number of offspring of each individual to minimize the expected number of alleles missing in the next generation while maintaining a population of constant size. Let xjbe the integer variable representing the number of offspring of the individual Ij. Denote byEik1(resp.Eik2) the set of indices of individuals in the initial population for which alleleaikappears only once (resp. two times) for the gene gi. Let us evaluate the probabilitypikof extinction of the alleleaikin the next generation:pik=0if the alleleaikis not in the initial population or if the variable xjtakes a positive value for at least one index j of the setEik2. In the opposite casepik=∏j∈Eik10.5xj. By denoting Nm(resp. Nf) the number of males (resp. females) of the initial population, minimizing the expected number of alleles missing in the next generation, while maintaining the same number of individuals, consists in minimizing the expression∑i=1M∑k=1t(i)pikunder the constraints∑j=1Nmxj=Pand∑j=1Nfxj=P. Recall that the initial population size is equal to Nm+Nf=P. By setting IK={(i,k):i=1,…,M, k=1,…,t(i)} and using the nonnegative variables zik((i,k)∈IK) for expressing the probabilities of extinction of the allelesaik, the problem can be formulated by the mathematical program(P39):minx∈NPzik⩾0((i,k)∈IK)∑(i,k)∈IKzik:zik⩾∏j∈Eik10.5xj-∑j∈Eik2xj((i,k)∈IK),∑j=1Nmxj=∑j=1Nfxj=Por by the mathematical program(P40):minx∈NPzik⩾0((i,k)∈IK)tik⩾0((i,k)∈IK)∑(i,k)∈IKzik:zik⩾tik-∑j∈Eik2xj((i,k)∈IK),tik⩾∏j∈Eik10.5xj((i,k)∈IK),∑j=1Nmxj=∑j=1Nfxj=P.Since the objective function of (P40) is to be minimized, the variables zikand tiktake the smallest possible values at the optimum. If∑j∈Eik2xj>0, then the quantitytik-∑j∈Eik2xjis negative and ziktakes the value 0. Otherwise, zikequals tik, i.e.∏j∈Eik10.5xj. The last constraint of (P40) expresses that the total number of offspring of the males of the initial population, like that of the females, must be equal to the initial size of the population, i.e. to P. Taking the logarithm of both sides of the second constraint and applying the same technique as in Section 2.5, we obtain a guaranteed approximate solution of the problem by solving the mixed-integer linear program(P41):minx∈NPzik⩾0((i,k)∈IK)tik⩾0((i,k)∈IK)∑(i,k)∈IKzik:zik⩾tik-∑j∈Eik2xj((i,k)∈IK),logθr+tik-θrθr⩾∑j∈Eik1xjlog0.5((i,k)∈IK,r∈H),∑j=1Nmxj=∑j=1Nfxj=P.Experiments have shown that instances of (P41) with one hundred individuals, several hundred genes, and two alleles by gene could be solve quickly.Consider the pth pair of chromosomes of two individuals Iiand Ijbelonging to the population {I1,I2,…,Ip} and randomly draw one chromosome of Iiand one chromosome of Ijin this pair. The probability that these two chromosomes are identical (that of a common ancestor) is called the kinship coefficient. For example, the kinship coefficient of two brothers is equal to 0.25 and the kinship coefficient of two children Iiand Ij, from the couples of individuals (A,B) and (A,C), respectively, is equal to 0.125. Now consider a population of P individuals with known kinship coefficients between each pair. One seeks to remove a group of d individuals of this population to form a new population while minimizing the sum of the average kinship of the two subpopulations formed. Denoting by kijthe kinship coefficient between individuals Iiand Ij, the mean kinship of a population with P individuals is equal to(1/P2)∑i=1P∑j=1Pkij. This problem is presented by Allen et al. (2010) for the California condor, one of the largest birds in the world. This species was highly endangered in 1985 as only a few individuals remained in the wild. It was saved in extremis by captive breeding and reintroduced into the wild successfully. Using the Boolean variable xithat is equal to 1 iff the individual Iiis taken from the original population, Allen et al. (2010) formulate the problem by the quadratic program in 0–1 variables(P42):minx∈{0,1}Pd2+(P-d)2d2(P-d)2∑i=1P∑j=1Pkijxixj+1(P-d)2∑i=1P∑j=1Pkij-2∑i=1Pxi∑j=1Pkij:∑i=1Pxi=d.They propose the classic linearization of (P42) that consists in replacing the products xixjby the variables yijand adding the constraints 1−xi−xj+yij⩾0 and yij⩾0. They apply this method to a population of P=150 California condors for which they know the pedigree but find the optimal solution only for the values of d less than or equal to 10. For larger values of d, they propose to address the problem through a local improvement heuristic. We noticed that a linearization based on the ideas of Glover (1975) was more efficient from a computation time point of view but this approach does not allow to address the problem for values of d greater than or equal to 11. It is also conceivable to try to solve this difficult problem by one of several methods that have been proposed over the last thirty years for quadratic 0–1 programming (see Section 2.3.1). The direct solution of the 0–1 quadratic program (P42) – whose continuous relaxation is convex – provides relatively quickly a good solution with acceptable guaranteed quality. Note that (P42) is a discrete version of the optimization of a quadratic function over the simplex. Bomze and de Klerk (2002) proposed a polynomial-time approximation scheme for this problem called the standard quadratic optimization problem.We can consider a phylogenetic tree as a rooted tree A=(X,Y,U) where X={1,…,p} is the set of leaf vertices, Y={p+1,…,m} is the set of non-leaf vertices, and U is the set of arcs. The leaf vertices correspond to the species – or taxa – considered. The out-degree of each non-leaf vertex is greater than or equal to 2, except possibly that of the root.With each arc u of the rooted tree is associated a nonnegative value lu. A phylogenetic tree is based on the analysis of characters of the studied species, the branches representing the transformations of these characters. It is built on the assumption of parsimony, i.e. of a minimum number of character transformations (see e.g., Lin et al., 2007). It expresses the kinship between living organisms and indicates who is close to who (see Table 1and Fig. 6for an example from (Bergeron et al., 2002)). The phylogenetic diversity of a set of taxa S⊆X, that we denote by PD (S), is the sum of the values of the arcs of the minimum sub-tree connecting the vertices of S and the root (Faith, 1992). This definition is a rigorous tool to make decisions concerning the preservation of biodiversity. It is adopted, for example, by the Zoological Society of London (http://www.zsl.org/) and the World Wide Fund for Nature (http://www.wwf.org/). In connection with this phylogenetic diversity, Weitzman (1998) defines the problem that he called Noah’s Ark Problem (NAP): with each taxon i is associated an initial survival probability aithat can be increased to biat cost ci. NAP consists in determining a subset of taxa S which, under the budget constraint∑i∈Sci⩽B, maximizes the expected value of PD (S), i.e. the quantity∑u∈Ulu(1-∏i∈Xu∩S(1-bi)∏i∈Xu-S(1-ai))where Xuis the set of leaves reachable from the arc u. Several special cases of NAP have been considered in the literature. For example, if ai=0, bi=1 and ci=1, NAP consists in finding a subset S⊆X of B leaves that maximizes PD (S), and can be solved polynomially by a greedy algorithm (Pardi and Goldman, 2005; Steel, 2005). If ci=1 and if (1−bi)/(1−ai) is equal to a constant between 0 and 1 and independent of i, the problem can also be solved by a polynomial greedy algorithm (Hartmann and Steel, 2006). For other results on complexity and polynomial approximation of NAP, the reader can refer to (Hartmann and Steel, 2006; Hickey et al., 2008; Pardi and Goldman, 2007). Pardi (2009) proposes a generalization of the problem. One has a total budget of B units and one can allocate to each taxon i an amount of k units, k∈{0,1,…,B}. There are thus, for each taxon i, (B+1) possible survival probabilities. The author proposes a solution of the problem by dynamic programming. His method is effective in practice on some instances but its polynomiality is not proved.Here, we present a generalization of the problem by Billionnet (2013). For each taxon i, niconservation policies are possible. The kth policy applied to i has a cost cikand leads to a survival probability equal to pik. We assumeci1<ci2<⋯<ciniand0⩽pi1<pi2<⋯<pini<1. The problem is to determine the policy to apply to each taxon to maximize the expected value of the phylogenetic diversity of all taxa while meeting a budget constraint. Denoting k(i) the policy applied to the taxon i, one obtains an expected phylogenetic diversity equal to∑u∈Uλu(1-∏i∈Xu(1-pi,k(i))). It is easy to show that this problem is NP-hard from the 0–1 linear knapsack problem (Hartmann and Steel, 2006). Now, formulate the generalization of the Noah’s Ark problem by a mathematical program. For each taxon i and each policy k, define the Boolean variable xikwhich is equal to 1 iff the kth policy is applied to the conservation of the taxon i. Let IK={(i,k):i∈X, k=1,…,ni}. The problem can be formulated by the nonlinear program in 0–1 variables(P43):maxxik∈{0,1}((i,k)∈IK)∑u∈Uλu1-∏i∈Xu1-∑k=1nipikxik:∑(i,k)∈IKcikxik⩽B,∑k=1nixik=1(i∈X).The first constraint of (P43) is a budgetary constraint and the second one expresses that a single conservation policy must be applied to each taxon. Solving (P43) is difficult due to the nonlinearity of the objective function. Let us see the formulation (P44) of the problem that consists in expressing the probability that the arc u does not intervene (in the computation of the expected phylogenetic diversity) in function of the probabilities that the arcs directly following u in the rooted tree does not intervene either. Associate with each arc u the real variable zuwhich is equal to the probability that u does not intervene. Let Aube the set of arcs that follow directly the arc u, and UXbe the pendant arcs of U, i.e. the arcs which end is a leaf. For all non-pendant arcs, we have the equalityzu=∏j∈Auzj. For each pendant arc u of the tree, denote by ext (u) the corresponding leaf. The problem can then be formulated by(P44):maxxik∈{0,1}((i,k)∈IK)∑u∈Uλu(1-zu):∑(i,k)∈IKcikxik⩽B,∑k=1nixik=1(i∈X),zu=∏k∈Auzk(u∈U-UX),zu=1-∑k=1nipikxik(u∈UX,i=ext(u))where for all pendant arcs u, zuis the extinction probability of the species ext (u). Using the logarithmic function, we get the equivalent program, which the nonlinearity appears only in the constraint yu=log zu,(P45):maxxik∈{0,1}((i,k)∈IK)∑u∈Uλu(1-zu):∑(i,k)∈IKcikxik⩽B,∑k=1nixik=1(i∈X),yu=logzu(u∈U),yu=∑k∈Auyk(u∈U-UX),yu=∑k=1nilog(1-pik)xik(u∈UX,i=ext(u)).Then using the same technique as in Section 2.5, we can obtain an approximate solution of (P45) with a good guarantee. Experiments have shown that a few minutes of computation were normally needed to treat phylogenetic trees with thousands of nodes and about 10 conservation policies for each taxon.

@&#CONCLUSIONS@&#
