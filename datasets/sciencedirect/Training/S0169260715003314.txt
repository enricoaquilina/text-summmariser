@&#MAIN-TITLE@&#
ECG-based heartbeat classification for arrhythmia detection: A survey

@&#HIGHLIGHTS@&#
Surveys the feature description methods, and the learning algorithms employed.Also surveys the ECG signal preprocessing and the heartbeat segmentation techniques.Description of databases used for methods evaluation indicated by the AAMI standard.Discussion of limitations and drawbacks of the methods in the literature.Concluding remarks and future challenges are also pointed out.

@&#KEYPHRASES@&#
ECG-based signal processing,Heartbeat classification,Preprocessing,Heartbeat segmentation,Feature extraction,Learning algorithms,

@&#ABSTRACT@&#
An electrocardiogram (ECG) measures the electric activity of the heart and has been widely used for detecting heart diseases due to its simplicity and non-invasive nature. By analyzing the electrical signal of each heartbeat, i.e., the combination of action impulse waveforms produced by different specialized cardiac tissues found in the heart, it is possible to detect some of its abnormalities. In the last decades, several works were developed to produce automatic ECG-based heartbeat classification methods. In this work, we survey the current state-of-the-art methods of ECG-based automated abnormalities heartbeat classification by presenting the ECG signal preprocessing, the heartbeat segmentation techniques, the feature description methods and the learning algorithms used. In addition, we describe some of the databases used for evaluation of methods indicated by a well-known standard developed by the Association for the Advancement of Medical Instrumentation (AAMI) and described in ANSI/AAMI EC57:1998/(R)2008 (ANSI/AAMI, 2008). Finally, we discuss limitations and drawbacks of the methods in the literature presenting concluding remarks and future challenges, and also we propose an evaluation process workflow to guide authors in future works.

@&#INTRODUCTION@&#
There are various types of arrhythmias and each type is associated with a pattern, and as such, it is possible to identify and classify its type. The arrhythmias can be classified into two major categories. The first category consists of arrhythmias formed by a single irregular heartbeat, herein called morphological arrhythmia. The other category consists of arrhythmias formed by a set of irregular heartbeats, herein called rhythmic arrhythmias. The classification of normal heartbeats and the ones composing the former group are on the focus of this survey. These heartbeats produce alterations in the morphology or wave frequency, and all of these alterations can be identified by the ECG exam.The process of identifying and classifying arrhythmias can be very troublesome for a human being because sometimes it is necessary to analyze each heartbeat of the ECG records, acquired by a holter monitor for instance, during hours, or even days. In addition, there is the possibility of human error during the ECG records analysis, due to fatigue. An alternative is to use computational techniques for automatic classification.A full automatic system for arrhythmia classification from signals acquired by a ECG device can be divided in four steps (see Fig. 1), as follows: (1) ECG signal preprocessing; (2) heartbeat segmentation; (3) feature extraction; and (4) learning/classification. In each of the four steps, an action is taken and the final objective is the discrimination/identification of the type of heartbeat.The first two steps of a such classification system (ECG signal preprocessing and heartbeat segmentation) have been widely explored in the literature [2–6]. The techniques employed during the preprocessing step directly influence the final results, and therefore, should be carefully chosen. The results related to the heartbeat segmentation step, in the case of QRS detection, are very close to optimal. However, there is still room for exploration and improvements in the steps related to classification (feature extraction and learning algorithms). Even though the problem of ECG delineation is still open, it is not so useful for the methods in the literature surveyed here.This paper presents a survey of existing studies found in literature regarding the ECG-based arrhythmia classification methods and discusses the main techniques used for the construction of these automatic systems as well as two main paradigms used for evaluation: inter-patient and intra-patient [7,8]. In addition, the most popular databases and the problems related to the evaluation of current methods found in literature are also discussed. From this discussion, a workflow is proposed to guide the evaluation process of future works. Note that this workflow for evaluation process constitutes an important contribution of this survey work. In the literature, we find a survey of knowledge-based ECG interpretation [9] reviewing methods proposed in the 20th century. Clifford et al. [1] performed an extensive survey on the methods used for ECG signal analysis. Their study focused on the physiology of the signal, as well as its processing techniques, mainly on the feature extraction and classification. In particular, Clifford et al. [1] did not focus on the problem of evaluating methods, which is the differential of our study, in addition to a more up-to-date literature review on the issue. Moreover, our survey on feature extraction brings a special review on feature selection.The remaining of this paper is organized as follows. Section 2 introduces the fundamental aspects of ECG signals; the state-of-art is described in Sections 3, 4, 5, and 6; and the evaluation standards developed by the Association for the Advancement of Medical Instrumentation (AAMI) [10] and the databases recommended for these standards, together with the criticisms related to the systems developed up to date and future challenges, are discussed in Sections 7, 8, and 9.More specifically, Section 3 deals with the preprocessing techniques most utilized in ECG signals, while Section 4 presents the concept of segmenting heartbeats from the ECG signals and its commonly employed techniques. Section 5 deals with the key point for the success of arrhythmia classification, i.e., the representation of a heartbeat or the feature extraction process. Section 6 discusses the most popular learning algorithms found in literature for arrhythmia classification. Section 7 presents the recommended evaluation standard proposed by AAMI and describes the characteristics of the most utilized databases, indicated by the standard, to evaluate the classification arrhythmia methods. Section 8 presents some comments related to the issue of selecting data for learning/evaluating models for arrhythmia classification and its impact on the final result. Finally, Section 9 discusses the limitations and problems of the field and point out future challenges for the research community.The heart is a muscle that contracts in a rhythmical manner, pumping blood throughout the body. This contraction has its beginning at the atrial sine node that acts as a natural pacemaker, and propagates through the rest of the muscle. This electrical signal propagation follows a pattern [11]. As a result of this activity, electrical currents are generated on the surface of the body, provoking variations in the electrical potential of the skin surface. These signals can be captured or measured with the aid of electrodes and appropriate equipment.The difference of electrical potential between the points marked by the electrodes on the skin, usually is enhanced with the aid of an instrumentation (operational) amplifier with optic isolation. Then, the signal is submitted to a high-pass filter; and as a second stage, submitted to an antialiasing low-pass filter. Finally, it appears in an analogical to digital converter. The graphical registration of this acquisition process is called electrocardiogram (ECG) (see Fig. 2). Since Augustus Desiré Waller demonstrated the first human ECG in 1887, the electrical activity of the heart has been recorded [12]. Even so, the ability to recognize the normal cardiac rhythm and/or arrhythmias did not become routine in medical check-ups until 1960.Nowadays, there are many approaches to measurement/record ECG. da Silva et al. [13] provided a taxonomy of state-of-the-art ECG measurement methods: in-the-person, on-the-person and off-the-person.Within the in-the-person category, there are equipments designed to be used inside human body, such as surgically implanted ones, subdermal applications or even ingested in the form of pills. These devices are used when less invasive approach are not applicable.Contrasting with the in-the-person category, there is off-the-person category. Devices on this category are designed to measure ECG without skin contact or with minimal skin contact. According to [13], this category is aligned with future trends of medical application where pervasive computer systems are a reality. Examples of such equipments are the ones based on capacitive devices which measure the electric field changes induced by the body allowing ECG measurement at distance of 1cm or more even with clothing between the body and the sensor [13–15].The majority of devices used for ECG measurements are in the on-the-person category. Devices on this category normally require the use of some electrodes attached to the skin surface. Examples of such equipments are bedside monitors and holters. Nowadays, the standard devices used for heartbeat analysis come from this category.On equipments belonging into the on-the-person category, three or more electrodes are used to obtain the signal, in which one of them serves as a reference for the others. Usually, the reference electrode is placed near the right leg. As such, there can be different visions of the ECG signal, depending on the pair of electrodes chosen to construct the signal. These differentiated visions are given the name of leads.A widely used configuration of electrodes is one composed of 5 electrodes [16]: one of the electrodes is positioned on the left arm (LA), one on the right arm (RA), one on the left leg (LL), one on the right leg (RL) and one on the chest, to the right of the external (V or V1). Another widely employed setup uses 10 electrodes [16], where 5 extra electrodes (besides V or V1 on the chest and LA, RD, LL and RA on legs and arms) are positioned on the chest (V2 to V6) allowing a formation of 12 leads. The 10 electrodes (12 leads) configuration can be seen in Fig. 3.From these configurations, several different leads can be constructed to visualize the ECG signal. For example, Fig. 4illustrates 3 particular leads: (I) formed by the electrical potential difference between the LA and RA electrodes; (II) formed by the electrical potential difference between the LL and RA electrodes; and (III) formed by the electrical potential difference between the LL and LA electrodes.The previously described lead II is one of the most utilized for diagnosing heart diseases. It highlights various segments within the heartbeat, besides displaying three of the most important waves: P, QRS and T (see Fig. 5). These waves correspond to the field induced by the electrical phenomena occurring on the heart surface, denominated atrial depolarization (P wave), ventral depolarization (QRS complex wave) and repolarization (T wave). The patterns provoked by arrhythmias can deeply change these waves. Meanwhile, lead V and its correlate leads (V1, V2) favor the classification of ventricular related arrhythmias, since there are electrodes positioned on the chest, improving the registry of action potentials on ventricular muscle.Therefore, the leads most utilized for the automatic heartbeat and arrhythmia classification are leads II and V and the methods that use a combination of these two leads (and other combinations) are the ones that present the best results to date [17]. In this sense, the recent work by Tomasic and Trobec [18] reviews methods working with reduced numbers of leads and approaches for the synthesis of leads, concluding that the traditional 12 lead system can be synthesized from a smaller number of measurements [19]. In contrast, another study published by de Chazal [20] demonstrated that similar effectiveness for ECG arrhythmia classification can be obtained at a lesser computational cost when using only one lead, compared with methods using multiple leads [7].Although on-the-person is the mainstream on devices aiming heart diseases diagnoses, [13] have shown that data captured with off-the-person based devices can be highly correlated to data captured with traditional on-the-person based equipments. The authors claim that off-the-person based equipments can extend preventive medicine practices by allowing ECG monitoring without interference on daily routine. In that sense, we encourage researchers to build ECG databases based on off-the-person devices to evaluate and validate heartbeat classification methods for that category.Among all proposals for reducing noise in ECG signals, the simplest and most widely used is the implementation of recursive digital filters of the finite impulse response (FIR) [22], which was made computationally possible with the advance in microcontrollers and microprocessors. These methods work well for the attenuation of the known frequency bands, such as the noise coming from the electrical network (50Hz or 60Hz), since they allow quick and easy application of the reject-band-filter. The problem with this approach is that the frequency of the noise is not always known, which can be solved by applying filters for various frequency bands to the signal. However, the indiscriminate use of filters, i.e., high-pass and low-pass ones, distorts the morphology of the signal, and many times, makes it unusable for diagnosing cardiac diseases. Architectures with adaptive filters [23,24] were also employed for noise removal from the ECG signals. However, according to Thakor and Zhu [25], this technique has constraints and does not offer great advantages over the FIR digital filters. Xue et al. [26] surmount some of these difficulties by using adaptive filters based on neural networks such that the noise reduction was significantly improved. This strategy proportioned better detection of the QRS complex, when compared with the same method using linearly adaptive filters.In the last decade, many methods based on wavelet transforms have been employed to remove noise, since they preserve ECG signal properties avoiding loss of its important physiological details and are simple from a computational point of view [27–29]. Sayadi and Shamsollahi [2] proposed a modification of the wavelet transform called the multi-adaptive bionic wavelet transform and it was applied to reduce noise and baseline variation of the ECG signal. This method presented superior results when compared to the ones based on the traditional wavelet transform.Other methods have also presented interesting results on noise attenuation. Sameni et al. [30] have proposed the use of nonlinear Bayesian filters for ECG signal noise reduction, presenting promising results. A new algorithm based on the Extended Kalman Filter [3], which incorporates the parameters of the ECG dynamic model for ECG noise reduction and signal compression, yielded a significant contribution because the method showed the greatest effectiveness to date. Note that the works in [2,3,30] report their results in terms of signal to noise ratio.Techniques for preprocessing the ECG signal are widely explored, but the choice of which method to use is intrinsically connected with the final objective of the research. Methods focusing on the heartbeat segmentation from the ECG signal (i.e., detection of the QRS complex, other waves or fiducial points aiming at heartbeat delimitation) tend to require a preprocessing that is different from the methods focusing on the automatic classification of arrhythmias.Table 7 sumarizes the main reviewed references of methods aiming at heartbeat classification and this table is explored further (Section 8). Those methods follow AAMI instructions and the same protocol to report the results, but different preprocessing techniques are used. de Chazal et al. [7] used two median filters to remove baseline wander. One median filter of 200-ms width to remove QRS complexes and P-waves and other of 600ms width to remove T-waves. The resulting signal is then filtered again with a 12-tap, low-pass FIR filter with 3-dB point at 35Hz. Same preprocessing is used in [31–35,8,36]. In [37] signal is preprocessed with 10th order low pass FIR filter. Ye et al. [38] used a wavelet-based approach to remove baseline wander [39] and then a band-pass filter at 0.5–12Hz is applied to maximize QRS complex energy. Bazi et al. [40] proposed the use of high pass filter for noise artifacts and a notch filter for power network noise. Lin and Yang [41] uses a second order low pass filter and two median filter. In [42], the signal is subtracted by its mean and then normalized. Escalona-Moran et al. [43] used the raw wave i.e., no preprocessing is applied.Note that the methods cited in Table 7 use different preprocessing approaches. However, the impact of these approaches on automatic arrhythmia classification methods is not clear. The considered state-of-the-art methods do not even apply preprocessing on the signal. Although some studies exist relating preprocessing techniques with the final performance of the automatic classification of arrhythmias, such as the work presented in [44], they are insufficient in number and more research in this area is encouraged. It is worth noting that the state-of-the-art methods for automatic arrhythmia classification do not use state-of-the-art preprocessing methods signal to noise ratio improvement.Heartbeat segmentation methods (i.e., detection of the R peak or the QRS complex) have been studied for more than three decades [49,53,46,54,55] and the generations of these algorithms and newly developing methods reflect the evolution of the processing power of computers. With the facility of using faster processing computers, authors stopped worrying about computational cost and started concentrating on the heartbeat segmentation accuracy. Two measures are usually considered for evaluating the accuracy of heartbeat segmentation: sensitivity and positive predictivity, which are defined as:(1)SensitivitySEG=TP/(TP+FN),and(2)Positive predictivitySEG=TP/(TP+FP),where TP (True Positive), FP (False Positive) and FN (False Negative) indicate the number of heartbeats correctly segmented, number of segmentations that do not correspond to the heartbeats, and number of segmentations that were not performed, respectively.For a fair comparison of the methods focusing on the heartbeat segmentation, a standard database needs to be used. The most utilized, and recommended by ANSI/AAMI for the validation of medical equipment [10], is the MIT-BIH database for arrhythmia analysis [56] – in this case, used for heartbeat segmentation, although other databases are also used, such as that of AHA [57] and that of CSE [58]. However, according to Kohler et al. [59], many of the methods presented in the literature do not use a standardized database, or use only part of it, which makes it difficult to fairly compare methods.An approach widely used for segmentation, due to its simplicity and promising results, is based on digital filters for the attenuation of the noise and removal of the fluctuating baseline, nonlinear translations that enhance the R peak and adaptive detection threshold were proposed by Pan and Tompkins [49]. More sophisticated methods have also been used, such as methods based on neural networks [53], genetic algorithms [50], wavelet transform [60,61,4], filter banks [46], Quad Level Vector[62], among others. Table 1displays the performance of some methods for heartbeat segmentation that use the MIT-BIH database for evaluation. Note that the SensitivitySEG(Se) and Positive predictivitySEG(+P) values do not show great differences in the methods studied. It is important to highlight that the methods presented in this table, contemplated a large spectrum of complexity, i.e., from very simple methods to more elaborated ones.Some algorithms also propose to identify other waves associated with heartbeats, such as the P wave and the T wave [4,63–65], which can be useful for arrhythmia classification methods, since more information about the heartbeats can be obtained.Although heartbeat segmentation is not the main focus of this survey, note that this stage is of paramount importance in the arrhythmia heartbeat classification process, since some errors here are propagated to the following stages and have a strong impact in the final classification of the arrhythmia system. However, a large majority of the reviewed researches herein utilized databases in which the events related to heartbeat segmentation, i.e., the detection of the R peak or the QRS complex, are identified and previously labeled, reducing the segmentation stage to a simple search of a labeled event in the database. In this way, the results reported by these works disregard the impact of segmentation step even though the database labeling is prone to human errors. Therefore, evaluating the impact of different segmentation algorithms on automatic arrhythmia classification methods can be a promising research direction.Ye et al. [66] proposed a test to investigate the robustness of their feature extraction method against one segmentation issue, the R-peak mislocate error. A Gaussian-distributed artificial jitter was used to add error on R-peak annotations. We suggest to other authors to incorporate such test in future works aiming automatic heartbeat classification.The feature extraction stage is the key to the success in the heartbeat classification of the arrhythmia using the ECG signal. Any information extracted from the heartbeat used to discriminate its type maybe considered as a feature. The features can be extracted in various forms directly from the ECG signal's morphology in the time domain and/or in the frequency domain or from the cardiac rhythm. Most popular methods proposed in literature are discussed in Section 5.1.Even though some works regard feature extraction and feature selection as two interchangeable terms, these two process are in fact different. While feature extraction is defined as the stage that involves the description of a heartbeat, feature selection consists in choosing a subset with the most representative features with the objective to improve the classification stage. Section 5.2 is dedicated to describe feature selection approaches.The most common feature found in the literature is calculated from the cardiac rhythm (or heartbeat interval), also known as the RR interval. The RR interval is the time between the R peak of a heartbeat with respect to another heartbeat, which could be its predecessor or successor. With exception of patients that utilize a pacemaker, the variations perceived in the width of the RR interval are correlated with the variations in the morphology of the curve, frequently provoked by arrhythmias [1]. Thus, the features in the RR interval have a great capacity to discriminate the types of heartbeats and some authors have based their methods only on using the RR interval features [67–69]. Variations of this feature are used to reduce noise interference and are very common, e.g., the average of the RR interval in a patient for a certain time interval [70].Lin and Yang [41] have shown that the use of a normalized RR-interval significantly improves the classification results. Only normalized RR-intervals are used in that work and the results are comparable to the state-of-the-art methods even under the inter-patient paradigm. Doquire et al. [71] confirmed the efficiency of normalized RR-intervals by means of feature selection techniques.Other features extracted from the heartbeat intervals are also found in literature, such as other distances between the fiducial points of a heartbeat (here called ECG-intervals or ECG segments), as can be seen in Fig. 5. Among these intervals, the QRS interval, or the duration of the QRS complex, is the most utilized. Some types of arrhythmias provoke variations in the QRS interval, making it a good discriminating feature [7,72]. It is worth mentioning that there exist other algorithms available to determine these fiducial points, such as the one proposed by Laguna et al. [63]. Table 2displays the standard values for these intervals, considering a healthy human being with no cardiac abnormalities.Features extracted from the domain of time/frequency together with the features of the RR interval appear as part of the methods that produced the highest accuracies in literature to date (see Table 7). The simplest way to extract features in the time domain is to utilize the points of the segmented ECG curve, i.e., the heartbeat, as features [73,74]. However, the use of samples of the curve as features is a technique that is not very efficient, since besides producing a vector of the features with high dimensions (depending on the amount of samples used to represent the heartbeat), it suffers from several problems related to the scale or displacement of the signal with respect to the central point (peak R).Aiming at reducing the dimension of the feature vector, various techniques have been applied directly on the samples that represent the heartbeat (in the neighborhood of the R peak) as principal component analysis (PCA) [75–77], or independent component analysis (ICA) [78–80], in which new coefficients are extracted to represent the heartbeat. Chawla [81] presents a comparative study between the use of PCA and ICA to reduce the noise and artifacts of the ECG signal and showed that PCA is a better technique to reduce noise, while ICA is better one to extract features. The ICA technique enables statistically separate individual sources from a mixing signal. The ECG is a mix of several action potentials and each action potential could be strongly related to an arrhythmia class. The rationale behind ICA for ECG heartbeat classification is to separate the action potentials sources as well as the noise sources. The PCA technique separates the sources according to the energy contribution to the signal. The study presented in [81] suggest that noise sources on this base have low energy and are difficult to isolate and that the individual sources isolated by ICA are promising features for ECG classification. Moreover, it has been shown that the combination of these two techniques, i.e., PCA for noise reduction and ICA for feature extraction, can offer greater advantages when compared to using only one of them. Another technique based on PCA, the Kernel Principal Component Analisys (KPCA), was used by Kanaan et al. [82]. In that work, a comparison between PCA and KPCA was performed and it was concluded that KPCA is superior to the PCA technique for classifying heartbeats from the ECG signal. According to Kallas et al. [83], KPCA performs better, due to its nonlinear structure.Özbay et al. [84] used clustering techniques directly in points sampled from the curve to reduce from 106 samples to 67 clusters/points. The authors also used a clustering technique to increase the number of features to 212, but there were no significant differences in the results.Asl et al. [85] used Generalized Discriminant Analysis (GDA) to reduce the dimensions of the features of the heartbeat interval type to classify rhythmic arrhythmias. They reported an accuracy close to 100% for this type of arrhythmia using the MIT-BIH database. However, the authors did not take care to separate the heartbeats of the same patient used during training and testing (intra-patient paradigm), which is a serious concern discussed further. The inter-patient paradigm should be considered for a more realistic scenario.Simpler techniques, such as interpolation, have also been used to reduce the number of points representing the heartbeat. An example of this technique is presented by de Chazal et al. [7], in which the heartbeat, originally represented by 250 samples (approximately 600ms of the curve, sampled at 360Hz), was sub-divided and presented in 18 samples (see Fig. 6). In the literature, the sub-sampled ECG wave is also called morphology or morphological features.Recently, random projections have also been employed for such aim, as in [86,42]. Huang et al. [42] show that features extracted with random projections produced results comparable to the state-of-the-art methods, even when considering the inter-patient paradigm.Other techniques have also been employed, such as linear predictive coding [87], high order accumulates [88,89], clustering [84,90,91], correlation dimension and largest Lyapunov exponent [92,93], Hermite transform [94], local fractal dimension [95].Although various techniques have been considered, most of the studies presented in literature use wavelet transforms and researchers claim that this is the best method for extracting features from the ECG signal [44,96,97]. The wavelet transform allows information extraction from both frequency and time domains, different from what is usually achieved by the traditional Fourier transform [98] which permits the analysis of only the frequency domain. Within the types of wavelet transform, the discrete wavelet transform (DWT) is the most popular for ECG signal classification due to its easy implementation.Besides DWT, continuous wavelet transform (CWT) has also been used to extract features from the ECG signals [99], since it overcomes some of the DWT drawbacks, such as the coarseness of the representation and instability. However, CWT is not largely used due to the fact that its implementation and its inverse are not available in standard toolboxes (such as MATLAB wavelet Toolbox) and CWT should be carefully discretized for the use as a CWT analyzer. In addition, even though Addison [99] emphasizes the high computational cost as a disadvantage for using CWT, it has been employed successfully even on simple medical equipments for at least a decade. Finally, Addison [99] defends the use of DWT, together with CWT, because they offer gain over the methodologies used nowadays, in which the authors use only one of the transforms.According to Güler and Übeyli [44], the choice of the mother wavelet function used for feature extraction is crucial for the final performance of the classification model. This choice should be carefully analyzed in order not to lose important ECG signal details. Besides the choice of the mother wavelet function, the order of filter and level of decomposition are parameters that influence the final results of the arrhythmia classification. Daamouche et al. [100] proposed the use of the Particle Swarm Optimization (PSO) technique for optimizing these parameters, and concluded that this process improve the final results.In the literature, various statistical features extracted from the coefficients of wavelet transform are proposed, such as mean, standard deviation, energy [44] and coefficient variance [101]. These features have a great advantage since they are immune to the variations of fiducial point marking. Some authors used techniques to reduce the space of the features after applying the wavelet transform, such as in the work of Song et al. [102] who compared the PCA and linear discriminant analysis (LDA) techniques for dimensional reduction after the use of wavelet transform. Wang et al. [103] and Polat & Güneş [104] also employed PCA to reduce features formed by wavelet coefficients and also reported a significant improvement their results. According to Güler and Übeyli [44], the Daubechies wavelets are the most appropriated mother wavelets for ECG heartbeat classification. Among them, the Daubechies of order 2 offers the best accuracy.Although many techniques have been proposed to extract and reduce features from ECG signals aiming heartbeat classification, only a few of them have considered the inter-patient paradigm as one can see in Table 7. Therefore, it is difficult to evaluate whether features extracted with PCA, ICA, GDA and others are useful to discriminate patients or heartbeats.The variance of the autocorrelation function is considered to be a measure of similarity or coherence between a signal and its shifted version [101]. This technique is used for feature extraction from wavelet coefficients [101,37], and have demonstrated to be effective in the discrimination of arrhythmic heartbeats.The vectorcardiogram (VCG) is a representation of the ECG signal in two dimensions that integrates information from two leads (see Fig. 7). Features extracted with VCG were used in [105,31,106,37]. According to Goldberger et al. [107], heartbeat classification categorized as Supraventricular ectopic beat (SVEB) and Ventricular ectopic beat (VEB) (arrhythmic heartbeats) can be favored by information from leads of type V1, V2 or V4. Because of this, it is believed that the features extracted by VCG (combined with leads II and V1) can help to better discriminate minority and important arrhythmic classes such as SVEB and VEB.According to Llamedo and Martinez [37], many authors have used techniques that reduce the feature space, but few have investigated techniques for feature selection in the context of arrhythmia classification. Llamedo and Martinez [37] employed, for the first time in literature, an algorithm for feature selection by using floating sequential search for arrhythmia classification. This method interchanges algorithms executing forward and backward searches to obtain a set with the most robust features and avoid local optima in the feature space. The proposed method achieved better results than the state-of-art method using only eight selected features.Recently, Mar et al. [34] also performed feature selection by using the floating sequential search [108]. In that study, the authors analyzed a set of possibilities of the feature selection, searching for a trade-off between the number of features and accuracy. The aim of that research was to make a specially developed method adequate for ambulatory monitoring; that is, to be specially useful in real world applications. For such aim, an objective function optimized by a feature selection method, was especially developed to be an indicator of the quality of the arrhythmia classifications from an ECG signal. In addition to the linear discriminant (LD) classifier used in previous works, Mar et al. [34] employed a multi-layer perceptron. However, neither of these results were better than those proposed by de Chazal et al. [7] and the work of Llamedo and Martinez [37] in terms of accuracy. Nonetheless, the focus of Mar et al. [34] work was on the maintenance of accuracy with the use of a reduced number of features.Feature selection techniques can bring various benefits for the classification methods, such as the increase of the generalization power of the classification algorithms and the reduction of the computational cost, due to the fact that they use a smaller number of features to construct the final model [34]. However, in the works analyzed in this survey, these techniques were little explored.Doquire et al. [71] compare wrapper feature selection technique against a filter feature selection technique and more than 200 types features (dimensions) are considered for the task. The wrapper feature selection is used with the weighted LD model using a forward-backward search strategy. The filter technique employed is the mutual information in conjunction with ranking approach and weighted SVM (Support Vector Machines). According to the authors, results have shown that higher figures are obtained when a very small number of features are selected. They stressed that the most important features appears are R-R intervals, the amplitude and length of the T wave, and 2nd-order statistics. Also they claimed that the mutual information criterion is a powerful tool for feature selection in this scenario.According to Zhang et al. [35], many features are associated with mathematical interpretation and do not have a clear meaning to physicians. Usually, the authors employ several combined features and the understanding of which feature contributes to detection of which class of heartbeat is also not clear in the literature. Aiming that, Zhang et al. [35] proposed a heartbeat class-specific feature selection scheme to allow the investigation of feature contribution for each arrhythmia/heartbeat class. Thus, we suggest the incorporation of this approach on works aiming heartbeat classification. It could bring important contribution to the literature by allowing better understanding of correlation among heart diseases and features extracted from ECG.State-of-art techniques for attribute selection, such as Genetic Algorithms (GA) [109,110] and particle swarm optimization (PSO) [111,112] can also provide promising results and should be better investigated in future works.Once the set of features has been defined from the heartbeats, models can be built from these data using artificial intelligence algorithms from machine learning and data mining domains [113–115] for arrhythmia heartbeat classification.The four most popular algorithms employed for this task and found in the literature are: support vector machines (SVM) [40,38,66], artificial neural networks (ANN) [34,116,69] and linear discriminant (LD) [7,37,17], and Reservoir Computing With Logistic Regression (RC) [43]. Note that the state-of-the-art method aiming heartbeat classification uses RC algorithm.Due to their importance for cardiac arrhythmic classification, these four classifiers (SVM, ANN, LD, and RC) are discussed in the next subsections (Sections 6.1, 6.2, 6.3 and 6.4). Then, Section 6.5 reviews other techniques that also have been employed to arrhythmia classification.SVM is one of the most popular classifiers found in literature for ECG-based arrhythmia classification methods. Park et al. [33] used SVM and validated the method according to AAMI standards and the data set split scheme proposed by de Chazal et al. [7]. These same authors used SVM in a mock-hierarchy configuration to resolve the imbalance of the MIT-BIH database, and reported promising values. de Lannoy et al. [32] managed to overcome the imbalance of the MIT-BIH database with SVM, alternating the objective function for each class (Weighted SVM). Expressive gains were reported for the SVEB and F classes.Various approaches with SVM variations have been proposed, such as a combination of the fuzzy theory to refine SVM classification [117], combined with an ensemble of classifiers [42], genetic algorithms combined with restricted fuzzy SVM [118] and least squares SVM [104]. Huang et al. [42] used the SVM in a hierarchical manner with a maximum voting strategy and report significantly improvements.Moavenian and Khorrami [119] proposed the use of a new kernel function for capturing data from SVM. In that work, it was used the same methodology for comparing the results obtained from a SVM and a Multilayer Perceptron Artificial Neural Network (MLP-ANN). While SVM was more efficient in execution time, both in the training and in the testing, MLP performed better in terms of accuracy, Sensitivity (Se), positive prediction (+P) and false positive rate (FPR).Since SVM presents a negative behavior for imbalanced classes, database balancing techniques for the training phase, which are little explored for this problem, can be studied in future research, as for example, more sophisticated sampling techniques, i.e., Synthetic Minority Over-sampling Technique (SMOTE) [120].The ANN architectures mostly used for arrhythmia classification are Multilayer Perceptrons (MLP) and Probabilistic Neural Networks (PNN). According to Yu and Chen [101], models constructed with PNN are computationally more robust and efficient than the traditional MLP. However, in [121,84,122,88], it was proposed a hybrid neuro-fuzzy network methods in order to minimize the problems of MLP, increasing its generalization and reducing its training time.Many other approaches based on ANN have been proposed.Güler and Übeyli [44] used combined neural networks in order to obtain a more generic method from a more sophisticated form of cross-validation. However, of all the articles mentioned in this study, only that of Mar et al. [34] used MLP with a more fair evaluation protocol by applying the patient division scheme proposed by de Chazal et al. [7]. Thus by using the reported results in the works of the methods that utilizes ANN as classifier is impossible to makes a fair comparison. Finally, Mar et al. [34] compared MLP with Linear Discriminants and found that MLP was significantly superior.Combining classifiers had been little explored for the task in question. According to Osowski et al. [91], a combination of classifiers not only reduces the overall error in the neural networks, but also reduces the incidence of false negatives.The Linear Discriminant is a statistic method based on the discriminant functions [114]. Such functions are estimated from a training set of data and try to linearly separate the feature vector, being adjusted by the weight vector and a bias. The criteria for calculating the weight vector varies according to the model adopted. In [7], the parameters were determined using the maximum-likelihood calculated from training data.Linear discriminants are the classifiers more used in methods that follow the scheme proposed by de Chazal et al. [7] and recommended by AAMI. The authors of that research claim that the classifier was chosen for its simplicity and for the fact that they did not want to emphasis the classifier, but instead, the proposed features. Amongst its advantages, LD can easily overcome problems generated by the imbalance of the training set (a difficulty presented by approaches based on SVM). When using the scheme proposed in [7], it is a great challenge to tune SVM and MLP classifiers to obtain promising classification effectiveness for the minority SVEB and VEB classes (see Table 9). Moreover, the LD classifier requires less training time, if compared to SVM and MLP, as it is not iterative. That is, it simply calculates statistics from the training data and then, the classification model is defined.According to Rodan and Tiňo [123], reservoir computing models are dynamical models aiming to process a time series signal in two parts: represent the signal through a non-adaptable dynamic reservoir and a dynamic readout from the reservoir. More details regarding RC can be found in [124].The state-of-the-art method for heartbeat classification uses RC [43]. According to Escalona-Moran et al. [43], their approach uses a simple nonlinear dynamical element subject to a delayed feedback where each point of the ECG signal is sampled and held during one delay time and then multiplied by a binary random mask. The learning process is accomplished with logistic regression. The technique appears to be robust to the class imbalance of the dataset. Besides, it achieves the best results in the literature to date (see Table 7). In addition, the authors also claim that the technique is suitable to implement in hardware due to its low computational cost, which allows the development of real time applications for heartbeat classification.Many other methods for arrhythmia classification have been developed using other machine learning and data mining algorithms, such as decision trees [125,126,68], nearest neighbors [127–129], clustering [73,130,131], hidden Markov models [132,133], hyperbox classifiers [105], optimum-path forest [134], conditional random fields [8] and rules-based models [135,67,136].Algorithms with a lazy approach, such as the k Nearest Neighbors (kNN), are not much used for the problem of arrhythmia classification, since their efficiency is intimately connected to previous knowledge to perform the classification of each sample that is represented by the complete training set, which leads to a high computational cost during the testing phase. This cost can invalidate its use for diagnosis in real time. Mishra and Raghav [95] used a classifier based on kNN and reported promising results, however the computational cost was not mentioned. In other works, also based on kNN, in the literature [127,92,128,137,129], no one presented a more fair evaluation protocol for comparison of methods as the one proposed by de Chazal et al. [7], and no one also followed the AAMI recommendations. In addition, the computational cost of these methods was not investigated.Clustering techniques are widely used along with Artificial Neural Networks. According to Özbay et al. [84], they can improve the generalization capacity of the neural networks and diminish the learning time. Some works used unsupervised clustering techniques to agglomerate all of the heartbeats in the record of a given patient into clusters [131] and the final classification of each cluster, i.e., the heartbeats of that group, is then defined by a human specialist [138,130,73]. Other works in this same way [139,140,17], using linear discriminant as classifiers and fair evaluation schemes present promising results which are reliable for real-world applications. It is important to note that this semi-automatic (or patient-specific paradigm) and promising approach still depends on a human specialist.HMM is widely used to audio and speech signal anaysis and recognition [141,142]. Coast et al. [132] used HMM for the arrhythmia classification problem, other studies have used this technique to analyze ECG signals. For instance, Andreao et al. [143] validated the use of HMM for ECG analysis in medical clinics (real world).The Optimum-path Forest (OPF) classifier was used for arrhythmia classification for the first time by Luz et al. [134]. In that work, the OPF performance, in terms of computational cost and overall accuracy, was compared to other three classifiers: Bayesian, SVM and MLP. Experiments showed that OPF obtained, in average, comparable results, revealing it as a promissory approach.Methods that use a decision tree allow an interpretation of the decisions made by the model [68]. However, this type of method is not efficient for continuous features (belonging to a set of real numbers) [144,145] and feature vectors of large dimensions [146]. Thus, methods that use decision trees consider only a few features. For example, in [68], only the features in the RR interval were used in the decision tree. Meanwhile the hyperbox classifiers, besides providing high level of interpretation of the classification rules, are also more efficient for higher dimension feature vectors [105]. Mert et al. [147] used a combination technique of bagging and decision tree. According to the authors, the Bagged Decision Tree demonstrated greater accuracy and a better capacity to discriminate the classes.The methods with the greatest interpretation level are the ones that use a set of rules. The set of rules presented by Tsipouras et al. [135,67,136] was obtained together with cardiologists and are related to a morphological tachogram for arrhythmic events. Methods constructed in conjunction with rules usually present a worser performance, in terms of effectiveness, when compared to other methods proposed in literature. However, no test using a fairer comparison scheme, such as the one proposed by de Chazal et al. [7], and the recommendations of AAMI, was done with methods that use a set of rules. This subject is discussed in depth in Section 8.Using a few discriminative features from previous works [71,37], de Lannoy et al. [8] proposed the use of weighted Conditional Random Fields for the classification of arrhythmias and compared the approach with SVMs and LDs. The experiments demonstrated that the proposed method obtains promising results for the minority arrhythmical classes (SVEB e VEB). However, the relatively low efficiency for the normal class (80%) represents a problem when used in real life scenario (inter-patient paradigm), since many healthy heartbeats will be classified as arrhythmic.Various databases are composed of cardiac heartbeat grouped in patients records freely available that permits the creation of a standardization for the evaluation of automatic arrhythmia classification methods. This standardization was developed by AAMI and is specified in ANSI/AAMI EC57:1998/(R)2008 [10] and defined the protocol to perform the evaluations to make sure the experiments are reproducible and comparable.The use of five databases is recommended by the standardization:•MIT-BIH: The Massachusetts Institute of Technology – Beth Israel Hospital Arrhythmia Database (48 records of 30min each);EDB: The European Society of Cardiology ST-T Database (90 records of 2h each);AHA: The American Heart Association Database for Evaluation of Ventricular Arrhythmia Detectors (80 records of 35min each);CU: The Creighton University Sustained Ventricular Arrhythmia Database (35 records of 8min each);NST: The Noise Stress Test Database (12 records of ECG of 30min each, plus 3 records with noise excess);The most representative database for arrhythmia is the MIT-BIH, and because of this, it has been used for most of the published research. It was also the first database available for this goal and has been constantly refined along the years [148].The majority of the heartbeats recorded in these databases have annotations associated with the type of heartbeat or the events. These heartbeat annotations, as much for the class and for the fiducial points (e.g., point R, maximum amplitude of the heartbeat) are fundamental for the development and evaluation of automatic arrhythmia classification methods.The ANSI/AAMI EC57:1998/(R) 2008 standard also specifies how annotations should be done in the databases. An example can be seen in Fig. 8, in which there is the lead II at the upper part of the figure, lead V1 at the lower, and some annotations in the center. Noteworthy is the fact that it is recommended that records of patients using pacemakers should not be considered. In this database, 4 patients/records have this property and its respective heartbeats should be removed. In addition, segments of data containing ventricular flutter or fibrillation (VF) should also be excluded from the analysis.Although various types of cardiac arrhythmias exist, AAMI recommends that only some types should be detected by equipment/methods. There are 15 recommended classes for arrhythmia that are classified into 5 superclasses: Normal (N), Supraventricular ectopic beat (SVEB), Ventricular ectopic beat (VEB), Fusion beat (F) and Unknown beat (Q). Table 3illustrates the 15 classes and their symbols, as well as the hierarchy of the 5 groups (superclasses).The measures recommended by AAMI for evaluating methods are: Sensitivity (Se), Positive predictivity (+P), False positive rate (FPR) and Overall accuracy (Acc). Sensitivity and Positive Predictivity are also known in literature as recall and precision, respectively; the overall accuracy can be strongly distorted by the results of the majority class. In this way, the first three measures are the most relevant for comparing the methods, since the classes for the heartbeat types are extremely imbalanced in available databases.Calculation of the measures is based on the definitions presented in Table 4. Note that in sections (a), (b), and (c) of Table 4, formulas and schemas to compute Se, +P, FPR and Acc are given for V, S and N classes, respectively. Observe that according to this table, it is not necessary to penalize VEB +P with the false positives Fvand Qv(as highlighted in the schema of Table 4(a)), meanwhile, for SVEB +P, Qv(as highlighted in the schema of Table 4(b)) also does not need to enter the calculation.The standard also suggests that the results should be presented in a global manner, considering that each heartbeat has the same weight (gross statistics) and in per sample basis. A set of results is exemplified in Table 5.Next, we briefly discuss the five databases recommended by the standard, presenting the number of records, sample frequency, resolution and finality of each.This database11The complete information regarding the database as well as its usage and data annotation/labelling can be found in http://www.physionet.org/.is presented in majority of the publications found in literature. It is unique since it contemplates the five arrhythmia groups proposed by AAMI as described in Table 3.This database contains 48 records of heartbeats at 360Hz for approximately 30min of 47 different patients. Each record contains two ECG leads and in the majority of them the principal lead (lead A) is a modification of lead II (electrodes on the chest). The other lead (lead B) is usually lead V1, modified, but in some records, this lead is known to be V2, V5 or V4 [107]. Generally, lead A is used to detect heartbeats, since the QRS complex is more prominent in this lead. Lead B favors the arrhythmic classification of the types SVEB and VEB[107]. More information regarding this database can be found in [148].The EDB database22The EDB database can be obtained in [107].is a collection of 90 records acquired from 79 subjects, sampled at 250Hz with 12-bit resolution. These records were extracted from 70 men (between 30 and 84 years old) and 8 women (between 55 and 71 years old). As all of these subjects were suffering from a specific cardiac disease (i.e., myocardial ischaemia), the database was originally built to allow ST-segment and T-wave analysis.The heartbeats were recorded for a two hour duration and each of them contains two signals (i.e., two leads). Two cardiologists made the annotations for the record and the AAMI standard was used. More information regarding this database can be found in [149].The AHA database33The AHA database can be obtained in https://www.ecri.org/.consists of 155 records, each one composed of two leads, sampled at 250Hz with 12-bit resolution. Each recording is three hours long and only the final 30min have been annotated. The database was created to evaluate ventricular arrhythmia detectors. However, the database does not differentiate normal sinus rhythm from supraventricular ectopic beats (SVEB).The CU database44The CU database and the annotation files can be obtained in [107].is composed of 35 eight-minute ECG recordings, sampled at 250Hz with 12-bit resolution. The database was intended to evaluate algorithms aiming at detecting episodes of sustained ventricular tachycardia, ventricular flutter, and ventricular fibrillation. It provides reference annotation files to aid users to locate these events on the recordings. More information regarding this database can be found in [150].The NSD database55The NSD database and its annotation files can be obtained in [107].includes 12 half-hour ECG recordings and 3 half-hour noise recordings. The noise inserted in the recordings is typical interferences found in ambulatory care services, such as baseline wander, muscle artefact (EMG) and electrode motion artefact. According to Goldberger et al. [107], the electrode motion artefact is considered to be the most troublesome, since it can be easily misinterpreted as ectopic beats. Also, it cannot be easily removed by filters.The ECG recordings available in the NSD database were created based on two clean recordings from MIT-BIH (118 and 119). The noise was artificially inserted in the signals. This database is more detailed described in [151].The AAMI standard specifies a protocol for tests and evaluation of arrhythmia classification methods. It also stipulates which databases should be used. However, it does not specify which patients/heartbeats should be used to construct the model to be classified (training phase) and which patients/heartbeats should be used for evaluation methods, i.e., the testing phase, which may render biased results. For instance, de Chazal et al. [7] demonstrated that the use of heartbeats from the same patient for both the training and the testing makes the evaluation process biased. This is because the models tend to learn the particularities of the patient's heartbeat during the training, obtaining expressive numbers during the test (very close to 100%). As previously mentioned, this heartbeat division protocol is called in the literature intra-patient scheme or paradigm [8,42]. However, in a clinical environment, a fully automatic algorithm/method will find heartbeats of patients different from those they used to learning in the training phase.Intending to specify a protocol, the work of de Chazal et al. [7] proposed a division of the heartbeats from the MIT-BIH database into two sets so that the database becomes more coherent with reality. The first set is composed of all heartbeats of records: 101, 106, 108, 109, 112, 114, 115, 116, 118, 119, 122, 124, 201, 203, 205, 207, 208, 209, 215, 220, 223 and 230, called Dataset 1 (DS1). While the second is composed of all heartbeats of records: 100, 103, 105, 11, 113, 117, 121, 123, 200, 202, 210, 212, 213, 214, 219, 221, 222, 228, 231, 232, 233 and 234, called Dataset 2 (DS2). The authors only used DS1 to construct the classification model, while DS2 was reserved for evaluation. In this way, they guaranteed that the created model had no contact with the heartbeats pertaining to DS2, i.e., heartbeats from DS1 and DS2 come from different individuals. Such division protocol is called in the literature inter-patient scheme or paradigm [7,8,42]. Note that only the MIT-BIH database was used for the creation of the sets, since it is the only one indicated by the AAMI standard that contemplates all 5 of the superclasses for arrhythmias.According to de Chazal et al. [7], these records were primarily divided in two parts: odd and even numbered records. The final record selection was achieved by exchanging some of the records between the parts so as to balance the classes. The heartbeat distribution of the sets can be seen in Table 6. Observe that the two sets have approximately the same number of heartbeats per class, with approximately 100 thousand heartbeats. It is worth mentioning that records 201 and 202 are from the same patient, but are in different sets. The other records pertain to only one patient.de Chazal et al. [7] concluded that for a more realistic evaluation, the DS1 set must be used for training and the DS2 set for testing, making heartbeat classification a significantly more difficult task, and consequently, reducing the performance of the presented classifying method. They also concluded that the minority classes (SVEB and VEB), where the most problematic arrhythmias are found, suffered more with this type of protocol.Tables 7and 8lists the main works, considered by us, published in literature, grouped according to the scheme of heartbeat selection: intra-patient, where heartbeats of the same patients probably appear in the training as well as in the testing dataset; and the second scheme, where authors took the precaution to construct and evaluate the classification using heartbeats from different patients (inter-patient), following the protocol proposed by [7].Works that do not fit into inter-patient category, do not permit fair comparisons with the results in the literature, once a great majority of the authors did not follow the same protocol for the evaluations. As one can see in Table 8, it is also difficult to assess which technique contribute to heartbeat classification, since methods with different approaches achieves very high (>98%) accuracies. Thus, the reported results grouped in Table 8 cannot be taken into consideration from a clinical point of view, since the reported values by these works are probably different in a real life scenario in terms of accuracy.Unfortunately, the great majority of the works in the literature does not concern on following the division defined in [7] or any other inter-patient protocol that imposed the non-usage of heartbeats from the same patient in the training and testing [160], as shown in Table 8.Aiming to standardize the evaluation process considering a clinical point of view and AAMI recommendations, we suggest future works to follow a workflow66The proposed workflow for the evaluation process is an important contribution of this survey work.:1.Database selection:•Use MIT-BIH ARRDB with inter-patient scheme proposed in [7] to allow unbiased literature comparison;Use INCART database to assess generalization power of the method, as proposed in [37];Preprocessing. Run all process with at least 2 filtering scheme besides the proposed filtering method by the authors:•Signal filtering as proposed in [7] to allow literature comparison;Use the Raw Signal, i.e., no filtering. This should work as a ground truth;Segmentation:•Add jitter to R location annotation as proposed in [66] to test the robustness of the method against segmentation errors;Feature extraction:•Use feature selection to report which proposed features improve the results;Use a class-oriented feature selection to assess which feature is more suitable to which disease as proposed in [35]. This could result in an important contribution to the literature;Classification:•During training, use a k-patient cross validation to define model parameters as proposed in [7].Investigate the database imbalance impact on chosen classifier, by reporting results with and without use of techniques to compensate the imbalance;Evaluation:•Present the results according to AAMI recommendations to allow literature comparison;Another paradigm found in the literature is the patient-specific paradigm [139]. This class of work relies on semi-automatic heartbeat classification and is out of scope of this work.Luz and Menotti [161]77The content of this part of this section is an overview of the work published in [161].reimplemented some models that presented an overall accuracy of nearly 100% and were not concerned about the heartbeat selection scheme. Afterwards, they re-evaluated the results produced by the methods with the objective of reporting experiments in accordance with the protocol recommended by AAMI and using the division scheme proposed in [7]. The reported results following and not following the AAMI standard and the protocol proposed in [7] can be seen in Tables 9and 10, respectively. Observe that the chosen methods for this experiment are reasonably recent and contemplate the use of various classifiers and various forms of feature extraction. Analyzing the values of Tables 9 and 10, it can be observed that the results obtained by the same classification method using a scheme of random selection (in which heartbeats were randomly chosen to compose the training and testing sets) are significantly superior to the values obtained with experiments using the division proposed in [7].The results showed in Tables 9 and 10 suggest that to perform a fair evaluation of ECG-based heartbeat classification methods, heartbeats of the same patient should not be present in both training and testing sets, since it is not a realistic scenario. Otherwise, the classifiers will learn nuances of patients in the training set and as such, the evaluation of a method on the testing set using heartbeats of a patient whose heartbeats are present in the training set as well, is biased, even if the heartbeats of the same patient are different. Although some works in literature strongly draw attention to this bias problem [7,160,161,37], few authors have taken the precaution of following a protocol, as proposed by AAMI, to report the results and evaluate the methods, which makes it difficult to make a fair comparison of the works published in literature.Researchers have raised several problems related to the automatic classification of cardiac arrhythmias [161,7,34,37], which are discussed in the next paragraphs.Results presented in literature usually use the MIT-BIH database (also known as MIT-BIH ARR DB) that is extremely unbalanced. However, this aspect has been ignored by authors that use the intra-patient scheme. Authors that followed a more realistic approach and opted not to mix heartbeats for the training and testing (inter-patient scheme), reported great difficulty in obtaining promising results for the heartbeat arrhythmia classes SVEB and VEB. As such, there exist innumerous proposed methods in the literature that do not follow a more fair evaluation protocol.Several authors employ semi-automatic approaches [139,162,163] to improve the reported results. According to [162], semi-automatic approaches can improve the results in over 40% even when a small number of heartbeats are selected for adaptation. The drawback of such approaches is that they demand intervention of experts. However, expert intervention is common in clinical environment and therefore this approach is a promising research direction.Regarding fully-automatic approaches, we stress that even the protocol proposed by de Chazal et al. [7], considered to be the most fair presented in the literature, has some problems that were previously related by Llamedo & Martinez [37] and Mar et al. [34]. The imbalance between the classes led the authors to add two records of the same patient in the two already-mentioned sets. Since these records, 201 and 202, are from the same patient and belong to sets DS1 and DS2, respectively, results slightly better than expected might be achieved. In addition, records 201 and 202 significantly concentrate on a large part of heartbeats class SVEB. Another important weakness of the protocol proposed in [7] is the use of the imbalanced record 232 in DS2. That record contains more than 75% of heartbeats of the class SVEB. As such, methods that achieve correct classification for the heartbeats of this record can be erroneously considered as state-of-the-art, when in truth, they could just be specialized with the heartbeat of only a single patient.Researchers from the machine learning community have shown that the size/diversity of the databases used for the construction of methods impacts more than the choice of the learning algorithm and/or employed techniques [164]. Efforts to create new databases or even to increase the size of existing ones, as well as creating standard evaluation protocols, have been made in several research areas involving pattern recognition, specially to avoid unfair comparisons between methods [165].We believe that one major obstacle to achieving advances in the research focusing on fully-automatic classification of heartbeats (arrhythmias) in ECG is the reduced number of available databases. Therefore, we suggest to the research community dedicated to study the heartbeat classification problem that they encourage/stimulate the extension of databases dedicated for this end.We also suggest the use of new trends to capture the ECG signal, such as off-the-person approaches, for the elaboration of new databases. Nonetheless, we believe that the creation of such databases would be a great challenge because, besides the financial costs involved, they would have to be incorporated into standards such as AAMI standards to reach the desired audience.As few authors use the same evaluation scheme for tests, it is difficult to make a fair comparison between the methods. It is also difficult to asses the real contribution of the methods since the intra-patient scheme favors the reported figures. Another challenge would be study and re-implement intra-patient methods published in the literature, following a heartbeat selection scheme without bias (inter-patient approach), an initial work pointing towards this direction appears in [161]. Furthermore, analyze their impact under a non-biased view is of the paramount importance for the literature of this subject.

@&#CONCLUSIONS@&#
