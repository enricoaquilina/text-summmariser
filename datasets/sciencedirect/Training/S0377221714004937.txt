@&#MAIN-TITLE@&#
A PH/PH

@&#HIGHLIGHTS@&#
PH is chosen to fit the passenger arrival interval distribution in the corridor.PH is chosen to fit the passenger service time distribution in the corridor.A PH/PH(n)/C/C state-dependent queuing model is established.The M/G(n)/C/C, M/G/1, and D/D/1 models are proved to be special cases of PH/PH(n)/C/C.The quantitative relationship between LOS and corridor width is established based on PH/PH(n)/C/C.

@&#KEYPHRASES@&#
Facilities planning and design,Queuing,Metro station corridor,State-dependence,Quasi-birth–death process,

@&#ABSTRACT@&#
Metro station corridor width design considering demand fluctuation as well as the randomness and state-dependence of service time is an urgent concern and a complicated random planning issue. This paper confirms the accuracy of phase-type distribution (PH) fitting for passenger arrival intervals and service times with randomness and state-dependence in metro station corridors. A PH/PH(n)/C/C state-dependent queuing model is thus established by a finite level-dependent quasi-birth–death (QBD) process. The existing M/G(n)/C/C, M/G/1/C, and D/D/1/C models are proved to be special cases of the PH/PH(n)/C/C model through theoretical derivation and the precision of the proposed model is analyzed through simulation tests. The quantitative relationship between the level of service (LOS) and the corridor width is established based on the proposed model. A total of 81 experiments are designed to compare the calculations between the proposed model and the M/G(n)/C/C, M/G/1/C, and D/D/1/C models. Comparison results demonstrate that (1) the value of effective width of the PH/PH(n)/C/C queuing model is higher than those of the M/G(n)/C/C, M/G/1/C, and D/D/1/C models; (2) the real area occupied per person in the corridor of the PH/PH(n)/C/C queuing model is mostly proximate to the designed LOS, whereas those of the M/G(n)/C/C, M/G/1/C, and D/D/1/C models fail to meet the designed LOS; and (3) the performance measures of the PH/PH(n)/C/C queuing model enjoy high performance-width elasticity and are significantly improved compared with those of the M/G(n)/C/C, M/G/1/C, and D/D/1/C models.

@&#INTRODUCTION@&#
The existing code for design of metro (Group, 2013; Beijing Urban Construction Design Research Institute, 2003) determines corridor width based on the given level of service (LOS), which is convenient for practical application. However, the code applies fixed-length distribution in the hypotheses of passenger arrival interval and service time (time for passing through the corridor), which neglect the randomness of passenger arrival interval (demand fluctuation) as well as the randomness and state-dependence of service time. Service time depends on the number of passengers (n), namely, system state, in the corridor; when system state n reaches the corridor capacity, it causes jamming in the corridor, and the service time becomes infinitely long. Thus, the designed corridor width cannot satisfy the required LOS and fluctuating demand. In several metropolises in China (e.g., Beijing and Shanghai), corridor service facilities at urban rail transit stations are always overloaded even during the off-peak period of passenger flow because of the demand fluctuation as well as the randomness and state-dependence of service time. (This situation is confirmed by the abundant experiments designed in Section 5.) Therefore, considering demand fluctuation as well as the randomness and state-dependence of service time to establish the quantitative relationship between LOS and corridor width is an urgent concern.Metro station corridor and passenger flow comprise a type of unique queuing system with diversified arrival interval distributions (not a fixed coefficient of variation), varying service time distributions (where service time depends on system status n and the coefficient of variation is not fixed), and limited capacity (Section 4). Metro station corridor width design is a complicated random planning issue (Yuhaski & Smith, 1989; Mitchell & Smith, 2001; Jiang, Hu, & Zhu, 2013).Existing design codes simplify random queuing as a determined service problem. For example, the “Transit Capacity and Quality of Service Manual” (Group, 2013) and China’s “Code for Design of Metro” (Beijing Urban Construction Design Research Institute, 2003) determine pedestrian corridor width using a fixed passenger arrival interval and a fixed service time, a method similar to the D/D/1/C queuing model. Although the D/D/1/C queuing model is convenient for practical application, it neglects the randomness of passenger arrival interval as well as the randomness and state-dependence of service time. Thus, corridors designed based on the D/D/1/C queuing model fail to meet the required LOS and fluctuating demand.As a result, Jiang, Hu, and Lu (2010) presented a new design method for metro station corridor width by using the M/G/1/C queuing model, which is based on the arrival interval with exponential distribution (M) and the service time with general distribution (G). However, the M/G/1/C queuing model still does not consider the state-dependence of service time and follows an unrealistic arrival interval hypothesis. In an arrival interval with exponential distribution, the coefficient of variation must be 1 (only appropriate for free flow (Jiang et al., 2013)). Hu (2010), Wang (2010), and Jiang et al. (2013) proved that the coefficient of variation is diversified because practical passenger arrival interval is strongly random and may not always be subject to exponential distribution. Lovas (1994) studied the crowd queuing phenomenon for metro stations in emergencies by using the G/M/1 queuing network simulation model, which is based on arrival interval with general distribution (G) and service time with exponential distribution (M). However, the service time does not consider state-dependence and follows an unrealistic hypothesis. The present paper will prove that the variation coefficient of service time is diversified and may not always be subject to exponential distribution (see Section 2.4.2).Numerous studies have considered the state-dependence of a corridor’s average service time. For example, Yuhaski and Smith (1989) and Cheah and Smith (1994) established and developed respectively the random equivalent M/M(n)/C/C and M/G(n)/C/C state-dependent queuing models [M(n) and G(n) represent the correlation between the service time distribution and the system state n] to analyze the circulation system (including the corridor). Subsequently, Smith (1991), Mitchell and Smith (2001) and Weiss, Williams, and Smith (2012) studied emergency network design, topological network design of pedestrian networks and optimization of building evacuation networks (including corridor system) respectively by establishing the M/G(n)/C/C state-dependent network model. Cruz, Smith, and Medeiros (2005) and Khalid, Nawawi, and Kawsar (2013) developed an M/G(n)/C/C state-dependent network simulation model to analyze circulation system network and complex topological network (including the corridor system) respectively. Chen, Liu, and Xiao (2012) carried out a computational analysis on the passenger evacuation capacity of the stairs and corridor systems at metro stations using the M/G(n)/C/C state-dependent model. All these application studies of the M/G(n)/C/C state-dependent model demonstrate the model’s improved description of the queuing phenomenon in corridors and similar systems compared with those of the D/D/1/C and M/G/1/C models. However, the state-dependence of standard deviation of service time is assumed to be the same as that of average service time in these studies, while in fact they are greatly disparate (see Section 2.4). Furthermore, the M/G(n)/C/C state-dependent model’s arrival interval hypothesis still needs to be improved because exponential distribution (M) is appropriate only in the case of free flow. Therefore, this model is unable to bridge the great gap with the practical situation (Section 5).Phase-type distribution (PH) possesses good universality, analyticity, and computability since theoretically, it can approach to any positive random variable (e.g. arrival interval or service time) infinitely and keep the characteristic of exponential distribution’s easy treatment (Hu, Jiang, & Zhu, 2013). Therefore, PH has replaced exponential distribution (M) in random model analysis and processing as an important stochastic analysis tool in various domains, such as queuing system analysis, reliable modeling, as well as analysis and optimization of communication system efficiency (Hu et al., 2013), resulting in the emergence of abundant PH-based queuing models, including PH/PH/1 (Krishnamoorthy, Babu, & Narayanan, 2009), PH/PH/1/C (Alfa & Zhao, 2000) and its network model (Haverkort, 1995), PH/PH/K (Krishnamoorthy, Babu, & Narayanan, 2008) parallel queuing model, and PH/PH/K/C (Miyazawa, Sakuma, & Yamaguchi, 2007) parallel queuing model. Meanwhile, in order to deal with a wider range of PH-based queuing models, quasi-birth–death (QBD) processes have been developed (Masuyama, 2011; Liu, Yang, & Wu, 2012; Baumann & Sandmann, 2012; Pérez & Van, 2011; Latouche & Ramaswami, 1999; Gaver, Jacobs, & Guy, 1982; Bright & Taylor, 1995; Baumann & Sandmann, 2010; Baumann & Sandmann, 2013), such as infinite level-independent QBD processes, infinite level-dependent QBD processes, finite level-independent QBD processes and finite level-dependent QBD processes. Besides, in order to solve these queuing models based on QBD processes, numerical methods are developed (Masuyama, 2011; Liu et al., 2012; Baumann & Sandmann, 2012; Pérez & Van, 2011; Latouche & Ramaswami, 1999; Gaver et al., 1982; Bright & Taylor, 1995; Baumann & Sandmann, 2010; Baumann & Sandmann, 2013), including Matrix Geometric method, Spectrum Expansion method, LU-Decomposition method, Gaussian Elimination method, Matrix Analytic method and Matrix Continued Fractions method. In short, with the development of the QBD processes and numerical methods, PH-based queuing models can be established and solved to describe the actual queuing phenomena accurately and to optimize the system parameters.However, PH-based queuing models still have not been applied in metro station planning and design. In the Youth Project of the Chinese National Natural Science Foundation (Serial No. 51108391), Jiang et al. (2013) were the only researchers who presented an urban rail transit station planning and design based on PH queuing models to achieve better time–space matching between forward passenger flow and service facilities.Hence, in this paper, a PH/PH (n)/C/C state-dependent queuing model based on the randomness of passenger arrival interval as well as the randomness and state-dependence of service time is established and solved by a finite level-dependent QBD process and a Matrix Analytic Scheme algorithm respectively to describe the metro station corridor queuing phenomenon accurately. Besides, the quantitative relationship between corridor width and LOS is established based on the PH/PH (n)/C/C queuing model to facilitate the rational planning and design of the metro station corridor (Notably, not for the corridor renovation during the operation stage). We focus on the single horizontal straight corridor queuing model, which can be expanded to include complex corridor, stair, platform, and station hall systems.The remainder of the paper is organized as follows: Section 2 presents the preparation of the PH/PH (n)/C/C state-dependent queuing model, including a description of the queuing system, an introduction to PH as well as PH fitting for passenger arrival interval distribution and state-dependent service time distribution. Section 3 establishes the PH/PH (n)/C/C state-dependent queuing model and shows the generality and precision analysis of this model through theoretical derivation as well as simulation test respectively. Section 4 establishes the quantitative relationship between corridor width and LOS based on this queuing model. Section 5 presents the experimental design and analysis. This Section focus on the calculation of metro station corridor width using the PH/PH (n)/C/C state-dependent queuing model and other existing major models at a given LOS. Besides that, the calculated corridor width undergoes the simulation test again to obtain the performance measures for comparative analysis. Finally, Section 6 concludes the paper and discusses some future work.In a unidirectional horizontal straight corridor (Fig. 1(a)) with a length of L (given in meters), passengers arrive at the corridor at a certain time interval A (a random variable given in seconds). With the increase in the number of passengers n (system state) in the corridor, the mean and standard deviation (reflecting fluctuation of velocity) of pedestrian velocity Vn(a random variable given by m/s) decrease because the increased number of passengers in the limited corridor space (the upper limit of passengers is corridor capacity C) crowds the corridor and restricts the sideward movement of quicker passengers attempting to surpass the slower passengers, reducing the freedom of passengers walking in the corridor. This crowding results in a low uniform pedestrian velocity and changes the mean and standard deviation of time B(n)=L/Vnof passengers passing through the corridor. B(n) is state-dependent [quantitative analysis on B(n) is provided in Section 2.3], and when n reaches C, forward movement for passengers in the corridor is virtually impossible.Therefore, if each available position in the corridor is regarded as a service desk, then passenger flow in the corridor can be described as a state-dependent queuing system with passenger arrival interval A, C service desks, total service time B(n) (n=1, 2,…, C), and capacity C. This state-dependent queuing system is thus expressed as an A/B(n)/C/C queuing system according to Kendall’s symbolic expression.Similarly, in a bidirectional horizontal corridor (Fig. 1(b)) with a length of L (given in meters), passengers arrive at the corridor at certain time intervals A1 and A2 from two opposite directions. With the increase in n, the mean and standard deviation of pedestrian velocity V′n(which is different from the random variable in the unidirectional corridor) decrease, changing the mean and standard deviation of B′(n)=L/V′nas a result. When n reaches C, forward movement for passengers in the corridor is virtually impossible. By integrating these two passenger flows (A1 and A2) into one passenger flow with interval A′, the bidirectional horizontal corridor system can then be converted into a unidirectional horizontal corridor system that can be described by the A′/B′(n)/C/C queuing system.Similarly, in a multidirectional horizontal corridor (Fig. 1(c)), passengers arrive at the corridor from several directions at certain intervals (A1, A2,…, AI). The arrival rates of these passenger flows are λ1, λ2, …, λI, and their travel distances to the exit are L1, L2, …, LI. With the increase in n, the mean and standard deviation of pedestrian velocity V″n(a random variable different from those of the unidirectional and bidirectional corridors) decrease, changing the average and standard deviation of B″(n)=L′/V″n(L′=∑i=1IλiLi∑i=1Iλirepresents the average travel distance of passenger flows) as a result. When n reaches C, forward movement for passengers in the corridor is virtually impossible. Integrating these multidirectional passenger flows (A1, A2,…, AI) into one passenger flow with interval A″ can convert the multidirectional horizontal corridor system into a unidirectional one that can be described by the A″/B″(n)/C/C queuing system.For the queuing systems above, we have to apply appropriate distributions to describe the passenger arrival interval (A, A′, or A″) and service time [B(n), B′(n), or B″(n)] to make them analytical and universal. As mentioned previously, PH possesses good universality, analyticity, and computability. Therefore, we choose PH to fit the passenger arrival interval distribution and service time distribution in the corridor, and then establish the corresponding PH/PH (n)/C/C queuing model for the corridor system. In Section 2.2, the basic concept of PH will be introduced.Only continuous PH is involved in this study because both passenger arrival interval and service time are continuous random variables. When a non-negative random variable X is subject to continuous PH, the distribution function F(x) of X can be expressed as(1)F(x)=1-α̲·exp(T·x)·e̲,x⩾0,whereα=(α1,α2,…,αm) satisfies∑i=1mαi⩽1and αi⩾0; m is the order of PH;e̲=(1,1,…,1)m×1′is the column vector; exp(T·x) refers to the matrix exponential; and T is the m-order matrix, that is, T=(Tij)m×m, which satisfies Te⩽0, Tii<0, and Tij⩾0, i≠j. (α, T) is the m-order representation of PH.Mean value EX, variance VX, and square coefficient of variation (SCV) c2 of PH are(2)EX=-α̲·T-1·e̲(3)VX=EX2-(EX)2=2α̲·T-2·e̲-(EX)2(4)c2=VX/(EX)2=2α̲·T-2·e̲/(EX)2-1.Although general PH is theoretically an unlimited approach to any non-negative random variable (e.g., arrival interval or service time of the queuing system), it is necessary to determine as many as m2+m parameters (generally, m⩾2). However, only the mean value (EX) and coefficient of variation (c2) of the arrival interval and service time can be obtained indirectly and the other information (including third-order moment, fourth-order moment and the complete data of the arrival interval and service time) is impossible to be provided for the corridor planning and design (See Sections 2.3 and 2.4), and therefore not all parameters can be determined directly. Thus, general PH is inconvenient for practical application.Sadre (2007) and Weerstra (1994) achieved good fitting for general non-negative random variables by using the following simplified PH, which is determined by EX and c2, and were able to increase the possibility of applying the PH queuing model in corridor planning and design.1.When c2⩽1, m=⌈1/c2⌉,α=(1,0,…,0), matrix T can be expressed as(5)T=-t1t1-t2t2⋱⋱-tm-1tm-1-tm,where ti=m/EX, 1⩽i⩽m−2;tm=2m[1+12m(mc2-1)]/[EX(m+2-m2c2)]; tm−1=mtm/(2tmEX-m). For the data of c2⩽1/30, m is set as 30 to simplify the queuing analysis.When c2>1, m=2,α=(p,1−p),p=121+(c2-1)/(c2+1), the matrix T can be expressed asWhen simplified PH is used to describe arrival interval and service time, the descriptions are expressed as PH<λ,ca2> or PH<u,cs2>(λ=u=1/EX represents the arrival rate or service rate). Simplified PH has following properties:Property 1Given I passenger flows with their time intervals subject to the PH<λi,ca,i2>, i=1, 2, …, I. When these passenger flows are integrated into one passenger flow, its time interval is subject to the PH<λ,ca2>(λ=∑i=1Iλiandca2=∑i=1Iλiλca,i2)as deduced bySadre and Haverkort (2011).If the non-negative random variable X is subject to the PH<u,cs2>(i.e., X∼PH<u,cs2>) and the PH of its l order is represented by (β, S), then Y=X/n(n is a positive integer) is subject to the PH<nu,cs2>and the PH of its l order is represented by (β, n·S) as deduced.Set the distribution function of Y=X/n as G(t), then(7)G(t)=P(Y⩽t)=P(X/n⩽t)=P(X⩽n·t)=F(n·t)=1-β̲exp(n·S·t)e̲,t⩾0.Given that S′=n·S=(n·Sij)l×l, then G(t)=1−β·exp(S′·t)·e. Y=X/n is still subject to PH and its l order PH is represented by (β, S′) because the elements of S′ satisfy n·S′· e⩽0, n·Sii<0 and n·Sij⩾0, i≠j. As a result, the mean value EY=−β·S−1·e/n=EX/n=1/(nu) and square coefficient of variationcY2=β̲·nS-2·e̲/(EY)2-1=β̲·S-2·e̲/(EX)2-1=cs2can be calculated. Therefore, Y=X/n is subject to the PH<nu,cs2>and the PH of its l order is represented by (β, n·S).Note: one might have another fitting method based on general PH, that is: (1) Select the most suitable distribution from various distributions with two parameters (e.g. Lognormal, Normal and Gamma distributions), which are all determined by EX and c2, for fitting the actual arrival interval and service time distributions of passengers in metro station; (2) Trace the best fitting distribution by a standard general PH fitting algorithm [e.g. Expectation Maximization (EM)] and obtain all the parameters of general PH; and (3) Test the general PH fitting results for the actual arrival interval and service time distributions. Although the method is feasible (all the parameters of general PH are determined by EX and c2 indirectly), it is more complicated than the direct use of simplified PH. Besides, the general PH obtained by the above method may not be able to achieve better fitting results than the simplified PH because the fitting accuracy of the former depends on that of the best fitting distribution as well as that of the standard general PH fitting algorithm (e.g. EM). Moreover, the general PH is not able to meet Property 1, and therefore it is difficult to establish PH queuing model for the corridor with bidirectional or multidirectional passenger flows. Hence, we select simplified PH for fitting the actual arrival interval and service time distributions in this paper. □As stated in Section 2.1, it is necessary to apply PH to describe the passenger arrival interval (A, A′, or A″). For easy understanding, the unidirectional passenger arrival interval (A) is considered first before the bidirectional and multidirectional arrival intervals (A′ and A″).Supposing the passenger arrival rate λ (peds/s) and arrival interval SCVca2have been obtained indirectly in corridor planning and design, they can thus be substituted directly into Eq. (5) or (6) to obtain the m-order representation (α, T) of PH<λ,ca2>that describes the random variable of arrival interval A, which is denoted as(8)A∼PH〈λ,ca2〉orPH(α̲,T).To verify the precision of simplified PH in describing passenger arrival interval, nine sets of passenger arrival interval data (each sample size is 200) obtained from the Chengdu metro station entrance and exit (Jiang et al., 2013) are tested. The fitting effect is shown in Fig. 2(a). The Kolmogorov–Smirnov statistic (D) ranges from 0.0389 to 0.0770 which is less than the critical value (1.36/√200) at a significance level of 0.05. Therefore, the simplified PH is able to describe the metro station passenger arrival interval accurately. [Note: Although the complete data is obtained by the metro station videos during its operation, yet we only use the simplified PH distribution, which is determined by λ andca2, for fitting the complete data. This is due to the reason that other information cannot be obtained during the station planning and design stage (see Reference (Jiang et al., 2013)). Even though we obtain better fitting results using the general PH distribution determined by additional information (e.g., third-order moment, fourth-order moment or the complete data of the arrival interval), but it cannot be applied during the corridor planning and design.]To facilitate practical application during corridor planning and design stage, λ andca2are determined by the only two forecast data [peak-hour volume q (peds) and peak-hour factor (ε)] as mentioned in existing codes (Group, 2013; Beijing Urban Construction Design Research Institute, 2003). The peak-hour factor (ε) is defined as(9)ε=q/(4q15),where q15 represents the maximum flow volume in one quarter peak-hour (15min), and ε ranges from 0.25 to 1.00.The corresponding mean arrival interval (EA) and arrival rate (λ) are easily obtained by peak-15min flow rate during the planning and design (Group, 2013):(10)EA=3600ε/q,(11)λ=q/(3600·ε).ca2can be determined according to local conditions or estimated through the following equation:(12)ca2=e6.819ε·(ε-1)2/(4ε-1)For Eq. (12), the SCV of the passenger arrival interval during the peak-15min flow can be estimated from the SCV of passenger arrival interval in the peak hour because the former is sampled from the latter. According to Eq. (9), a peak hour is divided into four periods (15min for each period). Average arrival interval of the peak-period with maximum flow volume q15=q/(4ε) is 900/q15=3600ε/q, and the passenger volume in this peak-period accounts for q15/q=1/(4ε) of the entire peak-hour volume. The passenger volume of the three remaining off-peak periods is q−q15=q−q/(4ε), accounting for 1−q15/q=(4ε−1)/(4ε) of the entire peak-hour volume, and the average passenger arrival interval is 2700/(q−q15)=10800ε/[(4ε−1)·q]. If the three off-peak periods have the same passenger volume, thenca2can be approximated by the following equation:14ε3600εq2+4ε-14ε10800ε(4ε-1)·q2-3600q23600q2=(ε-1)24ε-1.This study obtains a correction factor (e6.819ε) from the regression analysis based on nine sets of survey data because the three off-peak periods generally have different passenger volumes in practice. The coefficient of determination (R2) of the regression curve reaches 0.975, indicating a good fitting effect.According to Eq. (12), the SCV is related to the peak-hour factor (ε) but is uncorrelated with peak-hour volume (q).λ andca2are solely determined by q and ε based on Eqs. (11) and (12) respectively. Therefore, the m-order representation (α, T) of PH<λ,ca2>describing the random variable of arrival interval A can be obtained by directly substituting Eqs. (11) and (12) into Eq. (5) or (6).Example 1When q=3600 and ε=0.8, λ=1.25 andca2=4.25can be calculated using Eqs. (11) and (12). Given thatca2>1, substituting it into Eq. (6) results in the PH being expressed asα̲=(0.8934,0.1066),T=-2.2335-0.2665.For bidirectional passenger flows, passenger arrival rates λ1 and λ2 (peds/s) and arrival interval SCVs(ca12andca22)can be obtained indirectly by Eqs. (11) and (12) during the planning and design stage of the metro station corridor. PH<λ1,ca12>and PH<λ2,ca22>of arrival intervals A1and A2, can then be determined according to Eq. (5) or (6). Finally,PH<λ,ca2>λ=λ1+λ2andca2=λ1ca,12+λ2ca,12λof arrival interval A′ (the integrated passenger flow) is obtained according to Property 1.For multidirectional passenger flows, passenger arrival rates λ1, λ2,…, λI(peds/s) and arrival interval SCVsca12,ca22,…,caI2can be obtained indirectly by Eqs. (11) and (12), and then PH<λi,cai2>(i=1, 2, …, I) of arrival intervals A1, A2, …, AIcan be determined according to Eq. (5) or (6). Finally, PH<λ,ca2>(λ=∑i=1Iλiandca2=∑i=1Iλiλca,i2) of arrival interval A” (integrated passenger flow) is obtained according to Property 1.State-dependent pedestrian velocity should be analyzed before the PH fitting for state-dependent service time because service time (time for passengers to pass through the corridor) is determined by corridor length and pedestrian velocity.According to Section 2.1, the increased number of passengers in the corridor lowers the mean and standard deviation of pedestrian velocity. A study on the L×W (given by m2; generally, W is the effective width that excludes the unserviceable width of the buffering zone) horizontal corridors and their passenger flows (including unidirectional, bidirectional, and multidirectional passenger flows) can provide better quantitative understanding of the state-dependent velocity. The number of passengers in the corridor is clearly limited at any given moment (corridor capacity C), and n passengers (system state) walk in the corridor at a random velocity Vn(n=1, 2,…, C) (m/s). The mean and standard deviation of Vnare vnand δn(n=1, 2, …, C) respectively. Through a statistical analysis of mass data, Zhao (2011) reported that the logarithmic normal distribution (Log−N) can achieve better fitting effect for pedestrian velocity compared with the normal distribution. Therefore, we suppose that(13)Vn∼Log-Nvn′,δn′,n=1,2,⋯,C,wherevn′andδn′are two parameters of Log−N determined by vnand δnrespectively. The calculations ofvn′andδn′arevn′=ln(vn)−0.5·ln[1+(δn/vn)2] andδn′=[ln(1+(δn/vn)2)]0.5 respectively.Therefore, the state-dependence of Vnis completely determined by the state-dependencies of vnand δn. The state-dependent models of vnand δnare stated as follows:(1)State-dependent model of vnYuhaski and Smith (1989) presented an exponential model of vnwith a high fitting precision based on the six relation curves of velocity–density in the corridor designed by Fruin (1971) and Tregenza (1976).(14)vn=v1·exp-n-1ωγ,n=1,2,…,C,whereγ=lnln(va/v1)ln(vb/v1)/lna-1b-1; ω=(a−1)/[ ln(v1/va)]1/γ=(b−1)/[ln(v1/vb)]1/γ; v1 is the mean pedestrian velocity (generally 1.5m/s) when only one passenger is in the corridor; and C=[k· L·W] (k is the maximum pedestrian density whose value is generally 5peds/m2), which means that the corridor capacity is the maximum integral that is less than k times the corridor area (m2). Thus, pedestrian velocity will decrease to 0 when k reaches 5peds/m2; va(a=2·L·W) is the mean velocity when k is 2peds/m2 (0.64, 0.60, and 0.56m/s, respectively, for unidirectional, bidirectional, and multidirectional passenger flows as provided by Cheah & Smith (1994) and Cruz et al. (2005), Cruz, Smith, & Queiroz (2005)); and vb(b=4·L·W) is the mean velocity when k is 4peds/m2 (0.25, 0.21, and 0.17m/s, respectively, for unidirectional, bidirectional, and multidirectional passenger flows as provided by Cheah & Smith (1994) and Cruz et al. (2005)).Note that (1) this paper only discusses the exponential model because the linear model of vnproposed by Yuhaski and Smith (1989) is less accurate; (2) weighted nonlinear regression or piecewise linear approximation have a fitting effect similar to the exponential model (Cheah & Smith, 1994; Cruz et al., 2005); (3) although vnis also influenced by the ratio of bi- or multi-directional flows and other factors (i.e. shape, color and lighting of the corridor, pattern of floor material, clothing, luggage, and age of the pedestrians, environmental context, and so on) (Cheah & Smith, 1994; Cruz et al., 2005; Cruz et al., 2005) and warrants in-depth study (Blue & Adler, 2001; Lam, Lee, & Chan, 2003; Hoogendoorn & Daamen, 2005; Blue & Adler, 2000; Xie, Wong, & Lam, 2013; Ko, Kim, & Sohn, 2013), it is not the scope of this paper (in this paper, the analysis is carried out solely for unidirectional passenger flows through corridors); and (4) Yuhaski and Smith (1989) and Cruz et al. (2005) demonstrated that v1, k, va, and vbcan be adjusted according to the requirements of the practical situation, which will not influence the applicability of the exponential model.State-dependent model of δnScholars are currently focused on the state-dependent model of vn, and no research on the state-dependent model of δnhas been reported yet, resulting in relative data shortage. Thus, in this section, the state-dependent model of δnis obtained through a simulation according to the state-dependent model of vn(Eq. (14)) and the pedestrian characteristics in the U.S. Code (Group, 2013). The model of δncan also be obtained according to available local practical data.AnyLogic software is applied to simulate a 10×3m2 horizontal corridor (According to the U.S. TCRP REPORT 100 (Group, 2013), the buffer distance on each side is 0.5m. Therefore, the practical corridor width is 4m). To ensure the accuracy and usability of data, every system state n is run 30 times using the simulation to obtain the mean standard deviations of pedestrian velocity in unidirectional, bidirectional, and multidirectional corridors as well as the 95% confidence interval (Fig. 3).In the present study, multidirectional passenger flows are produced from four directions (Fig. 1(c)). A bidirectional corridor is produced when entrances 3 and 4 are closed; and a unidirectional corridor is produced when entrances 2, 3, and 4 are closed. The simulation experiment is designed as follows:(1) To obtain the state-dependent model of δn(n=1, 2,…, 150), the system state is kept stable at n for every simulation to acquire the corresponding δn. Therefore, we randomly group the n passengers entering the corridor at the beginning of the simulation (e.g., k and n−k passengers are allocated at each entrance of the bidirectional corridor; k1, k2, k3 and n−k1−k2−k3 passengers are allocated at every entrance of the multidirectional corridor) and new passengers are allowed to enter into the corridor once old passengers leave the corridor to keep the system stable at n. To obtain the steady-state value of δn, 11,000 intelligent pedestrians are tested in the simulation. The first 1000 pedestrians are used to maintain system stability and are excluded from the statistical analysis. Thus, δnunder different system states is obtained.(2) The major parameters that need to be standardized include pedestrian size, initial location, initial velocity, and free velocity (V1). Pedestrian size is determined as the uniform distribution from 0.21m2 (female size) to 0.23m2 (male size) according to the U.S. standard. Initial location is the uniform distribution from 0 to W. Initial velocity applies the exponential formula (Eq. (14)). Note: Several simulation tests revealed that the variation of some parameters within a reasonable range or the selection of other distributions will not influence δnunder a stable system state. For example, the stable standard deviation obtained from pedestrian size distribution of Triangular (0.21, 0.24, 0.22) and initial location of Triangular (0, W, W/2) is slightly different (0.001–0.003) from the previous result. This finding indicates the flexibility in parameter standardization. However, the distribution and parameter selection of V1 have a strong influence on δn. The following text will introduce its determination specifically.Eqs. (13) and (14) demonstrate that V1∼Log−N[ln(1.5)−0.5·ln(1+(δ1/1.5)2), (ln(1+(δ1/1.5)2))0.5]. Therefore, only the parameter δ1 (standard deviation of pedestrian velocity when only one passenger is in the corridor) needs to be determined. We obtain δ1=0.33m/s by taking [0.75,2.42] as the 99% confidence interval of Log−N that V1 is subject to because the “Transit Capacity and Quality of Service Manual” of the United States only provided the range of V1 (0.75m/s to 2.42m/s) without its standard deviation. The remaining 1% is for V1 beyond the given range (e.g., low-speed children, the disabled, the aged and high-speed merchants). Therefore, the distribution of V1 is Log−N (0.38,0.22).To ensure the accuracy and usability of data, every system state (n) is run 30 times (through JAVA programming) using the simulation to obtain mean standard deviations of pedestrian velocity in the unidirectional, bidirectional, and multidirectional corridors as well as the 95% confidence interval (Fig. 3).Fig. 3 shows the exponential variation trend of the standard deviation curve of the pedestrian velocity. Therefore, the following exponential model similar to Eq. (14) is used to approximate the mean standard deviation curve of the pedestrian velocity:(15)δn=δ1·exp-n-1ω′γ′,n=1,2,…,C,whereγ′=lnln(δa/δ1)ln(δb/δ1)/lna-1b-1;ω′=(a-1)/ln(δ1/δa)1/γ′=(b-1)/ln(δ1/δb)1/γ′; δ1 is the standard deviation of the pedestrian velocity when the corridor has only one passenger (recommended value=0.33m/s); δais the standard deviation of the pedestrian velocity when k is 2 peds/m2 (0.17,0.14, and 0.11m/s for unidirectional, bidirectional, and multidirectional passenger flows, respectively); and δbis the standard deviation of the pedestrian velocity when k is 4peds/m2 (0.07, 0.04, and 0.01m/s for unidirectional, bidirectional, and multidirectional passenger flows, respectively). The rest of the signs represent the same variables in Eq. (9).The fitting effect of this model (Eq. (15)) is shown in Fig. 3. R2 of the three fitting curves reach 0.9835, 0.9859, and 0.9863, which indicate that the state-dependent standard deviation of the pedestrian velocity is accurately described by Eq. (15).Note that (1) under the setting of simulation parameters, the curve of vnobtained from the simulation experiment is fitted well by that of Eq. (14) (R2 ranges from 0.9871 to 0.9994); (2) weighted nonlinear regression or piecewise linear approximation have a fitting effect similar to the exponential model; (3) δ1, k, δa, and δbcan be adjusted according to the requirements of the practical situation, which will not influence the applicability of the exponential model; and (4) δnis also influenced by the ratio of bi- or multi-directional flows and other tangible and intangible factors (e.g. shape, color and lighting of the corridor, pattern of floor material, clothing, luggage, and age of the pedestrians, environmental context, and so on), but it is not the scope of this paper (In this paper, the analysis is carried out solely for unidirectional passenger flows through corridors).In sum, the state-dependence of Vncan be determined by Eqs. (13)–(15).For clear understanding, the unidirectional passenger flow is first examined.(1) Service time of unidirectional passenger flow.A L×W unidirectional metro station corridor (Fig. 1(a)) is examined. The random variable of the service time is represented by B(n)=L/Vn. Vnis subject to the Log−N(v′n,δ′n) determined by Eqs. (13)–(15). Thus,(16)B(n)∼Log-N-vn′+ln(L),δn′,n=1,2,…,C,wherevn′andδn′are calculated according to Eqs. (13)–(15):δn′=ln1+δ1v12exp2n-1ωγ-2n-1ω′γ′,n=1,2,…,C,vn′=ln(v1)-n-1ωγ-0.5δn′2,n=1,2,…,C.The value of the parameters should correspond to the unidirectional passenger flow in Eqs. (13)–(15).Although the Log−N of Eq. (16) describes state-dependent service time, it still requires further processing into corresponding PH because it lacks Markov characteristics and possesses bad analyticity in modeling queueing systems (Jiang et al., 2013). Section 2.2 indicates that the simplified PH determines all the parameters according to service rate and SCV. The SCVcs,n2and the service rate μnare calculated according to Eq. (16):(17)cs,n2=δ1v1·expn-1ωγ-n-1ω′γ′2,n=1,2,…,C,(18)μn=v1·exp-n-1ωγL·1+cs,n2,n=1,2,…,C.Therefore, Eqs. (17) and (18) are directly substituted into Eq. (5) and (6) to obtain the ln-order representation (βn, Sn) of the simplified PH<μn,cs,n2>of B (n), i.e.,(19)B(n)∼PH<μn,cs,n2>orPH(β̲n,Sn)MATLAB software is used for the programming calculation of every n (n=1, 2,…, C). The calculation steps of every n (n=1, 2,…, C) are less than 30 (as determined by Eq. (5) and (6)); thus, the complexity of the calculation is only O(C).The tracking performance of the simplified PH to Log−N has to be further verified. The fitting effect of the simplified PH to nine groups of Log−Ns with different coefficients of variation (each sample size is 600) is shown in Fig. 2(b). The Kolmogorov–Smirnov statistic (D) ranges between 0.0206 and 0.0441 which is less than the critical value (1.36/√600) at a significance level of 0.05, indicating that the simplified PH can still describe the service time distribution well.(2) Service time of bidirectional and multidirectional passenger flows.According to Section 2.1, the bidirectional passenger flow (Fig. 1(b)) is similar to the unidirectional passenger flow. The simplified PH of the service time B′(n) is the same as that in Eq. (19). However, the value of the parameters should correspond to the bidirectional passenger flow in Eqs. (14) and (15).Similarly, for multidirectional passenger flows (Fig. 1(c)), the multidirectional passenger arrival rates are λi(i=1, 2, …, I), and the travel distance of passenger flows to the exit is L1, L2, …, LI. The simplified PH of the service time B″(n) is the same as that in Eq. (19). However, L in Eq. (16) should be the average travel distance∑i=1IλiLi/∑i=1Iλi, and the values of the other parameters should correspond to the multidirectional passenger flows in Eqs. (14) and (15).Section 2.3.1 indicates that the PH〈λ,ca2〉of the passenger arrival interval A has m-order representation (α, T). According to Section 2.4.2, the PH<un,cs,n2>of the service time B(n) has ln-order representation (βn, Sn). Therefore, in view of the analysis in Section 2.1, the corridor and passenger flow can be described as a PH/PH (n)/C/C parallel-serial queuing model, where PH is the arrival interval distribution PH<λ,ca2>and PH (n) is the service time distribution PH<un,cs,n2>. Therefore, the model can be expressed as a PH<λ,ca2>/PH<un,cs,n2>/C/C parallel-serial queuing model in detail. Miyazawa et al. (2007) provided a solution to the PH/PH/C/C parallel queuing model, but it is inapplicable to this parallel–serial queuing model. As a result, a set of new solutions has to be designed.Let the passengers in the corridor be stable at n and the random variable of the total service time of these n passengers be Xn. Suppose that at least one of these n passengers just entering the corridor is the last one to leave the corridor, then Xnhas the same distribution as the travel time of the pedestrian, that is, Xn∼PH<un,cs,n2>. Given that these n passengers leave the corridor one by one (the leaving interval of passengers leaving the corridor at the same time can be considered 0), the random variable of the average leaving interval per passenger is Xn/n. In other words, everyone has to wait until the previous passenger leaves. Therefore, the corridor and passenger flow is a queuing system with one service desk and service time Xn/n (leaving interval), as shown in Fig. 1. According to Property 2, Xn/n is subject to PH<nun,cs,n2>and has an ln-order representation of (βn, nSn). Therefore, the PH<λ,ca2>/PH<un,cs,n2>/C/C parallel–serial queuing model can be converted approximately into a PH<λ,ca2>/PH<nun,cs,n2>/1/C single-service desk state-dependent queuing model, which enables the derivation of the proposed state-dependent queuing model on the basis of the PH/PH/1/C (Alfa & Zhao, 2000; Haverkort, 1995; Sadre, 2007; Sadre & Haverkort, 2011) model.The system state at t is defined by n, arrival phase j (1⩽j⩽m), and service phase kn(only available when passengers exist and 1⩽kn⩽ln). As a result, the state space U can be expressed asU={(n,j)|n=0,1⩽j⩽m}∪{(n,j,kn)|1⩽n⩽C,1⩽j⩽m,1⩽kn⩽ln}.This state space is divided to obtain the level: 0, 1, …,C.0̲={(0,1),(0,2),…,(0,m)},n̲={(n,1,1),…,(n,1,ln),…,(n,m,1),…,(n,m,ln)},1⩽n⩽C.Therefore, this queuing system can be described by a finite level-dependent QBD process with C+1 levels, where level 0 consists of m states and leveln(1⩽n⩽C) consists of m·lnstates. Levelnrepresents the state of the system when it contains n customers. A step from levelnto leveln+1(n<C) represents an arrival and a step from levelnto leveln−1 (n>0) represents a departure. The m·lnstates of a leveln(n>0) describe the current state of the arrival and the service processes (level 0 contains only m states because the queue is empty and the service process has not yet started; it only records the state of the arrival process). This process leads to the following generator matrix Q of the Markov chain:(20)Q=Q0,0Q0,1Q1,0Q1,1Q1,2Q2,1Q2,2Q2,3Q3,2Q3,3Q3,4⋱⋱⋱QC-1,C-2QC-1,C-1QC-1,CQC,C-1QC,C,(21)Q0,0=T,(22)Qn,n=T⊕(n·Sn),n=1,2,…,C-1,(23)QC,C=(T+T0̲α̲)⊕(C·SC),(24)Q0,1=T0̲α̲⊗β1̲,(25)Qn,n+1=T0̲α̲⊗En,n+1,n=1,2,…,C-1,(26)Q1,0=Em⊗S10̲,(27)Qn,n-1=Em⊗n·Sn0̲βn-1̲,n=2,3,…,C,where T0=−T· e; Em=diag(1, 1, …, 1)m×m; En,n+1=diag (1, 1, …, 1)ln×ln+1, 1⩽n⩽C−1;Sn0̲=-Sn·e̲, 1⩽n⩽C; and T⊗S and T⊕S are the Kronecker product and Kronecker sum of matrices T and S respectively. The block matrix of Q represents the transition rate matrix among different levels. The non-zero (tri-)diagonal blocks of Q are different from that of PH/PH/1/C (Alfa & Zhao, 2000) because of the dependence on the system state n.The steady-state probability vectorπof the Markov chain with generator Q can be obtained by solving the following global balance equation:(28)π̲·Q=0̲andπ̲·e̲=1,whereπ=(π0,π1, …,πC).π0=(π01, π02, …, π0m) represents the steady-state probability vector at level 0, andπn=(πn,1, πn,2, …, πn, mln) (1⩽n⩽C) is the steady-state probability vector at leveln. Thus, the length ofπism+∑n=1Clnm(m, ln⩽30 as stated in Section 2.2), that is, the computer storage ofπis a linear function about C [i.e. O(C)]. In addition, the steady-state probability distribution satisfiesπn+1=πnRn(0⩽n⩽C−1), where Rnis the level-dependent rate matrix with m·lnby m·ln+1 non-negative elements, and Rn=−Qn,n+1/(Qn+1,n+1+Rn+1Qn+2,n+1), Rc=0€Rm·l(C)×m·l(C) as well asπ0(Q0,0+R0Q1,0)=0 (Baumann & Sandmann, 2013).Eq. (28) cannot be solved through the Matrix Geometric method (Neuts, 1984) and Spectrum Expansion (Chakka, 1998) because of the different diagonal matrix (Qn,n=T⊕nSn, 1⩽n⩽C−1) of Q. However, the global balance equation as a limited linear equation set can be directly solved by LU-Decomposition, Gaussian Elimination, Gauss–Seidel, Matrix Continued Fractions or Matrix Analytic (Pérez & Van, 2011; Latouche & Ramaswami, 1999; Gaver et al., 1982; Bright & Taylor, 1995; Baumann & Sandmann, 2010; Sadre, 2007).Meanwhile, the performance measures (i.e. average number of passengers in the corridor EN, area occupied per person ES, blocking probability PC, passenger output rate θ(Bocharov, 1987), and average dwell time of passengers in the corridor ET) are able to be calculated according to the following formulas:(29)EN=∑n=1Cn·π̲n·e̲,(30)ES=∑n=1CL·Wnπ̲n·e̲(1-π̲0·e̲),(31)PC=π̲C·e̲,(32)θ=λ-π̲C·(T0⊗ElC)·e̲,(33)ET=∑n=1Cπ̲n·e̲·μn-1(1-π̲0·e̲),where ElC=diag(1, 1, …, 1)lC×lC.In order to obtain these performance measures, one might have an idea, that is: (1) Solve Eq. (28) by numerical methods (e.g. LU-Decomposition, Gaussian elimination, Gauss–Seidel, Matrix Continued Fractions or Matrix Analytic) and obtain the steady-state probability vectorπ(Pérez & Van, 2011; Latouche & Ramaswami, 1999; Gaver et al., 1982; Bright & Taylor, 1995; Baumann & Sandmann, 2010; Sadre, 2007); and then (2) Calculate the performance measures by substitutingπinto the Eqs. (29)–(33). However, this method requires huge computer storage [i.e. O(C2) or O(C)] due to the explicit calculation ofπ(Sadre, 2007; Baumann & Sandmann, 2013). To avoid huge storage demand, Baumann and Sandmann (2013) applied an efficient Matrix Analytic Scheme algorithm without explicitly computingπ, in which storage demand does not depend on the corridor capacity C, to calculate stationary expectations (e.g. EN, ES and ET). Besides that, the computational complexity of the algorithm is a linear function about C. Hence, we select the Matrix Analytic Scheme algorithm to obtain the above performance measures (see Fig. 4for the details). The algorithm is based on: (1) According toπn+1=πnRn(0⩽n⩽C−1), the expectationEπ̲(f̲)=∑n=0Cπ̲nf̲n=π̲0∑n=0C∏k=0n-1Rkf̲n, wherefnis a vector function about the system state n [e.g. (fn=n· e, 0⩽n⩽C) for EN in Eq. (29), (f0=0·e,fn=(L·W/n)·e, 1⩽n⩽C) for (1−π0· e)· ES in Eq. (30), (fn=0· e, 0⩽n⩽C−1,fC=e) for PCin Eq. (31), (fn=0·e, 0⩽n⩽C−1,fC=(T0⊗ElC)·e) for (λ−θ) in Eq. (32), and (f0=0· e,fn=(1/un)·e, 1⩽n⩽C) for (1−π0·e)· ET in Eq. (33)]; and (2) Compute the expectation factor∑n=0C∏k=0n-1Rkf̲nwithout storage of Rn(0⩽n⩽C-1) using the Horner Rule [i.e.∑n=0C∏k=0n-1Rkf̲n=(f̲0+R0(f̲1+R1(f̲2+R2(...+RC-2(f̲C-1+RC-1f̲C)))))].The following is a theorem suggesting that the proposed PH/PH (n)/C/C model is extended from the M/M (n)/C/C and M/G (n)/C/C state-dependent queuing models of Yuhaski and Smith (1989), the M/G/1/C queuing model used by Jiang et al. (2010), and the D/D/1/C queuing model used by the National Code (Group, 2013; Beijing Urban Construction Design Research Institute, 2003).Theorem 1(1) Whenca2=1 andcs,n2=1 (1⩽n⩽C), the proposed PH/PH (n)/C/C model is equivalent to the M/M (n)/C/C state-dependent queuing model. The proposed model is randomly equivalent to the M/G (n)/C/C state-dependent queuing model. (2) Whenca2=1, nun=u andcs,n2=cs2(1⩽n⩽C), the proposed model is approximate to the M/G/1/C queuing model. (3) Whenca2=0, nun=u, andcs,n2=0 (1⩽n⩽C), the proposed model is approximate to the D/D/1/C queuing model.(1) Whenca2=1, the arrival interval distribution is PH (α, T) (α=1 and T=−λ) according to Eq. (5), indicating that the arrival interval is subject to the exponential distribution M. Similarly, based oncs,n2=1 (1⩽n⩽C) and Eq. (5), the service time distribution is PH (βn, Sn) [βn=1 and Sn=−nun(1⩽n⩽C)], indicating that the service time is subject to the state-dependent exponential distribution M(n). Substitutingα, T,βn, and Sninto the matrix Q in Section 3.2.1 yieldsQ=-λλμ1-λ-μ1λ2μ2-λ-2μ2λ3μ3-λ-3μ3λ⋱⋱⋱C-1μC-1-λ-C-1μC-1λCμC-CμC.The recurrence method is used to solveπ· Q=0 andπ· e=1, yieldingπ0̲={1+∑n=1C[λn/(n!∏i=1n{μi)]}-1}andπn̲=π0̲λn/(n!∏i=1nμi)(1⩽n⩽C). This result is the same as that of the M/M (n)/C/C queuing model, which is randomly equivalent to the M/G(n)/C/C queuing model (Yuhaski & Smith, 1989). Therefore, both the M/M (n)/C/C and M/G (n)/C/C queuing models are special cases of the PH/PH (n)/C/C queuing model.(2) Whenca2=1, the arrival interval distribution is PH (α, T) (α=1 and T=−λ) according to Eq. (5), indicating that the arrival interval is subject to the exponential distribution M. Similarly, based on nun=u andcs,n2=cs2(1⩽n⩽C) as well as in Eq. (5) or (6), the service time distribution is PH (β, S) with a same order l. Substitutingα, T,β, and S into the matrix Q yieldsQ=-λλβ̲S0̲-λ⊕SλElS0̲-λ⊕SλEl⋱⋱⋱S0̲-λ⊕SλElS0̲S,where S0=−S·e, El=diag(1, 1, …, 1)l×l, and the other symbols represent the same variables as Section 3.1.2. In fact, the PH/PH (n)/C/C queuing model is converted into the M/PH/1/C queuing model (Yu, Tang, & Fu, 2013). Since M/PH/1/C queuing model is approximate to M/G/1/C queuing model (Yu et al., 2013), the M/G/1/C model is also a special case of the PH/PH (n)/C/C queuing model.(3) Whenca2=0 (the corresponding passenger arrival interval is subject to fixed-length distribution D), the arrival interval distribution is approximated by the 30-order PH (α, T) according to Eq. (5). Similarly, based on nun=u andcs,n2=0 (1⩽n⩽C; the corresponding service time distribution is a fixed-length distribution D) and in Eq. (5), the service time distribution is approximated by 30-order PH (β, S). Substitutingα, T,β, and S into the matrix Q yieldsQ=TT0̲α̲⊗β̲E30⊗S0̲T⊕ST0̲α̲⊗E30E30⊗S0̲β̲T⊕ST0̲α̲⊗E30⋱⋱⋱E30⊗S0̲β̲T⊕ST0̲α̲⊗E30E30⊗S0̲β̲(T+T0̲α̲)⊕S.This equation indicates that the PH/PH (n)/C/C queuing model has been converted into the PH/PH/1/C queuing model (Alfa & Zhao, 2000; Haverkort, 1995). As the fixed-length distribution D can be approximated by 30-order PH distribution (Jiang et al., 2013), the PH/PH/1/C queuing model is approximate to the D/D/1/C queuing model. Therefore, the D/D/1/C queuing model can be considered a special case of the PH/PH (n)/C/C queuing model.In short, Theorem 1 shows that the existing M/M (n)/C/C, M/G (n)/C/C, M/G/1/C and D/D/1/C queuing models are special cases of the proposed PH/PH (n)/C/C queuing model since the M, D and G distributions can be approximated by PH. In fact, the PH/PH (n)/C/C queuing model can also approximate the generalized G/G(n)/C/C queuing system without analytical solutions since the G distribution can be approximated by PH. Hence, the PH/PH (n)/C/C queuing model has generality. □In a L×W single metro station corridor with passenger flows from both sides (Fig. 1(b)), the two passenger arrival intervals are subject to PH<λ1,ca,12>and PH<λ2,ca,22>. Such a queuing system can be converted into a unidirectional passenger flow queuing model in a L×W corridor with an arrival interval distribution PH<λ′,ca′2>, λ′=λ1+λ2,ca′2=(λ1ca,12+λ2ca,22)/λ′. Note that the corresponding service rate function unand SCVcs,n2follow the bidirectional passenger flow state-dependent model (See Section 2.4.2).Similarly, in a L×W single metro station corridor with passenger flows from multiple directions (Fig. 1(c)), the passenger arrival intervals are subject to PH<λi,ca,i2>(i=1, 2, …, I), and their travel distances to the exit are L1, L2, …, LI. Such a queuing system can be converted into a unidirectional passenger flow queuing model in a L′×W corridor with an arrival interval distribution PH<λ″,ca″2>,λ″=∑i=1Iλi,ca″2=∑i=1Iλica,i2/λ″,L′=∑i=1IλiLi/λ″. Note that the corresponding service rate function unand SCVcs,n2follow the multidirectional passenger flow state-dependent model (See Section 2.4.2).To verify the accuracy of using the PH<λ,ca2>/PH<nun,cs,n2>/1/C (i.e. PH/PH (n)/C/C) model to describe the queuing process in the metro station corridor, nine groups of simulation tests based on the practical passenger arrival interval distributions with different coefficients of variation in Section 2.3.1 to a 30×2m2corridor are performed with AnyLogic software (the pedestrian parameters are the same as those in Section 2.4.1). Every group of simulation test is repeated 30 times with random seeds. Each simulation involves 11,000 pedestrians, with the first 1000 used for system stabilization and excluded from statistical analysis. Table 1shows the performance measures of the two methods. The “Simulation” row is the mean result of the 30 simulations. The “95% Confidence Interval (CI)” row also refers to the 30 simulations.According to Table 1, for the nine groups of practical passenger flows with different arrival rates and coefficients of variation (see Section 2.3.1), both simulation and queuing models achieve similar performance measures in the corridor. The maximum absolute errors between the values of the queuing model and the mean values of the simulations in terms of the average queue length EN, the area occupied per person ES, the blocking probability PC, the output rateθ, and the average duration time ET are 4.70, 0.11, 0.02, 0.03, and 6.78, respectively; the corresponding maximum relative errors are 1.58%, 4.76%, 10.00%, 1.54%, and 3.01%. The values of the queuing model are all within the 95% CI of the simulation. Therefore, the PH/PH (n)/C/C model can accurately describe the queuing phenomenon in the metro station corridor.As stated in Section 1, this paper aims to establish the quantitative relationship between LOS and corridor width considering demand fluctuation as well as the randomness and state-dependence of service time. The PH/PH (n)/C/C queuing model established in Section 3 accounts for the randomness of the passenger arrival interval as well as the randomness and state-dependence of service time. Therefore, the current Section quantifies the corridor width based on the PH/PH (n)/C/C queuing model and required LOS.Suppose that the area occupied per person in the corridor under the required LOS is S (m2/ped), an equation can be established between the S and EScalculated from the PH/PH (n)/C/C queuing model [see Eq. (30)]. The corridor width under this LOS can be calculated as follows:(34)W=S(1-π̲0·e̲)∑n=1CL·π̲n·e̲n.Eq. (34) is an implicit function because of the correlation between C and W; thus, the corridor width cannot be directly calculated. Therefore, the equation is converted into the following optimized model:(35)minW-S(1-π̲0·e̲)∑n=1CL·π̲n·e̲n2s.t.W>0.Eq. (35) can be solved by the “fmincon” function and “SQP” algorithm in the optimization toolbox of the MATLAB software.Note that (1) the quantification methods of corridor width based on D/D/1/C (Group, 2013; Beijing Urban Construction Design Research Institute, 2003), M/G/1/C (Jiang et al., 2010), and M/G (n)/C/C (Yuhaski & Smith, 1989; Cheah & Smith, 1994; Chen et al., 2012) models are similar to that based on the PH/PH (n)/C/C model as D/D/1/C, M/G/1/C, and M/G (n)/C/C models are special cases of PH/PH (n)/C/C model (See Section 3.1.3); (2) in the D/D/1/C model, the arrival rate λ=q/(3600·ε), and the service rate u=W·vn∗/S where n∗=L·W/S with a relative density of 0.2S−1; and (3) in the M/G/1/C model, the arrival rate λ=q/(3600·ε), the service rate u=W·vn∗/S and the SCVcs2=cs,n∗2where n∗=L·W/S with a relative density of 0.2S−1.To compare the quantized corridor width of the method based on the PH/PH (n)/C/C queuing model with those of the methods based on D/D/1/C (Group, 2013; Beijing Urban Construction Design Research Institute, 2003), M/G/1/C (Jiang et al., 2010), and M/G (n)/C/C (Yuhaski & Smith, 1989; Cheah & Smith, 1994; Chen et al., 2012) queuing models (These methods are abbreviated as PH/PH (n)/C/C, D/D/1/C, M/G/1/C, and M/G (n)/C/C respectively), we designed 81 groups of comparative experiments. The LOS B, C, and D are selected according to the Transit Capacity and Quality of Service Manual (TCRP Report 100) (Group, 2013) because relevant data in China’s Code for Metro Design (Beijing Urban Construction Design Research Institute, 2003) are inadequate. To compare the effective corridor widths of the different methods under the three LOS, the design area occupied per person S involved in these methods takes the values of 2.3, 1.4, and 0.9m2/ped respectively (Group, 2013).The calculated corridor widths of the different methods are shown in Table 2(a). For comparative analysis, such mass data are divided into three groups according to LOS to draw the width comparison diagram (Fig. 5(a)). Each group has 27 experiment subgroups consecutively numbered from top to bottom of Table 2(a).Fig. 5(a) and Table 2(a) indicate the following:1. A significant order of quantized width obtained from 81 groups of experiments among these queuing models is observed; that is, PH/PH (n)/C/C>M/G (n)/C/C>M/G/1/C>D/D/1/C. The quantized width of PH/PH (n)/C/C is 0.24m to 1.80m greater than that of M/G (n)/C/C, with an average of 0.90m. The quantized width of M/G (n)/C/C is 0.06m to 0.47m greater than that of M/G/1/C, with an average of 0.12m. The quantized width of M/G/1/C is 0.03m to 0.46m greater than that of D/D/1/C, with an average of 0.10m. This result is expected because PH/PH (n)/C/C accounts for the randomness of the arrival interval as well as the randomness and state-dependence of service time compared with M/G (n)/C/C (Section 3.1.3 confirms that the M/G (n)/C/C model is a special case of the PH/PH (n)/C/C model), whereas M/G (n)/C/C considers the additional state-dependence of service time compared with M/G/1/C, and M/G/1/C accounts for the additional randomness of the arrival interval and service time compared with D/D/1/C.2. The corridor widths of PH/PH (n)/C/C when εequals 0.3, 0.6, and 0.9 are on average 1.59, 0.62, and 0.55m greater than that of M/G (n)/C/C; 1.71, 0.74, and 0.65m greater on average than those of M/G/1/C; and 1.84, 0.80, and 0.72m greater than those of D/D/1/C. This result demonstrates that low εincreases the gap between PH/PH (n)/C/C and the other methods because decreasing ε increases the coefficient of variation of passenger arrival interval distribution [as indicated by Eq. (12) and the range of ε]. Furthermore, PH/PH (n)/C/C accounts for such randomness more significantly than the other methods, and thus enables its corridor width to be more sensitive to ε.3. As expected, for the reason that the service rate u and the SCVcs2depend only on the relative density 0.2S−1, there is no relation between the quantized width of the first two methods (i.e. D/D/1/C and M/G/1/C) and L. However, the quantized widths of M/G (n)/C/C and PH/PH (n)/C/C slightly decrease with increasing L; only a small range of 0.02m to 0.06m, and 0.01m to 0.04m is decreased when L=50m compared with that of L=10m. Such a slight difference is not observed in Fig. 5(a). To test whether a great L yields a significantly different width among the two models, 27 groups of experiments of L=300m are conducted (q: 5000, 10,000, and 15,000 peds; ε: 0.3, 0.6, and 0.9; LOS: B, C, and D). However, it is surprising that compared with that in the experiment of L=10m, the quantized width increases by 0.85m to 0.94m and 1.01m to 1.35m on the contrary, much higher than the results of the D/D/1/C and M/G/1/C models. Investigating the reason behind this phenomenon, it was found that an increase in L has two opposing influences on ES(By virtue of increasing the capacity of the corridor, ES increases since the area of the corridor increases; however, this benefit is adversely affected by the fact that increasing the length gives the passengers a longer distance to travel within the corridor). Because of the behavior of these opposing influences, there is a threshold in L; when L is greater than the threshold, the effect of the passengers having to travel a longer distance to leave has a stronger overall effect on the congestion than the integral increase in capacity that will accompany an increase in L.Although the quantized corridor width of PH/PH (n)/C/C is larger than that of the other methods, its rationality requires further verification. We conduct a simulation of the designed corridor by AnyLogic software. Real area occupied per person and other performance measures can be obtained by inputting 27×3×4 groups of experimental parameters in Table 2(a) (including W, L, q and ε of all models) into simulation experiments. Note: In each simulation experiment, arrival interval distribution is determined by Eqs. (8), (11) and (12) because of their accuracy (See Section 2.3.1), random numbers are generated based on a fixed seed value of 23 to make fair comparisons, 11,000 intelligent pedestrians are tested (The first 1000 pedestrians are excluded from the statistical analysis), and the pedestrian parameters are the same as those in Section 2.4.1.Fig. 5(b) and Table 2(b) show that only the PH/PH (n)/C/C obtains an area occupied per person approximate to the designed LOS [the difference between the actual area occupied per person (ES) and the designed LOS is 0∼0.05m2/ped]. Under LOS B, the ES of M/G (n)/C/C, M/G/1/C, and D/D/1/C is 0.61, 0.65, and 0.66m2/ped smaller on average than the designed LOS; 0.30, 0.33, and 0.35m2/ped smaller on average under LOS C; and 0.40, 0.46, and 0.52m2/ped smaller on average under LOS D. For the 3, 11, 12, 20 and 21 groups of experiments (numbered from top to bottom of Table 2(a)), the ES gained from M/G (n)/C/C, M/G/1/C, and D/D/1/C under LOS B is approximate to S of LOS C. For the 2, 20, and 21 groups of experiments, the ES gained from M/G (n)/C/C, M/G/1/C, and D/D/1/C under LOS C is approximate to S of LOS C. Under LOS D, the ES gained from 77.78% of all the experiments of M/G (n)/C/C, M/G/1/C, and D/D/1/C is smaller than 0.5m2/ped, which is the unstable LOS F (Reference (Group, 2013)). Therefore, the designed corridor width of PH/PH (n)/C/C can satisfy the given LOS better than that of M/G (n)/C/C, M/G/1/C, and D/D/1/C.The comparison of other performance measures among the different methods is shown in Figs. 5(c) to 4(f). The figures demonstrate that the other performance measures of PH/PH (n)/C/C are also improved compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C.1. Under LOS B, the EN of PH/PH (n)/C/C decreases by 13.16%, 16.01%, and 21.25% on average compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C, which decrease by 15.21%, 16.74%, and 22.33% on average under LOS C and by 36.25%, 56.18%, and 65.31% on average under LOS D.2. Under LOS B, the ET of PH/PH (n)/C/C decreases by 14.02%, 18.30%, and 25.96% on average compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C, which decrease by 15.69%, 19.28%, and 26.94% on average under LOS C and by 42.74%, 65.57%, and 75.46% on average under LOS D.3. Under LOS B, the θ of PH/PH (n)/C/C increases by 2.53%, 3.85%, and 5.26% on average compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C, which increase by 2.03%, 3.61%, and 5.28% on average under LOS C and by 11.11%, 25.01%, and 42.86% on average under LOS D.4. Under LOS B, the PCof PH/PH (n)/C/C decreases by 18.68%, 19.15%, and 19.48% on average compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C, which decrease by 34.69%, 35.54%, and 36.07% on average under LOS C and by 68.07%, 98.99%, and 99.50% on average under LOS D.This improvement in all performance measures is expected because of the cost of “increasing width”. Therefore, whether our method is necessary still requires further analysis. As a result, the performance-width elasticity coefficient (the percentage of increase in performance measures divided by the percentage of increase in corridor width; it is similar to the elasticity coefficient of economics) is introduced, as shown in Table 2(c).According to Table 2(c), aside from the 7 groups of the elasticity coefficient of the θ-width, 38 groups achieve an absolute value larger than 1 (the maximum value reaches 5.86). The average absolute value of 45 groups of performance-width elastic coefficients reaches 2.05, indicating the high performance-width elasticity of PH/PH (n)/C/C compared with those of M/G (n)/C/C, M/G/1/C, and D/D/1/C. In other words, increasing width by 1% improves performance by more than 1% and well satisfies the demand fluctuation of passenger flows. Therefore, PH/PH (n)/C/C is more appropriate for the design of metro station corridor widths than M/G (n)/C/C, M/G/1/C, and D/D/1/C.

@&#CONCLUSIONS@&#
