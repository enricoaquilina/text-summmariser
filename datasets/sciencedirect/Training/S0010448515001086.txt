@&#MAIN-TITLE@&#
Analytic construction and analysis of spiral pocketing via linear morphing

@&#HIGHLIGHTS@&#
We define spiral tool-paths via linear interpolation between closed curves.The algorithm is simple and provides an analytic solution in B-spline form.The tool path is smooth and maintains constant radial distances between laps.For non-convex pockets, the interpolation of its boundary and medial axis provides the spiral.Cutter engagement, feed direction, time and forces help to analyse the spiral.

@&#KEYPHRASES@&#
2’5-D milling,Ruled surface,Smooth tool path,Engagement angle,Feed direction,Cutting force,

@&#ABSTRACT@&#
In numerical control, pocketing is a widely extended machining operation with different industrial applications. Conventional strategies (directional and contour parallel) provide a uniform material removal rate, but they show discontinuities and undesirable stops. However, smooth spiral paths overcome discontinuities, although the removal rate is not constant, and their implementation is complex. In order to provide an in-between solution, our algorithm embeds an Archimedean spiral into a linear morphing definition of the pocket. The solution is smooth, simple, analytic, and leads to a B-spline curve. Different tests were performed to compare the proposed spiral to other conventional and spiral strategies. To study the influence of the tool-path geometry, we computed engagement angle and feed direction, and measured force and time. The results demonstrate that our spiral is a committed, analytic and easy to compute solution.

@&#INTRODUCTION@&#
Pocketing is one of the most common operations in NC machining applications. More than 80% of all mechanical parts can be performed using212-D milling.  [1]. Even the most complicated objects are usually produced from a stock through layer-by-layer roughing and 3D–5D finishing  [2]. Pocketing is used in the machining of die cavities  [3], moulds and mechanical components for automotive and aerospace industry  [4].Direction-parallel (zigzag) and contour-parallel strategies are commonly employed for pocketing. In direction-parallel pocketing, milling takes place by way of a zigzag between parallel lines. In contour-parallel pocketing, tool paths are obtained by offsetting the border contour inwardly, and island contours outwardly  [5].Zigzag is a well-studied strategy  [6–9], and is widely used in the roughing stage  [10]. These tool-paths maintain a constant cutting width, and are simple to program. Some drawbacks are excessive retraction motion of the tool, intensive alternation of machining direction, and stop-and-go motion. These may result in longer tool paths, longer machining times and no uniform surface quality  [11].Contour-parallel is the usual choice for machining complex pockets. Offset computation is not straightforward and therefore widely dealt with in the literature  [2,12–16]. Other difficulties faced by this approach are: undesired grooving cuts and multiple entries to ensure total material removal, which might degrade the cutting dynamics, increase the total machining time, and lead to worse surface quality  [11].Zigzag and contour-parallel tool paths have multipleC1discontinuities, making them unsuitable for High Speed Machining (HSM) applications  [17]. Many authors have proposed different smooth tool path strategies to alleviate these difficulties, including the use of medial axis transform  [17–19], mesh mapping techniques  [20], optimization of conventional strategies  [21], or solving an elliptic PDE boundary value problem  [4,11].Although conventional strategies are implemented in CAM packages, it is difficult to reproduce and implement the most powerful spiral solutions. This demonstrates the interest of an easier procedure to produce a spiral in B-spline representation, allowing a straightforward incorporation into CAD/CAM software.The aim of this work is to machine a pocket with an analytic smooth tool path that reproduces the behaviour of an Archimedean spiral; hence attempting to maintain constant radial distances between spiral turnings.The idea is to deform the Archimedean spiral according to a morphing between the pocket boundary and an inner curve. Because of its simplicity, we define the morphing using a linear interpolation. Unlike the interpolation between points, which leads to discrete algorithms such as the recent Li et al.  [22] procedure, we demonstrate that the linear morphing between curves provides an analytic solution.If the morphing boundary curves are B-spline curves, then the proposed analytic solution has an exact B-spline representation. In that case, the construction is reduced to the convolution between lists of control points.This study is limited to regions without any holes, and concentrates mainly on convex pockets. We nevertheless explain how to extend the procedure to non-convex regions with an example. Additionally, we show how to configure the spiral for practical applications.A study of evaluation parameters and a comparative analysis of several real and virtual tests are included in this paper. The efficiency of a strategy in a pocketing operation is usually measured by two parameters: machining time  [23] and cutting forces  [24]. These two parameters are influenced by cutter engagement  [25] and feed-direction  [26]. Whereas conventional strategies show a quasi-constant cutter engagement and high feed-direction changes, spiral tool-paths are smooth, but have non-constant cutter engagement  [21].Regarding the paper structure, the relationship between the Archimedean spiral and a linear morphing is explained in Section  2. This relationship is helpful in obtaining spiral tool-paths for machining free-form pockets, as shown in Section  3. Those tests (pocketing of 3 simple convex shapes) and parameters (cutter engagement, feed direction, cutting force magnitude and machining time) compare our strategy with other tool-paths (2 conventional and 1 spiral curves) as described in Section  4. The test results are presented and discussed in Section  5. Finally, the main conclusions are drawn in Section  6.It is simple to estimate a smooth tool path for machining a circular pocket. An outward Archimedean spiral withmturnings gives a smooth trajectory, which preserves distances in radial directions, and has a straightforward equation:(1)s(t)=t2πc(mt),c(mt)={cos(mt),sin(mt)},t∈[0,2π].The previous spiral is a particular case of a curve that lies in a region defined by the linear morphingd(u,v)between two closed curves: an interior curvedin(u), and the region boundarydout(u):(2)d(u,v)=(1−v)din(u)+vdout(u),u,v∈[0,1].A spiral path (Fig. 1) joins points at consecutive rulings of the ruled surfaced(u,v). Ifdk(mu),k={in,out}representsmperiodic repetitions of a closed parametric curvedk(u),u[0,1], then the spiral ond(u,v)hasmturnings, and has the following equation:(3)c(u)=(1−u)din(mu)+udout(mu).Ifdin(mu)=p={0,0}(the interior curve is a point),u=t/2π, anddout(mu)=c(mt), then Eq. (3) provides the Archimedean spiral (Eq. (1)).The curve definition (3) provides a straightforward solution for defining spirals within convex regions (Fig. 1(b)): a regionΩwhere a pointpexists in such way that the line segment frompto any point inΩis contained inΩ.The following study is mainly focused on convex regions because they are the basic features in industrial applications, and their simplicity helps to analyse the influence of certain parameters, such as interior curve choice, on the pocketing performance.It is, however, possible to extend the proposed solution to non-convex regions by defining the interior curve via the pocket medial axis, as we discuss briefly in Section  3.2.This section describes how to use the curve definition (3) to obtain a tool path for machining a pocket. First, we explain a procedure for convex regions, and second we give clues to extend the method to more general regions without interior islands.Convex pockets appear in many industrial applications. Computer Aided Process Planning CAPP teaches that the features in aerospace and automobile components can be divided into simply connected convex pockets such as triangles, squares, circles and so on  [27,28].It is easy to adapt an Archimedean spiral to a convex pocket by the linear morphing definition (3). The pocket boundary offset at a distance equal to the tool radius isdout(u), whereasdin(u)is a closed curve or a point within the pocket.The resulting tool pathc(u)has the boundary continuity (Fig. 2(a)). Moreover, its shape, as well as the milling step-over, depends on the interior point or curve definition (Fig. 2(b)), and the correspondence betweendout(u)anddin(u)(Fig. 2(c)). It is easy to see that the number of turnings also influences the step-over value.In order to reduce the spiral curvature and therefore cutting forces and time, we use an inner curve instead of a point. The spiral curve (3) behaves likedin(u)whenuapproaches 0, and likedout(u)whenuapproaches 1. A pointpis a degenerate circle with radius approaching zero, and therefore ifdin(u)=p, then the resulting spiral has high curvature aroundu=0. The choice of an interior curve (such as a circle) instead of a point improves the spiral curvature at its initial laps (Fig. 3).We use an interior circle, because it is the simplest closed curve, and it has a constant curvature. Its simplicity helps to align the input curves, and its constant curvature helps to control the spiral curvature.Regarding the step-over distance, the interior curve shape and position contribute to modifying the spacing of the laps. We choose our interior circle centre at the innermost point of the pocket (Fig. 2(b)). This choice avoids large step-over variations in pockets with length–width ratios close to 1, as in the examples in Section  5. In the case of a large length–width ratio, an innermost slender curve can be chosen if the step-over variation is our main goal.The linear morphing between the input curves may lead to undesired artefacts, such as self-intersections (Fig. 2(c)) because this morphing is oblivious to the relative orientation and curvature of the curves at the corresponding points  [29]. Note that, these artefacts do not appear when the region defined by the input curves contains all line segments connecting any pair of corresponding points.A simple way to align the input curves is to change their starting points until the region between both curves contains all line segments between interior-boundary corresponding points. It can be done automatically, taking a discrete number of points or manually by a potential user. This simple solution eliminates the drawback of reparameterizing the interior curve to reach an adequate point distribution, such as that resulting from intersectingdin(u)with lines connectingdout(u)and a pointpwithindin(u), which avoids self-intersections.We use the straightforward approach discussed previously to align the input curves. The alignment heuristic applied in this work is now summarized (Fig. 2(c)):•Move the Cartesian origin top: a point withindin(u).Give the same counter-clock direction todin(u)anddout(u).Force both curves;din(u)anddout(u)to start at the positivex-axis.Regarding the number of turnings, several heuristics can be applied to definem. For example, ifLis the largest distance between corresponding points on the input curves then:(4)m=Quotient(L,2kR),0<k≤1,where2Ris the tool diameter, and the Quotient function gives the integer quotient of two numbers. The spiral turnings have a uniform distribution in each ruling between corresponding points such as the Archimedean spiral. Hence, a portion of material is left uncut if the quotient of dividing the length of the largest ruling by the number of turnings (step-over distance) is greater than the tool diameter.For the examples presented in this work, the input curvedout(u)is a degreen≥3B-spline curve, and we approximate the interior circle by anotherdegree≥3B-spline curvedin(u), which has the same number of control points asdout(u), but uniformly distributed on a circle of radiusRless than or equal to the mill radius. The previous choices guarantee smooth spiralsc(u)with at leastC2continuity. Regarding the contact spiral-input curves, the proposed method only guaranteesC0continuity.Let the input curves be B-spline curves, then the proposed construction provides the exact spiral path in B-spline form. The B-spline representation has an important advantage compared to other analytical equations: it is the semantic representation of CAD models based on the IGES Standard. The main steps for computing the B-spline spiral are summarized below:Step 1.Split the input curves into Bézier segments by a knot insertion algorithm. We use the de Boor algorithm  [30]. If the degree-ninput curvesdk(u),k={in,out}havepcontrol points, then we obtainpdegree-nBézier curvesb1,k(u),b2,k(u),…,bp,k(u).Duplicate each Bezier curvem(number of turnings) times, and obtain a set of curves:bj,k(u),j=1,2,…,m⋅p.Rewrite Eq. (3) to compute the spiral portionjalong the radial distancer(u,j)of each pair of corresponding Bézier curves:(5)cj(u)=(1−r(u,j))bj,in(u)+r(u,j)bj,out(u),r(u,j)=(j−1m⋅p)(1−u)+(jm⋅p)u.Carry out the operations indicated by Eq. (5): addition, multiplication and degree elevation. Eachcj(u)is a Bézier curve whose control pointsc0,j,c1,j,…,cn+1,jare computed by Eq. (5).The aforementioned operations are straightforward in Bézier form. A simple way to do the computation is using the procedure explained by J. Sánchez-Reyes  [31], which is based on convolutions/additions between lists of control points.Make a list with the control points obtained in Step 4, and delete duplicates. This listci,i=0,1,…,m⋅p⋅(n+1), together with a uniform knot array with interior elements of multiplicityn+1, define the degree-n+1B-spline spiral:(6)c(u)=∑i=0m⋅p⋅(n+1)ciNin+1(u),Nin+1(u)are the B-spline basis functions .The resulting spiral tool-path is a degreen+1B-spline curve because of the degree elevation performed at Eq. (5). On the other hand, its continuity depends on the boundary curves continuity. Note that, it is possible to reduce the number of control points by removing knots using the algorithm of Step 1.A procedure in the computational software program ‘Mathematica’ was implemented to perform the previous computations. Fig. 4shows the control window of this application and an example of the resulting B-spline spiral tool-path computed via linear morphing.Although this work is focused on convex pockets, we can give an indication of how to open up the construction to wider range of regions. The following description is a preliminary solution, and further efforts have to be carried out to obtain practical implementations.Note that, for non-convex regions, the main difficulty is how to choosedin(u)to get low step-over variations, and how to aligndin(u)anddout(u)to avoid self-intersections. The medial axis of the pocket is a candidate to determinedin(u).The medial axis (MA) of a pocket is the locus of centres of maximal disks contained within its boundary. Boundary points in contact with a maximal disk are at the same distance from MA. Moreover, each boundary point is related with a unique medial axis point. If the interior curvedin(u)is the MA then the input curves are aligned, and the step-over is quasi-uniform.Dorado  [32] proposes an algorithm to approximate the medial axis by Bézier curves, whose parameters depend on that of the boundary. Once the previous approximation is performed, it is possible to apply Eq. (3), as we explained for convex regions (Section  3.1).Fig. 5shows an example where the main branches of the medial axis define the interior curve (MA pruned to its bifurcation points). Future studies focused on the definition of a closed interior curve around MA might reduce the curvature of the spiral.The tool-path obtained via linear morphing (LM spiral) is compared with conventional tool-paths: direction parallel and contour parallel, and the spiral strategy developed by Bieterman and Sandstrom  [4] (BS spiral). Machining time and forces provide a measurement of the operation efficiency. Smoothness and step-over influence the resulting force and time. To study the influence of smoothness and step-over on the operation, we compute feed direction and cutter engagement respectively.Three simple and convex pocket geometries (triangle, square, and pentagon) are machined to show how a particular strategy and boundary influence the results.ForcesA dynamometer attached to the milling table provides the three force components[fx,fy,fz]in respect of the machine coordinate system. In order to compare different strategies, we measure the force magnitudeFatNtime points along the tool-path, and compute its mean valueF̄:(7)F=1N∑i=1Nfx,i2+fy,i2+fz,i2.Machining timeAlthough the start of the machining process is easy to determine, due to the large increase of force inzdirection, the end of the process is difficult to pinpoint. To overcome this drawback, we decided to generate a similar increment inzforce at the end of the tool-path (by adding G01 Z-0.5 at the end of the CNC code). The distance between the two maximum peaks inzforce curve (Fig. 6) provides the machining timetm.Since tested tool-paths have similar but not equal length, we computeη, the ratio of theoretical timetto machining timetm:(8)η=ttm.In other words,tis the time required to machine a tool-path of lengthlat the reference speedvr. Note thattmis always greater thantbecause the machine reduces its speed at path discontinuities or where the curvature is high. Therefore, ifηis equal to 1, then the machine attains the reference speed. Discontinuities or high curvatures reduceη, which means a reduction in the actual machining speed.Cutter engagementThis geometric parameter is an angular measurementαof the periphery of the cutter in contact with the material being removed, and it is directly related to the radial chip thickness (Fig. 7). Cutter engagement and cutting forces vary accordingly along the tool-path. High changes on theαvalues, and therefore on cutting force, arise from an inadequate cutting plan, and affect part quality and tool wear.The engagement angle is an adequate metric for the influence of path geometry on the operation efficiency. Forces are usually measured with respect to time by a dynamometer, whereas cutter engagement is computed with respect to the parameter of the tool-path, which is meaningful to study the geometry influence on the operation.Note that, it is not straightforward to determineαanalytically for complex paths  [33]. Because of that, we have programmed a heuristic algorithm based on discrete sampling and Boolean operations to compute the engagement angle.Feed directionIn order to quantify the smoothness of a pocketing strategyc(u)={x(u),y(u)}, we estimate the feed direction via the tangent directionc′(u)along the tool-path. Feed direction and curvature are related because the curvature measures changes in the curve direction  [2]. The computation of feed direction is easier than that of curvature, and we consider it useful to study both spiral curves and conventionalC0paths based on linear segments.For spiral paths, this parameter is restarted after each turning. Hence we compute feed directionf(u)with the following equation:(9)f(u)=arctan(y′(u)x′(u))+2π(m(u)−1).The number of turningsm(u)is an integer between 1 andm, and it depends on the parameteru. We takem(u)=1for direction parallel paths.Table 1shows the configuration parameters for each test. We define the tool-paths (spirals and conventional curves) according to the following criteria:•All paths have a similar length. Length differences are less than 10%.The whole region must be machined. For spiral strategies, we define a maximum step-over.On the other hand, our method provides an exact B-spline spiral (not a discrete approximation). We export its control points and knots, and the CAM software generates the tool-path CNC code.Regarding the spiral processing time, the linear morphing algorithm running on a PC with an Intel i7 2.10 GHz processor and 8 GB RAM spends less than 0.1 s in each test. This time is several orders of magnitude lower than the process programmed to produce the Bieterman and Sandstrom examples (greater than 100 s).AA 6063 was used throughout the experimental work. The workpiece material was sawed into blocks with a dimension of 80 mm × 60 mm × 20 mm. We used GÜHRING 3309–DIN 6527 L–MD end mills. The cutter had a diameter of 6 mm and helix angle of30°.Fig. 8portraits the main components of the experimental setup. All pocketing tests were performed on a conventional vertical prismatic machining centre. It had a continuously variable speed of 100–4000 rpm with a maximum spindle power of 1.5 kW and variable feed rates up to 5 m/min. The cutting conditions were fixed as follows: feed rate of 100 mm/min, spindle speed of 1500 rpm and axial depth of cut of 2 mm. Cutting fluid was used in all machining tests.Cutting force measurements were carried out using a three-component piezoelectric platform dynamometer with a resonant frequency of 2.3 kHz in thex-,y-axes, and 3.5 kHz in thez-axis. The dynamometer was connected to a PC. The whole system was checked and calibrated prior to use. Cutting force signatures was stored on a hard disk, and the post processing of the cutting force data was performed using Mathematica software.Figs. 9–11show the estimated cutter engagement and feed direction along the tool-path for 3 simple convex pockets: triangle, square and pentagon. The boundarydout(u)is not included in the computations.On the other hand, Figs. 12–14show the measured force magnitude versus time for the aforementioned cases. A filtered profile has been computed for each example to get an idea of the force tendency, and to compare force to cutter engagement. Finally, mean force magnitude, mean engagement angle, and the ratioηare drawn at Fig. 15.The following discussion shows the advantages and disadvantages of the proposed solution based on a linear morphing (LM spiral) in respect of conventional strategies and the Bieterman and Sandstrom  [4] spiral (BS spiral).Regarding cutter engagement (Figs. 9–11), the proposed solution (LM spiral) and BS strategy have no constant value. Otherwise, conventional methods maintain a constant value except at discontinuities. Cutter engagement has a similar evolution to that of the measured force magnitude (Figs. 12–14).LM spiral is a blend of conventional and Bieterman–Sandstrom solutions. Note that constant cutter engagement without discontinuities is a desirable result for avoiding tool vibration and wear. In this regard, LM spiral shows adequate behaviour since it lacks discontinuities (like BS), and it tends to a constant value (like conventional solutions).The smoothest tool-paths: BS and LM have a continuous feed direction (Figs. 9–11). Different discontinuities appear in the feed direction curve of conventional strategies. The milling machine has to reduce its speed at significant feed direction changes (points of high curvature), and therefore smooth paths become the fastest, as Fig. 15 shows.Figs. 9–15 show thatFandαhave similar profiles and mean values. Moreover, the mean values are related with the defined step-over. We demonstrate this with an example: according to Fig. 15 and Table 1, in the case of the triangular pocket, the direction parallel strategy with a step-over of 4 mm produces the maximum values ofFandα, and the contour parallel with a step-over of 3 mm produces the lowest. On the other hand, BS and LM have medium values ofFandα, because they have a non-constant step-over between 3 mm and 4 mm.Finally, Fig. 15 shows that BS and LM spirals have the highest machining speeds (highestηvalues). The main reason for this is that the feed direction discontinuities in conventional solutions reduce their actual machining speed.For the tested LM spirals, the speed ratio value(η)depends on the pocket curvature and the number of turnings. These parameters influence the value and number of feed direction changes. The spiral in the pentagon has the highestη, since the pentagon has lower curvature values than the triangle and the square. Triangle and square pockets have similar curvature values, but the spiral within the triangle has fewer turnings, and that explains its higher experimentalη.

@&#CONCLUSIONS@&#
There are different solutions regarding the tool-path for machining a pocket. Conventional strategies are easy to implement but show discontinuities, whereas current spiral paths have continuity but the step-over is not constant and their implementation is not straightforward.This paper gives a smooth spiral for machining pockets without holes. The key idea is to adapt an Archimedean spiral (the linear morphing between a circle and its centre) to a free bounded region. The resulting tool path maintains the radial distance between turnings constant, as does the classical Archimedean spiral, and it inherits the continuity of the boundary.The construction is simple and leads to an analytic solution in few steps (Section  2): choose an interior curve, compute the linear morphing between the boundary and the interior curve, and apply the linear morphing equation (Eq. (3)). The interior curve and the number of turnings influence the spiral curvature and the step-over.The main advantages of the aforementioned construction are summarized below:•The method is straightforward, and gives an analytic spiral tool-path with the boundary continuity.If the boundary and the interior curves are B-Spline, then there is an exact spiral in B-Spline form. This helps to incorporate the procedure into CAD/CAM programs.The construction attempts to maintain the radial distance between turnings.Section  4 describes the tests performed to study the proposed solution. We tested 3 simple geometries on a 2.5D conventional milling machine, using two conventional strategies (directional and contour parallel), Bieterman and Sandstrom spiral  [4], and the spiral embedded in a linear morphing. Force and time were measured to evaluate the operation efficiency, whereas the engagement angle and the feed direction were computed to analyse the influence of variable step-over and smoothness on the pocketing operation.The tests performed show that spiral solutions are better for reducing cutting time, although the time reduction would be better appreciated using high-speed machines. On the other hand, the mean forces are similar and depend mainly on the engagement angle.