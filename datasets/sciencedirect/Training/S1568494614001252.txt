@&#MAIN-TITLE@&#
Using Hopfield neural network to optimize fuel rod loading patterns in VVER/1000 reactor by applying axial variation of enrichment distribution

@&#HIGHLIGHTS@&#
The analysis technique was developed to find the optimum core configuration.Applying axial variation of enrichment distribution in VVER/1000 reactor.Optimization fuel management by using artificial neural network.Using Hopfield neural network to optimize fuel management reactor core.

@&#KEYPHRASES@&#
Optimization,Hopfield neural network artificial,Power peaking factor,Effective multiplication factor,Axial variations distributions of enrichment,

@&#ABSTRACT@&#
The present work investigates an appropriate way to solve the problem of optimizing fuel management in a VVER/1000 reactor. To automate this procedure, a computer program has been developed. This program suggests an optimal core configuration which is determined according to established safety constraints. The suggested solution is based on the use of coupled programs, one of which is the nuclear code, for making a database and modeling the core, and another one is the Hopfield neural network. In addition to we applied axial variations of enrichment in fuel rods to flat the flux core as novel role. This computational procedure consists of three main steps. The first one consists of creating the cross section database and calculating neutronic parameters by using WIMSD4 and CITATION codes. The second one consists of finding the best axial variations distributions of enrichment to create a fuel rod pattern by using Hopfield neural network artificial (HNNA) and the cross section database. The third one consists of loading of the fuel rods by the suggested fuel rod patterns and finding the optimum core configuration by HNNA that based on minimizing power peaking factor (PPF, PPF=maximum power/average power) and maximizing the effective multiplication factor (keff, the ratio of the number of neutrons in two successive fission generations). The procedure uses the optimized parameters in order to find configurations in which keff is maximized. The penalty function is applied to limit the value of local PPF in the neighborhood fuel assemblies. Therefore, in this paper, we proposed a new approach for the use of Hopfield neural network to guide the heuristic search, and applied axial variations distributions of enrichment as novel method to flat the neutron flux and for evaluating the obtained results pertaining to the first core.The results show that applying the HNNA led us to the appropriate PPF and keff. Also, applying HNNA and axial variation of enrichment is promising to reach the flattening neutronic flux and guaranteeing safety condition in the reactor core. Therefore, we achieved to a set of two basic parameters PPF and keff as effective factors on satisfying the safety constraints of VVER/1000 reactor core.

@&#INTRODUCTION@&#
Optimization of the fuel management in reactor core is one of the basic and complex problems. The appreciable quantity of the loaded fuel in the core needs careful management to achieve the best fuel assembly arrangements.Actually, these operations are arduous, since they involve problem of significant meaning in terms of safety and economic. Therefore, the fuel management problem for any given nuclear reactor consists of setting an optimal fuel reloading policy for each cycle to minimize the overall related operation energy cost. On the other hand this loading must guarantee required generated energy.Many fuel shuffling methods have been studied to achieve these goals; that is, to obtain the optimal loading patterns. Some of these methods are as follows: linear programming [22], dynamic programming [25], variational optimum control theory (OCT) [26], perturbation theory [10], direct search [24] and heuristic/artificial intelligence [13], population-based incremental learning (PBIL) [2,14,16,23], and ant colony optimization (ACO) [5–7,15,23].In total, to solve the N-restriction problems are introduced the neural networks as powerful tools. In the field of optimization, the HNNA has a well-demonstrated capability of finding solutions to difficult optimization problems. As a good example in this regard is the traveling salesman problem (TSP) [12]. In the field of fuel management optimization, Sadighi et al. [21] employed HNNA and the simulated annealing technique to flat neutron flux in PWRs and applying HNNA and evaluating process, keff to optimize Busheher reactor core [20].In this paper, the application of HNNA, which is a powerful approach in this field, is introduced. We coupled the HNNA method to apply axial variations distributions of enrichment in fuel rods to flat the neutron flux and power peaking factors in the core and applied evaluation process to find the optimum core. It is worth to say that this method is decreased amount of the associated calculations of this problem. Also, it should be mentioned that applying axial variations distributions of enrichment in reactor core is one of innovation methods which will improve certainly the core basic neutronic parameters. This method extremely decreases temperature differences in fuel rod surrounding coolant as important problem to guarantee safety conditions.Therefore, placing four kinds of various enrichments in 10 segments of the fuel rod is the first goal. The second goal is finding the best loading reactor core that containing these fuel rods to reach the highest generated energy. The objective function of this problem based on decreasing the total, radial and axial power peaking factor and increasing keff as effective parameters to reach optimum core. Consequently, the overall energy cost of the related operation is minimized. This problem is eventuated ultimately to achieve the highest generated power and the most of monotonous fuel consumption for reactor core that is very important in economical and technology aspects.The VVER/1000 is a nuclear power plant with a thermal power of about 3000MW. This reactor is moderated and cooled by light water and loaded with enriched uranium oxide (1.6%, 2.4%, 3.3%, and 3.7%) in first core cycle. The core loaded by 163 hexagonal fuel assemblies. Every fuel assembly is composed of 311 fuel rods (that have an active length of 353cm), a water rod, a measuring central tube and 18 guide tubes arranged with a pitch of 1.275cm in a triangular lattice. A number of fuel assemblies contain burnable absorber rods (CrB2+AL) for reactivity control during the first cycle. Of the 20 guide tubes, 18 are used for control rods movement and or burnable poisoning rods insertion while the other two are used for instrument devices or measurements. That all of them fastened by 15 spacer grids made of Zr+1%Nb in the axial zone [18].The core neutronic parameters are calculated using computer codes WIMSD4 for group constants generation of homogenized fuel assembly macroscopic cross sections. Then, the reactor core is modeled in 3D by hexagonal geometry using CITATION to create cross section database. Also, in this process, the neutronic parameters are calculated for the first loading pattern of reactor core. These parameters included keff, excess reactivity, radial linear power distribution in core, axial linear power distribution in core, radial power peaking factor, axial power peaking factor, total power peaking factor, local power peaking factor for any fuel assemblies.To optimize the fuel management of core configuration and applying axial variations distributions of enrichment, the HNNA is used. This neural network has been designed with a high ability to solve restraint problems. In this work HNNA used to find the minimum value of PPF and the maximum value of effective multiplication factor for core configuration VVER/1000 reactor.The results show that the total, axial and radial power peaking factors are improved in the suggested patterns. Therefore, employing the HNNA and applying axial variations distribution of enrichment led us to the appropriate PPF, keff, neutron flattening flux and monotonic burn-up that eventuate to achieve optimal core.Each fuel assembly type of the VVER/1000 reactor is composed of 311 fuel rods and 20 guide tubes, that loaded with burnable absorber and/or control rods or it is filled with light water. In order to prepare cross section database, using the WIMSD4 computer code to generate cross sections. The CITATION code is used to calculate the flux distribution in the fuel assemblies are provided by flux integration over each fuel assembly [20].To perform the required core calculations of the VVER-1000 with employing 3D hexagonal core model, CITATION computer code was used. The core divided axially into 41 subzones and each fuel assembly cell is divided into 7 meshes. Radial reflector region thickness is averaged to be 34cm and top and bottom reflectors are averaged to be 20cm [19,20] (Fig. 1).A novel original computational process is proposed in this work, which gives optimal configuration of fuel rods by applying axial variation of enrichment distribution in VVER-1000 reactor core. This process uses an evaluating method both on multiplication factor and artificial neural network technique [20].In this process two main stages are coupled: (1) finding the best applying axial variations of enrichment in fuel rods; (2) optimization the core configuration including these fuel rods.It is considerable that in both of above stage using Hopfield neural network is common calculation method. At the first section we describe the Hopfield neural network. Then, we explain how to use Hopfield neural network and connect to the keff evaluating process.A Hopfield neural network is a single layer feedback network consisting of a large number of neurons, which are fully interconnected unsupervised network. The Hopfield neural network has the Lyapunov energy function that the energy function decreases with the evolution of the network's state [27], and when the network reaches the final stable state, the energy function falls into a local minimum. The general method of applying the Hopfield neural network to solve optimization problems is to map the objectives and constraints involved in the problem into an energy function, and then obtain the neuron's dynamic equation by differential of energy function [11]. The Hopfield energy function may contain several energy terms, which may be roughly classified into constraint terms and the objective function. The constraint terms may be further classified into zero-constraint terms, nonzero-constraint terms and hybrid-constraint terms. Zero-constraint terms are used to constrain the network to converge to binary values. A nonzero-constraint term is used to constrain that a subset of objective function has several nonzero elements at the stable state. Other constraint terms are simply called hybrid-constraint terms [8].Generally, the Hopfield energy function can be expressed as a weighted sum of the above constraint terms and the objective function [17]. After establishing constrains functions and penalty coefficients, differentiating the energy function (Lyapunov function) leads to a dynamic neuron function. This function is used to update value of the transfer function for HNNA algorithm [12].This process continues until the function convergence is satisfied for the stop criterion. In reality, this kind of neural network is called recurrent since the outputs are feedback to input signals and the process is repeated until a stop criterion is satisfied. The output of a neuron (either 0 or 1) is called the neuron state and the set of all neuron states is called the global state. The stop criterion is given by an energy function that decreases its value when the neurons change their neural states. Using a transfer function, neurons can change their neuron states. If these changes are appropriate, then the energy function value decreases. The energy function acts as goal function (indicating the solution cost), and the proposed solution is associated to a global state [1].Generally, the process begins by initializing the weight matrix and proposing a valid global state. The iterative process then consists in changing the neural states (according to the transfer function) in order to decrease the energy function value. This energy function value corresponds to a stable global state. Therefore, we explained the energy/Lyapunov function of HNNA and evaluation process to clarify optimize process.At the first, we explained method of axial variations enrichment applying in fuel rod that this novel method are applied by the HNNA algorithm. Then, we calculated the local PPF of the suggested pattern fuel rod by using database, WIMS and CITATION codes.It should to be mention that this process is the first step of optimization strategy that is based on loading adjacent enrichment fuel with minimum local temperature difference. This strategy eventuates to decrease the extremely temperature difference in the core. This problem is very important to guarantee the safety condition. Also, this novel method, applying axial variations distribution of enrichment in fuel rods, eventuate to flat the neutronic flux in the core that cause to increase generated power in safety condition.In the second step, we employed HNNA method and evaluating process that the penalty function is applied to limit the value of local PPF in the neighborhood fuel rods on placing two fuel rod with minimum difference local PPF [20]. These steps are explained in following sections.An original computational system is proposed in this work, which gives the best applying axial variation of enrichment in fuel rods.The most important requirement for this computational system is the energy function, which is tailored to the problem. Therefore, we should justify the energy function for this problem. The first step of computational procedure consists of determining constraint function and employing heuristics rules that are used during the optimization process. These heuristics are described as follows:1.Each fuel element divided into 10 segments.Highest enrichments should be placed in top and bottom of fuel element segments.Burnable absorber rods are in fixed positions.Applying four various enrichment to form fuel rod patterns, 1.6%, 2.4%, 3.3%, and 3.7%.Placing symmetrical enrichment in top and bottom half of fuel elements.To note coolant temperature differences that surrounded fuel element segments.Heuristically, these constraints are used as the restriction functions neural network to find the best placing pattern of enrichment axial variation distribution in fuel element segments. In this section, each segment in the fuel rod is assigned to one neuron and its neuron state indicates which one of the various enrichments is located in the associated segment. This fuel rod has 10 neurons, and is fully connected. We assumed a 10×10 quadratic and symmetric matrix for activation values that to name ‘fuel matrix’.Therefore, the constraint and objective functions to consist of:1.Each enrichment is replaced only once in segment fuel rod.Each segment is filled only once kind of enrichment in the fuel rod segment.There are 10 segments in each fuel rod in total, namely the sum of all element segments in the fuel element isTotally 10 neuron are active (the main function for optimization process)The main term to achieve the goal is delta function, Δ. In reality, we applied two effective function as Δ that this function consists of two Dirac delta and Kronecker delta functions. The first function is Kronecker delta that is based on recognizing the fuel enrichment. The second function is Dirac delta that applying the main condition to load the at least two adjacent fuel enrichment that it is based on minimum local temperature between adjacent fuel segments.In total, the energy function is the sum of four functions as below:(5)Energy Function:E=Ea+Eb+Ec+EdAccording to neuron dynamic function, assuming the dynamic system with (n, n) state variables v11, v12, …, vnn, the network motion equation is [17]:(6)duxidt=−dEdvxiwhere uxiand vxiare the input and output of the xith neuron. For energy function E, the motion functions as follows:(7)Uw,I(NEW)=Uw,I(OLD)+Δt*−Uw,I−A×∑z=1,wz10Vz,I−B×∑J=1,J≠I10Vw,J−C×∑z=110∑J=110Vz,J−N−D×∑z≠w10dw,z(vv,i+1+vv,i−1)Finally, Eq. (7) is used in the Hopfield neural network algorithm. This algorithm is used to update transfer function. This process continues until this function is converged for any neuron and stop-criterion is satisfied. Then, these valid current solutions are checked. The algorithm is summarized in the following scheme:1.To calculate the local coolant temperature differences for each segment of fuel rod.To calculate the fixed weight matrix.To initiate the net functions of all neuron to a random value with zero mean.To repeat the following steps until stop-criterion is satisfied:4.1.To randomly determine the order in which the neurons are going to be updatedUpdate each neuron in the order determined in dynamic function.To check if stop-criterion is satisfiedTo check if current solution is a valid tour [17,28].It is worth to mention that this algorithm is design by Fortran95 [3,4]. It should be noted that the transfer function is chosen to be a sigmoid. We also tested a hardlimiter but the obtained solutions were not satisfying. Also, it should be mentioned to say that the stop-criterion is satisfied as follow: the termination criterion is to see if the current state is equal to last state of the neuron array (Fig. 2).Therefore, 102 neurons are updated each iteration. When the neural network arrive a stable state, the energy of the neural network arrives at a local minimum. The final matrix of updating neuron presents the best patterns for fuel element. The algorithm designated to HNNA was converged after 126 iterations. This algorithm was generated a final matrix of activation values. The final matrix consist 10 active neurons. These active neurons are indicated by ‘1’ value and other neurons are indicated by ‘0’ value. This binary matrix is a pattern of applying enrichment variations in fuel rod. Of course, to present his matrix must convert to visual configuration model. The best presented patterns are showed in Fig. 3.Finally, we computed local PPF for any suggested fuel rod as main parameter for optimization process by using database, are generated by neutronic code that are employed as main parameter in objective and constraint function in Section 2.1.3.This method is applied by using Hopfield neural network algorithm similar to previous algorithm. Then, the evaluating program by multiplication factor coupled to this artificial neural network technique.It should be mentioned that this process is the main step of optimization strategy that is based on loading adjacent fuel rods, consist of axial variation of enrichment, with minimum local PPF difference. This strategy eventuates to decrease the PPF extremely inhomogeneous in the core [20].Therefore, each position in the reactor core is assigned to one neuron and its neuron state indicates which fuel rod is located in the associated channel in the core. This reactor has 163 fuel assemblies and each fuel batch contains of 311 fuel rods. Therefore, this reactor has 50,693 (163×311) neurons, and is fully connected. Since the most important requirement applying this neural network model is the energy function, which is tailored to the problem we now justify the energy function. The constraint and objective functions to consist of [20]:1.Each fuel rod fill only once channel in reactor core.Each channel has filled only once fuel rod in reactor core.Three are n (50,693) fuel rods in total, namely the sum of all element in the array is n.Totally n neurons are fired, the main function for optimization.Therefore, the energy function is the sum of the four functions:(12)Energy function:E′Total=E′A′+E′B′+E′C′+E′D′For energy function E′, the motion functions as follows:(13)U′X,I(NEW)=U′X,I(OLD)+Δt′×−U′X,IA′×∑Y=1,XY50,693VY,I−B′×∑J=1,JI50,693VX,J−C′×∑Y=150,693∑J=150,693VY,J−50693−D′×∑y≠x50,693δx,y(vy,i+1+vv,i−1)Finally, Eq. (13) is used in the Hopfield neural network algorithm. This algorithm is used to update transfer function. This process continues until this function is converged for any neuron and stop-criterion is satisfied. Then these valid current solutions are checked. The algorithm is summarized in the following scheme:1.To calculate the difference local PPF for all fuel rods.To calculate the fixed weight matrix.To initiate the network functions of all neuron to a random value with zero mean.To repeat the following steps until stop-criterion is satisfied:4.1.Randomly determine the order in which the neurons are going to be updated.Update each neuron in the order determined in dynamic function.To check if stop-criterion is satisfied.To check if current solution is a valid tour [17,20,28].

@&#CONCLUSIONS@&#
It can be concluded of this paper that the novel optimization method is proposed. This optimization method is based on two processes. In the first section of this method, we used HNNA as fully interconnected unsupervised network. It has Lyapunov energy function which guarantees to reach the stable state. In the first step, we applied the axial variations distribution of enrichment in the fuel rods as novel method to flat the neutron flux in the core by HNNA. Also, we applied loading at least two adjacent fuel rods with minimum local PPF as objective term to flat the total PPF of the core and decreasing extremely inhomogeneous variations of the total PPF of the core as the second step. In the third process, we evaluated the HNNA suggested patterns by modeling and calculating pattern based on database and CITATION code to reach neutronic parameters. In reality, we compared these results to obtained results of the primary reactor core. The main criterion of the evaluating process is based on comparing keff. In total, it should be mentioned to say that the obtained results of HNNA suggested pattern is interesting and acceptable. Therefore, the coupled method consist of HNNA and evaluating process lead us to achievement of intelligent tool to optimize the fuel management in reactor VVER/1000.