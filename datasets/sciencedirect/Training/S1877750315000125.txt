@&#MAIN-TITLE@&#
A multiscale computational framework to understand vascular adaptation

@&#HIGHLIGHTS@&#
We develop a computational framework for multiscale modeling of vein graft adaptation that couple environmental condition described with PDEs and tissue adaptation at the cellular level described with agent base model.The implementation is designed to facilitate dialogue between computational scientist and MDs and accelerate the iterative process on model improvement: it is modular, simple and computationally efficient.We have been able to reproduce interesting pattern observed on our animal model and have a tool to question the impact of new potential control on the biology such as proliferation rate or inflammation.

@&#KEYPHRASES@&#
Multiscale,Agent based models,Pde,Vascular adaptation,Hybrid agent base model,Multiscale modeling,Surgical outcome,Intimal hyperplasia,

@&#ABSTRACT@&#
The failure rate for vascular interventions (vein bypass grafting, arterial angioplasty/stenting) remains unacceptably high. Over the past two decades, researchers have applied a wide variety of approaches to investigate the primary failure mechanisms, neointimal hyperplasia and aberrant remodeling of the wall, in an effort to identify novel therapeutic strategies. Despite incremental progress, specific cause/effect linkages among the primary drivers of the pathology, (hemodynamic factors, inflammatory biochemical mediators, cellular effectors) and vascular occlusive phenotype remain lacking. We propose a multiscale computational framework of vascular adaptation to develop a bridge between theory and experimental observation and to provide a method for the systematic testing of relevant clinical hypotheses. Cornerstone to our model is a feedback mechanism between environmental conditions and dynamic tissue plasticity described at the cellular level with an agent based model. Our implementation (i) is modular, (ii) starts from basic mechano-biology principle at the cell level and (iii) facilitates the agile development of the model.

@&#INTRODUCTION@&#
In 2009, cardiovascular disease was the underlying cause of death accounting for 34.1% of all 2371,000 deaths, accounting for 1 of every 2.8 deaths in the United States [1]. Surgical revascularization using autologous vein also remains a frequent used treatment option, with 427,000 coronary bypass procedures performed in 2004. Fueled by an epidemic of obesity and diabetes in the United States, substantial increases in the need for these interventions are projected over the next decade. Despite the escalating need for these often life-saving procedures, their medium and long-term durability remains compromised. Contemporary data demonstrate restenosis rates following percutaneous coronary interventions to range between 25 and 35% at 6 months and high grade restenosis (>75%) or occlusion of coronary vein bypass grafts approaching 50% at a year [2]. Since many technical avenues for improved patency have been exhausted, the recent belief has been that the future of enhancing the durability of these constructions lies in a better knowledge of the biology of the vein graft healing response.Vascular adaptation following local injury occurs through a combination of wall thickening (hyperplasia) and expansion or contraction of the lumen [3]. Over the past two decades, researchers have applied a wide variety of approaches to investigate the biologic mechanisms that drive a pathologic hyperplasic or vascular remodeling in an effort to identify novel therapeutic strategies to improve clinical outcomes [4–11]. These strategies have focused largely on linear models to separately describe the physical or biologic components of vascular disease progression. In order to significantly advance our understanding of the function of such complex phenomena, it is necessary to integrate data from several domains and use quantitative models to predict the behavior and outcomes. Based on both fundamental biology and the physical environment, we propose here a computational framework to develop an agent based model of vascular adaptation following acute intervention.Our model encompasses multiple scales in space and time. The continuous mechanic description of flow and tissue deformation operates at the time scale of the second. The spatial resolution is at the scale where the density of tissue is in continuum mechanic, i.e., millimeter scale. The tissue plasticity is at the spatial scale of the individual cells, i.e., micrometer scale. The time scale of the tissue adaptation is of the order of the cell cycle expressed in hours. It is feasible to use separated modules to approximate each scale that are weekly coupled. Change in the anatomy takes days and mechanical stress over a slow time scale. We assume that cells are sensitive to quasi-steady approximation of mechanical quantities, such as mechanical stress. The coupling between these modules explicit the relationship between tissue plasticity at the cellular level with environment conditions described thanks to the classical continuous mechanic.Our implementation is modular, agile, and starts from basic mechano-biologic principles at the cell level. This construction supports the dialogue between theoreticians and experimentalists by describing in a non-ambiguous way all variables, relationships between variables, and assumptions. Each iteration of the computational model is confronted with an experimental result, challenging us to revisit and update our assumptions. The modular nature of our implementation provides an efficient structure for integrating rapid revisions to the model. We should emphasis that our work share many common difficulties with multiscale modeling of vascular adaptation after stenting, or AAA formation. While our approach is quite generic we have indeed concentrated our model to capture some of the main features of vein graft adaptation that are quite unique and different than those problems [12–16]. We would like to know precisely what is the initial condition at time zero in our animal model. This is something far more difficult to have in aneurism formation or repair model.At the time of implantation, vein bypass grafts are composed of a thin intimal layer, which serves as the blood-tissue interface, and a thick medial layer, which provides the structural support for the wall (Fig. 1a). Boundaries between the intima and media and the external surface of the media are a sheet of connective tissue, called the internal elastic lamina (IEL) and external elastic lamina (EEL), respectively. Upon exposure to the high pressure/high flow arterial circulation, two distinct processes – intimal hyperplasia and wall (inward/outward) remodeling – are initiated [17]. Intimal hyperplasia is characterized by the migration of smooth muscle cells (SMC) into the intima with the proliferation and deposition of extracellular matrix (ECM), resulting in narrowing of the vein graft lumen. In contrast, remodeling is characterized by the preservation or loss of lumen area through reorganization of the cellular and extracellular components within the media. It is the balance between these two processes that dictates the degree of luminal narrowing and ultimately the success or failure of the graft [18] (Fig. 1b).Analogous to the focal nature of atherosclerotic disease in the arterial system [19], local wall shearing forces have been postulated as a major regulator of vein graft adaptation. Suggested by an array of animal experiments from both our group [20] and others [21] and more recently confirmed by recent observations in humans [22]; reductions in local wall shear have been demonstrated to be critical components leading to accelerated intimal hyperplasia development, limited outward remodeling, and vein graft failure. The temporal pattern of these dominant biologic processes, and their relationship to the imposed luminal shear stress, are detailed in Table 1[23]. This table provides both a heuristic and experimental understanding of the vein graft adaptation.While multiple lines of evidence suggest an important interaction between the physical and biologic environments, a quantitative understanding of the dynamics that govern the remodeling process is lacking. Our laboratory has conducted a series of experiments to catalogue the temporal, spatial, and shear-dependent variations in the dominant biologic process that dictate the vein graft architecture. Using our rabbit model of shear-modulated vein grafting adaptation [24–28], harvested vein segments were implanted into the arterial circulation and exposed to either low or high shear conditions. At 4, 7, and 14 days, grafts were harvested for histomorphometric analysis (n=5 per group). The tissue cross-sections were stained and analyzed for intimal and medial areas. The spatial distribution of cell proliferation and apoptosis shown in Fig. 2were determined, using Bromodeoxyuridine (BrdU) incorporation and terminal deoxynucleotidyl transferase (dUTP) nick end labeling (TUNEL) assays, as previously described [28,29].We may hypothesize two simple feedback mechanisms driven by blood velocity and intramural pressure that compete each other with wall remodeling to support the phenomenological description accumulated from years of experiments – see Table 1 and Fig. 3:•(F1) Low shear stress promotes SMC division in the intima, which gives intima thickening. This in turn increases flow and shear stress.(F2) High tension promotes SMC division in the media, which leads to wall thickening. Increase in wall thickness lowers the tension, provided that the difference between the internal and external pressure stays constant.None of these two mechanisms are linear, and additional mechanisms may either saturate the impact of mechanical effect, or reverse it thanks to the wall plasticity [3,9]. For example, the production of ECM and collagen change the mechanical properties of the wall over the time. Beside the vein graft is companion with wall injury, in particular with the loss of the vaso vasorum. Inflammation triggers monocytes recruitment at the wall that transform into macrophage inside the wall. This may trigger SMC cell division. Vice versa, cell apoptosis may promote inflammation [7].Further, for the value of shear stress and tension large enough, apoptosis may take over cell division [11].To make things even more complicated, changes in graft hemodynamics are not only influenced by local changes in geometry, but also more global changes in cardiac contractility and microvascular resistance. As a result, changes in flow rate and intraluminal pressure are independent of vein graft adaptation. The current model is designed to investigate the full range of potential hemodynamics and describe the potential spectrum of vein graft responses.A model that fits experimental data might be able to help decide which mechanism is dominant under which circumstances.From both the Brdu and Tunnel experiment, we see that the main time dependent factor is in fact related to the injury at the wall (and EEL) and somehow related to the production of macrophage and (MCP1, CCR2, with some delay). We start with a very fast dynamics for cell mitosis that decays in time as the vein graft tissue” gets repaired”.Cell mitosis rate in the intima might be described then as -see Fig. 2:rate of mitosis=function of (time)×exp(-Shear/dist to lumen)×function of (Shear).Similarly Cell mitosis in the media might be described as–see Fig. 2:rate of mitosis=function of (time)×function of (Tension).Eventually these two sub-domains models are coupled by describing the transfer of biochemical components and migration of cells through the elastic membrane that separate the intima from the media.There might be no understanding at this point of the possible contribution of undifferentiated cells that come from the outside medium (lumen or outside vein graft) adhere to the wall and become SMCs as they progresses inside the wall. The only way an SMC moves inside the wall in this model is through the ECM degeneration/production [30,31].The framework of an agent based model (ABM) is well adapted to describe the discrete elements that comprise the tissue at a cellular level. Such a bottom-up approach provides a framework for the implementation of biological rules that can be explicitly tested using experimental models [32]. In contrast, Partial Differential Equations (PDEs) are well suited to describe continuum mechanics, and our current problem, to compute the hemodynamic forces and stress-strain relationships that define the environment. With these divergent needs, our current approach creates a hybrid computational framework that integrates both ABM and PDE approaches.In the initial formulation, we will develop an ABM that tracks the cell dynamic, focusing exclusively on cell proliferation, cell apoptosis, and extracellular matrix production/degeneration. In this simplest form, the model construct approximates a cellular automata, comprised of a spatial grid that can assume a finite number of discrete values [33,34]. Each element in the grid subsequently evolves in response to the configuration of its nearest neighbors. We will follow somehow here a constructive approach form the simplest one dimensional model to the most complicated two dimensional model in order to address the difficulties of the construction one at a time. The one dimensional model we will present next has pedagogic value but also can be easily analyzed by ODEs. This will help us to establish the set of parameters in SMC apoptosis/mitosis or ECM production/degeneration that can be statistically consistent with a steady solution.To demonstrate the general organization and performance of the approach, a one dimensional model is chosen. A one dimensional line of ABM sites, bounded by the lumen of radius (Rlumen) and the outside of the graft (LEEL) is created see Fig. 4. The ABM sites are the state of “cell” (i.e., SMC) or “matrix” (i.e., ECM), with no adjacent sites remaining undefined. SMC and ECM are assigned a priori in random fashion, but with a prescribed proportion Θ that is a fixed number ranging from zero to one (Fig. 4). The rabbit vein graft wall at the time of implantation is composed predominately of media and is assumed to be composed of 25 occupied SMC/ECM sites. dSMC is defined as the dimension of an SMC/ECM site, which will be non-dimensionalized in this formation of the model (i.e., dSMC=1).Evolution of the model is stochastic, based on the following set of probabilities.SMC undergoes division or apoptosis with periodicity Tcell=12h, and two parameters (0<Papoptosis, Pdivision<1) are chosen apriori to define the probability law that drives this cellular process. An initial distribution of SMC is selected, with an initial clock randomly generated in the (0, Tcell) interval. Every hour, the internal clocktnof the SMC is evaluated. We use the notation a | b for a couple of integers (a, b) to say that a divides b. If Tcell| tn, then a random number between zero and one is generated [p=rand (1) in (0,1)]. If p<Papoptosis, the cell goes to apoptosis and disappears from the ABM site. The voided site is removed and the two neighbor ABM sites reconnect.If p>1−Pdivision, the cell divides and a new site is created and inserted adjacent to the active site, effectively expanding the line of ABM sites by one unit. Following division, the internal clocks of the active and daughter SMC sites are reset to zero. If no division or apoptotic event occurs, the clock of the site is advanced by one unit of time (1h). Note that, no synchronization between various SMC sites has been specified, and the number of cell event varies from one time step to the next one.Because the ABM is a uniform, one-dimensional structure, an ordinary differential equation (ODE) can be used to describe the population of SMC. IfYSMCnis the total number of SMC sites in the ABM at time tn(n stands for the time step expressed in hours), then(1)∂YSMC∂tc=(Pdivision−Papoptosis)YSMC,wheretcis the time scale of division. Equilibrium corresponds to(2)Papoptosis=Pdivision,while (Pdivision<Papoptosis) or (Pdivision>Papoptosis) leads to extinction or unchecked growth, respectively.ECM are either produced or degraded by SMC. These processes occur at a time scale Tmatrix, where Tmatrix<<Tcelland Tmatrix=2h is chosen as an initial approximation. As matrix proteins are integrated into the architecture of the blood vessel, ECM are assumed not to transform or migrate. As such, the pattern of ECM and SMC sites is driven by the ECM kinetics, Tmatrix.Similar to our approach with the SMC kinetics, ECM events are triggered when Tmatrix | tn and a random number p=rand (1) in (0,1) is generated.If p<P*production, an ECM unit is created and integrated into the ABM site adjacent to an SMC occupied site. In contrast, the degradation of ECM is assumed to be dependent on the local density of SMC, and three new parameters (P*production, P1degradation, P2degradation) are used to define these relationships. With the probability of ECM degradation depending on the number of neighboring SMC sites, the following relationships are developed:(3)Pdegradation1=Pdegradation*,Pdegradation2=2Pdegradation.*Note that, in the current formulation of the model, ECM has no effect on the SMC population outside of manipulating the local SMC/ECM density and facilitating SMC movement (migration) through the ABM sites. Fig. 5illustrates the sequence of changes that are typically observed over several hours of simulation.Similar to describing the SMC, the total number of ECM sites, YECM, in the ABM, can be expressed using a continuous ODE model as follows:(4),∂YECM∂tc≅(Pproduction*−Pdegradation*)YSMCIf the number of SMC is stable, the proportion of SMC to ECM sites (Θ) is constant if the ECM degradation balances ECM production and be approximated as follows:(5)(1-Θ)[Θ22Pdegradation*+2Θ(1-Θ)Pdegradation*]=ΘPproduction.which gives(6)2(1-Θ)Pdegradation*=Pproduction.This initial model formulation is driven by the following 4 parameters:(7)0<Papoptosis,Pdivision,Pproduction*,Pdegradation*<1.Where an SMC can go either through exponential growth or extinction if (2) is not satisfied. Should the SMC become extinct, the one way coupling between the SMC and ECM kinetics will result in an ECM population that remains identical for all future time. In most scenarios, however, the system will reach an asymptote where the population of SMC and ECM is constant, and conditions (2) and (6) are satisfied. This solution, termed the basic solution, will provide the foundation for expansion of the model to include the influence of mechanical forces on SMC/ECM dynamics, approaching the complex behavior observed in implanted vein grafts.We are going to modify the 1D model with additional rules that take into account the impact of mechanical stress and shear stress at the lumen wall on the model. The reasoning will be however the same for the one dimensional model than for the two dimensional model described in the next section. Building on this core model, the complexity of the ABM is enhanced as follows:1. All probability rules will express a deviation from the equilibrium relation:(8)Pdivision=Papoptosis,βPdegradation*=Pproduction.Where β is adjusted numerically to provide a basic solution, which in the absence of mechanical forces maintains an assymptotic solution for the number of SMC/ECM in each layer. The basic solution is governed by two parameters:(9)Pdivision=α1>0,Pproduction=α2>0.where α1 and α2 are adjusted to match the time scale of cell division and extracellular matrix deposition.2. To incorporate the augmentation in biologic processes that occurs in the days to weeks after vein bypass graft implantation (Table 1), all intrinsic SMC and ECM activities are weighted by a time factor, A(t), using the following expression:(10)A(t)=exp{-((t-Ti)δTi)2}.This augmentation factor reaches its maximum at time Tiand decays with time scale Ti. This rules gives two parameters:(11)Ti=α3>0,δTi=α4>0.3. SMC biology is tightly regulated by the local mechanical environment, and major factor in defining the spatial variations in SMC/ECM density and biologic activity that characterizes the implanted vein graft. To incorporate these mechanical forces in the model, we hypothesize that it is the deviation from the base line shear stress – see Fig. 4 that drives the biologic response. To accomplish this, we define Δt as the deviation from a normal shear stress condition (i.e., Δτ=τ–τ0), and we will use Δσ for the deviation from normal tension.τ¯andσ¯are defined as fixed reference value for shear stress and wall tension, respectively, and used to normalize these parameters.4. Harvest and implantation of the vein graft leads to a transient activation of the endothelium. Secondary modulation of this activated state by the shearing forces at the blood-graft interface results in dampening or augmentation of the activation in response to elevated or reduced forces, respectively (Table 1). Proportional to this activation state is the endothelial production of a variety of growth factors, which induce transformation of the neighboring SMC from a quiescent to proliferative phenotype. To model this phenomenon, the biologic effect of the shear stress in the intima is assumed to decay exponentially, and the probability of SMC division modified using an activation and shear-dependent term as follows:(12)Δτ(y)=Δtwallexp{-((y-Rlumen)α8dSMC)},(13)Pdivision=α1A(t)(1+α6Δτ(y)/τ¯)(1+α7Δτwall/τ¯),while in the medial layer, the probability of cell division is independent of surface shearing forces, as follows:(14)Pdivision=α1A(t).We observed that our biological assumption and the probabilistic rules (13) & (14) are coherent with the BrDU experimental result in Fig. 2 obtained at the early stage of vein graft adaptation.5. In addition to their effect on proliferation, growth factors are potent chemo-attractants that promote SMC migration along their concentration gradient. As such, the early endothelial activation induces a one way flow of SMC in the luminal direction, effectively shifting the position of internal elastic lamina away from the lumen. To model this behavior, the probability that an SMC crosses from the media to intima (pthrough) is described as follows:(15)Pthrough=α5A(t)(1+α13Δτ(y)τ¯)(1+α14Δσr(y)σ¯),α5>0.Based on the morphologic analysis of vein grafts at the time of implantation, the initial position of the IEL is chosen to provide an intimal thickness of 2 ABM sites.6. Damage to the medial layer and SMC injury at the time of vein graft harvest is an unavoidable outcome of the procedure. This injury leads to a transient increase in programmed cell death (apoptosis) that we hypothesize is proportional to the radial (circumferential) wall tensile stress within the media, as follows:(16)Papoptosis=α1A(t)(1+α9Δσr(y)σ¯).The disorganized structure of the developing intima is thought to have limited load-bearing potential. As such, apoptosis in the intima is assumed to be independent of wall tensile forces, as follows:(17)Papoptosis=α1A(t)We observe that our biological assumption is coherent with the Tunnel experimental result of Fig. 2 obtained at the early stage of vein graft adaptation, since both mechanical tension and apoptosis rate growth with the distance from the endothelium.7. Extracellular matrix provides critical structural support to the vein graft, and the metabolism of these proteins are highly dependent on the local mechanical environment. Within the model, ECM production and degradation are assumed to be regulated by shear stress in the intima and tensile forces in the media, yielding the following expressions for ECM metabolism in the intima:(18)Pproduction*=α2A(t),(19)Pdegradation*=α2A(t)(1+α10Δτ(x)τ¯),and in the media:(20)Pproduction*=α2A(t),(21)Pdeg radation*=α2A(t)(1+α11Δσr(y)σ¯).It should be noted that all governing expression are defined as a deviation from the basic solution, focusing on the differences in the rate of gain or lost that is Papoptosis–Pdivision and P*production–P*degeneration respectively. Because the vectors of parameters {α5, α6, α7, α8, α9, α10, α11, α12, α13, α14} have no predefined sign, this set of axioms does not a priori specify the magnitude to which each of these biologic processes up or down regulate the SMC and ECM dynamic. The early activation of the vein graft plays an important role in both the transient and long-term structure of the graft. With the assumed exponential decay of A(t), the “equilibrium” configuration can be approximated as time goes to infinity, with δTidefining the time scale and Tidefining the time of peak activity for these transient perturbations. We conjecture that these two quantities provide important insights into the time at which the failing vein graft becomes clinically significant.A somewhat simplified one dimensional model was extensively tested against our experimental data in [30]. The main conclusion of this study is that the very small number of SMC and ECM involved to replicate the rabbit model with this one dimensional radial symmetric approximation is so small, that the noise of the stochastic system overcome the result. This is why it is rather essential to move on with a two dimensional model at least. We will present this construction next.To correspond directly with the cross-sectional, histologic data that will be used for validation, modification of the model into a two dimensional format is required. The expanded model uses a hexagonal grid of sites with three directions of symmetry and retains the general parameter framework described above. Major modifications in the algorithm (Fig. 6) for the integration of a two dimensional geometry are as follows:•Unlike the one-dimensional model, creation or loss of an element within the two dimensional, hexagonal grid structure presents multiple solutions for reorganization. While developing an organizational structure based on the first principles and mechanical equilibrium or a model of cell-cell contact are potential solutions, these methodologies are limited by the requirement for a non-structured ABM format and a high level of uncertainty. As an approach to this problem, we hypothesize that the reorganization on a regular grid pattern is dictated by the minimum mechanical energy needed to eliminate empty spaces or incorporate newly formed elements. We assume that the new cell (after division), or matrix element (after production) pushes surrounding elements along the shortest path that leads to an empty space, minimizing the number of SMC/ECM moves on the hexagonal grid (Fig. 7). In a similar manner, apoptosis of a cell or degradation of a matrix element is filled by the surrounding elements in a way that leaves no cell empty along the shortest path to an empty space. It is expected that this reorganization in the tissue might be trapped by a local optimum in the minimum path, and noise is introduced in the algorithm to overcome this problem. Even with this modification, the identified movements may be close to the minimum path but not necessarily the absolute global optimum solution.In the ABM model in two space dimension, lateral motion of cells at the interface with the lumen or external graft surface is required to prevent a singularity in the local force profile. This “smoothing” at the interfaces serves to increase the contact surface between elements (Fig. 8) and is applied at each time step of the algorithm (i.e., every hour). Interestingly, we have observed that this procedure does not preserve the circular shape at the interface as expected and may result in “mushroom-like” structures that are not observed in vivo. To mitigate this artifact, we assume that the intra-luminal blood pressure or surrounding external tissue applies a positive pressure on the wall toward the graft center. Consequently, elements are directed toward sites that are closer to the center of the graft and/or increase contact at the interface. The balance between these rules defines the extent of lateral migration that occurs at each time step and ultimately the relative uniformity of the vein graft geometry. Functionally, we have two parameters (ncontact and npressure) that define the number of times per time step that each rule is applied.Note that the flow disturbance in the lumen, as opposed to the standard uniform pressure, may have a different influence on the lumen shape. While integration with a fluid-structure interaction model could be used to determine the local drag forces, this refinement has not been implemented in the current derivation but will be important when the model is extended to three dimensions.•In the current model derivation, we have assumed that the probability of ECM degeneration is proportional to the number of SMC neighbors. Unlike the one dimensional case, ECM in a hexagonal grid can have up to six SMC neighbors. From our numerical observation with the two dimensional basic solution, SMC have the tendency to form cell clusters with the ECM inside these clusters being removed. To maintain the more uniform distribution that characterizes the intact graft, we have imposed a maximum cap on the number of SMC that will be considered to be capable of degrading an adjacent ECM element. Specifically, we define the probability for an ECM to be degenerated by an SMC to be proportional to the number of SMC neighbors up to four, with neighboring SMC greater than four having no additional effect on the probability of matrix degradation. It should be noted that this rule is completely heuristic and motivated by the observation of an “emergent property” of the ABM, suggesting that ECM degeneration in a biological system has a non-linear dependence on the local density of SMC.In the one dimensional case, the border between the intima and media (i.e.,-1 IEL) is defined to be one specific element in the ABM grid. SMC can migrate from the media to the intima through this interfacial element. In the development of the two dimensional model, we have assumed that the IEL maintains a circular geometry, and the IEL perimeter may either grow or contract by an increment δR. A new parameter α15 is introduced in the ABM model to model these shear dependent changes in the IEL geometry, with the probability of growth proportional to the increase of shear stress and the probability of contraction proportional to the decay of shear stress as follows:When the average displacement of the IEL is larger (or smaller) than one-half the thickness and/or the standard deviation of an element, the sites designated as IEL reset on the grid to correspond to a circle, defined by the mean radius of the previous quasi circular structure.•While fluid shear stress is applied only on the luminal surface (∂Ωlumen), the biologic effect of this shear stress (e.g. growth factor (G) and cytokine production) is transferred to the most superficial portions of the wall. A diffusion operator is used to model the effect of this shear stress as follows:Depending on the convexity and curvature of the lumen wall, the diffusion of growth factor will be automatically enhanced or reduced, versus the standard exponential decay in the direction normal to the wall.•Final Remark: we can indeed provide a much more complex model by adding module on demand. For example if we have a better understanding of the mechanism of recruitment of macrophage after graft implantation, and some data on how macrophage change specifically SMC activities, we can easily incorporate macrophage as cells moving on the top of this hexagonal grids with additional probability rules to be defined. Similarly we may start to introduce additional complexity by differentiating fibroblast from miofibroblast, etc. Part of the agile development of the model is to limit ourselves toward additional level of complexity when we do not have enough biological experimental data to back up the model. This is indeed a very dynamic process that is an outcome of the ongoing discussion between experimentalist and computational modeler.With a complete description of the two-dimensional ABM construct, integration with the mechanical model, detailing both flow and soft tissue mechanics, provides the environmental conditions to which the cells are exposed.Spatial variations in SMC and ECM kinetics leads to irregularities in the lumen contour and non-uniformities in the flow field, precluding an analytical approach to this problem. Also, the time scale for tissue plasticity (days to weeks) is sufficiently large compared to the frequency of cardiac pulsations (seconds) that we have assumed that the cells adapt to a time-averaged condition of the mechanical environment. Implicit in our approach is that the error induced by neglecting the nonlinear convective term in the Navier–Stokes equations and use of a steady flow solution (Fig. 10) is smaller than the level of uncertainty that characterizes the biology of the system.With these assumptions, we use a zero velocity boundary condition at the wall (∂Ωlumen) and the conservation of flux at the time scale of tissue plasticity(25)∫Ωlumenudydz=Flux ,to compute the steady potential flow inside the lumen driven by a constant pressure gradientdPdx(Fig. 10). From this potential flow solution, the equations for fully developed duct flow(26)d2udy2+d2udz2=1μdPdx=Ct,u|∂Ωlumen=0.are used to compute the normal shear stress component at the wall (τwall), where μ is viscosity. The solution for this problem can be computed from the solution of the standard Poisson problem(27)Δv(y,z)=-1,(y,z)∈Ωlumen,v|∂Ω lumen=0.so that(28)u=C0v,where C0is such that the flux is conserved. A finite volume scheme and an immersed boundary implementation of the no slip wall condition, v=0 on ∂Ωlumen is then used to compute v on a regular spatial grid.However, complexity to this solution is added by the implicit fluid-structure interactions that characterize this problem. This mandates that the potential flow should be computed in the geometry of the lumen under conditions of physiologic loading (i.e. the pressure difference between the lumen and the outward wall). We use the ABM solution to serve as the reference position for all SMC/ECM dynamical changes in the unloaded configuration. An inverse map of the displacement is then used to retrieve the wall shear stress for the unloaded geometry (Fig. 11). The approach used for determining the wall deformation associated with loading is described below.The ABM hexagonal grid is based on the unloaded model geometry and from a practical point of view generates the contour of the lumen (Xl, Yl) and EEL(XE, YE) using a non-dimensional, cell-based unit scale. Upon transferring this geometry to the tissue mechanic module, the data is converted to the dimensionalized, physical domain for the application to the standard numerical modeling techniques. A Neo-Hookean hyperelastic model [34] is then used to simulate the tissue deformation of the vein wall generated by the transmural pressure, where the strain energy potential (W) is given by:(29)W=μ12(J-2/3I1-3)+K2(J-1)2where I1is the first invariant of the left Cauchy-Green deformation tensor,μ1is the initial shear modulus of the material, K is the bulk modulus, and J is the determinant of the elastic deformation gradient. For the finite element simulation, the mesh of this two dimensional ring shape domain is generated by Gmsh [34], and uses a primary Delaunay triangulation. Based on our assumption of steady flow, a quasi-static method that neglects inertia terms is utilized. This mesh is passed to the finite element solver FEBio [34], which calculates an approximation of the tension at each node of the mesh of the vein graft using the following formula:(30)σ=[(λ1−λ2)2+(λ2−λ3)2+(λ3−λ1)2]2where λiare the eigenvalues of the stress or strain tensor of each point of the node in descending order.For simplicity we have restricted ourselves to a material in the wall that has uniform mechanical properties. All of these calculations correspond to conditions where Young modulus is 2000, poisson ratio is 0.49, shear modulusμ=3448Pa, bulk modulus K=33333Pa [34,35]. We have chosen a transmural pressure on the vein graft that provide a wall displacement of few percent, to be coherent with our observation. To be realistic all the parameters values we have chosen here are reasonable guess, and do not intend to represent a specific rabbit. This information is passed back to the ABM module, in the unloaded coordinate system, for further analysis.A summary of the coupling among the ABM, Flow and Tissue Mechanics modules is provided in Fig. 12.The ABM module passes the contour of the lumen (Xl, Yl) and EEL (XE, YE) to the Tissue Mechanic module. The Tissue Mechanic module subsequently returns the deformed shape of the vein graft (i.e. (Xl/, Yl/) and (XE/, YE/)) to the blood flow module and wall tension σ(XE/, YE/) to the ABM module. The Flow module calculates τ(Xl/, Yl/) and τwall(XE/, YE/) and returns this information back to the ABM module. Finally, the ABM module then updates the number of SMC/ECM based on the probabilistic rules associated with τwall(XE/, YE/) and σ(XE/, YE/).To reduce the computational complexity, both the mechanical modules use a quasi-steady approximation. In contrast, the ABM module is highly dynamic, on the time scale of hours to approximate the cell cycle. The coupling algorithm is adaptive with respective to time. The ABM module calls the two mechanical modules only when the lumen and external wall of the vein graft in the ABM change position enough to lead to a change of number of cells/matrices to a few percent (i.e. 2%).The modular construction of the model provides a format in which the mechanical elements can be readily substituted with more realistic solvers, such as an off-the-shelf commercial fluid dynamics code or a soft tissue mechanics model that is more specific to vein wall composition. Our experimental results to date would suggest that the uncertainty in the model is driven by the biologic variability, supporting our use of low-complexity approaches for the mechanical modules as a first-order approximation.To address the challenges in both agile development and efficient implementation of the computational model, we have pursued the following strategies:In the initial development of the model, the core structure was created in Matlab, to leverage the fast prototyping and provide a straight forward method to visualize the dynamic aspects of the ABM solution. Although the computing performance is compromised, this use of a meta language allowed for the rapid identification of coding errors and provided a useful tool for the efficient and tangible exchange of ideas within the research team. The ability to tune the performance of the model based on repeated feedback from vascular biologists and clinicians was critical in this early stage of development.Having obtained confidence in the model construct, the initial prototype was translated into a computer-efficient portable C code, to perform a first phase verification and create a parallel implementation that exploits the locality of data in the distributed memory. Facilitated by this parallel structure, the code was capable of evaluating the multiple paths that are implicit in an ABM with a large number of initial parameters. Among the challenges encountered during this second phase implementation was difficulty in debugging the hybrid ABM-PDE code (Section 4.6). While a variety of techniques (e.g. manufactured solutions) are available to identify errors in a standard PDE code [36], there are no such equivalent techniques in the evaluation of ABMs.Existing library components were integrated into the code to streamline model development. In particular, the computational mechanical codes are quite mature and were used as the foundation of the tissue mechanic and blood flow modules. As no specific model offers an ideal generic solution, competitive libraries were tested using the defined benchmark problems with established solutions. For example, the Neo-Hookean hyperelastic tissue mechanical module was tested against a radial symmetric analytical solution assuming linear elasticity [34]. The deformation of the lumen wall was tested through a range of lumen geometries and transmural pressures. As illustrated in Fig. 13, the numerical approximation of tension with the Neo-Hookean hyper elastic model is quite consistent with the analytical solution.In a similar manner, the numerical approximation of shear stress returned from the flow module was verified using a uniform, cylindrical geometry evaluated through a range of lumen diameters and flow rates. Notable in the implementation of the flow module was verification that the spatial resolution of the numerical grid provides an uncertainty on the shear stress that is significantly less than the level of noise in the stochastic ABM.Overall, the emphasis has not been on the parallel efficiency of the hybrid ABM-PDE code but on minimizing the duration of one complete cycle (4.6) and maximizing our confidence in the accuracy of the code. During this development, we found that it was particularly beneficial to use hardware components that match the characteristics of each module component. While an off the shelf mechanical code runs smoothly on a single server machine that has the capacity to accommodate the finite element mesh, the ABM model has intrinsic data parallelism that is more suitable to a large array of processors. Such a balanced implementation scheme has been examined by our group for a similar application [34].Among the many levels of parallelism that can be leveraged, the dominant factor corresponds to the large number of repetitive iterations that are needed to complete the simulation. Building a stochastic solution typically requires O(10) runs and exploring the non-linear sensitivity analysis relies on O(1000) parameter combinations, all of which can run simultaneously. In our current formation, we have utilized our past experience with BOINC [37] and/or Java Interface [38] to implement this parallelism. Implementing a master-slave architecture into the parallel version of the code, a single master processor is responsible for sending the parameter sets to the slave processors to perform the simulation. Transitioning from a matlab to a C code implementation provided an 11-fold reduction in the execution time of the ABM module. To evaluate this efficiency, we used the high performance computing cluster at the University of Houston, where each single core has 1.6GHz Intel Itanium 2 (×128) processor, 512 GB of global memory, and a red hat enterprise linux 5 operating system. Eighteen cores for the linear sensitivity analysis and 200 cores for the nonlinear sensitivity analysis were used simultaneously in these evaluations.The three primary modules of the model have very different arithmetic complexity. The ABM complexity varies linearly with the number of sites, while the finite element code for the structure has a higher level of arithmetic complexity. The potential flow corresponds to a Laplace solver and has nlog (n) complexity, where n is the number of unknown parameters. In the current simulation using the sequential code structure for a one month vein graft, the execution time for each of the modules is provided in Table 2. The largest share of our computational effort, in excess of one-thousand runs, was used to obtain the linear and non-linear sensitivity analyses. Further improvements in efficiency were obtained by leveraging the fact that the final solution for the vein graft geometry has a high degree of radial symmetry. Replacing the numerically-based tissue mechanic model with the analytical solution provided a one-third reduction in the cpu time required to complete the analysis Table 3.In this section, we are going to describe the step by step process that we followed to build some confidence on the model.Convergence of the basic solution was evaluated as a function of the number of simulations (Fig. 14). To that purpose, we have computed the mean number of the SMC and ECM population as a function of the number of runs of the ABM that is indeed a stochastic algorithm. An oscillating relaxation pattern was evident, with the stabilization of the solution by the fifth run.Not unexpectedly, the rate of convergence depends on the size of the model system. With a hexagonal grid of 120×120 sites, 15 runs were sufficient to reach a stable solution (Fig. 14) while larger (i.e. 240×240) grid converged by 10 runs.A sensitivity analysis was performed to identify those biologic processes that have a dominant effect on the vein graft adaptation. Specifically, the linear and nonlinear effects of each parameters on the number of SMC/ECM were independently evaluated.Starting with a linear sensitivity analysis around the basic solution state, the effect (deviation of mean, standard deviation from the basic solution) for a particular parameter is examined while fixing the other parameters at their baseline (i.e. basic solution) values. As such, the linear sensitivity analysis of SMC/ECM apoptosis/mitosis is based on the following formula:(31)P=P0(1+β*ττ¯),where P0 is the initial probability of SMC/ECM apoptosis, the ratio ofτ/τ¯is ∼1 (i.e. basic solution), and β={α5, α6, α7, α8, α9, α10, α11, α12, α13, α14, α15}. Note that, β ϵ (0, β0) where β0is a value of β such that (P−P0)/P0≤10%. With the ABM output being a distribution of values corresponding to each run, the numerical result is set as the mean and standard deviation of these values. The sensitivity of the result is then considered as non-neglect able when the difference of the outcome (with this 10% perturbation normalized ratio) is larger than the standard deviation for the non-perturbed (basic) solution.Using this approach, a subset of parameters, {α5, α7, α9} (Fig. 15(a)–(c)), demonstrated significant linear sensitivity, while changes in the remaining parameters induced only a limited influence on the SMC/ECM kinetics.The parameters α5, α7 and α9 are respectively related to the rate of SMC migration from media to intima, the SMC mitosis rate in intima, and the rate of SMC apoptosis in media. It is not surprising that these parameters are key to explain at the early development of vein graft major hyperplasia observed in low shear stress condition, as well as massive apoptosis observed in the media of vein graft exposed to high blood pressure.However, this linear stability result does not apply to later time, where complex nonlinear relationship between competing factors can lead to very different dynamic as shown in [23].Unfortunately, the local sensitivity analysis is limited to detecting incoherence in the model. Due to the complexity of the system, non-linear relationships are highly likely to be dominant drivers of model performance. A nonlinear sensitivity analysis, examining the combined effect of the parameter set and the probabilistic rules of SMC/ECM kinetics on model uncertainty, were used to further our understanding of these interactions. In this non-linear analysis, the flow module and the tension module from the analytical solution have been coupled with the ABM module, and the range of parameter values used were the same as those used in the linear analysis.A partial rank correlation coefficient (PRCC) analysis between the input and output variables was performed. The input and output matrices were rank transformed, and the correlation coefficient were calculated for each input to obtain the PRCC index [39].In Fig. 16, the PRCC parameters indices have been plotted for SMC/ECM inside intima/media. A positive index indicates a positive correlation, a negative index corresponds to a negative correlation, and the greater the index the more dominant the effect. We can conclude that the most dominant parameters are {α5, α6, α7, α9, α11}.Their positive and negative correlation can be verified by the axiomatic rules of ABM (Section 4.2). As for example α6 is positively correlated to SMC mitosis as suggested by the following rulePdivision=α1A(t)(1+α6Δτ(y)/τ¯)(1+a7Δτwall/τ¯),while α7 has inverse (or negative correlation in Fig. 15) relationship with the mitosis of SMC.Another important feature of this computational framework of the vein graft adaptation is that it can generate the standard feedback mechanism that leads either to restenosis or outward remodeling see Fig. 16.We observe then for each of these two feedback mechanism a logistic response that corresponds well to the dynamical system that model vascular adaptation in the radial symmetric case [23]. This is the first element of a cross validation between the models Fig. 17.However, reducing the motility of cells at the interfaces lead invariably to spatial pattern with strong dissymmetry.In this step by step construction of our computational model of vascular adaptation, we can now go one step further and explore extensive experimental validation to reduce this general model to a smaller system that can be controlled. But this in depth study goes far beyond the description of the computational framework that is the focus of this paper.

@&#CONCLUSIONS@&#
