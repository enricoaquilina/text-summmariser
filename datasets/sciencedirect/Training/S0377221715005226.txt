@&#MAIN-TITLE@&#
Scheduling operating theatres: Mixed integer programming vs. constraint programming

@&#HIGHLIGHTS@&#
We model the problem with mixed integer programming and constraint programming.The two models are presented in detail and compared on real data.We take into account the affinity relationships between surgical team members.

@&#KEYPHRASES@&#
Combinatorial optimization,Constraints satisfaction,Linear programming,OR in health services,Models comparison,

@&#ABSTRACT@&#
The daily scheduling of an operating theatre is a highly constrained problem. In addition to standard scheduling constraints, many additional constraints on human and material resources encountered in real life should be taken into account. These constraints concern the priority of operations, the affinities between surgical team members, renewable and non-renewable resources, various sizes in the block scheduling strategy, and the surgical team's preferences/availabilities. We developed two models in our research work, using mixed-integer and constraint programming respectively. These were compared using a real-life case in order to determine which one coped better with a highly constrained problem. A cross-comparison of the experimental results shows that the mixed-integer programming model provides a better performance using the weighted sum objective function than using the makespan minimization objective function. Conversely, the constraint programming model is better suited to the makespan minimization objective function than to the weighted sum objective function. The originality of this research lies on three levels: (1) two models are presented in detail and compared using real data; (2) constraint programming is used to schedule the operating theatre; (3) some new constraints are taken into account, such as the affinities between team members in the composition of surgical teams, and the priorities of patients such as diabetics.

@&#INTRODUCTION@&#
Health systems in many countries are in crisis. This situation is not new; what is new, however, is the awareness that if the current trend continues most health systems will no longer be viable by 2015 (IBM, 2006). Belgium is no exception to this trend, even though it is sometimes said to have one of the best healthcare system in the world. Its strengths are its almost complete coverage of the population (Durant, 2006), the dynamics produced by the global supply system and the actual delivery of care, the quality of health education and healthcare providers, and the increasing professionalization of the healthcare management structures (Itinera Institute, 2008). Nevertheless, Belgium is losing ground to other countries as regards the overall quality of its healthcare system. The country was ranked sixth in the Euro Health Consumer Index for 2013. First place went to the Netherlands, followed by Switzerland, Iceland, Denmark and Norway (EHCI, 2013). Healthcare systems are fundamental to European societies, making a huge contribution to human activity and hence economic development. Health and its preservation are human needs that everyone wants to obtain and maintain.During the 1960s and 1970s, the prosperous economic situation in Belgium allowed almost unlimited expenditure on health, which led to enough people being hired and enough material being bought to ensure the supply of good quality services. However, from the 1980s to the present day, major rationalizations have been undertaken focusing notably on hospitals.The research reported in this paper focuses on one of the central and most expensive of hospital activities: the management of operating theatres. The operating theatre in a hospital is composed of operating rooms and one recovery room. This research aims to help the operating theatre manager improve the organization of these facilities, in particular the assignment of surgical cases. The development of an efficient algorithm is required for assigning a set of surgical cases to operating rooms during a period (often a week). This weekly operating theatre planning and scheduling problem is solved in two phases. In other words, decisions are made at the tactical and then the operational level. First, a planning problem is solved to obtain the date of surgery for each patient, allowing for the availability of operating rooms and surgeons. Second, a daily scheduling problem is solved to determine the sequence of operations in each operating room (Fei, Chu, & Meskens, 2009).Managing the operating theatre is a complex task because surgical cases must be planned and scheduled so as to minimize the costs of operating rooms and satisfy the needs and requests of surgeons, anesthetists and nurses. Satisfying the patient's needs and managing the material resources must also be taken into account. Moreover, human and material resources are in limited supply, and legal regulations have to be fulfilled.Our study focuses on the daily scheduling of surgical cases at the operational level, taking into account human and material constraints. The role of human beings in the decision-making process cannot be ignored. The operating theatre employs various teams of workers (surgical, nursing, anesthetic, maintenance, etc.). Given the limitations on resources, scheduling their activities is crucial to the efficient performance of their work. Some constraints are linked to restrictions on the availability of resources: these include the opening hours of the operating rooms, the availability of surgeons, anesthetists and nurses, and the availability and numbers of surgical instruments, and recovery beds. Other constraints are linked to the specificities of the resources (e.g. the versatility of the operating rooms, staff qualifications). Similarly, just as the operating rooms may be dedicated to certain types of procedures, the medical staff may also be specialized. The operating theatre manager therefore has to try to harmonize resources and increase the versatility of the staff so as to optimize the use of the operating theatre.The daily scheduling of the operating rooms is a highly constrained problem. A recent review by Meskens, Duvivier, and Hanset (2013) suggests that very few studies of this problem have taken into account the constraints of both material and human resources. The only constraints on human resources which are normally considered are the number and availability of surgeons, stretcher-bearers and anesthetists and sometimes of nurses and surgeon assistants (Beliën & Demeulemeester, 2007; Fei et al., 2009, 2010; Guinet & Chaabane, 2003; Ghazalbash, Sepehri, Shadpour, & Atighehchian, 2012; Hashemi, Rousseau, & Pesant, 2014; Marcon, Kharraja, & Simonnet, 2003; Roland, Di Martinelly, Riane, & Pochet, 2010; Vijayakumar, Parikh, Scott, Barnes, & Gallimore, 2013; Wang et al., 2014). Recent works (Marques, Captivo, & Vaz Pato, 2012; Van Huele & Vanhoucke, 2014) also consider the surgeon's workload. A very small number of research papers have taken into account priorities between patients (Cardoen, Demeulemeester, & Belien, 2009a, 2009b; Min & Yih, 2010a, 2010b). In general, the material constraints taken into account are limited to the number of operating rooms, the availability of specific materials and the number of beds in the recovery room (Augusto, Xie, & Perdomo, 2010; Bulgarini, Di Lorenzo, Lori, Matarrese, Schoen, 2014; Fei, Meskens, & Chu, 2010; Ghazalbash et al., 2012; Kharraja, Hammami, & Abbou, 2004; Pham, & Kinkert, 2008; Santibanez, Begen, & Atkins, 2007; Testi & Tànfani, 2009; Vijayakumar et al., 2013; Van Huele & Vanhoucke, 2014). Stochastic aspects have been integrated by some authors in the planning and scheduling problem of operating theatre such as Denton, Viapiano, and Vogl (2007), Hans, Wullink, Van Houdenhoven, and Kazemier (2008), Min and Yih, 2010a, 2010b), Lamiri (2008), Lamiri, Xie, Dolgui, and Grimaud (2009).However, in real life other constraints are also very important and we propose in this research to take them into account. These include human constraints such as the priority of some surgical cases (for example, children and people suffering from diabetes should be scheduled at the beginning of the day), the preferences of surgeons, nurses and anesthetists, and material constraints such as the versatility of operating rooms and the availability of medical supplies.In particular, the affinity relationship between two persons who work on the same surgical cases has been taken into account in this research. This is an important constraint for team building that has not carried weight in previous research works (except in Meskens et al., 2013). It has frequently been noted that the same people work together every day in the operating room for long periods of time. A strong affinity in teamwork can generate synergy through a coordinated effort, and allows each member to maximize his or her strengths and minimize his or her weaknesses. Obviously, the surgical team's effectiveness contributes to better communication and so to quality and safety in the health care received by patients. A growing number of studies have demonstrated this point (Carney, West, Neily, Mills, & Bagian, 2010; Kurmann et al., 2010; Sekhar and Mantovani, 2015; Tibbs & Moss, 2014; Weaver et al., 2010).Each resource limitation included in an operating theatre management model leads to an increase in its complexity, in terms of the number of variables and/or the number of constraints and the computational time required to solve the optimization problem. In the case of highly constrained problems, however, where the solutions space might be narrow and fragmentary, exact methods could provide optimal solution within reasonable time. Constraint programming (CP) may also be another adequate tool for our highly constrained target problem. Indeed, the goal of CP is to solve problems when combinatorial optimization has to handle many variables and constraints.The major difficulty encountered in solving a combinatorial optimization problem is the explosion in the number of combinations as the number of variables increases. The main problem when considering such a huge set of combinations is the amount of computing hours or days required to find an optimal solution. This is not acceptable in the context of time-limited decision-making. However, unlike the classical mathematical approach, the constraint programming paradigm is based on “reasoning” about the constraints and is still efficient when a lot of constraints are involved. This is one of the reasons why we chose to use constraint programming. This method also has the advantage of providing the user with different modes of functioning when searching for a solution in the path tree of solutions (Krzysztof, 2003).Based on logic programming and graph theory, constraint programming is an alternative to mathematical programming for complex problems that have a slow convergence. It is also an efficient approach to solving and optimizing problems in the event of nonlinear constraints, logical statements, or non-convex solution space. This includes time-tabling problems, sequencing problems, and allocation or rostering problems (IBM ILOG, 2010). Constraint programming has been widely applied in industrial scheduling problems (Baptiste, LePape, & Nuijten, 2001; El Khayat, Langevin, & Riopel, 2006; Harjunkoski & Grossmann, 2002; Novas & Henning, 2014), but has rarely been used in the field of healthcare. Some perspectives in the literature have recommended the use of constraint programming for solving nurse rostering problems in operating theatres (Trilling, 2006), staff scheduling in healthcare (Bourdais, Galinier, & Pesant, 2003), and medical resident scheduling problems (Topaloglu & Ozkarahan, 2011). Recently, Hashemi et al. (2014) as well as Van Huele and Vanhoucke (2014) used constraint programming based on a column generation approach to resolve a surgery-planning and scheduling problem. Zhao and Li (2014) resolved a scheduling of elective surgeries problem in an ambulatory surgical center. They proposed and compared constraint programming and Mixed Integer Nonlinear Programming models to solve the scheduling problem. But the treated problem was not highly constrained. The authors did not take into account any human or material constraints.In order to demonstrate the advantages of applying CP to a highly constrained problem as against a traditional method, we compare a constraint programming model (CP-MOD) to a traditional mathematical programming one (MP-MOD).In our two models, new constraints have been taken into account, such as the priority of operations, the affinities between surgical team members, renewable and non-renewable resources, various sizes in the block scheduling strategy, and the surgical team's preferences/availabilities. The comparison between the two models is the main contribution.Following this introduction, the problem is defined mathematically in the second part of the paper, which sets out its notations and hypothesis. The third and fourth parts describe respectively the MP and CP scheduling models, and the fifth part compares the two models. This comparison is made on the one hand by the minimization of the makespan, and on the other hand by the minimization of the weighted sum of the completion time. Finally we present our conclusions and perspectives.In this research, we first need to describe mathematically the problem of daily scheduling of surgical cases. The time horizon is set to one day and divided into T time slots (t ∈{1..T}). In our implementation each time slot is fixed to 30 minutes, the most common divisor of the surgery durations that we collected from a field study. This temporal granularity is quite close to reality, but does not substantially increase the size of the search space. There is a set of R operating rooms. Each room will then be available for T time slots, which will correspond to free periods for the surgeons.In practice, there are two types of operations: elective operations, which are planned by the surgeon in consultation with the patient; and emergency operations, which — as their name suggests — are unplanned and arrive unexpectedly. In general, operations for emergency patients are performed in dedicated operating rooms; some of them are allowed to be scheduled together with elective operations, if patients’ clinical conditions are relatively stable. In our model, each operation included in the set of operations to be assigned is denoted by o∈Ω.A set of material and human resources is also required for each operation. Concerning human resources, the legislation requires the presence of at least one surgeon, one anesthetist, and two nurses for each surgical case. The affinity relationships between members of surgical team are taken into account. Some specialized works (Leach, Myrtle, & Weaver, 2011; Mazzocco et al., 2009; Weaver et al., 2010) showed that affinities in a surgical team had an impact on the performance of the team in terms of communication, cooperation, and coordination, which itself has a significant impact on the quality of care delivered to the patient. Their estimations are obtained by means of a field survey and interviews with the surgical staff. Since affinity relationships are not all evaluated equal between members, the lower value is thought to be acceptable to qualify a bilateral affinity relationship. Hence an overall evaluation of these bilateral affinity relationships will contribute to building efficient surgical teams.We make a distinction between renewable and non-renewable resources. Material resources can be renewable (Kρ) or non-renewable (Kυ). For example, sterile medical trays, which are a basic requirement for operations, need to be completely sterilized between uses, and so are non-renewable resources in the course of a day. Human resources are typically renewable resources (Kρ).We consider the existence of three kinds of priority for operations: High, Medium and Low. Operations with a high priority (set Ωb) start earlier than the other operations; they cover children, diabetics, ambulatory operations, etc. Operations with a low priority (set Ωe) are carried out later than the others, and are mainly infectious cases that contaminate the room and require more cleaning after the operation. We have also added preferential constraints related to the preferences of the surgeons for particular operating rooms and to the availability of human resources.The limited capacity of recovery beds is taken into account. In practice, the ratio of operating rooms to recovery beds is 1–1.5 (legal constraint), or 1–2 if precautionary measures are taken. The operation-recovery process is a two-stage no-wait flow-shop, so the scheduling of operating theatres should ensure that there will be at least one available recovery bed at the end of each operation. When no bed is (or will be) free at the end of the surgery, the operation is not (or will not be) performed. The patient can be transferred to the normal bed only after his/her recovery.The notations of input data used for the two models are listed below:ΩThe set of all the surgical casesOThe number of operations: O = | Ω |oAn operation: o∈ΩTThe set of time slots in a daytA time slot: t∈ΤΓThe set of operating roomsRThe number of operating rooms: R=| Γ |rAn operating room: r∈ΓSThe set of surgeonssA surgeon: s∈SAThe set of anesthetistsaAn anesthetist: a∈ANThe set of nursesnA nurse: n∈NΓsThe set of operating rooms allocated to surgeon sΩsThe set of operations allocated to surgeon sΩbThe set of operations with high priority that start earlier than the othersΩmThe set of operations with medium prioritiesΩeThe set of operations with low priority that start later than the othersOsThe number of operations allocated to surgeon s: Os = | Ωs |ObThe number of operations taking place at the beginning of the day (high priority): Ob = | Ωb |OmThe number of operation with medium priorities : Om = | Ωm |OeThe number of operations that take place at the end of the day (low priority): Oe = | Ωe |doThe duration of operation o (in number of time slots)ESoThe earliest start of operation o (time slots)LSoThe latest start of operation o (time slots)KρThe set of renewable resourcesKυThe set of non-renewable resourceskA resource: k∈{ Kρ ∪ Kυ }mokρThe quantity of the renewable resource k required by operation omokvThe quantity of the non-renewable resource k required by operation oMkρ(t)The quantity of the renewable resource k, available at moment tMkvThe quantity of the non-renewable resource k, available for the dayMS(s, t)The availability of surgeon s at time t: MS(s, t) ∈ {0, 1}MN(n, t)The availability of nurse n at time t: MN(n, t) ∈ {0, 1}MA(a, t)The availability of anesthetist a at time t: MA(a, t) ∈ {0, 1}BThe set of recovery bedsbA recovery bed: b∈BdboThe duration of the recovery after operation o (in number of time slots)B1,oBeginning of operation o, in an operating room (time slots)B2,oBeginning of recovery, in the recovery room, at the end of operation o (time slots)C2,oEnd of recovery of the operation o, in the recovery room(time slots)CmaxMakespan, end of recovery, in the recovery room, at the end of the latest operation o (time slots)AffSN(s,n)The affinity relationship between surgeon s and nurse n (∈{0,1})AffSA(s,a)The affinity relationship between surgeon s and anesthetist a (∈{0,1})AffNA(n,a)The affinity relationship between nurse n and anesthetist a (∈{0,1})AffNN(n1,n2)The affinity relationship between two nurses n1 and n2 (∈{0,1})As discussed above, three sets of operations were created: Ωb, containing all the operations that have to be carried out before the other operations; Ωe, containing those that have to be carried out after the other operations; and Ωm, containing those that have no special requirement. In addition, we can define the earliest/latest start times (ESoand LSo) for each operation when needed.Operations are defined by a set of characteristics. We assume that the duration of a particular operation, do, can be predicted in advance. Furthermore, for the comfort and safety of the patient, we assume that the operation starts as soon as possible (ESo) and no later than (LSo) (expressed in time slots).Renewable resources are available again once the operation terminates. For each operation, we know the quantity of renewable resource required by operationmokρ, and it will be compared to the amount of available resourceMkρ(t)at time t. Unlike renewable resources, consumed non-renewable resources cannot be reused by other following operations. Only the total use of each resource∑mokvis compared to the available quantity of the non-renewable resourceMkvfor the day.The availability of each surgeon is expressed in a matrix, MS(s, t). Table 1 gives an example of such a matrix, and shows that Surgeon 1 is available for operations from 10.30, Surgeon 2 between 8.00 and 10.30 and Surgeon 3 between 9.30 and 12.00. In the same way as for the surgeon, two availability matrices are given to describe respectively the availabilities of the anesthetist MA(a, t), and of the nurse MN(n, t).The affinity relationship for teamwork is expressed through an affinity matrix Aff(p1,p2), where each row and each column represents a person (a surgeon, an anesthetist, or a nurse). For each pair of persons, a score of 0–9 is assigned based on the preferences expressed by them (the lower of two unilateral notes). Mutual incompatibility is denoted by 0 and strong preference is denoted by 9. Several pretreatments are directly applied to this matrix before its use in the mathematical model through a Graphical User Interface. The full description of all these treatments lies outside of the scope of this paper. However, we may mention that their objective is to ensure the homogeneity of the values to a certain extent, and to ensure that there are sufficient non-null values to avoid any lack of teamwork with sufficient affinities.It might be possible to use the integer values in Table 2directly in the mathematical models. Then we need to ensure with appropriate constraints, that a team can be built if the average affinity value between the members is greater than a predefined threshold, which could be the median value5 between 0 and 9 for example. However, the average value may “hide” some dissatisfaction between members in the same team. In another solution, ensuring that the affinity criterion is linear, it might be possible to use a weighted sum of affinities ∑(ki × Aff(p1, p2)) between the members in the same team. However, this leads to the problem of choosing these weights ki. In order to ensure a minimum affinity between all pairs of the members in each team, we have chosen to transform the affinities into binary values using a threshold. Thus, the integer values are of no use as the input data of our mathematical models since the affinity matrix is only used to answer a binary choice: whether two persons will work together in a same surgical team. Directly using integer values cannot enrich the results of the models, but increases the computational burden. If the affinity score is greater than or equal to the threshold, then the two persons p1 and p2 will be happy to work together. Otherwise, the two persons will refuse to work in a same team. Obviously a high threshold may hinder team-building due to incompatibility between members. Therefore, if, for example, the threshold is set to 5, the affinity matrix described above can be transformed as follows (Table 3). The variables AffSA(s,a), AffSN(s,n), AffNA(n,a), AffNN(n1,n2) obtain their values from the transformed matrix. However, the value of this threshold has to be defined. Several approaches are possible. One of them consists in starting from a value that is equal to the average value of the team members' affinities, and transforming the matrix into a binary matrix. If there is no solution due to a lack of surgical teams, then we should try again with a lower threshold value (using, for instance, a dichotomy approach to compute the new value). If there is a solution and there is enough time to restart a resolution, then we can increase the threshold value and try to solve the problem with this value, and so on. The resulting approach is a tradeoff between a set of pretreatments and mathematical models. All basic tests are implemented in the pretreatment phase to simplify the mathematical modelling.A list of assumptions must be enumerated in order to complete the description of our framework:•No surgeon can operate on more than one patient at the same time. Similarly, no recovery bed can be occupied by more than one patient at the same time.All the scheduled patients are ready for their surgery on the given day.All scheduled operations have to be performed during the current day, i.e. no operation can be postponed.The induction time for each operation, and the post-operation clean-up after the operation, are included in the operating time.The recovery beds in the recovery rooms are identical; that is, the patient can be transferred to any available recovery bed.Once a surgical case has started in an operating room, it cannot be interrupted, i.e. there is no pre-emption.The time needed at the start of every work day to clean the operating rooms before all operations is not taken into account. The post-operation clean-up time (cleaning time after each operation) is included in the operating time. These ‘setup’ times are independent of the operating schedule. However, operations may be sequenced in a particular order, as mentioned above. For example, those which are particularly contaminating, such as iatrogenic infections, will be scheduled at the end of the day.The daily scheduling problem of the operating theatre can be mathematically formulated by a mixed integer programming (MP) model. The objective is to minimize the makespan of the generated work schedule.The operations have to be placed individually; each one is described by the number of time-slots for which it will take up a room over the operating duration. Within a room r, the duration of each operation is given by do, a group of consecutive binary variables showing the assignment of operation o in this room. Only the binary variables relative to the operation for the room in question and for the sequence of time slots occupied by the operation will be set to 1; the others are all set to 0. In this way, a three-dimensional (O operations, T time slots and R rooms) binary variables matrix is created. This matrix is represented by OTR(o, t, r). The use of such matrices is motivated by the fact that one of our objectives is to obtain the detailed schedule of each resource. As illustrated in Fig. 1, binary variables take the value 1 not only at the beginning of the operation but throughout its duration in a given room r.A number of other matrices are described for the members of the team and the recovery room.OTR(o,t,r) =1 if operation o is assigned at time t to operating room r0 otherwiseOTB(o,t,b) =1 if operation o is assigned at time t to recovery bed b0 otherwiseSTR(s,t,r) =1 if surgeon s is assigned at time t to operating room r0 otherwiseNTR(n,t,r) =1 if nurse n is assigned at time t to operating room r0 otherwiseATR(a,t,r) =1 if anesthetist a is assigned at time t to operating room r0 otherwiseThe formulation of the model can now be written as:(1a)MinimizeCmaxs.t.(1b)C2,o=B2,o+dbo−1(1c)Cmax≥C2,o(2)B1,o=(∑r=1R∑t=ESoLSo+do−1t.OTR(o,t,r))−(do.(do−1)2)do∀o∈Ω(3)B2,o=(∑b=1B∑t=ESo+doLSo+do+dbo−1t.OTB(o,t,b))−(dbo.(dbo−1)2)dbo∀o∈Ω(4)∑o=1OOTR(o,t,r)≤1,∀r∈Γ,∀t∈T(5)∑r∈Γs∑o=1OOTR(o,t,r)≤1,∀s∈S,∀t∈T(6)∑r=1R∑t=ESoLSo+do−1OTR(o,t,r)=do,∀o∈Ω(7)∑r=1R∑t=1T−do+1⌊∑τ=tt+do−1OTR(o,τ,r)do⌋=1,∀o∈Ω(8)∑o=1OOTB(o,t,b)≤1,∀b∈B,∀t∈T(9)∑b=1B∑t=ESo+doLSo+do+dbo−1OTB(o,t,b)=dbo,∀o∈Ω(10)∑b=1B∑t=1T−dbo+1⌊∑τ=tt+dbo−1OTB(o,τ,b)dbo⌋=1,∀o∈Ω(11)B1,o+do=B2,o,∀o∈Ω(12)B1,o1≤B1,o2+(1−∑t=ESo2LSo2+do2−1OTR(o2,t,r)do2)T,∀o1∈Ωb,∀o2∈Ωm,∀r∈Γ(13)B1,o2≤B1,o3+(1−∑t=ESo3LSo3+do3−1OTR(o3,t,r)do3)T,∀o2∈Ωm,∀o3∈Ωe,∀r∈Γ(14)∑r=1R∑o=1OmokρOTR(o,t,r)≤Mkρ(t),∀t∈T,∀k∈Kρ(15)∑r=1R∑o=1Omokυdo∑t=1TOTR(o,t,r)≤Mkυ,∀k∈Kυ(16)∑o∈ΩsOTR(o,t,r)≤MS(s,t),∀s∈S,∀t∈T,∀r∈Γs(17)STR(s,t,r)=∑o∈ΩsOTR(o,t,r),∀s∈S,∀t∈T,∀r∈Γs(18)∑r=1RNTR(n,t,r)≤MN(n,t),∀n∈N,∀t∈T(19)2×STR(s,t,r)=∑n=1NNTR(n,t,r),∀s∈S,∀t∈T,∀r∈Γs(20)∑r=1RATR(a,t,r)≤MA(a,t),∀a∈A,∀t∈T(21)STR(s,t,r)=∑a=1AATR(a,t,r),∀s∈S,∀t∈T,∀r∈Γs(22)STR(s,t,r)+NTR(n,t,r)−1≤AffSN(s,n)∀s∈S,∀n∈N,∀t∈T,∀r∈Γ(23)STR(s,t,r)+ATR(a,t,r)−1≤AffSA(s,a)∀s∈S,∀a∈A,∀t∈T,∀r∈Γ(24)NTR(n,t,r)+ATR(a,t,r)−1≤AffNA(n,a)∀n∈N,∀a∈A,∀t∈T,∀r∈Γ(25)NTR(n1,t,r)+NTR(n2,t,r)−1≤AffNN(n1,n2)∀n1,n2∈N,n1≠n2,∀t∈T,∀r∈Γ(26)OTR(o,t,r)=0,∀o∈Ω,∀r∈Γ,∀t∉[ESo,LSo+do](27)OTR(o,t,r)=0,∀s∈S,∀o∈Ωs,∀r∉Γs,∀t∈T(28)OTB(o,t,b)=0,∀o∈Ω,∀b∈B,∀t∉[ESo+do,LSo+do+dbo]The objective function (1a) and constraints (1b) and (1c) ensure minimization of the makespan of the operating theatre.The beginning time of an operation or a recovery is given by constraints (2) and (3). They allow us to locate the first value 1 of the variables OTR declared for the operation o in an operating room r or on a recovery bed b. Constraints (4) indicate that two operations cannot take place at the same time in the same operating room. Furthermore, there certainly exists an exact match between every operation and its surgeon. Thus, the operations allocated to each surgeon, selected from the set of surgeons S, are known in advance. Constraints (5) prevent any surgeon from conducting two operations at the same time in different operating rooms. Constraints (6) and (7) were introduced into the model to express the fact that an operation o has to take place over do consecutive time slots. Constraints (6) require the number of variables set to 1 to be equal to do, while constraints (7) specify that the variables set to 1 in this interval must be continuous, due to the fact that the integer division of the sum of consecutive 1 by do must be equal to 1. In this way, we ensure that there is only one string of consecutive 1, representing the operation (zero everywhere else). Constraints (8), (9) and (10) express the conditions at the recovery room stage, for instance the fact that there is only one patient at a time in a recovery bed, and that the variables OTB set to 1 have to be continuous throughout the interval of time dbo. Constraints (11) ensure continuity between two stages of the procedure; the expression on the left indicates the last OTR set to 1 at the operating stage of an operation, while that on the right represents the first OTB set to 1 at the recovery stage of the same operation.Constraints (12) and (13) are precedence constraints. Similarly, they express the timing requirements for the operations included in the sets Ωb and Ωe. High priority operations should start before those with medium priorities, but low priority operations after those with medium priorities. Constraints (14) and (15) represent the limits on the renewable and non-renewable resources. The difference lies in the fact that we have to weight these variables by the inverse of the duration of the operation to obtain comparable values. Constraints (16) and (17) express the availability of surgeon s at time t by MS(s, t). Similarly, constraints (18) and (20) are derived from constraints (16) and express the availability of nurse and anesthetist at time t by MN(n, t) and MA(a, t). Constraints (19) and (21) express the fact that a team consists of a surgeon, an anesthetist and two nurses. Constraints from (22) to (25) describe the implementation of affinity relationship in the model. Team members can work together only when all combinations Aff(p1,p2) are greater than or equal to the affinity threshold. Constraints (26) and (27) express that one operation performed by surgeon s should be placed in the time window between its earliest start time and latest end time, only in one of the operating rooms allocated to surgeon s. They also ensure that there is no operation planned when the surgeon cannot operate. Finally, constraints (28) ensure that post-operative recovery can only be placed in the time window between its earliest start time and latest end time.Constraints (7) and (10) should be linearized to be used with Cplex solver. One of the solutions is to replace each of the two constraints with three linear constraints and new decision variables. The equivalent constraints to (7) are designed as following.(7a)x(o,t,r)≥OTR(o,t,r)−OTR(o,t−1,r)∀o∈Ω,∀t∈T(7b)∑t=1T∑r=1Rx(o,t,r)=1∀o∈Ω(7c)OTR(o,0,r)=0∀o∈Ω,∀r∈ΓIn the same way, the equivalent constraints to (10) are designed as following.y(o,t,b)={1ifrecoveryafteroperationostartsattimetinbedb0otherwise(10a)y(o,t,b)≥OTB(o,t,b)−OTB(o,t−1,b)∀o∈Ω,∀t∈T(10b)∑t=1T∑b=1By(o,t,b)=1∀o∈Ω(10c)OTB(o,0,b)=0∀o∈Ω,∀b∈BAn overview analysis of MP model is performed to estimate the size of the scheduling problem. The number of decision variables depends on (o+s+n+a)*t*r+o*t*b, and the number of constraints are given in Table 4below. The size of the problem scales up quickly with the time-splitting scheme and the number of operations, surgeons, nurses, anesthetists, operating rooms, and recovery beds. A MP optimization engine will take a considerable amount of time to analyze the model's feasibility and to calculate the optimal solution in a fragmented solution space.Due to the limits introduced by the use of linearization in solving scheduling problems, the effectiveness of MP models is apparently not guaranteed, especially for large-scale problems. In contrast, constraint programming offers suitable modeling techniques to solve time-tabling and sequencing problems usually characterized by non-linear constraints, logical constraints, and incompatibility constraints. The CP engine is often used as a fast generator of feasible solutions, but takes a considerable amount of time in terms of finding optimal solutions. Detailed analysis will be described in the Section 5.Constraint programming deals not only with logical constraints used in constraint satisfaction problems (CSP), but also with mathematical constraints that are usually solved by classical approaches. A CP model is defined in three parts. The first part describes all decision variables; the second gives the domain for each of these variables, including discrete values; the third contains various sets of constraints, representing logical and mathematical relationships between variables.The operations are represented by interval variables instead of binary variables in MP-MOD. An interval variable represents an interval of time during which an operation is performed. In general, it is defined (see Fig. 2) by its inherent attributes, such as earliest start time, latest end time and duration, but its position in time or its start time are unknowns in CP-MOD. In contrast, an operation's start time in MP-MOD should be deduced from output results, once the optimal solution is found. The definition of interval variables for operations is given as follows (definition 29).(29)INTERVALoperation(oinΩ)inESo..LSo+do−1SIZEdoAn operation can be performed only when all human and material resources are brought together. A six-tuple <o,s,r,n1,n2,a> is proposed to represent team building for a given operation. The objective is to make a preselecting constraint that generates all possible surgical teams which satisfy affinity constraints. An instance of the six-tuple is composed of an operation o, the surgeon s who is capable to perform the operation o, an operating room r allocated to s, two nurses n1, n2, and an anesthetist a, with all (Aff(p1,p2) > threshold) satisfied. The set of all possible surgical teams can be expressed in terms of the definition (30). In the same way, the set of all operation-recovery combinations is obtained by the definition (31). These two definitions also considerably reduce the search space of the scheduling problem.(30)Teams={<o,s,r,n1,n2,a>|∀s∈S,∀o∈Ωs,∀r∈Γs,∀n1,n2∈N,n1≠n2,∀a∈A,AffSA(s,a)×AffSN(s,n1)×AffNA(n1,a)×AffSN(s,n2)×AffNA(n2,a)×AffNN(n1,n2)>0}(31)Recovery={<o,b>|∀b∈B,∀o∈Ω}In one of the solutions generated by the CP-MOD, only one six-tuple per operation will be present. The others, having not satisfied all constraints and the objective function, are absent. This can be expressed by a Boolean function (32).(32)presenceOf(x)={true,∀x∈Teams,xispresentfalse,∀x∈Teams,xisabsentAny given resource, no matter whether it is a human resource, an operating room or a recovery bed, can be used at moment t by only one operation or one patient, so there is no question of overlap between two operations in the schedule of a resource above. However an overlap is allowed when two operations use different resources. Here, all individual schedules of these resources are defined as follows, but no-overlap constraints will be added in the model's section below. Definitions from (33) to (37) give different schedules for surgeon s, nurse n1, n2, anesthetist a, operating room r, and recovery bed b as soon as a feasible solution found.(33)Sched(s)={operation(x)|∀x∈Teams,presenceOf(x),x.s=s}∀s∈S(34)Sched(n)={operation(x)|∀x∈Teams,presenceOf(x),x.n1=norx.n2=n}∀n1,n2∈N(35)Sched(a)={operation(x)|∀x∈Teams,presenceOf(x),x.a=a}∀a∈A(36)Sched(r)={operation(x)|∀x∈Teams,presenceOf(x),x.r=r}∀r∈Γ(37)Sched(b)={operation(y)|∀y∈Recovery,presenceOf(y),y.b=b}∀b∈BThe availabilities of each member in a surgical team are expressed by a stepwise function. A typical stepwise function, denoted by stepwise(i in 1..n) {Value[i] → Time point[i]} is often used to model the availability or the use of a resource over time. An example of a stepwise function is illustrated in Fig. 3. Using its concept, the functions from (38) to (40) respectively express the availabilities of surgeon, nurse and anesthetist in time.(38)Avail(s∈S)=stepwise(t∈T){Ms(s,t)→t;0}={Ms(s,1),t<1Ms(s,i+1),∀i∈[1..n−1],∀t∈[ti,ti+1)0,t>tn}(39)Avail(n∈N)=stepwise(t∈T){Mn(n,t)→t;0}(40)Avail(a∈A)=stepwise(t∈T){Ma(a,t)→t;0}However, the availabilities of renewable resources cannot be described by a simple stepwise function. The quantity of a renewable resource is reduced at the beginning of an operation and restored at the end of it. Two additional functions are introduced to model the consumption and the production of a cumulative resource. The value of function stepAtStart(o,h) changes to h at the start of an interval variable, an operation o in our case, while the value of stepAtEnd(o,h) changes at the end of the operation o. Therefore, a function Qty(k) is given in (41) to express the available quantity of renewable resource k over time (Fig. 4).(41)Qty(k∈Kρ)=stepwise(t∈T){Mkρ(t)→t;0}−∑o∈ΩstepAtStart(o,mokρ)+∑o∈ΩstepAtEnd(o,mokρ)The CP-Model of the daily scheduling problem is introduced below.(42)MinimizeMax(endOf(o))∀o∈Ωs.t.(43)¬(start(δ1)<start(δ2)<end(δ1))⇔noOverlap(Sched(β))∀δ1,δ2∈Sched(β),∀β∈S∪N∪A∪Γ∪B(44)presenceOf(∀x1∈Teams,x1.o=o)⇒¬(∃x2∈Teams,x2.o=o,x2≠x1,presenceOf(x2))∀o∈Ω(45)presenceOf(∀y1∈Recovery,y1.o=o)⇒¬(∃y2∈Recovery,y2.o=o,y2≠y1,presenceOf(y2))∀o∈Ω(46)End(operation(x))+1=Start(recovery(y))∀x∈Teams,∀y∈Recovery,x.o=y.o(47)End(operation(x1))≥Start(operation(x2))∀x1,x2∈Teams,x1.r=x2.r,(x1.o∈Ωb,x2.o∈Ωm)or(x1.o∈Ωm,x2.o∈Ωe)(48)presenceOf(x)⇒Avail(s)∧Avail(n1)∧Avail(n2)∧Avail(a)=1∀x∈Teams,x.s=s,x.n1=n1,x.n2=n2,x.a=a,start(operation(x))≤t≤end(operation(x))(49)Qty(k)≥0∀k∈Kρ∪KυThe objective function (42) ensures minimization of the makespan of the operating theatre. The function endOf(o) gives the end of recovery of the operation o, and we have endOf(o) = C2,o. Constraints (43) are used to indicate that no overlap is allowed between two operations inside an individual schedule of any resource, such as surgeon, nurse, anesthetist, operating room, and recovery bed. Constraints (44) and (45) state that for a given operation, the presence of one surgical team and one recovery bed is exclusive in a generated solution, hence there does not exist another alternative that is admitted at the same time. Constraints (46) and (47) are precedence constraints. Constraints (46) ensure that recovery starts as soon as the operation finishes. Constraints (47) express that operations with higher priority should start before those with lower priority. Constraints (48) are used to ensure that a six-tuple can be chosen into a feasible solution only if all necessary human resources are available during the whole period of operation. Finally, Constraints (49) concern the available quantity of renewable and non-renewable resources.There are various ways to model this daily scheduling problem, and the choice of modeling is crucial to the performance of the model. Our MP and CP models have been optimized but remain accurate to the real world constraints. The comparison between these two models is based on our choice of modeling that aims at testing their respective abilities.First, the decision variables are defined in different ways. Binary variables are used in the MP model to describe each of the five decision variables in a three-dimensional matrix. The core element of this daily scheduling problem, the operations, is represented by a sequence of OTR (o,t,r). However in the CP model, an integrated interval variable is sufficient to describe an operation.In order to ensure that an operation is correctly represented in output results, Constraints (6) and (7) should be introduced into the MP model. Furthermore, additional variables and constraints have been developed for the purpose of obtaining linear constraints. In the case of linear programming, where the solver accepts only linear constraint and linear objective function, linearization becomes a major obstacle to the modelling work at a conceptual level. There is no guarantee that equivalent and efficient linear constraints can always be found. None of these issues matter in the CP model.Second, the constraint section of the CP model takes into account only some precedence and overlap constraints; all the others, like affinity constraints from (22) to (25) in the MP model, can be directly integrated into the definitions of team tuples (30). This can significantly reduce the search space of the daily scheduling problem. In addition, the start time of each operation, defined by (2), becomes an inherent unknown of the interval variables; the availability constraints (16) (18) and (20) can be replaced by (38), (39) and (40) in the CP model. Constraint programming using logical operators, variables, and expressions is much more intuitive for the modelling work of scheduling problems, compared with mathematical programming.

@&#CONCLUSIONS@&#
