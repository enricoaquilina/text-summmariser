@&#MAIN-TITLE@&#
A multi-center milestone study of clinical vertebral CT segmentation

@&#HIGHLIGHTS@&#
The first multi-center milestone comparative study for vertebra segmentation methods.Objectively evaluate the performance of state-of-the-art vertebra segmentation algorithms.Construct a publicly available annotated reference data set for spine labeling and segmentation.

@&#KEYPHRASES@&#


@&#ABSTRACT@&#
A multiple center milestone study of clinical vertebra segmentation is presented in this paper. Vertebra segmentation is a fundamental step for spinal image analysis and intervention. The first half of the study was conducted in the spine segmentation challenge in 2014 International Conference on Medical Image Computing and Computer Assisted Intervention (MICCAI) Workshop on Computational Spine Imaging (CSI 2014). The objective was to evaluate the performance of several state-of-the-art vertebra segmentation algorithms on computed tomography (CT) scans using ten training and five testing dataset, all healthy cases; the second half of the study was conducted after the challenge, where additional 5 abnormal cases are used for testing to evaluate the performance under abnormal cases. Dice coefficients and absolute surface distances were used as evaluation metrics. Segmentation of each vertebra as a single geometric unit, as well as separate segmentation of vertebra substructures, was evaluated. Five teams participated in the comparative study. The top performers in the study achieved Dice coefficient of 0.93 in the upper thoracic, 0.95 in the lower thoracic and 0.96 in the lumbar spine for healthy cases, and 0.88 in the upper thoracic, 0.89 in the lower thoracic and 0.92 in the lumbar spine for osteoporotic and fractured cases. The strengths and weaknesses of each method as well as future suggestion for improvement are discussed. This is the first multi-center comparative study for vertebra segmentation methods, which will provide an up-to-date performance milestone for the fast growing spinal image analysis and intervention.

@&#INTRODUCTION@&#
The vertebral column, also known as spine, is a bony skeletal structure forming the central weight-bearing axis of the human upper body. Multiple medical imaging modalities, such as radiographs, CT, MRI and PET, are used to evaluate spine anatomy and diagnose spinal pathology. Using current generation of scanning techniques, CT is the most spatially accurate modality to assess the three dimensional morphology of the vertebra. Spine segmentation is a fundamental step for most subsequent spine image analysis and modeling tasks, such as identification of spine abnormalities (e.g. vertebral fractures [1]), image-based biomechanical modeling (e.g. load analysis [2]) or image-guided spine intervention (vertebral fusion [3]). The accuracy of the segmentation is demanded in some analysis. For instance, image-guided spine intervention often requires sub-millimeter precision. Manually segmenting a vertebra is time consuming and subjective. Fully automated or semi-automated methods are required for most clinical applications.Vertebra segmentation is challenging due to the complex shape and variable architecture of vertebrae across the population, similar structures in close vicinity, pathology, and the spatial inter-relation between vertebrae and ribs. In recent years, a number of spine segmentation algorithms for computed tomography (CT) images have been proposed. In early work, segmentation of vertebrae was achieved by unsupervised image processing approaches such as adaptive thresholding, region growing and boundary adjustment (Kang et al. [4]), or region-based segmentation such as watershed (Li et al. [5]) and graph-cut (Aslan et al. [6]). Level set methods had also been adopted since they can handle the complex topological merging and breaking in the vertebrae. Lim et al. [7] included the Willmore flow in a level set framework to guide a surface model evolution. Huang et al. [8] combined edge- and region-based level set functions for vertebra segmentation on CT images. Li et al. [9] proposed an automatically initialized level set method based on hybrid morphological filter and Gaussian mixture model to deal with the topological variation. In region-based techniques, Blumfield et al. [10] devised a statistical and heuristic methods to detect key features for vertebral body segmentation. Yao et al. [11] presented a technique based on watershed algorithm, directed graph search, curved reformation and vertebra template to automatically partition and segment the spinal column. Naegel et al. [12] applied mathematical morphology and watershed for the labeling and segmentation of vertebrae.More recent methods were mostly based on geometric models, statistical anatomical models, or probabilistic atlas. The models incorporated prior knowledge about the vertebra anatomy. Furthermore, the statistical models estimate the mean shape and variation of a vertebra from a training set of segmented vertebrae. The models were fit to the target image data either through forces derived from the image or via a deformable registration framework. These models are often sensitive to the initial pose estimation, which are done either manually or automatically. The manual initialization may be performed by placing seeds within the vertebral body [13] or drawing bounding box to restrict the searching range [14]. Automatic initialization had also proposed via detecting the spine curvature and inter-vertebral disk [11]. Klinder et al. [15] proposed a method, by integrating detection, identification, and segmentation of vertebrae in a single framework. The method was based on spinal curve extraction and statistical shape models (SSM). The method proposed in Ma et al. [16] was based upon bone-structure edge detectors and coarse-to-fine registration of a deformable surface model for the thoracic spine. Both shape and pose statistics were incorporated in Rasoulian et al. [17] in a multi-vertebrae model for lumbar spine segmentation. Kim and Kim [18] proposed a deformable fence model to separate lumbar vertebrae and surrounding tissues. Individual vertebra was modeled in an articulated spine model with a low-dimensional manifold representation and inferred the model using high-order Markov random fields (Kadoury et al. [19]). The vertebrae were clustered into sub-groups using manifold learning and a linear point distribution model was constructed for each sub-group. Ibragimov et al. [20] built landmark-based shape representations of vertebrae using transportation theory and aligned the model to a specific vertebra in three-dimensional (3D) CT images using game theory. Part-based models and active shape models were used in Roberts et al. [21] to divide the vertebra into several parts and conducted the segmentation collaboratively. The model was applied on 2D radiograph images and can be extended to 3D. Stern et al. [22] proposed a 3D superquadric model for the segmentation of just the vertebral body. Multi-atlas with joint label-fusion had showed promising results in the segmentation of several anatomical organs including vertebrae. Wang et al. [23] applied the atlas approach in the segmentation of osteoporotic vertebrae with compression fractures. Ghebreab and Smeulders [24] constructed a deformable integral spine model encoded as a necklace model by learning the appearance of vertebrae boundaries from a set of training images.More recently, machine learning techniques had been applied in the segmentation of vertebrae. Huang et al. [25] applied a statistical learning approach based on Adaboost for vertebra detection and an iterative normalized cut algorithm for boundary refinement. Suzani et al. [26] proposed a deep learning scheme to automatically localize, identify and segment vertebral body in MR images. Mirzaalian et al. [27] combined a probabilistic boosting tree classifier for initialization of statistical shape models for segmentation.Most of the published methods reported fairly accurate results (1.12±1.04mm point-to-surface error reported in Klinder et al. [15]). Table 1summarizes the performance of some recently published methods, including number of cases, performance metrics by DICE coefficient and average surface distance, targeted subjects, and initialization methods. All information is directly extracted from the published peer-reviewed papers. However, these algorithms were mostly evaluated on different data sets with various degrees of difficulties and are not publicly available. This precludes direct comparison of the results and access to the data, and therefore, their performances were not independently verified.In order to objectively compare different segmentation algorithms, it is necessary to establish standardized reference data and validation criteria. Quite a few challenge frameworks have been developed in the past few years for several medical image analysis problems. A dedicated website at http://www.grand-challenge.org has the most complete list of organized challenges since 2007, including those focusing on liver, lung, brain and heart, amongst others. Thus far, there is no grand challenge focusing specifically on spine image analysis.This paper presents a milestone comparative study of the vertebra segmentation. The first stage was a challenge held at the 2014 International Conference on Medical Image Computing and Computer Assisted Intervention (MICCAI) Workshop on Computational Spine Imaging (CSI 2014), and the second stage was evaluation on more challenging clinical cases. The objective to organize this vertebra segmentation comparative study was three-fold. First, we wanted to provide a platform to objectively evaluate the strengths and weaknesses of various spine segmentation algorithms; second, we intended to construct an annotated reference data set for spine labeling and segmentation; and third, we want to assess current state-of-the-art segmentation accuracy for vertebra and its substructures. The details of the organization of the comparative study can be found at the website (http://csi-workshop.weebly.com/).The data sets used in the comparative study were acquired at the University of California, Irvine, Medical Center (Orange, CA, USA), between March 2013 and May 2013. The study received Institutional Review Board approval, and was compliant with the Health Insurance Portability and Accountability Act. As the study was performed as a retrospective analysis of previously obtained imaging studies, informed consent was waived. The data sets were manually selected by a radiologist with eight years of experience according to the following selection criteria: thoracic and lumbar spine column scanned. All patients were scanned using a spine CT protocol, where a small field of view centered at the spine was reconstructed. The scanning parameters included 0.7–2.0mm slice thickness, 120kVp, soft tissue reconstruction kernel, and intravenous contrast. The volumes completely covered the thoracic and lumbar part of the spine and were scanned as a single continuous CT data set at high spatial resolution.Following these data characteristics, we collected twenty data sets for the comparative study, ten for training and ten for testing. The training cases were provided before the participants entered the workshop challenge (January, 2014). The testing sets were provided in two stages after the participants entered the challenge. In the first stage, five cases from healthy young individuals (20–34 years, mean 27 years) were provided. In the second stage, the participants were invited back to test on five cases from an osteoporotic cohort (59–82 years, mean 73 years) that has been previously identified to have at least one vertebral compression fracture. In the osteoporotic set, 16 vertebrae were identified with a compression fracture (one with grade 1 Genant score, ten with grade 2, and five with grade 3). Examples of the two testing sets are shown in Fig. 1. All data were anonymized and made available in Meta format (MHD/raw). The data sets and related codes are open to public and released on SpineWeb (http://spineweb.digitalimaginggroup.ca/spineweb/index.php?n=Main.Datasets), a collaborative platform for research on spine imaging and image analysis. The details of the training and test data sets are listed in Table 2. The test sets from healthy young individual were intended to assess the baseline performance and the more difficult diseased cases for evaluating the accuracy of state-of-the-art vertebra segmentation algorithms.The reference segmentation data was generated in two stages. First, the initial segmentations were obtained using a fully automatic algorithm reported in [11], which was based on adaptive thresholding, watershed, directed graph search, and connected component analysis. The obtained segmentations were then manually corrected and refined by a medical fellow and a research fellow using customized software that was developed for the manual correction. In the reference data, each vertebra was assigned a unique label and the background (pixels other than vertebrae) was assigned label 0. We created reference segmentation for every vertebra, for both thoracic (T1–T12) and lumbar (L1–L5) spines. A reference segmentation file was saved in Meta data format [28] for each data set with the same resolution as the original CT image file. The reference segmentations for the test sets were based on consensus reading of two operators. Fig. 1 shows examples of the reference labels in the sagittal plane and the 3D surface model generated by the reference segmentation for both a healthy case and an osteoporotic case.Since the release of the training data there have been over 60 requests or downloads of the training data from SpineWeb. Five teams entered the comparative study held at the Computational Spine Imaging Workshop (CSI 2014). Among the participants, four teams segmented both thoracic and lumbar vertebrae, and one team segmented only lumbar vertebrae.The five participating algorithms are dubbed as Method 1 [29], Method 2 [30], Method 3 [31], Method 4 [32], and Method 5 [33] in this paper according to the order of the submission. The titles of the five methods are listed in the references. The following is a brief description of each participating method.Method 1 [29] is an atlas-based technique and consists of four steps: pre-processing, initial alignment, non-rigid registration and label fusion. N spine atlases (image data with corresponding label data) are used to segment thoracic and lumbar vertebrae as imaged in a target data set. In the pre-processing step, consisting of spinal canal tracking, disc detection, and vertebra position and rotation estimation, an approximate position and rotation (pose) of each vertebra in all data sets are estimated. The results from the pre-processing are used to obtain an initial alignment between each of the N atlases and the target data set. The initial alignment can either be for the whole spine or computed per vertebra. This is followed by a registration step, where the vertebrae of each atlas are registered to the target data set using non-rigid registration (minimizing the local phase-difference). This step is performed on a group of three vertebrae. The computed transforms are used to transform corresponding label sets. The transformed labels are combined to a single label volume using label fusion (majority voting) to form the segmentation of the vertebrae as imaged in the target data set.Method 2 [30] is based on a statistical multi-vertebrae shape+pose model which is registered to the bony edges of the spinal column as extracted from the CT volume. For construction of the model the idea is to analyze the pose and shape statistics separately as they are not necessarily correlated and are not formulated in the same parameter space. Training data is collected for every vertebra (in this case T1 to L5) and is used to build individual sub-models each containing three neighboring vertebrae and the ensemble of all models covering the whole spinal column. Segmentation using one of these statistical multi-object shape+pose model can then be formulated as a registration problem where the model is registered to the bone edge point cloud extracted from the CT volume by optimizing the model parameters using the expectation maximization (EM) algorithm. Successive registration of the individual sub-models starting from a user-specified initial vertebra finally results in the segmentation of the spine.Method 3 [31] uses a variational segmentation framework which is derived from a convex formulation of 3D geodesic active contours for individual vertebra segmentation. In this formulation the weighted total variation (TV) norm is combined with prior bone intensity and shape information. For bone intensity prediction, normalized foreground (bone) and background histograms are learned from annotated training data. Each voxel of a test image is classified accordingly using the log-likelihood ratio. Prior shape knowledge in terms of a mean shape is obtained by registering the set of binary training vertebrae representations and final averaging. To account for variation in shape along the spine, mean shape representations for upper thoracic, lower thoracic and lumbar spines are calculated separately. At testing time, the learned mean shape is registered to a binary representation of the bone prior to get a rough location of the vertebrae. The final energy formulation expressed in a variational framework obtains a segmentation by combining bone prior, registered shape prior and the weighted TV norm which accounts for both edge magnitude and edge direction of the respective image.Method 4 [32] consists of two parts: vertebra detection and vertebra segmentation. An interpolation-based optimization approach is applied to detect the whole spine and individual vertebrae in an unknown CT spine image by using a spline-based interpolation function on an equidistant sparse optimization grid and a dimension-wise computational complexity reduction algorithm to obtain the optimal translation, scaling and rotation parameters of the rigidly align vertebra shape models. The obtained detection results represent a robust and accurate initialization for vertebra segmentation, built upon the existing shape-constrained deformable model approach. The proposed iterative segmentation consists of finding distinctive vertebra boundaries by applying Canny edge operator and random forest regression model of image intensities and intensity gradients, and of deforming the vertebra shape model so that it fits the obtained vertebra boundaries while preserving shape topology.In Method 5 [33], a statistical shape models (SSM) of each lumbar vertebra was previously created from an independent dataset of 30 lumbar spines with no evident osteological pathologies. From manually placed intervertebral discs centers, the similarity transformation parameters of each vertebra are computed to initialize the vertebra shapes. The segmentation is performed by iteratively deforming a mesh inside the image intensity and then projecting it into the SSM space until convergence. Afterwards, a relaxation step based on B-spline is applied to overcome the SSM rigidity. The deformation of the mesh, within the image intensity, is performed by displacing each landmark along the normal direction of the surface mesh at the landmark position seeking a minimum of a cost function based on a set of trained features.The technical comparisons of the five methods are detailed in Table 3. The comparisons are conducted in six aspects: vertebral localization, segmentation strategy, bundled model, registration/optimization, image feature, and running time. Methods 1 and 4 comprise steps to automatically initialize the location of vertebrae. Methods 2, 3, and 5 require manual initialization of the model, either at the center of vertebral bodies or at the center of intervertebral discs. The automatic initializations of Method 1 and 4 were self-claimed by the participants and not verified. All methods are based on certain types of shape and intensity models. Method 1 uses multiple atlases directly derived from the reference data. Method 2 uses a statistical shape+pose model built from 87 training volumes incorporating variations of both shape and pose across the population. Both Methods 3 and 4 use mean shape models from the training data. Method 4 builds a model for each vertebra level, while Method 3 builds one model for each section of the spine (one for T1–T6, one for T7–T12, and one for L1–L5). Method 5 computes a statistical shape model from 30 training models for each vertebra level. In Methods 1 and 2, adjacent vertebrae are bundled together (5 vertebrae in Methods 1 and 3 vertebrae in Method 2) in the segmentation. Different registration/optimization frameworks were adopted in the methods. Method 1 first applies a non-rigid registration for each atlas and then performs a label fusion. Method 2 conducts an EM algorithm to optimize the model. Method 3 adopts a total variation framework. Surface mesh deformation and reconfiguration is performed in Method 4. Method 5 employs statistical shape deformation plus B-spline relaxation for surface optimization. Different feature functions are used in the methods for the optimization. They are mostly based on edge point and intensity models. The running time was reported by the participating teams (Table 3). It can only be viewed as a reference, since the algorithms were run on different hardware platforms and some have been optimized by graphics processing units (GPU).

@&#CONCLUSIONS@&#
