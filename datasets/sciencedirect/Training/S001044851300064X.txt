@&#MAIN-TITLE@&#
A feature-based method of rapidly detecting global exact symmetries in CAD models

@&#HIGHLIGHTS@&#
A feature-based method is proposed to rapidly detect the symmetries in CAD models.A study on the relationship between feature information and symmetries is conducted.How to determine the symmetries of the Boolean combinations of features is framed.Symmetries of numerous CAD models have been successfully detected by our approach.

@&#KEYPHRASES@&#
CAD,Symmetry detection,Design feature,Merging symmetries,Verifying symmetries,

@&#ABSTRACT@&#
Detecting global exact symmetries in CAD models is of great importance in the research of CAD/CAE integration. Therefore, a method is proposed in this paper to rapidly detect the global exact rotational and reflectional symmetries in feature-based CAD models. The theories of determining the symmetries of the Boolean combinations of the features are framed. Based on these theories, our approach is processed as follows. First, the features of the CAD models are classified into congruent feature sets. Next, through the study on the relationship between feature information and the symmetries of features, by using only feature information, as many symmetries of the feature sets as possible are detected. Then these feature sets are sorted into an ordered sequence. Finally, symmetries of the entire model can be derived by successively merging and verifying the symmetries of feature sets in the ordered sequence. Experimental results show that the global exact symmetries can be robustly and rapidly detected.

@&#INTRODUCTION@&#
Product symmetries are of great significance from the design stage to the downstream processing stages, such as manufacturing and engineering analysis. Therefore, detecting symmetries in CAD models is one of the most important issues in the integration studies of CAD/CAE/CAM. Firstly, detecting symmetries is of high importance in the analysis of design aesthetics. Secondly, symmetric partitioning can be achieved by recognizing the symmetries of the CAD models, which greatly reduces the scale of a finite element analysis. Thirdly, detecting symmetries can be used to optimize the manufacturing process, e.g. it can help locate the machining and assembly arms when the product needs to be machined and assembled. Lastly, in reverse engineering, analyzing symmetries can be used to detect the design intent of the CAD models.Symmetries can be classified, in terms of the symmetry range, into global symmetries and local symmetries. A global symmetry is an isometry that maps the set onto itself. A local symmetry is an isometry that maps one portion onto another portion of the set. As for the symmetric extent, an approximate (or exact) symmetry is an isometry that maps the set approximately (or exactly) onto itself. Our paper’s purpose is to rapidly detect the global exact rotational and reflectional symmetries in CAD models, taking the following reasons in mind.(1)The global exact symmetries exist widely in CAD models at the design stage.The global symmetries are easy to be observed by human eyes in a simple CAD model but not in a complex one.The exact symmetries cannot be observed by human eyes in any CAD model.Detecting the global exact reflectional and rotational symmetries of CAD models is one of the most important approaches in simplifying models in CAD/CAE integration  [1].Next, the previous work on detecting symmetries in CAD models is addressed as follows.Tate and Jared  [2] devised an algorithm to detect the global exact reflectional and rotational symmetries by matching the loops of the regular B-Rep models. However, matching only the loop properties of the faces, such as the loop area, the loop type, the loop centroid and the loop normal, may lead to symmetry misdetection. This algorithm takesO(n4)time, wherenindicates the number of faces in the B-Rep model.In the work done by Li et al.  [3], all candidate global symmetry planes are initiated through the symmetry properties of the faces and their intersections. Then, the global exact reflectional symmetries of the model can be determined by merging all the candidate symmetries. The idea of merging two reflectional symmetries was first used in this work.Based on the previous work  [4–8], Li et al.  [9] proposed a symmetry-recognizing method to detect the design intent in approximate B-Rep models created through reverse engineering. The local approximate symmetries, composed of seven symmetry types, are detected by detecting the incomplete symmetry cycles, which provides an efficient way to handle approximate tolerances due to the model approximation. With the symmetry cycles merged, the global symmetries of the model can be derived. The design intent can be robustly detected inO(cn4), wherecis a constant andnis the number of faces in the B-Rep model. Nevertheless, this method is an efficient way to detect local approximate symmetries but not a particular way to detect global exact symmetries.The previous methods described above only attempt to detect the symmetries in regular CAD models, which are composed of planes and quadratic surfaces. Jiang et al.  [10] proposed a method to efficiently detect the local approximate rotational symmetries of free-from surfaces in B-Rep models. This work initially matches the boundaries of free-form surfaces so that most of the asymmetric free-form surfaces can be filtered out in advance, and consequently the scale of the subsequent time-consuming symmetry detection is greatly reduced. However, this method is not robust enough because its surface sampling approach has to depend on the parameterization of the surfaces.In summary, all of the previous methods use the face as the basic unit of symmetry detection. The detection efficiency decreases sharply when the number of faces increases, even by a small amount. As a result, these methods are still far from being completely satisfactory for the end users.Currently, the parametric feature-based modeling technique is becoming mature and has been widely adopted by most CAD modelers. A feature-based CAD model is created through the chronological Boolean combinations of finite features. Therefore, a feature-based CAD model contains not only the B-Rep representation but also the abundant feature information such as feature types, parameters, sketches, references and building histories. Some of the feature information explicitly contains symmetries such as the mirror plane of a mirror feature, the rotational axis of a circular pattern feature. While some symmetries are implicitly contained in the feature information such as the extrusion features’ extrusion lengths, the revolution features’ revolution angles and the 2D sketches of the sketch-based features. By making full use of the feature information and taking a feature as the basic unit for symmetry detection, the symmetries in the feature-based models can be detected much more efficiently compared with the existing methods. However, when using feature information to detect symmetries, the following two problems arise. (1) When detecting symmetries of the features, not all the symmetries can be detected by using only feature information. (2) After the symmetries of features have been detected, the rules to determine the symmetries of the Boolean combinations of the features have to be proposed. Based on the above-mentioned reasons and problems, a feature-based approach is presented in this paper to rapidly detect global exact rotational and reflectional symmetries in feature-based CAD models. For brevity, henceforth, symmetries, unless stated otherwise, we refer to global exact symmetries.The remainder of this paper is organized as follows: definitions on the symmetries, introduction to design features, and theories used in our approach are given in Section  2. Our symmetry detection approach is outlined in Section  3. Details on each stage of our approach are described in Section  4. The experimental results and limitations are given in Section  5. This paper is concluded and our future work is discussed in Section  6.The theories of determining the symmetries of the Boolean combinations of features are demonstrated in Section  2.2. Prior to that, the basic concepts are introduced in Section  2.1.Reflectional symmetries and rotational symmetries: our approach is proposed to detect the rotational and reflectional symmetries of CAD models. These two kinds of symmetries were well defined in Jiang’s work  [11]. In Euclidean spaceR3, if an objectMis symmetric under a reflectional transformationTwith respect to a faceb, the objectMis said to be reflectionally symmetric with respect tob,Tis denoted asZbandMhas a reflectional symmetryZb. In Euclidean spaceR2,bis a line. In Euclidean spaceR3, if an objectMis symmetric under a rotational transformationTof360/kdegrees about the axis linea, wherekis an natural number, the objectMis calledk-fold rotationally symmetric with respect toa,Tis denoted asCa,kandMhas a rotational symmetryCa,k. In Euclidean spaceR2,ais a point.There is a special kind of rotational symmetry. Whenk→∞,Ca,kis denoted asCa,∞, which indicates a rotational symmetry with respect to any rotation angle. In 2D,Ca,∞indicates the rotational symmetry of a circle. In 3D,Ca,∞indicates the rotational symmetry of a revolution body. In addition, any plane passing through the axis of a revolution body is a reflectional symmetry plane of this revolution body. Specifically, any line passing through a cylinder’s centroid and perpendicular to the cylinder’s axis is a 2-fold rotational symmetry axis. All the 2-fold rotational symmetries of this kind in a cylinder are denoted asCo,2,∞, whereois the cylinder’s centroid, 2 is the rotational fold,∞means there exist infinite rotational symmetries inCo,2,∞. Besides, a one-fold rotational symmetry, which is an identity transformation, is not treated as a symmetry. In this paper, symmetries only refer to rotational or reflectional symmetries excluding one-fold rotational symmetries.Self-symmetries and inter-symmetries: the set of all the rotational and reflectional symmetries, excluding one-fold rotational symmetries, in an objectMin 2D or 3D is said to be the self-symmetries ofM, or the symmetries ofM, denoted asS(M). For every symmetrys∈S(M), we say thatMsatisfies symmetrys.For finite objectsM1,M2,…,Mnall in 2D or all in 3D, if there exists a rotational or reflectional transformationTwhich satisfies the following two conditions: (1)Tis a permutation for the set{M1,M2,…,Mn}; (2)Tis not the self-symmetry of any object in{M1,M2,…,Mn}, i.e.T(Mi)≠Mi,i=1,2,…,n, thenTis said to be an inter-symmetry of the object set{M1,M2,…,Mn}, orTis said to be an inter-symmetry among the objectsM1,M2,…,Mn. The set of all the inter-symmetries of{M1,M2,…,Mn}is denoted asSinter({M1,M2,…,Mn}).{M1,M2,…,Mn}can be treated as an objectM. Therefore, according to the definitions of self-symmetries and inter-symmetries,Sinter({M1,M2,…,Mn})⊆S({M1,M2,…,Mn}). For example, in Fig. 2.1(a), among all the symmetries ofS({M1,M2,M3}), only symmetryCo,3is the inter-symmetry of{M1,M2,M3}. SymmetriesZa,ZbandZcare not the inter-symmetries of{M1,M2,M3}, e.g.Za(M1)=M2,Za(M2)=M1,Za(M3)=M3. Consequently,Sinter({M1,M2,M3})={Co,3}. In addition,Zais the inter-symmetry of{M1,M2}and the self-symmetry ofM3. The other two examples are shown in Fig. 2.1(b)(c).The relationship between congruence and inter-symmetries: two objects that can be transformed into each other by an isometry are said to be congruent   [12]. According to the definitions of congruence and inter-symmetries, the inter-symmetries can exist only among the objects which are congruent with each other, as shown in Fig. 2.1(a). And also, it is possible that there exist no inter-symmetries among the objects which are congruent with each other, as shown in Fig. 2.1(b). If the objects are not congruent with each other, there definitely exist no inter-symmetries among all these objects, as shown in Fig. 2.1(c). In addition, it can be seen that for an object set{M1,M2,…,Mn},S({M1,M2,…,Mn})depends on not only the self-symmetries of each object in{M1,M2,…,Mn}but also the inter-symmetries among the congruent objects in{M1,M2,…,Mn}.Design features: in this paper, the input CAD models are the models created by Boolean combinations of design features. The design features (for brevity, henceforth, we refer to design features as features) supported in this paper are: Pad, Shaft, Rib, Stiffener, Pocket, Slot, Shell, Groove, Hole, Fillet, Chamfer, Draft, Mirror and Pattern (Circular Pattern, Rectangular Pattern, User-defined Pattern). Pad, Pocket, Stiffener and Hole are created by extruding their profiles (or 2D Sketches) to some lengths along certain directions. Shaft and Groove are created by revolving their profiles (or 2D Sketches) to some angles about certain axes. Rib and Slot are created by sweeping their profiles (or 2D Sketches) along some paths. Mirror and Pattern copy features in certain geometric arrangements. Shell, Fillet, Chamfer and Draft are created by deleting or greatly changing the edges or faces of the current intermediate model. For example, after a Fillet feature is used, the filleted edges are deleted and also the neighboring faces of the filleted edges are greatly changed.The union operation, denoted as∪, is a primary Boolean operation that combines features into the CAD model. A Pad, Shaft or Rib feature is performed through a union operation with the current intermediate model if the designer needs to add materials. A Pocket, Groove, Slot, Hole or Shell feature is performed through a union operation with the current intermediate model if the designer needs to subtract materials. A Fillet or Chamfer feature adds or subtracts materials depending on whether its referred topological elements are concave or convex. The models composed of the features supported by this paper cover most of the CAD models made up of planes and quadratic faces.Bad design habits: the building history of a feature-based CAD model greatly depends on the design habits of the designers, among which the bad design habits, as summarized below, are found to be rarely used in feature-based modeling.(1) Redundant feature modeling. In a CAD modelM, if a feature or a portion of a feature is deleted, or two features with the same feature type are substituted by one feature of this feature type, the geometrical shape of modelMremains unchanged, then the modeling process of modelMis called redundant feature modeling. Fig. 2.2shows some redundant and non-redundant feature modeling cases. As shown in Fig. 2.2(a), if two Pad features Pad.1 and Pad.2 are substituted by one Pad feature Pad.3, modelM1remains unchanged. As shown in Fig. 2.2(b), feature Pocket.1 is fully wrapped by feature Pad.2 which is fully wrapped by feature Pad.1, therefore, the process of building modelM2can be simplified by using only Pad.1. As shown in Fig. 2.2(c), if Pad.2’s portion which is inside Pad.1 is deleted, modelM3remains unchanged. Therefore, the process of building modelM3can be simplified by using Pad.3 instead of Pad.2.(2) The local symmetric shapes of the CAD model are built by using non-symmetric features, which is a bad design habit and rarely used in practice. As shown in Fig. 2.3(a)–(c), two local symmetric shapes (highlighted and symmetric underZb) are built by three different design habits. Fig. 2.3(a) shows a bad design habit. The usual design processes to build these two local symmetric shapes are shown in Fig. 2.3(b) and (c). Another example is shown in Fig. 2.3(d)–(f). Fig. 2.3(d) shows a bad design habit. The usual design processes to build these two local symmetric shapes are shown in Fig. 2.3(e) and (f).In summary, the two kinds of bad design habits discussed above are rarely used in engineering. Therefore, to assure the correctness of the theories in the next section, these bad design habits are not considered in this paper.This section discusses the theories of computingS(M1∪M2), whereM1andM2satisfy the following three conditions.Condition 1M1andM2are two volumetric objects in 3D.Condition 2M1is built by the unions of features. The same applies toM2.Condition 3For any featurefithat is used to buildM1and anyfjthat is used to buildM2,fiandfjare incongruent.In the late sections, these theories are used to detect the symmetries of a feature set, to sort feature sets and to determine the symmetries in the Boolean combinations of feature sets of CAD models. Note that the bad design habits, which are discussed in Section  2.1, are excluded when these theories are discussed. If not specified, in this section,M1andM2are assumed to satisfy Conditions 1–3.First, based on the definitions of self-symmetries and inter-symmetries, as discussed in Section  2.1,S(M1∪M2)depends only on the self-symmetries ofM1, the self-symmetries ofM2and the inter-symmetries betweenM1andM2. With the limitation of Condition 3,M1andM2are incongruent. Thus, there exist no inter-symmetries betweenM1andM2. So,S(M1∪M2)depends only onS(M1)andS(M2).Next, let us discuss how to computeS(M1∪M2)in a special case thatS(M1)=ΦorS(M2)=Φ. In this case, ifS(M1∪M2)≠Φ, then it can be seen thatM1,M2orM1∪M2must have been built by using the bad design habits, as discussed in Section  2.1. Since the bad design habits are excluded, then we have: ifS(M1)=ΦorS(M2)=Φ, thenS(M1∪M2)=Φ.In the remainder of this section, assume thatS(M1)is known andS(M1)≠Φ, how to computeS(M1∪M2)is to be discussed in the following three cases: (1)S(M2)is known; (2)S(M2)is unknown; (3)S(M2)is partly known.(1)S(M2)is known.First, we are going to discuss how to merge two symmetries, which is the basis of computingS(M1∪M2)when bothS(M1)andS(M2)are known. Before that, a definition is given below.Definition 1Weaker/Stronger Relation between Two SymmetriesLetMbe an object in 3D andS(M)={s1}. IfMis symmetric unders2, then we says2is no stronger thans1, ands1is no weaker thans2, which is denoted ass2⩽s1ors1⩾s2.For example, if an object is symmetric underCa,8, then this object must be symmetric underCa,2andCa,4. Therefore, the symmetries weaker thanCa,8areCa,2andCa,4. Specifically, the null symmetryϕis the weakest symmetry among all symmetries.The cases that the symmetries are weaker than the symmetrysare discussed below. (1) Ifs=Zb, then there exists no symmetries weaker thans. (2) Ifs=Ca,kandk≠∞, then the weaker symmetries areCa,l, wheregcd(k,l)=landl⩾2,gcd(k,l)means the greatest common divisor of natural numberkandl. (3) Ifs=Ca,∞, then the weaker symmetries areCa,l(l≠∞)orZb(planebpasses through axisa).Given two symmetriess1ands2, the strongest symmetrysamong the ones that are no stronger thans1ands2, is called the merging ofs1ands2, denoted ass=s1∪s2. According to Definition 1, the cases thats1∪s2≠ϕare given in Table 2.1. In the other cases that are not shown in Table 2.1,s1∪s2=ϕ. Ifs1∪s2≠ϕ, thens1(ors2) is said to be successfully merged bys2(ors1).Next, let us discuss the relationship between the symmetries inM1∪M2and the symmetries inM1andM2. LetM1andM2satisfy both Conditions 1 and 2. For any symmetrys1∈S(M1)and any symmetrys2∈S(M2), ifs1∪s2is not null,s1∪s2denotes the strongest symmetry among the ones under which bothM1andM2are symmetric. Besides, by excluding the bad design habits discussed in Section  2.1, as shown in Fig. 2.4, we can see that the union ofM1andM2is symmetric unders1∪s2in all the cases thats1∪s2≠ϕ. So, we have:(1)s1∪s2∈S(M1∪M2).In Fig. 2.4(a), Formula (1) holds forM1andM2, whereM1is built by using a triangular Pad feature andM2is built by using a triangular Pocket feature. In Fig. 2.4(g), Formula (1) holds forM1andM2, which are built by respectively using two circular Pad features which are congruent with each other.Finally, we discuss how to computeS(M1∪M2)by using onlyS(M1)andS(M2), whereM1andM2satisfy Conditions 1–3. LetS(M1)={s11,s12,…,s1n},S(M2)={s21,s22,…,s2m}, for anys1i,s1j∈S(M1),1⩽i,j⩽n,i≠j, lets1i∪s1jbe null, the same applies toS(M2). Since Condition 3 is satisfied byM1andM2, then there exist no inter-symmetries betweenM1andM2andS(M1∪M2)depends only onS(M1)andS(M2). Therefore, according to Formula (1), all the symmetries inM1∪M2can be derived by computing the merging of all the distinct pairwise symmetriess1i∈S(M1)ands2j∈S(M2), i.e.(2)S(M1∪M2)={s1i∪s2j∣s1i∈S(M1),s2j∈S(M2),i=1,2,…,n,j=1,2,…,m.}.Then, if bothS(M1)andS(M2)are known,S(M1∪M2)can be computed by using the following Approach 1.Approach 1LetAbe a null symmetry set, select the first symmetrys11inS(M1), compute the merging ofs11and the symmetries inS(M2)one by one. Ifs11can be successfully merged bys2jinS(M2), then we know there exist no other symmetries inS(M2)that can successfully merges11, thus adds11∪s2jtoA. Then, handle the next symmetrys12inS(M1)as we do withs11,…, until the last symmetry inS(M1). Finally,S(M1∪M2)=A.For the convenience of future reference, for any two symmetry setsS1={s11,s12,…,s1n}andS2={s21,s22,…,s2m}, the symmetry set{s1i∪s2j∣s1i∈S(M1),s2j∈S(M2),i=1,2,…,n,j=1,2,…,m}is called the result of mergingS1andS2, denoted asS1∪SS2.(2)S(M2)is unknown.IfS(M1)is known andS(M2)is unknown, a direct but time-consuming method to computeS(M1∪M2)is to firstly detect the symmetries ofM2by using the face-based methods. ThenS(M2)is known. Therefore,S(M1∪M2)can be obtained by using Approach 1. In comparison with this method, a more efficient approach is proposed in this paper to obtainS(M1∪M2)whenS(M1)is known andS(M2)is unknown. Before that, a definition is introduced below.Definition 2Weaker/Stronger Relation between Two Symmetry SetsLetM1andM2be two objects in 3D. For anysi∈S(M2), ifM1is symmetric undersi, then we sayS(M2)is no stronger thanS(M1)andS(M1)is no weaker thanS(M2), which is denoted asS(M2)⩽S(M1)orS(M1)⩾S(M2).According to Formula (2), we know that any symmetrysinS(M1∪M2)is the merging result of one symmetry, let us says1, inS(M1)and one symmetry, let us says2, inS(M2), i.e.s=s1∪s2. Thens⩽s1ands⩽s2. Based on Definition 1, bothM1andM2are symmetric unders. Therefore, based on Definition 2, it can be inferred thatS(M1)⩾S(M1∪M2)andS(M2)⩾S(M1∪M2).So, whenS(M1)is known andS(M2)is unknown,S(M1∪M2)can be obtained by verifying whetherM1∪M2satisfies the symmetries which are no stronger than those ofS(M1). Then, it follows Approach 2.Approach 2First, if there exists an infinite-fold rotational symmetryCa,∞inS(M1)which is not satisfied byM2, perform Approach 2.1 to obtainS(M1∪M2); otherwise, perform Approach 2.2 to obtainS(M1∪M2).Approach 2.1Use Li  [9]’s method to detect the symmetries ofM2and thenS(M1∪M2)can be obtained by using Approach 1.Approach 2.2LetAbe a null symmetry set, for every symmetrys∈S(M1),(1)ifsis a reflectional symmetry and is satisfied byM2, then addstoA;ifsis a rotational symmetryCa,k,k≠∞, then sort the symmetries no stronger thanCa,kinto an ordered sequences1→s2,…,→sn, where their rotational folds are in a descending order. Check the symmetry along this sequence till we find the first one that is satisfied byM2(if there exists), then add this one toA;ifsis a rotational symmetryCa,∞, then addCa,∞toA;Finally,S(M1∪M2)=A.For example, letS(M1)={Zb,Ca,24}andS(M2)be unknown. First, there exists noCa,∞inS(M1). Then letAbe a null symmetry set,S(M1∪M2)can be obtained by Approach 2.2. ForZbinS(M1), supposeM2satisfiesZb, then addZbtoA; ForCa,24inS(M1), sort the symmetries no stronger thanCa,24into an ordered sequenceCa,24→Ca,12→Ca,8→Ca,6→Ca,4→Ca,3→Ca,2. Check the symmetry along this sequence till we find the first one that is satisfied byM2(if there exists). SupposeCa,24andCa,12are not satisfied byM2butCa,8is satisfied byM2, then addCa,8toA. Finally,S(M1∪M2)=A={Zb,Ca,8}.(3)S(M2)is partly known.IfS(M1)is known and only a part ofS(M2)(denoted asPS(M2)) is known, the approach to obtainS(M1∪M2)is demonstrated as follows.Approach 3First, mergeS(M1)andPS(M2)by Approach 1. The merging result is denoted asA. The symmetries ofS(M1)that cannot be successfully merged by those ofPS(M2)are denoted asRS(M1). The symmetries inRS(M1)may be successfully merged by those inS(M2)–PS(M2). However,S(M2)–PS(M2)is unknown. Consequently, we then verify whetherM2satisfies the symmetries which are no stronger than those ofRS(M1)by Approach 2. The verifying result is denoted asB. ThenS(M1∪M2)=A∪B, where∪denotes the union operation of two sets.Given a feature-based CAD modelMas input and the symmetries ofMare unknown, our approach aims at rapidly detecting and outputting all the global exact rotational and reflectional symmetries of modelM. The main idea of our approach is to detect as many symmetries in the features of modelMas possible by using only feature information, and then use the rules of determining symmetries of the Boolean combinations of the features to derive all the symmetries of modelM.The symmetries of a CAD model depend on not only the self-symmetries of its features, but also the inter-symmetries among its congruent features. Fig. 3.1(a) shows a building history of a CAD modelM. The symmetries of modelMare shown in Fig. 3.1(b). The symmetries of modelMdepend on not only the self-symmetries of the features Pad.1, Pad.2, Fillet.1, Fillet.2, Pad.3, Pocket.1, Fillet.3 and Stiffener.1, e.g.Zb∈S({Pad.1}), but also the inter-symmetries between the features Hole.1 and Hole.2, e.g.Zb∈Sinter({Hole.1, Hole.2}). To detect the inter-symmetries among the congruent features, all the features should be classified into the congruent feature sets. For example, in Fig. 3.1(a), Hole.1 and Hole.2 are congruent; therefore they should be classified into the same congruent feature set.By using only feature information, we can easily and rapidly detect as many symmetries in a feature set as possible. However, not all the symmetries in a feature set can be detected by using only feature information. For example, the inter-symmetriesZbbetween Hole.1 and Hole.2 in Fig. 3.1(a) cannot be detected by using only the feature information of Hole.1 and Hole.2. Therefore, the geometric shapes of the features, which can be described by its real faces, are used to detect the symmetries of the feature sets. The real faces of featurefare the faces belonging to featurefin the next intermediate model  [13]. By constructing the parent–child relationships of the topological elements in the model, the real faces of the feature set can be correctly derived. In Fig. 3.1(a), Hole.1’s real faces in the next intermediate model are highlighted. By using the rules of merging and verifying the symmetries of feature sets, finally, the symmetries of the model can be derived. To minimize the operations of merging and verifying symmetries, we choose a reasonable order to handle these feature sets. Next, the overall steps of our approach are given below.Step 1:Construct the parent–child relationships of the topological elements in the model.Classify the model features into congruent feature sets.Detect symmetries of feature sets by using only feature information.Sort the feature sets into an ordered sequence.Merge and verify the symmetries of feature sets in the ordered sequence.In this section, the overall steps are described in greater detail.When adding a featurefinto the current intermediate model, the topological elements of featurefmay be merged, split or modified. The two corresponding topological elements, respectively, belonging to neighboring design stages, have a parent–child relationship. For example, after adding Pad.2 to Pad.1, as shown in Fig. 4.1(a), the facesf1andf2are unchanged. The facesf3andf4are merged intof5. Therefore,f5has two fathers:f3andf4.f3andf4have the same child:f5. Fig. 4.1(b) shows the real faces of Pad.2. In CAD systems, the unchanged real faces, such asf1andf2in Fig. 4.1(b), can be easily derived. Nevertheless, the changed real faces, such asf5in Fig. 4.1(b), are hard to be derived. To solve this problem, the parent–child relationships of topological elements need to be constructed.The parent–child relationships can be constructed by using a persistent naming mechanism. However, the existing naming methods are too imperfect  [14–17] to correctly construct the parent–child relationship. Furthermore, the naming mechanisms are not fully open to the programmers  [18].Based on the reasons above, a simple approach is proposed to construct the parent–child relationships. The details on this approach are beyond the scope of this paper. In general, this approach successively compares the IDs, geometrical types, and bounding boxes of distinct pairwise topological elements to gradually filter out most of the topological elements without the parent–child relationships. The parent–child relationships can be finally determined by accurately comparing the characteristic point sets  [5] of the topological elements.To detect the inter-symmetries among the congruent features, the features of the input model are classified into the congruent feature sets. For any featurefiandfj, which belong to different feature sets, respectively,fiandfjare incongruent. By making full use of feature information, the features can be rapidly classified into the feature sets.Let all the features of the input model bef1,f2,…,fnand for every distinct pairwise featuresfiandfj,1⩽i,j⩽n,i≠j, perform the following steps to classify all the features into the feature sets.Step 1:Iffiandfjhave different feature types,fiandfjare incongruent; otherwise, perform step 2.Iffiandfjhave a replicate relationship because of using a Mirror or Pattern feature, perform step 5; otherwise, perform step 3.Iffiandfjare sketch-based and their sketches are incongruent,fiandfjare incongruent; otherwise, perform step 4.If the corresponding feature information, except feature types and sketch information, offiandfjis the same, then perform step 5; otherwise,fiandfjare incongruent.Putfiandfjinto the same feature set.In Step 3, whether two 2D sketches are congruent can be determined as follows. First, the incongruent sketches are filtered out by comparing the numbers and types of sketch elements. Then, Atallah’s  [19] algorithm is used to exactly determine whether two sketches are congruent.For example, if the two Pad features’ sketches, extrusion types and extrusion lengths are the same, they are congruent and should be put into the same feature set. If the two Fillets’ radiuses are the same, there may be inter-symmetries between them and should be put into the same feature set as well.After the above steps are executed, the featuresf1,f2,…,fnare classified into the feature sets:FS1,FS2,…,FSm, wherem≤n.Similar to a CAD model, the symmetries of a feature set depend on not only the symmetries of each feature but also the inter-symmetries among the features in this feature set. The main idea is to rapidly detect as many symmetries of a feature set as possible by using only feature information instead of the face-based methods. Before introducing the approaches of detecting the symmetries of a feature set, we first discuss how to detect the symmetries of a feature.In this paper, the relationship between the feature information and the symmetries of features is studied to detect symmetries in the features supported by our approach. For example, the symmetries of a Pad, Pocket, Stiffener or Hole feature can be detected by using its feature information composed of its extrusion type, extrusion length, extrusion direction and 2D sketch. The symmetries of a Shaft or Groove feature can be detected by using its feature information composed of its revolution angle, revolution axis and 2D sketch.The following are the details on how to detect the symmetries of a Pad featurefPadby using the feature information offPad. LetAbe a null symmetry set. First, detect the symmetries in the sketch offPad. Then check the detected symmetries in this sketch. If there exists a symmetryZlin this sketch, add a reflectional symmetryZctoA, wherecis a plane created by extruding linelalong the extrusion direction, as shown in Fig. 4.2(a). If there exists a rotational symmetryCd,kin this sketch, add a rotational symmetryCe,ktoA, whereeis a line created by extruding pointdalong the extrusion direction, as shown in Fig. 4.2(b). IffPadis extruded in a fixed extrusion length, add a reflectional symmetryZbtoA, where planebis created by translating the sketch plane till to the half of the extrusion length along the extrusion direction, as shown in Fig. 4.2(a). If there exist two perpendicular reflectional planes infPad, addCa,2toA, where lineais the intersection of these two perpendicular reflectional planes, as shown in Fig. 4.2(a). If there exists a reflectional plane perpendicular to an infinite-fold rotational axis line infPad, addCo,2,∞intoA, whereois the intersection of this reflectional plane with this infinite-fold rotational axis. In Fig. 4.2(b), the reflectional planefis perpendicular to the infinite-fold rotational axise, then addCo,2,∞toA, where pointois the intersection of axisewith planef. Finally,S(fPad)=A.In addition, by employing Atallah’s  [20] optimal method of detecting symmetries of 2D shapes, the symmetries of a 2D sketch can be detected inO(nlogn). A thorough discussion on detecting the symmetries of the other features by using their feature information is beyond the scope of this paper. In general, as many symmetries (or self-symmetries) of the features as possible can be rapidly detected by using only their feature information.In the cases below, not all of the features’ symmetries can be detected by using only feature information.Case 1: Feature intersection. For example, in Fig. 4.3(a), Pocket.1 is created by extruding its 2D sketch to a fixed length and it cuts Pad.1 from the top face of Pad.1. Thus the extrusion length can be derived from the Pocket.1’s parameters. So, all the symmetries{Za,Zb,Zc,Cd,2,Ce,2,Cf,2}of Pocket.1 can be detected by using only Pocket.1’s feature information.In Fig. 4.3(b), Pocket.1 is created by extruding its 2D sketch to cut off all the materials from Pad.1’s top face along the extrusion direction of Pocket.1. Thus, Pocket.1 can be treated as a feature that is created by extruding its 2D sketch to an infinite length. So, the extrusion length cannot be determined by any parameter of Pocket.1. Therefore, it is uncertain whether Pocket.1 is symmetric with respect to the plane similar to the planebin Fig. 4.3(a). It is also uncertain whether Pocket.1 is symmetric with respect to the 2-fold rotational axes similar to the axeseandfin Fig. 4.3(a). Thereby, in this case, only the symmetries{Za,Zc,Cd,2}of Pocket.1 can be detected by using Pocket.1’s feature information. And the other three symmetries{Zb,Ce,2,Cf,2}are undetermined.A Stiffener feature is created by intersecting with the other features. For example, in Fig. 4.3(c), Stiffener.1 is created by extruding its 2D profile that is composed of edgese1,e2,e3, wheree1makes up the sketch of Stiffener.1 ande2,e3are created by the intersections of the sketch plane of Stiffener.1 with the faces of Pad.1 so as to make a closed loop withe1. The feature information of Stiffener.1 is composed of its sketch, extrusion direction and extrusion length. Consequently, the 2D profile of Stiffener.1 cannot be derived by using only Stiffener.1’s feature information. Therefore, no matter how the Stiffener’s feature information is to be set, not all of Stiffener’s symmetries can be detected by using only its feature information.Case 2: Topological reference. To derive the symmetries of Shell, Fillet, Chamfer and Draft features, the symmetries should be detected in its topological elements that must be deleted. For example, in Fig. 4.3(d), the Chamfer.1 is created by chamfering four edgese1,e2,e3,e4in Pad.1. The symmetries of Chamfer.1 are shown in Fig. 4.3(e). We can see thatS({e1,e2,e3,e4})=S({Chamfer.1}). Thus, without using the face-based methods to detect the symmetries in{e1,e2,e3,e4}, none of the symmetries of Chamfer.1 can be determined.Case 3: Inter-symmetries among congruent features. In a feature set, if some features are not replicated to the other features in this feature set by a Mirror or Pattern feature, then none of the inter-symmetries among these features can be detected by using only feature information of themselves. For example, in Fig. 4.3(f),S({Hole.1,Hole.2})is shown in the right. If one of these two holes is not replicated to another by a Mirror or Pattern feature, then no symmetry inSinter({Hole.1,Hole.2})can be detected by using only the feature information of Hole.1 and Hole.2.The set of the detected symmetries, which can be detected by using only feature information, of a feature or a feature setBare denoted asSd(B). Given a feature setFS={f1,f2,…,fu}, the approach of derivingSd(FS)is given below.(1)Ifu=1, thenSd(FS)=Sd(f1), whereSd(f1)can be derived as discussed in Section  4.3.1.Ifu⩾2, then check whether featurefi,i=1,2,…,u, in FS belongs to a Mirror or Pattern feature, which meansfiis replicated by or the replication result of a Mirror or Pattern feature. The set of features that belong to the same Mirror or Pattern feature is denoted as SFMP. The feature that does not belong to any Mirror or Pattern feature is called a single feature, denoted as SF. For a SFMP,Sd(SFMP)can be derived by using only the feature information of each feature in this SFMP and the feature information of the corresponding Mirror or Pattern feature. Then, a SFMP or SF is taken as a unit for symmetry detection, denoted as USD. Suppose thatFS={USD1,USD2,…,USDq},q≤u, the shape of FS can be treated as the union of all the USDs. Besides,USD1∪USD2∪⋯∪USDq=((USD1∪USD2)∪⋯)∪USDq. According to Formula (1) and the definition of the merging of two symmetry sets in Section  2.2, it can be inferred that((Sd(USD1)∪SSd(USD2))∪S⋯)∪SSd(USDq)⊆S(FS). Then Approach 1 is used forq−1times to compute((Sd(USD1)∪SSd(USD2))∪S⋯)∪SSd(USDq)and the computation result isSd(FS).AfterSd(FS)has been derived by using the above approach, we need further to determine whether none of, part of, or all of the symmetries of a feature set FS have been detected. And then,S(FS)can be tagged correspondingly as undetermined, partly determined or determined. Then, it follows the approach as below.(1)IfSd(FS)=Φ, it means none of the symmetries of a feature set FS has been detected by using only feature information, thenS(FS)is tagged as undetermined.IfSd(FS)≠Φ, there are two cases (2.1) and (2.2) as below.(2.1)If there exists Case 1, Case 2 or Case 3, as discussed in Section  4.3.2, in FS, it means that not all of the symmetries of FS have been detected by using only feature information, thenS(FS)is tagged as partly determined.If there does not exist Cases 1–3, as discussed in Section  4.3.2, in FS, it means that all of the symmetries of FS have been detected by using only feature information, i.e.S(FS)=Sd(FS), thenS(FS)is tagged as determined.One example is shown in Fig. 4.4(a)–(d). In this example, both Pad.1 and Pad.2 belong to Mirror.1 which is a Mirror feature that mirrors the features with respect to planeb. Therefore, {Pad.1, Pad.2} is a SFMP. ThenSd(FS1)=Sd(USD1)∪SSd(USD2)={Ca,2,Zb,Zc}. In another example, as shown in Fig. 4.4(e)–(g), none of the features inFS2belongs to any Mirror or Pattern feature. Then,Sd(FS2)=(Sd(USD1)∪SSd(USD2))∪SSd(USD3)={Zc}∪S{Ca,2,Zb,Zc}={Zc}. In comparison, by using only feature information, more symmetries can be detected inFS1, it is because thatFS1has more feature information thanFS2does, i.e. the feature information of Mirror.1 can be used to detect the inter-symmetries of {Pad.1, Pad.2}, which, however, cannot be detected by using only feature information inFS2. Therefore, a conclusion is drawn that our approach makes full use of feature information to rapidly detect as many symmetries of a feature set as possible.In this section, to make sure that the unnecessary operations of merging and verifying symmetries in the next step can be avoided, a step is taken forward to discuss how to sort the feature sets.First, since verifying symmetries is far more time-consuming than merging symmetries, the feature sets with more undetermined symmetries are put behind the feature sets with less undetermined symmetries. Therefore, the priority should be given to the feature sets with symmetries determined, then to feature sets with symmetries partly determined, and then to the features sets with symmetries undetermined.Second, it can be seen that(3)S(M)=S(FS1∪FS2∪⋯∪FSm)=S(((FS1∪FS2)∪⋯)∪FSm).Then, based on the discussion in Section  2.2, it can be inferred thatS(M)⩽S(FSi),i=1,2,…,m. Therefore, the earlier the feature sets with weaker symmetries are handled, the more unnecessary operations of merging and verifying can be avoided to determine the symmetries of the model. Consequently, ifFSiandFSj,i,j=1,2,…,mandi≠j, have the same number of undetermined symmetries, andSd(FSi)⩽Sd(FSj), thenFSiis put beforeFSjin the ordered sequence.At last, the feature sets are sorted. It can be seen that the sorting results may not be unique. If there exist more than one ordered sequence, choose any one for handling. Whichever sequence being chosen, the unnecessary operations of merging and verifying symmetries in the next step can be avoided.Suppose all the feature sets of a CAD modelMare sorted into the ordered sequence:FS1→FS2⋯→FSm, in this section, the details on merging and verifying symmetries of the feature sets are to be discussed.Based on Formula (3), the problem of computingS(M)can be reduced to computing the symmetries of(((FS1∪FS2)⋯)∪FSi)∪FSi+1, the variableiequals1,2,…untilm−1, where((FS1∪FS2)⋯)∪FSiis taken as the current intermediate model CIM andFSi+1is taken as the current feature set CFS. Finally,S(M)equals the lastS(CIM∪CFS), i.e. at this stage,i=m−1. During these processes, according to the discussion on the special case of “S(M1)=ΦorS(M2)=Φ” in Section  2.2, wheneverS(CIM∪CFS)is null, the whole program will be terminated and the result is “no symmetries”, which means the modelMcontains no rotational or reflectional symmetries.Before computingS(CIM∪CFS), it is known thatS(CIM)has been computed in the last stage and has already been determined. Besides, by using only feature information, as many symmetries of each feature set as possible have been detected in Step 3 of the overall steps. Therefore,S(CFS)may be determined (i.e.S(CFS)=Sd(CFS)), undetermined or partly determined (i.e. the part ofS(CFS)that has been detected isSd(CFS)). And also, based on the feature classification, it is known that CIM and CFS satisfy Conditions 1–3 in Section  2.2. Therefore,S(CIM∪CFS)can be computed by using the corresponding one of Approachs 1–3 in Section  2.2. Especially, at the stage of computingS(FS1∪FS2), to make sure thatS(FS1)is determined, if not all of the symmetries ofFS1have been detected by using only its feature information, then Li  [9]’s algorithm is used to detect the symmetries in the real faces ofFS1. Thus,S(FS1)can be derived. As a matter of fact, sinceFS1is sorted as the first feature set in the order sequence, and then in most cases, the symmetries ofFS1can be detected by using only its feature information.When verifying whether CFS satisfies symmetries, if CFS is a Shell, Fillet, Chamfer or Draft feature set, the referred topological elements, such as the filleted edges of Fillet features, the removed faces of Shell features and the drafted faces of Draft features, are verified; otherwise the real faces of CFS are verified. Due to space constraints, the details on verifying symmetries are not further discussed. In general, the characteristic points  [5] of the topological elements (real faces or referred topological elements) are extracted to verify whether they can be carried onto themselves under the symmetries.Using a 2.8 GHz i5-2300 CPU with 4G RAM, the experiments were implemented by using “Visual Studio 2005” integrated with the “CAA and RADE” toolkit for the application development of CATIA v5 R19.Experiment 1 was performed for the purpose of validating the correctness of each processing stage of our approach. Fig. 5.1shows the building history of the input base modelM. The next intermediate model is derived by adding the feature shown over the arrow, which lies on the right side of the current intermediate model. The real faces of the features are highlighted. The base model includes 19 features. In the application development environment of CATIA, the features in a CAD model comprise not only the features in the feature tree, but also the replicating results of the Mirror or Pattern features. For example, the base model has 18 features, not 15 features, where Hole.2 is the result of mirroring Hole.1 by Mirror.1. Hole.5 and Hole.6 are the results of mirroring Hole.3 and Hole.4 by Mirror.2.In total, it took 250 ms to detect the symmetries of the input modelM. Table 5.1shows the result of each processing stage. After checking the feature information of the features in modelM, the following facts were found. The sketches of Pad.1 and Pad.2 were incongruent. The radius of Fillet.1 was different from that of every Fillet inFS5. The radius of each hole inFS6was different from that of each hole inFS7. Hence, the result of feature classification in Table 5.1 is correct. Both the 2D sketches of Pad.1 and Pad.2 were extruded to the fixed lengths, and consequently symmetries ofFS1andFS3were determined. The detected symmetries{Zb,Zc,Ca,2}of Pad.1 are shown in Fig. 5.2(a). The 2D profiles of Pocket.1, Hole.1, Hole.2, Hole.3, Hole.4, Hole.5 and Hole.6 were extruded to cut off all the materials along their extrusion directions. Therefore, the symmetries ofFS2,FS6andFS7were partly determined. The detected symmetry of Pocket.1 wasCd,∞, as shown in Fig. 5.2(b). BothFS4andFS5were Fillet feature sets, so their symmetries cannot be determined by using only feature information. Consequently, the result of detecting symmetries of each feature set is correct. According to the discussion in Section  4.4, it can be seen that, in Table 5.1, the result of sorting the feature sets is correct.At the stage “Merging and verifying symmetries”, in Table 5.1, SSM indicates the symmetries ofS(CIM)that were successfully merged by those of CFS. SV indicates the symmetries ofS(CIM)to be verified. In fact,SV=S(CIM)−SSM. WhenFS3andFS6were merged with the corresponding CIM, since all the symmetries ofS(CIM)could be successfully merged, so there existed no symmetry to be verified, i.e.SV=Φ. WhenFS2was merged, the Pocket.1’s axis linedin Fig. 5.2(b) indeed lied in planecin Fig. 5.2(a), thus only the symmetryZcwas successfully merged. Thereby,{Zb,Ca,2}needed to be verified. The real face of Pocket.1 obtained in this experiment was highlighted in Fig. 5.2(c). The real faces ofFS7obtained in this experiment were highlighted in Fig. 5.2(d). BothFS4andFS5were Fillet feature sets. Therefore, their filleted edges were used to verifyS(CIM). The detected symmetries of the base model are shown in Fig. 5.2(e). Experiment 1 shows that our approach is helpful in making full use of the feature information in the base model, and also helpful in efficiently determining the symmetries of the Boolean combinations of the features.To test the robustness and efficiency of our method, symmetries of more than one hundred models have been successfully detected. Experiment 2 shows the detection results of 32 different models of connectors, accessories, bearings, gearboxes, handheld devices and so on. Fig. 5.3presents the visual results of experiment 2. The models at the arrow tails are input models. The models with planes or axes at the arrow heads are the results of symmetry detection. The transparent rectangular planes indicate the detected reflectional symmetry planes. The dashed and dotted lines indicate the detected rotational symmetry axes. It can be seen that the global symmetries of these 32 input models can be correctly detected. It also shows that our method is robust.The results of experiment 2 are shown in details in Table 5.2, where ET indicates the execution time, NFE indicates the number of features in the model, NFA indicates the number of faces in the model, NRES indicates the number of reflectional symmetries and NROS indicates the number of rotational symmetries. The following conclusions can be drawn from Table 5.2.(1)All symmetries of the 32 models were correctly detected.The symmetries were detected in very short time. None of the execution time exceeds one second.The execution time bears little relation to the faces in models. And, the execution time increases steadily with an increase of the number of features. For example, although the gear model (No. 32) has 195 faces, its symmetries were detected in only 150 ms. This is because the gear model has only 4 features and the Circular Pattern feature’s information was used to directly derive the rotational axis of the replicated features.Additionally, the case of verifying the symmetries that are weaker than the infinite-fold rotational symmetries did not occur in these 32 input models.

@&#CONCLUSIONS@&#
