@&#MAIN-TITLE@&#
An analytical comparison of the LP relaxations of integer models for the k-club problem

@&#HIGHLIGHTS@&#
Comparison of formulations for the 3-club problem, from the LP relaxation standpoint.New enhanced formulation for the 3-club problem.New enhanced formulation for the k-club problem (k>1).New formulation for a variant of the 3-club problem with additional robustness constraints.

@&#KEYPHRASES@&#
Combinatorial optimization,Formulations,k-Clubs,Integer programming,Clique relaxations,

@&#ABSTRACT@&#
Given an undirected graph G=(V,E), a k-club is a subset of nodes that induces a subgraph with diameter at most k. The k-club problem is to find a maximum cardinality k-club. In this study, we use a linear programming relaxation standpoint to compare integer formulations for the k-club problem. The comparisons involve formulations known from the literature and new formulations, built in different variable spaces. For the case k=3, we propose two enhanced compact formulations. From the LP relaxation standpoint these formulations dominate all other compact formulations in the literature and are equivalent to a formulation with a non-polynomial number of constraints. Also for k=3, we compare the relative strength of LP relaxations for all formulations examined in the study (new and known from the literature). Based on insights obtained from the comparative study, we devise a strengthened version of a recursive compact formulation in the literature for the k-club problem (k>1) and show how to modify one of the new formulations for the case k=3 in order to accommodate additional constraints recently proposed in the literature.

@&#INTRODUCTION@&#
Given an undirected graph G=(V,E) and an integer k, a k-club S is a cluster of nodes such that any two of its elements can reach each other through at most k−1 intermediate cluster members. If k=1, then every cluster member is directly linked to all the others and S is a clique (Bomze, Budinich, Pardalos, & Pelillo, 1999; Sorensen, 2004; Alidaee, Glover, Kochenberger, & Wang, 2007; Martins, 2010). If k>1, a k-club can be interpreted as a distance-based relaxation of a clique.The need for graph models to represent clusters was first noted during the 1970s in the literature of social networks analysis (Alba, 1973;Mokken, 1979). It was also noted then that the clique model is too restrictive for many real-world applications for not all social relations require face-to-face interaction. In fact, social relations are frequently established through intermediaries. This explains the importance of clique relaxation models for social sciences.Recently, the OR community has produced a significant number of studies on clique-related models with applications in both the social sciences as well as other fields such as computational biology (Blażewicz, Formanowicz, & Kasprak, 2005; Balasundaram, Butenko, & Trukhanov, 2005; Butenko & Wilhelm, 2006) and data mining (Boginski, Butenko, & Pardalos, 2006).For any k>1, the k-club problem is to find a maximum cardinality k-club of a graph. The k-club problem is NP-hard (Bourjolly, Laporte, & Pesant, 2002). The computational performance of all the approaches reported in the literature depends on the value of k and the edge density of the graph. To be able to devise better exact and approximate approaches, it is important to gain a deeper understanding of the problem from a theoretical point of view. A detailed study of the non-hereditary nature of k-clubs for k>1 is presented in Mahdavi Pajouh and Balasundaram (2012). In this study, we investigate the relative strength of the LP relaxations of integer programming formulations for the k-club problem built in different variable spaces.The rest of the paper is organized as follows. In Section 2 we provide definitions, terminology, and notation. Section 3 contains the motivation and an overview of the study. Section 4 contains a review of the literature on k-club models. Sections 5 and 6 are devoted to the comparison of models and the development of enhanced versions, from the linear programming standpoint. In Section 7 we derive a formulation for a problem that has recently been proposed in the literature: a variant of the 3-club problem with additional robustness constraints. Conclusions are presented in Section 8.Given an undirected graph G=(V,E) and a node v∈V, we represent by Nvthe set of all nodes adjacent to v, and call it the neighbourhood of v. The distance distG(u,v) between two nodes u and v is the minimum number of edges needed to link them, and the diameter diam(G) is the maximum distance between any u and v. If S⊆V, the subgraph induced by S is G[S]=(S,E(S)), where E(S) is the set of edges with both end nodes in S. For any k⩾1, if diam(G[S])⩽k, S is a k-club. A k-club S⊆V can be represented by its incidence vector X=(x1,…,x∣V∣). If C is a subset of nodes and s, t∈V⧹C, we say that C is an s−t node cut set if C intersects all chains that link s and t.Formulations with variables to represent only nodes are called natural whereas formulations with additional variables to represent edges, chains or paths are called extended. A formulation is compact if the number of its variables and constraints is bounded from above by a polynomial function of the number of nodes. If an integer linear programming formulation is represented by [F], then [F]LP represents its linear programming (LP) relaxation, their optimal values are represented by Z[F] and Z[F]LP, and their feasible sets are represented by S[F] and S[F]LP, respectively. Feasible solutions to LP relaxations of natural (resp. extended) integer formulations are represented byX¯, (resp.(X¯,Y¯),(X¯,V¯), and(X¯,Z¯)). Integer formulations are compared by projecting their LP relaxation feasible sets onto the space of node variables. Given a polyhedronP={(x,y)∈Rn×q:Ax+By⩽b}, where A, B, an b have m rows, the projection of P onto the x-space is defined asProjx(P)={x∈Rn:∃y∈Rq(x,y)∈P}. For more on polyhedral theory and projection the reader is referred to Nemhauser and Wolsey (1988) and Balas (2005). Given two integer formulations [F1] and [F2], whose objective function is the same and is to be maximized, if Projx(S[F1]LP) is a subset of Projx(S[F2]LP), then Z[F1]LP⩽ Z[F2]LP, and we say that [F1]LP is stronger than [F2]LP and formulation [F1] dominates [F2]. If Projx(S[F1]LP)=Projx(S[F2]LP), then [F1] and [F2] are LP-equivalent.Like many other combinatorial optimization problems, the k-club-problem has alternative integer linear programming formulations that are stated with different sets of variables. The first formulation in the literature, proposed in Bourjolly et al. (2002), is a compact extended formulation with node and chain variables. Following Almeida and Carvalho (2012), we shall call it the chain formulation and denote it by [F_C]. Since two-edge chains t=(i,r,j) that link nodes i and j can be identified by the central node r, there is no need for chain variables to represent them. Based on this observation, Bourjolly et al. (2002) also proposed a simplified natural formulation for the case k=2. Very recently, four new formulations have been proposed for k-clubs. Veremyev and Boginski (2012) present a compact extended recursive formulation (henceforth referred to as [F_R]) derived from a nonlinear model by a linearization procedure that takes into account the structure of k-clubs. For k=3, Almeida and Carvalho (2012) propose a node cut set natural formulation [F_S] with a non-polynomial number of constraints and a compact extended formulation [F_N] with node and edge variables. For the case k=2, Carvalho and Almeida (2011) devise a natural formulation whose constraints define facets of the 2-club polytope P2c. This formulation, based on Bourjolly et al.’s model, is obtained by lifting redundant constraints.Many authors have carried out comparative studies of alternative formulations for important combinatorial optimization problems – e.g. tree problems (Magnanti & Wolsey, 1995) and travelling salesman-related problems (Gouveia & Voss, 1995; Oncan, Altinel, & Laporte, 2009). To the best of our knowledge, no similar study can be found in the literature for the k-club problem. Veremyev and Boginski (2012, pp. 320–321) comment on the tightness of binary formulations based on the results obtained with a set of test instances. They guess that their recursive formulation “is generally at least as good (or, at the very least, not substantially worse) than the one byBourjolly et al. (2002)” and that their formulation “is rather tight for larger values of k”. Almeida and Carvalho (2012) have proved that formulation [F_N] dominates chain formulation [F_C] for k=3, and they present a weakened version of [F_N] which is LP-equivalent to [F_C]. The authors also prove that for k=3 node cut set formulation [F_S] dominates [F_N], but do not show how to strengthen the latter to obtain a formulation LP-equivalent to the former.With this study we aim to investigate the relative strength of the LP relaxations of different formulations for the maximum k-club problem. Since the formulations are stated with different sets of variables, the comparisons are made by projecting the LP feasible sets onto the space of node variables. The insight gained into the k-club structure by means of these comparisons may be of help to explore possible ways to formulate related problems, as illustrated in Section 7 with the R-robust k-club problem recently proposed in the literature by Veremyev and Boginski (2012).First, for the case k=3, we show how to modify [F_C] in order to obtain an enhanced version [F_EC], which is LP-equivalent to [F_S]. Then, we address the tightness of the recursive formulation [F_R] in comparison with the tightness of [F_C] and show that the conclusion depends on the value of k: for k=3 [F_R] dominates [F_C] but the dominance does not hold for k=4. For k=3, we also show that [F_R] is dominated by [F_EC].Based on the insight gained from the comparisons of [F_R], [F_C], and [F_EC] for k=3, we derive a strengthened version of [F_R] that is valid for any k>1, denoted by [F_ER]. We then show that for k=3 [F_ER] and [F_EC] are LP-equivalent.We conclude the paper with a formulation for the R-robust 3-club problem, introduced in the literature by Veremyev and Boginski (2012). To the best of our knowledge, there is in the literature no other formulation for the robustness condition when k>2.To set the grounds for the comparisons presented in the following sections, we shall first review integer programming formulations in the literature.To simplify the notation, we will denote byPkthe set of all pairs of nodes that cannot belong simultaneously to a k-club, because their distance in G=(V,E) is greater than k, and byNkthe set of all pairs of nonadjacent nodes whose distance in G=(V,E) does not exceed k.The formulation proposed in Bourjolly et al. (2002), with node and chain variables, can be presented as follows. For any two nonadjacent nodes i, j∈V, letCijkbe the set of all chains, of length at most k, that link i and j, and letC=∪i,j∈VCijk. Let yt, t∈C, be a binary variable associated with chain t and Vtbe the set of all nodes in the chain.A maximum k-club is an optimal solution for(1)[F_C]maxZ=∑i∈Vxis.t.xi+xj⩽1{i,j}∈Pk(2)xi+xj⩽1+∑t∈Cijkyt{i,j}∈Nk(3)yt⩽xrt∈C,r∈Vt(4)xi∈{0,1}i∈V(5)yt∈{0,1}t∈CConstraints (1) guarantee that if distG(i,j)>k, then nodes i and j are not both selected for the k-club. Constraints (1) will be referred to as packing constraints. Constraints (2) impose that a pair of nonadjacent nodes in a k-club must be linked by at least one selected chain with at most k edges. Constraints (3) impose the inclusion in the k-club of all nodes in selected chains. Conditions (4) and (5) define the variables as binary.Note that for every pair{i,j}∈Nkand every chaint∈Cijk,r∈Vt⧹{i,j}can be substituted for r∈Vt, in constraints (3), since in any solution such thaty¯t>min{x¯i,x¯j}the value of variable ytcan be decreased tomin{x¯i,x¯j}, without altering the solution in the x-space.The number of chain variables ytand constraints in [F_C] is O(∣V∣k+1).Veremyev and Boginski (2012) use a different approach to devise a formulation for the k-club problem. First, they develop a nonlinear model. Then, they transform it into a linear model with binary variables xi(i=1,…,∣V∣) to represent nodes, and integer variableswij(l)(i,j=1,…,|V|;l=2,…,k)to represent the number of paths of length l that link nonadjacent nodes i and j. Finally, taking into account the k-club structure, they devise a recursive binary formulation with node variables xi(i=1,…,∣V∣) and binary variablesvij(l)(i,j=1,…,|V|;l=2,…,k)such thatvij(l)=1if and only if there is at least one path of length l from node i to node j in the subgraph induced by the set S⊆V whose incidence vector is X=(x1,…,x∣V∣).The recursive formulation can be presented as follows:(6)[F_R]maxZ=∑i∈Vxis.t.xi+xj⩽1+∑l=2kvij(l)i,j∈V,(i,j)∉E(7)fori,j∈V,j>i,vij(2)⩽xivij(2)⩽xjvij(2)⩽∑k∈(Ni∩Nj)xk(8)vij(2)⩾1|V|∑k∈(Ni∩Nj)xk+(xi+xj-2)(9)forl=3,…,k;i,j∈V,j>i,vij(l)⩽xivij(l)⩽∑k∈Nivkj(l-1)(10)vij(l)⩾1|V|∑k∈Nivkj(l-1)+(xi-1)(4)xi∈{0,1}i∈V(11)vij(l)∈{0,1}i,j∈V;l=2,…,kConstraints (6) impose that each pair of selected nodes must be linked by at least a path with at most k edges. Constraints (7) and (8) define paths with two edges. Constraints (9) and (10) define the recursion for paths with three or more edges. Constraints (11) define the recursion variables as binary.Recursive formulation [F_R] has size O(k∣V∣2).For the case k=3, Almeida and Carvalho (2012) propose two alternative formulations – neighbourhood formulation [F_N] and node cut set formulation [F_S]. The rationale for [F_N] and [F_S] is summarized next.Consider a pair of nonadjacent nodes i and j of G=(V,E). They may be included in a 3-club S only if at least one of the following conditions holds:(I)There is a node r in S that is a neighbour of i and j, i.e., r∈(Ni∩Nj);There are two adjacent nodes in S, p and q, such that p is a neighbour of i, and q is a neighbour of j, i.e., p∈Ni, q∈Nj, and (p,q)∈E.Condition (I) holds if and only if distG[S](i,j)=2.If condition (II) holds and p∈(Ni∩Nj) or q∈(Ni∩Nj), then distG[S](i,j)=2 and condition (I) holds as well. So, in (II), we can consider only nodes p∈(Ni⧹Nj) and q∈(Nj⧹Ni). Let Eijdenote the set of edges that link those nodes:Eij={(p,q)∈E:p∈(Ni⧹Nj),q∈(Nj⧹Ni)}.Let us now associate a variable zijwith each edge (i,j)∈E.A maximum 3-club is an optimal solution for(12)[F_N]maxZ=∑i∈Vxis.t.xi+xj⩽1{i,j}∈P3(13)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑(p,q)∈Eijzpq{i,j}∈N3(14)zij⩽xi,zij⩽xj,zij⩾xi+xj-1(i,j)∈E(4)xi∈{0,1}i∈V(15)zij⩾0(i,j)∈EConditions (12) are packing constraints. Neighbourhood constraints (13) impose that two nonadjacent nodes i and j cannot be both in a 3-club unless a common neighbour is in the 3-club or a pair of neighbours, p and q, of i and j respectively, linked by an edge, are in the 3-club. Constraints (14) guarantee that an edge (i,j) is used if and only if both its end nodes belong to the 3-club. Constraints (15) define edge variables as nonnegative.Conditions zij⩾xi+xj−1 can be ignored because in any solution withz¯ij<x¯i+x¯j-1the value of variable zijcan be increased tomin{x¯i,x¯j}, without altering the solution in the x-space.Note that, if in the last term of conditions (13)E(Ni,Nj) is substituted for Eij, the resulting formulation is LP-equivalent to [F_C] (Almeida & Carvalho, 2012); if in [F_C] for each pair of nodes{i,j}∈N3all variables ytassociated with three-edge chains t=(i,p,q,j) with p∈(Ni∩Nj) or q∈(Ni∩Nj) are removed, the resulting formulation is LP-equivalent to [F_N] (Almeida & Carvalho, 2012).Neighbourhood formulation [F_N] has ∣V∣+∣E∣ variables and|V|2-|V|2+2|E|constraints.[F_S] is a natural formulation for the 3-club problem based on node cut sets of auxiliary graphs built for pairs{i,j}∈N3. This formulation is described next.Consider again a pair of nonadjacent nodes i and j of G=(V,E) and Eij={(p,q)∈E:p∈(Ni⧹Nj),q∈(Nj⧹Ni)}. Eijis the set of inner edges of three-edge chains that link nodes i and j, and whose inner nodes are not in Ni∩Nj. Let Vijrepresent the set of their end nodes. Each node v∈Vijis either adjacent to node i or to node j. Therefore Vijcan be partitioned into subsets Aij={v∈Vij:v∈ (Ni⧹Nj)} and Bij={v∈Vij:v∈(Nj⧹Ni)}.Let us now associate with i and j a subgraph Gij=(Nij,Hij), where Nij=Vij∪{i,j} and Hij=Eij∪{(i,v)∈E:v∈Aij}∪{(v,j)∈E:v∈Bij}.To include nodes i and j in a 3-club S, it is also necessary to include a node r∈(Ni∩Nj) or a node of each set Sij⊆Vijsuch that E(Vij⧹Sij)=∅, since otherwise distG[S](i,j)>3. These sets Sijare i−j node cut sets. The set of all minimal Sijwill be denoted bySij.A maximum 3-club is an optimal solution for(12)[F_S]maxZ=∑i∈Vxis.t.xi+xj⩽1{i,j}∈P3(16)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑s∈Sijxs{i,j}∈N3,Sij∈Sij(4)xi∈{0,1}i∈VConditions (12) are packing constraints. Node cut set constraints (16) impose that, if two nonadjacent nodes i and j are both selected for the 3-club, then a common neighbour of i and j or one node from eachSij∈Sijis also selected for the 3-club.Node cut set formulation [F_S] dominates neighbourhood formulation [F_N] (Almeida & Carvalho, 2012).For k=3, Almeida and Carvalho (2012) show that chain formulation [F_C] is dominated by formulation [F_N], which is in turn dominated by natural formulation [F_S]. They also show how to modify [F_C] to obtain a chain formulation, LP-equivalent to [F_N]. All these formulations are compact, except for [F_S], which has a non-polynomial number of node cut set constraints. The comparisons in Almeida and Carvalho (2012) suggest that if we aim to obtain a chain formulation LP-equivalent to [F_S], we have to devise more stringent constraints to link node and chain variables. The intuition for the new linking constraints is provided by the example in Almeida and Carvalho (2012, p. 157): the dominance of [F_S]LP over [F_N]LP may be strict only when there is at least one pair{i,j}∈N3and a node v∈Vijsuch thatdeg(v)Gij[Vij]>1. In this case, node v is shared by two or more three-edge chains whose central edges are represented by variables zpq, with (p,q)∈Eij. In a non-integer feasible solution(X¯,Z¯)for [F_N]LP, if v∈Aij, it may happen that∑q:(v,q)∈Eijz¯vq>x¯vor, if v∈Bij, it may happen that∑p:(p,v)∈Eijz¯pv>x¯v. In either case, the solution can be cut off by imposing the condition that the sum of the values of all variables that represent the chains that share node v cannot be greater thanx¯v. To formulate these new linking constraints, we shall rewrite chain variables yt, t=(i,p,q,j), asypqij, in order to make the identification of inner nodes immediate.The enhanced version of chain formulation [F_C] for k=3 we propose in this section combines the new linking constraints sketched above with the rationale used to remove ytvariables associated with three-edge chains t=(i,p,q,j) with at least one inner node in Ni∩Nj(see Section 4.3).Let us consider chain formulation [F_C] for k=3.For each pair of nodes{i,j}∈N3, letCij=2(resp.Cij=3) represent all chains with two (resp. three) edges that link i and j.Each chaint=(i,r,j)∈Cij=2can be represented by its central node r. Therefore, all variables ytthat represent chains ofCij=2can be discarded and constraints (2) rewritten as(17)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑t∈Cij=3yt{i,j}∈N3As discussed in Section 4.3, for each{i,j}∈N3, variables ytassociated with chainst=(i,p,q,j)∈Cij=3with p∈ (Ni∩Nj) or q∈(Ni∩Nj) can be eliminated. To simplify the notation, for all other chainst=(i,p,q,j)∈Cij=3let us writeypqij, instead of yt, with constraints (3) rewritten as(18)ypqij⩽xiypqij⩽xj{i,j}∈N3(p,q)∈Eij(19)ypqij⩽xpypqij⩽xq{i,j}∈N3(p,q)∈Eijand constraints (5) rewritten as(20)ypqij∈{0,1}{i,j}∈N3(p,q)∈EijConstraints (2) in [F_C] can now be lifted to(21)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑(p,q)∈Eijypqij{i,j}∈N3A chain that includes edge (i,p) (resp. (q,j)) can only be used if node p (resp. q) is in the 3-club, and to include a pair of nonadjacent nodes i and j in the 3-club, there is no need to select more than one chain with three edges. Therefore, constraints (19) can be lifted to(22)umq:(p,q)∈Eijypqij⩽xp{i,j}∈N3p∈Aij(23)∑p:(p,q)∈Eijypqij⩽xq{i,j}∈N3q∈BijAn enhanced chain formulation for the 3-club problem is[F_EC]max∑i∈Vxi:(12),(21),(18),(22),(23),(4),(20).By construction, [F_EC] dominates [F_C].Proposition 1For k=3, Z [F_EC]LP⩽Z [F_C]LP.Note that constraints (18) can be ignored because in any solution withy¯pqij>minx¯i,x¯jthe value of variableypqijcan be decreased tominx¯i,x¯j, without altering the solution in the x-space. Constraints (18) can also be written as∑(p,q)∈Eijypqij⩽xiand∑(p,q)∈Eijypqij⩽xjbecause the upper bounding constraints xv⩽1, for all v, dominate (21) if∑(p,q)∈Eijy¯pqij>min{x¯i,x¯j}. This version of constraints (18) imposes the extra condition that at most one chain with three edges can be selected to link nodes i and j in the induced subgraph. The condition is not restrictive for the 3-club problem, but it is incompatible with multiple-chain conditions for robustness that have been recently proposed in the literature (see Section 7). By contrast, the lifting of constraints (19) to constraints (22) and (23) strengthens the LP relaxation of the integer model and paves the way to the introduction of robustness conditions.The dominance of [F_EC] over [F_C] may be strict. An illustration is provided by the graph depicted in Fig. 1(a).For k=3, the number of variables in [F_EC] and [F_C] is O (∣V∣4). In practice, the number of variables in [F_EC] is significantly smaller than the number of variables in [F_C] because all variables that represent chains with two edges as well as many variables that represent chains with three edges are eliminated.In this section, we compare the LP relaxations of the integer models described in Sections 4 and 5, for the case k=3. In these relaxations, constraints (4), (5), (11), and (20) are replaced by(4′)0⩽xi⩽1i∈V(5′)yt⩾0t∈C(11′)vij(l)⩾0i,j∈V;l=2,…,k(20′)ypqij⩾0{i,j}∈N3(p,q)∈EijIn Section 6.1, we establish the LP-equivalence of [F_EC] and [F_S]. In Section 6.2, we show that formulation [F_R] is dominated by enhanced chain formulation [F_EC] and dominates chain formulation [F_C]. Based on the comparative study made for the case k=3, we propose an enhanced version of [F_R] which is valid for the k-club problem, for any k>1. We then establish the LP-equivalence between [F_EC] and this enhanced version of [F_R] for k=3. In Section 6.3, we show that there is no dominance relation between formulations [F_N] and [F_R].The rationale used to derive formulation [F_EC] suggests that with constraints (22) and (23) we may obtain a chain formulation as strong as [F_S] from the LP relaxation standpoint. In this section we present a formal proof that [F_EC] and [F_S] are, in fact, LP-equivalent.To prove that [F_EC] and [F_S] are LP-equivalent, we shall show that the feasible set of [F_S]LP is the projection of the feasible set of [F_EC]LP onto the x-space.Let(X¯,Y¯)be any feasible solution for [F_EC]LP.For any{i,j}∈N3andSij∈Sij,∑(p,q)∈Eijy¯pqij=∑(p,q)∈Eijp∈(Aij∩Sij)q∈Bijy¯pqij+∑(p,q)∈Eijp∈(Aij⧹Sij)q∈(Bij∩Sij)y¯pqij⩽∑p∈(Aij∩Sij)x¯p+∑q∈(Bij∩Sij)x¯q=∑s∈Sijx¯s.Therefore,X¯satisfies all node cut set constraints (16), for the pair{i,j}∈N3. Since{i,j}∈N3was chosen arbitrarily,X¯is feasible for [F_S]LP.Conversely, letX¯be any feasible solution for [F_S]LP, and let us build a feasible solution(X¯,Y¯)for [F_EC]LP.For every{i,j}∈N3, let us consider subgraph Gij=(Nij,Hij) (see Section 4.3), and a layered digraphDijbuilt from Gijas follows.The layers ofDijare: L1={i}, L2=Aij, L3=Bij, and L4={j}. For each edge in Hij, we create a directed arc inDijand define the arc capacities as:cap(u,v)=x¯vifu=iandv∈Aij∞ifu∈Aijandv∈Bijx¯uifu∈Bijandv=jLet f be a maximum i−j flow inDij. By construction,value(f)=∑(p,q)∈Eijfpq. Let us sety¯pqij=fpqfor all (p,q)∈Eij. By the max-flow min-capacity cut theorem, value(f) is also the capacity of an i−j cut of minimum capacity inDij. Hence,value(f)=∑s∈Cijx¯s, where Cijis the set of nodes of Vijthat are incident to the arcs in a minimum capacity i−j cut inDij. Therefore,value(f)=min∑s∈Sijx¯s:Sij∈Sij, and constraints (16) for {i,j} are satisfied. Since the pair {i,j} was chosen arbitrarily, we can conclude that(X¯,Y¯)is feasible for [F_EC]LP.Proposition 2Z[F_EC]LP=Z[F_S]LP.As pointed out by Veremyev and Boginski (2012), a theoretical comparison of the tightness of the LP relaxation of their formulation [F_R] with that of the LP relaxation of [F_C] is a very challenging task, due to the recursive nature of [F_R]. As we shall show next, the result of the comparison is not independent of the value of k: [F_R] dominates [F_C] for k=3, but the dominance does not hold for k=4.We shall conclude this section by showing that [F_EC] dominates [F_R] for k=3.We shall first show that [F_R] dominates [F_C] for the case k=3. Recalling the rationale presented in the proof of Proposition 2, it is quite intuitive that constraints (7) play an important role in any comparison of [F_R]LP and [F_C]LP for k=3. Given a pair{i,j}∈N3and a node p∈Aij, constraintvpj(2)⩽xpmay cut off feasible solutions of [F_C]LP in the x-space, in a way that bears a clear resemblance with the effect of constraints (22) in [F_EC].Proposition 3For k=3, Z [F_R]LP⩽Z [F_C]LP.Let(X¯,V¯)be feasible for [F_R]LP. We shall assume, without loss of generality, thatv¯ab(2)=minx¯a,x¯b,∑r∈(Na∩Nb)x¯randv¯ab(3)=minx¯a,∑k∈Nav¯kb(2), for all a, b∈V.Let us now build a feasible solution(X¯,Y¯)for [F_C]LP.All packing constraints are satisfied byX¯becausev¯ij(2)=v¯ij(3)=0for all pairs{i,j}∈P3.Let{i,j}∈N3be chosen arbitrarily. If Ni∩Nj=∅, thenv¯ij(2)=0and∑r∈(Ni∩Nj)x¯r=0. Otherwise, letDijbe a complete layered digraph with five layers:L1={i},L2={i′},L3=Ni∩Nj,L4={j′},andL5={j}(where i′ and j′ are copies of i and j, respectively) and arc capacities defined bycap(u,v)=x¯iifu=iandv=i′x¯rifu=i′andv=r∈(Ni∩Nj)∞ifu∈(Ni∩Nj)andv=j′x¯jifu=j′andv=jSuppose that f is a maximum i−j flow inDij. By construction,value(f)=∑r∈(Ni∩Nj)fi′r. If we sety¯t=fi′r, for every chaint=(i,r,j)∈Cij=2, it follows that∑t∈Cij=2y¯t=v¯ij(2). We are now left with variablesv¯ij(3)and chainst∈Cij=3, for all{i,j}∈N3. For every pair{i,j}∈N3, let us build a layered digraphDij, with layers L1={i}, L2={i′}, L3={p:p∈NiandNp∩Nj≠∅},L4=t:t∈Cij=3, and L5={j} (where i′ is a copy of i) and whose set of arcs isAij={(i,i′)}∪{(i′,p):p∈NiandNp∩Nj≠∅}∪∪(p,t):t∈Cij=3andedge(i,p)belongstochaint∪(t,j):t∈Cij=3with arc capacities defined bycap(u,v)=x¯iifu=iandv=i′v¯pj(2)ifu=i′andv=p∈L3∞ifu∈L3andv=t∈L4min{x¯w:wisanodeoft}ifu=t∈L4andv=j.Suppose that f is a maximum i−j flow inDij. By construction,value(f)=∑t∈Cij=3ftj=v¯ij(3). By settingy¯t=ftj, for allt∈Cij=3, it follows that∑t∈Cij=3y¯t=value(f). We can now conclude that∑t∈Cij3y¯t=v¯ij(2)+v¯ij(3)and consequently, since{i,j}∈N3was chosen arbitrarily, that(X¯,Y¯)is feasible for [F_C]LP.□The dominance of [F_R] over [F_C] for k=3 may be strict. An illustration is provided by the graph depicted in Fig. 1(b).The dominance does not hold for k=4, as illustrated by the example presented in Appendix A.Let us now consider [F_EC] and [F_R] for k=3.Let{i,j}∈N3be chosen arbitrarily. In [F_EC] constraints (23) impose that∑p:(p,q)∈Eijypqij⩽xqfor every q∈Bij. In [F_R] constraints (9) impose only thatvij(3)⩽xiandvij(3)⩽∑k∈Nivkj(2). Due to constraints (23), feasible solutions for [F_R]LP on the x-space, may be infeasible for [F_EC]LP. An illustration is provided by the graph depicted in Fig. 2(a).We shall next show that for k=3 [F_EC] dominates [F_R].Proposition 4For k=3, Z [F_EC]LP⩽Z [F_R]LP.We shall show that the projection onto the x-space of the feasible set of [F_EC]LP is included in the projection onto the x-space of the feasible set of [F_R]LP by showing that if(X¯,Y¯)is feasible for [F_EC]LP, then(X¯,V¯)is feasible for [F_R]LP, wherev¯ab(2)=minx¯a,x¯b,∑r∈(Na∩Nb)x¯randv¯ab(3)=minx¯a,∑k∈Nav¯kb(2),foralla,b∈V.We shall assume, without loss of generality, that for all pairs{i,j}∈N3,∑(p,q)∈Eijy¯pqij⩽x¯iand∑(p,q)∈Eijy¯pqij⩽x¯j. Note that, to satisfy constraints (7) and (9),vij(2)andvij(3)cannot assume values greater than the ones they are being assigned, which makes constraints (8) and (10) irrelevant.If{i,j}∈P3, thenv¯ij(2)=v¯ij(3)=0, and consequently,x¯i+x¯j⩽1+v¯ij(2)+v¯ij(3)if and only ifx¯i+x¯j⩽1.Let{i,j}∈N3be chosen arbitrarily.Ifv¯ij(2)=x¯iorv¯ij(2)=x¯j, constraint (6) is satisfied, regardless of the value ofvij(3). Otherwise,v¯ij(2)=∑r∈(Ni∩Nj)x¯r.Ifv¯ij(3)=x¯i, constraint (6) is satisfied, regardless of the value ofvij(2). Otherwise,∑k∈Niv¯kj(2)<x¯iandv¯ij(3)=∑k∈Niv¯kj(2).Let us assume thatv¯ij(3)=∑k∈Niv¯kj(2).By construction,∑(p,q)∈Eijy¯pqij=∑p∈Aij∑q:(p,q)∈Eijy¯pqij.Let p∗ be chosen arbitrarily in Aijand remember we are assuming, without loss of generality, that∑(p,q)∈Eijy¯pqij⩽x¯j.Since∑q:(p∗,q)∈Eijy¯p∗qij⩽∑(p,q)∈Eijy¯pqij, we can conclude that∑q:(p∗,q)∈Eijy¯p∗qij⩽x¯j.By (22),∑q:(p∗,q)∈Eijy¯p∗qij⩽x¯p∗, and by (19),∑q:(p∗,q)∈Eijy¯p∗qij⩽∑q:(p∗,q)∈Eijx¯q=∑q∈Np∗q∈Nj⧹Nix¯q⩽∑q∈Np∗∩Njx¯q.It follows that∑q:(p∗,q)∈Eijy¯p∗qij⩽minx¯p∗,x¯j,∑r∈Np∗∩Njx¯r=v¯p∗j(2)and, therefore∑(p,q)∈Eijy¯pqij⩽minx¯i,∑k∈Niv¯kj(2)=v¯ij(3).Since{i,j}∈N3was chosen arbitrarily, we can conclude that if(X¯,V¯)is feasible for [F_EC]LP, then(X¯,Y¯)is feasible for [F_R]LP.□The study of the relations between [F_EC]LP and [F_R]LP for k=3 gives hints on how to strengthen the recursive formulation from the LP relaxation standpoint for any integer k⩾3. Note that for k=2, [F_C] and [F_R] are essentially the same (Veremyev & Boginski, 2012).For k=3, the dominance of [F_EC]LP over [F_R]LP stems from two reasons: the elimination of all variables that represent chainst=(i,p,q,j)∈Cij=3with p∈(Ni∩Nj) or q∈(Ni∩Nj) in [F_EC] and the lifting effect provided by constraints (23). For any k⩾3, a similar elimination is obtained by replacing (9) with(9′)vij(l)⩽xivij(l)⩽∑k∈(Ni⧹Nj)vkj(l-1)Due to their recursive nature, variablesvij(l)represent paths directed from node i to node j. Given any undirected graph, there is at least one path from i to j if and only if there is at least one path from j to i. Therefore, for any k⩾3, we can add to [F_R] the following conditionsfor l=3, …, k; i, j∈V, j>i,(9″)vij(l)⩽xjvij(l)⩽∑k∈(Nj⧹Ni)vki(l-1)(10′)vij(l)⩾1|V|∑k∈Njvki(l-1)+(xj-1)The resulting enhanced recursive formulation for the k-club problem is[F_ER]max∑i∈Vxi:(6)-(8),(9′),(9″),(10),(10′),(4),(11).By construction, [F_ER] dominates [F_R].Proposition 5Z [F_ER]LP⩽Z[F_R]LP.The dominance of [F_ER] over [F_R] may be strict. An illustration is provided by the graph depicted in Fig. 2(b).It is quite intuitive that if k=3, [F_EC] and [F_ER] are LP-equivalent.The proof of Proposition 6 follows the rationale used in the proof of Proposition 4. A detailed proof is presented in Appendix B.Proposition 6For k=3, Z [F_EC]LP=Z[F_ER]LP.For k=3, formulation [F_C] is dominated both by [F_N] and [F_R], but the dominances stem from different reasons. The dominance of [F_N] over [F_C] is due to the substitution of Eijfor E(Ni,Nj) in the last term of inequalities (13) (Almeida & Carvalho, 2012). The dominance of [F_R] over [F_C] is, roughly speaking, a consequence of (7). It is then natural to suspect that in the x-space the feasible sets of [F_N]LP and [F_R]LP are different and no inclusion relation holds for them.The graph used to illustrate the dominance of [F_R] over [F_C] (see Fig. 1(c)) can also be used to show that in the x-space a feasible solution for [F_N]LP may not be feasible for [F_R]LP.On the other hand, in the x-space a feasible solution for [F_R]LP may not be feasible for [F_N]LP. An illustration is provided by the graph depicted in Fig. 3.Since there is no inclusion relation in the x-space between the feasible sets of [F_R]LP and [F_N]LP, there is no domination relation between [F_R] and [F_N].For the case k=3, neighbourhood formulation [F_N] is more compact than any other formulation in the literature. Since, also for k=3, [F_EC] and [F_S] are LP-equivalent, and [F_S] dominates [F_N], we can conclude that [F_N] is also dominated by [F_EC]. Note that there is no way of imposing constraints on the set of three-edge chains that link each pair of nodes{i,j}∈N3using only node and edge variables. However, it is possible to derive [F_EC] from [F_N] by introducing chain variables and adding valid inequalities for the 3-club polytope.Let us consider again variablesypqij(see Section 5), and let us add constraints (18), (20), (22), and (23) to [F_N]. After adding these constraints, constraints (13) can be replaced with(21)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑(p,q)∈Eijypqij{i,j}∈N3Now, edge variables zijplay no role in the formulation and can be dropped, together with constraints (14). To summarize, (13) and (14) in [F_N] can be replaced with 18 and (20)–(23). Thus, by introducing chain variablesypqijand lifting variable linking constraints, [F_N] is transformed into [F_EC]. This procedure provides an alternative proof of the dominance of [F_S] over [F_N] presented in Almeida and Carvalho (2012).The large number of variables added to [F_N] to transform it into [F_EC] raises the question of the magnitude of the difference Z [F_N]LP−Z [F_EC]LP. An upper bound on this difference is easy to derive by considering a variant of formulation [F_S], denoted by [F_Sγ], which results from replacing constraints (16) with(24)xi+xj⩽1+∑r∈(Ni∩Nj)xr+∑s∈Sij(γs-1)xs{i,j}∈N3,Sij∈Sijwhere γsis the degree of node s in subgraph Gij.Since∑s∈Sij(γs-1)xs⩾1if and only if∑s∈Sijxs⩾1, formulation [F_Sγ] is valid for the 3-club problem. Since γs⩾2 for all s∈SijandSij∈Sij,Z[F_S]LP⩽Z[F_Sγ]LP.We shall next show that [F_N] dominates [F_Sγ].Proposition 7Z[F_N]LP⩽Z[F_Sγ]LP.Let(X¯,Z¯)be feasible for [F_N]LP. For all{i,j}∈N3andSij∈Sij,∑(p,q)∈Eijz¯pq=∑(p,q)∈Eijp∈(Aij∩Sij)q∈Bijz¯pq+∑(p,q)∈Eijp∈(Aij⧹Sij)q∈(Bij∩Sij)z¯pq⩽∑s∈(Aij∩Sij)(γs-1)x¯s+∑s∈(Bij∩Sij)(γs-1)x¯s=∑s∈Sij(γs-1)x¯sandX¯is feasible for [F_Sγ]LP.□The dominance of [F_N] over [F_Sγ] may be strict. An illustration is provided by the graph depicted in Fig. 4.The graphs depicted in Figs. 3 and 4 provide an illustration that there is no dominance relation between [F_Sγ] and [F_C].A k-club is by definition a subset of nodes of a graph which induces a subgraph with diameter at most equal to k. If k is small, a k-club represents a cluster with good connectivity between each pair of its members– every member needs at most k−1 intermediaries to reach any other member. If the underlying graph represents a communication network, the diameter has been considered a natural way of describing the reliability of the network (Boesch, Harary, & Kabell, 1981). However, a k-club is a fragile structure in that if one of its elements breaks down by accident, the communications among members may be severely affected. A k-club is also quite vulnerable to external attacks: the destruction of a selected single element (node or link) may render the communication among members totally impossible. To identify network clusters that combine good connectivity among members with better reliability properties, Veremyev and Boginski (2012) introduced the new concept of R-robust k-club, which extends the original k-club definition by imposing the additional condition that there must be at least R internally node-disjoint paths between every pair of cluster members. A key feature of this new concept is that the elimination of up to R−1 elements will not destroy the k-club structure, which means that the R-robust k-clubs have much better error and attack tolerance characteristics than k-clubs (Veremyev & Boginski, 2012). As pointed out by the authors, developing mathematical programming approaches for finding large network clusters with good error and attack tolerance characteristics is not an easy task.For the case k=2, all distinct paths that link a given pair of nodes i and j are internally node-disjoint, since each path is either edge (i,j) or a two-edge path of the form (i,r,j) with node r in Ni∩Nj. The R-robust 2-club problem is formulated in Veremyev and Boginski (2012) as follows:(25)maxZ=∑i∈Vxis.t.aij+∑k∈(Ni∩Nj)xk⩾R(xi+xj-1)i,j∈V,i<j(4)xi∈{0,1}i∈Vwhere aij=1 if (i,j)∈E and aij=0 otherwise.For k>2, to guarantee that there are at least R internally node-disjoint paths between any pair of nodes it is necessary to identify the inner nodes of each path with more than two edges. In Veremyev and Boginski (2012), thewij(l)variables that represent the number of distinct paths with l edges (l=2,…,k) that link each pair of nodes i and j (i,j=1,…,∣V∣) are defined by recursion, and by its very nature a definition by recursion is incompatible with the identification of inner nodes path by path. For that reason, for k>2 Veremyev and Boginski (2012) considered a relaxation of the R-robust k-club concept, obtained by replacing the original condition “R internally node-disjoint paths” by the relaxed condition “R distinct paths”.The relaxed R-robust k-club problem is formulated in Veremyev and Boginski (2012) with binary node variables xi(i=1,…,∣V∣) and integer path variableswij(l)(i,j=1,…,∣V∣;l=2,…,k)as follows:(26)maxZ=∑i∈Vxis.t.aij+∑l=2kwij(l)⩾R(xi+xj-1)(27)wij(2)⩽∑k∈(Ni∩Nj)xk+|V|(2-xi-xj)(28)wij(2)⩾∑k∈(Ni∩Nj)xk-|V|(2-xi-xj)(29)wij(2)⩽|V|xiwij(2)⩾-|V|xi(30)wij(2)⩽|V|xjwij(2)⩾-|V|xjand forl=3,…,k,(31)wij(l)⩽∑k∈Niwkj(l-1)+|V|l-1(1-xi)(32)wij(l)⩾∑k∈Niwkj(l-1)-|V|l-1(1-xi)(33)wij(l)⩽|V|l-1xiwij(l)⩾-|V|l-1xi(4)xi∈{0,1}(34)wij(l)∈Z+where aij=1 if (i,j)∈E, aij=0 otherwise, and i, j=1, …, ∣V∣.Constraints (26) impose that each pair of selected nodes must be linked by at least R paths with at most k edges. Constraints (27)–(30) define the number of two-edge paths that link each pair of nodes, and constraints (31)–(33) define the number of paths with three or more edges that link each pair of nodes. Constraints (34) define the path variables as nonnegative and integer.While for k=2 the conditions “R internally node-disjoint paths” and “R distinct paths” are equivalent, for k>2 the latter is considerably weaker than the former, since distinct paths may share even all inner nodes. This means that the error and attack tolerance properties of R-robust k-clubs are not guaranteed by conditions (26)–(34) and (4). For k=3, the error and attack tolerance properties of R-robust k-clubs can be guaranteed by adapting formulation [F_EC], as described next.Given a pair of nodes i and j not linked by an edge in G, constraints (22) and (23) impose that at most one chain that includes node p and at most one chain that includes node q can be selected to link them in the induced subgraph. Furthermore, in formulation [F_EC], variablesypqijare defined only for (p,q)∈E such that p∈(Ni⧹Nj) and q∈(Nj⧹Ni). Thus, chains represented by variablesypqijare internally node-disjoint with two-edge chains that link i and j (which are represented by their central nodes). In short, all that is missing to model R-robust 3-clubs is a set of variables to identify each chain with three edges that links pairs of nodes i and j, linked by an edge in G.For each pair of nodes i and j adjacent in G, let us define variablesypqij, with p∈Ni⧹(Nj∪{j}) and q∈Nj⧹(Ni∪{i}). Each variable is associated with one edge inEij1={(p,q)∈E:p∈Ni⧹(Nj∪{j}),q∈Nj⧹(Ni∪{i})}.To obtain a valid formulation for the R-robust 3-club problem, we substitute constraints(37)∑r∈(Ni∩Nj)xr+∑(p,q)∈Eijypqij⩾R(xi+xj-1){i,j}∈N3for constraints (21) and enlarge formulation [F_EC] with the new constraints(38)∑r∈(Ni∩Nj)xr+∑(p,q)∈Eij1ypqij⩾(R-1)(xi+xj-1)(i,j)∈E(39)ypqij⩽xiypqij⩽xj(i,j)∈E(p,q)∈Eij1(40)∑q:(p,q)∈Eij1ypqij⩽xp(i,j)∈Ep∈Ni⧹(Nj∪{j})(41)∑p:(p,q)∈Eij1ypqij⩽xq(i,j)∈Eq∈Nj⧹(Ni∪{i})(42)ypqij∈{0,1}(i,j)∈E(p,q)∈Eij1Conditions (37) and (38) impose that each pair of nodes must be linked by at least R selected chains with at most three edges. Conditions (39)–(41) impose that all nodes in selected chains that link adjacent nodes are included in the solution and that these chains are internally node-disjoint.To summarize, an optimal solution for[F_EC-R]max∑i∈Vxi:(12),(18),(22),(23),(4),(20),(37)-(42)is a maximum 3-club that satisfies the additional condition that every pair of its nodes is linked by at least R internally node-disjoint chains.

@&#CONCLUSIONS@&#
In this paper, we have presented a comparative study of the LP relaxations of integer formulations for the k-club problem. The comparisons involved models known from the literature and three new models. Some models are valid for any k>1 whereas some other were designed for the case k=3.For the case k=3, the connections among all these formulations are synthesised in Fig. 5. For generic formulations [F_∗] and [F_•], [F_∗] → [F_•] means that the LP relaxation of [F_∗] is stronger than the LP relaxation of [F_•], and [F_∗]↔[F_•] means that [F_∗] and [F_•] are LP-equivalent. Thick arrows represent the relations derived in this study and thin arrows represent relations derived in Almeida and Carvalho (2012). A dashed line between [F_∗] and [F_•] means that there is no relation between their LP relaxations.For k=4, we showed that [F_R]LP is not stronger than [F_C]LP.Based on the insight obtained by comparing [F_EC] and [F_R] for k=3, we devised [F_ER] for the k-club problem and showed that it dominates [F_R], for any k>1. In addition, we have derived a formulation for the maximum R-robust 3-club problem. To the best of our knowledge, this is the first formulation in the literature for the maximum R-robust 3-club problem.