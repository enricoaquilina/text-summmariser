@&#MAIN-TITLE@&#
A theoretical framework for quantifying blood volume flow rate from dynamic angiographic data and application to vessel-encoded arterial spin labeling MRI

@&#HIGHLIGHTS@&#
We propose a method for dynamic angiographic blood volume flow rate quantification.This technique is compatible with most types of dynamic angiographic data.We applied this method to vessel-encoded arterial spin labeling angiography.Blood volume flow rate estimates were validated using a flow phantom.Results in the cerebral arteries of healthy volunteers agree with previous studies.

@&#KEYPHRASES@&#
Blood volume flow rate quantification,Magnetic resonance imaging,Dynamic angiography,Vessel-encoded pseudocontinuous arterial spin labeling,Cerebral arteries,

@&#ABSTRACT@&#
Angiographic methods can provide valuable information on vessel morphology and hemodynamics, but are often qualitative in nature, somewhat limiting their ability for comparison across arteries and subjects. In this work we present a method for quantifying absolute blood volume flow rates within large vessels using dynamic angiographic data. First, a kinetic model incorporating relative blood volume, bolus dispersion and signal attenuation is fitted to the data. A self-calibration method is also described for both 2D and 3D data sets to convert the relative blood volume parameter into absolute units. The parameter values are then used to simulate the signal arising from a very short bolus, in the absence of signal attenuation, which can be readily encompassed within a vessel mask of interest. The volume flow rate can then be determined by calculating the resultant blood volume within the vessel mask divided by the simulated bolus duration. This method is applied to non-contrast magnetic resonance imaging data from a flow phantom and also to the cerebral arteries of healthy volunteers acquired using a 2D vessel-encoded pseudocontinuous arterial spin labeling pulse sequence. This allows the quantitative flow contribution in downstream vessels to be determined from each major brain-feeding artery. Excellent agreement was found between the actual and estimated flow rates in the phantom, particularly below 4.5ml/s, typical of the cerebral vasculature. Flow rates measured in healthy volunteers were generally consistent with values found in the literature. This method is likely to be of use in patients with a variety of cerebrovascular diseases, such as the assessment of collateral flow in patients with steno-occlusive disease or the evaluation of arteriovenous malformations.

@&#INTRODUCTION@&#
Angiographic methods, which generate images of blood vessels, are of great importance in the assessment of vascular diseases, such as atherosclerosis. They can provide information on vessel morphology and function which aids clinicians with diagnosis, prognosis and treatment planning in these patients. Vessel-selective angiography provides additional information about the relative importance of each feeding artery which is useful in a number of areas, such as the assessment of collateral blood flow or the evaluation of blood supply to a tumor or arteriovenous malformation. However, many angiographic methods provide only qualitative information on blood flow, making objective comparison across arteries and across subjects difficult.One method that overcomes this restriction is phase-contrast Magnetic Resonance Angiography (MRA) (e.g. Dumoulin and Hart, 1986) which provides quantitative blood velocity and flow rate measurements. However, it is somewhat hampered by long scan times (Miyazaki and Lee, 2008) and by a lack of information regarding the arterial source of downstream blood flow. To achieve blood flow rate quantification from other types of dynamic angiographic data a simple modification of perfusion-based single voxel models (such as Buxton et al., 1998) is not appropriate since there is no flow-dependent accumulation of labeled blood in large vessels. Indeed, the signal contrast measured in these experiments depends directly on blood volume, not blood flow.Flow rate quantification from dynamic angiographic MRI data using a pulsed arterial spin labeling (ASL) preparation has previously been reported (van Osch et al., 2006), but their method requires an extra calibration scan to measure the arterial input function (AIF). Measurement of the absolute AIF is not possible for 2D projection methods such as X-ray digital subtraction angiography (DSA). In addition, for techniques in which imaging cannot commence until the end of a long labeling period, such as those based on continuous ASL (CASL: Williams et al., 1992) or pseudocontinuous ASL (PCASL: Dai et al., 2008), measurement of the early part of the AIF is precluded. This is unfortunate, since these preparations can produce longer boluses of labeled blood than pulsed ASL, improving signal-to-noise ratio (SNR). In addition, vessel-selective labeling with pulsed ASL (Hendrikse et al., 2004; Golay et al., 2005) is restricted to arteries over which a single slab can be positioned, excluding all other vessels. In CASL or PCASL, this restriction does not apply since vessel-selective labeling is performed within a single plane. Such approaches have recently been applied to angiographic imaging by a number of groups (Okell et al., 2010; Robson et al., 2010; Helle et al., 2011), but these studies have been limited to qualitative depictions of flow and the measurement of simple timing parameters.In this study we propose a framework for absolute blood volume flow rate quantification using generic dynamic angiographic data. This involves the fitting of a kinetic model in each voxel, accounting for relative blood volume, delayed blood arrival, bolus dispersion and signal attenuation. A self-calibration method is described for relating the relative blood volume parameter to absolute blood volume in either 2D or 3D acquisitions, using the same data set. Using these results a method for quantifying blood volume flow rate by simulating a very short bolus of labeled blood is described.Here we apply this methodology to dynamic 2D MRI data acquired with a pulse sequence (Okell et al., 2010) which combines a vessel-encoded PCASL (VEPCASL) preparation (Wong, 2007) with a segmented spoiled gradient echo readout (Günther et al., 2002; Sallustio et al., 2008) for which a specific kinetic model describing the signal evolution in a single voxel has recently been described (Okell et al., 2012). This sequence has the advantages of not requiring an invasive procedure, the administration of a contrast agent or exposure to ionizing radiation. However, in principle the proposed method is applicable to any dynamic angiographic imaging modality for which the time course of the relative concentration of labeled blood in proximal arteries is known or can be measured and attenuation of the labeled blood signal can be described. Validation of this method using a flow phantom is presented, along with results of its application in healthy volunteers.Consider a dynamic angiography experiment (as illustrated in Fig. 1) using a rect-shaped bolus of duration, τ, where all of the blood flowing through a defined point in the upstream vessels is perfectly labeled. Assuming that there is no flow pulsatility and that the subject’s physiology remains constant, the volume of blood which is labeled must flow through the vessel network every time period τ. By extension, the volume of this labeled blood which flows into any downstream vessel must also flow through that vessel during every time period τ. Even if the bolus disperses during its passage, by the conservation of mass the volume of labeled blood flowing into the vessel will not be affected. Therefore, the blood volume flow rate within a downstream vessel can be calculated simply as the volume of labeled blood which flows into it divided by the bolus duration, τ.In order to be able to accurately estimate the volume of labeled blood which ends up in a vessel of interest, the entire bolus of labeled blood must be present in that vessel, or its downstream branches, at one point in time. To achieve this, a very short bolus duration can be used to ensure that the spatial extent of the bolus is small. If this is sufficient to ensure that the entire bolus is present in the vessel of interest at one point in time, even in the presence of dispersion, and the total volume of labeled blood within this vessel can be estimated from the measured signal intensity, then this should be sufficient to estimate the blood volume flow rate within that vessel. However, to perform such an experiment would be difficult: in some angiographic modalities a rect-shaped bolus with uniform labeling cannot be achieved, the use of a short labeling duration leads to poor SNR (Okell et al., 2010) and decay of the signal during imaging would further confound the measurement.To overcome these problems, we use a kinetic model which describes the time evolution of the signal in a single voxel from a given feeding artery, incorporating blood volume, arrival time, bolus dispersion and signal attenuation. This model can be fitted to high SNR data acquired using a long bolus duration. Once the model parameters in each voxel have been estimated, the theoretical signal arising from a more ideal very short bolus experiment can be simulated over an arbitrary range of time points, and with the confounding signal attenuating effects removed. After signal calibration, the blood volume within a vessel of interest can be calculated, and thus the blood volume flow rate can be determined. Fig. 2outlines the processing stages required for this approach.The derivation of a kinetic model to describe the signal evolution in a single voxel for dynamic angiography data based on a CASL/PCASL preparation and a spoiled gradient echo readout has been previously reported (Okell et al., 2012). This model can be generalized to any dynamic angiographic data as follows. The signal, S, measured in a single voxel at time t will depend upon the relative concentration of the tracer in a proximal vessel, cin. This tracer takes a time Δt to arrive at the voxel. An additional delay, t′, due to dispersion is modeled by convolution with a dispersion kernel, D(t′). For clarity, the variables used in this paper are listed in Table 1. Note that we have substituted some variable symbols here from Okell et al. (2012) to maintain consistency with other literature.Signal attenuation due to tracer decay and resulting from the imaging method are described by multiplicative factors T and Ψ, respectively. The measured signal is also scaled by the volume of blood within the voxel, v, and a calibration factor, S0, which relates blood volume to measured signal in the absence of signal attenuation, which we combine into a single scaling factor A=S0v. Thus, the measured signal, S, is given by:(1)S(t)=A∫-∞+∞cin(t-t′-Δt)D(t′)T(Δt,t′,t)Ψ(Δt,t′,t)dt′This equation assumes the measured signal is proportional to the volume of the tracer within each voxel. For imaging modalities where this is not the case an appropriate conversion would have to be performed either as a preprocessing step or incorporated into the kinetic model. Note that Eq. (1) can be used to fit data from multiple feeding arteries whose signals have been separated in preprocessing. The fit to the signal from artery j gives Aj=S0vjwhere vjis the volume of blood within the voxel originating from artery j.In the case of CASL/PCASL angiography cin is a rect function with duration equal to the labeling duration, τ:(2)cin(t)=0t<010⩽t<τ0t⩾τNote that although the relative concentration of labeled water takes a value of one here, this does not imply that the labeling efficiency is 100%. A reduced labeling efficiency would result in a global reduction of the measured signal, which is incorporated into the calibration factor, S0.For the VEPCASL data used in this study we chose a gamma variate model for D characterized by sharpness, s, and time to peak, p. In this case T represents decay of the label due to T1 relaxation and Ψ represents signal attenuation due to the imaging radio frequency (RF) pulses. Note that Ψ depends on the time at which blood first arrives in the imaging region, Δtmin, which is determined as an explicit step in preprocessing (described below) rather than being fitted from the data. This leaves four free parameters in each voxel: A, Δt, s and p. The explicit mathematical forms for D, T and Ψ relevant for VEPCASL angiography can be found in our previous paper (Okell et al., 2012).The kinetic model described above allows only relative blood volume to be determined, and hence only relative blood volume flow rate. In order to calculate absolute blood volume flow rates, the calibration factor S0 must be determined. If a 3D angiography acquisition were performed, and provided one or more voxels small enough to fit entirely within an artery could be found, then this should be sufficient for the calibration. Fitting Eq. (1) to such voxels would yield an estimate of A for each feeding artery, the sum of which we define as Atot. In these voxels the sum of v over all feeding arteries must be equal to the voxel volume Δx ΔyΔz, so we can write:(3)S0^≈AtotΔxΔyΔzvoxelswithinarteriesIn a 2D acquisition, where a thick slab is imaged to yield a 2D projection of the vascular network, the volume of blood leading to the measured signal is unknown since it only occupies a portion of the slab thickness. However, if a vessel can be identified that runs parallel to the imaging plane, and if it is assumed that the cross section of that vessel is approximately circular, then measurements of vessel diameter,d¯, within the imaging plane can be used to estimate the volume of blood producing the measured signal and therefore S0. For example, plotting a profile of Atot against distance, d, perpendicular to the vessel direction (see Fig. 3) allows a fit to bothd¯and S0 simultaneously by considering the equation for a circle, to give:(4)Atot(d)=S0ΔxΔyd¯2-4(d-d0)2|d-d0|⩽d¯/20|d-d0|>d¯/2where d0 is the location of the center of the vessel.The volume flow rate of blood, Fg, in a given vessel, g, is given by the volume of blood passing through it per unit period of time. As discussed above, under constant flow rate conditions, the volume of labeled blood which flows into this vessel, Vg, arises from experimentally imposed labeling for a time τ, and thus must flow into this vessel during every time interval, τ. Therefore, the volume flow rate through this vessel can be written as:(5)Fg=Vg(τ)τAs mentioned previously, in order to get an accurate estimate of Vg, the labeled bolus must be entirely contained within vessel g and the imaging region. In addition, signal attenuating effects must not be present. This can be achieved by using the parameter estimates derived from fitting the kinetic model described above to the data in order to simulate the signal, S′, in each voxel that would have arisen from a very short labeling duration, τ′, in the absence of signal attenuating effects (i.e. T=Ψ=1):(6)S′(t)=A∫t-Δt-τ′t-ΔtD(t′,s,p)dt′Summing this simulated signal across a mask encompassing vessel g (which may include its downstream branches) and dividing by the calibration factor S0 gives an estimate of the labeled blood volume within the vessel at the specified time. For times during which the simulated bolus lies entirely within the mask and imaging region, the volume flow rate can be estimated as:(7)F^g=1τ′∑vesselmaskS′(t)S0Fgshould be independent of the time at which it is measured. Therefore, for any t where the labeled bolus is still located within the vessel mask and has not moved out of the imaging slab or started exchanging with tissue, the same volume flow rate should be calculated. CalculatingF^gat multiple time points thus provides an opportunity to test the model and obtain a more robust estimate. Fig. 4shows schematically the expected variation in the estimated blood volume flow rate within a vessel mask over a range of simulated time points.It is noted that in cases where dispersion is very significant or where the vessel segment of interest is small, the simulated bolus may not lie entirely within the vessel mask and imaging slab at any of the simulated time points. In such cases the volume flow rate will be underestimated.All experiments performed for this study were undertaken using a 3 Tesla Siemens MRI scanner (both TIM Verio and TIM Trio, Siemens Healthcare, Erlangen, Germany) using a 12 channel head coil for signal reception and body coil for transmission.A flow phantom was used to validate the proposed method by allowing comparison between known volume flow rates and those estimated using the method described above. The phantom consisted of a variable speed water pump (Ismatec SA, Zürich) connected to a long rubber tube with an internal diameter of approximately 4mm. Two sections of this tube were secured to a foam pad inside the scanner bore with water running in opposite directions in the two sections. This foam pad was placed within the head coil along with a water bottle phantom to ensure appropriate coil loading.A 3D time-of-flight (TOF) sequence was used for phantom localization and planning of the vessel-encoded scans. An additional TOF scan was acquired using the body coil for signal reception to allow correction for the variation in the head coil sensitivity across the field of view. 2D time-resolved VEPCASL angiography data were acquired as described by Okell et al. (2010) (voxel size 1.1×1.1mm interpolated to 0.55×0.55mm, slab thickness 50mm, temporal resolution 55ms, 20 time frames) with the exception that only four encoding cycles were necessary to separate the signal from the two tubes: non-selective tag, non-selective control, tag right tube whilst controlling left and tag left tube whilst controlling right. Acquisitions were performed over a range of flow phantom velocities. The true volume flow rate was measured during each acquisition by recording the time taken for the outlet tube to fill a measuring beaker to a fixed volume. This was repeated three times and the fixed volume divided by the average time taken to give the volume flow rate in ml/s.Six healthy volunteers with no known neurological disease (4 male, age range 24–39; mean age 32) were recruited and scanned under a technical development protocol agreed with local ethics and institutional committees. A 3D TOF sequence was used for planning the vessel-encoded acquisitions. Six-cycle vessel-encoded dynamic angiography acquisitions (as per Okell et al., 2010) in transverse (50mm imaging slab) and coronal (100mm imaging slab) views centered on the circle of Willis were also performed. A sagittal acquisition was not performed due to overlap of vessels in this view. These source data have been used in previous publications (Okell et al., 2010; Okell et al., 2012).Preprocessing was performed as per Okell et al. (2012), including separation of vascular components using a maximum a posteriori (MAP) Bayesian solution (method BT3 Chappell et al., 2012) to the general framework for vessel-encoded analysis (Chappell et al., 2010), phase correction to convert the complex signals to real signals, correction for coil non-uniformity, determination of earliest blood arrival in the imaging region (Δtmin) and fitting of the kinetic model in high signal voxels for each feeding artery using a Bayesian framework.The generation of the high signal mask was modified slightly for data in the coronal view (including for the flow phantom data) since it was noted that in very proximal vessels the blood washes out very rapidly, leading to a low mean signal and therefore exclusion from the mask. To overcome this limitation another mask was created in the same manner using the maximum, rather than the mean, signal over time, and the intersection of these two masks was used for the fitting.Pre-processing of the flow phantom and healthy volunteer data differed slightly: for the flow phantom, the signal was separated into contributions from water originating from the two tubes plus static water. In healthy volunteers, the signal was separated into contributions from static tissue plus the four main brain feeding arteries: namely the right and left internal carotid arteries (RICA and LICA) and vertebral arteries (RVA and LVA). In addition, correction for coil non-uniformities in the flow phantom data was performed using a body coil image as a reference, since the segmentation approach taken originally for human subjects is not appropriate for such a phantom.Since the experimental data collected in this study consisted of 2D projections from thick slabs it was necessary to determine the blood calibration factor using the 2D method described above. Once the kinetic model fitting was complete a map of the parameter A, which is proportional to blood volume, was used to calibrate the signal. First, A was summed across all feeding arteries to give Atot, which is proportional to the total blood volume within each voxel. The calibration factor, S0, was then determined by fitting Eq. (4) to a profile of Atot through ten manually-selected vessel segments. The TOF images were used to ensure that the chosen vessel segments were running approximately parallel to the imaging plane. S0 was then taken as the average of these measurements. In the transverse acquisitions this corresponded to three profiles through both left and right proximal middle cerebral arteries (M1 segments) and two profiles through both left and right proximal posterior cerebral arteries (P2 segments). In coronal acquisitions, four profiles were drawn through both left and right internal carotid arteries (two through the C1 segments and two through the C3 segments, as defined by Bouthillier et al. (1996)) and two through the distal basilar artery. To account for uncertainty in S0 the standard error of its mean value was calculated. This uncertainty was propagated through to the flow rate quantification stage.Volume flow rate quantification was performed by simulating the signal, S′, from a very short bolus duration (τ′=1ms) in the absence of T1 decay and RF effects (using Eq. (6)). Note that the choice of τ′ should not have a significant impact on the flow rate quantification if it is small relative to dispersion of the bolus (i.e. p and 1/s). In our experiments in the cerebral vessels 1/s is on the order of 100ms. To ensure that the measured volume flow rates were not dependent on the choice of τ′, the processing of the flow phantom data was performed at a range of τ′ values.In order to propagate uncertainties in the fitting procedure through to the flow rate quantification a numerical estimate of the covariance matrix associated with the parameters was recorded as part of the fitting procedure (Okell et al., 2012). The parameter covariance matrix was used to determine a grid of points in parameter space over which the mean and variance of the simulated signal, S′, were calculated, weighted by the true posterior probability of the parameters given the data.As shown in Fig. 4 the estimated volume flow rate within a given vessel mask is expected to plateau during the time that the bolus is entirely within the mask. To estimate this plateau region the approximate start and end times of the bolus passage through the mask were determined by thresholding the estimated volume flow rate at 20% of its maximum. Assuming the plateau occupies a significant proportion of this broad peak, the median value within it should be approximately equal to the volume flow rate within the plateau region and should also be relatively insensitive to noisy peaks and troughs in the curve. The plateau region was defined as the interval bounded by the times at which the estimated volume flow rate first and last exceeds this median value. The final estimated flow rate and its error were calculated as the mean and standard deviation within this plateau region.Quantification was performed within a number of masks which were drawn manually for each data set (examples shown in Fig. 5). In the transverse view these encompassed the right and left middle cerebral arteries (RMCA and LMCA) and posterior cerebral arteries (RPCA and LPCA) along with both anterior cerebral arteries (ACAs), which were considered together due to their proximity. In the coronal view the MCAs and ACAs were also analysed, but the more proximal coverage also allowed flow quantification in the right and left internal carotid arteries (RICA and LICA) and the combined flow in the vertebral and basilar arteries (VAs and BA). This larger mask ensured that the whole simulated bolus was contained within it. Note that the PCAs were not analysed in the coronal view as they overlap considerably with other vessels, rendering attempts at quantification inaccurate.

@&#CONCLUSIONS@&#
The method described in this paper allows the quantification of blood volume flow rates using dynamic angiographic data. Its self-calibrating nature avoids the need for additional calibration scans. Results were presented from vessel-encoded arterial spin labeling data of the cerebral blood vessels, allowing the separate assessment of blood flow from each main brain-feeding artery. Validation was performed using a flow phantom, showing excellent agreement with the known flow rate, particularly below about 4.5ml/s. Flow rate measurements in healthy volunteers agree well with the literature, except in the anterior cerebral arteries which were not contained sufficiently within the imaging region, although this could be remedied by extending the size of the imaging region in future experiments.It is hoped that the quantitative information provided by this method could help with the assessment of collateral blood flow, treatment planning, and allow the more objective assessment of longitudinal changes to blood flow patterns over the course of a disease and the response to treatment.