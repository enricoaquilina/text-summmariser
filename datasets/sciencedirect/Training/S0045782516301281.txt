@&#MAIN-TITLE@&#
Algebraic approximation of sub-grid scales for the variational multiscale modeling of transport problems

@&#HIGHLIGHTS@&#
Transport-Equivalent Scaling (TES) for algebraic VMS models is introduced.TES leads to intrinsic time scales expressions suitable for generic transport systems.The convergence process of TES and other standard approximations is investigated.Method validated with incompressible, compressible, magnetohydrodynamic benchmarks.TES is suitable for the seamless unified handling of incompressible and compressible flows.

@&#KEYPHRASES@&#
Variational Multiscale,Stabilized Finite Element Method,Intrinsic time scales,Transport problem,Incompressible–compressible flow,Magnetofluiddynamics,

@&#ABSTRACT@&#
Variational Multiscale (VMS) Finite Element Methods (FEMs) are robust for the development of general formulations for the solution of multiphysics and multiscale transport problems. To obtain a tractable and computationally efficient model, VMS methods often rely on a residual-based algebraic approximation of the sub-grid scales (small or unresolved features of the solution field not captured by the discretization) using a so-called intrinsic time scales matrix, which depends on the problem’s overall differential operator and represents the main model parameter. A novel technique for approximating the intrinsic time scales matrix for generic transport problems in a relatively inexpensive manner (e.g., does not rely on eigenvalue computations) is presented. The method is denoted Transport-Equivalent Scaling (TES) and is based on the monolithic casting of the transport problem as a system of transient–advective–diffusive–reactive (TADR) equations and a subsequent scaling of the coefficient matrices such to preserve each type of transport flux. An algebraic VMS formulation incorporating the TES method is complemented with a discontinuity-capturing (DC) approach and implemented within a FEM solver for the solution of TADR problems. The solution of the global discrete system is accomplished using a generalized-alpha time-stepper together with a globalized inexact Newton–Krylov nonlinear solver. The effectiveness of the TES formulation is verified with the simulation of benchmark incompressible, compressible, and magnetohydrodynamic flow problems. The results demonstrate that the TES method seamlessly handles incompressible–compressible flows in a unified manner (e.g., without assessing the compressibility of the flow). The convergence process using the TES approach and a more standard approximation for the intrinsic time scales, as well as the effect of the DC approach, are also investigated. Analysis of the intrinsic time scales for a one-dimensional incompressible flow model reveals the similitudes and differences between the TES formulation and other conventional methods.

@&#INTRODUCTION@&#
A wide variety of transport problems (e.g. turbulent, multi-phase, reactive, combustion, and plasma flows) can generally be expressed as systems of transient–advective–diffusive–reactive (TADR) equations  [1]. These problems are typically multiscale, given that the solution presents distinct characteristics in different parts of the domain according to the relative dominance of the different terms in the equations (e.g., advection or diffusion dominated). Numerical discretization schemes (e.g., Finite Difference, Finite Volume, or Finite Element Methods) not designed for the handling of multiscale problems may display lack of stability or spurious features in some regions of the domain. This is particularly the case in locations interfacing regions with different dominant physical behavior (e.g., an advection-dominated region next to a diffusion-dominated one). Such regions are often manifested as boundary and internal layers, e.g. as found in viscous or thermal boundary layers in internal flows, shocks in supersonic flows, or reactions fronts. Specialized methods have often been devised for the appropriate handling of specific multiscale phenomena, such as upwinding approaches for the solution of advection-dominated advective–diffusive problems  [2].Stabilized Finite Element Methods (FEMs) form a framework to overcome the lack of stability in the basic Galerkin approach for the solution of transport problems, which are inherently multiscale, by adding a residual-based stabilizing term. Stabilized formulations play a significant role in the reliable modeling and simulation of transport problems, specially fluid flows  [3]. Stabilized FEMs are consistent given that the added stabilization term is proportional to the residual form of the equation. Furthermore, this term is often of the same order as the finite element discretization, which ensures preserving the original order of convergence of the discretization. There exist different types of stabilization approaches, such as Streamline Upwind Petrov–Galerkin (SUPG)  [4–6], Galerkin Least Squares (GLS)  [7,8], and Pressure Stabilizing Petrov–Galerkin (PSPG)  [9,10].Among Stabilized FEMs, the Variational Multiscale (VMS) method developed by Hughes and collaborators  [11] represents one of the most robust techniques for the modeling of multiscale phenomena. Further developments of the VMS method have been presented by Hughes et al.  [12,13], Codina  [14,15], and Hauke  [16], who addressed the modeling of sub-grid scales (small or unresolved features of the solution field not captured by the discretization) by using a residual-based algebraic approximation. The VMS approach constitutes a framework for the development of comprehensive and robust formulations for the solution of multiphysics and multiscale transport problems. VMS methods have proven robust and efficient strategies for the modeling and simulation of diverse types of flow problems, as evidenced by the works reported in  [15,17–19] on incompressible flows,  [20–22] on compressible flows,  [23–26] on transitional and turbulent flows,  [27] on reactive flows,  [28] on radiative transport problems, and  [29–31] on plasma flows. The VMS framework is ideally suited for the development of coarse-grained models, particularly as those required for the simulation of fluid flow turbulence. Examples of the use of VMS methods for the turbulent flows can be found in  [32–34], where a three scale separation method is developed and applied. Variational Multiscale Large Eddy Simulation (VMS-LES) is a relatively new method which circumvents the assumptions in traditional LES (a technique for the numerical simulation of turbulent flows based on scale separation  [35]) by using a variational decomposition of scales together with a residual-based approximation of the small scales. VMS-LES represents the state-of-the-art for the modeling and simulation of turbulent flows (e.g., incompressible  [26,36–40], compressible  [21,41], and magnetohydrodynamic  [42] flows).Variational Multiscale methods often use a residual-based algebraic approximation of the sub-grid scales to obtain a tractable and computationally efficient discrete model. The approximation relies on a so-called intrinsic time scales matrixτ, which depends on the problem’s overall differential operator and represents the main model parameter. There are numerous approaches to obtain an expression forτ; most of them require certain amount of empiricism for multi-dimensional and coupled problems  [2,3,6,16,21,43–45].Pioneer work on the formulation of intrinsic time scales matrices was done by Hughes and collaborators [4,5,46], who focused on advective–diffusive problems and the incompressible Navier–Stokes equations. Following these researchers, Tezduyar and Park  [47] presented a model forτbased on the SUPG method for steady-state coupled nonlinear convection–diffusion–reaction systems. Idelsohn et al.  [48] proposed a two-parameter Petrov–Galerkin formulation to correct for the lack of symmetry with respect to the fundamental governing parameters in Tezduyar and Park approach. The discontinuity-capturing directional dissipation (DCDD) stabilization method, which is based on the solution gradient and involves a second element length scale was introduced and investigated in  [49–52] for flow fields with sharp gradients.The stabilization parameterτincludes a measure of the local length scale (element length) and other parameters such as the local Reynolds or Péclet number. Various element length definitions to be used inτhave been proposed, starting with those in  [4,53] followed by the one introduced in  [47]. Moreover, several definitions ofτdependent upon spatial and temporal discretizations were introduced and tested in  [54]. Various intrinsic time scales matrices which are applicable to higher-order elements were proposed by Franca et al.  [55]. Tezduyar and Osawa  [3] introduced an alternative strategy for computingτusing the element-level matrices and vectors involved in Stabilized FEM formulations, which is potentially suitable for general transport problems.In order to deal with multiscale phenomena prevalent in physics and engineering problems, a precise definition ofτwas developed by Hughes  [11] who clearly showed the connection between Stabilized and Variational Multiscale methods. Furthermore, Hughes and Mallet  [6] determined a definition for the intrinsic time scales matrix based on the SUPG concept suitable for multidimensional advective–diffusive systems by generalizing the definition ofτfor the restricted case of steady state simulations. Shakib et al.  [56] presented a more general definition ofτwhich could be used for unsteady space–time cases. Theirτwas formulated first for the pure advection and then adjusted for the presence of diffusion. The definition ofτbased on a space–time FEM discretization presented by Shakib et al. is suitable for general transport systems, but it is also arguably computationally expensive given that it requires multiple computations of eigenvalues.Furthermore, besides the different approaches developed for computingτin incompressible flow regimes, approaches for compressible flows include the work by Beau et al.  [57] and Aliabadi et al.  [58] who present a simple option for handling the intrinsic time scales matrix for entropy and conservation variables. Additionally, for the compressible Navier–Stokes equations based on primitive variables including pressure, Hauke  [59] presented a couple of sets of simple stabilizing matrices which are easy to implement and compete in quality with the standard expression emanating from the eigenvalue problem.Codina and collaborators introduced developments of residual based stabilization methods using orthogonal and time dependent subscales  [60–64]. In contrast to other stabilized methods, Codina and Principe  [63] proposed a VMS FEM approximation for thermally coupled incompressible flows that considered the subscales as transient and solved the effect of subscales in all the terms of the equations, both the nonlinear convective terms of the momentum and the heat equation and, if required, in the thermal coupling term of the momentum equation due to the Boussinesq model. The idea of allowing the subscales to depend on time avoids several inconsistencies found in most Stabilized FEM formulations  [64].Most approaches for computing the intrinsic time scales matrix have been developed for particular types of problems and only a few have been designed for general transport problems (e.g.,  [6,56]). The latter are relatively computationally expensive, as they require the computation of eigenvalues and/or multiple matrix square-root evaluations. This fact has motivated the development of the presented method for approximatingτfor generic transport problems in a relatively inexpensive manner. The method is denoted as Transport-Equivalent Scaling (TES) and is based on the monolithic casting of the transport problem as a system of TADR equations and a subsequent scaling of the coefficient matrices such to preserve each type of transport flux. The effectiveness of the TES method is verified with benchmark incompressible, compressible, and magnetohydrodynamic flow problems. Particularly, the results demonstrate that the TES approach seamlessly handles incompressible–compressible flows in a unified manner (i.e., without assessing the compressibility of the flow, such as evaluating the Mach number).A new technique for computing the intrinsic time scalesτfor the handling of generic transport problems (this is, without prior analysis of the system of TADR equations describing the transport model) in a relatively inexpensive manner is presented. Section  2 describes the algebraic Variational Multiscale formulation for the modeling of TADR systems. Section  3 presents the new definition of the intrinsic time scales matrix based on the concept of TES to model the sub-grid scales, together with alternative approaches that are not suitable for generic transport problems or are problem-specific. Section  4 introduces a discontinuity-capturing operator to complement the VMS formulation in order to increase the robustness of the method. Section  5 describes the numerical solution approach based on the generalized-alpha predictor multi-corrector time-stepper together with a globalized inexact Newton–Krylov nonlinear solver. Section  6 demonstrates the effectiveness of the proposed formulation through simulations of incompressible, compressible, and magnetohydrodynamic benchmark problems. The analysis of different techniques for computing the intrinsic time scales matrix is presented in Section  7. Summary and conclusions are presented in Section  8. Appendix presents the intrinsic time scales matrix for two-dimensional steady-state incompressible flows obtained using different approaches to complement the material in Section  7.The algebraic VMS formulation in the present work is applied within the context of the FEM. A wide range of multiphysics and multiscale flow problems can be treated in a fully coupled monolithic manner as a single transient–advective–diffusive–reactive (TADR) transport system for the vector of unknownsYas:(1)R(Y)=A0∂tY︸transient+(Ai∂i)Y︸advective−∂i(Kij∂jY)︸diffusive−(S1Y+S0)︸reactive=0,whereRrepresents the TADR residual,A0,Ai,Kij,S1are coefficient matrices used to describe each transport process,S0is a vector,ttime,iandjare spatial indexes (e.g., for a three-dimensional problem in Cartesian coordinates:i,j=x,y,z), and Einstein’s convention of repeated indexes has been adopted. Eq. (1) needs to be complemented by the specification of initial and boundary conditions.The strong form of the transport problem for vectorY(t,X), where(t,X)∈R+×Rnd, defined over the spatial domainΩ⊂Rnd(i.e.,Y:R+×Rnd→Rnv), wherenvandndrepresent the number of variables and spatial dimensions, respectively, can be expressed by  [31]:(2)∀X∈Ω,t>0:R(Y)=LY−S0=0,(3)∀X∈Ω,t=0:Y=Y0,(4)∀X∈Γp,t>0:Y=p,and(5)∀X∈Γq,t>0:−niKij∂jY=q1Y+q0,whereLis the total transport operator given by:(6)L=A0∂t+Ai∂i−∂i(Kij∂j)−S1.Eq. (2) is a re-statement of Eq. (1); Eq. (3) represents the specification of initial conditions, Eq. (4) specified-value (Dirichlet) boundary conditions over the part of the boundaryΓp, and Eq. (5) the specified-flux (Neumann or Robin) boundary conditions overΓq, withnas the outer normal toΓq. The boundary of the domain is∂Ω=Γ=Γp∪Γq, withΓp∩Γq=∅. The above formulation of the TADR problem, following  [14], assumes that the matricesKijare positive-definite.The VMS method uses the Variational (also called weak) form of Eq. (2), namely:(7)(W,R(Y))Ω=0,where(⋅,⋅)Ωindicates the bi-linear operator(f,g)Ω=∫Ωf⋅gdΩ, andWis the test function (belonging to an appropriate functional space consistent withYand the definition of the problem in Eqs. (2)–(5), see  [31]). There are at least two major aspects that need to be addressed for the formulation of a VMS model, which are scale decomposition and approximation of the small scales  [12,14,24,26,33,65–67]. Similarly to  [68,14], let the solution fieldYbe decomposed into a large (coarse, grid-scale) componentȲand a small (fine, sub-grid) scale componentY′, i.e.,(8)Y=Ȳ+Y′.The large scale corresponds to the solution field described by the discretization of the problem, whereas the small scale represents the part of the solution that cannot be captured by the discretization. A similar decomposition is applied toW(i.e.,W=W̄+W′). The above decomposition implies decomposition of the continuous spaceVwhereYandWbelong (i.e., the spaceV=(H1(Ω))nv=V̄⊗V′,Ȳ∈V̄,Y′∈V′, whereH1(Ω)denotes the Sobolev space of functions having square-integrable first derivatives inΩ, and the spaceV̄is formally defined by the use of a projector operator  [15,66]). Using the scale decomposition and assuming that the transport operator introduced in Eq. (6) is linear, the original problem is casted into a set of two problems, one for the large and another for the small scales, namely:(9)(W̄,R(Ȳ)+LY′)Ω=0and(W′,R(Ȳ)+LY′)Ω=0.The VMS formulation strives to obtain an equation for the large scales alone. Towards that end, by using adjoint duality (e.g.,(a,Lb)=(L∗a,b))  [66], the equation for the large scales becomes:(10)(W̄,R(Ȳ))Ω+(L∗W̄,Y′)Ω=0,where the superscript∗indicates the adjoint operator. The first term in Eq. (10) is equivalent to the standard Variational (Galerkin) formulation of the problem (Eq. (7)), whereas the second term depends parametrically onY′and aims to model the part of the solution that cannot be captured by the discretization. The solution for the small-scales problem can be expressed by:(11)Y′=−L−1R(Ȳ),where the operatorL−1is formally defined in terms of the Green’s function for the total transport operatorLand the projector operator  [66]. Up to this point, no approximation has been used in the formulation, given that solving the small-scales problem (Eq. (11)) is at least as complex as solving the original problem (Eq. (2)). To obtain a tractable and computationally efficient model, the VMS formulation relies on approximating the small scales given by Eq. (11). In particular, the algebraic VMS formulation relies on approximatingL−1locally with an algebraic operatorτ, i.e.,(12)τ≈L−1,whereτis the so-called intrinsic time scales matrix. With this approximation, the Variational Multiscale formulation of Eq. (2) forYleads to the following problem for the large scales only:(13)R̄(W̄,Ȳ)=(W̄,(A0∂t+Ai∂i−S1)Ȳ−S0)Ω+(∂iW̄,Kij∂jȲ)Ω+(W̄,q1Ȳ+q0)Γq︸large scales+((A0T∂t+AiT∂i+∂i(KijT∂j)+S1T)W̄,τ((A0∂t+Ai∂i−∂i(Kij∂j)−S1)Ȳ−S0))Ω′︸small scales+(∂iW̄,KijDC∂jȲ)Ω′︸discontinuity capturing=0,whereR̄(⋅,⋅)represents the bilinear form describing the residual of the VMS problem, and the superscriptTis the transpose operator. The first three terms at the right-hand-side of Eq. (13) are equivalent to the standard Variational (Galerkin) formulation of the problem; the fourth term represents the modeling of the small scales, and the last term is a so-called discontinuity-capturing (DC) operator, which adds robustness to the solution process in the presence of large gradients, withKijDCas the discontinuity-capturing diffusivity matrix. Note that the operator applied toW̄in the small scales term does not correspond exactly to the operatorL∗given the spatial dependency ofAiandKij. Furthermore,Ω′indicates a counterpart ofΩsuitable for the evaluation of the extra terms. Details about the VMS formulation used, including further simplifications to Eq. (13) and implementation details, are found in  [31].It is to be noted that the method in Eq. (13) with the definitions ofτandKijDCto be presented (Sections  3 and 4), unlike other approaches such as the ASGS method in  [14], is not invariant under change of variables (i.e., change of unknowns and/or vectorS0). Consequently, the method depends on the specific choice of variables used. The test problems solved in Section  6 use sets of primitive variables. The choice of primitive variables is motivated by the work of Hauke and Hughes  [20] that demonstrated the advantages of their use, especially for the unified handling of incompressible and compressible flows. Conservation variables, which have been considered to be the optimal variables for compressible flows, cannot be employed in the incompressible limit and therefore need to be abandoned. The use of entropy variables, which produces symmetric matricesA0,Ai,Kij, seems an appealing alternative; but their use would require finding a suitable entropy function, which is not trivial for general transport problems  [68].The intrinsic time scalesτis the main modeling component of the VMS formulation. The role of this operator is to approximate the inverse of the total transport operatorL, i.e.,(14)τ≈L−1=(A0∂t+Ai∂i−∂i(Kij∂j)−S1)−1,where the superscript−1represents the inverse operator. It is crucial to consider that finding the inverse ofLis at least as difficult as solving the original problem. Therefore, for computational convenience,τis defined as an approximation only; particularly, as a local algebraic approximation. A general form forτreads:(15)τ=(ct(Ã0⋅GtÃ0)d2+ca(Ãi⋅GijÃj)d2+cd(K̃ijGij:GijK̃ij)d2+cr(S̃1⋅S̃1)d2)−1d,wheredandct,a,d,rare parameters of the approximation;Ã0,Ãi,K̃ij,S̃1are approximate transport matrices counterparts to the transport matricesA0,Ai,Kij,S1respectively;Gtis a temporal metric (or operator for a dynamic approximation  [64,69]), andG={Gij}the spatial metric tensor that provides a local measure of the spatial discretization used.GtandGijare defined as:(16)Gt=(ntΔt)2and(17)Gij=∑k=13∂ξk∂xi⋅∂ξk∂xj,whereΔtis the time step size,nta constant function of the accuracy of the temporal discretization (e.g.,nt=2for second order methods);X={xi}i=13denotes the coordinates of elementKin physical space, andξ={ξi}i=13denotes the coordinates of elementK⌢in isoparametric (local) space (e.g., for a uniform quadrilateral Cartesian mesh with elements of sizeh,δijh2=Gij−1(no sum) whereδijis the Kronecker delta (i.e.δij=1ifi=j, and zero otherwise)). (The simulations in Section  6 use bi-linear quadrilateral and tri-linear hexahedral finite elements.) It is assumed thatX=X(ξ):K⌢→Kis a continuously differentiable mapping with a continuously differentiable inverse. Moreover, Eq. (15) considers that the projector operator (to map variables from the large to the small scales space) is equal to identity matrixI; a better approach is given by Codina  [70] who developed the concept of orthogonal sub-scales.In the present work, the constantsct,a,d,rare set equal to one, as well as the parameterd(typicallydis set equal to 1  [14,31] or 2  [20,26]). The algebraic approximation of the intrinsic time scales matrix used here can alternatively be expressed as:(18)τ=(τt−1+τa−1+τd−1+τr−1)−1,where the subscriptst,a,d, andrare used to indicate transient, advective, diffusive, and reactive intrinsic time scales, respectively. Thus, the approximation ofτimplies finding approximations for each type of transport time scales (e.g., an advective time scale is given byτa≈(Ãi⋅GijÃj)−12).Eq. (15) is associated with at least two major issues. One is due to the computational cost, in particular the cost of computing matrix square roots and/or inverses. The other issue is regarding the physical dimensionality of each transport equation (i.e., physical units of each variable and coefficient). The definition ofτgiven by Eq. (15) is valid only if the variables for each transport equation are dimensionally equivalent (e.g., if each unknown is made non-dimensional, or if entropy variables are used  [20,71]) or if the approximate transport matrices are diagonal.The main motivation for working with approximate transport matrices is to find a definition ofτthat provides an adequate description of the sub-grid scales that is relatively inexpensive to compute. Furthermore, it is highly desirable to have these matrices such that Eq. (15) is valid for generic transport problems; this is,τprovides adequate modeling of the sub-grid scales independently of the specific structure of the transport matrices.The approximate transport matrices can be computed based on different approximations. The simplest approach is extracting the main diagonals of the corresponding transport matrices, i.e.,(19)Ã0=diag(A0),(20)Ãi=diag(Ai),(21)K̃ij=diag(Kij),and(22)S̃1=diag(S1),where the diagonal operatordiag(⋅)is defined such that given matricesM={Mij}andN={Nij},(23)N=diag(M)={δijMii},whereδijis the Kronecker delta. The Diagonal (Diag.) approximation may be appropriate if the matricesA0,Ai,Kij, andS1, are mostly diagonal dominant (e.g., for some compressible fluid flows with marked compressibility throughout the domain, or for uncoupled scalar transport systems). But, in general, the Diagonal approximation of the transport matrices faces several limitations. For instance, it leads to a null intrinsic time scale for a variable whose transport equation does not display non-zero elements along the diagonal of the transport matrices; or, a skew-symmetric matrixS1should affect the stability of the formulation while Eq. (22) neglects such contribution.The present work introduces Transport-Equivalent Scaling (TES) as a new technique for approximating the transport matrices suitable for the handling of generic transport problems using the definition ofτin Eq. (15). For general transport problems, as those with non-diagonal dominant transport matrices (as found in incompressible, reactive, or magnetohydrodynamic flow models), the Diagonal approximation ofA0,Ai,Kij, andS1is not adequate. To address the potential lack of diagonal dominance of the transport matrices while maintaining dimensional consistency, the TES method is based on the use of the following expressions:(24)Ã0=sdiag(A0,∂tY),(25)Ãi=sdiag(Ai,∂iY),(26)K̃ij=sdiag(Kij,∂iY),and(27)S̃1=sdiag(S1,Y),where the scaled diagonal operatorsdiag(⋅,⋅)is defined such that given matricesM={Mij},N={Nij}, and vectorS={Si}, then:(28)N=sdiag(M,S)={Nij},where:Nij={δij∑k(SkSi)Mikif|Si|>εδijMiiif|Si|≤ε.In Eq. (28)εis a small numerical parameter to avoid division by zero. Numerical tests (Section  6) have shown that its value has negligible effect on the final solution as long as it is small enough (i.e.,ε∼10−7or smaller for double-precision calculations).The definition of approximate transport matrices above ensures preservation of each type of transport flux, i.e.,Ft=A0∂tY=Ã0∂tY,Fia=Ai∂iY=Ãi∂iY(no sum),Fid=Kij∂jY=K̃ij∂jY, andFr=S1Y=S̃1Y, whereFt,Fia,Fid, andFrare transient, advective, diffusive, and reactive transport fluxes, respectively. Such property motivates the denomination of the method as Transport-Equivalent Scaling. (Note that this characteristic of TES applies even if any derivative ofYis zero (and hence the|Si|<εcondition in Eq. (28) applies) given that in such situation the corresponding transport flux is also equal to zero.)The use of the TES approximation makesτa function of the solution vectorYand its derivatives (∂tY,∂iY) and hence renders the method highly nonlinear, which potentially affects the convergence process. Given that the inclusion of the discontinuity-capturing operator in Eq. (13) makes the VMS formulation nonlinear, even for linear problems, no added algorithmic cost to the overall formulation is implied (i.e., Eq. (13) implies a non-linear system of equations, even for constant transport matrices). The definition ofKijDCused in the VMS formulation is addressed in Section  4; and the effect of TES on the convergence process is discussed in Section  6.6.Despite the added non-linearity, the main potential advantages of the TES approach are that: (1) it leads to diagonal matrices, and hence the issues of dimensional consistency of the transport equations and computational cost of evaluating matrix square roots or inverses in Eq. (15) are avoided; (2) it is appropriate for the handling of general transport problems (e.g., irrespective of the structure of the transport matrices); and (3) it has the desired property of relying on a physical characteristic of the problem, this is, the equivalence of transport fluxes.Remark 1The definition of thesdiagoperator implies that the approximate transport coefficient for a given variable is a weighted-average of the corresponding coefficients for all the other variables weighted by the local value of the variable’s gradient. For example, for a given transport matrixAxand variablevinY, i.e.Yv, assuming that∂xYv≠0, the element associated to variablevof the approximate transport matrix (the term along thevdiagonal)Ãxis given by:(29)Ãx(v,v)=Ax(v,v)+∑k≠vωkAx(v,k)with:ωk=∂xYk∂xYv,whereωkis the weight associated to contribution from variablekto the advective part of the transport equation for variablev.Remark 2The diagonal matrix resulted fromsdiag(M,S)is equal todiag(M), irrespective of the components of the scaling vectorS, for a diagonal matrixM. Nevertheless, whereas the matrixdiag(M)is expected to be increasingly similar to the matrixMthe more diagonal-dominant the latter is, the matrixsdiag(M,S)can be markedly dissimilar fromM, even if the latter is strongly diagonal-dominant, due to the specific values of the components ofS(the coefficientsωkin Eq. (29) can be relatively large).Remark 3It can be noticed that the definition of the operatorsdiagimplies that the resulting diagonal matrixNfromN=sdiag(M,S)can have negative elements (i.e.,Nkk<0for somek) depending on the values of the components of the scaling vectorS. This behavior is a consequence of transport flux preservation, given that the transport fluxes may not be positive. Such non-positive elements are of no consequence given the definition ofτin Eq. (15), which uses the quadratic product of each approximate transport matrix (e.g., terms of the formÃi⋅Ãj).Remark 4Given the definitions of the approximate matrices using thediagorsdiagoperators, the inverse of the intrinsic transport matrices (i.e.,τt−1,τa−1,τd−1, andτr−1) can potentially have all zero elements along their diagonals. Such situation would cause the definition ofτgiven by Eq. (18) being not defined. This behavior is partially avoided, in practice, by modifying Eq. (18) as:(30)τ=(τt−1+τa−1+τd−1+τr−1+ε)−1,whereεis a diagonal matrix whose elements are small numbers appropriate for each equation to avoid division by zero. In the tests in Section  6, these numbers have been chosen equal to10−7.One important issue in CFD is the handling of incompressibility in incompressible flow problems (evidenced by the use of the continuity equation∇⋅u=0, which only depends on the velocity vectoru, as the equation associated to the pressure fieldp). The appropriate handling of incompressibility in stabilized FEMs has been investigated extensively, (e.g.,  [10,51,72]), and is still an active area of research, particularly for the unified handling of incompressible–compressible flow problems  [73–76], as found in low Mach number compressible flows or in all-speeds flow solvers.One distinct advantage of the TES method with respect to the Diagonal approximation is that the former is naturally able to deal with the incompressibility constraint, whereas the latter cannot. The use of the Diagonal approximate transport matrices (Eqs. (19)–(22)) does not provide adequate stabilization of the equation for pressure (i.e., total mass conservation) in the incompressible limit; in fact, it leads to a nullτp(the intrinsic time scale for pressure defined byτp≡τ1,1). Therefore, the use of the Diagonal approach requires further modification to provide an appropriate approximation forτp. An approach for correctingτpused in  [31] is given by:(31)τp←(τp,comp−1+τp,inc−1)−1,whereτp,compcorresponds toτpwhenτis evaluated using Eq. (15). It is implied thatτpis an adequate intrinsic time scale for a compressible flow (i.e., for a flow with non-negligible dependence of density with pressure). In Eq. (31),τp,increpresents an adequate time scale for an incompressible flow, which similarly as used in  [31] can be given by:(32)τp,inc=(ρτuiGii)−1,whereτuiis the main intrinsic time scale for the velocity componenti. It can be noticed that the exponent “−1” in Eq. (32) is consistent with settingd=1in Eq. (15); a similarly valid expression could be obtained ford=2, and the corresponding modification of Eq. (32). Equation (32) is consistent with the use of a Schur complement of the velocity–pressure coupled system.Using the TES approximation, no modification is needed for the pressure intrinsic time scale. This capability of the TES method represents a distinct advantage over the Diagonal approximation and other approaches found in the literature  [26,40,42,47,48,51]. Moreover, this fact makes the TES methodology particularly suited for the unified handling of incompressible and compressible flow problems.Remark 5Bazileves et al.  [26] introduced an intrinsic time scales matrix for (three-dimensional) incompressible flows given by:(33)τ=[τC01×303×1τMI3×3],whereτMis the velocity time scale corresponding to the momentum equation (i.e.,τM=τui) andτCthe pressure time scale for the continuity equation (i.e.,τC=τp), which is computed according to:(34)τC←(τMg⋅g)−1,whereg⋅g=∑igigi,gi=∑j∂ξj∂xi, andξjdenotes the coordinates of each element in parametric space. Consideringτp,compin Eq. (31) equal to zero, Eqs. (34) and (31) express the same type of incompressibility correction.Remark 6Hauke and Hughes  [20] defined an expression forτpsuitable for incompressible–compressible flows, namely:(35)τp←(1−α)τp,comp+ατp,inc,with(36)α=Mak+Marefk−Ma−2(Mak−2+Marefk)(1−Ma−2)(Mak−2+Marefk),whereMarefis a reference Mach number(1/3<Maref<1), andka model parameter (0<k<4). It can be shown  [31] that in the advective limitτp,comp≈Ma−2τp,inc. Therefore, Eq. (35) can alternatively be expressed by:(37)τpτp,inc≈Mak−2+MarefkMak+Marefk.Whereas if incompressibility correction (Eq. (31)) is used, the resultingτpcan be expressed as:(38)τpτp,inc≈1Ma2+1.The expression forτp/τp,incin Eq. (37) displays a maximum in the regionMa<1(given thatMaref<1); in contrast, the expression in Eq. (38) is monotonically decreasing for the whole range ofMa, which may be more favorable for attaining a convergent solution process.The use of discontinuity-capturing (DC) approaches, mandatory in general compressible flow solvers due to the appearance of shocks, is commonly found in industrial-strength general fluid flow solvers, even incompressible flow solvers. The goal of the discontinuity-capturing operator is to add robustness in the form of numerical diffusion only where the solution is under-resolved. Particularly, DC can be used to complement the stabilization provided by the modeling ofY′in VMS methods. Thus, DC has to disappear wherever the local residualR(Y)is zero (and therefore the sub-grid scalesY′are negligible); also, it should act in the direction of the local gradient  [31].Discontinuity-capturing was used by Hughes et al. in  [77] to enhance the ability of the SUPG method to produce smooth approximations to internal and boundary layer in advective–diffusive problems. This approach was then extended to symmetric transient–advective–diffusive systems  [78] and to symmetric TADR systems of equations  [56]. There exist other alternative approaches for DC, including methods such as flux corrected transport  [79], slope limiters, and others  [80,81].As introduced in Eq. (13),KijDCis the DC diffusivity matrix, which has to be proportional to the residual vector to maintain the consistency of formulation. The anisotropic DC diffusivity matrix definition presented in  [31] have been used in the present work, which is given by:(39)KijDC=νGij,with(40)ν=χ(diag(Yr))−1abs(R(Ȳ)),whereYr=(∂iY⋅Gij−1∂jY)12is a vector representing a reference value of the solution,abs(⋅)is the element-wise absolute value operator for a vector argument (e.g., given vectorV={Vi}and matrixW={Wij},W=abs(V)representsWij=δij|Vi|), andχis a dimensionless matrix defined by:(41)χ=min(2ζ,υ),wheremin(⋅,⋅)is the element-wise minimum function (e.g., for vectorsV,W, and matrixZ,Z=min(V,W)representsZij=δijmin(Vi,Wi)), and:(42)υ=(I+(τtτa−1)−1+(τdτa−1)−1+(τrτa−1)−1)−1,where (considering all inverses above exist)υis a measure of how advection-dominated the system is (see Eq. (18)), andIis the identity matrix. In Eq. (41), the matrixζis defined as:(43)ζ=(diag(Yr))−1abs(Y′),whereY′is the small scale component of the solution fieldY(Eq. (11)). Given that the definition ofKijDCrelies on the multiscale treatment of the problem (i.e., Eq. (43)), the DC operator above is denoted as multiscale. More details about the DC operator, including its relationship with other DC formulations, can be found in  [31].The VMS formulation given by Eq. (13), together with the definition ofτgiven by Eq. (15), and the Diagonal (with incompressibility correction Eq. (31)) and TES methods for approximating the transport matrices, have been implemented in the TPORT (TransPORT) solver  [82]. TPORT is designed for solving general systems of (nonlinear) transient–advective–diffusive–reactive equations given in quasi-linear form (Eq. (1)) using algebraic VMS (Stabilized) FEMs. TPORT is written in C++ and performs parallel processing in shared-memory architectures using OpenMP (Open Multi-Processing) and in distributed-memory systems using PETSc  [83]. TPORT has been extensively used for the simulation of scalar transport, incompressible and compressible flow problems, radiative transport, and equilibrium (LTE) and nonequilibrium (NLTE) plasma flows (see  [31] and references therein). PETSc, the Portable, Extensible Toolkit for Scientific Computation, is an open-source software package that provides a robust and flexible suite of data structures and routines for the parallel solution of scientific applications. PETSc uses the MPI (Message Passing Interface) standard for all-message passing communication. It is designed to provide the numerical infrastructure for application codes involving the implicit numerical solution of PDEs  [84].The simulations used to evaluate the TES approach, presented in the next section, have utilized the second-order generalized-alpha predictor multi-corrector time-stepper method developed by Jansen and collaborators  [85] together with the globalized inexact Newton–Krylov nonlinear solver approach of Eisenstat and Walker  [86] (both implemented in TPORT) in association with the KSP (Krylov Sub-Space) linear solvers from PETSc  [84]. The globalization approach in the Newton–Krylov nonlinear solver uses the line search approach of Kelly  [87]. The line search starts with a relatively large estimate of the step length for movement along the search direction, and iteratively decreases the step size until a reduction of the objective function is obtained that adequately corresponds to the reduction that is desired  [88].The effectiveness of the TES formulation is verified with the simulation of representative fluid flow benchmark problems; namely two-dimensional and three-dimensional incompressible, two-dimensional compressible, and three-dimensional magnetohydrodynamic flow problems. The TES method is evaluated against the Diagonal approximation with incompressibility correction (Eq. (31)) by comparing the accuracy of the results as well as the characteristics of the solution process.In order to evaluate the ability of the TES approach to handle incompressibility in fluid flows, the simulation of the two-dimensional lid-driven cavity flow problem is initially considered. Figure 1shows the description of the problem as a TADR system; namely, an incompressible fluid flow model using dimensionless variables characterized by an imposed constant velocity over the top boundary of magnitude equal to Re, i.e., the problem’s Reynolds number. The set of boundary conditions are listed in Fig. 1(a), as well as the solution forRe=103using the TES approximation without DC in Fig. 1(b). The problem is discretized using a non-uniform mesh with 40 × 40 bilinear quadrilateral elements. The numerical simulation of this problem is based on solving Eq. (13) forY=[puxuy]T(wherepis pressure, anduxanduyare the velocity vector components) with the following transport matrices and vectorS0:(44.1)A0=[000010001],(44.2)Ax=[0101ux000ux],(44.3)Ay=[0010uy010uy],(44.4)Kxx=Kyy=[000010001],(44.5)Kxy=Kyx=03×3,(44.6)S1=03×3,and(44.7)S0=03×1.In Fig. 1(c) the TES results are validated against the values reported by Erturk et al.  [89] using the variation of12ux/Reand12uy/Realong the centerline (x=0.5) of the cavity. The TES velocity profiles with and without using the DC operator are in a very good agreement with those reported in  [89]. The velocity profiles using the Diagonal approximation with incompressibility correction are also depicted in Fig. 1(c) for two cases of applying or not the DC operator. The TES and Diagonal approximations (with incompressibility correction) produce results with comparable accuracy.Close examination of the results in Fig. 1(c) reveals that the use of DC with the Diagonal approximation does not influence the results significantly whereas the use of DC together with the TES method leads to less accurate (i.e., more diffuse) results.The three-dimensional lid-driven cavity flow problem is investigated to complement the analysis of incompressible flows. The problem description together with the obtained velocity fields for two values of the Reynolds number (i.e., Re  =  100 and Re  =  400) is shown in Fig. 2. A non-uniform grid using 40×40×40 trilinear hexahedral elements is used. The transport matrices and vectorS0associated with the TADR equation for the vector of variablesY=[puxuyuz]T, similarly to the two-dimensional incompressible flow problem, can be extracted from the set of matrices and vectors presented in  [31].Figure 2(b) and (c) display the velocity distribution obtained on ax–zcut-plane (y=0.5) using the TES method with no DC (left), together with the velocity profiles across thex- andz-axis (right). The TES approximation generates velocity fields very similar to those obtained by Albensoeder and Kuhlmann  [90]. Similarly to the two-dimensional cavity flow problem, the results using the TES and Diagonal approximations are contrasted, together with the effect of using or not a DC operator. The results show that there is no marked difference between the results using the TES and Diagonal approximations, and the use of the DC approach has a negligible effect on the results. Comparing to the results of the two-dimensional cavity flow, the effect of using DC is evidently less pronounced in three-dimensional incompressible flow problems.Based on the results of the two-dimensional and three-dimensional lid-driven cavity simulations, it can be concluded that the TES approximation is able to produce adequately valid results. In terms of accuracy, none of the TES and Diagonal approximations excels over the other significantly. Nevertheless, as was stated previously, the TES method (i.e., Eqs. (24)–(27)) did not require any modification to account for incompressibility, whereas the Diagonal approximation did (i.e., Eq. (31)).The algebraic VMS using the TES approximation is also validated with the simulation of the compression ramp flow problem, a standard benchmark for compressible flow solvers. The problem consists of a supersonic flow passing over a flat plate joined to an angled ramp. The developed flow consists of a weak shock at the leading edge which is produced by the horizontal boundary, and another weak shock that breaks the incoming supersonic flow  [20]. The compressible flow model is described by Eq. (13) using the vector of unknownsY=[puxuyT]T, whereTrepresents temperature. The transport matrices and vectorS0for the two-dimensional compressible flow model are obtained from  [31].Figure 3presents the problem set-up, boundary conditions, and solution fields using the VMS formulation with the TES approximation and the multiscale DC operator. The problem was solved using air as the working fluid. The computational discretization is the same as the one used by Hauke and Hughes  [20] and consist on a total of 7701 nodes and 7500 elements. The results illustrate that the VMS simulation with the TES approximation predicts the correct shock angle.To complete the validation process and contrast the TES and Diagonal (with incompressibility correction) approximations, Fig. 4shows the variation of the pressure coefficient on the surface of the compression ramp. Except at the beginning and end of the ramp, the values of the pressure coefficient for both approximations, TES and Diagonal with incompressibility correction, are analogous and similar to the pressure coefficient values reported by Shakib et al.  [56].The compression ramp problem is also simulated using the commercial software Fluent®  from ANSYS®   [91] using comparable model and solver settings to those in the VMS formulation, despite Fluent’s solver is based on the Finite Volume Method (i.e., pressure-based, coupled, second-order accurate solver). The pressure coefficient over the ramp surface obtained from the Fluent’s results is also included in Fig. 4, which also shows comparable accuracy to those using the TES and Diagonal approximations and the results by Shakib et al.  [56].The TES approximation is next evaluated with the simulation of the magnetohydrodynamic (MHD) benchmark problem known as the Hartmann flow  [29,92–97]. The Hartmann flow problem describes the fully developed flow of an incompressible electrically conducting, thermally de-coupled, fluid through a rectangular channel. The Hartmann flow is characterized by three non-dimensional parameters: (1) the Hartmann number (Ha), which describes the relative strength of the electromagnetic and viscous forces; (2) the magnetic Reynolds number, which describes the relative strength of electric to viscous diffusion, and (3) the imposed pressure gradient along the channel length. These parameters can be fully defined from a known imposed pressure gradientρGalong the channel length, the imposed transversal magnetic fieldB0along the channel heightH, and the fluid material properties.Despite the problem is essentially one-dimensional (i.e., the analytical solution describes the velocity profile along the channel height), the simulations presented here used the complete three-dimensional flow model given by Eq. (13) with the vector of variablesY=[puxuyuzϕAxAyAz]T, whereϕis the electric potential andAx,Ay, andAzare the components of the magnetic vector potential. The set of transport matrices and the vectorS0for this flow problem can be found in  [31]. The set of boundary conditions are listed in Table 1wherep0is the reference value of pressure equal to 1.01325 [105 Pa];G=50[ms−2], andUacorresponds to the analytical solution for the velocity distribution given byUa=[uxa(y)00]T, and:(45)uxa(y)=U0(1−cosh(HayH)cosh(Ha)).U0=−ρG/σB02is the reference imposed velocity, andH=Ly/2. The Hartmann number is defined byHa=B0H(σ/μ)12. The simulations use as material propertiesρ=μ=σ=1.Figure 5presents the problem set-up and the VMS simulation results using the TES and Diagonal (with incompressibility correction) approximations together with the corresponding analytical solutions for two values of the Hartmann number (i.e.,Ha=1andHa=10). The velocity profiles in this figure are plotted as function of the average velocity.According to Fig. 5, the velocity fields of all the different examined cases are in agreement with those obtained from the analytical solution. Results of the TES approximation are slightly closer to the analytical solution compared to the results of the Diagonal approximation with incompressibility correction. This fact indicates that the TES approximation generates more accurate results for this problem. Additionally, Fig. 5 shows that the effect of DC operator on simulation results is not notably recognizable for the studied Hartmann numbers.The previous simulation results indicate that the TES method is an acceptable technique for approximating the transport matrices and obtaining a definition ofτvalid for generic transport problems. The TES method produces more accurate results than the Diagonal approximation for some problems, whereas not for the others. Besides the accuracy of the results, the type of the convergence, which is a factor to estimate the computational cost of the simulation, has also to be addressed.Table 2compares the convergence of the incompressible and magnetohydrodynamic flow problems as function of the method for approximating the transport matrices (TES or Diagonal with incompressibility correction), the use or not use of discontinuity-capturing (DC), and the use or not use of the line search procedure. The compression ramp problem is omitted from Table 2 given that it had to be run as a time-dependent simulation.Figure 6shows representative convergence histories and is aimed to clarify the different types of convergence introduced in Table 2. This figure illustrates the variation of‖Res‖/tolversus the number of nonlinear solver iterations, where‖Res‖is the norm value of the global residual vector (Eq. (13)) and tol is the overall tolerance to declare convergence in terms of residual reduction and is given by:tol=εrel‖Res0‖+εabs, whereεrelandεabsare the user-specified relative and absolute tolerances (i.e.,εrel∼10−5,εabs∼10−10), and‖Res0‖is the norm of the residual at the beginning of the nonlinear solution process (i.e., before the first iteration). Figure 6 displays the convergence process for the TES and Diagonal approximations with and without DC for (a) the two-dimensional and (b) the three-dimensional lid driven cavity flow problem, respectively.The results in Fig. 6, particularly those in Fig. 6(a), show a marked difference in the initial value of‖Res‖/tolbetween the TES and Diagonal cases. Such difference is mainly due to the difference in the respective value of‖Res0‖for such cases. (Recall that the residual is a function of theτused.) The results in Fig. 6(a) correspond to simulations using the line search approach for a maximum of 5 reduction steps. The behavior of the simulations with the Diagonal approximation shows a decrease of three orders of magnitude in the value of‖Res‖/toland a reduction failure after that, which causes the solution process to stop before the target value (tol) for‖Res‖is achieved. Such convergence behavior is denoted as lsc (line search convergence) in Table 2. Similarly, the convergence when TES with DC is used depicts two orders of magnitude decrement in‖Res‖/toland occurrence of reduction failure, and hence is also denoted as lsc. The results for the TES approach without DC show that the simulation stops because proper convergence is achieved (i.e.,‖Res‖/tol<1). This behavior is denoted as type cnv (convergence) in Table 2.Unlike Fig. 6(a), the simulations in Fig. 6(b) did note use the line search technique (i.e., they were obtained by setting the maximum number of reductions to zero). The variation of‖Res‖/tolwith respect to the number of nonlinear solver iterations evidences that the simulations with the Diagonal approximation with and without DC converge with type cnv and that‖Res‖/toldecreases with approximately a constant slope. The convergence behavior of the TES simulations with and without the DC operator introduces another type of convergence expressed as type stg (stagnation) in Table 2. For these simulations the value of‖Res‖/toldecreases through different steps (for about four orders of magnitude) and stagnates after that. Thus, the simulations continue with oscillatory variation of‖Res‖/toluntil reaching the predefined maximum number of nonlinear solver iterations.In addition to the types of convergence discussed above (i.e., cnv (convergence) and lsc (line search convergence)), the convergence process can also be categorized as type lsf (line search failure) and flr (failure). Type lsf occurs when a simulation using line search shows reduction failure (i.e., the maximum number of reductions is reached without obtaining a decrease in the value of‖Res‖) at the very beginning of the nonlinear solution process. Type flr (failure) indicates that the numerical simulation fails while line search was not used. This failure is manifested by an increase of the value of‖Res‖/tolfrom one nonlinear solver iteration to another. Although in some of the simulations reported in Table 2 the residuals stagnate (type stg) or reduction failure occurs (type lsc), a sufficient decrease of the value of‖Res‖/tolis achieved and the simulation results appear valid (e.g., the results are close to the reference solutions, as depicted in Figs. 1–5). In such cases, the simulations are considered valid and that the solution has convergence (although not to the target tol).Based on the results in Table 2 for the two-dimensional cavity flow, without the use of line search, the TES approximation with and without DC converges with an adequate decrement in‖Res‖/tol(type cnv), whereas for the Diagonal approximation with and without DC,‖Res‖/toldecreases for several orders of magnitude and stagnates after that (stg). For the two-dimensional cavity flow problem, when line search is used, the TES approximation without DC converges with type cnv while for the other simulations reduction failure occurs after a sufficient decrement of‖Res‖/tolto deem the results valid is obtained (lsc). Table 2 also shows that for simulations using line search, the use of the DC operator does not significantly change the total number of nonlinear solver iterations while without line search, the simulation with DC needs more iterations to converge.Considering the three-dimensional cavity flow problem, for both Re  =  100 and Re  =  400 without the line search method, simulations with the Diagonal approximation converge with type cnv while those with the TES method stagnate. Utilizing the line search approach, the simulations using the TES approximation show reduction failure, but those with the Diagonal approximation converge successfully. Investigating the effect of DC, Table 2 indicates that using the Diagonal approximation, for Re  =  100 the DC operator does not notably influence the required number of nonlinear solver iterations while for Re  =  400 convergence to the desired relative tolerance occurs with fewer iterations. The use of the multiscale DC operator affects the TES method in a reverse manner, as for both Re  =  100 and Re  =  400, residuals decrease to a specific value with less number of iterations. Comparing the performances of the TES and Diagonal (with incompressibility correction) approximations for the two-dimensional and three-dimensional cavity flow problems, there appears to be no conclusive statement about which type of approximations is more suitable for an incompressible flow. Nevertheless, the TES method did not require any special treatment for the handling of incompressibility.Evaluating the Hartmann problem simulations, if DC is not used, convergence can be obtained with almost the same number of nonlinear solver iterations for both, the TES and Diagonal (with incompressibility correction) approximations. When the DC operator is used, the number of iterations with the Diagonal approximation remains unchanged for both small and large Hartmann numbers. However, for the TES approximation and large Hartmann numbers using the DC operator decreases the total number of nonlinear iterations whereas for small Hartmann numbers DC does not influence the convergence process. For Ha  =  1, the TES and Diagonal methods with and without the multiscale DC operator converge with type cnv when line search is not used, and converge with type lsc when it is used. For Ha  =  10, without the line search approach, convergence failure occurs and if the line search is used reduction failure occurs after sufficient decrement in the value of‖Res‖/tol(lsc). In conclusion, for small Hartmann numbers there is not any significant difference between the convergence of simulations with the TES and Diagonal approximations (with incompressibility handling), with or without DC operator, and with or without the multiscale line search.Analyzing different formulations of the intrinsic time scales matrixτhelps understanding the suitability of the TES approach for handling generic transport problems compared to other methods. Five different formulations forτfor a one-dimensional steady incompressible flow is considered next. The obtained expressions from these formulations are presented in Table 3. The transport equations for this case study are given, using dimensionless units, by the set of equations for:(46)continuity:∂xux=0,and(47)momentum conservation:∂xp+ux∂xux−Re−1∂x2ux=0,whereuxandpare the dimensionless velocity and pressure, respectively. The transport operator and the vector of variables in the form of Eq. (2) are:(48)L=[0∂x∂xux∂x−Re−1∂x2],and(49)Y=[pux]T.First, an algebraic expression ofτis obtained. Assuming∂xcan be approximated byh−1, and∂x2byh−2, wherehstands for the element size, the algebraic transport operator, counterpart to Eq. (48), reads:(50)Lalg=[01h1h|ux|h+Re−1h2].Substituting Eq. (50) into Eq. (14), the algebraic one-dimensionalτis obtained.Another expression forτis obtained following the formulation by Bazileves et al.  [26] (see Remark 5). Theτresulted from the Diagonal approximation of transport matrices with and without considering the incompressibility correction (Eq. (31)) and also the intrinsic time scales matrix resulted from the TES method are also shown in Table 3.By comparing the expressions in Table 3, the following aspects aboutτcan be concluded:(1)The algebraic one-dimensional intrinsic time scales matrix is non-diagonal and symmetric.The pressure intrinsic time scaleτpusing the Diagonal approximation is equal to zero, as noted in Section  3.4, and therefore this approximation is not suitable for incompressible flows.The Diagonal approximation with incompressibility correction and the Bazileves et al. formulation express the same type of stabilization. The differences between the exponent of the advective and diffusive terms can be explained according to Eq. (15). Bazileves et al. develop their intrinsic time scales expression consideringd=2while theτusing the Diagonal approximation is obtained usingd=1.For the TES approach,τpis non-zero if the gradients of velocity and pressure are not negligible.TES approach leads to an expression forτpthat resembles the one obtained with the incompressibility correction or that used by Bazileves et al. (i.e.,τp=τux−1h2). Specifically, the TES approach leads to the following expression:(51)τp=ςx−1h2,whereςx−1=(∂xp/∂xux)h−1is part of the velocity intrinsic time scale. Similarly, for a two-dimensional steady incompressible flow model, as shown in the Appendix, the TESτpis:(52)τp=ςxy−1h2,whereςxy−1=(ςx−2+ςy−2)−12,ςx=1h∂xp∂xux, andςy=1h∂yp∂yuy. Thisτpalso contains components ofτuxandτuy. Therefore, the TES approximation inherently acts as an incompressibility handling technique.Besides the differences of the various intrinsic time scales matrices, they hold several similarities; for instance the determinant of all the expressions forτhas the form:(53)det(τ)=fh2,wheredet(⋅)represents the determinant operator. In Eq. (53),fcan be a constant or a function of the problem parameters. This behavior also applies to the determinant of the intrinsic time scales matrix for a two-dimensional steady incompressible flow as shown in the Appendix.

@&#CONCLUSIONS@&#
Variational Multiscale (VMS) methods are robust for the development of comprehensive formulations of multiphysics and multiscale flow models. VMS methods typically rely on a residual-based algebraic approximation of the small scales using a so-called intrinsic time scales matrixτ, which depends on the problem’s overall differential operator, as the main model parameter. A new approach for definingτ, denoted Transport-EquivalentScaling (TES), has been presented. The TES method leads to relatively inexpensive expressions for the intrinsic time scales that are suitable for the handling of generic transport problems. The TES approach is based on a monolithic treatment of the governing equations as a single transient–advective–diffusive–reactive system together with a subsequent scaling of the coefficient matrices such to preserve each type of transport flux. An algebraic VMS formulation incorporating the TES method is complemented with a discontinuity-capturing (DC) approach and implemented within a Finite Element Method solver for the solution of TADR problems. The resulting discrete system is solved by a generalized-alpha time-stepper together with a globalized inexact Newton–Krylov nonlinear solver. The effectiveness of the VMS method with the TES approximation is verified with the simulation of benchmark incompressible, compressible, and magnetohydrodynamic flow problems. The results indicate that the TES approximation is capable of producing valid results and can be considered as a generic approach for the modeling of transport problems. The convergence process using TES and a more standard approximation forτ, as well as the effect of the DC approach, are also investigated. The results confirm that the TES method does not require any special treatment for approximating the pressure intrinsic time scale in incompressible flows and is therefore suitable for the unified handling of incompressible and compressible flows. Additionally, results show that the use of the DC approach has a negligible effect on the final results and does not necessarily improve the convergence process. Analysis of different expressions forτfor a one-dimensional incompressible flow model reveals the similitudes and differences between the TES formulation and other conventional methods.