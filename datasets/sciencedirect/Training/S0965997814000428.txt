@&#MAIN-TITLE@&#
Improving FEM crash simulation accuracy through local thickness estimation based on CAD data

@&#HIGHLIGHTS@&#
Local thicknesses automated estimation, given a part’s geometry and midplane mesh.Enhanced estimations enable accurate prediction of engineering part crash behavior.Huge impact on engineering practice allowing zero-prototyping product development.Ford Motor Company is using this approach.

@&#KEYPHRASES@&#
Product development,FEM simulation,Car crash simulation,Thickness estimation,Ray tracing,Zero-prototyping,

@&#ABSTRACT@&#
In this paper, we present a method for estimating local thickness distribution in finite element models, applied to injection molded and cast engineering parts. This method features considerable improved performance compared to two previously proposed approaches, and has been validated against thickness measured by different human operators. We also demonstrate that the use of this method for assigning a distribution of local thickness in FEM crash simulations results in a much more accurate prediction of the real part performance, thus increasing the benefits of computer simulations in engineering design by enabling zero-prototyping and thus reducing product development costs. The simulation results have been compared to experimental tests, evidencing the advantage of the proposed method. Thus, the proposed approach to consider local thickness distribution in FEM crash simulations has high potential on the product development process of complex and highly demanding injection molded and cast parts and is currently being used by Ford Motor Company.

@&#INTRODUCTION@&#
The automotive industry is continuously faced with a rising number of challenges, including, among others, requirements to reduce vehicle weight – motivated by the need to reduce CO2 emissions – and to increase protection and safety for occupants and pedestrians. These challenges take a strong influence on the development process and make it necessary to fully utilize deployed materials as efficiently as possible. Additionally, product development has to be economical with respect to development time and costs. To comply with these ever increasing challenges car manufacturers are intensifying the use of Computer-Aided Engineering (CAE) tools for the various stages of the development process. One such stages is vehicle crash simulation, a mathematically very complex event, which led to the proposal of different representation and analysis approaches including Morlet wavelets [7], the Levenberg–Marquardt optimization algorithm [10], nonlinear autoregressive models [11] and adaptive neurofuzzy inference systems [17], among others. Finite Element Methods (FEM) have been a standard tool for a long time, particularly for modeling and simulating thermoplastic parts under service conditions [12,16]. However, these approaches can only be successful if the numerical methods are capable and have a high confidence level.Within the area of car crash simulation, thermoplastic parts are particularly challenging due to the intrinsic complex behavior of those materials. However, as plastics are pervasive in many different automotive applications, including those with very demanding specifications, it becomes vital to find adequate methods for modeling and simulating those parts under service conditions.Due to the fact that most thermoplastic parts used in vehicles are injection molded, the actual local thicknesses can vary significantly throughout a part (see Fig. 1), especially near edges, joints, ribs and mold drafts. This has an effect on the accuracy of the deformation and fracture behavior prediction. However, local thickness distribution is not explicitly available in FEM midplane meshes. Therefore current state of the art within vehicle crash simulations is to resort to two alternative approaches:(i)for simple parts, which are not highly loaded in crash scenarios, a constant design thickness is often used;for more complex and/or highly stressed parts, manual segmentation is applied to use different constant thicknesses in feature areas, which is very time consuming and not applicable within automotive series developments.These thickness values are based on digital manual CAD measurements due to the fact that physical parts are not available at this stage within the development process. Both approaches result in deviations between simulation and physical tests in the area of deformation behavior, force–deflection characteristics and especially fracture prediction due to simplifications in the thickness range. Thus it is absolutely vital that elements’ thicknesses are properly assigned. This local thickness information exists implicitly in the full part geometry in Computer Aided Design (CAD) files. Automated and precise ways to extract that local thickness distribution from the 3D CAD files to 2D midplane elements used within automotive series development simulations are therefore required to avoid limiting the precision, and thus the potential benefit, of crash simulations. The goal is to allow for zero-prototyping, such that physical parts are only produced once the development process is finished. Vehicle development engineers work only with CAD data, upon which CAE models are built and simulations run. Results from these simulations are applied to the CAD models to comply with all boundary conditions and legislation. No cost and time expensive re-engineering and re-tooling should be required after the production of physical parts, which places high accuracy requirements on crash simulations.In previous work two thickness estimation techniques were proposed [5], based on ray tracing (RT) and nearest neighbor 3D range searches (NN), which allow tagging each midplane mesh element with its associated local thickness (see Fig. 2), thus empowering accurate vehicle crash simulations. It was shown that both techniques complement each other: if each algorithm’s best estimate can be selected for each element of the midplane mesh, then accuracy is improved. Identifying the best estimate for each element is not evident, however, due to the complexity of real world parts. Real world geometries and midplane meshes have lots of details and particular configurations that make it very difficult to establish which is the best estimate – particularly, the real local thicknesses are not known, since this is exactly the quantity that is being measured. Additionally, there are some pathological geometric and midplane mesh configurations which hinder both algorithms from computing any thickness estimate at all. These elements are then tagged as incorrect and must be processed manually by a human operator. Thus, the previously proposed method is unable to provide the thickness distribution information that is required in a practical industrial context.The present paper extends the above cited approach, enabling accurate thickness estimation for all midplane mesh elements. Its contributions are fourfold:•a criterion for deciding whether RT and NN thickness estimates for a given element are accurate based on their relative values;a technique, based on propagation from neighboring elements, for estimating an element’s thickness when both RT and NN algorithms fail to compute an accurate approximation;a comprehensive pipeline for completely automated estimation of local thicknesses, given a part’s surface geometry description and the corresponding midplane mesh;a systematic analysis of the proposed pipeline accuracy, including a validation against thickness measured by different operators and comparisons of FEM crash simulations with and without local thickness estimates against related dynamic physical component tests using a pedestrian protection load case.Thus, the main goal of this work is to enable a fully automated approach to extract local thickness information from a full 3D mesh, and assign an appropriate value of local thickness to every element in the associated 2D midplane mesh, dispensing with using a unique design thickness for the entire part (a gross approximation) or performing manual segmentation (a time-consuming and error-prone operation). Midplane meshes are state of the art within vehicle development because they deliver good quality results in a timely manner. Solid modeling would be an alternative but due to the huge amount of computer capacity needed to handle these big models and significantly increased calculation times, they are currently seldom used for vehicle development. The presented results demonstrate that not only is local thickness accurately estimated, but also that these enhanced estimations enable more accurate prediction of the crash behavior of engineering parts. This is a significant improvement regarding crash simulation quality, allowing for zero-prototyping and resulting in reduced re-testing of physical components, saving time, human resources and money. Therefore this approach constitutes a significant contribution and will have a substantial impact on engineering practice, particularly within the automotive industry, where Ford Motor Company is already using this approach.It is important to note that all part thickness values presented in this paper are normalized for confidentiality reasons. Normalization is performed by dividing all thickness values by the part’s maximum thickness. Thus, the thicknesses listed do not represent the real thickness of the case-study parts and their units are mm/mm.The next section presents a thickness estimation method proposed by Ferreira et al. [5] and discusses its limitations. Section 3 describes the newly proposed approach, whereas Section 4 presents and analyzes experimental results. The paper closes with some concluding remarks.This section describes previous work published by Ferreira et al. [5], which proposes two methods for local thickness estimation from a part’s geometric description. Original results presented in this paper build upon these methods.One broadly accepted definition of the local thickness of a three dimensional object with respect to any given point p on the object’s surface is based on its Medial Axis Transform (MAT) [9]. Since each such point p has a unique corresponding point m on the medial axis, local thickness at p can be defined as the radius of the sphere centered at m and tangent to p. Since the MAT is a computationally very expensive process Gal et al. [6] propose the Local Diameter Shape Function for any point p on the surface of the object, which is based on tracing a large number of rays in a cone around the direction opposite to the surface’s normal at p and finding the distance to the next surface intersection point along each ray. The local thickness is then given by the average length of the rays after discarding outliers.The problem addressed within this paper is different in the sense that one wishes to estimate local thickness around the centroids of the midplane mesh and not for points on the surface of the object. The generation of the midplane mesh itself is not addressed here, since this is already used in FEM crash simulations and is made available by product development engineers using the CAD system. The two basis algorithms are however still based on the notion of ray tracing and/or cones of directions, but centered on the midplane mesh elements’ centroids and distributed around this mesh normals – for more details see next subsection. In this context local thickness at the centroid of each midplane mesh element is broadly defined as the sum of the distances from the centroid to some surface point on each side of the element.When correctly generated the midplane mesh runs inside the part’s surface and parallel to it. However, creating midplane meshes is not trivial. There are several techniques and applications for mesh generation and mesh refinement, but there is still ongoing research on finding automated (or semi-automated) procedures that enable obtaining meshes of adequate quality for simulation purposes [2,8,13]. In practice, midplane meshes currently used for FEM are coarse approximations of the part’s surface geometry. Consequently, details on the original geometry might be lost and the midplane mesh often runs partially outside the part’s surface. These representation inaccuracies lead to thickness estimation errors as described in the next subsections.The broad definition of thickness given above lead to two alternative thickness estimation algorithms [5], both optimized by resorting to a kd-tree to spatially sort the surface’s geometric primitives:Ray Tracing (RT) – A ray is shot for each side of the midplane mesh element, with origin on the element’s centroid and direction equal to the element’s normal [1,15]. Ideally, each of these rays intersects the part’s geometry; the sum of both intersections’ distances is taken as an estimate of the part’s local thickness (see Fig. 3(a)).Nearest Neighbor (NN) – A search over the part’s surface geometry locates which point is nearer to the midplane mesh element centroid [3]. Fig. 3(b) illustrates the algorithm; the dashed circle represents the search domain, which grows until the search algorithm returns a valid point on the part’s surface. Actually, two such searches are performed to locate two points, each on a different side of the midplane mesh element. The sum of the distances from the element’s centroid and these two points is taken as an estimate of the part’s local thickness.For most cases both algorithms return similar thickness estimates. However, real automotive parts and models include complex geometric configurations and incorrect midplane mesh approximations where either one or both algorithms fail to find robust estimates.A systematic analysis of the results obtained for a range of parts with various characteristics allowed identifying the following cases where the proposed algorithms are unable to accurately estimate thickness [5]:1.When the midplane mesh runs outside the part’s surface both algorithms fail to find valid points on both sides of the mesh and, consequently, fail to estimate thickness; see Fig. 4(a) and (b).The ray tracing approach fails when the midplane mesh element’s centroid is aligned with a rib; see Fig. 4(c). Rays, which are shot along the element’s normal, will run inside the part, finding an intersection at distant points of the part’s surface and overestimating thickness. The NN algorithm will still be able to find nearest points near the rib’s junction with the part’s surface, thus avoiding large thickness estimation errors and clearly outperforming ray tracing; see Fig. 4(d).The nearest neighbor approach underestimates thickness for elements that are close to the mesh boundaries; see Fig. 4(d). The spatial search will find the nearest points on the part’s lateral surface, rather than on the longitudinal surfaces; the thickness estimate is thus smoothed and diverges from its actual value, suggesting a round edge. The RT algorithm does not suffer from this problem, given that it searches only along the midplane element’s normal; see Fig. 4(c).Case 1 can be detected during thickness estimation if there is a way of determining whether a midplane mesh element’s centroid is contained within the part’s volume, as defined by its closed surface. This is a generalization of the well-known point in polygon problem and can be solved by resorting to ray tracing: if a ray is shot from a given point along any direction, that point is inside the closed surface if it intersects the surface an odd number of times; else it is outside the closed surface [14]. Thus, if each of the rays shot by the RT algorithm intersects the surface an odd number of times, then the centroid is inside the part. If both rays intersect the surface an even number of times, then the centroid is outside the surface. In this latter case, and if at least one of the rays intersects the surface more than zero times, the side of the centroid whose ray reported the closest intersection is selected as the one closest to the surface and thickness is estimated as the difference between the two closest intersections of that ray. Two different cases are thus identified: (i) the midplane mesh runs outside the part’s volume but still encompasses it as in Fig. 4(a), and (ii) the midplane mesh is partially outside the part’s volume and does not encompass it as in Fig. 4(b). Case (i) can still be solved by ray tracing, whereas case (ii) cannot and requires tagging that mesh element as incorrect.Cases 2 and 3 would be easily solved if the most accurate estimate, among RT and NN, could be identified on a per element basis. Additionally, in order to limit the divergence occurring near the midplane mesh boundaries with the NN algorithm (case 3 above), a limitation can be imposed on the maximum acceptable angle between the element’s normal and the direction defined by the element’s centroid and the surface nearest point. By limiting this angle it is expected that the part’s lateral surface is rejected as a nearest neighbor, thus forcing the algorithm to expand its search onto regions of the surface that are farther away from the mid-plane element. Ferreira et al. [5] show that a limit of 80° more than halves estimation errors near the mesh boundaries over a wide range of parts.Summarizing, for most midplane mesh elements NN and RT return very similar thickness estimates and either can be used without impacting on the overall thickness estimation accuracy. Near ribs or near mesh boundaries one of the algorithms fails (cases 2 and 3), while the other still accurately estimates thickness: RT and NN complement each other on these cases. Detecting which algorithm returns the most accurate estimate would allow correctly handling these elements, but this is a nontrivial problem given the complexity of real parts’ geometric configurations. Finally, when the midplane mesh is not contained within the volume defined by the parts’ surface both algorithms will fail to find an estimate. Ray tracing can be used to detect such elements by resorting to a generalization of the point in polygon algorithm. Furthermore, if the midplane mesh encompasses the part’s surface, RT can still generate an estimate of the local thickness. Section 3 proposes a methodology to handle all these cases.This section proposes a new methodology for generating improved thickness estimates for all midplane mesh elements. It uses the above described ray tracing and nearest neighbor algorithms and resorts to thickness propagation among neighboring elements when an accurate estimate cannot be found for a given element. The proposed methodology builds upon the following premises:•in the presence of well behaved midplane mesh elements both algorithms return similar thickness estimates; if these estimates diverge significantly, then one of the cases described on the previous section applies;midplane elements that stand completely outside the part’s volume as defined by its closed-surface cannot be handled by RT or NN; RT can however be used to identify such elements;since thermoplastic parts are injection molded, thickness is expected to change smoothly across a part’s surface, even though thickness can change significantly across the whole surface; the fact that thickness is most often locally smooth enables propagation methods, where an element’s thickness can be estimated as a function of its neighbors’ thicknesses.The proposed pipeline includes two main stages: stage 1 locally estimates thickness and classifies these estimates as either correct or incorrect, whereas stage 2 handles incorrect estimates.The first step of thickness estimation entails generating initial estimates by resorting to the two above described algorithms and then classifying these estimates as either correct or incorrect. This classification is based on whether or not the element’s centroid is placed within the part’s volume and on an eventual divergence between the RT and NN thickness estimates. Elements for which no correct thickness estimate could be generated are further classified onto three different types of incorrectness, referred to as types A, B and C. Incorrect elements are inserted on an ordered queue, sorted by the type of incorrectness. A complete description of this first stage is given below and illustrated diagrammatically in Fig. 5.Stage 1.1 entails estimating an element’s thickness with the ray tracing algorithm and detecting whether or not the element lies within the part’s volume. If it does, then it proceeds to stage 1.2, otherwise it will be enqueued as an incorrect element. Elements that lie outside the part’s volume might still encompass the part’s surface; this being the case, they are classified as being of type A, otherwise they are classified as type C (no thickness estimate whatsoever is generated for type C elements). For type A elements, RT is still able to generate a thickness estimate and this estimate is also stored on the queue. However, the accuracy of this estimate depends on the angle formed by the ray direction and the normal of the part’s surface at the intersection point. If this angle is large, then the ray will traverse the part obliquely and overestimates thickness. Type A elements are thus inserted on the ordered queue of incorrect elements sorted by the above described angle; elements with smaller angles will be processed first by stage 2 of the pipeline, decreasing the probability of propagating largely overestimated thicknesses.Informed by the fact that both NN and RT return similar estimates over those regions where the midplane mesh is an accurate representation of the part’s surface, stage 1.2 computes the element’s thickness using the NN algorithm and compares it with the RT estimate. To assess whether or not these two estimates diverge significantly the normalized difference,Δi, is computed according to Eq. (1)(1)Δi=|TiRT-TiNN|max(TiRT,TiNN)whereTiRTandTiNNare the Ray Tracing (RT) and Nearest Neighbor (NN) thickness estimates for element i. Elements exhibitingΔi>∊are enqueued as type B incorrect elements together with the respective NN estimate. The optimum value for the error threshold∊was experimentally determined to be 0.2, based on an ensemble of engineering parts.Stage 1.3 detects false positives resorting to user supplied minimum and maximum acceptable thicknesses – these values are known by the parts’ designers. If an element considered correct by stage 1.2 has a thickness estimateTithat falls outside the interval defined by these minimum and maximum values, then its value is set to either the minimum or maximum, respectively, and the element is enqueued as type B. Finally, thickness estimates that successfully passed the three verification stages are stored on the correct estimates database.At the end of stage 1 the ordered queue contains all those elements for which an accurate thickness estimate could not be found. These will be handled by propagating thickness estimates from neighboring elements which have been stored on the correct estimates database. Propagation is expected to give accurate results because thickness varies smoothly across an injection molded part.Two elements are considered neighbors if they share at least one vertex and if the angle formed by their normals is below some given threshold; a value of 25° was experimentally determined to give good results in the vast majority of cases. Taking orientation into account for defining neighborhood is fundamental to avoid propagating thickness among elements that belong to geometrically different regions of a part, such as from a rib to the part’s main surface. However, as described below, in some cases the concept of neighborhood has to be relaxed and propagation is allowed among connected elements, that is elements that share at least one vertex.The proposed algorithm (see Algorithm 1) applies four different thickness correction criteria (C1 to C4), one at a time, for the totality of elements stored in the incorrect elements queue. Thus, for each criterion, the ordered queue of incorrect elements is sequentially traversed. For all criteria, except C3, the current incorrect element’s neighborhood is looked up in the correct estimates database; if the criterion specific conditions are satisfied, the element’s thickness is corrected and it is placed in the correct estimates database. The element is then removed from the incorrect elements’ queue and processing restarts from the queue’s head and criterion C1. The reason for restarting the algorithm is that, since there are more correct elements, propagation can now be successful for incorrect elements where it failed before.Algorithm 1Thickness estimation propagation1: Start with criterion C12: for each criterion in {C1, C2, C3, C4} do3:for each element E in the incorrect queue do4:if current criterion applies to Ethen5:Compute E thickness estimate according to current criterion rules6:Remove E from the incorrect queue7:Add E to the correct estimates database8:GoTo line 19:endif10:endfor11: endforThe four criteria are progressively less restrictive on the conditions imposed to be successfully applied. The incorrect elements are also stored on the queue ordered by the type of error: type A meaning that a ray tracing estimate is available for elements placed outside the surface’s volume, type B meaning that the difference between the RT and NN estimates is significant, and type C when no thickness estimate is available at all. The combination of these two orders, criteria and error type, is crucial to ensure maximum accuracy on the final result.The criteria are as follows:C1 – if all direct neighbors of the current element are tagged as correct, then assign to the element their average thickness;C2 – if at least one direct neighbor of the current element is tagged as correct, then assign to the element the average thickness of all correct direct neighbors;C3 – if the current element was tagged as type A, i.e., it lies outside the part’s volume but its thickness was still estimated by ray tracing, and this estimate is above the minimum thickness and below the maximum, then assign it the estimated thickness;C4 – assign to the current element the average thickness of all the correct elements with whom it shares at least one vertex, i.e., relax the neighborhood constraint by ignoring relative orientation.

@&#CONCLUSIONS@&#
