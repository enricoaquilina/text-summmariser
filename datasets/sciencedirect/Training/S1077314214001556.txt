@&#MAIN-TITLE@&#
Scale filtered Euclidean medial axis and its hierarchy

@&#HIGHLIGHTS@&#
We propose a new methodology for Euclidean medial axis filtering.We propose a new methodology for generation of full hierarchy of scale medial axes.We propose a new methodology which allows for a fair comparison of medial axis filtering algorithms.Series of experiments show that our algorithm gives better or similar results, compared to the best related methods.

@&#KEYPHRASES@&#
Filtered medial axis,Discrete scale axis,Shape representation,Image analysis,Stability,Hierarchy,

@&#ABSTRACT@&#
We propose an Euclidean medial axis filtering method which generates subsets of the Euclidean medial axis in discrete grids, where filtering rate is controlled by one parameter. The method is inspired by Miklos’, Giesen’s and Pauly’s scale axis method which preserves important features of an input object from shape understanding point of view even if they are at different scales. There is an important difference between the axis produced by our method and the scale axis. Contrarily to ours, the scale axis is not, in general, a subset of the Euclidean medial axis. It is even not necessarily a subset of the original shape. In addition, we propose a new method for the generation of a hierarchy of scale filtered Euclidean medial axes. We prove the correctness of the method. The methods and their properties are presented in 2D space but they can be easily extended to any dimension. Moreover, we propose a new methodology for the experimental comparison of medial axis filtering algorithms, based on five different quality criteria. This methodology allows one to compare algorithms independently on the meaning of their filtering parameter, which ensures a fair confrontation. The results of this confrontation with related previously introduced methods are included and discussed.

@&#INTRODUCTION@&#
The notion of medial axis has been introduced by Blum in the 60s [1]. The medial axis of an object X is composed by the centres of the balls which are included in X but which are not fully included in any other ball included in X (such balls are called maximal balls or medial balls). The medial axis is, by nature, centred in the object with respect to the distance which is used to define the notion of ball.In the literature, different methods have been proposed for computing the medial axis approximately or exactly, for instance methods relying on discrete geometry [2–5], digital topology [6,7], mathematical morphology [8], computational geometry [9,10], partial differential equations [11], or level-sets [12]. In this work we focus on the discrete medial axis inZnbased on the Euclidean metric.The medial axis is a very useful representation of the object and plays a major role in shape analysis in numerous applications, for example object recognition, registration or compression. From the medial points and associated ball radii, one can exactly reconstruct the original shape. However it can be hard or even impossible to use this tool effectively without first dealing with some problems, especially in discrete spaces and with noisy objects.Firstly, the medial axis in discrete spaces has not, in general, the same topology as the original object. Solutions to this problem have been proposed by several authors, for instance [6,7,13]. They use discrete homotopic transformations guided and constrained by the medial axis, to obtain an homotopic skeleton which contains the medial axis (see Fig. 1). We do not consider these topological problems in the rest of the paper.The second problem is the sensitivity of the Euclidean medial axis to small contour perturbations (see, for example, Fig. 1). In other words, the medial axis is not stable under small perturbations of a shape: modifying a shape slightly (for example in terms of Hausdorff distance) can result in substantially different medial axes. This is a major difficulty when the medial axis is used in practical applications (e.g., shape recognition). A recent survey which summarises selected relevant studies dealing with this topic is presented in [14]. This fact, among others, explains why it is usually necessary to add a filtering step (or pruning step) to any method that aims at computing the medial axis and when a nonreversible but simplified description of binary objects is of interest.The simplest strategy to filter the medial axis is to keep only points which are centres of maximal balls of at least a given diameter. Different criteria can be used to locally threshold and discard spurious medial points or branches: see [15,16], for methods based on the angle formed by the vectors to the closest points on the shape boundary, or the radius of the smallest ball enclosing these closest points [17,3].In these methods, local information (that is, geometric information extracted from a single medial ball) is compared to a global parameter value to determine the importance of the corresponding medial axis point. However, it is well known that this local filtering can lead to remove small branches which might be important for the shape understanding (see Fig. 2) especially for shapes with features at different scales [14].A more complex criterion was proposed by [18]: the authors utilise information about ball covering by the other balls of the medial axis. This information is obtained, for each ballB(x,r)of the medial axis, by counting the number of object points inside the cell of x in the power diagram of all medial points. The medial point x is removed if this area is too small.All these methods are based on a single parameter, furthermore they have the property that any filtered medial axis of a shape X for a parameter valueλis a subset of any filtered medial axis of X for parameter valueμ, wheneverλ⩾μ. In other words, the set of all filtered medial axes of a shape forms a hierarchy.Some medial axis filtering methods (e.g., [17,3]) may not be able to preserve significant details at different scales, as their parameter links to a dimension (e.g., a ball radius) that is set globally, for the whole image. The parameter value must then be adapted to the only scale of details that should be preserved.In [19], the authors address this scale dependency issue and propose an approach that puts in relation local information and regional information, that is, the status of a ball is only influenced by the one of neighbouring balls. Their method is based on the theory of the scale axis transform [20], which defines a whole family of medial representations at different levels of abstraction, called scale axis representations (see Fig. 3). For objects or scenes that include parts showing different scales, this method gives good results in many cases. Furthermore, the scale axis enjoys nice mathematical properties related to stability and convergence, with respect to some dense sampling of a manifold.On the other hand, the scale axis is not necessarily a subset of the Euclidean medial axis (see Fig. 4), it is even not necessarily a subset of the original shape (see Fig. 6). Thus, the scale axis cannot be used in applications of skeletons where these properties are mandatory.In this paper we propose a new method for the Euclidean medial axis filtering (see Section 4). Our proposition is inspired by the scale axis method (see Section 3). However, we obtain a filtered Euclidean medial axis, included in the exact one, instead of a set of points that is not necessarily a subset of the latter. Our method produces axes that preserve important features for shape understanding, even if they are at different scales. We propose a new algorithm for the generation of a full hierarchy of medial axes with a proof of its correctness and an analysis of its properties (see Section 5). The new algorithms work in arbitrary dimension. We evaluate experimentally their properties, and compare them with the previously introduced methods [18,16]. In addition, we propose a new methodology for the comparison of medial axis filtering algorithms, which permits to fairly compare algorithms that are based on different strategies, and takes into account five different quality criteria (see Section 6).This article extends the paper [21], which was limited to the algorithm that computes a single filtered medial axis. Additionally, we introduce here a method for the construction of full medial axes hierarchies, we prove its correctness, we propose a new methodology for the comparison of medial axis filtering algorithms, we report more experiments and discuss some properties of our new methods.In this section, we recall some basic geometric and topological notions for binary images [22,23].We denote byZthe set of integers, byNthe set of nonnegative integers, and byN+the set of positive integers. A point x inZdis defined by(x1,…,xd)withxiinZ. Letx,y∈Zd, we denote byd(x,y)the Euclidean distance between x and y, that is,d(x,y)=((x1-y1)2+⋯+(xd-yd)2)1/2.We denote byR+the set of positive real numbers. LetY⊂Zd, we denote byd(x,Y)the Euclidean distance between x and the set Y, that is,d(x,Y)=miny∈Y{d(x,y)}. LetX⊂Zd(the “object”), we denote byDXthe map fromZdtoR+∪{0}which associates, to each point x ofZd, the valueDX(x)=d(x,Zd⧹X). The mapDXis called the (Euclidean) distance map of X. Forx∈Zdandr∈R+, we denote byB(x,r)the ball of radius r centred on x, defined byB(x,r)={y∈Zd,d(x,y)<r}. Notice that, for any point x in X, the valueDX(x)is precisely the radius of a ball centred on x and included in X, which is not included in any other ball centred on x and included in X.Now, let us recall the notion of medial axis (see also [24,7]). LetX⊆Zd. A ballB(x,r)⊆X, withx∈Xandr∈N+, is maximal for X if it is not strictly included in any other ball included in X. The medial axis of X, denoted byMA(X), is the set of the all couples(x,r)such thatB(x,r)is a maximal ball for X.LetX⊂Zd,Y⊂X, we denote byREDTX(Y)the reverse Euclidean distance transform[18], defined byREDTX(Y)=⋃y∈YB(y,DX(y))The medial axis permits the exact reconstruction of the original object thanks toREDT, more precisely we haveX=REDTX(MA(X)).In this section, we adapt the notion of scale axis (see [19,20]), originally introduced in the continuous spaceRd, to the case of discrete spaceZd. LetX⊆Zd,x∈X,r∈N+ands∈R+. The parameter s is called the scale factor. We denote byXsthe multiplicatively s-scaled shape, defined byXs=⋃(x,r)∈MA(X)B(x,rs). Fors⩾1, we denote bySATs(X)the s-scale axis transform of X, defined bySATs(X)={(x,r/s)|(x,r)∈MA(Xs)}.The algorithm introduced in [19] for computing the scale axes of objects inRdcan be adapted to objects inZdas follows. First, calculate the Euclidean medial axis of X. To do so, we use an efficient algorithm presented in [18]. Then multiply the radius of each medial ball by the chosen scaling factor s.As a consequence, some small medial balls are covered completely by larger nearby balls since they are not important. On the other hand, small balls without larger balls in their neighbourhood are not covered and will be preserved.The next step is to reconstruct the objectXsbased on scaled radius values. This reconstruction can be made efficiently by using the reverse Euclidean distance transform (see Section 2). Then,MA(Xs)is computed.The final step of the algorithm consists in rescaling the medial balls ofMA(Xs)by a factor1/sto obtain the scale axis of X.Fors=1, the scale axis is identical toMA(X). With increasing s, the scale axis gradually ignores less important features of X, leading to successive simplifications ofXsand the scale axis structure.Finally, a detailed discrete scale axis algorithm is provided in Algorithm 1.Algorithm 1DiscreteScaleAxis(InputX,s)01.MA(X)←EuclideanMedialAxis(X)02.MA′(X)←{(x,rs)|(x,r)∈MA(X)}03.Xs←ReverseEuclideanDT(MA′(X))04.MA(Xs)←EuclideanMedialAxis(Xs)05.SATs(X)←{(x,r/s)|(x,r)∈MA(Xs)}06.returnSATs(X)All steps of DiscreteScaleAxis algorithm can be calculated in linear time with respect to|X|(line 01),|MA(X)|(line 2),|Xs|(lines 03–04) and|MA(Xs)|(line 05) respectively, where|X|stands for the cardinality of X. Therefore, the computational complexity of the algorithm isO(|Xs|).The crucial part of the method presented in the previous section, is the reconstruction part after medial balls scaling and the need for generating a new medial axis from the scaled object (see Fig. 4). Because of this, we do not have the propertySATs(X)⊆MA(X). On the other hand, at first sight, this is the most important part of the algorithm since the medial axis simplification occurs in this part.To solve this problem, we remark that an efficient filtration may be obtained by only deciding whichMA(X)points are not important and should be removed, based on the covering of scaled balls by neighbouring scaled balls. Therefore, we do not have to generate a new objectXsand itsMA(Xs). In this way we can obtain a filtered Euclidean medial axis of X which is a subset ofMA(X).This informal discussion motivates the following definition of the Scale Filtered Euclidean Medial Axis (SFEMA).Letx∈X,r∈N+. We denote byBX(x,r)the intersection ofB(x,r)with X, that is,BX(x,r)={y∈X|d(x,y)<r}.Definition 1LetX⊆Zd, ands∈R,s⩾1. We denote bySFEMAs(X)the Scale Filtered Euclidean Medial Axis of X defined bySFEMAs(X)=(x,r)∈MA(X)|BX(x,rs)⊈⋃(y,t)∈MA(X),t>rBX(y,ts).We illustrate this definition in Fig. 5. An object X and its medial axis are depicted in (a). In (b), the smaller ball is not fully covered by the bigger one after scaling. In the scale axis representation both balls will be preserved. However, the scaled bigger ball includes the intersection of the scaled smaller one with X. Therefore, the smaller ball will not exist inSFEMAs(X). In (c), the scaled smaller ball is included in the scaled bigger one. Therefore, it is neither in the scale axis nor inSFEMAs(X).Examples ofSFEMAs(X)for different scale factorssi, are shown in Fig. 7.Let us analyse the properties and the major differences between the s-scale axis [19] and our s-scale filtered Euclidean medial axis. The most important property is thatSFEMAs(X)consists ofMA(X)points only, that is, for alls⩾1:SFEMAs(X)⊆MA(X). This property (inclusion property, for short) is essential in some applications of the medial axis. In particular, a hierarchical representation of the family of filtered axes (see Section 5) is not possible without this property. In Fig. 4 we have shown an example of the Miklos et al.’s scale axis where an additional branch even appears after filtering. Fig. 6shows another example. The scale axis loses important features of the object (this might be a desirable behaviour in some applications, though) and is not included in the object. Besides, the s-scale filtered medial axis holds the inclusion property and permits to reconstruct most of the original object.Notice that, the commonly used strategy based on homotopic thinning that permits to obtain a topologically correct skeleton (see Introduction, text and Fig. 1(b)), is based on the assumption that the filtered medial axis lies inside the original object.The second interesting property relies on the notion of intersected ball (BX). If we want to simplify the object, using Miklos et al.’s scale axis, for example by removing a medial ballB(x,r),x∈X, the scale factor should be big enough in order that ballB(x,rs)is included in one of other medial balls, that is,B(x,rs)⊂B(y,rs),y∈X(see Fig. 5c), or in a union of such balls. In our method, since we use notion of intersected ball, we only test inclusion inside X (see Fig. 5b). This allows us to use a smaller scale factor. Therefore, we have a better ability to control the resulting s-scale filtered Euclidean medial axis. Notice also that the use of intersected balls is essential to design an efficient algorithm.Below, we give an algorithm for computingSFEMAs(X)for a given objectX⊆Zd.Proposition 1Algorithm SFEMA computes exactly the s-Scale Filtered Euclidean Medial Axis, as defined by Definition1.Consider any point p in X (after line 04). The assertion: “for allk∈{1,…,i},d(xk,p)>srk” holds true during the execution of the loop at line 06. After execution of this loop (line 07) we know that for allk∈{1,…,i-1},d(xk,p)>srk, andd(xi,p)⩽sri. Thus, at line 08, we know that p belongs toBX(xi,ris)and that it does not belong to any ballBX(xk,rks), withrk>ri. From this we deduce that(xi,ri)belongs toSFEMAs(X).This proves that all detected pairs indeed belong toSFEMAs(X). Now consider any pair(x,r)ofSFEMAs(X), there exists at least one point p inBX(x,rs)that is not included in⋃(y,t)∈MA(X),t>rBX(y,ts). As all points p of X are considered by the algorithm (line 04), the pair(x,r)will be detected.□The algorithm in line 02 performs a sorting of medial axis elements, in timeO(|MA(X)|log|MA(X)|). In the following lines the algorithm performs two loops. The first one starts in line 04 and does|X|iterations. The next, nested loop, starts in line 06 and in the worst case performs|MA(X)|iterations. Summarizing, computational complexity of SFEMA isO(|X||MA(X)|).Algorithm 2SFEMA(InputX,s)01.H←∅02.MA(X)←EuclideanMedialAxis(X)03.L¯et(x1,r1),…,(xn,rn)denote the elements ofMA(X)sorted in decreasing order of radii, that is,r1⩾⋯⩾rn04.foreachp∈Xdo05.i←106.whiled(xi,p)>sridoi←i+1end07.Ifi⩽nthen08.H←H∪{(xi,ri)}09.end10.end11.returnHIntuitively, the greater the scale parameter s used inSFEMA, the smaller the filtered axis. Moreover for each objectX,SFEMAproduces a family of axes that are all subsets ofMA(X). This suggests that these axes could be nested into each other. In this section, we formalise this property, we show that it is not always true with the axes defined bySFEMA, and we propose a new algorithm for computing directly a family (hierarchy) of nested filtered axes.It may be interesting to compute a hierarchy instead of a single filtered skeleton in cases, which are frequent, where there is no trivial way to fix a priori a single parameter value for a set of images. In such cases, the precomputed hierarchy may allow a user to interactively visualise the effect of each parameter value on the filtering. Alternatively, a post-processing algorithm may be applied, in certain applications, to automatically choose a threshold of the hierarchy that satisfies a given criterion (for example, a chosen number of skeleton branches).Definition 2We denote byMAs(X)the filtered medial axis ofX⊂Znfors∈S⊆R+, where S represents the set of all possible values of parameter s of the considered filtering algorithm.The familyH(X)={MAs(X)|s∈S}is a hierarchy if for alls1,s2∈S,s2>s1impliesMAs2(X)⊆MAs1(X)⊆MA(X).Unfortunately, given an objectX⊆Zd, the familySFEMA(X)={SFEMAs(X)|s⩾1}is not necessarily a hierarchy. Fig. 8presents an object X whose associated family of medial axesSFEMA(X)does not enjoy the hierarchy property. This fact motivates the following definition:Definition 3LetX⊂Znand(x,r)∈MA(X). We denote byΨX:MA(X)→[1,∞)∪{∞}the scale map of X defined byΨX(x,r)=min{t⩾1|∀s⩾t,(x,r)∉SFEMAs(X)}In words,ΨX(x,r)is the minimal scale at which a given ball disappears from all the following scaled filtered axes.We see that thresholding the mapΨXat a given level s gives us a filtered axis. By construction, all these axes form a hierarchy.Now, let us introduce Algorithm 3, which calculates the scale map.The computational complexity of Algorithm 3 is the same as Algorithm 2, that is,O(|X||MA(X)|). The algorithm in line 02 performs a sorting of medial axis elements, in timeO(|MA(X)|log|MA(X)|). In the following lines the algorithm performs two loops, the second nested in the first. The first one starts in line 04 and does|X|iterations. The next nested loop starts in line 06 and performs|MA(X)|iterations, where|MA(X)|≪|X|(usually).Before proving the correctness of Algorithm 3, we illustrate its behaviour based on the simple example of Fig. 9.Notice that Algorithm 3 could be simplified if we assume that all medial axis ball have distinct radii: line 8 and variabletminrare only useful in the case of equal radii. For the sake of simplicity, the balls of this example have distinct radii, hencetminris always equal totmin.In this example we focus on the computation of the scale map value for the medial axis point x, that is,Ψ(x,r).For point a, the algorithm calculatestminas a minimum ofd(a,xi)/rifor all ballsB(xi,ri)(shortlyBi) greater thanB(x,r)(shortly B) in lines 06–13. In our example only two maximal balls are greater thanB:B1andB2.Algorithm 3ScaleMap(InputX)00.MA(X)←EuclideanMedialAxis(X)01.foreach(x,r)∈MA(X)doΨX(x,r)←0 end02.Let(x1,r1),…,(xn,rn)be elements inMA(X)sorted03.such thatri⩾ri+104.foreachp∈Xdo05.tmin←+∞06.fori=1tondo07.t←d(xi,p)ri08.Ifi=1orri≠ri-1thentminr←tmin09.Ift>1andt<tminthentmin←t10.Iftminr⩾d(xi,p)/riandΨX(xi,ri)<tminrthen11ΨX(xi,ri)←tminr12end13.end14.end15.returnΨXWe haved(a,x1)/r1(shortlyda1) greater thand(a,x2)/r2(shortlyda2). Sotmin=da2. It means that during scaling the ballB2covers the point a as the first of all maximal balls greater than B. Moreover the minimum cover scale s such thata∈sB2is equal toda2. Then the algorithm, in line 10, checks if ball B reaches the point a for smaller scaling factor thanB2(smaller thantmin). In our caseda=d(x,a)/ris smaller thanda2. So point a belongs to a union of balls greater than B for minimum cover scales=da2and it belongs to the ballB(x,r∗da2), thus ifΨ(x,r)<da2the algorithm updatesΨ(x,r)in line 11.Similarly for the point b we havedb<db2<db1, sotmin=db2andΨ(x,r)is set todb2if less thandb2.The situation is different for the point c, for we havedc2<dc<dc1, it means thattmin=dc2<dcso when the union of balls greater than B scaled bydc2reaches point c, it does not belong toB(x,r∗dc2)so the algorithm does not updateΨ(x,r). The same situation occurs for point d, when reached by scaledB2it does not belong to scaled B soΨ(x,r)is not updated. In the example,Ψ(x,r)=dc2.Let us first remark that, in the definition ofΨ, it is not necessary to consider all possible values of t or s, but only the ones of the formd(x,p)r, withp∈Xand(x,r)∈MA(X), and+∞. Thus, we define:Sp=s=d(xi,p)ri;(xi,ri)∈MA(X)ands>1∪{+∞}That is,Spis the set of scales such that p lies on the border of a scaled medial axis ball. Then:S=⋃p∈XSpAnd we have:(1)ΨX(x,r)=min{t∈S|∀s∈S,s⩾t,(x,r)∉SFEMAs(X)}Letr1be the radius of the biggest ball inMA(X), that is,r1=max{ri|(xi,ri)∈MA(X)}. Now, for any p in X and any(x,r)∈MA(X)let us define(2)E(p,r)=min{t∈Sp|∀s∈S,s⩾t,p∈⋃rj>rB(xj,srj)}ifr<r1+∞otherwiseFor a point p and a radiusr,E(p,r)is the minimum scale for which p is covered by a scaled medial ball of radius greater than r (minimum cover scale).Moreover let us define:(3)X(x,r)={p∈X:E(p,r)⩾d(p,x)/r}For a medial ball(x,r),X(x,r)represents the set of all points p of X such that the minimum cover scaleE(p,r), applied to the ball(x,r), suffices to cover p.From the last definition we have:(4)X(x,r)={p∈X:p∈BX(x,rE(p,r))}Proposition 2For any(x,r)inMA(X), we haveΨX(x,r)=maxp∈X(x,r)E(p,r).Letr=r1=max{ri|(xi,ri)∈MA(X)}. Then we haveX(x,r)=X,E(p,r)=+∞for anyp∈XandΨX(x,r)=+∞. From now on, we suppose thatr<r1.Let us setpˆ=arg maxp∈X(x,r)E(p,r)andtˆ=E(pˆ,r). Hence, we havetˆ=maxp∈X(x,r)E(p,r). So, directly from (2) we have that∀p∈X(x,r),p∈⋃rj>rB(xj,tˆrj), thus∀s∈S,s⩾tˆ,X(x,r)⊆⋃rj>rBX(xj,srj). Moreover, by the very definition oftˆ,∀s∈S,s<tˆ:pˆ∉⋃rj>rB(xj,srj). Thus, combining the last two expressions we obtain:(5)maxp∈X(x,r)E(p,r)=mint∈⋃p∈X(x,r)Sp|∀s∈S,s⩾t,X(x,r)⊆⋃rj>rB(xj,srj)From (4) the definition oftˆ, we have:(6)∀s∈S,s>tˆ,X(x,r)⊆BX(x,sr)Now let us take anyp∈X⧹X(x,r). From (3) we haveE(p,r)<d(p,x)/r. So, by definition ofE(p,r), for anys∈Ssuch thatp∈BX(x,rs), we havep∈⋃rj>rBX(xj,srj). In other words:(7)∀s∈S,BX(x,rs)⧹X(x,r)⊆⋃rj>rBX(xj,srj)Finally from (5)–(7) we have:(8)maxp∈X(x,r)E(p,r)=mint∈S|∀s∈S,s⩾t,B(x,sr)⊆⋃rj>rB(xj,srj)=Ψ(x,r)□Algorithm ScaleMap applied to X outputs the scale mapΨX, as defined in the Definition3.Algorithm ScaleMap, for a medial ballB(xi,ri)and a pointp∈Xin lines 06–13, setstminrtoE(p,ri)defined by Eq. (2).Then in line 10 it checks whether p belongs toX(xi,ri), see (3). Thus, we have that the algorithm (lines 8–11) calculatesmaxp∈X(xi,ri)E(p,ri).By Proposition 2, the algorithm calculates correctlyΨ(xi,ri), for each i.□Let us define a new medial axis family, which enjoys the hierarchy property, based on the scale map calculated by Algorithm 4.Definition 4LetX⊂Zn,s>1andΨXis a scale map of X. We define byHSMAs(X)the hierarchical scaled medial axis of X by the following formula:HSMAs(X)={(x,y)∈MA(X)|ΨX(x,r)>s}In conclusion, we have the following property, which is straightforwardly consequence of Definitions 2 and 4.Theorem 2LetX⊂Zd. The familyH(X)={HSMAs(X)|s>1}is a hierarchy.In this section, we compare qualitatively and quantitatively properties of five medial axis filtering algorithms. In the comparison we include algorithms that operate in the same framework as ours: discreteλ-medial axis (DLMA) [5], the Euclidean medial axis filtered with the use of bisector function (BFMA) [16], filtering based on medial ball radius (RFMA) [18], filtering based on ball covering (CFMA) [18] and a filtering method proposed in this work: the hierarchical scaled medial axis (HSMA).In this study, we do not consider the topology preservation issue, as none of these methods provide a guarantee of preserving topology. A classical way to obtain topologically correct skeletons from a sparse medial axis, consists of performing an homotopic thinning of the shape with the constraint of preserving the medial points [6,7,13].In our experiments we use six selected shapes from the Kimia’s database [25], that are representative of the whole set. Four of the selected objects: “Ray”, “Elephant”, “Camel” and “Fountain”, have important features at different scales, in contrast to the two other ones: “Classic” and “Misk” (see Fig. 10).It is difficult to compare methods, all based on a single filtering parameter, but where the parameter has a different meaning. Due to this fact, comparing the results of two methods for the same parameter value does not make sense. Therefore, we have to find some strategies to ensure a fair comparison between methods, based on criteria that do not depend on their particular way of working. Furthermore, we want these criteria to be related with actual concerns met in real-world applications.Several criteria have already been proposed in the literature. Chaussard [26] defined the so-called visual quality factor which is a combination of reconstruction error with information derived from the skeleton of the shape, namely, the number of skeleton points. Van Eede et al. [27] propose a solution based on weighted reconstruction error, combined with skeleton complexity defined as the number of skeleton branches. However, the quality of the medial axis depends of the reconstruction weight which need to be set arbitrarily. Setting this parameter properly is not obvious.In the following subsections, we propose a comparison methodology that is based on five different criteria. In each case, we give both the definition and the intuitive meaning of the criterion, and we report the results of our experiments.For the exact and unfilteredMA(X)we haveX=REDTX(MA(X)). However, this property is no longer true if we consider filtered medial axes e.g., HSMA, DLMA, BFMA, RFMA or CFMA. Therefore, it is interesting to measure how much information about the original object is lost when we perform filtering. We defineRX(Y)=|(X∪REDTX(Y))⧹(REDTX(Y)∩X)||X∪REDTX(Y)|We callRX(Y)the (normalised) residual size of Y. Residual size give us a numerical evaluation of reconstruction error. Now we can set Y to different filtered medial axes, e.g., by using different methods or filtering parameter values, and then evaluate, e.g., visually, which one filtration is the best for a same degree of reconstruction of the object. The resultRX(Y)is a real value between 0 (perfect reconstruction) and 1 (bad reconstruction).Fig. 11presents DLMA, BFMA, HSMA, RFMA and CFMA of a chosen shape, extracted for several values of normalised residual size. Note that we compare the results of methods for approximately equal values of their residual size, rather than for equal values of their parameters. One can observe, in Fig. 11, that DLMA loses representation of the tail even for low values of residual size. On the other hand, BFMA preserves representation of the tail but it also preserves unimportant balls on the border of the object. Such balls may represent noise. HSMA preserves representation of the tail even for high value of residual size. Moreover it successfully removes unimportant balls even for low values of residual size. RFMA loses the tail even for low value of residual size and it preserves many unimportant balls. CFMA successfully removes unimportant balls but loses some representation of the tail for high residual size.For the sake of paper size we have not included results for other objects from Fig. 10. Interested readers can find the results in [28] and draw similar conclusions as from Fig. 11.Notice that, this strategy makes sense only if the residual size values are a monotonic, increasing function of the method’s parameter, ensuring a one-to-one correspondence (or one-to-few, in cases of equality) between residuals and parameter values. The inclusion property is a sufficient condition for this function to be increasing.We denote byNSX(Y)the normalised medial axis size, defined as the ratio of the number of medial points to the number of object points:NSX(Y)=|Y|/|X|Now we can compare the normalised residual size obtained for the same NS, using different methods. Intuitively, this allows us to judge of the importance (on average), with regard to reconstruction, of the medial points that are kept by the filtering method.In Fig. 12we show the normalised residual size R as a function of normalised medial axis size NS for different shapes and different filtering methods. The results shows that the CFMA obtains the smallest residual size values for the very small normalised sizes of filtered medial axis. When the size of the medial axis is large enough the CFMA behaves similarly to BFMA and HSMA. It means that CFMA, BFMA and HSMA, at the first place remove points that do not affect the reconstruction error very much. In contrast, with RFMA and DLMA, some important (for reconstruction) points are removed even for very large size of medial axes.From the shape understanding point of view, preserving visually important segments and removing unimportant ones, at the same time, is even more important than achieving very good reconstruction properties. Based on the two previous criteria only, it is hard to take into account the negative impact of the removal of a visually important feature that has a relatively small size. Therefore, in this section, we introduce another comparison criterion which allows us to observe how different filtering strategies preserve visually important features.Globally, the filtering algorithms will be tested by measuring the “difference” between the border of an object X, and the border of the reconstructed shape after filtering. The “difference” will be measured using the dissimilarity measure commonly used in replacement of the Hausdorff distance, because of its lower sensitivity to outliers, and defined as follows:LetX,Ybe two subsets ofRn. We setD(X|Y)=1|X|∑x∈Xminy∈Y{d(x,y)}andd(X|Y)=max{D(X|Y),D(Y|X)}is the dissimilarity between X and Y.In Fig. 13we show the dissimilarity as a function of normalised residual size for different shapes and different filtering methods. Results shows that in all cases BFMA produce lower dissimilarity than other filtering criteria for the same value of normalised residual size. It means that BFMA preserves more visually important features, on the negative side it also preserves some noise. The HSMA produces results comparable to BFMA, but without the same sensitivity to noise. We can also observe a good behaviour of the CFMA up to some value of residual ssize. After reaching this level it starts removing features at low scale which cause dissimilarity to rapidly increase. On the other hand, DLMA and RFMA give comparable results for the objects without features at different scales, and very poor results for the other ones.To evaluate the skeleton complexity, we have to consider skeletons that have the same topological characteristics as the original objects. In order to guarantee topology preservation, we perform an ultimate homotopic thinning of X with the constraint of retaining the points of its filtered medial axis Y (constraint set), that is, we iteratively remove simple points from X that do not belong to Y (see Fig. 14). A priority function is needed in order to specify which points must be considered at each step of the thinning. In the general case, the choice of this priority function is not obvious as reported in [16,7]. For example, taking the exact Euclidean distance map as a priority function may cause “extra branches” to appear which change the skeleton complexity and bias the comparison. Taking this fact into consideration we choose the functionFXdefined in [5] as priority: intuitively, for each object point x, the valueFX(x)is the radius of the smallest ball that encloses all boundary points of X that are closest to x.Now, we define the complexity of the skeleton as the number of its end points. Notice that, due to the preservation of the connectivity, any isolated medial point that corresponds to unfiltered noise on the border of the object, will generate a spurious branch of the skeleton (see Fig. 14).We propose another comparison criterion which relies on this notion of skeleton complexity. Quite often in applications, the desired degree of filtering can be expressed in terms of skeleton complexity (for example, the shape of a human silhouette should be represented by a skeleton of complexity five, with end points in the head, the arms and the legs). To each number of end points of the successive filtered skeletons, corresponds a degree of filtering that we evaluate quantitatively by its reconstruction error.For a given method we denote byY(X,λ)the filtered medial axis at valueλof the parameter. To each of the setsY(X,λ)corresponds a homotopic skeletonS(Y(X,λ))that has a certain complexity. Note that, for a given complexity c, there may exist several values ofλ, or none, such that the complexity ofS(Y(X,λ))is c.Now for a given complexity c, we consider the largest (in the sense of the inclusion) setY(X,λ)such that the complexity ofS(Y(X,λ))is c. We denote byYc(X)this set, or∅if it does not exist. The quality of this filtered medial axis will be evaluated by computingRX(Yc(X)), that is, the residual size ofYc(X).Now we can simply compare medial axes at each complexity level independently by changing the parameter c without caring about the meaning of the filtering parameterλ. We could also make a comparison by focusing only on the most suitable level for the shapes of interest. For example if we consider shapes similar to the letters “p”, “b”, “d”, etc., the most interesting complexity level is one, because these shapes have one visually important branch. Therefore, to compare filtered medial axes of such family of shapes we would use the value ofRX(Y1(X)).Fig. 15shows the minimum residual size at different complexity levels. We can notice that HSMA gives the lowest residual size at the most suitable complexity according to the shape. The HSMA gives poor results only for very low complexity, since the method preserves very well features at different scales. Comparable results are generated by CFMA. The BFMA has the worst behaviour in this experiment, since it preserves many points which are close to the border. Therefore, the BFMA is unable to generate medial axes with low complexity. This strongly limits its practical application.The last interesting criterion is related to the hierarchy property of the medial axes (see Definition 2 in Section 5). In some applications, one can be more interested in a filtering strategy which cannot only remove large amounts of points at once, but also allows one to produce some intermediate results at different levels of hierarchy. Then, the different methods may be compared on the basis of their ability to propose a rich set of hierarchy levels. This is also an important criterion if, in the end, only one filtered axis is kept, for its choice can be done more finely if the number of possibilities is larger.Let us denote byMAs(X)the filtered medial axis ofX⊂Znfor the value s of the filtering parameter. Since all methods in our comparison enjoy the hierarchy property, we know thats>timpliesMAs(X)⊆MAt(X). However, due to the discrete nature of the object X, there exists only a finite set of valuess0,…,skyielding distinct filtered axes. More precisely, we consider the set{si}i=0kof positive real numbers such that:(i)MAs0(X)=X, andMAsi(X)≠MAsi-1(X), for anyi∈{1,…,k}, andMAsi(X)=MAs(X), for anyi∈{0,…,k-1}and anys∈[si,si+1[.In the following, the indices i are called the hierarchy levels.Then, we can evaluate the reconstruction error at each hierarchy level independently. When we increase the hierarchy level, the filtering algorithm removes a set of medial points with the same “importance”. The “importance” of the point depends on the filtering criterion. The filtering method which removes a smaller amount of points at each change of hierarchy level, can produce more different representations of the object.In Fig. 16, we show achieved values of normalised residual size at each hierarchy level for all tested filtering methods and for different shapes. Based on these results, we can observe how many different medial axes can be produced by manipulating the filtering parameter and how the reconstruction error evolves.For the first four objects which have features at different scales, the HSMA generates the highest number of multiscale representations of the object. For the last two classes of objects HSMA gives globally the best result. In contrast, the CFMA yields globally the smallest number of hierarchy levels. RFMA and DLMA also generate a relatively small number of medial axes. Indeed, the number of different filtered medial axes generated with CFMA, RFMA and DLMA might be not enough in some applications.

@&#CONCLUSIONS@&#
This paper has three main contributions. The first contribution is a new method for Euclidean medial axis filtering which possesses the following properties:–it generates subsets of the Euclidean medial axis,the filtering is based on only one parameter,it generates filtered medial axes which preserve important parts of an input object at different scales,it allows for a better reconstruction of the input object, compared to other related medial axis filtering algorithms,the computation complexity of the algorithm isO(|X||MA(X)|),it extends trivially to any finite dimension.The second and the most important contribution, is an algorithm which, for anyX⊆Z2, generates a full hierarchy of scale filtered medial axes (HSMA) in timeO(|X||MA(X)|). This algorithm also trivially extends for the case ofZn. We prove that the algorithm indeed computes the HSMA as we defined it.The third contribution consists of a new methodology which allows for a fair comparison of medial axis filtering algorithms. The methodology is based on five different quality criteria. Using this new methodology, one can compare quantitatively properties of algorithms, independently of the meaning of specific algorithm parameters. Following this methodology, we made a series of experiments that show that HSMA gives better or similar results, compared to the best related methods.