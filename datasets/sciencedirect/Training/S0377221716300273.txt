@&#MAIN-TITLE@&#
Complex multi-state systems modelled through marked Markovian arrival processes

@&#HIGHLIGHTS@&#
Redundant complex systems with an indeterminate number of units and repairpersons are modelled.The online unit is a multi-state one with minor and major performance states.Four types of failures: internal and external (both repairable and non-repairable).Preventive maintenance as response to random inspection is introduced.The effectiveness of preventive maintenance is analysed through several measures.

@&#KEYPHRASES@&#
Reliability,Phase type distribution,Marked Markovian Arrival Process (MMAP),Multi-state systems,Markov modelling,

@&#ABSTRACT@&#
Complex multi-state warm standby systems subject to different types of failures and preventive maintenance are modelled by considering discrete marked Markovian arrival processes. The system is composed of K units, one online and the rest in warm standby and by an indefinite number of repairpersons, R. The online unit passes through several performance states, which are partitioned into two types: minor and major. This unit can fail due to wear or to external shock. In both cases of failures, the failure can be repairable or non-repairable. Warm standby units can only undergo repairable failures due to wear. Derived systems are modelled from the basic one according to the type of the failure; repairable or non-repairable, and preventive maintenance. When a unit undergoes a repairable failure, it goes to the repair facility for corrective repair, and if it is non-repairable, it is replaced by a new, identical one. Preventive maintenance is carried out in response to random inspections. When an inspection takes place, the online unit is observed and if the performance state is major, the unit is sent to the repair facility for preventive maintenance. Preventive maintenance and corrective repair times follow different distributions according to the type of failure. The systems are modelled in transient regime, relevant performance measures are obtained, and rewards and costs are calculated. All results are expressed in algorithmic form and implemented computationally with Matlab. A numerical example shows the versatility of the model presented.

@&#INTRODUCTION@&#
Redundant systems and preventive maintenance, which are two ways to improve system reliability and availability, are of considerable research interest. Serious damage, financial losses and, possibly, total system failure can be provoked by poor reliability. Two approaches can be adopted to improve the reliability of a complex system: standby systems and preventive maintenance. Various classes of redundant systems have been proposed, depending on the problem to be addressed. Levitin, Xing, and Dai (2014) developed an optimisation problem, in which a fixed set of elements was distributed between cold and warm standby groups; an appropriate element initiation sequence was then selected to minimise the expected mission operation cost of the system while providing the desired level of system reliability. In this respect, too, Vanderperre and Makhanov (2014) analysed a repairable duplex system characterised by cold standby and by pre-emptive priority rules. In this paper, general probability distributions for failure and repair were allowed. There exists an extensive body of literature related to warm standby systems, from significant initial research such as that by Gnedenko (1965), who analysed a warm standby system with a general number of components, to recent papers such as Wells (2014) where known analytic results are extended to a case with repairable and non-repairable failures.Preventive maintenance is intended to improve system reliability and to increase profits. Nakagawa (2005) studied standard and advanced problems of maintenance policies for system reliability. Zhong and Jin (2014) included preventive maintenance in a cold standby two-component system, using semi-Markovian processes. In order to keep components running properly, the working component receives periodic preventive maintenance. An optimal replacement policy was developed by Zhang and Wang (2011) to cope with a deteriorating system with multiple types of failures. Under this approach, the application of an optimal replacement policy ensures that the long-run expected reward per unit of time is maximised. Preventive maintenance has also been described for use in complex systems, with either a multi-state unit or with a general set of cold standby multi-state units (Ruiz-Castro, 2013, 2014).Nowadays, multi-state systems are of particular importance in ensuring reliability. Most texts on reliability theory analyse systems in which the units perform in terms of traditional binary models: up state (performing) and down state (failure). Many real-life systems, termed multi-state systems, are composed of multiple components with different performance levels and incorporating several failure modes. In this respect, Natvig and Morch (2003) analysed the Norwegian offshore gas pipeline network in the North Sea, transporting gas to Emden in Germany, and Lisnianski, Frenkel, and Ding (2010) have studied multi-state systems, presenting a variety of significant cases of interest to engineers and industrial managers. Lisnianski and Frenkel (2012) included Markov processes in the analysis of multi-state systems, highlighting the benefits of their application.When complex systems are modelled, intractable expressions are often encountered. Several methodologies have been proposed to analyse the behaviour of a multi-state system, and one such method is that of Markov process theory. Markov processes enable us to model the behaviour of a complex multi-state system and to obtain measures in an algorithmic and computational form. One class of distributions that makes it possible to model complex systems with well structured results, thanks to its matrix-algebraic form, is the phase-type distribution (PH), which was introduced and analysed in detail by Neuts (1975, 1981), who pointed out its useful algorithmic properties. Phase type distributions and Markov processes have been applied in fields such as queuing theory, survival and reliability, where real-life problems have been modelled in an algorithmic form (Ruiz-Castro & Fernández-Villodre, 2012).Many stochastic systems have inputs to the system over time that can be counted to control events, e.g. electrical systems at which electric shock waves arrive at random intervals. Multi-state systems that evolve over time may be subject to different types of failures, whether repairable or non-repairable, and benefit from measures such as preventive maintenance to enhance performance and economic results. The analysis of these systems requires a mathematical tool that can describe the input analytically and give rise to a numerically tractable model. The Markovian arrival process (MAP) class that was introduced byNeuts (1979) counts the number of events in an underlying Markov chain. Two special cases of this process are Batch MAP and Marked MAP. In the first case, arrivals in batch are allowed, and in the second, several types of arrivals are counted. In all cases, the arrival rates of events can be customised for different situations, which highlight the inherent versatility of this class of processes. In a recent study, He (2014) presented the main results associated with MAPs.Reliability systems are usually studied in the continuous case. However, not all systems can be continuously monitored, and some must be observed at certain times, for reasons such as the internal structure of the system, the need for periodic inspections, etc. Reliability systems that evolve in discrete time have been proposed to analyse the behaviour of devices in fields such as civil and aeronautical engineering. Ruiz-Castro and Quan-Lin (2011) considered a Markovian structure to model a k-out-of-n: G system with multi-state components by means of well-structured blocks. Recently, Ruiz-Castro (2014) included preventive maintenance in a discrete system to analyse its effectiveness with respect to performance measures and related costs in a complex device.The aim of the present paper is to model certain warm standby complex systems that evolve in discrete time, are subject to different types of failure (repairable and non-repairable) and are protected by means of preventive maintenance with an indeterminate number of repairpersons. External shocks are included and from a basic system various complex ones are derived. This evolution is analysed using a Markov model and the main measures are determined in an algorithmic and computational form. Events occur at different times and are modelled by a marked, batch-arrival MAP. Costs are introduced and a numerical example shows the versatility of the modelling, comparing two similar complex systems with and without preventive maintenance. Various measures are applied to determine whether preventive maintenance is profitable from performance and financial standpoints. The results presented in this paper were obtained in an algorithmic and computational form, through the use of this methodology.Section 2 presents the basic system, the assumptions and the state space, and Section 3 describes Marked MAPs in detail and obtains the matrix blocks and the transition probability matrix that describes the evolution of the system. Section 4 then addresses the modelling of the four systems derived. Section 5 is focused on the performance measures; thus, availability, reliability, conditional probability of failure, mean times and mean number of events are determined in transient regime. Section 6 introduces the concept of rewards, together with measures such as mean costs and profit up to a certain time. Finally, the versatility of the modelling is shown in Section 7, with a comparison of two similar systems, with and without preventive maintenance.We assume a K-system with the online unit and the rest in warm standby that evolves in discrete time. The online unit is subject to repairable or non-repairable internal failures due to wear out. Also, the online unit is subject to random external events which can produce external shocks by producing failure. This one can be repairable and non-repairable depending on time up to failure. Any warm standby unit can undergo only repairable failures due to wear. When one failure occurs, the unit goes to the repair facility for corrective repair. The repair facility is composed of an indefinite number of repairpersons R where R≤K. The online unit is a multi-state one where it passes through several performance stages which are partitioned in minor (the first n1 states) and major (the rest). Inspections occur randomly and in response to these ones preventive maintenance can be carried out. The online unit goes to preventive maintenance only when one major state is observed under inspection. Corrective repair times are different according to the type of failure, from either the online place or standby. The order of the type of failure in queue keeps in memory.The system described above is subject to the following assumptions.Assumption 1The internal operational time of the online unit is PH-distributed with representation (α, T). The number of operational states is equal to n, and these are partitioned in minor (the first n1 states) and major states (states n1+1, …, n).Assumption 2Internal failures can be repairable and non-repairable. When an internal repairable failure occurs, a transition occurs to a subset of states, and the same happens for the non-repairable failures with another subset of states. The internal time up to failure can be written by blocks as(T|Tr0|Tnr0)where the blocksTr0andTnr0are column vectors including the absorbing probabilities from the transient states for an internal repairable and non-repairable failure, respectively. The absorbing probabilities for an internal failure from the transient states are given by the column vectorT0=Tr0+Tnr0.Assumption 3Events that produce failures of the online unit due to external shocks occur according to a phase type renewal process. If the online place is occupied, this event produces the failure of the unit. The time between two consecutive events is PH distributed with representation (γ, L). The order of the matrix L is equal to t.Assumption 4External failures can be repairable and non-repairable. When an external repairable failure occurs, a transition occurs to a subset of states, and the same happens for the non-repairable failures with another subset of states. The external time up to failure can be written by blocks as(L|Lr0|Lnr0)where the blocksLr0andLnr0are column vectors including the absorbing probabilities from the transient states for an external repairable and non-repairable failure, respectively. The absorbing probabilities for an external failure from the transient states are given by the column vectorL0=Lr0+Lnr0.Assumption 5When the online unit undergoes a non-repairable failure then it is replaced by a new and identical one in a negligible time.Assumption 6Any warm standby can fail at any time with probability p.Assumption 7While the online place is occupied by a unit, random inspections can occur. The time between two consecutive inspections is PH distributed with representation (η, M). The order of the matrix M is equal to ε.Assumption 8The corrective repair time for any warm standby that fails is PH distributed with representation (β0, S0). The order of this matrix is equal to z0.Assumption 9The corrective repair time when the online unit undergoes a repairable failure is PH distributed with representation (β1, S1). The order of this matrix is equal to z1.Assumption 10The preventive maintenance time is PH distributed with representation (β2, S2). The order of this matrix is equal to z2.Assumption 11When all standby units, the online unit does not undergo a failure, none unit is repaired and one inspection occurs then the online unit keeps on working independent of the observed state.Assumption 12The random times defined above are independent.One interesting aspect that must be taken into account in this model is that events can occurs simultaneously. Thus, for instance, failures on several warms standby units and one inspection on the online unit can occur at same time.The system described above can be modelled by a discrete Markov process with a finite number of states. We define as Xkthe number of non-operational units in the repair facility at time k. This is a vector Markov process and the state space is composed of macro-states. This one is defined as E={E0, E1,…,Ek}, where Ekcontains the phases when there are k units in the repair facility. On the order hand, the order of the units in the repair facility is important to be considered, given that the type of failure determines the type of repairing.For this reason the macro-state Ekis partitioned in several macro-states depending on the order of the units in the repair facility. Then,Ek={Ei1,i2,…,ik;il=0,1,2,l=1,…,k}, k=1,…,K−1, andEK={Ei1,i2,…,iK;iK=0,1,il=0,1,2,l=1,…,K−1}, contains the phases when there are k units in the repair facility and the order of these units to repair is given byi1,…,ikin lexicographical order; where 0 indicates that the unit comes from warm standby, 1 indicates that the online unit undergoes a repairable failure and 2 indicates that the online unit is in the repair facility for preventive maintenance. The first min{R, k} units are being repaired and the rest are in repairing queue given that there are R repairpersons.Finally, the phases of the macro-states are given by(1)E0={(i,j,m);1≤i≤n,1≤j≤t,1≤m≤ɛ},for k<KEi1,…,ik={(i,j,m,r1,r2,…,rmin{k,R});1≤i≤n,1≤j≤t,1≤m≤ɛ,1≤rh≤zih,h=1,…,min{k,R}}andfork=KEi1,…,iK={(j,r1,r2,…,rR);1≤j≤t,1≤rh≤zih,h=1,…,R},where i denotes the phase of the operational time of the online unit, j is the phase of the external shock time, m the phase of the inspection time and finally, rhis the phase of the repair time of the hth units that is being repaired.The system that is being analysed can be modelled through a Discrete Marked Markov Arrival Process (MMAP). As it has been described, several types of events can occur while the system is working on. We have focused on the analysis of the different types of failures and preventive maintenance. Besides the modelling of the system, this methodology enables us to count the number of events by time.The transition probability matrix is built by taking into account the state space defined in (1). To clarify certain expressions, we denote by eha column vector containing all 1 of order h (if the subscript is not noted, then the order of e is the appropriate for a correct product). The Kronecker product of two matrices is used in this paper. Given two matrices, A and B, with order a×b and c×d respectively, the Kronecker product is a matrix with order ac×bd defined asA⊗B=(aijB),for any element aijof the matrix A.The following auxiliary matrices have been built to facility the complex modelling.The following auxiliary matrices, U1and U2, are defined which are used when one inspection occurs. The element (i, j) of these matrices is given byU1(i,j)={1;i=j≤n10;otherwise,U2(i,j)={1;i=j≥n1+10;otherwise.These matrices consider only the minor and major phases respectively.If there are g units being repaired and a of them finishes its repairing then the transition probability by considering only the phases for these g units is given byFora<g,g≥2,a≥1,C(g,a;i1,…,ig−a;j1,…,jg;k1,…,ka)={S(1)⊗⋯⊗S(g);js=is−I{a≥1}·∑z=1aI{kz<s},s=1,…,g;s≠kz,z=1,…,a0;otherwise,whereS(h)={Sih;h≠kz,z=1,…,aSih0;otherwise,and ih, jh, khindicates the type of failure of the hth unit that is being repaired after the transition, before the transition and the ordinal of the repairpersons that concluded the repair, respectively.For instance, if there are g=4 units being repaired (types j1=0, j2=1, j3=1, j4=2) and 2 of them are repaired (the second and the fourth, k1=2, k2=4) then the transition probability by considering the repair phases is given byC(4,2;0,1;0,1,1,2;2,4)=S0⊗S10⊗S1⊗S20.From this matrix function the transition probability for any order of repairing is given byB(g,a;i1,…,ig−a;j1,…,jg)={Si1⊗⋯⊗Sig;a=0;is=js,s=1,…,g∑k1=1g−a+1∑k2=k1+1g−a+2⋯∑ka=ka−1+1gC(g,a;i1,…,ig−a;j1,…,jg;k1,…,ka);0<a<gB(l,a;j1,…,jg)=Sj10⊗⋯⊗Sjg0;a=g.If the same example above is considered then the general transition probability when 2 units are repaired from j1=0, j2=1, j3=1, j4=2 to i1=0, i2=1 is given byB(4,2;0,1;0,1,1,2)=C(4,2;0,1;0,1,1,2;2,4)+C(4,2;0,1;0,1,1,2;3,4)=S0⊗S1⊗S1⊗S20+S0⊗S1⊗S10⊗S20.The situation of any unit can be modified at any time and changes on the online unit and on any warm standby unit can occur at any time and simultaneously.Throughout the paper, given a matrix A we denote A0 to the matrix A0=e−Ae. A matrix of zeros with appropriate order is denoted by 0 and the function I{} is the indicatory function.Firstly, we are going to focus on the online unit. While this one is operational, then it can undergo internal failure, external shock and/or one inspection. These possibilities are considered in the definition of the following matrices that describe different transition probabilities for the online unit.The transition probability when the online unit changes of phase without failure and preventive maintenance by considering the corresponding phases is given byH0=T⊗L⊗M+U1T⊗L⊗M0η.The first term indicates the changes in the internal performance states, phases of the external shock time and phases of the inspection time (T⊗L⊗M). The changes when one inspection occurs and a minor state is observed are given in the second term (U1T⊗L⊗M0η). The matrix U1T contains the transition probabilities between any two internal operational phases of the online unit when a minor state is observed by inspection, an external failure does not occur (L) and one inspection takes place and the time up to the following inspection is reinitialised (M0η).A repairable failure on the online unit takes place when an internal failure, an external shock by producing repairable failure or both things occur. If there are units in warm standby or one unit is repaired at same time, then the matrix transition probability is given byH1=Tr0α⊗(L+Lr0γ)⊗(M0η+M)+(en−T0)α⊗Lr0γ⊗(M0η+M).The above case when the only operational unit is the online, and at same transition time a repaired is not produced is given byH1′=Tr0⊗(L+Lr0γ)⊗eɛ+(en−T0)⊗Lr0γ⊗eɛ.When one inspection occurs and a major state is observed then the unit goes to the repair facility to preventive maintenance (at same time a failure does not occur). If there are units in warm standby or one unit is repaired at same time then the transition probability block is given byH2=U2(en−T0)α⊗L⊗M0η.In the previous case, we assume that when there is only one operational unit and a repaired is not produced at a certain time, then the online unit keeping on working although a major state is observed by inspection. It is considered to optimise the operational time of the system. This transition probability block is given byH2′=U2T⊗L⊗M0η.A non-repairable failure on the online unit takes place when a non-repairable external shock is produced. The non-repairable failure is ‘stronger’ than a repairable one and preventive maintenance. Then, the matrix transition probability is given byH3=Tnr0α⊗(L+L0γ)⊗(M0η+M)+(en−Tnr0)α⊗Lnr0γ⊗(M0η+M).Table 1shows the matrices associated to the events over the online unit.The matrices described above are the basis of the modelling of this multi-state complex system. The transition probability matrix is composed of matrix blocks according to the macro-states defined in (1). We have already analysed the behaviour of the online unit, next warm standby units are introduced in the analysis.If r indicates the number of standby units which are broken at a certain time and l the number of units in the repair facility before that time, then we define the matrixHc,l,r=(K−l−1r)pr(1−p)K−l−1−rHc,wherec=0,1,2,3;l=0,…,K−1;r≤K−l−1.This matrix Hc,l,rcontains the transition probabilities when there are l non-operational units, and at next time r warm standby units breaks down and the online unit passes to the situation c in that time; where c is equal to 0 when the online unit keeps on working the next time, 1 when this one undergoes a repairable failure, 2 when it undergoes a major inspection and 3 when the online unit undergoes a non-repairable failure.If the online unit goes to repair facility, all warm standby units fail and a repair does not occur thenH′c,l,K−l−1=pK−l−1H′c,forc=1,2.Fig. 1shows the possible transitions for only the online and standby units.The behaviour of the system; when the online unit, the standby units, and the repair facility are considered, is modelled through a MMAP with arrivals in batch. We distinguish among four types of events:O: the only units that fail at a certain time are warm standby units.A: the online unit undergoes a repairable failure and any unit in warm standby can fail.B: the online unit undergoes a major inspection and any unit in warm standby can fail.C: the online unit undergoes a non-repairable failure and any unit in warm standby can fail.When the events A, B and C have place at a certain time, the number of warm standby units that fail can vary from 0 to the total units in standby at the previous moment. We defined DOr, DAr,DBrand DCr, for r=0,…, K−1, as the matrices that contain the transition probabilities between any two phases described in the state space when the event O, A, B or C occurs, respectively, and r standby units fail.The system is modelled by the following MMAP,(DO0,DO1,…,DO,K−1,DA0,DA1,…,DA,K−1,DB0,DB1,…,DB,K−1,DC0,DC1,…,DC,K−1).Fig. 2shows the transitions when there are l units in the repair facility, a of them are repaired and r standby units fail.In this section the matrices associated to the MMAP are worked out. Some of them are developed in this section and the rest are given in the Appendix.MatrixDOrThe matrix DOrcontains the transition probabilities when the online unit does not go to repair facility and r warm standby units fail at a certain time. This fact depends on the number of units in the repair facility before and after the transition time. The block (l, k) of the following matrix corresponds to this transition between the macro-states Eland Ek. This matrix is given byDOr=(DlkOr)l,k=0,…,K,whereDlkOr=0ifk>l+rork<l+r−min{l,R}orl≥I{r≥1}(K−r).Once again, the matricesDlkOrare composed by matrix blocks corresponding to the transition between macro-statesEj1,…,jlandEi1,…,ik. The matrix blockDlkOr(i1,…,ik;j1,…,jl)contains the transition probabilities described by considering the order under repairing and in queue of failure types before and after transition. These blocks are built by considering the H blocks and the auxiliary matrix functions defined in Section 3.1. Then,D00O0=H0,0,0,D0rOr(i1,…,ir)=(H0,0,r+H′2,0,rI{r=K−1})⊗βi1⊗⋯⊗βimin{r,R};is=0,s=1,…,r;r=1,…,K−1,Dl,0O0(j1,…,jl)=(H0,l,0+H′2,l,0I{r=K−l−1})⊗B(l,l;j1,…,jl);l=1,2,…,R≠Kjs=0,1,2;s=1,…,l,DK,0O0(j1,…,jK)=α⊗(L+L0γ)⊗η⊗B(K,K;j1,…,jK);K=RjK=0,1;js=0,1,2,s=1,…,K−1.Fora=1,…,R≠K,iR−a+s=jR+s;s=1,…,min{K−R,a}andjK=0,1,DK,K−aO0(i1,…,iK−a;j1,…,jK)=α⊗(L+L0γ)⊗η⊗B(K,a;i1,…,iK−a;j1,…,jK)⊗βiR−a+1⊗βiR−a+2⊗⋯⊗βimin{K−a,R}.DK,KO0(i1,…,iK;j1,…,jK)=(L+L0γ)⊗B(K;0;i1,…,iK;j1,…,jK);is=js,s=1,…,K,andforr=0,…,K−2;l=1,…,K−r−1;a=0,…,min{l,R,l+r−1},il−a+s=0;s=1,…,r,jK=0,1andiR−a+s=jR+s;s=1,…,l−Rifl>R,Dl,l+r−aOr(i1,…,il+r−a;j1,…,jl)={(H0,l,r+H2,l,r′I{r=K−l−1,a=0})⊗B(l,a;i1,…,il−a;j1,…,jl)⊗βil−a+1⊗βil−a+2⊗⋯⊗βimin{l−a+r,R};min{l−a+r,R}≥l−a+1(H0,l,r+H2,l,r′I{r=K−l−1,a=0})⊗B(l,a;i1,…,il−a;j1,…,jl);min{l−a+r,R}<l−a+1,where I{} is the indicatory function.For instance, if there are l units in the repair facility with orderj1,…,jl, then the probability that the online unit does not go to repair facility, r warm standby units fail (H0, l, r), a units that are being repaired are finished (B(l,a;i1,…,il−a;j1,…,jl)) and the possible units in queue entry to be repaired (βil−a+1⊗βil−a+2⊗⋯⊗βimin{l−a+r,R}) is given byDl,l+r−aOr(i1,…,il+r−a;j1,…,jl).MatricesDArThe matrix DArcontains the transition probabilities when the online unit undergoes a repairable failure and r warm standby units fail at a certain time. This fact depends on the number of units in the repair facility before and after the transition time. The block (l, k) of this matrix corresponds to this transition between the macro-states Eland Ek. This matrix is given byDAr=(DlkAr)l,k=0,…,KwhereDlkAr=0ifk>l+r+1ork<l+1+r−min{l,R}orl≥K−r.As above, the matricesDlkArare composed by the matrix blocksDlkAr(i1,…,ik;j1,…,jl)that contains the transition probabilities described by considering the order in queue of failure types before and after transition. These blocks are built by considering the H blocks defined above. Then,D0,r+1Ar(i1,…,ir+1)=(H1,0,rI{r<K−1}+H1,0,r′I{r=K−1})⊗βi1⊗βi2⊗⋯⊗βimin{r+1,R};r=0,…,K−1i1=1is=0;s=2,…,r+1Forr=0,…,K−2;l=1,…,K−r−1;a=0,…,min{l,R},il−a+1=1,il−a+s=0;s=2,…,rjK=0,1andiR−a+s=jR+s;s=1,…,l−Rifl>R,Dl,l+r+1−aAr(i1,…,il+r+1−a;j1,…,jl)={(H1,l,rI{r<K−l−1ora>0}+H1,l,r′I{r=K−l−1anda=0})⊗B(l,a;i1,…,il−a;j1,…,jl)⊗βil−a+1⊗βil−a+2⊗⋯⊗βimin{l+r+1−a,R};min{l+r+1−a+r,R}≥l−a+1(H1,l,rI{r<K−l−1ora>0}+H1,l,r′I{r=K−l−1anda=0})⊗B(l,a;i1,…,il−a;j1,…,jl);min{l+r+1−a+r,R}<l−a+1Thus, in the last case, if there are l units in the repair facility with orderj1,…,jl, then the probability that the online unit undergoes a repairable failure, r warm standby units fail (H1, l, r), a units that are being repaired are finished (B(l,a;i1,…,il−a;j1,…,jl)) and the possible units in queue entry to be repaired (βil−a+1⊗βil−a+2⊗⋯⊗βimin{l+r+1−a,R}) is given byDl,l+r−aAr(i1,…,il+r−a;j1,…,jl).The rest blocks are given in the Appendix.The system is modelled through a vector Markov process as it has been described above. Given the MMAP that governs the behaviour of the system, the transition probability matrix associated to the Markov process is given as the addition of the matrices built above. Thus,(2)P=∑r=0K−1(DOr+DAr+DBr+DCr)=(Dlk)l=0,…,Kk=max{0,l−R},…,K,where these blocks can be expressed through the blocks different of zero in the following way.Forl=0,…,K;k=max{0,l−R},…,K,Dlk=I{l=K}DlkO,0+I{l<K,k≥max{l−R,0}}∑a=max{l−k,0}min{l,R,max{K−k−1,0}}DlkO,k−l+a+I{l<K,k≥max{l−R+1,1}}∑a=max{l−k+1,0}min{l,R,max{K−k,0}}DlkA,k−l+a−1+I{l<K,max{l−R+1,1}≤k<K}∑a=max{l−k+1,0}min{l,R,max{K−k,0}}DlkB,k−l+a−1+I{l<K,max{l−R,0}≤k<K}∑a=max{l−k,0}min{l,R,max{K−k−1,0}}DlkC,k−l+a.The transient distribution of the model can be worked out from the transition probability matrix by considering the different matrix blocks. Given the initial distributionω=(ω0,ω1,…,ωK)the probability that at time ν the system is in the different states of the macro-state Ekis noted bypEkνand it is given by considering the matrix block structure aspEkν=∑l=0KωlDlk(ν),whereDlk(ν)=∑l1=l−min{l,R}min{k+min{l,R},K}Dl,l1∑l2=l1−min{l1,R}min{k+min{l1,R},K}Dl1,l2⋯×∑lν−2=lν−3−min{lν−3,R}min{k+min{lν−3,R},K}Dlν−3,lν−2∑lν−1=lν−2−min{lν−2,R}min{k+min{lν−2,R},K}Dlν−2,lν−1Dlν−1,k.Some different systems can be derived from the basic system. Repairable and non-repairable failures on the online unit where these failures may, or may not depend on the time up to internal failure of the online unit are considered. These new systems are modelled by considering similar structure as given above but with different matrices H.SYSTEM II: A System with only repairable or non-repairable internal failures depending on the time up to failure of the online unitWe assume the system I where external failures cannot occur. This one is a particular case of the system above but the state space changes in the following wayE0={(i,m);1≤i≤n,1≤m≤ɛ},for k<KEi1,…,ik={(i,m,r1,r2,…,rmin{k,R});1≤i≤n,1≤m≤ɛ,1≤rh≤zih,h=1,…,min{k,R}},and for k=KEi1,…,iK={(r1,r2,…,rR);1≤rh≤zih,h=1,…,R}.The matrix blocks are given byH0=T⊗M+U1T⊗M0η,H1=Tr0α⊗(M0η+M),H1′=Tr0⊗eɛ.H2=U2(en−T0)α⊗M0η.H2′=U2T⊗M0η.H3=Tnr0α⊗(M0η+M).SYSTEM III: A System with repairable or non-repairable external and internal failures depending on the time up to failure of the online unit without preventive maintenanceWe assume system I without random inspections. Preventive maintenance is removed. This one is a particular case of system I with the following state spaceE0={(i,j);1≤i≤n,1≤j≤t},for k<KEi1,…,ik={(i,j,r1,r2,…,rmin{k,R});1≤i≤n,1≤j≤t,1≤rh≤zih,h=1,…,min{k,R}},and for k=KEi1,…,iK={(j,r1,r2,…,rR);1≤j≤t,1≤rh≤zih,h=1,…,R},The matrix blocks are given in this case asH0=T⊗L,H1=Tr0α⊗(L+Lr0γ)+(en−T0)α⊗Lr0γ,H1′=Tr0⊗(L+Lr0γ)+(en−T0)⊗Lr0γ,H3=Tnr0α⊗(L+L0γ)+(en−T0)α⊗Lnr0γ.Finally, in this case the MMAP is given by(DO0,DO1,…,DO,K−1,DA0,DA1,…,DA,K−1,DC0,DC1,…,DC,K−1).SYSTEM IV: A System with repairable or non-repairable internal and external failure of the online unit independent of the time up to failureWe assume the basic system I where the internal (external) operational failure can be repairable with probability pin_re(pex_re) and non-repairable with probability pin_nre= 1− pin_nre(pex_nre= 1− pex_nre). The type of failure is independent of the failure time. The model of this system is achieved from system I by consideringTr0=pin_reT0,Tnr0=pin_nreT0,Lr0=pex_reL0andLnr0=pex_nreL0SYSTEM V: A System with repairable internal failure and external repairable or non-repairable failure independent of the time up to failureWe assume the basic system I where the internal operational failure is always repairable (pin_re=1) and the external operational failure can be repairable with probability pex_reand non-repairable with probability pex_nre=1−pex_nre. The type of failure is independent of the failure time. The model of this system is achieved from system I by consideringTr0=T0,Tnr0=0,Lr0=pex_reL0andLnr0=pex_nreL0.RemarkNew systems can be obtained by considering independence on the type of failure. In this case, new models can be achieved by considering system I, II and III withTr0=T0pin_re,Tnr0=T0pin_nre,Lr0=L0pex_reandLnr0=L0pex_nre.Some interesting measures associated to system I (the more general system) are calculated. Particular cases can be worked out for the other systems in a similar way.The availability is the probability that the system is working on at a certain time ν. It is given byA(ν)=1−pEKνeI{R<K}2·3K−R−1t∑i=0R∑j=0R−iR!i!j!(R−i−j)!z0iz1jz2R−i−j+I{R=K}t(z0+z1)∑i=0R−1∑j=0R−i−1(R−1)!i!j!(R−i−j−1)!z0iz1jz2R−i−j−1,where the subscript of the vector e is the number of columns ofpEKν(defined in Section 3.2.2).If the system is new initially thenA(ν)=1−ω0D0K(ν)eI{R<K}2·3K−R−1t∑i=0R∑j=0R−iR!i!j!(R−i−j)!z0iz1jz2R−i−j+I{R=K}t(z0+z1)∑i=0R−1∑j=0R−i−1(R−1)!i!j!(R−i−j−1)!z0iz1jz2R−i−j−1.The reliability function is defined as the probability that the system fails by first time after a certain time. This function can be defined by considering different stop times while the system is evolving by time. The distribution function of this stop time is PH-distributed where the absorbing state is the fact that produces the stop event. For instance, if the system is new initially, then the distribution of the time up to first time that the system has not operational units is PH distributed with representation (ω*, P*) whereω*and P* are the initial distribution and the matrix P restricted to the macro-states {E0,…, EK−1}.Thus, the mean time up to first time that the system is not operational is given byμ=ω*(I−P*)−2P*0=ω*(I−P*)−1e.Some different conditional probability of failure can be defined if the different types of failures and preventive maintenance are considered. We focused on system I, a similar reasoning can be developed for the rest of systems.The conditional probability of internal repairable failure is the probability that the system is working on at the beginning of a certain time ν, and an internal repairable failure on the online unit and r warm standby units fail at that moment (an accidental non-repairable failure on the online unit does not occur). This probability is given byϕin_rer,ν=∑k=0K−1I{r≤K−k−1}pEkν−1[Tr0⊗(et−Lnr0)⊗e]pr(1−p)K−k−r−1.The conditional probability of internal non-repairable failure is the probability that the system is working on at the beginning of a certain time ν, and an internal non-repairable failure on the online unit and r warm standby units fail at that moment (any accidental failure can occur). This probability is given byϕin_nrer,ν=∑k=0K−1I{r≤K−k−1}pEkν−1[Tnr0⊗e]pr(1−p)K−k−r−1.The conditional probability of internal failure is achieved by adding both measures above.A similar reasoning as above can be made for the external failures. Thus, the conditional probability of repairable external failure is the probability that the system is working on at the beginning of a certain time ν, and a repairable external failure on the online unit and r warm standby units fail at that moment (an internal non-repairable failure does not occur). This probability is given byϕex_rer,ν=∑k=0K−1I{r≤K−k−1}pEkν−1[(en−Tnr0)⊗Lr0⊗e]pr(1−p)K−k−r−1.The conditional probability of non-repairable external failure is the probability that the system is working on at the beginning of a certain time ν, and a non-repairable external failure on the online unit and r warm standby units fail at that moment (any internal failure can occur). This probability is given byϕex_nrer,ν=∑k=0K−1I{r≤K−k−1}pEkν−1[en⊗Lnr0⊗e]pr(1−p)K−k−r−1.The conditional probability of external failure is achieved by adding both measures above.The conditional probability of major inspection is the probability that the system is working on at the beginning of a certain time ν, and a major inspection occurs by producing preventive maintenance and r warm standby units fail (the online unit does not undergo failures at that time.). This probability is given byϕpmν=∑k=0K−2I{r≤K−k−1}pEkν−1[(en−T0)⊗(et−L0)⊗e]pr(1−p)K−k−r−1.One interesting measure from economic and performance point of view is the mean sojourn time. While the system is working on, this one passes through several states, how long does it spend in each macro-state up to a certain time?From the Markovian theory, it is well-known that the mean sojourn mean time at any macro-state k up to time ν can be worked out as(3)ψkν=∑m=0νpEkme,fork=0,1,…,K.The units of the system are partitioned between online and warm standby, and the repair time of any one, when a repairable failure occurs, depends on it. In this section we are interested about the mean time that the repairpersons are working on units that failed from the online place and from the standby up to a certain time.The mean time that the repairpersons are working on standby repairable failures from the beginning up to time ν is given by(4)ψstbyν=∑m=0ν∑k=1KpEkmqk0,whereqkwis a column vector defined for k=1,…, K−1 asqkw=(qw(0,0,min{k,R}…,0,0)entɛ3I{k>R}(k−R)∏i=02ziqi(0,0,…,0,0)qw(0,0,min{k,R}…,0,1)entɛ3I{k>R}(k−R)∏i=02ziqi(0,0,…,0,1)qw(0,0,min{k,R}…,0,2)entɛ3I{k>R}(k−R)∏i=02ziqi(0,0,…,0,2)qw(0,0,…,1,0)entɛ3I{k>R}(k−R)∏i=02ziqi(0,0,…,1,0)qw(0,0,…,1,1)entɛ3I{k>R}(k−R)∏i=02ziqi(0,0,…,1,1)qw(0,0,…,1,2)eI{k>R}ntɛ(k−R)∏i=02ziqi(0,0,…,1,2)⋮qw(2,2,…,2,2)entɛ3I{k>R}(k−R)∏i=02ziqi(2,2,…,2,2))qKw=(qw(0,0,R…,0,0)e2t3(K−R−1)∏i=02ziqi(0,0,…,0,0)qw(0,0,R…,0,1)e2t3(K−R−1)∏i=02ziqi(0,0,…,0,1)qw(0,0,R…,0,2)e2t3(K−R−1)∏i=02ziqi(0,0,…,0,2)qw(0,0,…,1,0)e2t3(K−R−1)∏i=02ziqi(0,0,…,1,0)qw(0,0,…,1,1)e2t3(K−R−1)∏i=02ziqi(0,0,…,1,1)qw(0,0,…,1,2)⊗e2t3(K−R−1)∏i=02ziqi(0,0,…,1,2)⋮qw(2,2,…,2,2)e2t3(K−R−1)∏i=02ziqi(2,2,…,2,2)).with K≠R and for K=R,qKw=(qw(0,0,R…,0,0)et∏i=02ziqi(0,0,…,0,0)qw(0,0,R…,0,1)et∏i=02ziqi(0,0,…,0,1)qw(0,0,…,1,0)et∏i=02ziqi(0,0,…,1,0)qw(0,0,…,1,1)et∏i=02ziqi(0,0,…,1,1)qw(0,0,…,2,0)et∏i=02ziqi(0,0,…,2,0)qK(0,0,…,2,1)et∏i=02ziqi(0,0,…,2,1)⋮qw(2,2,…,2,2)et∏i=02ziqi(2,2,…,2,2)),being the function qw( · )the number of types of failure w=0, w=1 or w=2, that are being repaired given in the corresponding sequence.The mean time that the repairpersons are working on repairable failures of online units from the beginning up to time ν is given by(5)ψonlineν=∑m=0ν∑k=1KpEkmqk1.The mean time that the repairpersons are working on preventive maintenance from the beginning up to time ν is given by(6)ψpmν=∑m=0ν∑k=1K−1pEkmqk2.The most general system that has been modelled, System I, is subject to several types of events; repairable and non-repairable failures and preventive maintenance. These events are happening by time and it is interesting to analyse the mean number of these ones up to a certain time.Given a type of event, the mean number of occurrences up to time ν is worked out as∑m=1νP{eventoccursattimem}.These measures are calculated by considering the MMAP structure in the modelling.Thus, the mean number of repairable failures of the online unit up to a certain time ν is(7)Γreν=ω∑m=1νPm−1DAe,whereDA=∑r=0K−1DA,r.Analogously, the mean number of non-repairable failures and major revisions of the online unit up to a certain time ν is equal to these expressions respectively,(8)Γnreν=ω∑m=1νPm−1DCeandΓpmν=ω∑m=1νPm−1DBe,whereDB=∑r=0K−2DB,randDC=∑r=0K−1DC,r.Finally, the mean number of warm standby units that fail up to a certain time ν is equal to(9)Γstbyν=ω∑m=1νPm−1∑r=1K−1r[DOr+DAr+DBr+DCr]e.When a complex system is going to be analysed, at least two points must be taken into account: performing times and rewards. In this section we analyse the behaviour of the costs and benefits associated to the system over time.We assume two logical classes of rewards and costs: per unit of time and due to events.While the system is operational, a gross profit is obtained per unit of time. The mean gross profit per unit of time is denoted by B. Also, each unit produces an operational cost per unit of time according to the type of unit. Each operational standby unit produces a mean cost per unit of time equal to csand the online unit produces a cost depending to the operational phase. The mean cost per unit of time produced by the online unit and for each operational phase is given by the column vectorc0.On the other hand, while a repairperson is working, a cost is produced per unit of time, depending on the type of repair (online unit, standby unit and preventive maintenance) and depending on the repair phase in each case. Then, the mean cost per unit of time when a unit is being repaired; type standby, online unit or preventive maintenance is given by the column vectorscr0,cr1 andcr2 respectively. Finally, while the system is not working, a mean loss equal to C is produced by unit of time.Different column vectors containing the mean net reward per unit of time, depending on performing phase and on the types of failures and on the number of units in the repair facility is calculated. Next, the case system I is developed in this section; it can be performed for the other systems analogously.The profit vector containing the mean net profit per unit of time associated to the macro-state Ekis given bynrk={(B−(K−1)cs)entɛ−c0⊗etɛ;k=0(B−(K−k−1)cs)entɛ·3k−min{k,R}∑i=0min{k,R}∑j=0min{k,R}−imin{k,R}!i!j!(min{k,R}−i−j)!z0iz1jz2min{k,R}−i−j−(c0⊗etɛ·3k−min{k,R}∏i=02ziqi(0,.min{k,R}…,0,0)c0⊗etɛ·3k−min{k,R}∏i=02ziqi(0,.min{k,R}…,0,1)c0⊗etɛ·3k−min{k,R}∏i=02ziqi(0,.min{k,R}…,0,2)⋮c0⊗etɛ·3k−min{k,R}∏i=02ziqi(2,.min{k,R}…,2,0)c0⊗etɛ·3k−min{k,R}∏i=02ziqi(2,.min{k,R}…,2,0)c0⊗etɛ·3k−min{k,R}∏i=02ziqi(2,.min{k,R}…,2,0));k=1,…,K−1−C·et(2·3K−R−1)1−I{R=K}∑i=0R−I{R=K}∑j=0R−I{R=K}−i(R−I{R=K})!i!j!(R−i−j−I{R=K})!z0iz1jz2R−i−j−I{R=K}(z0+z1)I{R=K};k=K,and the cost vector containing the mean cost per unit of time depending on the type of repair associated to the macro-stateEi1,…,ikis given bynci1,…,ikk=et(nɛ)I{k≠K}⊗cri1⊙⋯⊙crimin{k,R},where given two column vectors v and w, with order a and b respectively, then v⊙wis defined asv⊙w=v⊗eb+ea⊗w.The mean cost per unit of time depending on the type of repair associated to the macro-state Ekis given bynck={(nc0,0,…,0,0k,nc0,0,…,0,1k,nc0,0,…,0,2k,…,nc2,2,…,2,0k,nc2,2,…,2,1k,nc2,2,…,2,2k)′;0<k<K(nc0,0,…,0,0k,nc0,0,…,0,1k,nc0,0,…,1,0k,nc0,0,…,1,1k,nc0,0,…,2,0k,nc0,0,…,2,1k,…,nc2,2,…,2,0k,nc2,2,…,2,1k)′;k=KFor the case k units in the repair facility the global net column cost vector is built asc0=nr0andck=nrk−nckfork=1,…,K.Finally, the global net column profit vector by considering the state space given in Section 1 is built asc=(c0,…,cK)′.The complex system, described in this work, is subject to several events; repairable failures of the online, repairable failures of the standby units, preventive maintenance and non repairable failure of the online unit. Each time that an event occurs, a mean fixed cost is produced due to several reasons such as materials, new units, etc. We introduce in the model these costs asfcs: mean fixed cost due to one repairable failure of one standby unitfc0: mean fixed cost due to one repairable failure of the online unitfcpm: mean fixed cost due to one preventive maintenancefcnr: mean cost of a new unitDifferent reward measures can be defined from the vectors described above. The costs and profit per unit of time are given by the following expressions.Mean net profit up to time ν(10)Φwν=∑m=0ν∑k=0K−1pEkmnrk,Mean cost due to corrective repair of standby units up to time ν(11)Φsν=∑m=0ν∑k=1KpEkm·mck,0wheremck,w={(mc0,0,…,0,0k,w,mc0,0,…,0,1k,w,mc0,0,…,0,2k,w,…,mc2,2,…,2,0k,w,mc2,2,…,2,1k,w,mc2,2,…,2,2k,w)′;0<k<K(mc0,0,…,0,0k,w,mc0,0,…,0,1k,w,mc0,0,…,1,0k,w,mc0,0,…,1,1k,w,mc0,0,…,2,0k,w,mc0,0,…,2,1k,w,…,mc2,2,…,2,0k,w,mc2,2,…,2,1k,w)′;k=Kbeingmci1,…,ikk,w=entɛ⊗cri1w⊙⋯⊙crimin{k,R}wwherecrtypew=crtypeif type=w andcrtypew=0ztypeotherwise for w=0, 1, 2.Mean cost due to corrective repair of online units up to time ν(12)Φ0ν=∑m=0ν∑k=1KpEkm·mck,1Mean cost due to preventive maintenance up to time ν(13)Φpmν=∑m=0ν∑k=1KpEkm·mck,2.The total net profit up to time ν is worked out by adding costs produced by the events. It is worked out from (7)–(9) and it is equal toΦν=Φwν−Φsν−Φ0ν−Φpmν−(1+Γnrν)fcnr−Γreν·fc0−Γstbyν·fcs−Γpmν·fcpm.The mean net profit measureΦwνtakes into account only the profit generated by the online unit while the system is working on, whereas the mean total net profit,Φν, includes profit and costs due to repair and preventive maintenance.We assume a system with 4 units, the online one and the rest in warm standby, and 2 repairpersons. The objective of this study is to analyse the effectiveness of preventive maintenance in the behaviour of the reliability system. It is going to be studied by comparing some reliability measures by considering the system I (with preventive maintenance) and III (without preventive maintenance) described in Section 4. The lifetime distribution for the online unit, the time distributions between two external shocks and two inspections, the preventive maintenance time distribution and the repair time distributions according to the types of failures are given in Tables 2 and 3. Any standby unit can undergo a repairable failure at any moment with probability p=0.001.The internal behaviour of the online unit is composed of three phases (good, fair, poor). These phases are disposed consecutively. The mean time in each phase is equal to 200, 20 and 20 respectively; therefore the mean time up to internal failure is 240 units of time. The inspections over this unit occur randomly with a mean time between two consecutive inspections equal to 10 units of time. In this case, the online unit is inspected and if phase one or two is observed then the unit continues working. Therefore, if phase three (poor) is observed then the unit goes to repair facility for preventive maintenance. The online unit is subject to external shocks. The mean time between two consecutive shocks is equal to 143.16 units of time.On the other hand, the mean corrective and preventive maintenance time depends on the type of corrective repair. We assume that the mean corrective repair time for the online unit is higher than preventive maintenance. The mean time for corrective repair of the online unit is equal to 50 units of time whereas that the mean preventive maintenance time is 10 unit of time. Preventive maintenance is important to improve the reliability of the system. Finally, the mean corrective repair time for any standby unit is equal to 20 units of time. This failure type is more important than preventive maintenance but not such as the failure of the online unit.When the online unit fails, this one is repairable with probability 0.8 and non repairable with probability 0.2. The column vectors that determine the type of failures for the external shocks are given byLr0=(0.0050.0035)andLnr0=(0.0020.001).Thus, when one external shock occurs then it is repairable with probability 0.7145 and non-repairable with probability 0.2855.This system has been compared with and without preventive maintenance. We assume that the initial vector of the system is built by considering new units, new operational times and, given that the events that produces external shocks occurs consecutively, independently of the rest of the system, the stationary distribution of the time between external shocks is considered. The reliability functions have been built and plotted from Section 5.2. Fig. 3shows the reliability functions in both cases.We can see that the reliability function for the system with preventive maintenance is higher than the case without preventive maintenance. The mean time up to no operational unit by first time is equal to 28,166.16 and 22,619.54 for the system with and without preventive maintenance respectively.Some measures associated to both systems have been compared to analyse the effectiveness of preventive maintenance. Firstly, the mean sojourn time in each macro-state has been calculated in several times from (3). It is shown in Table 4where we can observe that if preventive maintenance is considered, the mean time with all units being operational is higher, whereas the mean time with units in the repair facility is lower.It is also very interesting to analyse the mean time that the repairman is working by considering the different types of failures and preventive maintenance up to a certain time. These measures have been worked out from (4)–(6) and they are given in Table 5 for both systems.In Table 5 we can observe that the repairpersons work more time in units that had an online repairable failure when preventive maintenance was not introduced. Thus, if the case up to 20,000 units of time is considered, the mean time working in online failed units increases a 27.07 percent when preventive maintenance is not taken into account. In this same case, the mean time that the repairpersons are occupied increases a 14.24 percent when preventive maintenance is not applied. This fact is very important from an economic standpoint.Finally, preventive maintenance avoids the failure of the online unit. Therefore, it is interesting to compare the mean number of events occurred up to a certain time between both systems, with and without preventive maintenance. These events are repairable and non-repairable failures of the online unit, repairable failures of the warms standby units and major revisions for preventive maintenance. These measures are worked out by considering the results given in (7)–(9). They are compared in Table 6.From Table 6 we can observe that the mean number of events up to any time on the online unit is lower when preventive maintenance is considered. This fact is essential when high costs are presented when a failure happens.The behaviour of the system has been analysed from the performance point of view, but is preventive maintenance profitable from an economic standpoint? This question is answered by introducing costs and rewards associated to the evolution of the system according Section 6. The following assumptions are considered.While the system is working a profit equal to B=5 and different costs per unit of time are produced. If the online unit is at degradation level 1, 2, or 3, then a cost of 0.5, 1 and 2, respectively, per unit of time is produced while it is working. Each warm standby unit produces a mean cost per unit of time equal to 0.25. The units can fail, and in this case they go to the repair facility. The repairman can be working in different situations; with a unit that failed from online, standby or preventive maintenance. In each case the cost per unit of time is equal to 1.5, 1 and 0.25, respectively. Of course, while the system is not working (all units in the repair facility), this one is having a loss per unit of time equal to C=4.When a failure occurs, a mean fixed cost is produced due to several causes such as new pieces. These ones have a mean cost equal to 1 for any type of failure. Finally, a new unit has a cost equal to 500.The cost vector and the measures given in (10)–(13) have been worked out. The results are compared for system I (with preventive maintenance) and system III (without preventive maintenance). These measures are given in Table 7.A comparison from Table 7 can be performed. The net profit due to performance of the system and performing costs are given byΦwν, and we can observe that preventive maintenance is profitable if any time is considered. Regarding costs, these ones produced by the repairable online failures are higher when preventive maintenance is not considered. Also, we can achieve that the cost due to preventive maintenance is negligible in this case. In this way, the last column show that the total net profit up to a certain time is greater when preventive maintenance is included. Preventive maintenance avoids repairable and non repairable failures of the online unit, and this fact avoids great costs.

@&#CONCLUSIONS@&#
When we wish to model a complex reliability system in order to analyse its evolution over time, it is essential to express this modelling and its associated measures in a well-structured form. In this paper, a complex model with an indeterminate number of units and repairpersons is developed. Derivative systems from this one have also been modelled, examining Markov models by means of a marked, batch-arrival Markovian process. Redundancy is incorporated into the system, where the online unit is subject to internal failures, which may or may not be repairable, and to external shocks. Preventive maintenance is carried out to improve system reliability. The different types of corrective repair and the preventive maintenance performed all follow different time distributions while the unit is in the repair facility. For this reason, the order of the failures must be taken into account and saved in memory, in modelling the process.The Markovian arrival processes examined are versatile and provide an excellent tool for stochastic modelling. Any stochastic counting process can be approximated arbitrarily by a sequence of Markovian arrival processes. We highlight the versatility of MAPs, and analyse several complex models with the corresponding measures, in a well structured form using an algorithmic matrix structure.In summary, in this study we model general reliability systems and associated measures to analyse the behaviour and effectiveness of preventive maintenance, in an algorithmic and computational form. Costs are introduced into the system and a numerical example given to compare the performance and cost behaviour of two similar multi-state reliability systems, with and without preventive maintenance, by means of the features presented in the proposed methodology.