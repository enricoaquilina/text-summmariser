@&#MAIN-TITLE@&#
Numeric analysis and simulation of space vector pulse width modulation

@&#HIGHLIGHTS@&#
We give the derivation for the harmonic distortion factor (HDF).Monte Carlo simulation is an efficient method to analyze the HDF.We discuss the method to build a universal SVPWM simulation platform.Harmonic spectra can be gotten through theoretical formulas and simulation.The simulation number can be determined according to the specified precision.

@&#KEYPHRASES@&#
Space vector pulse width modulation,Harmonic distortion factor,Current ripple,Harmonic spectrum,Simulation model,Monte Carlo simulation,

@&#ABSTRACT@&#
In order to demonstrate and analyze the characteristic of the space vector pulse width modulation (SVPWM) technology, several key issues are discussed. The harmonic distortion factor derivation, the numerical analysis method and the program code are presented. The main components of the simulation model are discussed, and the key code is given. The theoretical and simulation spectra of the phase voltage and the DC bus current are presented. The program code is universal and can be used to many other kinds of SVPWM strategies with some minor modification. The simulation result shows that the simulation number has heavy effects on the analysis precision in the Monte Carlo method, and the simulation model is feasible and effective. The theoretical numerical analysis formulas of the SVPWM strategy are always complex, while the simulation method is convenient, so it is excellent if the two methods are used in conjunction.

@&#INTRODUCTION@&#
The two-level three-phase inverter has been widely used in all kinds of fields, such as industry, agriculture and transportation for a long time [1–4]. Based on the volt-second balance principle, the pulse width modulation (PWM) technology is utilized to invert the direct current (DC) source to the alternating current (AC) one with the variable amplitude and frequency under the control of the controller [5,6]. Among lots of modulation strategies, the sinusoidal PWM (SPWM) is a kind of mature modulation strategy and can be realized easily through the hardware, while the space vector PWM (SVPWM) strategy is another widely used modulation type and can be realized easily in the digital control system. Compared with SPWM, SVPWM has many advantages of excellent harmonic performance, high DC voltage utilization ratio, and so on. The SVPWM strategy has been discussed in plenty of literature, and the research method can be divided into three categories: theoretical derivation [5–8], physics experiment [5,9] and computer simulation [8,10]. Holmes and Lipo [5] systematically discussed the harmonic characteristic and optimal method to the SVPWM strategy, introduced some other modulation strategies, and gave many theoretical derivation and relative formulas. The three methods have their advantages and disadvantages. The theoretical derivation is very accurate, easy to distinguish the essential and subtle difference between different strategies, and provides the foundation for optimization, but it is always complex. The computer simulation is an effective and powerful tool for the modulation analysis with the great improvement of the simulation software package, such as MATLAB/Simulink, PSpice, Plecs and psim, so how to build the SVPWM model in the speed regulating system to study the modulation characteristic is discussed in plenty of literature. In the theoretical derivation and the computer simulation, the device models are always idealized to simplify the problem, and only consider the main factor. The physical experiment is nearest to or almost is the actual application cases, but the experiment setup and procedure may be complex and expensive. The engineering software MATLAB is a powerful package for the numerical computation, formula derivation, simulation and characteristic presentation, so MATLAB is widely used in PWM research [11–13]. The paper discusses several key issues to SVPWM and the numeric analysis procedure and simulation building method using MATLAB. The paper is structured as follows. The basic principle and classification are introduced in Section 2, the harmonic distortion factor (HDF) formula derivation is discussed in Section 3, how to develop the universal simulation model is proposed in Section 4, the spectrum analysis is discussed in Section 5, and some conclusions are drawn finally.The SVPWM is based on the volt-second balance principle. The combinations of the switch states form six active voltage vectors(U→1,U→2,U→3,U→4,U→5andU→6)and two inactive (zero) voltage vectors(U→0andU→7)as shown in Fig. 1[4].The endpoints of the six active vectors form a hexagon which can be divided into six sectors. The vector summation method in the first sector is shown in Fig. 1, where Tsis the switching period (modulation period),U→sis the target voltage vector, θ is the argument ofU→s, andTSV1, TSV2 and TSV0 are the duration time ofU→1,U→2and the zero vector (U→0and/orU→7). The commonly used working sequence of the basic vectors is expressed by Eq. (1) and the three-phase switch signal waveforms of the upper arms in every sector are shown in Fig. 1.(1)→[U→0→U→1→U→2→U→7→U→2→U→1→U→0]→[U→0→U→3→U→2→U→7→U→2→U→3→U→0]→[U→0→U→3→U→4→U→7→U→4→U→3→U→0]→[U→0→U→5→U→4→U→7→U→4→U→5→U→0]→[U→0→U→5→U→6→U→7→U→6→U→5→U→0]→[U→0→U→1→U→6→U→7→U→6→U→1→U→0]→There are countless strategies that satisfy Eq. (1) and the volt-second balance principle. The strategy can be classified into two kinds: deterministic SVPWM (DSVPWM) and random SVPWM (RSVPWM). It should be pointed out that the classification is not absolute and the classification method can be done based on other characteristics.The DSVPWM includes continuous SVPWM (called simply as CPWM) and discontinuous SVPWM (DPWM). The classical DPWM strategies include DPWM0, DPWM1, DPWM2, DPWM3, DPWMMIN and DPWMMAX. In the volt-second balance principle, the duration time partitioning coefficient of the two zero vectors is indeterminate. If the duration time ofU→0andU→7are TSV0 and TSV07, the partitioning coefficient is defined as(2)R0=TSV07/TSV0The distribution method is the essential difference between DPWM and CPWM. R0 is either 1 or 0 for the six classical DPWM strategies while 0.5 for the most common traditional CPWM strategy (called simply as TSVPWM).The RSVPWM strategy includes random frequency RSVPWM (RSFPWM), random zero vector distribution RSVPWM (RZDPWM), random pulse position RSVPWM (RPPPWM) and hybrid RSVPWM (HRPWM) that is the combination of RZDPWM, RSFPWM and RPPPWM. The RSVPWM strategy is controlled by no less than one random variable. R0 is a random variable for RZDPWM. The switch period Ts/switch frequency is a random variable for RSFPWM and the RPPPWM is controlled by three random variables.The micro HDFf(M,θ) is defined based on the harmonic mean square value of the three phases ripple currents [5,7–9].(3)ΔiH-MS=ΔiAB2+ΔiAC2+ΔiBC2=UDC2Lσ2Ts2483f(M,θ)whereΔiAB,ΔiACandΔiBCare the three-phase ripple currents with delta connection load,〈ΔiAB2〉,〈ΔiAC2〉and〈ΔiBC2〉are the mean square value of the ripple currents, UDC is the DC voltage, Lσis the equivalent line–line inductance, and M is the modulation index.Through integral in the first sector, the macro HDF can be gotten and expressed as(4)F(M)=1π/3∫0π3f(M)dθIn order to get the theoretical equations for the micro and macro HDF, the symbolic computation function in MATLAB is utilized, and the key program code is as follows.In the program, fm and FM are respectively the micro and macro HDF. If R0 is replaced by 1, 0, and 0.5, the HDF formulas for DPWMMAX, DPWMMIN and TSVPWM are gotten. Based on the following program code, the macro HDF can be got as shown in Fig. 2.From Program segment 1, we can find that the macro HDF includes four variables R0, R1, R2 and R3. R1, R2 and R3 control the pulse positions and R0 controls the partitioning method of the two zero-vectors. The four variables are constants or change according to the deterministic rule of the DSVPWM strategy. One or more variables may be random variables for the RSVPWM strategy, and the micro and macro HDF formulas are random functions. The characteristic of the HDF can be analyzed more easily if the probability distribution law is simple, while difficult if the distribution law is complex to RSVPWM. So the Monte Carlo simulation is a universal method and is applicable to any case. The code for a hybrid RSVPWM macro HDF analysis is list in Program segment 3. In the code, Nmax is the simulation number; the variable Pro stores the probability density of macro HDF; FMmin, FMmax and FMmean are the maximum, minimum and mean HDF values for the every modulation index respectively. The probability density is shown in Fig. 3using MATLAB command mesh (myHDF, myM, Pro). Nmax has heavy effect on the computation precision, and the maximum, minimum and mean HDF values with difference Nmax are shown in Fig. 4using MATLAB command plot (myM, FMmin, myM, FMmax, myM, FMmean).The sample size N (Nmax in Program segment 3) can be determined by(5)N=k2σε2where σ is the standard derivation of the macro HDF, ɛ the absolute error of the macro HDF between the mathematical expectation and the sample average, and k the coefficient determined by the specified confidence level.A unified SVPWM simulation platform is developed including TSVPWM, DPWM0, DPWMM1, DPWMM2, DPWMM3, DPWMMIN, DPWMMAX, RZDPWM, RPPPWM, RSFPWM and several HRPWM and other strategies. The building procedure can be divided into four components: interface design, random number generation, period control and signal generation.The parameter setup includes SVPWM type, RSVPWM/DPWM strategy, random distribution pattern, switching period/frequency and dead time. The Mask Subsystem function is used to design the interface. Seven variables are used and the triple tables <variable, Prompt, Type> are as follows: <PWMtype, SVPWM type, popup>, <DSVPWMstr, DSVPWM strategy, popup>, <RSVPWMstr, DSVPWM strategy, popup>, <RanDis, Random distribnution, popup>, <Tpwm, PWN period, Edit>, <Td, Dead time, Edit> and <DSVPWMth0, DSVPWM starting angle (rad), Edit>. The Dialog Callback for PWMtype is as follows.A variable k is used to identify the SVPWM strategy selection, and the code of the initialization commands is shown in Program segment 5. For example, if the RPPPWM with the uniform distribution is selected, the value of k is 3310, k is 3320 for the RPPPWM with the normal distribution, and k is 3330 for the RPPPWM with the triangular distribution. The interface is shown in Fig. 5with the different selection.MATLAB provides many pseudorandom number generating functions, such as rand for uniformly distributed pseudorandom numbers and randn for normal distribution numbers. The distribution that cannot be generated directly using only one function in MATLAB can be derived from the uniform distribution over the unit interval (0,1). To the unbounded distribution (normal distribution, for example), the random number should be truncated. The three-sigma rule is adopted, that is to say, if the difference between the random number and the mean is more than triple standard deviations, then this number should be removed, and one new number is generated until the rule is satisfied. To generate a random number RandNum between 0 and 1, the following code can be used.Persistent variables are adopted in the model. The random number and the switch period are also defined as persistent variables. The persistent variable values are computed and assigned in the first simulation step of a switch period and held in the whole switch period. For example, the random numbers are generated in the first simulation step. The simulation clock is used to judge if a new PWM period begins. The relationship between the simulation clock and the PWM period is shown in Fig. 6.In order to prevent short circuit of the DC bus voltage resulting from the turn-on and turn-off delays, the dead time is required. The narrow pulse is also removed in the simulation model.Using the simulation model developed in the paper, the switch signal waveforms for TSVPWM, DPWM0 and RZDPWM are shown in Fig. 7.The harmonic analysis is an important subject to the inverter and modulation method. The harmonic has heavy effects on mechanical vibration, motor temperature increase, acoustic noise, electromagnetic radiation, DC bus capacitance, and so on. The mathematic expressions of the output phase voltage and line voltage for the PWM strategies widely used based on Double Fourier Integral have been given and discussed in plenty of classic literature by some researchers, such as Holmes and Lipo [5] and Chen [4]. The output pulse phase voltage can be expressed as the sum of infinite series [5].(6)where ωcis the carrier angular frequency, θcthe phase offset angle for carrier, ω0 the modulation wave angular frequency, θ0 the phase offset angle for the modulation wave, and A00, B00, Amnand Bmnare the coefficients determined by the PWM strategy.The frequency spectrum of the phase voltage can be easily presented by programming using Eq. (6) in MATLAB. The DC bus current can be expressed using the phase voltage and the switch function, and the formula is very complex. Because the spectrum of the phase voltage and the switch function can be computed using Eq. (6), the spectrum of the DC bus current can also be easily computed in MATLAB. Based on the simulation model, the spectra of the phase voltage and the DC bus current can be analyzed using fast Fourier transform (FFT) in MATLAB/Simulink. The theoretical and simulation spectra of the phase voltage are shown in Fig. 8, where the simulation spectrum is truncated for easy comparison. The theoretical and simulation DC bus current spectra with the load of a salient pole PMSM are shown in Fig. 9. The theoretical and simulation results are consistent from the figures.

@&#CONCLUSIONS@&#
(1)The HDF derivation and numerical analysis method and the MATLAB code are presented. The program code is universal and can be used to many other kinds of SVPWM strategies with minor modification. The result shows that the simulation number has heavy effects on the analysis precision in the Monte Carlo simulation.The main components of the SVPWM simulation model are discussed and the key program code is given. The simulation result shows that the simulation model is feasible and effective in the modulation study.The harmonic analysis is an important subject to the inverter and modulation method. The theoretical and simulation spectra of the phase voltage and the DC bus current are presented and the comparison shows their good consistency.The theoretical numerical analysis formulas of the SVPWM strategy are always tedious, and the simulation is intuitionistic and convenient. So it is excellent if the two methods are used in conjunction.