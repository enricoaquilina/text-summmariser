@&#MAIN-TITLE@&#
The use of a particle method for the modelling of isotropic membrane stress for the form finding of shell structures

@&#HIGHLIGHTS@&#
Derivation of equilibrium equations for loaded shell structures with a varying isotropic stress.The application of the finite element method for the numerical implementation.The introduction of a new particle method for the numerical implementation.

@&#KEYPHRASES@&#
Masonry shell,Isotropic stress,Minimal surface,Particle methods,

@&#ABSTRACT@&#
The best known isotropic membrane stress state is a soap film. However, if we allow the value of the isotropic stress to vary from point to point then the surface can carry gravity loads, either as a hanging form in tension, or as a masonry shell in compression. The paper describes the theory of isotropic membrane stress under gravity load and introduces a particle method for its numerical simulation for the form finding of shell structures.

@&#INTRODUCTION@&#
In conventional structural design the geometry of a structure is first chosen more or less arbitrarily and then analyzed to establish how well it performs. It is then modified to improve its performance and this cyclic process is continued until the designers are satisfied. Michael Brawne  [1] likened this cyclic optimization process (as applied to architectural design) to Karl Popper’s theory of the scientific method. The optimization process can be automated using computers using techniques including genetic algorithms  [2] and simulated annealing  [3].Form finding techniques rely on physical or numerical models to automatically generate the form. The model must have different, but analogous, properties to the structure being designed and classic examples include Antoni Gaudí’s hanging models for the masonry vaults of the Church of Colònia Güell  [4] and Frei Otto’s soap film models for fabric, cable net and gridshell structures. Form finding techniques do not produce an ‘optimum form’, but a ‘good form’. However in practice the difference between optimization and form finding is arbitrary—one would expect form finding to be taken through a number of ‘optimization’ cycles involving analysis of the structure in its proposed final form in masonry or fabric.Masonry shells can only work in compression and a number of numerical techniques have been developed for finding their geometry to achieve a specified stress state under dead load  [5–12]. In this paper we propose the use of a variable isotropic stress state where the membrane stress is uniform in all directions with no shear stress, but the value of the stress varies from point to point.There is no particular reason why the compressive membrane stress should be isotropic, but it could be argued that an isotropic stress is in some ways optimum. This mirrors the argument that a minimal surface is the best shape for a cable net or fabric structure. Certainly we want to avoid loss of compression in a masonry structure leading to cracking or loss of tension in a tension structure leading to wrinkling. Thus we want the radius of Mohr’s circle for stress  [13] to be less than the mean stress. The simplest case is to set the radius of Mohr’s circle equal to zero corresponding to an isotropic stress. Note that Mohr’s circle construction can be applied to any symmetric second order tensor, for example surface curvature  [14].Imposing the condition that the stress state should be isotropic also has the effect of avoiding undue stress concentrations. In general this is a good thing, but there are circumstances where one wants a concentration of stress or force, for example at a point support or at a boundary arch. However a boundary arch can be modelled as a separate entity leaving the state of stress in the rest of the shell isotropic.We will use the expression ‘surface tension’ to denote the value of the isotropic membrane stress expressed as a force per unit length. If the stress is compressive, then the surface tension is negative. It is often thought that the surface tension in a soap film is constant, but if this were the case it would not be possible for a soap film to carry its own weight. A vertical soap film must have a higher surface tension at the top than at the bottom. The situation is analogous to hydrostatic pressure that must increase with depth.Even without gravity surface tension must vary with film thickness. Imagine a soap film with slight fluctuations in thickness. The surface tension must be greater where the film is thinner to pull fluid from thicker areas to ensure stability  [15].In the following sections we present the theoretical analysis of an isotropic membrane stress under gravity loads. We then give an example of the solution of the equations using the finite element method. Finally we formulate and illustrate the use of a particle method for numerical simulations.The methods described in Sections  2.1 and 2.2 are based on those in Green and Zerna  [16], but with some changes in notation.Consider a surface described by the position vector(1)r(θ1,θ2)=x(θ1,θ2)i+y(θ1,θ2)j+z(θ1,θ2)k.i,jandkare unit vectors in the directions of the Cartesian axes andθ1andθ2are the surface parameters or coordinates replacing theuandvwhich are often used. Note that the 1 and 2 are not exponents.The covariant base vectors are(2)gi=∂r∂θi=∂x∂θii+∂y∂θij+∂z∂θikin whichiis equal to 1 or 2.g1andg2are tangent to the surface in the directions of increasingθ1andθ2respectively. Note that they are in general not unit vectors, nor are they perpendicular to each other.The components of the metric tensor are(3)gij=gi⋅gjand the square of the distance between adjacent points on the surface is(4)δs2=(∑i=12∂r∂θiδθi)⋅(∑j=12∂r∂θjδθj)=∑j=12∑i=12gijδθiδθj=gijδθiδθj.The summations in the right hand side of this expression are implied by the Einstein summation convention. This expression forδs2is known as the first fundamental form and thereforegijare also known as the coefficients of the first fundamental form.The quantity(5)g=g11g22−g122and the unit normal,(6)n=g1×g2|g1×g2|=g1×g2g.Note thatgis not a scalar in that it is a property of the coordinate system, rather than something with physical meaning.The contravariant base vectorsgjalso lie in the plane of the surface. They are defined by(7)gi⋅gj=δijn⋅gj=0in which the Kronecker deltas,δij=0ifi≠jandδij=1ifi=j. Thusg1is perpendicular to bothg2andnand its magnitude is such thatg1⋅g1=1.The contravariant components of the metric tensor are(8)gij=gi⋅gjand a vector can be expressed as(9)v=vigi+vn=vigi+vnin which(10)vi=gijvjvi=gijvj.Again note the use of the summation convention in (9) and (10).Finally, the coefficients of the second fundamental form are(11)bij=bji=∂gi∂θj⋅n=∂gj∂θi⋅n=−gj⋅∂n∂θiand the second fundamental form itself is(12)δr⋅δn=−bijδθiδθj.bijtell us about how the direction of the normal changes as we move about on the surface, in other words, about the curvature of the surface.bijandgijare not independent, they are linked by the Gauss–Codazzi–Mainardi equations which ensure that the surface fits together.We are now in a position to define the membrane stress tensorσ=σijgigjby(13)δf=ϵikσijgjδθkin whichδfis the element of force crossing the imaginary cutδr=gkδθk.ϵ12=−ϵ21=gandϵ11=0andϵ22=0are the components of the Levi-Civita permutation pseudotensor. Note that we are not yet making the assumption that the membrane stress is isotropic.Eq. (13) makes a bit more sense when written out in full:(14)δf=g(σ11δθ2−σ21δθ1)g1+g(σ12δθ2−σ22δθ1)g2,especially when compared to the equivalent relationship for plane stress in two dimensions in Cartesian coordinates:(15)δf=(σxδy−τyxδx)i+(τxyδy−σyδx)j.Equilibrium of moments about the surface normal tell us that the stress tensor is symmetric,σ12=σ21.Adding the forces on a small quadrilateral of shell we have(16)∂∂θ2(ϵi1σijgj(−δθ1))δθ2+∂∂θ1(ϵi2σijgjδθ2)δθ1+wgδθ1δθ2=0wherewis the load per unit surface area. Thus(17)∂∂θi(gσijgj)+wg=0.In terms of components this can be written as(18)σijbij+w=0which is the equilibrium equation in the direction of the normal and(19)∇iσij+wj=0which are the two equilibrium equations in the plane of the surface.∇iσijis the covariant derivative,(20)∇iσij=∂σij∂θi+σkjΓkii+σikΓkijand(21)Γkij=gj⋅∂gk∂θiare the Christoffel symbols of the second kind.The previous section provided the theoretical background for understanding the membrane equilibrium equations for shell and tension structures. Next, we derive the equations for isotropic membrane stress.If the state of stress is isotropic the membrane stress tensor is(22)σij=σgijin which the scalarσis the surface tension with units force per unit width.The equilibrium equations now become(23)σgijbij+w=0and(24)∇i(σgij)+wj=0.However(25)gijbij=2HwhereHis the mean or Germain curvature so that in the normal direction,(26)2σH+w=0.When the loading is zero we haveH=0which is the condition for a minimal surface.The covariant derivatives of the components of the metric tensor are zero so that the in-plane equilibrium equations become(27)∂σ∂θi+wi=0.If the loading is vertical then(28)wi=−Wgi⋅kw=−Wn⋅kin whichWis the downwards load per unit surface area. However,(29)gi⋅k=∂z∂θi,so that the in-plane equilibrium equations become(30)∂σ∂θi=W∂z∂θi.Thusσmust be a constant along a contour line of constantzand thereforeσmust be a function ofzonly. Thus(31)dσdz=WandWis therefore also a functionzonly.If we write(32)W=W(σ)whereW(σ)is a function that we have chosen, then(33)z=∫dσWgiving us the relationship betweenW,σandz.The equilibrium in the normal direction is(34)2σH=Wcosλwhereλis the slope of the shell, that is the angle betweennandk.The physical stress in a shell of thicknesstis(35)σphysical=σtin units of force per unit area. Remember thatσis the membrane stress with units force per unit length. The weight per unit surface area isW=ρgtwhereρis the density andgis the acceleration due to gravity (not to be confused with the geometric quantity with the same symbol).Thus(36)σphysicalρg=σWand therefore if the ratioσphysical/ρis constant,(37)σW=−ain whichais a constant with units of length. The minus sign is to give us a negativeσcorresponding to compression whenWandaare positive.Then(38)dσdz=−σaand therefore the thickness,(39)t=t0exp(z0−za).The shape of the shell is given by(40)2aH+cosλ=0in whichHis negative for a dome-like shell.If(41)W=W0+Q(z0−z)whereQis a constant, then(42)σ=σ0−W2−W022Q,unlessQ=0in which caseWis a constant and(43)σ=σ0−W(z0−z).We will focus our attention on the case when(44)σ0=−W022Qso that(45)σ=−W22Qand(46)σW=−W02Q−12(z0−z).The membrane stress is proportional to the thickness squared, rather than just the thickness as in the previous section. This is justified by the following reasoning. Even though we try and design shells to work by membrane action, they need bending stiffness to resist buckling and also to resist non-funicular loads, that is loads which excite possible inextensional modes of deformation as analyzed in Lord Rayleigh’s 1890 paper on the oscillation of bells  [17].We know that the linear buckling theory of shells can give extremely optimistic results, but the Zoelly and Van der Neut formula  [18] tells us that the linear buckling load of a spherical shell of given radius is proportional to the square of the thickness. This is because buckling involves bending stiffness as well as membrane stiffness  [19]. Clearly non-linear buckling is also influenced by both bending and axial stiffness.In cylindrical polar coordinates a shell of revolution is described byz=z(r)and the slopeλand arc length along the cross-sectionsare related torandzbydr/ds=cosλanddz/ds=sinλ.The mean curvature is(47)H=12(dλds+sinλr)and therefore Eq. (34) becomes(48)dλds=2H−sinλr=Wσcosλ−sinλrin whichW/σis a known function ofz. There is an analytic solution to this equation for the case whenW=0, the catenoid minimal surface,r=ccosh(z/c).There is also the cone(49)σW=z2which satisfies (31) and produces(50)0=dλds=2zcosλ−sinλrso that(51)λ=tan−1(2)=54.7°.For other cases we can integrate numerically by marching along the curve using Eq. (48) from a starting point with givenr,zandλ.Figs. 1 and 2show the uniform physical stress shell,σ/W=constant, while Figs. 3 and 4show theσ/W2=constantshell. In each case there is the possibility of a shell closed at the top or a shell with an oculus surrounded by a catenoid-like section. Fig. 3 shows a 54.7° slope cone in red.Eq. (48) naturally wants to form an oculus becausedλ/dswill tend to infinity ifr→0unless the initial conditions are such thatsinλ→0asr→0.If there is no oculus, the radius of curvature atr=0is equal to2σphysical/(ρg). If we takeρgto be 20 kN/m2 andσphysicalto be 10 MPa for a typical masonry, then we have a radius of curvature of 1000 m, showing how efficient shell structures could be.In this section we describe an example of the solution of the equations using the finite element method. It is included to give an indication of the sort of forms that can be derived using an isotropic stress shell. However, because techniques for the numerical form finding of tension structures by modelling a soap film using the finite element method are well established  [20], we will not describe the approach in detail.These techniques usually use flat triangular shape functions in which the degrees of freedom are the nodal coordinates. The area of a triangle is half the base times the height and the strain energy is the surface tension times the area. Hence upon differentiating the strain energy with respect to the degrees of freedom, the forces that a triangle exerts on its nodes are equal to the surface tension times half the length of the opposite side acting in the direction perpendicular to the side  [20].A compression shell is an inverted hanging membrane and Fig. 5shows a shell with uniform physical stress that is partly supported by the horizontal ground and partly by a weightless, momentless arch. A weightless arch could by physically realized by a concrete arch forming the edge of a weak masonry shell in which the arch has the same weight per unit area as the masonry. The arch could be prestressed in compression using flat jacks to ensure strain compatibility. Note that the slope of the shell is almost vertical near the scalloped edge. This is difficult to achieve using techniques which project the shell surface onto a horizontal plane  [5,7,8].The outer boundary is formed by the equationr=r0(1+0.15cos(6θ))in polar coordinates. The other boundaries are the inner arch and two radial lines at an angle2π/3with a ratio of inner to outer radii of 5.23. The shape of the shell is fixed by these parameters together with the ratio of load to membrane stress and the length of the arch.The differential equation corresponding to uniform physical stress (40) was solved using quadrilateral finite elements which were simply formed from two triangles joined along the diagonal of each quadrilateral. Element symmetry was ensured by splitting each quadrilateral two ways using both diagonals and averaging the values.The equations were solved using Dynamic Relaxation  [20]. This is an explicit method, which means that we do not need to formulate the stiffness matrix, and since this is a non-linear problem we cannot use the stiffness matrix to evaluate nodal forces. The stiffness matrix involves the second derivatives of the strain energy with respect to the degrees of freedom and these are only constants for a linear problem. The equivalent nodal forces come from the first derivatives of the strain energy and these can only be obtained from the second derivatives if the second derivatives are constants.We have only one differential equation and this controls the shape of the shell by forces in the normal direction. Nodes are free to float over the surface in very much the same way as the molecules of a real soap film. We need two more conditions to control nodal positions and one could be that one set of element edges form contour lines. Other possibilities include an equal mesh Chebyshev net or a geodesic coordinate system whose constant spacing could be relevant to laying masonry in courses. However, in this case the nodal positions were simply controlled by giving the element edges a constant tension coefficient or force density, that is force divided by length. The component of these forces was removed from the normal direction.We shall now investigate the use of a particle method to solve the equations developed in Section  2. The particle method is much less computationally efficient than the finite element method, but is of some theoretical interest.The method is based upon techniques developed for smoothed particle hydrodynamics  [21,22]. This is a mesh-free Lagrangian technique used for computational fluid dynamics, particularly in the film industry. The particles represent fluid particles and apply pressure and viscous forces to their near neighbours. Similar methods can also be used for solid mechanics and Silling  [23] has coined the term peridynamics for the technique. However a soap film is more a fluid than a solid and so our treatment is more like that of smoothed particle hydrodynamics in that links between particles are continuously being formed and broken.Consider a system of fluid particles in surface. The mass of theith particle ismiand its position is defined by the position vectorriwhich is a function of time. Let us suppose that there is a tension in the ‘link’ joining theith andjth particles equal to(52)Tij=Cijmimja3f(rija)where(53)rij=|ri−rj|andCijis a quantity with units force times length cubed over mass squared.ais a constant with units of length andf(rij/a)is some function which decreases with the separationrijto such an extent that only neighbouring particles interact.Consider a uniform virtual membrane strainϵ(not to be confused with the permutation pseudotensor). The virtual work associated with theith particle is(54)ϵ2∑j(Tijrij)in which the factor of12is there because each link is shared by two particles.If the surface tension in the surface to be modelled isσ, the virtual work per unit area is2σϵin which the 2 is there because the area strain is2ϵ.Thus the virtual work per unit mass is(55)ϵ2mi∑j(Tijrij)=2σϵμin whichμis the mass per unit area.Thus(56)σμ=14mi∑j(Tijrij)=14a2∑j[Cijmjrijf(rija)].We have large number of particles and therefore we can replace the summation by an integral so that,(57)σμ2=14a3∫Crf(ra)dmμ=14a3∫r=0∞Cf(ra)2πr2drin whichCis the value ofCijin the neighbourhood. If we scalef()such that(58)∫u=0∞f(u)2πu2du=2,then(59)C=2σμ2.Howeverσ/μ2will usually not be constant. Thus we could, for example, write(60)Cij=σiμi2+σjμj2,provided that we have an expression for the surface tension associated with theith particle,σi, as a function of the corresponding mass per unit area,(61)μi=∑j(mjF(rij/b))∫r=0∞F(r/b)2πrdr=∑j((mj/b2)F(rij/b))∫r=0∞F(r/b)2π(r/b2)dr=∑j((mj/b2)F(rij/b))∫u=0∞F(u)2πudu.F(r/b)is a weighting function andbis a constant length which would usually be set equal toa. This formula is based upon the idea that the integral of the mass per unit area over area is equal to the total mass.Again it makes sense to scaleF()so that(62)∫u=0∞F(u)2πudu=1in which case(63)μi=∑j(mjb2F(rijb)).It is conventional in smoothed particle hydrodynamics to set(64)f(u)=−F′(u)and this is consistent with our analysis because then(65)1=∫u=0∞F(u)2πudu=[F(u)2πu2/2]u=0∞−∫u=0∞F′(u)πu2du=−∫u=0∞F′(u)πu2du=∫u=0∞f(u)πu2du.The numerical experiments described in the next section used(66)F(u)=e−u2πand(67)∫u=0∞F(u)2πudu=∫u=0∞e−u22udu=−[e−u2]u=0∞=1as required.We also have(68)f(u)=2ue−u2πand therefore the force between adjacent particles is zero ifrij=0.Fig. 6shows a shell with no load compared with the catenoid in black. The analysis has 27,000 particles and the radius of influence of each particle is such that each particle interacts with approximately 12 neighbours. Fig. 7is a loaded shell with constant physical stress so thatσ/μ2in Eq. (56) is proportional to1/μ. In this case there are 75,000 particles and each particle interacts with approximately 25 neighbours.In each case only half the shell is drawn so that the particles on only one side are seen. Particles near the line of symmetry are drawn in red in Fig. 7 to show the shape of the cross-section which should be compared with part of Fig. 2.The shapes were found using Dynamic Relaxation  [20] which is essentially the same as Verlet integration  [24]. In each cycle the force between each pair of interacting particles is calculated and hence the resultant force on each particle, including the own weight when appropriate. The increment in particle velocity would normally be the resultant force divided by the particle mass times the time step, but we describe below how this was modified to ensure stability. The increment of displacement is the updated velocity times the time step. The time step and damping were chosen by trial and error since the best values are difficult to predict by purely theoretical considerations.Smoothed particle hydrodynamics is stable because pressure increases with density, and as noted in the introduction a soap film can only be stable if its surface tension increases as it gets thinner, that is ifσ/μ2is inversely proportional to at leastμ3. Numerical experiments were conducted trying to model this behaviour, but with limited success.It was therefore decided to allow the membrane stress to increase with mass per unit area area—which is what we want for the constant physical stress shell when loaded by gravity. This gives us two possibilities:Tension surfacewhich is unstable within its own plane and stable out of the plane.which is stable within its own plane and unstable out of the plane.In fact the two approaches are essentially the same, in the stable direction particles are moved in the direction of the out of balance force while in the unstable direction they are moved in the opposite direction to the out of balance force. This was done as follows. The symmetric second order tensor(69)Qi=1mi[4Pi−tr(Pi)I]in which(70)Pi=∑j[mj[(ri−rj)(ri−rj)/a2]f(rij/a)]∑j[mjf(rij/a)]and I is the unit tensor was evaluated for each particle in each cycle. Two of the principal directions (or eigenvectors) ofPiwill approximately lie in the local plane of the surface and the corresponding principal values (or eigenvalues) will be positive and approximately equal. The third principal direction will be approximately normal to the surface and the corresponding principal value will be approximately zero.Thus the two tangential principal values ofPiwill be approximately(1/2)tr(Pi)and therefore the three principal values ofQiwill be approximatelytr(Pi)in the two tangential directions and−tr(Pi)in the normal direction.Hence if we multiply the out of balance force byQiwe will automatically move a particle in the correct direction for a compression surface. For a tension surface we simply change the sign ofQi.The amount of motion per iteration is also controlled by the time step and the amount of damping in the Dynamic Relaxation, which were chosen by trial and error.We have replaced Newton’s second lawai=fi/mi(whereaiandfiare the acceleration and resultant force upon theith particle) by(71)ai=Qi⋅fiand soQiis the ‘reciprocal of inertia tensor’. It is perhaps unsatisfactory to introduce a concept which does not have any obvious physical meaning in real dynamics, but we are only interested in using fictitious dynamics to find a stable static solution. A real soap film manages to be stable in both the normal and tangential directions and hence exhibits both the characteristics of tension and pressure. In reality the soap film has a real thickness with internal pressure and an apparent surface tension in its two bounding surfaces caused by attractive forces. Thus to properly simulate a soap film using particles it may be necessary to have sufficient particles to model this truly three dimensional behaviour.The boundary conditions were very simple. The catenoid in Fig. 6 started as a circular cylinder contained within a cylindrical ‘can’ with ends. The velocity of any particle which moves outside the can is reversed in direction, vertically and/or radially. Thus the particles simply ‘bounce off’ the wall and ends and this produces the concentration and layering of particles where the lid and bottom meet the wall. There are no special boundary particles and this technique will work for tension or compression surfaces. It works for tension surfaces because then particles move in the opposite direction to out of balance forces in the tangential direction.The boundary conditions are similar for the loaded shell in Fig. 7, except for the addition of a ‘ball’ centred at the middle of the bottom. The initial shape was a parabola rotated around the axis.Fig. 8shows an unloaded soap film supported by a Frei Otto eye, a loop of cotton attached to a fixed point. In this case each particle interacts with approximately 10 particles and there are a total of 19,000 particles. The outer boundary is the bottom of a ‘can’ and the cotton is simply modelled as ordinary soap film fluid particles (shown in red on Fig. 8) linked by short lengths of cotton modelled by elastic links. These particles are permanently attached to the cotton.Fig. 8 can be compared with the physical model in Fig. 9and with Fig. 10which shows the principal curvature net on the minimal surface found using the method described in  [25]. The tension in the cotton means that its curvature vector must lie in the local plane of the surface and therefore it must be in an asymptotic direction on the surface. Since there is no shear stress in the surface, the tension in the cotton is constant and therefore the magnitude of its curvature, that is the geodesic curvature, must be constant. The outer boundary of the soap film in Fig. 10 is contained within a sphere within which the soap film is free to slide. This means that the soap film is normal to the sphere and therefore there can be no twist along the edge so that the outer boundary is a principal curvature direction.

@&#CONCLUSIONS@&#
In this paper we have discussed the use of a variable isotropic membrane stress for the form finding of shell structures. The solution of the resulting equations was done firstly using the finite element method, and secondly using a particle method similar to smoothed particle hydrodynamics.The particle method is very much less efficient, but does avoid the necessity of generating a grid. It is also nearer to a true physical analogue and may have other applications. It should be possible to model a soap film without introducing the reversal of movement associated with negative stiffness as implemented by the ‘reciprocal of inertia tensor’ which implies that particles have an ‘intelligence’ not associated with real molecules.