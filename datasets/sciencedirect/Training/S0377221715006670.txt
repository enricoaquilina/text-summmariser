@&#MAIN-TITLE@&#
The fleet size and mix location-routing problem with time windows: Formulations and a heuristic algorithm

@&#HIGHLIGHTS@&#
We introduce the fleet size and mix location-routing problem with time windows (FSMLRPTW).We develop integer programming formulations for the FSMLRPTW.We present a hybrid evolutionary search algorithm for the FSMLRPTW.

@&#KEYPHRASES@&#
location-routing,heterogeneous fleet,time windows,mixed integer programming,genetic algorithm,

@&#ABSTRACT@&#
This paper introduces the fleet size and mix location-routing problem with time windows (FSMLRPTW) which extends the location-routing problem by considering a heterogeneous fleet and time windows. The main objective is to minimize the sum of vehicle fixed cost, depot cost and routing cost. We present mixed integer programming formulations, a family of valid inequalities and we develop a powerful hybrid evolutionary search algorithm (HESA) to solve the problem. The HESA successfully combines several metaheuristics and offers a number of new advanced efficient procedures tailored to handle heterogeneous fleet dimensioning and location decisions. We evaluate the strengths of the proposed formulations with respect to their ability to find optimal solutions. We also investigate the performance of the HESA. Extensive computational experiments on new benchmark instances have shown that the HESA is highly effective on the FSMLRPTW.

@&#INTRODUCTION@&#
The design of distribution networks is critical for most companies because it usually requires a major capital outlay. Two major types of decisions intervene in this process, namely determining the locations of depots, and designing vehicle routes supplying customers from these depots. In the classical Facility Location Problem (FLP) (Balinski, 1965), it is assumed that each customer is served individually through a direct shipment, which makes sense when customer demands are close to the vehicle capacity. However, there exist several situations where customer demands can be consolidated. In such contexts, the FLP and Vehicle Routing Problem (VRP) should be solved jointly. The idea of combining location and routing decisions was put forward more than fifty years ago (Von Boventer, 1961) and has given rise to a rich research known as the Location–Routing Problem (LRP) (see Albareda-Sambola, 2015; Drexl and Schneider, 2015; Laporte, 1988; Min, Jayaraman, and Srivastava, 1998; Nagy and Salhi, 2007; Prodhon and Prins, 2014, for reviews). Applications of the LRP arise in areas as diverse as food and drink distribution, parcel delivery and telecommunication network design. Many algorithms, mostly heuristics, have been developed for the LRP and its variations over the past fifty years, including some population metaheuristics (Duhamel, Lacomme, Prins, & Prodhon, 2010; Prins, Prodhon, & Wolfler Calvo, 2006b), neighborhood-based metaheuristics (Duhamel, Lacomme, & Prodhon, 2011; Prins, Prodhon, & Wolfler Calvo, 2006a), simulated annealing (Karaoglan, Altiparmak, Kara, & Dengiz, 2012) and adaptive large neighborhood search (ALNS) algorithms (Hemmelmayr, Cordeau, & Crainic, 2012).According to Hoff, Andersson, Christiansen, Hasle, and Løkketangen (2010), heterogeneous fleets are more common in real-world distribution problems than homogeneous ones. The Fleet Size and Mix VRP with Time Windows (FSMVRPTW), introduced by Liu and Shen (1999), is an LRP with a single depot, a heterogeneous fleet and time windows. Many heuristics have also been developed for the FSMVRPTW (see Irnich, Schneider, & Vigo, 2014), including a two-stage construction heuristic (Liu & Shen, 1999), a sequential construction heuristic (Dullaert, Janssens, Sörensen, & Vernimmen, 2002), a multi-start parallel regret construction heuristic (Dell’Amico, Monaci, Pagani, & Vigo, 2007), a three-phase multi-restart deterministic annealing metaheuristic (Bräysy, Dullaert, Hasle, Mester, & Gendreau, 2008), a hybrid metaheuristic combining a threshold acceptance heuristic with a guided local search (Bräysy, Porkka, Dullaert, Repoussis, & Tarantilis, 2009), an adaptive memory programming algorithm (Repoussis & Tarantilis, 2010), and a genetic algorithm using a unified component based solution framework (Vidal, Crainic, Gendreau, & Prins, 2014). This problem and a number of its variations are reviewed by Baldacci, Battarra, and Vigo (2008) and Baldacci and Mingozzi (2009).To our knowledge, a number of studies indirectly consider heterogeneous fleets in an LRP context but without taking time windows into account (Ambrosino, Sciomachen, & Scutellà, 2009; Wu, Low, & Bai, 2002). Berger, Coullard, and Daskin (2007) only consider a distance constraint. Therefore, combining heterogeneous fleets and time windows in the LRP is done here for the first time. We believe there is methodological interest in solving the Fleet Size and Mix Location-Routing Problem with Time Windows (FSMLRPTW).In the FSMLRPTW, one considers a fleet of vehicles with various capacities and vehicle-related costs, as well as a set of potential depots with opening costs and capacities, and a set of customers with known demands and time windows. The FSMLRPTW consists of opening a subset of depots, assigning customers to them and determining a set of routes for heterogeneous vehicles such that all vehicles start and end their routes at their depot, each customer is visited exactly once by a vehicle within a prespecified time window, and the load of each vehicle does not exceed its capacity. The objective is to minimize the total cost which is made up of three components: the depot operating cost, the fixed cost of the vehicles, and the total travel costs of the vehicles. It is assumed that these costs are scaled over the same time horizon.The contributions of this paper are as follows. We introduce the FSMLPRTW as a new LRP variant. We develop a hybrid evolutionary search algorithm (HESA) with the introduction of several algorithmic procedures specific to the FSMLRPTW. Namely, we introduce the location-heterogeneous adaptive large neighborhood search (L-HALNS) procedure equipped with a range of several new operators as the main Education procedure within the search. We also propose an Initialization procedure to create initial solutions, and a Partition procedure for offspring solutions. Finally, we develop a new diversification scheme through the Mutation procedure of solutions.The remainder of this paper is structured as follows. Section 2 formally defines the problem and provides integer programming formulations together with valid inequalities. Section 3 presents a detailed description of the HESA. Computational experiments are provided in Section 4, and conclusions follow in Section 5.In this section, we first define the FSMLRPTW, and then present several integer programming formulations and valid inequalities to strengthen them.The FSMLRPTW is defined on a complete directed graphG=(N,A),whereN=N0∪Ncis a set of nodes in whichN0andNcrepresent the potential depot and customer nodes, respectively, andA={(i,j):i∈N,j∈N}∖{(i,j):i∈N0,j∈N0,i≠j}is the set of arcs. Each arc(i,j)∈Ahas a nonnegative distance cij. Here, the terms distance, travel time and travel cost are used in interchangeably. Each customeri∈Nchas a positive demand qi. A storage capacity Dkand a fixed opening cost gkare associated with each potential depotk∈N0. The index set of vehicle types is denoted byH. Let Qhand fhdenote the capacity and fixed dispatch cost of a vehicle of typeh∈H. Furthermore, sicorresponds to the service time of nodei∈Nc,which must start within the time window [ai, bi]. If a vehicle arrives at customeri∈Ncbefore time ai, it waits until aito start servicing the customer.To formulate the FSMLRPTW, we define the following decision variables. Letxijhbe equal to 1 if vehicle of type h travels directly from node i to node j and to 0 otherwise. Let ykbe equal to 1 if depot k is opened and to 0 otherwise. Let zikbe equal to 1 if customer i is assigned to depot k and to 0 otherwise. Letuijhbe the total load of vehicle of type h immediately after visiting node i and traveling directly to node j. Let fijbe the total load of the vehicle while traverzing arc(i,j)∈A,which is the aggregation of theuijhvariables overH. Lettihbe the time at which a vehicle of type h starts serving at node i. Let tibe the time at which service starts at nodei∈N,which is the aggregation of thetihvariables.The integer linear programming formulation of the problem, denoted by E1, is then:(1)(E1)Minimize∑k∈N0gkyk+∑h∈H∑k∈N0∑i∈Ncfhxkih+∑h∈H∑(i,j)∈Acijxijhsubject to(2)∑h∈H∑j∈Nxijh=1i∈Nc(3)∑h∈H∑j∈Nxjih=∑h∈H∑j∈Nxijhi∈N(4)∑h∈H∑j∈Nujih−∑h∈H∑j∈Nuijh=qii∈Nc(5)uijh≤Qhxijhi∈N0,j∈N,i≠j,h∈H(6)∑h∈H∑j∈Ncukjh=∑j∈Nczjkqjk∈N0(7)∑h∈H∑j∈Ncujkh=0k∈N0(8)uijh≤(Qh−qi)xijhi∈Nc,j∈N,h∈H(9)uijh≥qjxijhi∈N,j∈Nc,h∈H(10)∑i∈Ncqizik≤Dkykk∈N0(11)∑k∈N0zik=1i∈Nc(12)xijh+∑q∈H,q≠h∑l∈N,j≠lxjlq≤1i∈N,j∈Nc,i≠j,h∈H(13)∑h∈Hxikh≤zikk∈N0,i∈Nc(14)∑h∈Hxkih≤zikk∈N0,i∈Nc(15)∑h∈Hxijh+zik+∑m∈N0,m≠kzjm≤2k∈N0,(i,j)∈Nc,i≠j(16)tih−tjh+si+cij≤M(1−xijh)i∈N,j∈Nc,i≠j,h∈H(17)ai≤tih≤bii∈N,h∈H(18)xijh∈{0,1}(i,j)∈N,h∈H(19)zik∈{0,1}k∈N0,i∈Nc(20)yk∈{0,1}k∈N0(21)uijh≥0(i,j)∈N,h∈H(22)tih≥0i∈Nc,h∈H.The objective function (1) minimizes the total cost including depot fixed cost, vehicle fixed cost and variable travel cost. Constraints (2) and (3) are degree constraints; in particular constraint (2) guarantees that each customer must be visited exactly once, and constraint (3) ensures that entering and leaving arcs to each node are equal. Constraint (4) implies that the demand of each customer is satisfied. Constraint (5) means that the total load on any arc cannot exceed the capacity of the vehicle traverzing it. Constraint (6) ensures that the total load of each depot is equal to the total demand of customers assigned to it. Note that constraint (6) strengthens the formulation, yet are not necessary. Constraint (7) states that the load on a vehicle returning to each depot must be equal to zero. Constraints (8) and (9) are bounding constraints for load variables. Constraint (10) guarantees that total demand supplied by a depot cannot exceed its capacity. Constraints (11) and (12) ensure that each customer is assigned to only one depot and to only one vehicle type, respectively. Constraints (13)–(15) forbid illegal routes, i.e., routes that do not start and end at the same depot. Constraints (16) and (17), where M is a large number, enforce the time window restrictions. Constraints (18)–(22) define the domains of the decision variables.The validity of constraints (13)–(15) was proven by Karaoglan, Altiparmak, Kara, and Dengiz (2011). They prevent illegal routes starting at one depot and ending at another, the prevents the creation of infeasible routesP=(vk1,v1,v2,…,vs−1,vs,vl2)with s customers (k,l∈N0,k≠l). Constraint (13) implies thatzv1,k1=1. Sincexv1,v2=1andzv1,k1=1,constraint (15) ensures thatzv2,k1=1andzv2,k2cannot be equal to one.Formulation E1 shown by (1)–(22) is valid for the FSMLRPTW. Other valid formulations can be derived from E1. Before defining these formulations, we provide several variations of E1 by aggregating some of the variables or disaggregating some of the constraints. The reason is to either reduce the size of the formulation through aggregation of variables or to tighten the linear relaxation bound by disaggregating some of the constraints. First, fijwhich is the aggregation of theuijhvariables, is obtained as follows:(23)∑j∈Nfji−∑j∈Nfij=qii∈Nc(24)fij≤∑h∈HQhxijhi∈N0,j∈N,i≠j(25)∑j∈Ncfkj=∑j∈Nczjkqjk∈N0(26)∑j∈Ncfjk=0k∈N0(27)fij≤∑h∈H(Qh−qi)xijhi∈Nc,j∈N(28)fij≥qj∑h∈Hxijhi∈N,j∈Nc.Let (f, x) be a solution satisfying constraints (23)–(28) and let (u, x) be a solution satisfying constraints (2) and (4)–(9), where f, u and x are the respective vectors for variables fij,uijhandxijh. Then, for each feasible (u, x), there exists a feasible (f, x) and vice versa. Due to (2), there exists anh*∈Hfor whichxijh*=1and due to (8), there exists auijh*≥0,implyingxijh=uijh=0for all otherh∈H∖{h*}. Using these arguments, we have linked fijto the original variables in the following way:(29)fij=∑h∈Huijhi,j∈N.We can now derive constraints (23)–(28) from (4)–(9) by using definition (29). Constraints (23)–(28) are satisfied, since they are the same as (4)–(9), respectively.Second, the aggregation of thetihvariable is(30)ti−tj+si+cij≤M(1−∑h∈Hxijh)i∈N,j∈Nc,i≠j(31)ai≤ti≤bii∈N.Constraints (30)–(31) and (16)–(17) are equivalent. Due to (16) there existsh*∈Hfor whichxijh*=1,i.e.,xijh=0for all h ≠ h*,h∈H. An equivalent definition is(32)tj=∑h∈Htjhj∈N.We can now derive constraints (30)–(31) from (16)–(17) by using definition (32). Constraints (30)–(31) are satisfied, since they are the same as (16)–(17), respectively.Third, the disaggregation of the balance constraint (3) is(33)∑j∈Nxjih=∑j∈Nxijhh∈H,i∈N.Constraint (33) is equivalent to constraints (3) and (12). Given that i, j, k are on the same route, assumeh1,h2∈H,xijh1=1andxjkh2=1,which is valid for (3). But constraint (12) along with (3) only allows the use of the same vehicle on a route, i.e,xijh1=1andxjkh1=1. We can now derive constraint (33) from (3). Using (33) also makes (12) redundant. Constraint (33) ensures thatxijh1=1andxjkh1=1without using (12). Constraint (33) is satisfied, since they are the same as (3), respectively.We now define the following four variations of E1 as follows:(1)Formulation E2 minimizes (1), subject to (2), (3), (23)–(28) and (10)–(22).Formulation E3 minimizes (1), subject to (2)–(5) and (7)–(22).Formulation E4 minimizes (1), subject to (2)–(3), (23)–(28), (10)–(15), (30)–(31) and (18)–(22).Formulation E5 minimizes (1), subject to constraints (2), (33), (23)–(28), (10), (11), (13)–(15), (30)–(31) and (18)–(22).We make use of four polynomial size valid inequalities. These were used by several authors for variants of LRPs. The first inequalities are special case of classical subtour elimination constraints for the Traveling Salesman Problem (Dantzig, Fulkerson, & Johnson, 1954) for two nodes as follows:(34)xijh+xjih≤1i,j∈Nc,h∈H.Constraint (34) breaks subtours involving two customers only. The second valid inequality, which was used by Labbé, Rodríguez-Martin, and Salazar-González (2004) for plant-cycle location problem is as follows:(35)zik≤yki∈Nc,k∈N0.Constraint (35) imposes that customer i cannot be assigned to depot k if the latter is not open. We now adapt the next valid inequality described by Achuthan, Caccetta, and Hill (2003) for the FSMLRPTW as follows:(36)∑h∈H∑k∈N0∑i∈Ncxkih≥rα(Nc).Constraint (36) provides a lower bound on the number of routes originating from depots whererα(Nc)=⌈∑i∈Ncqi/maxh∈HQh⌉and ⌈•⌉ is the smallest integer larger than •. The fourth and final valid inequality is(37)∑k∈N0yk≥ymin.Constraint (37) bounds the number of opened depots from below, where yminis taken as the minimum number of k opened depots satisfying∑k∈N0Dk≥∑i∈Ncqiafter the depots have been sorted in non-decreasing order of their capacity.This section describes the proposed hybrid evolutionary search algorithm, called HESA, that has been developed to solve the FSMLRPTW. This algorithm builds on several powerful evolutionary based metaheuristic algorithms (see Koç, Bektaş, Jabali, & Laporte, 2014; 2015; Vidal et al., 2014). In this paper, we additionally introduce the location-heterogeneous adaptive large neighborhood search (L-HALNS) procedure which is used as a main Education component in the HESA. Furthermore, we develop an Initialization to create initial solutions and a Partition procedure to split offspring solutions into routes. Finally, we propose a new Mutation procedure to diversify the solutions.The general structure of the HESA is sketched in Algorithm 1. The initial population is generated by using the Initialization procedure (line 1). Two parents are selected (line 3) through a binary tournament process, where a crossover operation creates a new offspring C (line 4), which then undergoes the Partition procedure (line 5). The Education procedure uses the L-HALNS operators to educate offspring C and inserts it back into the population (line 6). The probabilities associated with the L-HALNS operators used in the Education procedure are updated by an Adaptive Weight Adjustment Procedure (AWAP) (line 7). The Intensification procedure which is based on the L-HALNS is run on elite solutions (line 8). As new offsprings are added, the population size nawhich is limited bynp+no,changes over the iterations. The constant npdenotes the size of the population initialized at the beginning of the algorithm and the constant nois the maximum allowable number of offspring that can be inserted into the population. If the population size nareachesnp+noat any iteration, then a survivor selection mechanism is applied (line 9). The Mutation procedure is applied to a randomly selected individual from the population with probability pm(line 10). When the number ϖ of iterations without improvement in the incumbent solution is reached, the HESA terminates (line 11). For further implementation details on the ALNS based education, parent selection, crossover, AWAP, intensification and survivor selection sections the reader is referred to Koç, Bektaş, Jabali, and Laporte (2015).In what follows, we detail the algorithmic features specifically designed for the FSMLRPTW. Section 3.1 presents the Initialization procedure of the population. The Partition procedure is described in Section 3.2. Section 3.3 presents the offspring Education procedure. Finally, the Mutation procedure is desribed in Section 3.4.We use a three-phase Initialization procedure to generate an initial population. The first and second phases generate the initial solution while the third phase creates other solutions. In the first phase, customers are assigned to the depots. Initially, the closest depot according to its distance is calculated for each customer, and the customers are listed in non-increasing order of distance. Each customer is then assigned to its closest depot starting from the top of the list, without violating the depot capacities. These steps are applied repeatedly to the residual customers who could not be assigned to their closest depots due to depot capacity constraints. In this case they are assigned to their closest feasible depot. In the second phase, routes are constructed for each depot by applying the Clarke and Wright (1964) algorithm and by selecting the largest vehicle type for each route. In the third phase, new individuals are created by applying the L-HALNS operators to the initial solution until the initial population size reaches np. A removal operator is randomly selected from a list of diversification based removal operators and a greedy insertion with a noise function operator is used as an insertion operator (see Section 3.3). Both of these operators are used in order to diversify the initial population. The number of nodes removed is randomly chosen from the initialization interval[bli,bui]in the destroy phase. The interval is defined by a lower and an upper bound calculated as a percentage of the total number of nodes in a given instance.We introduce a Partition procedure to be used in the L-HALNS (see Section 3.3). The objective of this procedure is to split the solution into routes after the parent selection and the crossover phases during the algorithm. Before applying this procedure, each solution is represented as a permutation of customers and can therefore be viewed as a list Lrto be used for removals. This procedure includes two phases. In the first phase, all customers of the newly generated solution are put into Lr. In the second phase, we use an intensification-based insertion operator (greedy insertion operator) to insert the customers of Lrto their best possible position. The Partition procedure yields a feasible solution for the FSMLRPTW which is inserted into the population.At every iteration, the Education procedure is applied to the newly generated offspring to improve its quality. The ALNS used as a way of educating the solutions, as in Koç et al. (2015), is basically an improvement heuristic. It consists of two procedures: removal, followed by insertion. In the removal procedure, n′ nodes are iteratively removed by the intensification based removal operators and placed in the removal list Lr, where n′ is in the interval[ble,bue]for the destroy operators. In the insertion procedure, the nodes of Lrare iteratively inserted into a least-cost position in the incomplete solution.Here, we introduce the Location-HALNS (L-HALNS) which integrates fleet sizing and the location decisions within the removal and insertion operators. This procedure differs from the Heterogeneous ALNS (HALNS) developed by Koç et al. (2014) to educate the solutions in the context of a heterogeneous fleet because the latter did not account for the location decisions. When a node is removed, we check whether the resulting route can be served by a smaller vehicle, and we also check whether the related depot has any customer already assigned to it. We then update the solution accordingly. If inserting a node requires additional vehicle capacity or requires opening a new depot, we then consider the option of using larger vehicles or the option of opening the least cost depot not yet open. More formally, for each nodei∈N0∖Lr,let fhbe the vehicle fixed cost and let gkbe the depot cost associated with this node. Let Δ(i) be the distance saving obtained as a result of using a removal operator on node i. Letgrk*be the depot fixed cost and letfrh*be the vehicle fixed cost after the removal of node i, i.e.,grk*is modified only if node i is the only node of depot k andfrh*is modified only if the route containing node i can be served by a smaller vehicle when removing node i. The savings in depot fixed cost and vehicle fixed cost can be expressed asgk−grk*andfh−frh*,respectively. Thus, for each removal operator, the total savings resulting from removing nodei∈N0∖Lr,denoted RC(i), is calculated as follows:(38)RC(i)=Δ(i)+(gk−grk*)+(fh−frh*).In the destroyed solution, the insertion cost of node j ∈ Lrafter node i is defined as Ω(i, j) on a given nodei∈N0∖Lr. Letgak*be the depot fixed cost and letfah*be the vehicle fixed cost after the insertion of node i, i.e.,grk*is modified only if node i requires to open a new depot, orfrh*is modified only if the route containing node i necessitates the use of a larger capacity vehicle after inserting node i. The cost differences in depot fixed cost and vehicle fixed cost can be expressed asgrk*−gkandfah*−fh,respectively. Thus, the total insertion cost of nodei∈N0∖Lris IC(i), for each insertion operator is(39)IC(i)=Ω(i,j)+(grk*−gk)+(fah*−fh).Fig. 1 provides an example of the removal and insertion phases of the L-HALNS procedure.The first and second diversification based removal operators were applied by Hemmelmayr et al. (2012), and the third one was used by Ropke and Pisinger (2006a). We introduce the fourth one as a new operator specific to the FSMLRPTW.1.Depot closing removal (DR): this operator randomly selects an open depot and closes it. The operator removes all customers of this depot. The DR operator also randomly selects a closed depot and opens it.Depot opening removal (DOR): the DOR operator randomly opens a closed depot. The n′ customers removed from the solution are those which are closest to this depot according to travel cost.Random removal (RR): This operator randomly selects n′ customers and puts them into the removal list.Depot distance removal (DDR): the DSR operator is based on the DR operator but differs from it by the criterion employed to open a closed depot. To open a depot, this operator selects a closest depot with respect to a removed one.We now present the eight intensification based removal operators used in our algorithm. The first seven were used in several papers (Demir, Bektaş, & Laporte, 2012; Koç et al., 2015; Ropke & Pisinger, 2006a; 2006b), whereas the last one is new.1.Neighborhood removal (NR): The general idea behind the NR operator is to remove n′ customers from routes that are extreme with respect to the average distance of a route.Worst distance removal (WDR): The WDR operator iteratively removes n′ high cost customers, where the cost is based on the distance.Worst time removal (WTR): This operator is a variant of the WDR operator. For each node, costs are calculated, depending on the deviation between the arrival time and the beginning of the time window. The WTR operator iteratively removes n′ customer from the solution which has the largest deviation.Shaw removal (SR): The SR operator aims to remove a set of n′ similar customers. The similarity between two customers is based on distance, time, proximity and demands.Proximity-based removal (PBR): This operator is a special case of SR which is solely based on distance.Time-based removal (TBR): The TBR operator is another variant of SR. The selection criterion of a set of customers is solely based on time.Demand based-removal (DBR): The DBR operator is yet another variant of SR which is solely based on demand.Depot closing removal (DCR): The aim of the DCR operator is to calculate the utilization efficiency of each depot Φ(k) (k∈N0) and remove from solution the one with the least Φ(k) value. Φ(k) is expressed as the ratio of the total demand of depot k over the capacity of depot k:(40)Φ(k)=∑i∈NcqizikDk.Two insertion operators (Demir et al., 2012; Koç et al., 2015; Ropke & Pisinger, 2006a; 2006b) are used in the repair phase of the Education procedure.1.Greedy insertion operator (GIO): This operator finds the best possible insertion position for all nodes in Lrwhile the cost calculation is based on distance. The insertion process is iteratively applied to all nodes in Lr.Greedy insertion with noise function operator (GINFO): The GINFO operator is a variant of the GIO operator that extends it by allowing a degree of freedom in selecting the best possible insertion position for a node.We introduce a Mutation procedure to increase the population diversity over the iterations (e.g., Nagata, Bräysy, & Dullaert, 2010). This procedure is applied with probability pm. An individual C different from the elite individuals is randomly selected. A randomly selected diversification based removal operator and the GINFO operator are then used in order to diversify the selected individual C. These two operators are applied to change the positions of a specific number of nodes, which are chosen from the interval[blm,bum]of removable nodes.In this section, we present the results of computational experiments performed in order to assess the performance of the formulations and the HESA. All experiments were conducted on a server with one gigabyte RAM and Intel Xeon 2.6 Giga Hertz processor. We used CPLEX 12.5 with its default settings as the optimizer to solve the integer programming formulations. The HESA was implemented in C++.Section 4.1 describes the benchmark instances and the experimental settings. The aim of the computational experiments is threefold: (i) to analyze the effect of the metaheuristic components (Section 4.2), (ii) to evaluate the formulation in terms of solving the FSMLRPTW to optimality on small-size instances (Section 4.3), and (iii) to compare and test the integer programming formulation which is integrated with valid inequalities and the HESA on small-medium-and large-size instances (Section 4.4).Benchmark data sets for the FSMLRPTW were generated by considering the data set described by Liu and Shen (1999) for the Fleet Size and Mix VRP with Time Windows (FSMVRPTW) and derived from the classical Solomon (1987) VRP with Time Windows instances with 100 nodes. These sets include 56 instances, split into a random data set R, a clustered data set C and a semi-clustered data set RC. The sets R1, C1 and RC1 have a short scheduling horizon and small vehicle capacities, in contrast to the sets R2, C2 and RC2 which have a longer scheduling horizon and larger vehicle capacities. Liu and Shen (1999) also introduced three cost structures, namely A, B and C, and several vehicle types with different capacities and fixed vehicle costs for each of the 56 instances. In our data sets, we have used the cost structure A and generated small-size (10-15-20-25-30-customer) as well as medium and large-size (50-75-100-customer) instances. We have selected the first customers of each data sets to generate the instances, i.e., the first 10 customers, 15 customers, and so on, of each Liu and Shen instance.We followed a procedure similar to that used for the LRP benchmark instances (see Albareda-Sambola, Díaz, & Fernández, 2005; Barreto, 2004; Karaoglan et al., 2012; Prodhon, 2006) to generate our depot characteristics. To this end, new depots features were added to each instance of Liu and Shen, as shown in Appendix A.1. The depot characteristics were generated using discrete uniform distributions. The depot coordinates are in the range [0, 100]2. For the sets C1, C2, R1, R2, RC1 and RC2, the depot costs are in the range [38000, 50000], [90000, 120000], [17000, 25000], [85000, 100000], [17000, 26000] and [85000, 100000], respectively. The intervals for depot capacities for each data set and for small-, medium- and large-size instances are given in Table 1. However, these data ensure the opening of at least two depots for each instance. In the original Solomon instances there is only one depot; we have used this depot’s time windows for other depots as well, i.e., in each data set, time windows are same for all depots.Evolutionary algorithms use a set of correlated parameters. All algorithmic parametric values were set as in Koç et al. (2015), where an extensive meta-calibration procedure was used to generate effective parameter values for the FSMVRPTW. These authors initially used the parameters suggested by Vidal et al. (2014) for the genetic algorithm, and by Demir et al. (2012) for the ALNS. The authors then conducted several experiments to further fine tune the parameters on randomly selected instances.This section compares four versions of the HESA, the details of which can be found in Table 2. We present four sets of experiments on randomly selected 100-customer instances; C101, C203, R101, R211, RC105 and RC207.Table 3presents the best results of ten runs for each of four versions. The columns display the instance type, the total cost, percentage deterioration in solution quality (Dev) of the three versions with respect to the HESA, and the computation time in seconds (Time). The row named Avg shows the average results. These results clearly indicate the benefit of including the Education, Intensification and Mutation procedures within the HESA. The HESA is consistently superior to all other versions on all instances. Version (1) performs worse than all other three versions. The superiority of version (3) over version (2) confirms the usefulness of the Intensification procedure in the algorithm. The computation times for all versions are of similar magnitude.The formulations E1, E2, E3, E4 and E5 are examined in terms of their ability to solve the FSMLRPTW to optimality on small-size (20-, 25-, and 30-customer) instances. To analyze the computational results, we used the following performance measures: the deviation (Dev) and computation time in seconds (Time) averaged over all instances for each instance set (over a total of 840 experiments), and the number of optimal solutions (#Op) obtained within one hour of computation time. Dev is the percentage deviation between the Upper Bound (UB) and the best-known Lower Bound (LB), i.e., 100 (UB−LB)/ UB. The upper bound is the optimal or best known solution obtained by solving the formulations.Table 4 presents comparative average results over the five formulations. The first column displays the instance sets, and the following two columns show the number of customers|Nc|and the number of depots|N0|,respectively. The overall results of E1 are better than those of E3, thus we infer that constraint (6) strengthens formulation E1. The results shown in Table 4 indicate that formulation E4 performs better than the other models in terms of reaching optimal solutions within one hour of computation time. These results imply that instead of constraints (4)–(9), using constraints (23)–(28) which include the aggregated variables fij, and instead of constraints (16)–(17) using constraints (30)–(31), which include the aggregated variables fij, yields better formulations for the FSMLRPTW. Formulation E4 yields 27 optimal solutions out of 56 instances for the 20-customer instances, 13 out of 56 instances for 25-customer instances, and nine out of 56 instances for 30-customer instances within the given time limit of one hour. In terms of computation time, E4 provides on average lower computation time than the other formulations.We now investigate the effect of the valid inequalities on formulation E4. To this end, we have conducted experiments on instances of the same size and we have used the same performance measures as shown in Table 4. We used four variations of E4 denoted as V1, V2, V3 and V4. Variation V1 is formulation E4 with valid inequalitie (34), V2 is formulation E4 with valid inequalities (34) and (35), V3 is formulation E4 with valid inequalities (34)–(36), and V4 is formulation E4 with valid inequalities (34)–(37). Table 5summarizes the average results of the effect of the valid inequalities on formulation E4. These results show that V4, which includes all valid inequalities, performs better than all other variations in terms of reaching optimal solutions within one hour of computation time. For the 20-, 25-, and 30-customer instances, the solution times are 2286.76, 2854.18 and 3134.89 seconds for E4, but these times are 2156.48, 2848.92, 3066.20 seconds for V4. Our results indicate that V4 yields same number of optimal solutions as E4, but within smaller computation times.We now present a comparative analysis of the results of the HESA and of the formulation E4 integrated with valid inequalities, denoted byE4v. Each instance was solved once with the HESA, and once withE4v. ForE4v,a common time limit of three hours was imposed on the solution time for all instances. For the HESA, ten separate runs are performed for each instance, the best one of which is reported.Tables 6and 7summarize the average results of the HESA compared withE4v. For detailed results, the reader is referred to Appendix A. In Tables 6 and 7, the first column displays the LP relaxation value ofE4v,obtained by relaxing the integrality constraint (18) on theXijhvariables only. Such a partial LP relaxation provides better quality lower bounds compared to a full relaxation where the integer restrictions (18)–(20) on all binary variables are relaxed, and in comparable solution times. The remaining columns show the total time of all 10 runs of the HESA (Total time (s.)), the time of the best solution (Time (s.)), the percent deviation values of the total cost (DevTC) and of the vehicle cost (DevVC) found byE4vwith respect to the HESA. In the Time column, “*” denotes that the instance was not solved to optimality within three hours.Table 6 shows that the HESA finds almost the same solutions as those ofE4vbut in a substantially smaller amount of time on the small-size FSMLPRTW instances. The average time required byE4vto solve 10-, 15-, 20-, 25- and 30-customer instances to optimality are 26.26, 3234.61, 6012.79, 8056.69 and 9359.53 seconds, respectively. For the HESA, the respective statistics are 3.18, 3.95, 6.58, 8.93 and 13.05 seconds.As can be observed from Table 7, the results clearly indicate that the HESA runs quickly, also for medium and large-size instances. In particular, the algorithm requires 90.08, 167.82 and 299.98 seconds of average computation time to solve 50-, 75- and 100-customer instances, respectively. The HESA is able to produce considerably better results thanE4vdoes in three hours. The improvements in solution values can be as high as 6.42 percent, with an average of 1.41 percent for the 50-customer instances. Similarly, the average improvement is 5.11 percent for the 75-customer instances, the highest value sitting at 23.09 percent. The results are even more striking for the 100-customer instances where the average total cost reduction obtained was 19.93 percent compared toE4v. In case of 50-, 75- and 100-customer instancesE4vwas not able to find optimal solutions for 166 instances out of 168 within three hours.We now investigate the effect of the fleet mix composition on the FSMLRPTW instances using the vehicle costs and DevVCvalues in Table 7. The results show that when optimality is guaranteed byE4v,the HESA is able to find the optimal fleet mix composition. For the 50- and 75-customer instances, the HESA decreased the vehicle costs by 8.08 percent and 32.10 percent on average compared toE4v. This decrease ranges from 0.00 to 18.68 percent and from 4.20 percent to 60.60 percent for the 50- and 75-customer instances, respectively. As for the total costs, the results are even more striking for the 100-customer instances where the average vehicle costs reduction obtained was 53.82 percent compared toE4v. These results imply that for medium- and large-size instances, the HESA is able to produce substantially lower vehicle costs thanE4v.

@&#CONCLUSIONS@&#
This paper has introduced the FSMLRPTW, a complex integrated logistics problem which, to our knowledge, was studied here for the first time, and has described a hybrid evolutionary search algorithm tailored to the problem. We have introduced several algorithmic procedures specific to the FSMLRPTW, namely, the location-heterogeneous adaptive large neighborhood search procedure equipped with a range of new operators as the main Education procedure within the search. We have also developed an Initialization procedure to create initial solutions, a Partition procedure for offspring solutions, and a new diversification scheme through the Mutation procedure of solutions. Computational results on a new set of benchmark instances of up to 100 nodes and 10 potential depots were presented, which indicate that the proposed algorithm is able to identify solutions within 0.05 percent of optimality for small size instances and yields better solutions for larger instances as compared to an off-the-shelf solver. The running times of the algorithm are so that it can be used in practical applications.