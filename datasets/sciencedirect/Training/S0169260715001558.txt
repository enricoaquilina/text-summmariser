@&#MAIN-TITLE@&#
Implementation of a two-group likelihood time-to-event continual reassessment method using SAS

@&#HIGHLIGHTS@&#
We present a program which accommodates patient heterogeneity in dose finding.The program is applicable to designing and implementing a trial.Examples using the program are given; sample size consideration and implementation.Valuable tool for statisticians wanting to address patient heterogeneity.

@&#KEYPHRASES@&#
Adaptive designs,Phase I trial,Dose finding,Continual reassessment method,Maximum likelihood,Sample size,

@&#ABSTRACT@&#
Background and objectivesDose finding trials using model-based methods have the ability to handle the increasingly complex landscape being seen in clinical trials. Issues such as patient heterogeneity in trial populations are important to address in the designing of a trial in addition to the inclusion/exclusion criteria. Designs accommodating patient heterogeneity have been described using the continual reassessment method (CRM) and time-to-event CRM (TITE-CRM), yet, the implementation of these trials in practice have been limited. These methods and other model-based methods generally need statisticians to help design and conduct these trials. However, the statistical programs which facilitate the use of these methods, currently available focus on estimation in the one-sample case.MethodsA SAS program to accommodate two groups using the TITE-CRM and likelihood estimation has been developed. The program consists of macros that assist with the planning and implementation of a trial accounting for patient heterogeneity.ResultsDescription of the program is given as well as examples using the programs. For planning purposes, an example will be provided showing how the program can be used to guide sample size estimates for the trial.ConclusionsThis program provides researchers with a valuable tool for designing dose-finding studies to account for the presence of patient heterogeneity and conduct a trial using a hypothetical example.

@&#INTRODUCTION@&#
Dose finding trials play a necessary role in the drug development process. These early phase trials recommend a dose to be used in subsequent phase trials. Dose finding trials are small, outcome adaptive trials where subject recruitment is sequential. The dose for a subject is determined by information from the prior subjects enrolled in the trial and the outcome is a defined response, often a toxicity. At the end of the trial, the dose closest to the pre-defined level of toxicity considered acceptable for the trial (the target rate of toxicity, TRT) is considered the maximum tolerated dose (MTD).The continual reassessment method (CRM) [1] is a model-based method which uses a parametric model to describe the relationship between doses and the probability of toxicity with the assumption that the relationship is strictly increasing. Since the introduction of CRM, modifications and extensions have been described such as cohort recruitment, partial ordering, using a weight to incorporate partial estimation of subjects and incorporating patient heterogeneity [2–5]. In particular, accounting for patient heterogeneity is necessary when the relationship between dose and the probability of toxicity is assumed to be different for some defined groups. It arises in trials where for instance, there are subjects who are naive versus non-naive to treatment. In these cases, ignoring patient heterogeneity produces an averaging effect for the trial and exposes subjects to either overly toxic or suboptimal dose levels [5].Designs that accommodate patient heterogeneity in the context of a single trial are the two-sample CRM described by O’Quigley [5], two-group CRM shift model [6] and our two-group time-to-event CRM (TITE-CRM) design [7] along with designs which deal with the idea of bridging [8,9]. While these designs have been described previously, their use has been limited and conducting separate trials prevails [10]. Their use may be limited as a result of needing a statistician to employ these designs [11]. Another barrier to using these designs is the software needed to design and implement a trial. These programs are valuable tools to statisticians in planning a trial by exploring scenarios using simulation. The simulations allow for the operating characteristics of a design to be investigated across a number of simulated trials. There are programs available to execute the one-sample CRM and extensions in R, SAS and other, stand-alone programs (see Table 1for examples) [12–23], however, none of these programs address patient heterogeneity.This paper introduces a program to design and conduct a trial that accommodates patient heterogeneity for two groups. The programs can be obtained by contacting the corresponding author. The program is capable of executing two main functions: (1) perform simulations to guide the trial design and to investigate different sample sizes and (2) conduct a trial using the two-group TITE-CRM. Section 2 reviews the method. Sections 3 and 4 details the simulation and trial implementation program, with illustration. Lastly, Section 5 provides some discussion.Using the notation from Salter [7], we review the two-group two-parameter TITE-CRM method in this section. The method needs at least one toxic outcome and one non-toxic outcome in each group to begin estimation and obtain the maximum likelihood estimators (MLE). Define the initial dose escalation (IDE) stage as the first stage employed until both outcomes (toxicity and no toxicity) have been observed in each group. The second stage begins once both outcomes have been observed in both groups. At that time, the full two-group likelihood TITE-CRM can begin.Group membership is denoted using superscripts while subscripts are used to index the subjects. We consider the case where the two groups have the same parametric form of the dose-toxicity function but different parameters denoted by f(x, β(i)), i=0, 1 and the same TRT, θ. We assume the groups share some information defined by two parameters, β and τ, where β(0)=β and β(1)=β+τ where the range of β and τ depend on the choice of f(x, β).At a given time point, a subject in the study has data of the form(y(i),x(i),w(i))where y(i) denotes the binary outcome (1=toxicity, 0=non-toxicity), x(i) is the dose given andw(i)is the weight. In the likelihood, the dose-toxicity function is adjusted by the weight,w(0≤w≤1), and is denoted byG(x(i),w(i),β(i))≡w(i)f(x(i),β(i)). Thus, at the enrollment of the (k+1)th subject, the available data are:[(yj(0),xj(0),wj(0)),j=1,…,k(0)]and[(yl(1),xl(1),wl(1)),l=1,…,k(1)]where k(i), i=0, 1 denotes the number of subjects from the ith group and k=k(0)+k(1). For ease of notation in the estimating equations, we drop the superscript indicating group in y, x andw, i.e.yj≡yj(0),yl≡yl(1),xj≡xj(0),xl≡xl(1),wj≡wj(0),andwl≡wl(1).The MLEs for β and τ based on k observations are solutions to the following equations:(1)∂ℓk∂β=∑j=1k(0)yj∂∂βf(xj,β)f(xj,β)+∑j=1k(0)(1−yj)−wj∂∂βf(xj,β)1−wjf(xj,β)+∑l=1k(1)yl∂∂βf(xl,β+τ)f(xl,β+τ)+∑l=1k(1)(1−yl)−wl∂∂βf(xl,β+τ)1−wlf(xl,β+τ)=0(2)∂ℓk∂τ=∑l=1k(1)yl∂∂τf(xl,β+τ)f(xl,β+τ)+∑l=1k(1)(1−yl)−wl∂∂τf(xl,β+τ)1−wlf(xl,β+τ)=0where∂f∂βand∂f∂τare the partial derivatives of f(·, ·) with respect to β and τ, respectively. The MLEs at this stage are denoted asβˆkandτˆksince the estimation was based on the first k subjects. Solutions to these equations typically have no closed analytical form and therefore need numerical approximation methods to obtainβˆkandτˆkfor k subjects.A revised dose-toxicity function is obtained usingβˆkandτˆkwith the same TRT, θ. The next dose for the (k+1)th subject is determined byxk+1(0)=argminx|f(x,βˆk)−θ|(doseforGroup0)orxk+1(1)=argminx|f(x,βˆk+τˆk)−θ|(doseforGroup1)whereargminxis the argument of the minimum corresponding to the dose level for which|f(x,βˆk)−θ|or|f(x,βˆk+τˆk)−θ|attain their respective minima. Thus, the next dose depends on the group membership of the k+1 subject. This procedure continues in this manner to obtain (βˆk+1,τˆk+1,xk+2(0),xk+2(1)), (βˆk+2,τˆk+2,xk+3(0),xk+3(1)), …, (βˆN,τˆN,xN+1(0),xN+1(1)), whereβˆNandτˆNare the MLEs of β and τ using data from all subjects. The MTD for the trial is the recommended dose for each group, (xN+1(0),xN+1(1)), after the last subject has completed the trial.The simulation program uses SAS macros to simulate trials using the two-group TITE-CRM. To begin, the program needs the user to define the necessary design parameters using macro variables and a dataset. Once input, the datasets storing the subject data to be used by the program are created (outcome macro). After some additional design information is gathered, the trial is initiated (test macro). The test macro executes the trial sequentially by subject and evaluates the accumulated data to call the appropriate macro to find the recommended dose for the new subject. For this reason, the test macro is broken into three cases: (1) for the first subject, (2) for subjects 2 to N, and (3) for the “N+1″ subject. The first subject needs an initial starting dose to be defined as an input parameter since neither the IDE or estimation has begun. The recommended doses for subjects 2 to N are either based on the IDE or estimation stage. Upon completion of the last subject, a final estimation of all trial data needs to be conducted in order to determine the trial MTD, the hypothetical dose for the “N+1″ subject.Each recommended dose is found in one of three ways: the IDE, IDE and one-sample (likelihood) TITE-CRM or two-group (likelihood) TITE-CRM. These macros are run prior to the test macro so they are stored and available when called in the test macro. The IDE (doseesc_tite) is employed until at least one toxic and non-toxic event is observed in one group. At that time, that group uses the one-sample TITE-CRM to recommend a dose (opt1G0_tite and opt1G1_tite depending on the group); the other group which has not observed both events continues with the IDE. When both groups have at least one toxic and one non-toxic event, then the full two-group TITE-CRM is used (opt_tite). After the final estimation, data from that trial is stored and the program starts a new trial. The test macro continues until the last simulated trial is reached and then compiles all of the simulated trial datasets into one dataset. This final step ends the macro. The general flow of the simulations is depicted in Fig. 1. The following section describes the necessary user-defined inputs to perform the simulation, the IDE and estimation stage and program outputs. Section 3.2 provides one example of how the program can be used.There are multiple design specifications which need to be defined prior to running the simulations. The user-defined macro variables and data needed fall into two main categories: (1) trial design parameters and (2) dose determination. The output data from the simulations is also discussed. Further documentation of variables can be found in the program documentation.The design of a trial needs clinical input. Factors such as the number of doses, the probability of toxicity associated with those doses, target level of toxicity (trt), prevalence of each group in the population and realistic expectations for the number of subjects (N) should be discussed when planning a trial and in turn defined by the user in the program. In the dose dataset, the user needs to input the number of doses and their associated probability of toxicity. The x values, or standardized dose units for the dose-toxicity function are calculated by the program.Each dose level has an associated working model (WMP0 and WMP1) and true (TP0 and TP1) probability of toxicity for each dose in each group. Currently, the working model function in the program is set as the empiric function, however this default may be changed by the user. Instructions on how to do this are in the program documentation. The parameters used in the dose-toxicity function are defined by macro variables (wm_beta, true_beta, wm_tau, true_tau) for the β and τ in the true and working models. The relationship between the groups is assumed to be additive in the program as described in Section 2.Since we are using the TITE-CRM, the observation window or the length of time the subject will be observed (obs_win) needs to be specified as well as the number of subjects that will arrive in that window (rate). The program calculates the inter-arrival time of the subjects as uniform and fixed over the observation window. The weight used in this program is the uniform weight which is the proportion of time a subject has been followed without experiencing a toxicity over the observation window. Although other weight functions have been used in the TITE-CRM [4,24], the program does not accommodate other weight functions at this time. In order to randomly allocate simulated subjects to a group, a Bernoulli random variable with probability, p_group (0<p_group<1), of being assigned to the second group was used. Consequently, the number of subjects in each group will vary by trial. The time to toxicity, (u), is drawn from a Uniform random variable on the interval (0, observation window). The seeds for the random number generators (seed1 and seed2) are defined as macro variables in the program. The number of simulations to be conducted should also be defined (nsim).As previously mentioned, the IDE stage is needed in order to use the likelihood function to obtain MLEs. For this program, the IDE macro (doseesc_tite) uses an algorithm or set of rules to escalate the dose until both a toxic and a non-toxic outcome are observed. A cohort of the user-defined size (escby) starts on the specified starting dose level based on group membership (xstartG0 and xstartG1). Note that the size of the cohort is the same for the two groups in the program. The IDE escalates independently for each group. Once the cohort size at a dose level is reached then the next cohort receives the next highest dose level. The escalation continues until both outcomes are observed and at that time, the one-sample or two-group TITE-CRM is implemented.Recall that the first subject has its dose defined initially by the user. This dose level will be the starting dose in the IDE, thus careful consideration to the choice of starting dose for each group should be given. Starting at lower dose levels, while a cautious approach, may expose subjects to suboptimal doses and depending on the planned group size or number of dose levels, the trial may not get to the full two-group TITE-CRM estimation. Also, the typical scenario is that the trial is waiting to observe a toxicity in the IDE stage, but in some cases it may be that toxicities occur initially so the trial needs a non-toxicity to proceed to the second stage. In an actual trial, provisions should be made in the protocol on how these will be handled or avoided.We used the NLP procedure (nonlinear programming) in SAS to obtain the MLEs of the model parameters. The Newton–Raphson method with ridging was used as the optimization method and is recommended for small problems (N≤40) [25]. The one-sample TITE-CRM also uses the NLP procedure to find solutions. The estimation macros correspond to the observation of both outcomes in either group (opt1G0_tite and opt1G1_tite) or both groups (opt_tite). Dose escalation and de-escalation are not restricted.The program produces four output datasets from the simulations. The all_ptdata contains the summary of subject data for all simulated trials. The all_recdose dataset stores the group-specific MTD for the trials. The all_est dataset stores only the estimated parameter values for each estimation while all_nlp dataset provides more comprehensive information on the estimation from the NLP procedure.Sample size is an important consideration in any study, including dose-finding trials. A typical dose finding trial is small and conducted using a fixed sample size, N. Simulations provide a way to evaluate the impact of the number of subjects to be used in the trial for a given scenario. Evaluating the operating characteristics obtained from the simulated design at varying sample sizes provides guidance as to the benefit or lack thereof with the addition of more subjects. The recommended MTD proportion stands out as a good criterion to use when examining different sample sizes as it is the primary interest in dose-finding trials [26].To illustrate, 1000 simulated trials were conducted using a set of six doses, target rate of toxicity of 0.20 and sample size of 80. While we recognize that 80 subjects is not a feasible sample size in these trials, the purpose is to compare the behavior for larger sample sizes with the smaller sample sizes to provide a ceiling on what can be expected for that scenario. Using the patient dataset for the 1000 trials, each trial was then truncated at varying sample sizes and the recommended MTD at those sample sizes (e.g. N=20, 26, 32, 38, 44, 50, 80) were found. The choice of sample sizes was arbitrary but can be motivated in practice by those sizes being considered for a specific trial. This simulation was conducted for three different group allocations, p_group=0.5, 0.75, 0.25. We assume the true dose-toxicity relationship for group 0 as {0.01, 0.18, 0.25, 0.36, 0.50, 0.70} and for group 1 as {0.02, 0.06, 0.10, 0.19, 0.32, 0.56}.The resulting all_recdose dataset was then used to examine the MTD for each group at each sample size. Instead of considering the recommended MTD proportion for each group separately, we examined the MTDs as a paired response accounting for the outcome in each group as a paired observation. We use the proportion of trials where the correct MTD is recommended for both groups (concordance proportion).In Fig. 2, we plot the proportion out of the 1000 trials the correct MTD was recommended for both groups. As the sample size increases, each allocation has a general trend to increase the concordance proportion as expected. Choices based on a steeper increase or plateaus in the proportion can be used to support sample size choices. From the example, the increase in proportion between 26 and 32 for the p_group=0.5 allocation may support a sample size of 32 if a gain of 3.3% is worth increasing the sample size by six subjects. Note that going from 44 to 50 subjects, resulted in a gain of only about 1%.We use hypothetical data to show how to run an actual trial. The general procedure for a trial is summarized in the inner trial loop (red dashed line) in Fig. 1.For an actual trial, the true probability of toxicity associated with a dose is unknown. The only design parameters to be specified are the working model parameters, the TRT, the starting dose levels and the cohort size. It also requires the user to supply the subject data each time a new subject is about to be enrolled. With this information, the program executes the appropriate estimation (see Sections 3.1.2 and 3.1.4 for details) in order to find the recommended dose. The outputs resulting from the program are discussed in Section 4.1.3.Before recruitment begins, the design parameters for the trial should already be set in the protocol. The default IDE in the program is as described in Section 3.1.2. The default working model function is the empiric and the working model parameters are used to find the trial x values. The group relationship is defined to be additive. Using specifications other than the defaults will require making changes to the program. A dataset with the dose levels and the initial probabilities of toxicity associated with those dose levels for the first group should be specified in the doses dataset.The data available at the time of estimation is evaluated to see if both toxic and non-toxic events have been observed by one or both of the groups. If neither group has the required events, then the program continues in the IDE stage. If either one of the groups has a toxicity and a non-toxicity (but not both groups), then the one-sample TITE-CRM is used for that group while the other group continues to recommend a dose based on the IDE. These macros are specific to the group which has both events. Once both groups have a toxicity and non-toxicity, the full two-group TITE-CRM likelihood estimation is implemented.The subject data file name and location is stored in filename. The ds macro variable is the name of the imported SAS data file. The import is built in and is programmed for a CSV file. The procedure can be changed to import other files as needed. Users can refer to SAS documentation for commands to accommodate other file types. Fig. 3gives an example of the subject data file. Further details of the file used to store the subject data is given in the supplemental material.Keeping documentation of the study progress is important in any trial. The output from this program is intended to provide the user with the outcome of interest as well as a way to verify and record the data used for each estimation. The program outputs the recommended dose for the next subject (or trial MTD at the final estimation) for each group, the estimated parameters (when available), the sample path for the trial and a listing of the subject data at the time of estimation. The output can be used as a record of inputs at each estimation, in addition to the results. It also provides a way to monitor recruitment overall and within each group. An example is shown in the next section.The estimation used the empiric dose-toxicity function,f(x,β)=xeβ, a TRT of 20% and initial working model probabilities of {0.10, 0.18, 0.25, 0.36, 0.50, 0.70} for the first group and {0.02, 0.06, 0.10, 0.18, 0.32, 0.55} for the second group for the hypothetical data given in Fig. 3. The IDE used the MTD of the initial probabilities as the starting dose for each group (dose levels 2 and 4, respectively) and escalates the dose after three subjects if both outcomes were not observed in each group separately. The observation window was assumed to be six units of time. The IDE or IDE/one-sample TITE-CRM was used to find the recommended doses for subjects 1–7. The full two-group TITE-CRM was used subsequently to find each recommended dose.Using the data in Fig. 3, we focus on the estimation at two time points, before and after the enrollment of subject 11 (S11), Fig. 3a and b, respectively. The data in Fig. 3a shows the hypothetical data used to find the recommended dose for S11. When subject 12 (S12) presents for enrollment, the information is updated so that the follow-up times for subjects 10 and 11 are now 5 and 3, respectively and neither has had a toxicity (Fig. 3b). The updated information is used to obtain the recommended dose for S12 and depends on the group membership of that subject. Fig. 4is an example of the output provided by the program when S12 is enrolled which contains the recommended dose for both groups, sample path for the trial and information on all study subjects as of that time.

@&#CONCLUSIONS@&#
