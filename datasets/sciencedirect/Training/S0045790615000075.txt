@&#MAIN-TITLE@&#
Adaptive block truncation coding technique using edge-based quantization approach

@&#HIGHLIGHTS@&#
An Adaptive block truncation coding technique (ABTC-EQ) is proposed.Edge image is taken from the input image and divides it into blocks of pixels.Quantization is done based on the edge information of each of these blocks.Bi-clustering is done for the non-edge block and tri-clustering for the edge block.Experimental analysis shows that ABTC-EQ outperforms BTC and its variants.

@&#KEYPHRASES@&#
Image compression,Lossy compression,Block truncation coding,Edge detection,k-means clustering,

@&#ABSTRACT@&#
In this paper a new approach of edge-based quantization for the compression of gray scale images using an Adaptive Block Truncation Coding technique (ABTC-EQ) is proposed, to improve the compression ratio (CR) with high picture quality. Quantization is done based on the edge information contained in each block of pixels of the image. Conventional BTC method retains the visual quality of the reconstructed image but it shows some artifacts near the edges. In conventional BTC and variants, same quantization is done for all pixel values with different block sizes so that CR is static for images with a fixed block size. But in the case of proposed method since the quantization is done based on the edge information, CR become dynamic and consequently achieves better visual quality with better CR. The experimental analysis based on subjective and quantitative analysis proved that the proposed method outperforms other BTC variants.

@&#INTRODUCTION@&#
With the widespread accessibility of digital cameras and the advancement of the Internet as a means of communication, digital images have become an important means of channeling visual information. Since uncompressed digital images need larger storage capacity and high transmission bandwidth, effective usage of image information could not be possible in many applications. Thus efficient image compression methods are becoming more important with the rapid growth of such data. Reconstruction of images from the compressed image with minimum loss is the key issue in all image coding techniques. To achieve high compression ratio (CR) or low bit rate in image coding, as much redundant data present in the image have to be removed without affecting the image quality [1,2].The conventional Block Truncation Coding (BTC) algorithm [3] is a simple and fast lossy compression technique based on moment preserving quantization for blocks of pixels in a gray scale image. Basically the algorithm adapts the local characteristics of an image. The input image is divided into non-overlapping blocks of pixels of sizes 4×4, 8×8 and so on. Each block is coded individually into bit planes consisting of 0’s and 1’s. Each block is coded by the values of the first order moments such as mean and standard deviation and the bit plane. Since BTC produces a set of bitmap, mean and standard deviation to represent a block, it gives a CR of 4 and hence the bit rate is 2 bits per pixel for a 4×4 block. Though BTC method provides good compression without much degradation on the reconstructed images it shows some artifacts like staircase effect or raggedness near the edges. Because of the two-level quantization used in BTC, anti-aliasing effects have been removed from the reconstructed image and sharp edges between the contrasting pixels form a jagged or uneven appearance. As edges play an important role in human visual perception, it also shows significance in image processing and computer vision. Edges provide semantically important image features. Various edge detection techniques reduces an image to its edge details which can be used in subsequent image processing applications, such as segmentation, feature extraction, and image compression. Edge detection techniques on an image significantly reduce the amount of data to be processed and filter out insignificant information, while preserving the important structural properties of the image. Thus the information of the image edge has much importance in identifying, segmenting and compressing image and consequently arise edge-based compression techniques.Several works on edge-based image coding techniques as well as variants of BTC techniques have been reported in literature to overcome the drawbacks of the conventional BTC method. Absolute Moment Block Truncation Coding (AMBTC) [4] preserves the higher mean and lower mean of each of the blocks and use this quantity to quantize output. AMBTC provides better image quality than image compression using BTC. Moreover, the AMBTC is quite faster compared to BTC. Mathews et al. [5] proposed a modified BTC algorithm using max–min quantizer (MBTC) which gives high quality reconstructed images with the same CR as BTC. Cheng and Tsai [6] proposed an image compression algorithm based on the application of the moment preserving edge detection. The algorithm uses simple analytical formulae to compute the parameters of the edge feature in an image block thus makes it computationally faster and the reconstructed images are of good quality in accord with human perception. Desai et al. [7] proposed an edge and mean based compression algorithm that produces acceptable quality images with high CR. The algorithm represents the image in terms of its binary edge map, mean information, and the intensity information on both sides of the edges. An image compression algorithm based on local edge detection proposed by Aggoun and Mabrouk [8] improves the bit rate of the conventional BTC algorithm. Mathews et al. proposed an improved method (IBTC-KQ) using k-means quad clustering for the compression of gray scale images [9] and color images [10]. Amarunnishad et al. [11] proposed an improved BTC image compression using a Fuzzy Complement Edge Operator (YIFCEO) [12] which shows an improvement in the visual quality of reconstructed images compared to the conventional BTC. All these modified techniques give significance on edge extraction and coding and it proves that edge-based compression techniques gives better results both in the visual quality and CR. Since edge information brings significant role in visual perception, we propose an edge-based BTC technique for compressing gray scale images which gives better visual quality reconstructed images than the conventional BTC method and its variants.In this paper, an edge preserving adaptive lossy image coder for gray scale image ABTC-EQ is proposed. In most of the image processing applications edges are considered as important image features for the analysis of an image. Edge pixels are those pixels at which the intensity of an image varies abruptly and an edge is characterized by this variation in gray levels and it indicates the boundary between two regions in an image [1]. Edge detectors are fundamental image processing tools designed to detect edge pixels in an image. Several classical edge operators such as Sobel, Prewitt, Laplacian, and Canny operators are already available in literature [1]. In the proposed method, an edge image is generated from the original image using an edge detection technique called Canny edge detector [1]. Then the original image is divided into edge blocks and non-edge blocks and quantization levels are defined based on the edge information. Using this edge-based quantization the image is coded inorder to get an edge preserved better quality reconstructed image. As the proposed method emphasize on both edge preservation and compression based on the edge information, an improvement in both the compression efficiency and visual quality can be achieved.The rest of this paper is organized as follows. Section 2 discusses the proposed method in detail. Section 3 describes the performance measures used and Section 4 gives a detailed analysis of the proposed method. Section 5 presents the experimental analysis and the paper concludes with Section 6.The proposed method ABTC-EQ introduces an edge-based block truncation coding technique in order to get good visual quality images with better compression ratio. ABTC-EQ finds the edge image from the input image using the Canny edge operator [13] and then divides the input image into blocks of pixels. Quantization is done based on the edge information of each of these blocks. In the non-edge block since the information is almost uniform bi-clustering is done whereas for edge block tri-clustering is done. The algorithm for this method is as follows:Step 1: Input a gray scale image of size M×N pixels and the block size k by which the image is to be divided into non-overlapped blocks.Step 2: Finding the edge map, emapThe edge map of the input image is derived by using the Canny edge operator. The Canny edge detector is an optimal edge detection algorithm consisting of different stages to detect a wide range of edges in images. The first stage of the algorithm is the noise reduction which means smoothening the image with a Gaussian filter. In the second stage, find the intensity gradient and apply an edge thinning technique called non-maximum suppression. Then trace the edges through the image using double thresholding and connectivity analysis [1,13].Step 3: Divide the image into blocks, each of size k×k, where value of k can be 4, 8, 16 and so on. Then each block W can be represented as,W=w1w2⋯wk⋮⋱⋮⋯wk2Step 4: Divide the edge map emap into blocks with the same block size k. Each edge block can be represented as,E=e1e2⋯ek⋮⋱⋮⋯ek2Step 5: Classification of blocksClassify the blocks in such a way that if any of the edge values in E is 1 and not all the edge values are 1 then the corresponding image block W is defined as an edge block, otherwise a non-edge block. An identifier flag is defined and assigned the value 0 for the edge block and 1 for the non-edge block.i.e.,if∃ei∈E,‖(ei==1andnotallei==1)thenflag=0//edgeblockelseflag=1//non-edgeblockStep 6: Adaptive Encodingif (flag==0)(i)Segment the block W into 3 clusters (c0, c1, c2) using k-means clustering [14] algorithm so that similar pixels are grouped into the same cluster.(1)ci(i=0to2)={wj|wj∈Wandwjclosure to centroidi}Compute the mean (μ0, μ1, μ2) of the pixel values corresponding to each cluster using Eq. (2).(2)μi(i=0to2)=1mi∑r=1mixrwhere xris the intensity value of the pixel in each cluster and miis the total number of pixels in each cluster.Based on these 3 clusters the bit map B is generated using Eq. (3).(3)Bl=b1b2⋯bk⋮⋱⋮⋯bk2wherebj=00,ifwj∈c001,ifwj∈c110,ifwj∈c2Therefore, 2 bits per pixel are required to represent each bj.else (flag==1)(i)Find the maximum (max) and minimum (min) values of gray levels in the block W. Also calculate the mean (μ) of the block.Find the threshold (T) by calculating the average value of max, min and μ using Eq. (4).(4)T=max+min+μ3Quantize the block W based on the threshold value (T) in such a way that, if a pixel value is greater than T, the value 1 is assigned and otherwise, value 0 is assigned to the bitmap. Then the compressed bitmap B obtained is,B=b1b2⋯bk⋮⋱⋮⋯bk2wherebj=1,wj>T0,wj⩽TSince the values of this bit map is either 0 or 1, only 1 bit per pixel is needed to represent each pixel.Pixels in the image block W are then classified into two ranges of values. The upper range consists of gray levels which are greater than T and lower range consists of gray levels which are less than or equal to T. The mean of the upper range (μ0) and the lower range (μ1) are calculated using Eqs. (5) and (6) respectively.(5)μ0=1p∑j=1pwj,wj>T(6)μ1=1q∑j=1qwj,wj⩽Twhere p is the number of gray values greater than T and q (=k2−p) is the number of gray values less than or equal to T.Repeat Step 6 for each block. The resultant bit map generated represents the encoded image. For the decoding process, the bitmap block B, the flag and the means are transmitted to the decoder. If flag is 0, (μ0, μ1, μ2) are transmitted otherwise (μ0, μ1) are transmitted. The decoding procedure is as follows:Step 7: Adaptive DecodingGet thek×kbit map blockB.B=b1b2⋯bk⋮⋱⋮⋯bk2if (flag==0)Decode bitmap block with the three means (μ0, μ1, μ2) using Eq. (7). Then the decoded image block Z can be represented as,(7)Z=z1z2⋯zk⋮⋱⋮⋯zk2wherezi=μ0,ifbj=00μ1,ifbj=01μ2,ifbj=10else (flag==1)Decode bitmap block B with the reconstruction values μ0 and μ1 using Eq. (8). Then the decoded image block Z can be represented as,(8)Z=z1z2⋯zk⋮⋱⋮⋯zk2wherezi=μ0,ifbj=0μ1,ifbj=1Repeat the step for each block and the resultant matrix represents the reconstructed image.In the edge map there can be blocks with all values either 0 or 1 and such blocks have no edges present in them resulting in a visually continuous effect. The average of the maximum, minimum and mean value is taken as the threshold and quantization is done based on this threshold for these non-edge blocks. While reconstructing such blocks, the mean values of the upper range and the lower range are taken as the reconstruction values. For the edge block, we have made an assumption that an edge divides the region into background region, foreground region and the region with edge pixels. With this assumption, we have done tri-clustering for the edge block such that the similar pixels in each region will be grouped into the same cluster. And the pixels in each region are decoded using the mean values of each cluster. Therefore, in ABTC-EQ, for an edge block tri-clustering is done and three mean values are transmitted while for a non-edge block only two mean values are needed to be transmitted to the decoder. Hence, depending on the structural information contained in an image we can reduce the number of bits to be transmitted and consequently increase the compression efficiency.Once an image compression technique has been designed and implemented, it is important to evaluate its performance based on some image quality measures. The two main criteria of measuring the performance of an image compression algorithm are compression efficiency and distortion caused by the compression algorithm. In this work we focus on measures such as Peak Signal to Noise Ratio (PSNR), Compression Ratio (CR) [15,16], Structural Similarity Index (SSIM) [17], Feature Similarity Index (FSIM) [18], Detail Variance (DV) and Background Variance (BV) [19].PSNR is most commonly used as a measure of quality of reconstruction of lossy compression. PSNR is a qualitative measure based on the mean-square-error (MSE) of the reconstructed image. MSE gives the difference between the original image and the reconstructed image. If the reconstructed image is close to the original image, then MSE is small and PSNR takes a large value. PSNR is dimensionless and is expressed in decibel.PSNR=10logL2MSEwhereLis the dynamic range of the pixel values(255for8-bit grayscale images)andMSE=1MN∑i=1M∑j=1Ny(i,j)-x(i,j)2where x represents the original image, y represents the reconstructed image and M×N is the size of the image.Compression efficiency is measured by the CR or by the bit rate. CR is the ratio of the size of original image to the size of the compressed image and the bit rate is the number of bits per pixel required by the compressed image.CR=sizeoftheoriginalimagesizeofthecompressedimageSSIM [16,17] is a method for measuring the similarity between two images. SSIM can be defined as a function of three components luminance, contrast and structure. The resultant SSIM index is a decimal value between (−1 and 1) and in the case of two identical sets of data value of SSIM becomes 1.Luminance change,l(x,y)=2μxμy+c1μx2+μy2+c1Contrast change,c(x,y)=2σxσy+c2σx2+σy2+c2Structural change,s(x,y)=σxy+c3σxσy+c3SSIM(x,y)=l(x,y)·c(x,y)·s(x,y)where x represents the original image, y represents the reconstructed image andμx=average ofx,μy=average ofyσx=variance ofx,σy=variance ofy,σxy=covariance ofxandy.c1andc2aretwo variables to stabilize the division with weak denominatorc1=(k1L)2,c2=(k2L)2,c3=c22,k1=0.001,k2=0.002by defaultLis the dynamic range of the pixel values(2#bits per pixel-1)FSIM is a low-level feature based IQA (Image Quality Assessment) metric, which uses two kinds of features namely, the PC (Phase Congruency) and the GM (Gradient Magnitude) These features represent the complementary aspects of the image visual quality [18].A visual quality appraiser based on background and detail region variance is also used for the quantitative evaluation of our proposed method. The two metrics, DV and BV, are calculated based on the local variance of the detail region and uniform region of the image, respectively [19]. A good compression technique could attain DV and BV values for reconstructed image almost closer or equal to those values for the original image.In this section, the conventional BTC algorithm and the proposed algorithm are analyzed in detail by taking a 4×8 size test image. The detailed analysis of these algorithms is illustrated in Table 1. More than 50% reduction in the MSE obtained by ABTC-EQ shows a significant enhancement in the visual quality of the reconstructed image.Performance of the proposed method has been evaluated for a set of test images of different sizes. Table 2shows the comparative performance results of BTC, AMBTC, MBTC and ABTC-EQ. The performance is measured based on four parameters PSNR (in dB), SSIM, FSIM and CR.From Table 2, it can be seen that performance of the proposed method ABTC-EQ is better than BTC, AMBTC and MBTC algorithms on the basis of the four performance measures. For all the test images with 4×4, 8×8 and 16×16 blocks, PSNR, SSIM and FSIM values are high in comparison with BTC, AMBTC and MBTC. It shows an enhancement in the visual quality of the reconstructed image.For BTC, AMBTC and MBTC methods, CR remains the same for all images for a fixed block size because bi-clustering is done for all the blocks of pixels and the number of bytes required to transmit for decoding is same for all the three methods. But in the proposed method ABTC-EQ, number of clusters varies depending on the edge information present in an image and subsequently the number of bytes required for decoding also varies. Hence, CR changes for different images. With block size 4, CR achieved by ABTC-EQ is less than that of BTC and its variants but by taking a block size higher than 4 we can achieve a higher CR for the proposed method. Still, the PSNR value of the proposed method will be higher as shown in Table 2. This shows the enhancement in the visual quality with a better CR than the conventional BTC and its variants.The variation in PSNR, SSIM, FSIM and CR values for different block sizes with BTC, its variants and ABTC-EQ is shown in Fig. 1.In the first three methods, bi-clustering is done and in the bit plane block, the changes in the bit values indicate the edges and these are determined by the block threshold. Because of the in-built fuzziness present in the image, these edge positions may or may not be accurate. This is reflected in the visual quality of the image. Also in these methods CR is same for all the images for the same block size. CR is changed only when the block size is increased. Therefore these methods are image independent. In BTC and its variants, since the average is taken as threshold, images with uniform information gives better results, but images with more structural information may cause some artifacts. So in the proposed method, we have taken care of the edge information contained in an image and based on the edge information, quantization is decided. Hence, we can achieve good CR with improved image quality. In this method, CR is dynamic and depends on the structural information present in the image. Based on this structural information bi-clustering or tri-clustering is done and consequently we can increase the compression efficiency as well as improve the visual quality. If the image shows more uniformity, bi-clustering is done and for non-uniform image blocks tri-clustering is done.Table 3shows the comparative analysis of ABTC-EQ with two variants, one in which all the image blocks are considered as non-edge blocks and the other in which all the image blocks are considered as edge blocks. In the first case, bi-clustering is done and in the second case, tri-clustering is done. The performance measures using these three methods are shown in three rows viz., ‘only tri-clustering’, ‘only bi-clustering’ and ‘ABTC-EQ’ in Table 3. Bi-clustering achieves better CR with a modest PSNR value whereas tri-clustering gives high PSNR value with less CR. These two cases can be compromised with our proposed method by which we can achieve better CR and PSNR values comparable with the other two variants. For instance, in the case of ‘lena’ image, the PSNR values obtained by the three methods are 31.5995, 33.6711 and 33.8401 with CR, 3.8209, 4 and 4.3794, respectively and PSNR values obtained for the image ‘cameraman’ are 29.3689, 29.7992 and 31.2452 with CR 3.8209, 4 and 4.3656. Similarly, for all other images the improvement in both the CR and PSNR value can be achieved using our proposed method.Some of the test images of different sizes and the corresponding reconstructed images using different BTC methods are shown in Fig. 2. Fig. 3shows the zoomed effect of the selected portion of the original and reconstructed images with BTC, its variants and ABTC-EQ. And it can be seen that ABTC-EQ gives perceptually high quality reconstructed image with minimum distortions near the edges.The edge images shown in Fig. 4. clearly depict the improvement in the visual quality near the edges. By the proposed method, the edges in the reconstructed images are very clear and sharp whereas the edges detected by the conventional BTC method are less and irregular. Also, in the conventional BTC method unwanted edges are detected.Table 4shows the comparative performance analysis of the proposed method ABTC-EQ with BTC, AMBTC and MBTC based on the two metrics BV and DV. From the table, it is evident that the difference between the local variations in the detailed region and in the background region of the original image and the reconstructed image is considerably reduced in the proposed method.

@&#CONCLUSIONS@&#
