@&#MAIN-TITLE@&#
Automatic high-fidelity 3D road network modeling based on 2D GIS data

@&#HIGHLIGHTS@&#
Procedural generation of high-fidelity 3D road models from 2D road GIS data.A set of carefully selected civil engineering rules for road design.A novel approach that generates road geometry from centerline information.Parameterization of network data into elements which compose sophisticated geometry.The algorithm produces seamless road geometry quickly and efficiently.

@&#KEYPHRASES@&#
Road network modeling,Procedural modeling,GIS,Civil engineering,Road parametric representation,Driving simulation,

@&#ABSTRACT@&#
Many computer applications such as racing games and driving simulations demand high-fidelity 3D road network models. However, few methods exist for the automatic generation of 3D realistic road networks, especially for those in the real world. On the other hand, vast 2D road network data in various geographical information systems (GIS) have been collected in the past and are used by a wide range of applications. A method that can automatically produce 3D high-fidelity road network models from 2D real road GIS data will significantly reduce both the labor and time cost, and greatly benefit applications involving road networks. Based on a set of carefully selected civil engineering rules for road design, this paper proposes a novel approach that transforms existing road GIS data that contain only 2D road centerline information into high-fidelity 3D road network models. The proposed method consists of several major components, including road GIS data preprocessing, 3D centerline modeling, and 3D geometric modeling. With this approach, basic road elements such as road segments, road intersections and traffic interchanges are generated automatically to compose sophisticated road networks in a seamless manner. Results show that this approach provides a rapid and efficient 3D road modeling method for applications that have stringent requirements on high-fidelity road models.

@&#INTRODUCTION@&#
Roads are a primary component of human civilization and different types of roads form road networks that are the backbone of modern society [1]. With advances in computing technologies, road models have been widely used in many applications such as games and virtual environments. In early computer applications involving road models, almost all 2-dimensional (2D) and 3-dimensional (3D) road models were generated by artists manually using modeling software tools such as Creator and Maya. From geometrical modeling of the road segments to texture mapping, good results were achieved through manual road modeling at the expense of intensive labor and time. This low level manual modeling seriously limited the number of road models generated and thus their widespread uses in various applications. In order to facilitate automatic road generation, various road modeling approaches have been proposed, especially for applications that contain 3D environments. However, most existing methods still require significant amounts of manual editing and pay little attention to the modeling of high-fidelity road geometry and complex road components such as traffic interchanges.Based on a set of carefully selected civil engineering rules for road design, this paper proposes a novel approach for automatic high-fidelity 3D road network generation that transforms existing road GIS data that contain only 2D road centerline information into 3D road network models. The proposed method consists of several major components, including road GIS data preprocessing, 3D centerline modeling, and 3D geometric modeling. With the proposed approach, basic road elements such as road segments, road intersections and traffic interchanges are generated automatically to form sophisticated road networks in a seamless manner. If synthetic environments provide road representations that are similar to the ones used in this approach, the proposed method can be utilized for automatic road network generation in synthetic environments as well.The remainder of this paper is organized as follows. Section 1.1 surveys the related work and Section 1.2 presents an overview of the proposed method. Section 2 discusses preprocessing of the input 2D GIS data. Section 3 describes the civil engineering rules for road design that are selected in this research. Section 4 presents the details of 3D road centerline modeling. Section 5 discusses 3D road geometric modeling. Section 6 shows some experimental results and Section 7 concludes this paper.Road networks are an essential component of virtual cities and several methods have been proposed for generating road networks in urban environments. Parish and Müller utilized the Lindenmayer system (L-system) for road generation and building construction [2]. Based on this work, a system that can simulate the growth of street network and 3D urban model over time was developed by Weber et al. in [3]. A tensor field based procedural method was proposed by Chen et al. to model street networks of large urban areas interactively [4] and a city modeling system was implemented by Lipp et al. to facilitate editing of procedural urban layouts [5]. Various existing procedural techniques including Voronoi diagrams and subdivision were combined in Glass’ paper to replicate the identified features of road patterns in South African informal settlements [6]. Patterns were also observed and extracted from the layout of real road networks and used to create new road layouts. Sun et al. extracted four kinds of common road patterns from existing road networks and generated road networks automatically based on these patterns [7,8]. Vanegas et al. selected a set of design parameters to represent a wide range of observed patterns in their adaptive road network generator [9]. More recent methods, such as agent-based technique [10,11], example based synthesis [12], discrete anisotropic shortest path algorithm [13,14], and sketch-based tool [15], have been developed for automatic road network generation. However, since the main goals of most of these studies were urban modeling, planning and simulation, it is reasonable for them to mainly focus on the layout of the road network rather than the detailed road geometry and structure. Also, all of these methods were designed to create road networks from scratch; none of them intended to produce geometric road network models for existing road networks from GIS data.Different from virtual city applications, road modeling in driving simulations placed more emphases on accurate road geometric design based on civil engineering rules. Artz [16] proposed a database for use in driving simulators to support high speed road surface query. In this system, a road network was represented via four analytic segment types and each segment was modeled in a convenient local coordinate system to simplify road surface definition and segment description. Mourant and Marangos [17] developed a virtual environment editor for driving scenes through three kinds of 2D two-lane road tiles. Complex parts of road networks were modeled in Kaussner’s work [18] using three types of parametric segments: straight lines, simple bends, and segment of super-curves. In the method proposed by Donikian et al. [19,20], road networks were constructed via eleven different sections with each having its own geometry and associated coding. Wang and his group [21–23] extended this approach from 2D to 3D and employed ribbon networks to model navigable road networks in virtual environments. In contrast to Donikian’s approach that divided a road network into various detailed specimens, their method defined “corridor” and developed generic representations of road networks, including intersections. Achal et al. integrated ribbon based road network generation, terrain modeling, vegetation modeling and autonomous traffic modeling into a comprehensive program to create flexible virtual environments [24].Although useful methods have been developed for road network generation, there is still a lot of room for improvement. First, many existing road generation methods involve significant manual operations and require frequent user interventions. It is desirable to reduce manual operations and increase the extent of automatic road generation. Second, few existing methods put emphasis on the road network modeling from real GIS data, which is useful in many modeling and simulation applications. These applications may include racing games which mimic true-to-life roads or driving simulations. Third, few approaches considered accurate modeling of road geometry based on civil engineering principles. For instance, few of them considered superelevation, a road design technique that tilts the roadway to help offset the centrifugal force developed as the vehicles goes around a curve. Superelevation is a very important feature reflecting the road surface elevation and has great impact on the driving experience, especially at high speed. None of the existing methods considered the design of complex highway interchanges, which are the most complex component in road networks. This paper proposes to address these limitations in existing road modeling methods by automatically generating geometrically accurate road networks based on real GIS information, taking into account civil engineering rules with emphasis on road intersections and traffic interchanges.Fig. 1shows the architecture of the proposed method, which consists of several major components, including road data preprocessing, 3D road centerline modeling, and 3D geometric modeling. During road data preprocessing, explicit topology of the road network is extracted from raw road data as a graph composed of road nodes and road links; road link information is further simplified. In 3D road centerline modeling, the missing height information of the road centerline is inferred based on 2D road GIS data, intersections are extracted from road nodes, and the whole road network is represented as road intersections and road segments in parametric forms. Finally, the 3D road centerline models are converted into various 3D road geometries consisting of triangles and textures in the 3D geometric modeling phase.In the existing GIS data, roads are represented as 2D (latitude and longitude) centerlines in the form of polylines as shown in Fig. 2(following page). Although the order of road points is recorded in the corresponding polyline, road network topology is not explicitly represented. To expedite the automatic road generation process, an explicit representation of the road network topology is necessary. In this research, a method proposed in [25] was employed to extract the topology of the road network from the raw road GIS data. The result is a road network represented as a graph composed by nodes and links. Road link information is further simplified to eliminate redundant representations of the same link in the original GIS data.Since the goal of this research is to generate high-fidelity road models, how real roads are designed according to civil engineering rules should be considered. In civil engineering, road design is the determination and arrangement of various elements of a road, including vertical and horizontal alignment, grades, sight distance, widths, slopes, etc. Since the centerlines of the road network are provided by the existing GIS data, some rules such as horizontal alignment of the road centerline are already enforced in the original GIS data. We mainly focus on road design elements related to elevation changes, such as grades, and road surface modeling, such as superelevation. The reason for putting more emphases on road surface modeling is that road surface is the most important element of roads and its quality completely determines the driving experience. In this section, we briefly describe a basic set of civil engineering rules that have significant impact on the road surface and their details can be found in relevant references.Road surface is the most critical component of a road as it provides direct contact and support to the vehicles on it. A set of four most important civil engineering rules for road surface design are selected based on the American Association of State Highway and Transportation Officials (AASHTO) standards [1], which are road width, cross slope, superelevation, and grade.Lane widths of 2.7–3.6m are generally used with 3.6m lanes predominant on most highways. In the AASHTO standards [1], 3.6m has been adopted as the standard lane width for new road constructions. In this research, the default lane width is 3.6m and is modifiable. Using the number of lanes from the road GIS data, the total road width can be determined.Sloping on roadway cross section is employed to meet the drainage needs and direct water off the traveled way to facilitate road users and reduce accident potential. According to the AASHTO standards [1], a plane model with a peak in the middle and a 2% cross slope downward toward both edges is preferred for normal road surface modeling.The superelevation of a curved road segment is used to balance the centrifugal force that moves the vehicle traveling on this curve outward with gravity and side friction according to the laws of mechanics. The superelevation rate can be determined based on the side friction factor, road radius and vehicle speed. In this research, the standard superelevation rates are used [1]. The centerline of the roadbed is used as the axis of rotation for superelevation. An illustration of a superelevation transition from normal crown to full superelevation is shown in Fig. 3.The road elevation changes according to the terrain surface due to the construction economy. The grade line is a reference line by which the elevation of the road is established and must meet requirements of sight distance, which is the continuous length of highway ahead visible to the driver for the designed speed and provides safety, comfortable driving, good drainage and pleasing appearance [1]. In general the flattest practicable grade is desirable, or at least the maximum grade given for terrain conditions shall not be exceeded. All these grade values can be found in [1].A road intersection is the junction where three or more road legs, or segments, join. With a fixed intersection angle, edges connecting two adjacent road legs mainly determine the shape and function of intersections; therefore the edge design is a critical part of intersection design [1]. The corner radii should be based on the minimum turning path in order to provide turning vehicles, especially right-turning vehicles enough space [1]. Three minimum designs for the inner edge of the road legs are provided as simple curve, simple curve with taper, and 3-centered compound curve with different radii [1].Different from normal intersections, merging or diverging intersections where a ramp merges into or diverges from an expressway have more complicated design requirements. The continuity in the basic number of lanes and the principle of lane balance are two design fundamentals. The basic number of lanes should be maintained over a significant length of route, regardless of changes in traffic volume and lane-balance needs. The principle of lane balance requires that the number of lanes should be reduced or increased by no more than one at a time. Auxiliary lanes are introduced at merging or diverging intersections in order to satisfy both the continuity of the basic number of lanes and the principle of lane balance. Two general models are provided by AASHTO standards [1] for the merging or diverging process: parallel design which includes additional auxiliary lanes in the merged legs and tapered design which only includes a short taper for fast merging/diverging.Traffic markings on road surfaces, such as pavement markings, provide regulations, guidance or warning information to road users. Standards for road markings are described at length in [26] and detailed sizes for various markings are given in [27].The major traffic markings generated in this research are pavement markings that provide the primary steering information for traffic and are the essential means to maintain transportation safety and facilitate a smooth traffic flow. The pavement markings generated in this research consist of three kinds of line markings: solid lines, broken lines and dotted lines, based on the U.S. road mark standards [26,27].3D road centerline modeling is at the core of the proposed method for automatic road network generation because the missing height information of the road centerlines is inferred based on 2D road GIS data during this phase. 3D road centerline modeling involves a number of complex steps. This section consists of three sub-sections: interchange modeling, road representation parameterization, and intersection modeling. Among them, interchange modeling represents the biggest challenge in this research as interchanges are the most complex component in road networks. Road representation parameterization transforms roads from discrete points to analytic forms. Intersection modeling synthesizes intersections based on the parametric representation of road networks.Road interchanges are special road intersections that combine ramps and grade separations at the junction of two or more highways in order to reduce or eliminate traffic conflicts, improve driving safety, and increase traffic capacity. Traffic interchange modeling is the most critical and challenging component in this research due to its complexity and the data deficiency that existing road GIS data are 2D and do not contain any height information (vertical position). In order to generate 3D models of interchanges, the overlapped road points in a road network are first identified and grouped into interchanges; then elevations are estimated and assigned to road points so that the road links containing these road points do not intersect or collide with each other. Interchange modeling consists of the following three components.1.Overlap detection: identify overlapped road points and find road links containing these points.Interchange extraction: group the overlapped positions into one or more interchanges and include the relevant road links as part of the interchanges (interchange links).Elevation estimation: assign elevation level to every overlapped road point using a greedy algorithm based on a set of selected rules, calculate their absolute elevations and then compute the elevations of road points located between them through linear interpolation.In the road GIS data, road intersections only occur at the end points of road polylines. Thus, if two road polylines contain the same point that is not the endpoint of either polyline, this point is the location where these two road polylines overlap. This characteristic of the road GIS data is used in this research to find the overlapped positions of two or more road polylines as shown in Fig. 4(a). Relevant road links containing the overlapped positions are identified as shown in Fig. 4(b).Since more than one interchange may exist in a given road network as shown in Fig. 5(a), it is necessary to first group the overlapped road points identified in Section 4.1.1 into interchanges and then process each interchange independently. Based on the positions of overlapping points, a clustering algorithm similar to k-means clustering is utilized in this research. Different from the k-means clustering, our algorithm does not need to initialize the number of groups and it starts with just one group. A point is included in an existing group if its distance to the centroid of that group is the smallest and less than a predetermined threshold (2000m is used in this work). A new group is generated to accommodate a new point whose distance to the centroids of all existing groups is larger than the predetermined threshold. When a new overlapped position is added to an interchange, its centroid (central position) is updated immediately. Based on the grouping of overlapped positions, related interchange road links are grouped accordingly. Thus, an interchange is composed by two kinds of elements: overlapped positions (interchange points) and related road links (interchange links). Fig. 5 gives an example of the interchange extraction where all overlapped positions are identified and grouped into two interchanges, colored in red and green respectively.To generate 3D models of interchanges, the elevation of each road link must be determined correctly, especially the elevation of overlapped positions. Because the original road GIS data do not contain road elevation information, the proposed method estimates road elevations using a greedy algorithm based on a set of criteria determined by civil engineering rules for road design. The elevation estimation consists of two steps: elevation level determination and absolute elevation calculation as discussed below.This paper uses the term “elevation level” to represent different height levels of road points. Larger level values correspond to higher elevation. That is, Level 1 corresponds to road points that are directly placed on the terrain surface; Level 2 represents points that are directly above Level 1 points, and so on. Elevation levels for the road points contained by an interchange are estimated based on the following civil engineering rules for road design.•Grade: the grade of any road link should be less than the maximal rate given by standard design rules to avoid sharp drop or rise of road elevation. This means two close overlapped road points belonging to the same road link should have the same elevation level to prevent drastic change of road elevation.Crest/sag: one road link can contain only one crest or sag within a certain distance (150m in this research) to reduce road users’ discomfort caused by driving up and down frequently.The detailed road link elevation level determination is a greedy algorithm that consists of basic level determination and fine level tuning for collision avoidance.•Basic level determination (Level 1 or Level 2): roughly divide the overlapped road points into Level 1 and Level 2 points. This approach is utilized because most interchanges are two level interchanges except some complicated ones that have a few of Level 3 or higher road links. Two steps are executed iteratively until all overlapped road points are determined as shown in Fig. 6.Step 1: find the interchange road link containing the most undetermined continuous overlapped points and assign these points a predefined elevation level (Level 1 or Level 2). Then assign their corresponding (overlapped) road points on other road links the other elevation level (Level 2 or Level 1). Thus, for each overlapped position, two road points have different elevation levels so that they do not intersect or collide with each other.Step 2: overlapped road points close to the determined overlapped road points (within 60m in this approach) are assigned the same elevation level as their neighbors according to the grade rule discussed before.Collision avoidance: collision among road links whose levels are assigned in basic level determination may happen since close overlapped road points belonging to the same road link are forced to have the same elevation level. Elevation levels for the collided road points are adjusted using a greedy algorithm. The overall road grade and number of crests/sags are used as the criteria by the greedy algorithm to select the best results. That is, for each conflicting road point, its elevation level is increased to avoid collision and the resulting road grade and the number of crests/sags are evaluated and the road point with the smallest road grade and number of crests/sags is finally selected for elevation level increment.The final model of the interchange is mainly decided by the value of predefined elevation levels assigned in Step 1 and different interchange models can be obtained by adjusting these values to meet different requirements. In this research, all possible sets of predefined elevation level values are generated in advance. For example, if 3 predefined elevation level values are used, there are 8 possible sets of predefined elevation level values as listed as follows: (1,1,1), (1,1,2), (1,2,1), (2,1,1), (2,1,2), (2,2,1), (1,2,2), (2,2,2).If the used set of predefined elevation level values is (1,2,1), for the first execution of step 1 in basic level determination, the most undetermined continuous overlapped points found by the program are assigned the 1st number of set, level 1; and then for the second execution of step 1, the most continuous overlapped points found in the left undetermined overlapped points by the program are assigned the 2nd number of set, level 2; the rest can be done in the same manner until all overlapped points are determined.Fig. 7gives an example of the interchange modeling with different predefined level values and a total of 4 different interchange models are generated from the same road GIS data, and the one displayed in Fig. 7(f) has exactly the same structure as the real one shown in Fig. 7(a).After determining the elevation level of each overlapped point, absolute elevations are calculated based on level height, and linear interpolation is used to compute the elevations for road points located between two overlapped positions. The grade rule should be complied with during the linear interpolation, especially for handling the junction between an interchange road link and a normal road link that does not have any overlapped position yet connects to the interchange road link.As discussed before, various interchange models can be generated from the same road GIS data with different predefined level values. Because the predefined elevation level values used in this research are 1 and 2 representing Level 1 and Level 2 respectively, this method can generate exactly the same model for any existing two-level road interchange. As shown in Fig. 7, among the four generated interchange models, the one displayed in Fig. 7(f) has exactly the same structure as the real one shown in Fig. 7(a). For interchanges containing 3 or more levels, the proposed algorithm does not guarantee to generate results that are exactly the same as the real interchange due to the complexity of interchange structure. Theoretically, with minor modification this method can be used to enumerate all possible configurations for 3-level interchanges and generate results that are identical to the real one. However, the computational complexity of such approach for interchanges with 3 or more levels prevented its use in this work.To evaluate the quality of different interchanges produced by the proposed method, we define several metrics for every interchange as follows:•Highest elevation level: the highest elevation level contained in the interchange.Number of crests and sags: the number of crests and sags contained in the interchange along every road segment.Maximal grade: the maximal grade produced in the interchange.Average grade: the average grade value of all road segments contained in the interchange.Total length: the sum of length of all road segments contained in the interchange.For all the above metrics, results with smaller values are better. Using the interchange between I-64 and I-264 shown in Fig. 2 as an example, values of these metrics for the 32 generated interchange models are calculated and two of them are shown in Fig. 8. Note that although these 2 interchange models seem different, they stemmed from the same GIS data with different 3D height information, and the height difference between two adjacent levels is exaggerated to 40m to clearly demonstrate the structure of produced interchanges.The result shown in Fig. 8(b), based on the evaluation metrics, is the best with the shortest length, smallest maximal grade, fewest crests and sags, and smallest average grade. Comparing all the generated models with the real interchange, it is found that Fig. 8(b) provides the closest match to the real one. The only difference between them is that a ramp which is located in Level 3 in the real change is placed in Level 1 in the generated model. The generated model offers another good design for the construction of this interchange that complies with the civil engineering rules.The road GIS data only contain discrete points of the road network in the form of polylines. This discrete representation has several drawbacks, with the most serious one being not supporting arbitrary resolution of representations. The proposed method converts the original discrete representation of the road network into parametric representation that has the advantages of supporting arbitrary resolution of levels of details and reducing memory usage. Horizontal alignment in road design consists of two major types of road segments: straight sections (called tangents) and circular curves, for the ease of driving on those road segments. Transition curves are often used for smooth transitions between tangents and circular curves, but are not always used [1,28]. Accordingly, our road representation parameterization defines two standard forms, which are straight lines and circular curves, to represent tangents and circular curves used in horizontal road alignment. Hermite curves are also utilized to represent the transition curves, as they guarantee the C1 continuity (which translates into the velocity of a vehicle).In order to divide the road links into segments that can be parameterized, three types of critical points are identified to segment the road polylines: acute turn, s-turn and turn start/end based on their geometric features [29]. After the critical points are identified, road polyline links are partitioned into a series of segments that are groups of discrete points. Then least square methods [29] are employed to fit these road segments into straight lines and circular curves. The threshold values used in the least square fitting methods are 0.998 for straight lines and 1.0m for circular curves. That means the correlation coefficient for every straight line fitting must be larger than 0.998 and the average difference between the fitted radius and real distance from given road point to the fitted center point mush be smaller than 1.0m. After the straight lines and circular curves are obtained, each type of road segment is shortened by a certain amount (30m in this work) and Hermite curves are constructed to provide the smooth transition. Hermite curves provide C1 continuity (both the curves and their tangents are continuous at joints of curves). Fig. 9shows the parametric representation of the road network displayed in Fig. 2 where red lines indicate straight lines, blue for circular curves, and cyan for Hermite curves.Although with the addition of Hermite curves there exists C1 continuity, visibly there may be defects in the geometry. Generally, this is the cause of numerical robustness in the calculations and discretization of the parameterized segments for geometrical representation. After all, the network is broken into several independent segments as illustrated in Fig 9. The automatic detection and correction of these defects is discussed in Section 5.Based on the shape and function, intersections are divided into two types: normal intersection and merging/diverging intersection. If an intersection has just 3 legs and one of the angles between its adjacent intersection legs is less than 30°, it is considered as a merging/diverging intersection; otherwise, it is a normal intersection. For normal intersections, the effect of curb radii should be taken into consideration. For merging/diverging intersections, the merging or diverging of the ramp leg must be handled correctly. The main task of the centerline modeling of intersections is to determine the end position of every intersection leg and separate it from connected road segments. The method discussed in [8] for junction synthesis was adopted and expanded in this research to generate the road intersection. Compared with the original method that only considered synthesizing junctions from connected straight line road segments, our method produced smooth junctions from both line and curved road segments. The resulting road intersection is represented by several parameters, including the position of the intersection center (node), the end point of the centerline and side vector for each leg (connected road link). An example of the intersection centerline modeling is given in Fig. 10.In this section, 3D road centerline models, namely the analytic representations of road segments and intersections are converted into 3D road geometric models consisting of triangles and textures. Road surfaces for intersections and traffic interchanges are tessellated from the road analytic representations through triangulation. Various civil engineering rules such as cross slope, superelevation, turning radii, and merging/diverging are taken into account in the geometric modeling. Once the initial geometric representation is constructed, another pass over the geometry is added to detect geometrical defects, most commonly found in the transition of connecting segments. Next we discuss the details of geometric modeling for road segments and road intersections, as well as surface rendering.Road segment geometric modeling is based on several road attributes, including road centerline positions, normal cross slope, superelevation, number of lanes, and side vectors. This section discusses modeling methods for roadbed, superelevation, and road markings.Road width is determined by the number of lanes and lane width. After the road width is determined, road surface is extended from the road centerline along the side vectors in both right and left directions. Discrete points along the road centerline and side vectors are generated from the analytic road segment representation. Finally, a triangle mesh to represent roadbed is generated using these points as vertices.For some roads that have auxiliary lanes at their end connecting to a parallel design merging/diverging intersection, the number of lanes changes and the left road surface and right road surface may have different width. Thus, the numbers of lanes for the left road surface and right road surface should be represented respectively to reflect the change of road width, especially for the taper part included at the end of the auxiliary lane to implement the lane merging.Normal cross slope for most road surfaces and superelevation for curved road surfaces are two key factors determining the main shape of road surfaces, such as the superelevation transition from normal crown to full superelevation. Using the centerline of the roadbed as the axis of rotation for superelevation, two parameters left rate (lRate) and right rate (rRate) are defined to represent the slope rate for each half of the road. For instance, for normal cross slope, both the lRate and rRate are −2% which means a 2% cross slope downward toward both edges. Both parameters are adjusted for curved road segments based on civil engineering rules to implement proper superelevation transition and full superelevation [1].Lane markings such as normal lines and broken lines are generated automatically based on the number of lanes and are added to the road surface as textures. The position and type of the lane marking are determined by the centerline and the number of lanes.Geometry defects occur in situations where segments are improperly parameterized (very rare), or in situations where adjacent segments aren’t quite connected properly (more common).Fig. 11demonstrates the rare case where a segment was improperly parameterized. The segment in question is parameterized as a curved segment; however due to the overall length of the segment, it would be better approximated with a straight line segment. Manually, this is easily corrected as the segments parameters could be tweaked by the user; however, the algorithm must automatically detect situations such as that in Fig. 11 and correct them. This defect occurs only in curved segments, and may be detected by determining the ratio of the length of the segment and the radius of the curve. If this ratio is small, the segment is approximated with a straight line.The more common defect is found in the transition between adjacent segments. It may be found between straight line – straight line segments, straight line – curved (or vice versa), and curved – curved segments. Fig. 12provides an example of this situation by providing a look at the road segments in three situations: without any Hermite curve interpolation, with a basic Hermite curve interpolation, and finally with the improved Hermite curve interpolation.In the basic Hermite curve interpolation method, segments with sufficient length (30m) are cut and a Hermite curve is injected. In situations where segment lengths aren’t sufficient, a portion (10%) of the ends are removed and replaced with a Hermite curve. This portion is meant to preserve the parameterization of the segment, especially for straight line segments. As shown in Fig 12(a) and (b), this portion may not be long enough to provide adequate smoothing. In the improved algorithm, the small segment and the adjacent Hermite curved segments are completely removed and a single Hermite curve is inserted. As shown in Fig 12(c), this provides a significant difference for the geometry and provides a much smoother curve.The geometric models of intersections are more complex than those of road segments because of various configurations of intersection legs, i.e., different numbers and directions of connected road segments. The outline of a road intersection is composed of two parts: legs and edges between any two adjacent legs. Normal intersection and merging/diverging intersections are handled differently in their geometric modeling.For normal intersections, circular curves are sufficient to represent these edges with proper curb radii as discussed in Section 3. In this research, the corner radius is a modifiable parameter for smooth transitions between adjacent road edges. Fig. 13illustrates the generation of edge curve between two adjacent intersection legs. P1 and P2 are two edge points of two adjacent intersection legs and P0 is the midpoint of the line segment P1P2. Line segments L1 and L2 are perpendicular to their corresponding edges at P1 and P2 respectively and intersect with the line segment L3, which is perpendicular to the line segment P1P2 at P0.The magnitudes of L1 and L2 are about 10m and the longer one of L1 and L2 is used as the radius and its intersection with L3 is used as the center. With this result, a circular curve is produced between P1 and P2 eventually. In Fig. 13, α is the angle between line segment P1P2 and L1, β the angle between line segment P1P2 and L2, θ the angle between two road edges. All these angles are calculated and used to determine the radius and center point.After the outline of the road intersection is determined, the surface of the road intersection is triangulated to represent the intersection surface with triangles. Examples of the geometry generated for such intersections are shown in Fig. 14.As discussed before, two models are provided for merging/diverging intersection design: parallel design and tapered design [1]. The parallel design includes additional auxiliary lanes in the merged legs and the tapered design only includes a short taper for fast merging/diverging. Fig. 15shows the results for each kind of merging/diverging intersection designs.Geometric modeling of the road network only generates the geometry of the roadways. To satisfy the needs in high fidelity simulations, the visual aspects of the roadways must be generated as well. Road surfaces contain different types of pavements such as asphalt and concrete. Several methods are used to render the road surface (pavements), including texture mapping, normal mapping, and pixel shaders.

@&#CONCLUSIONS@&#
