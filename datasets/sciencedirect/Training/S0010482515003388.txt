@&#MAIN-TITLE@&#
Image segmentation and registration algorithm to collect thoracic skeleton semilandmarks for characterization of age and sex-based thoracic morphology variation

@&#HIGHLIGHTS@&#
Thoracic skeleton semilandmarks from 343 males and females (ages 0–100) were collected.A segmentation and registration algorithm was developed for collecting semilandmarks.Between 2700 and 11,000 semilandmarks were collected from each rib and sternum.Over 55 million rib and sternum semilandmarks were collected across all subjects.The semilandmarks will be used to characterize thoracic morphology by age and sex.

@&#KEYPHRASES@&#
Anthropometry,Computed tomography,Medical imaging,Morphology,Registration,Segmentation,Ribs,Sternum,

@&#ABSTRACT@&#
Thoracic anthropometry variations with age and sex have been reported and likely relate to thoracic injury risk and outcome. The objective of this study was to collect a large volume of homologous semilandmark data from the thoracic skeleton for the purpose of quantifying thoracic morphology variations for males and females of ages 0–100 years. A semi-automated image segmentation and registration algorithm was applied to collect homologous thoracic skeleton semilandmarks from 343 normal computed tomography (CT) scans. Rigid, affine, and symmetric diffeomorphic transformations were used to register semilandmarks from an atlas to homologous locations in the subject-specific coordinate system. Homologous semilandmarks were successfully collected from 92% (7077) of the ribs and 100% (187) of the sternums included in the study. Between 2700 and 11,000 semilandmarks were collected from each rib and sternum and over 55 million total semilandmarks were collected from all subjects. The extensive landmark data collected more fully characterizes thoracic skeleton morphology across ages and sexes. Characterization of thoracic morphology with age and sex may help explain variations in thoracic injury risk and has important implications for vulnerable populations such as pediatrics and the elderly.

@&#INTRODUCTION@&#
Up to 70% of blunt chest trauma is attributed to motor vehicle crashes (MVCs) with another 20% attributed to falls that are common in the elderly population [1–3]. In MVCs, the thorax is the second-most injured body region and thoracic injury ranks second with respect to mortality, the incidence of serious injuries, and overall economic cost [4,5]. Thoracic injuries alone or in combination with injuries to other body regions are the leading cause of death across all ages in MVCs and account for up to 25% of all traumatic deaths [1,2,6].The elderly population aged 65+ years currently constitutes more than 13% of the total United States (US) population and is projected to reach nearly 20% by 2030 due to increases in life expectancy [7–9]. The incidence of thoracic injury is known to increase with age due to age-related decreases in skeletal and physiological resilience [6,10–13]. The morbidity and mortality associated with thoracic injury increases with age and injuries such as rib fractures and pulmonary contusion are more likely to result in pneumonia, acute respiratory distress syndrome, and respiratory failure in the elderly [6,14–21]. Thus, a compounding effect is seen in the elderly due to increased fragility and frailty where there is an increased risk of sustaining a thoracic injury and increased likelihood of death and complications following thoracic injury. Women have also been shown to have a 26% increased risk of sustaining an Abbreviated Injury Scale (AIS) 2+ thoracic injury and 9% increased risk of death from thoracic injury compared to males of the same age [12].Age and sex-related variations in rib cage geometry and mechanics likely relate to thoracic injury risk and outcome. Significant changes in the rib cage geometry with age and sex have previously been reported based off 2D measurements, true anatomical landmarks, and semilandmarks [22–26]. True anatomical landmarks are identifiable points often defined by juxtapositions of tissues (Type I) or maxima of curvature (Type II), while semilandmarks (Type III) are points defined by phrases such as “the most posterior” or points that represent geometric curves or surfaces of anatomical structures of known homology [27]. Gayzik et al. reported age-related shape variation of the thoracic skeleton based on 106 manually collected true anatomical landmarks and semilandmarks from 63 adult males [22]. Gayzik et al.׳s study was limited by the number of landmarks collected, as well as the exclusion of females, pediatrics, and elderly subjects older than 80 years. Kent et al. used a lateral view of a computed tomography (CT) reconstruction to measure the superior-most posterior and anterior rib points and calculate a two-dimensional (2D) rib angle relative to the CT scanner bed in 161 males and females aged 18–89 years [23]. Kent et al.׳s study was limited in that three-dimensional (3D) landmark data was not collected from the ribs or sternum and pediatrics were not included. Sandoz et al. constructed wireframes of 48 pediatric thoracic skeletons (males/females ages 4 months to 15 years) by collecting 50 landmarks from each rib׳s mid-line [24]. Sandoz et al.׳s study was limited to only pediatrics and the landmarks collected were limited in number and did not allow for characterization of the tubular geometry of the ribs or the sternum. Jit et al. measured the length and breadth of 400 adult post-mortem sternums for determination of sex-related differences [25]. Jit et al.׳s study did not characterize rib morphology, age-related changes in the thoracic skeleton, and was limited to 2D measurements. Also, pediatrics were not included and subject selection was skewed since a larger proportion of the post-mortem subjects were elderly. Shi et al. collected 464 rib cage landmarks from 89 adult male and female CT scans [26]. Rib landmarks were defined based on equidistance which is an arbitrary way of distributing semilandmarks that does not necessarily lead to geometric or biological correspondence of the points across specimens [27]. Shi et al.׳s study was also limited in that pediatrics were not included and the sternum was not characterized. Collectively, all of these prior studies were limited in that geometrical changes were quantified using select landmarks or manual measurements, the 3D changes in the rib cage were not fully characterized, and some age groups and specific sexes within these age groups were not represented. Thus, comprehensive 3D characterization of the thoracic skeleton (including the ribs and sternum) in both sexes for ages 0–100 years would add novel data to the literature.Advanced image processing techniques can be applied to CT images to quantify bone morphology. Image segmentation identifies anatomical structures, while image registration aligns anatomical structures from different subjects so that data can be analyzed in a common coordinate system [28–34]. Image registration, which is widely used by the neuroimaging community to identify structural and functional differences in the human brain, is applicable to other anatomy including the skeleton [35]. In a previous conference paper, we outlined image segmentation and registration techniques to collect 100 homologous semilandmarks from a rib [36]. The current study extends this preliminary work to collect thousands of homologous semilandmarks from the ribs and sternum of 343 subjects, providing technical details on the software and techniques used for data collection and analysis.The objective in the current study was to collect thoracic skeleton semilandmarks to fully quantify 3D thoracic morphology variations for both sexes and across the entire age spectrum (ages 0–100). This goal was accomplished using a semi-automated image segmentation and registration algorithm to collect over 100,000 homologous semilandmarks from each subject׳s thoracic skeleton. The number of semilandmarks collected from each subject was necessary for future use in morphometric analyses to quantify local shape variation of the thoracic skeleton at a very high resolution for various ages and sexes. The resulting semilandmark locations (defining thoracic skeleton shape) determined by the morphometric analysis for a specific age and sex will be used to define node locations for age and sex-specific detailed finite element (FE) models of the thorax. These FE models have thousands of nodes per bony structure, further justifying the need for high resolution landmark data.Homologous semilandmarks in comparable locations on each subject were collected from the thoracic skeleton. Semilandmarks are points that represent geometric curves or surfaces of anatomical structures of known homology [27]. In contrast to true anatomical landmarks which are limited in quantity [37], many semilandmarks could be collected to characterize thoracic skeletal morphology at a very detailed level. The methodology to collect homologous semilandmarks included: (1) Collection of normal medical images, (2) Image segmentation, (3) Atlas development, (4) Image registration, and (5) Deviation analysis.CT is a medical image modality known for optimal visualization of the 3D morphology of bone in live human subjects. For this study, existing supine chest CT scans of subjects with normal thoracic skeleton anatomy were collected from the radiological database at Wake Forest University Baptist Medical Center (Fig. 1). The collected scans were de-identified to protect patient confidentiality and Institutional Review Board approval was obtained for the study. A musculoskeletal radiologist was consulted to identify exclusion criteria and ensure that only CT scans of normal thoracic skeleton anatomy were collected. Exclusion criteria included, but were not limited to: congenital abnormalities, infections, fractures, and cancers of the ribs and sternum, scoliosis, kyphosis, sternotomy, thoracotomy, and osteopenia or osteoporosis present in individuals younger than 50. Patient medical records including radiology reports were reviewed and CT scans were visually inspected to determine if the subject met the inclusion criteria of normal thoracic skeleton anatomy. CT scans with a smaller slice thickness (nearer to 0.625mm) and those that captured the full geometry of the 24 ribs and the sternum were prioritized when selecting scans for inclusion. A minimum of 10 male and 10 female CT scans were collected for each of the following age groups: 0–3 months, 3–6 months, 6–9 months, 9–12 months, 1–3 years, 3–6 years, 6–10 years, and 10–100 year olds by decade (i.e. 10–20 years, 20–30 years, etc.). These sample sizes are comparable to sample sizes used in other shape analysis studies that obtained statistically significant results [22,38–41].The thoracic skeleton is composed of 24 ribs (arranged in 12 pairs), the sternum, costal cartilage, and the thoracic spine (Fig. 2A). The superior-most seven sets of ribs are known as "true ribs" that are directly attached to the sternum through the costal cartilage. The five sets of ribs in the inferior-most portion of the rib cage are known as "false ribs". The eighth through tenth ribs connect to the sternum via shared costal cartilage, while the eleventh and twelfth ribs are known as "floating ribs" and are not connected to the sternum. In this study, the 24 ribs and sternum were segmented from each subject׳s CT scan using a semi-automated method. Segmentation was performed using Mimics (Materialise, Plymouth, MI) or 3D Slicer (3D Slicer, Version 3.6, www.slicer.org, Boston, MA) software. A bone threshold of 180–225 Hounsfield Units (HU) was applied using visual inspection of the scan to select a threshold that captured the majority of the bone without overestimating the external surface. Automated region growing was applied by manually selecting a seed point on each rib. The segmentation masks were then manually edited to ensure the entire external surface of the rib or sternum was selected and surrounding soft tissue was excluded. Calcified costal cartilage was excluded when present and a semi-automated hole-filling operation was used to enclose the rib and sternum interior. The xiphoid process was excluded from the sternum segmentation and will be characterized in a separate analysis due to widespread population variability in the morphology and development of the xiphoid [42,43]. Segmentations of the ribs and sternum of each subject were completed in one to five hours depending on the subject size, bone density, and other factors. Results of the segmentation include binary images (masks) of the ribs and sternum on the 2D CT slices. The segmentation masks were converted to 3D triangulated surface models using the “optimal setting” for triangle reduction and smoothing within Mimics and triangulated surface models of each segmented rib and sternum were output (Fig. 2B).Rib and sternum atlases were developed from existing computer aided design (CAD) geometry of a 50th percentile male thorax [44]. This study built upon the previous work by (1) converting the CAD models to triangulated surfaces and binary images for use as an atlas in image registration, and (2) placing a high resolution point cloud of semilandmarks on the external CAD surface so that homologous semilandmarks could be collected as a result of image registration. The CAD geometry was selected as the atlas because it was an existing, smoothed geometry that could be used for the normalization of every subject, regardless of age and sex (Fig. 2A). In this study, the term “atlas” describes a single subject template of rib and sternum geometries created from a male subject of average size that are in a standard 3D coordinate system. An atlas was created for the sternum (consisting of the manubrium and sternal body only) and each rib through conversion to both a triangulated surface model using Geomagic Studio (version 2012, Geomagic, Inc., Morrisville, NC) and a stack of binary images using Amira software (FEI, Hillsboro, Oregon). The resolution of the binary images was defined as 0.98mm pixel spacing and 0.63mm slice thickness, which was comparable to the resolution of the subject CT scans. The surface area of each triangulated surface model was divided by the surface area of an equilateral triangle with 1.7mm sides (1.25mm2) to calculate a target number of semilandmarks for the atlas model of each rib and the sternum (Fig. 3). The semilandmarks were placed using uniform sampling on each atlas rib/sternum within Geomagic Studio. The triangulated surface was converted to a point cloud by removing the triangular faces and preserving the underlying triangular vertices. After specifying the targeted number of points, this point cloud was then reduced uniformly by subdividing the point cloud into equally sized cubical cells and deleting all but one point from each cell. In this way, the resulting uniformly sampled point cloud was composed of a subsample of points corresponding to triangular vertices of the original triangulated surface. In specifying a targeted number of points, a spacing parameter “r” was computed that represents the minimum targeted distance between adjacent points. A sphere was fit to every three adjacent points in the point cloud while performing the uniform sampling, such that flat regions would be fitted with a sphere that maintained a radius equivalent to “r” and high curvature regions would be fitted with a sphere with a radius lower than “r”. Curvature was preserved by retaining points in regions where the fitted sphere had radii reductions of 30% or less of the original “r”. This resulted in 100,805 total semilandmarks, with 2769–10,904 semilandmarks per structure (Fig. 3), which visibly characterizes the structure׳s shape more fully than previous analyses collecting only 100 semilandmarks per structure [36] (Fig. 4). The atlases and the semilandmarks were symmetric about the median plane (i.e. mid-sagittal plane of the human body) to allow for quantification of rib and sternum asymmetry in the study subjects.Image registration uses normalization techniques to find the optimal transformation to map different sets of image data to a single coordinate system. Primary components of image registration are a transformation model (linear, elastic, diffeomorphic, etc), a similarity (or correspondence) measure, and an optimization strategy.A semi-automated image registration algorithm was applied to collect homologous semilandmarks from the rib and sternum segmentations. For every subject, each subject׳s segmented rib and sternum was registered with the corresponding rib or sternum in the atlas (i.e. the sternum of each subject is registered with the atlas sternum). The registration algorithm uses a series of rigid, affine, and nonlinear transformations to morph the atlas and the point cloud of atlas semilandmarks to the rib or sternum of each subject (Fig. 5).First, a rigid transform consisting of translation and rotation operations was computed and applied to the atlas triangulated surface using 3D Slicer to roughly align the atlas to the subject (Fig. 5B). Rigid transformation was necessary as initial alignment of the atlas and subject is a precursor to the subsequent affine registration [45]. Three points were manually selected on the posterior, lateral, and anterior aspects of the triangulated surfaces of the atlas and the subject ribs to derive the rigid transformation for the rib registrations. The following three points were manually selected on the triangulated surfaces of the atlas and subject sternums to derive the rigid transformation for the sternum registrations: superior and inferior aspects of the manubrium and the inferior aspect of the sternal body.Following rigid registration of the atlas rib/sternum to the subject rib/sternum, an affine transform consisting of translation, rotation, and scaling operations was computed using the iterative closest point (ICP) algorithm and applied to the point clouds formed from the triangulated surface vertices of the atlas and subject (Fig. 5C) [45]. Affine registration with the ICP algorithm was performed using 3D Slicer or custom Matlab code (The MathWorks, Inc., Natick, MA). The ICP algorithm is a standard method of affine registration that was applied in this study to register the respective atlas rib or sternum to each subject rib or sternum, as a precursor to nonlinear registration.The linear 4×4 transformation matrices output from the rigid and affine registration were applied in sequence to the atlas binary images using the “Harden Transforms” feature within 3D Slicer. This feature resamples the binary images through application of a linear transform. These atlas binary images that were affine registered to the subject were used as an input to the nonlinear registration which was performed using the Advanced Normalization Tools (ANTS) software (Penn Image Computing and Science Laboratory, University of Pennsylvania, PA) [46]. Symmetric diffeomorphic registrations were performed that produce differentiable and invertible maps with a differentiable inverse, capturing both large and small deformations [29]. The symmetric image normalization transformation model (SyN) was used for maximizing cross-correlation between the atlas and subject images that were registered [31]. Cross-correlation was used as the similarity measure for the algorithm to quantify the correspondence between the two registered images [29]. Although cross correlation was used in this study, other similarity measures such as mean square difference could also be used to achieve comparable results when registering binary images. Custom Matlab code that calls the ANTs registration algorithm was used to batch the process of applying the series of registration transformations to morph the atlas images to the subject images. The quality of the registered images was visually inspected by overlaying the registered atlas images on the subject images using MRIcron software (Neuroimaging Informatics Tools and Resources Clearinghouse, Washington, DC). Low quality registrations identified by visual inspection included those where structural regions did not overlap between the registered atlas and the subject. The anterior and posterior ends of the ribs were the most common regions that did not overlap in the low quality registrations. Only high quality registrations where there were no major structural regions that did not overlap based on visual inspection were included in the analysis.After the atlas image was registered to the subject image, custom Matlab code was used to apply the rigid, affine, and symmetric diffeomorphic registration transforms to morph the point cloud of semilandmarks on the atlas structure to the subject structure. By applying all steps of the registration algorithm, the semilandmarks on each atlas are transformed to homologous locations in the subject-specific coordinate system of the CT scan (Fig. 5). Effectively, this image registration algorithm allows for the collection of homologous rib and sternum semilandmarks across subjects of all ages and sexes.To assess the quality and robustness of the registration algorithm, point-to-surface distances termed “deviations” were computed between the atlas semilandmarks transformed to each subject structure (rib or sternum) and the triangulated surface model of that structure. Signed distances (positive versus negative) were computed for the deviations, along with the absolute distance. On a per-subject level, the signed distances were examined, while the absolute distances were analyzed on an aggregate level. Deviations were computed using Geomagic Qualify software (version 2012, Geomagic, Inc., Morrisville, NC). Outputs of the deviation analysis included quantitative and visual summaries of the deviations to provide a quality check of the homologous semilandmarks collected for each subject. Correct registrations would ideally result in homologous semilandmarks that lie directly on the subject׳s triangulated surface model. Sub-analyses focused on the percentage of deviations exceeding 1.5mm on each structure, as deviations within this range are to be expected following registration given the scan resolution.

@&#CONCLUSIONS@&#
A semi-automated segmentation and registration algorithm was applied to collect homologous semilandmarks from the thoracic skeleton of 343 normal CT scans. Rigid, affine, and symmetric diffeomorphic transformations were used in the algorithm to morph a point cloud of semilandmarks from an atlas to homologous locations in the subject-specific coordinate system. The efficiency and efficacy of the algorithm allowed for the collection of between 2700 and 11,000 semilandmarks from each rib and sternum. Homologous semilandmarks were successfully collected from 92% (7077) of the ribs and 100% (187) of the sternums included in the study. Over 55 million homologous semilandmarks were collected from males and females ranging in age from 0 to 100 years. The extensive amount of data collected supplements existing data in the literature and has been used in recent studies to more fully characterize thoracic skeleton morphology across ages and sexes by performing a Generalized Procrustes Analysis to formulate age and sex-specific shape and size variation functions of the thoracic skeleton. These functions could be used to create age and sex-specific parametric FE thoracic models to evaluate vehicle crashworthiness or explain variations in thoracic injury patterns due to MVCs or falls [57]. The algorithm and the landmark data can be broadly applied to traumatic injury prediction, surgical simulation and planning, orthotic brace fitting, and advancement of diagnostics for scoliosis, kyphosis, lordosis, and congenital thoracic skeleton defects.None declared.