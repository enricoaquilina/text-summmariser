@&#MAIN-TITLE@&#
A moment-matching method to generate arbitrage-free scenarios

@&#HIGHLIGHTS@&#
The monomial method is applied to build a scenario generator for financial assets.The scenario generator belongs to the class of the moment-matching methods.The marginal moments up to the fourth order and correlations are matched.The generated scenarios satisfy the no-arbitrage condition.Accuracy and efficiency analysis is carried out when solving financial problems.

@&#KEYPHRASES@&#
Scenarios,Monomial method,Moment-matching,

@&#ABSTRACT@&#
We propose a new moment-matching method to build scenario trees that rule out arbitrage opportunities when describing the dynamics of financial assets. The proposed scenario generator is based on the monomial method, a technique to solve systems of algebraic equations. Extensive numerical experiments show the accuracy and efficiency of the proposed moment-matching method when solving financial problems in complete and incomplete markets.

@&#INTRODUCTION@&#
Starting from the seminal paper of Bradley and Crane (1972), stochastic programming has been widely used for dealing with financial problems as in Kusy and Ziemba (1986), Dantzig and Infanger (1993), Zenios (1993), Cariño et al. (1994), Golub, Holmer, McKendall, Pohlman, and Zenios (1995), Gondzio and Kouwenberg (2001), and Geyer and Ziemba (2008), where the asset price uncertainty is described by a scenario tree. During the last decades, reliable scenario generators have been proposed to make the mathematical problem computationally tractable. A comprehensive overview of such methods is reported in Dupačová, Consigli, and Wallace (2000), and more shortly in Kaut and Wallace (2007).A simple way to generate scenarios is to sample from a probability distribution that describes the randomness of the problem. Generally, a large number of scenarios is needed to capture the assumed distribution accurately but, to make the mathematical problem tractable without compromising the approximation accuracy, reduction methods are usually applied. Such methods aim at finding a subset of scenarios that, in terms of some probability metrics, have discrete distribution as close as possible to the initial randomness distribution (see, for instance, Dupačová, Gröwe-Kuska, and Römisch (2003), Heitsch and Römisch (2003), Pflug (2001)). Internal sampling methods, which sample scenarios directly during the solution procedure without starting from a pre-generated scenario tree, may also be applied. Applications of such methods may be found in Dantzig and Infanger (1991), and Infanger (1992), while Dempster and Thompson (1999) use the expected value of perfect information (EVPI) for adding and removing scenarios.Moment-matching methods fix the number of scenarios and generate an approximating discrete distribution matching the specified statistical properties. In this context, Høyland and Wallace (2001) propose a non-convex programming problem where the decision variables are the outcomes of the discrete distributions and their probabilities, while the objective function is a L2-distance between the target moments and the approximating discrete distribution moments. Høyland, Kaut, and Wallace (2003) propose, instead, an iterative procedure based on two transformations to correct the marginal moments and correlations, respectively. This method has the remarkable feature to be very fast, even when a consistent number of random variables has to be generated. Despite some criticisms (see Hochreiter and Pflug (2007)), moment-matching methods are suitable to describe the uncertainty affecting a given financial problem. Indeed, Kaut, Vladimirou, Wallace, and Zenios (2007) carry out a stability analysis for a portfolio management model, and show how the scenario generation procedure does not bias the results of the mathematical problem. A condition, which cannot be set aside when generating scenarios, is the absence of arbitrages. This requirement could be included in the moment-matching method of Høyland and Wallace (2001) and an example is given in Kouwenberg and Vorst (1998), who propose a stochastic programming approach as a planning tool to limit the downside risk of an asset portfolio. The consequences of the presence of arbitrage opportunities in the generated scenarios have been studied by Klaassen (1997), who considers a simple multi-period asset/liability management problem and shows how arbitrage opportunities may lead to substantial and unrealistic biases in the optimal solution. Such biases are present even when an investor cannot exploit arbitrage opportunities directly because of market imperfections and trading restrictions. In Klaassen (1998), it is proposed a scenario generator capable of aggregating nodes and stages in order to make the final scenario tree arbitrage-free and consistent with market prices. It is worth noting that this method operates under the risk-neutral probability measure and, consequently, it is suitable for pricing purposes but useless for optimization where scenarios under the physical (or real-world) measure are required. The application of the Klaassen (1998) method to a simple portfolio selection model is studied in Geyer, Hanke, and Weissensteiner (2010), who show how the state aggregation leads to an incorrect representation of the real return distribution and, consequently, to a wrong selection of the portfolio weights. Geyer et al. (2010) also show how arbitrage opportunities may arise with the scenario reduction method of Pflug (2001). They conclude that a viable alternative for building scenario trees with an acceptable size is to use a moment-matching method, and choose a branching factor that excludes arbitrage opportunities. In a recent study, Geyer, Hanke, and Weissensteiner (2014) analyze the presence of arbitrages when generating scenarios and identify three regions where arbitrages never exist, may occur, and always exist, respectively. Their analysis is crucial when evaluating the opportunity of considering the no-arbitrage condition in the generation model because, when falling in the region where arbitrages never exist, it is redundant while it is useful when arbitrages may occur. Concerning the last region where arbitrages always exist, they highlight that any scenario generator including the no-arbitrage condition would fail. Consiglio, Carollo, and Zenios (2014) develop a global optimization model to generate moment-matching and arbitrage free scenario trees for an arbitrary number of assets or general risky factors. In this context, analysis under complete or incomplete markets may be carried out since a complete market may be obtained by considering a number of scenarios equal to the number of assets plus one, while for a greater number of scenarios the market is incomplete.To build scenario trees that rule out arbitrage opportunities, in this paper we propose a new moment-matching method embedding the no-arbitrage condition during the scenario generation. This last aspect makes the proposed method really appealing in that checking the no-arbitrage condition after the generation is no more necessary since arbitrages are already ruled out. The proposed model is based on the monomial method, which is useful to solve systems of algebraic equations (see Burns and Locascio (1991)). The motivation of this choice relies on the no-arbitrage condition that may be expressed in terms of an algebraic equation. The monomial method solves a system of non-linear algebraic equations iteratively by constructing, at each iteration, an approximating monomial system and making this approximation linear by a logarithmic transformation of the variables. Consequently, it can be considered an alternative linearization scheme but, at the same time, superior in terms of performance (see Burns (1994b)) with respect to the Newton’s method due to its invariance properties. The result is a method that is accurate, efficient and flexible because it may be easily applicable to solve financial problems both in complete and incomplete markets.To present the model, we organize the paper as follows. In Section 2, we define a non-linear system in order to obtain scenarios of financial returns that match some statistical properties and rule out arbitrage opportunities. In Section 3, we show the application of the monomial method to solve the non-linear system defined in Section 2. In Section 4, we present some numerical results where we show the ability of the monomial method to match the specified statistical properties and rule out arbitrages even when considering the smallest number of scenarios. The performance of the new scenario generator is also analyzed when applied to portfolio selection using the CVaR as the risk-measure, and option pricing both in complete and incomplete markets. Finally, Section 5 concludes the paper.A scenario tree representation is a useful tool to describe the uncertainty affecting financial problems. Fig. 1shows a graphical representation of a non-recombinant scenario tree. There are five stages, t0,…, t4, where decisions are taken, and at each stage we have a finite number of nodes or realizations of input data. For instance, at stage t2, setNt2is made up by only four nodes. The tree is non-recombinant and each node, except the root node at stage t0, is preceded by just one node. When we reach a node, we obtain information about input data of the mathematical problem and, at the next stage, we may reach a finite number of child nodes linked to the starting node by arcs. Each arc emanating from a node is associated with a probability, and each child node represents a possible realization of the input data at the next stage. The non-recombinant property of the tree implies that a node can be preceded by only one parent node. Only the root node at stage t0 does not have any parent, and it is the predecessor of all the other nodes.To build a scenario tree, we follow a sequential approach.22Another possibility is to apply a parallel approach. In Gülpınar, Rustem, and Settergren (2004), an analysis on the differences between the two approaches and hints on their implementation are reported.In detail, we start from the root node at stage t0 and generate a discrete distribution that, from a graphical point of view, is identified by the child nodes. Then, for each node at stage t1, we generate a new discrete distribution through the child nodes, and so on. To generate the child nodes, we formulate a non-linear system that has to guarantee the moment-matching and satisfy the no-arbitrage condition because we work with financial assets. It is worth observing that the satisfaction of the no-arbitrage condition in all the sub-trees, made up by a parent node and its child nodes, guarantees the absence of arbitrages on the entire scenario tree.The choice of the number of realizations, that is the number of child nodes branching off from a parent node, is usually left to the decision maker and there is no general rule to be followed in order to obtain an optimal choice. In general, the number of realizations is a compromise between approximation accuracy and computational tractability.To present our model, we consider the financial return vector of I risky assets, X = {X1, X2, … , XI}, as the input data of the mathematical problem. By considering L possible scenarios each one with occurrence probabilitypl,l=1,…,L,the discrete distribution of X has to match each mean θi, standard deviation σi, skewness δi, kurtosis κi, and correlation ρij(where i, j = 1, … , I, with i ≠ j), of the supposed randomness distribution. This is obtained by imposing the following conditions:(1){∑l=1Lxi,lpl=θi,i=1,…,I,∑l=1L(xi,l−θi)2pl=σi2,i=1,…,I,∑l=1L(xi,l−θi)3pl=δiσi3,i=1,…,I,∑l=1L(xi,l−θi)4pl=κiσi4,i=1,…,I,∑l=1L(xi,l−θi)(xj,l−θj)pl=ρi,jσiσj,i=1,…,I−1,j=i+1,…,I,∑l=1Lpl=1,where xi, lis the return of the ith risky asset in the lth scenario. In the present form, the formulation of the problem does not assure the absence of arbitrage opportunities that is a fundamental assumption in financial markets. As mentioned in Klaassen (2002), the no-arbitrage condition is satisfied if there exists positive values vl, l = 1, … , L, that solve the following set of equations:(2)(1+xi,1)v1+(1+xi,2)v2+⋯+(1+xi,L)vL=1,i=1,…,I,to which we have to add the following condition:(3)(1+x0)v1+(1+x0)v2+⋯+(1+x0)vL=1,whenever, as usual in financial literature, the market allows investments in a risk-free asset with return x0. Conditions (2)–(3) identify an arbitrage-free market where a risk-neutral probability measure exists according to the first fundamental theorem of asset pricing. Indeed, choosing the risk-free asset as the numeraire, a risk-neutral probability ql, l = 1, ..., L is given by33It is easy to show by simple algebra that risk-neutral probability (4) assures that each discounted asset price is a martingale.(4)ql=(1+x0)vl.At this point, we apply the monomial method that is useful when solving systems of algebraic equations for positive variables. Unfortunately, the variables considered in non-linear system (1) are not always positive and, consequently, the monomial method may not be straightforwardly applied. To overcome this obstacle and avoid scale problems at the same time, we build the discrete distribution of the variables in the set Z = {Z1, Z2, … , ZI}, whereZi=Xi−θiσi+C,i=1,…,I,and C is a constant big enough to make Zipositive. Hence, we can easily compute the first four momentsμi(k)=E[Zik],k = 1, … , 4, and the joint momentsμi,j=E[ZiZj],i, j = 1, … , I, with i ≠ j, to properly take into account the correlations among financial returns. Obviously, we haveμi(1)=Candμi(2)=1+C2for each variable. Denoting by zi, lthe realization of variable Ziin scenario l, with l = 1, … , L, and i = 1, … , I, we can easily compute the corresponding realization of asset return Xias(5)xi,l=θi+σi(zi,l−C).Consequently, the moments are matched if the following two sets of equations are satisfied:1.the first set guarantees the matching of the first four moments:zi,1kp1+zi,2kp2+⋯+zi,LkpL=μi(k),where i = 1, … , I, and k = 1, … , 4;the second set guarantees the matching of the joint moments:zi,1zj,1p1+zi,2zj,2p2+⋯+zi,Lzj,LpL=μi,j,where i = 1, … , I − 1, and j = i + 1, … , I.The no-arbitrage condition is simply obtained by substituting (5) in (2). Finally, introducing an additional constraint on the probability sum that must be equal to one, we have to solve the following non-linear system for zi, l, vl, and pl:(6){∑l=1Lzi,lkpl=μi(k),i=1,…,I,k=1,…,4,∑l=1Lzi,lzj,lpl=μi,j,i=1,…,I−1,j=i+1,…,I,∑l=1L(1+θi+σi(zi,l−C))vl=1,i=1,…,I,∑l=1Lpl=1.After solving non-linear system (6), the realizations of Xiare given by xi, l= θi+ σi(zi, l− C), l = 1, … , L, and their discrete distribution by {(xi, l, pl), l = 1, … , L}. Whenever the market model allows investments in a risk-free asset, additional equation(7)∑l=1L(1+x0)vl=1,must be added to (6).The monomial method is an iterative procedure that allows to solve systems of algebraic equations characterized by positive variables. Each iteration consists in a monomial approximation of the non-linear system, followed by a linearization of the obtained approximated system. The monomial approximation is based on a process called condensation, arising from the inequality between the arithmetic and geometric average as specified hereafter. Indeed, the left-hand side of each equation in system (6) can be seen as an arithmetic average that can be approximated by the corresponding geometric average. The origin of the condensation technique dates back to the late 1960s and early 1970s, when it has been used as a non-linear programming tool (see, for instance, Duffin (1970)). Then, in Rijckaert and Martens (1976), it has been adopted for the first time to solve a system of non-linear equations.The monomial method, as implemented in this paper, is mainly based on the works of Burns (1994a), (1994b). Postponing to Section 4 the finding of an initial point, here we show a generic iteration. Let us assume that the current solution of (6) is given byz^i,l,v^landp^l,and approximate the left-hand side of each equation with a monomial term as follows:1.set of equations∑l=1Lzi,lkpl=μi(k),i=1,…,I,k=1,…,4,is substituted with∏l=1L(zi,lkplωk,l(i))ωk,l(i)=μi(k),whereωk,l(i)=z^i,lkp^l∑h=1Lz^i,hkp^h,l=1,…,L,with i = 1, … , I, and k = 1, … , 4;set of equations∑l=1Lzi,lzj,lpl=μi,j,i=1,…,I−1,j=i+1,…,I,is substituted with∏l=1L(zi,lzj,lplωl(i,j))ωl(i,j)=μi,j,whereωl(i,j)=z^i,lz^j,lp^l∑h=1Lz^i,hz^j,hp^h,l=1,…,L,with i = 1, … , I − 1, and j = i + 1, … , I;set of equations∑l=1L(1+θi+σi(zi,l−C))vl=1,i=1,…,I,is substituted with[∏l=1L(σizi,lvlϕl(i))ϕl(i)][∏l=1L((1+θi−σiC)vlψl(i))ψl(i)]=1,whereϕl(i)=σiz^i,lv^l∑h=1L(1+θi+σi(z^i,h−C))v^h,l=1,…,L,ψl(i)=(1+θi−σiC)v^l∑h=1L(1+θi+σi(z^i,h−C))v^h,l=1,…,L,with i = 1, … , I;and, finally, equation∑l=1Lpl=1,is substituted with∏l=1L(plλl)λl=1,whereλl=p^l∑h=1Lp^h,l=1,…,L.Whenever Eq. (7) is present in the non-linear system (6), it can be approximated by(8)∏l=1L(vlξl)ξl=11+x0,whereξl=v^l∑h=1Lv^h.Consequently, non-linear system (6) results into(9){∏l=1L(zi,lkplωk,l(i))ωk,l(i)=μi(k),i=1,…,I,k=1,…,4,∏l=1L(zi,lzj,lplωl(i,j))ωl(i,j)=μi,j,i=1,…,I−1,j=i+1,…,I,[∏l=1L(σizi,lvlϕl(i))ϕl(i)][∏l=1L((1+θi−σiC)vlψl(i))ψl(i)]=1,i=1,…,I,∏l=1L(plλl)λl=1.If the risk-free asset is present in the market, Eq. (8) is added to system (9). Then, we define the log-variablesΔyi,l=log(zi,lz^i,l),Δsl=log(vlv^l),andΔql=log(plp^l),where i = 1, … , I, and l = 1, … , L, and by substitutingz^i,leΔyi,lfor zi, l,v^leΔslfor vlandp^leΔqlfor plin system (9), and applying the logarithmic function to both sides of each equation, we obtain the following linear system:(10){∑l=1Lωk,l(i)(kΔyi,l+Δql)=log(μi(k)∑l=1Lz^i,lkp^l),i=1,…,I,k=1,…,4,∑l=1Lωl(i,j)(Δyi,l+Δyj,l+Δql)=log(μi,j∑l=1Lz^i,lz^j,lp^l),i=1,…,I−1,j=i+1,…,I,∑l=1L[ϕl(i)Δyi,l+(ϕl(i)+ψl(i))Δsl]=log(1∑l=1L(1+θi+σi(z^i,l−C))v^l),i=1,…,I,∑l=1LλlΔql=log(1∑l=1Lp^l).The presence of the risk-free asset requires the further equation∑l=1LξlΔsl=log(1∑l=1L(1+x0)v^l),in linear system (10). After solving linear system (10), a new solution to system (6) is simply given byz¯i,l=z^i,leΔyi,l,v¯l=v^leΔslandp¯l=p^leΔql. To sum up, the monomial algorithm can be stated as follows:1.select an initial starting solutionz^i,l,v^landp^l(in Section 4, we explain a possible way to find an initial starting point);compute the weightsωk,l(i),ωl(i,j),ϕl(i),ψl(i),and λl. In presence of the risk-free asset, compute also ξl;solve linear system (10) with respect to the variables Δyi, l, Δsland Δql;Calculate the new solutionz¯i,l=z^i,leΔyi,l,v¯l=v^leΔslandp¯l=p^leΔql;check the convergence, e.g. ‖[Δy1, … , ΔyI, Δs, Δq]‖ < tol,44Given the vectors a1, … , an, the notation ‖[a1, … , an]‖ denotes the Euclidean norm of a new vector a that includes all the elements of the vectors a1, … , an. For example, if the vectors a1, … , anhave the same size L, then the vector a has size n · L.whereΔyi=[Δyi,1,…,Δyi,L],i=1,…,I,Δs=[Δs1,…,ΔsL],Δq=[Δq1,…,ΔqL],andtol represents a tolerance level chosen exogenously. If the convergence criterion is satisfied,z¯i,l,v¯landp¯lrepresent the problem solution. Otherwise, setz^i,l=z¯i,l,v^l=v¯landp^l=p¯l,and go to step 2.In this section, we present some numerical results that show how the monomial method can be used for generating scenarios of financial assets.The data set consists in daily asset returns of 20 Exchange-Trade Funds (ETF) traded in the US market observed from February 3, 2014 to February 2, 2015. The total number of daily asset returns is 251, and Table 1 displays the main statistical properties. Starting from such data, under the assumption of independent daily returns, we may easily obtain the statistical properties relative to different time scales. Denoting by μd, σd, δd, κd, and ρdthe first four daily statistics and correlations, respectively, and considering 20 days in a month, m-days (20-days represent one-month and so on) returns statistics may be computed as:μm=mμd;σm=mσd;δm=δdm;κm=3m−1m+κdm;ρm=ρd.All the numerical results have been generated by implementing the monomial algorithm on an Intel Core i5-650 3.20 gigahertz machine, 6 gigabytes RAM DDR3, running Ubuntu 10.10 as operating system.The first analysis we propose is relative to the opportunity of considering the no-arbitrage condition because, as evidenced in Geyer et al. (2014), the arbitrage absence depends on the structure of the variance–covariance matrix. Working on time horizons of length one, two, and three months, our data set admits the possibility of arbitrages because we fall in the region identified by Geyer et al. (2014) where arbitrages may occur. In Table 2, we report the percentage of arbitrage-free markets when applying the Høyland et al. (2003) (HKW) model that does not embed the no-arbitrage condition. Percentage values are obtained generating 100 markets and assessing the absence of arbitrages by performing the stochastic programming model of King (2002). Arbitrages are present when the problem solution is unbounded. It may be observed that the percentage of arbitrage-free markets declines with respect to the time horizon. For instance, if we consider the data set with 20 assets and decide to generate markets with 200 scenarios, the percentage of arbitrage-free markets are, respectively, 100 percent, 14 percent, and 0 percent. Furthermore, it is hard to obtain arbitrage-free markets with a high number of assets and a number of scenarios near to the minimum allowed, that is, the number of assets plus one. Indeed, with respect to the data set with 20 assets, the percentage of arbitrage-free markets with 25 scenarios has been 0 percent, independently of the time horizon. On the contrary, the application of our monomial method embedding the no-arbitrage condition assures arbitrage-free markets in all the analyzed cases, thus evidencing the fundamental role of the no-arbitrage condition when generating scenarios.A crucial aspect when applying the presented monomial method is the choice of the initial starting point that we obtain following the procedure below, because it allows to replicate the first and the second marginal moments and correlations:Step 1.construct a matrix with dimension I × L by sampling independent random numbers from a normal variate with zero mean and unit variance; on the generic ith row of the matrix, with i = 1, … , I, compute the mean and subtract such mean to each one of its elements. In this way, we obtain a new matrix Y in which each row vector has zero mean;compute the variance–covariance matrix of Y, Φ = YYT/L, and apply the Cholesky decomposition to Φ to obtain the lower triangular matrix E so that Φ = EET. We recall thatΦ≈I,whereIis the identity matrix of dimension I;computeY=E−1Yso thatYYT/L=I;apply the Cholesky decomposition to the correlation matrix Σ, where the generic element on the ith row and on the jth column equals ρij, to obtain the lower triangular matrix F so that Σ = FFT;computeY=FYso thatΣ=YYT/L,and sum the constant C to each element ofYto obtainZ={z^i,l},with i = 1, … , I and l = 1, … , L, as the algorithm starting point.In the selected starting point, we set the values vland plequal to 1/L for l = 1, … , L.Another aspect to take into account when applying the monomial algorithm is the solution of the linear system with more variables than equations. In this case, we use the singular value decomposition for finding the Moore–Penrose pseudoinverse of the coefficient matrix and, then, compute a solution of the linear system through a simple matrix multiplication.In our implementation, we have set C equal to 20 and tol equal to 10−7, obtaining in this way solutions with very small errors. When a solution satisfying the tolerance level tol is found, the monomial algorithm normalizes the probability pl, that is, ifp^lis the probability of the lth scenario in the solution, then we takepl=p^l∑h=1Lp^h,forl=1,…,L,as final probabilities. These adjustments guarantee that the probabilities sum up to one exactly. Similarly, we adjust vland xi, lto be sure that the no-arbitrage condition is completely satisfied. Specifically, ifv^lis the value of the no-arbitrage variable in the lth scenario, in absence of a risk-free asset in the market we setvl=vl^; otherwise,vl=v^l∑h=1L(1+x0)v^h,forl=1,…,L.Then, denoting byx^i,lthe return of the ith asset in the lth scenario, we setxi,l=1+x^i,l∑h=1L(1+x^i,h)vh−1,forl=1,…,L,andi=1,…,I.After these adjustments, a solution can be affected only by a moment error that we evaluate by the average maximum error. For each moment (mean, standard deviation, skewness, kurtosis, and correlation), the latter quantity is obtained by the following step by step procedure:1.compute the absolute value of the difference between the estimated moment and the target moment for each asset, and compute the maximum error as the average of such absolute values;repeat step 1 over 100 different scenario trees;compute the average of the obtained maximum errors.From Table 3 and 4, where we report the average and the standard deviation of the maximum error, respectively, it is worth noting that the method provides moment estimates really close to the target ones, and this aspect assesses its accuracy when applied for moment-matching.To show the convergence and the computational efficiency of the proposed method, we analyze the considered data set under the assumption of complete markets that is the more problematic one since the number of scenarios is equal to the number of assets plus one. Indeed, when the number of scenarios is greater than the number of assets plus one, the method performs fine because there is a greater number of realizations that can be used to describe the marginal moments and correlations. On the other hand, when considering a complete market characterized by few assets, the moment-matching may not be reached because the number of scenarios is limited. This is the reason why in Table 5, where we report the convergence rate when we consider daily and one-month time horizons for different number of assets, we consider a complete market based on at least 7 assets and, consequently, 8 scenarios. To further assess the assertion above, from Table 5 we can observe that increasing the number of assets in the market leads to a greater convergence rate.Finally, from Table 6where we report the computational times when running the monomial method for different number of assets and scenarios, it is worth noting that the proposed method is computationally fast when keeping the number of assets at a reasonable level. Clearly, if we increase substantially the number of assets, the method performs slowly due to the fact that the linear system has to be solved at each iteration.So far, we have shown how the monomial method is able to match some statistical properties and guarantees the absence of arbitrage opportunities. Now, we want to test if the no-arbitrage condition is useful when the risk-measure in portfolio selection is the CVaR. To this aim, we consider the complete data set in Table 1 on a time horizon of 1 year, which presents the “problematic” feature of not ruling out arbitrages when considering up to 1000 scenarios. This aspect is crucial since it motivates the presence of the no-arbitrage condition when generating scenarios. We provide a comparison among the portfolios selected by the proposed monomial method and by the HKW model that does not embed the no-arbitrage condition in their scenario generator. The benchmark is generated under the assumption of normally distributed asset returns because optimal portfolios obtained by minimizing the CVaR coincide with the ones generated by the variance minimization, as it happens in the Markowitz model. In detail, we fix the asset return skewness and kurtosis to 0 and 3, respectively, and build the efficient frontier of the Markowitz model when considering different levels of short-selling, K, fixed at 25 percent, 50 percent, and 100 percent of the total invested amount. Then, for each case, we generate 10 scenario trees with both the monomial and the HKW method to select portfolios by the CVaR model provided hereafter. This analysis is made in order to observe where the selected portfolios are located with respect to the Markowitz frontier.To define the CVaR model, we denote by a1, … , aIthe portfolio weights, and define the loss in scenario l asLl=−∑i=1Iaixi,l,for l = 1, … , L. As reported in Rockafellar and Uryasev (2002), the portfolio model with CVaR as risk-measure may be formulated in scenario form as a linear programming (LP) model:(11)Minimizeζ+11−α∑l=1Lplzl(12)subjectto∑i=1Iai=1,(13)∑i=1Iyi=K(14)zl⩾Ll−ζ,l=1,…,L,(15)zl⩾0,l=1,…,L,(16)yi⩾−aii=1,…,I,(17)yi⩾0i=1…,I.The objective function (11) minimizes the CVaR of the loss distribution; Eq. (12) is just a budget constraint; Eq. (13) and inequalities (16) and (17) constraint the total short-selling to match the given level K; inequalities (14) and (15) model the loss deviation with respect to the variable ζ that is equal to the Value-at-Risk (VaR) of the loss distribution at the optimal solution; finally, α = 0.975 is the CVaR confidence level.In Fig. 2, we evidence how the monomial (Mon.) and the HKW methods behave when selecting portfolios, with respect to the Markowitz efficient frontier (MEF). Increasing the short-selling level, the monomial method provides portfolios near to the minimum variance portfolio and its performance is not influenced by the short-selling level. On the contrary, HKW provides portfolios more and more distant from the minimum variance portfolio nonetheless they have been generated minimizing the CVaR measure. This aspect may describe the effect of the no-arbitrage condition that, when embedded as in the monomial methods, allows to ever obtain an optimal solution near to the theoretical one. As a limiting case, we would like to evidence that, if we allow for unlimited short-selling, the HKW method provides an unbounded solution due to the presence of arbitrages, while the monomial method characterized by the no-arbitrage condition is not affected by such drawback. This aspect evidences how the solution of a CVaR model may lead to more biased solutions when omitting the no-arbitrage condition.In this section, we provide an additional application of the monomial method testing how it performs in option pricing. To do this and provide a comparison with the results reported in Consiglio et al. (2014), we consider a basket option with maturity T = 5 years written on four equally-weighted assets that do not belong to the data set used to assess the accuracy of the monomial method. As in Consiglio et al. (2014), we assume that each asset follows a geometric Brownian motion with drift μ equal to the risk-free rate x0 that we set at zero level, volatilityσ=10percent,20 percent, and 30 percent, and shows correlation ρ = 0.5 with the other assets. The analysis is carried out both in complete and incomplete markets. In the first case, we can obtain the theoretical option price by discounting the expected value of the option payoff under the risk-neutral probability measure. Consequently, we can compute the option price as follows. First, we determine the asset prices at option maturity T coinciding with the final stage of the scenario tree. Then, if T is the number of stages andNTis the set of the final nodes, the price of the ith asset in correspondence of noden∈NTis given byPi,n=Pi,0∏m∈H(n)(1+xi,m),where Pi, 0 is the initial price of the ith asset (we set Pi, 0 = 100 as in Consiglio et al. (2014)),H(n)is the set of nodes in a trajectory from root node to node n, and xi, mis the asset return of the ith asset at nodem∈H(n)(with xi, 0 = 0). Second, we determine the risk-neutral probability for each final noden∈NTasqn=∏m∈H(n)(1+x0)vm,where vmis the positive variable associated with nodem∈H(n)that guarantees the no-arbitrage condition. Finally, we discount the option payoff under the risk-neutral probability measure to obtain the option priceC=(1+x0)−T∑n∈NTqnmax(PnB−K,0),wherePnB=∑i∈IwiPi,n, and K is the strike price.To provide a numerical comparison with Consiglio et al. (2014), option prices are computed by applying their tree structure where the number of stages is 5 and the time horizon of each sub-tree is 1 year. With this aim, in Table 7, we report the prices of basket options computed by the monomial method (Mon.) with strike price ranging from 80 to 120 under the assumption that all the asset returns involved in the option valuation present the same volatility fixed, as already evidenced, at three different levelsσ=10percent,20 percent, and 30 percent. Each price is generated as the average of 20 option prices obtained by building 20 different scenario trees. We also report the option prices computed by the Consiglio et al. (2014) optimization model (Opt.), the benchmark values generated by Monte Carlo simulation (MC) based on 1,000,000 trials drawing from the risk-neutral distribution, and the mean absolute percentage difference (Err.) between the prices from the trees and the benchmark.It is worth noting that the proposed monomial method and the Consiglio et al. (2014) algorithm are comparable in terms of result accuracy and margins of errors with respect to the benchmark. But, while Consiglio et al. (2014) evidence substantial differences in the option price error when varying the option moneyness, the monomial method is not so much influenced by this aspect. Indeed, from the column labeled (Err.) in Table 7, it is evident that (apart few cases) the error ranges from 1 percent to 2 percent, approximatively. The differences in prices with respect to the benchmark values are obviously influenced by the fact that MC approximates with 1,000,000 trials the asset distribution under the Black–Scholes framework, while the monomial method is based on only 55 = 3125 scenarios to capture the first four marginal moments and correlations. In Fig. 3, we also plot the basket option values obtained in the 20 trials of the monomial method versus the MC estimates. Clearly, this analysis is just a way to provide comparisons with the existing method of Consiglio et al. (2014) and the benchmark in order to assess the quality of the scenarios generated by the monomial method, because more suitable methods are available for option pricing under the Black–Scholes framework.To provide an analysis of option pricing in incomplete market, we fix the volatility level at 10 percent and compute the bid and ask basket option prices evidencing the bid-ask spread for different strike prices, as reported in Table 8and showed in Fig. 4. Each price is again generated as the average of 20 option prices obtained by building 20 different scenario trees with the proposed monomial method. Incomplete markets are generated by considering a greater number of risky factors with respect to the available assets used to hedge them. Consequently, we assume that there exists a non-traded asset and apply the super-replicating strategy as suggested by King (2002) to compute the bid and ask prices. This analysis further supports the consistency of the method because as expected, in all the examined cases, the complete market price is greater than the bid and smaller than the ask basket option price in incomplete markets. In addition, both prices present the nice feature of being characterized by a small standard deviation.

@&#CONCLUSIONS@&#
In this article, we have presented a new scenario generator that allows to match correlations and marginal moments up to the fourth order. The building of this generator is based on the monomial method, a technique to solve systems of algebraic equations.Two are the valuable features of the proposed moment-matching method. The first one is its capability of generating scenario trees with a small branching factor, and this makes the method valuable for multi-stage programming models. The second one is the possibility of ruling out arbitrages from the generated scenarios, and this aspect allows to obtain results unaffected by the presence of arbitrages in the financial market.It is not too hard to extend the method to include more cross and marginal moments in the generation of scenarios, even though the computational times might increase significantly.Extensive numerical experiments, in which we apply the monomial method to solve financial problems like portfolio selection or option pricing, confirm its quality in terms of accuracy and computational feasibility. These applications evidence that the proposed method is also useful from a managerial point of view, for instance, to hedge derivatives or investment funds. Further developments of the proposed method may be addressed to capture more accurately the dependence structure of financial assets embedding copula functions within our operative framework.