@&#MAIN-TITLE@&#
Mathematical programming models for lock scheduling with an emission objective

@&#HIGHLIGHTS@&#
We provide two distinct mathematical programming formulations and compare them empirically.We show how these models allow for minimizing emission by having the speed of a ship as a decision variable.We investigate the trade-off between reducing flow time and reducing emissions.

@&#KEYPHRASES@&#
Integer programming,Lock scheduling,Emission reduction,

@&#ABSTRACT@&#
We investigate the scheduling of series of consecutive locks. This setting occurs naturally along canals and waterways. Our contribution is to (i) provide two distinct mathematical programming formulations and compare them empirically, (ii) investigate the trade-off between reducing flow time and reducing emissions, and (iii) compare the results of the integrated model to those of a heuristic scheduling the locks separately. Our findings confirm that integrated scheduling of consecutive locks can reduce flow time significantly, and reveal that both model formulations have their merits when compared to each other.

@&#INTRODUCTION@&#
On many inland waterways, locks are required to ensure a suitable water level for navigation. Typically, and notably when the waterway traffic density is high, locks act as bottlenecks, introducing waiting time for ships that pass through these canals and waterways. We consider here the setting where a series of consecutive locks is arranged in a sequence along a canal. In this problem setting, ships travel in both directions and each lock acts as a single server which handles both the upstream and the downstream traffic. Lock operations must alternate between upwards (downstream to upstream) and downwards (upstream to downstream) movements. Results on scheduling a single lock in order to minimize ships’ flow times exist in the literature (see Section 2). The first contribution of this work is to provide two general mixed integer linear programming (MIP) models that consider multiple locks in sequence. By scheduling the system of locks as a whole, we are able to obtain a global schedule that minimizes the ships’ flow times over the entire length of the canal (where the flow time of a ship is the total time that the ship spends in the canal). Moreover, these models can deal with an alternative objective function reflecting minimization of fuel cost or pollutant emissions. In both cases, communicating the outcome of the models to the ships allows them to lower their movement speed when locks are known to be unavailable. This avoids unnecessary idle time where ships would arrive at a lock before it is available. At the same time, this yields a reduction in fuel cost as well as pollutant emissions. The second contribution of this paper is a computational study evaluating the performance of the models. The parameters used in the instances are derived from a real-world dataset. It is reasonable to expect a trade-off between reducing emissions on the one hand, and minimizing the total flow time on the other hand. Our computational study confirms the existence of this trade-off and allows us to analyse this trade-off quantitatively. Finally, we evaluate the impact of an integrated model as compared to a heuristic that is based on scheduling each lock individually.The remainder of the paper is structured as follows. Section 2 provides a brief overview of related literature and known results. In particular, we mention some literature related to fuel consumption and greenhouse gas emissions. A formal definition of the problem is given in Section 3. We aim to provide a general problem description which may be easily extended by incorporating case-specific constraints or alternative objective functions. For this general problem setting, we propose two integer programming models in Section 4. We additionally provide some valid inequalities and performance improvements for both models. Section 5 outlines the computational experiments. Finally, Section 6 concludes the paper.Applying optimization techniques in the context of scheduling locks is not new in literature. Moreover, its relevance is emphasized in recent papers such as Caris, Janssens, and Macharis (2007), who point out that lock scheduling decisions strongly affect the simulated waiting time and suggest efficient decision rules for lock operating as future work. We first mention three specific waterways that have triggered scientific publications.An early example is the case of the Welland Canal in North America, which allows ships to bypass the Niagara Falls. The St. Lawrence Seaway Authority, which maintains the canal, faced increasing congestion at the locks along the canal. In Petersen and Taylor (1988), an integer programming model for this situation is described. The authors also discuss a dynamic programming model for scheduling the operations of a single lock, and extend this model to a heuristic that yields an operating schedule for the series of locks along the Welland Canal. In the problem setting considered, the Welland Canal locks can contain at most one ship.Due to the computational effort involved, a majority of works in the literature restricts the attention to simulation models and heuristic solutions. Examples can be found in a number of publications that consider the Upper Mississippi River (UMR). Smith, Sweeney, and Campbell (2009) use simulation models in order to aid policy decisions to reduce congestion on the UMR. Nauss (2008) describes an integer programming model for clearing a queue at a lock, for example due to technical failure, in the presence of sequence-dependent setup times. A similar MIP that strives to minimize vessel waiting times is integrated in a simulation by Smith et al. (2011) and compared to other priority policies. Different ship sequencing policies are also evaluated by Ting and Schonfeld (2001), who also take chamber assignment policies into account for locks where multiple chambers are available in parallel. A notable difference between the UMR and the problem setting considered in this work is that barges on the UMR are typically not handled in batches and may even require more than one lockage due to their length exceeding the lock capacity.A final example is the Kiel Canal, which connects the Baltic Sea to the North Sea. Lübbecke, Lübbecke, and Möhring (2014) propose a model for traffic optimization, including the sequencing of ships and scheduling of locks. A related implementation of a lock scheduling heuristic is available online, see Luy (2012).Research on problems involving a single lock can also be found. Hermans (2008) discusses a MIP model and a MIP-based heuristic for the single lock setting. Passchyn et al. (2015) propose a dynamic programming approach where the total flow time is minimized, while allowing batches of multiple ships to be processed in a single lockage. The authors cover a number of problem extensions to the initial problem setting and perform some computational tests to investigate the performance of heuristics. Verstichel, De Causmaecker, Spieksma, and Vanden Berghe (2014a, 2014b) consider the problem of packing ships in lock chambers and introduce an integer programming model that minimizes the total flow time for a single lock, which may consist of parallel chambers, while taking this packing aspect into account.Results on obtaining optimum solutions to a system of multiple locks as a whole, are more scarce in the literature. The potential of a centralized approach to scheduling has recently attracted more attention in the field. The Dutch waterway management organization Rijkswaterstaat, for example, is shifting its focus from decentralized lock operations towards the fluent operation of certain ‘corridors’ as a whole, see Kunst (2013). A recent publication by Prandtstetter, Ritzinger, Schmidt, and Ruthmair (2015) discusses a setting very similar to the one considered in this work; they introduce a formal definition for the problem of scheduling locks arranged in a sequence and describe a variable neighbourhood search approach to obtain heuristic solutions. A notable difference with the problem setting discussed here is that in Prandtstetter et al. (2015), the speed of all ships is considered to be fixed.Besides minimizing the total flow time, a different objective could be to minimize the fuel consumption for ships passing through the waterway system. While the fuel consumption may be an important economical factor for ship operators, the related emission of greenhouse gases may also be an optimization criterion for governments or waterway organizations. For this, it is important to take the ship’s speed into account, as both the fuel consumption and emissions per kilometre travelled increase at higher ship speeds. In recent years, the operational speed of intercontinental container ships has been decreased to improve fuel efficiency, a practice referred to as ‘slow steaming’. A large body of literature exists on optimizing ship speed for maritime shipping, see e.g. Ronen (1982) for some early results on this topic, and Psaraftis and Kontovas (2013) for a recent survey.In the context of ocean liner shipping, a reduction in ship speeds translates to a reduction in transport efficiency. On inland waterways however, ships are likely to incur waiting time near bottlenecks such as locks. This provides ships with the opportunity of decreasing their maximal speed on each of the sections along the canal while their total time spent inside the canal, i.e. the flow time, remains unchanged. A paper by Ting and Schonfeld (1999) considers a strategy of reducing ship speed to avoid idle time, reports significant economic benefits for a single lock. In the context of road transport, a model for the time-varying vehicle routing problem is proposed by Qian and Eglese (2014), where the goal is to minimize the greenhouse gas emissions.To the best of our knowledge, our paper is the first one to provide MIPs for emission reduction in the context of multiple locks on inland waterways.We give here a formal statement of the problem we are considering. For clarity of presentation, all known parameters are represented in uppercase, decision variables in lowercase, and sets in calligraphic script. Given is a series of L consecutive locks, for example, along a canal. We number them according to their position, with lock 1 referring to the lock on the downstream end of the waterway. We refer to the locks using the setL={1,…,L}. Over time, S ships arrive at either end of the canal. The setS={1,…,S}allows us to uniquely identify these ships. We assume that the arrival time Asis known for eachs∈S. Each of the ships travels to the end of the canal opposite to its arrival. Thus, a ship either arrives on the downstream side of lock 1 and must pass each of the locks1,…,Lin that order, or a ship arrives at lock L and must pass all locks in the orderL,…,1. We use the setsUandDto refer to the ships arriving on the upstream and downstream side of the canal respectively. Each lockℓ∈Lhas a strictly positive lockage time Pℓ, which is the time needed for a lock to change its position and to allow ships to leave and enter as needed. We assume that the lockage time is independent of the number of ships in the lock and their direction of travel. Locks also have a positive capacity Cℓ which gives, for eachℓ∈L,an upper bound on the number of ships that can simultaneously be present in lock ℓ. We do not assume an initial position for the locks, i.e. each lock may start at either its upstream or downstream position. The models presented in Section 4 can be easily extended to enforce a fixed initial position. Locks ℓ andℓ+1,ℓ∈L∖{L},are separated by a section of canal (reach) with length Sℓ. Each ships∈Shas a fixed minimum and maximum travel speed, represented byVsminandVsmaxrespectively. Ship s may thus travel at an arbitrary speed contained in the interval[Vsmin,Vsmax]. While the ships can travel at a different speed on different sections of the canal, we assume that each ship maintains a constant speed within each section. Each ships∈Smay also have an imposed deadline Ds, before which it must have left the last lock that it needs to pass. The problem parameters are summarized in Table 1.A solution is a schedule specifying the initial position of each lock, a series of times when movements start for each lock, an assignment of ships to lock movements such that each ship is assigned to exactly one appropriate movement (going in the right direction) of each lock, and a speed for each ship on each section between two consecutive locks. For a solution to be feasible we impose four conditions. First, each lock’s movements alternate between the upwards and downwards direction and none of the lock’s movements overlap. Second, the number of ships assigned to a single lock movement must not exceed the lock’s capacity. Third, the speed chosen for each ship s and each section must be contained in the interval[Vsmin,Vsmax]. Fourth, each ship must be assigned movements that are consistent with respect to timing, i.e. s cannot enter the first lock before its arrival time As, it must not leave the last lock after its deadline Ds, and the time interval available between the exiting of a lock and the entering of the subsequent lock must allow the ship to traverse the corresponding section at the chosen speed.We can graphically represent an example instance and a feasible solution as depicted in Fig. 1. Time is represented horizontally; the arrival of each ship, over time, is marked with an ‘X’. The positions are represented vertically. Each tilted line corresponds to a lock movement, i.e. the act of changing the water level and possibly transferring a ship to the other side of the lock. The assignment of ships to lock movements is also represented, the figure thus also represents a feasible solution. In the schedule depicted in Fig. 1, we assume that each lock has a capacity of at least 2.The problems we consider then are to find an optimum feasible solution with respect to the objective functions discussed in Sections 3.1 and 3.2.The first objective we consider is that of minimizing the total flow time, i.e. the elapsed time between the ship’s arrival at the first lock and departure from the last lock in its direction of travel, summed over all ships.Given this objective function we can easily see that we can fix the speed of each ship s to its maximum valueVsmaxwithout sacrificing optimality.A second objective we consider is to minimize total emission by allowing variable ship speeds. We assume that an emission function E(v) is given which expresses the emission of pollutants, in tonnes per kilometre, as a function of the ship speed v for v > 0. For simplicity, we assume that this function is identical for all ships. Note that this function E depends on many external factors and is generally non-linear. In idealized settings, the emission per kilometre is typically a strictly increasing (superlinear) function of ship speed due to the ship’s increasing resistance in the water. A cubic relationship, bounded by a constant minimum at low speeds, is often assumed between ship speed and the emissions per time unit, e.g. by Fagerholt, Laporte, and Norstad (2010). When this relationship is expressed in emissions per unit of distance travelled, this corresponds to a quadratic relationship, bounded by a hyperbola for low speed values. A qualitative illustration can be seen in Fig. 2.Clearly, it is suboptimal to sail at a speed below the threshold value where the minimum is attained, as increasing both the ship speed and subsequent idle time yields a better solution. Regardless of the existence of such a threshold speed, imposing a minimum value for the speed is also justified in order to guarantee sufficient manoeuvrability.Let vs, pdenote the speed of ship s along segment p. The total emission of greenhouse gasesEtotcan then be computed as follows:Etot=∑s∈S∑ℓ∈L∖{L}SℓE(vs,ℓ).A similar approach can be applied in order to minimize fuel consumption, which may be more desirable from the ship operator’s point of view.We note that for arbitrary functions E(v), it cannot be guaranteed that travelling at a constant speed in an individual section minimizes total emission. However, a constant speed is easily seen to be optimal for convex emission functions, see also Hvattum, Norstad, Fagerholt, and Laporte (2013).We introduce here two distinct MIP formulations representing the problems introduced in Section 3. In this section, we present a basic formulation for both models. Valid inequalities and other model improvements are presented in Appendices A and B.To state the travel time, which appears in the constraints of both models, as a linear expression of the variables, we introduce the variablesv¯s,ℓ,which equal the reciprocal of vs, ℓ, i.e.v¯s,ℓ=1vs,ℓ. The travel time for ship s along the section between locks ℓ andℓ+1then equalsv¯s,ℓSℓ. To characterize the emissions, we use the functionE¯(v¯),which expresses the emissions as a function of the reciprocal of ship speed. To obtain a linear model, we use a piecewise linear approximation ofE¯(v¯). Note that, in general, using a piecewise linear approximation may introduce additional variables as the number of segments increases. If the piecewise function is convex and is to be minimized, however, it suffices to introduce a single additional variable and a set of additional constraints. In order to reduce the notational burden we do not give the linearization here and useE¯(v¯)when we refer to the approximation. For an example and additional details on how to compute E(v) andE¯(v¯),we refer to Section 5.3.1.Note that even with Spand vs, pintegral, the travel time for some sections may be fractional. From a practical point of view, however, it might not make sense to schedule lock movements with a higher precision than the unit in which the arrival times are expressed, e.g. minutes. The time-indexed model described below allows lockages to start only at integral moments in time, whereas the second model allows arbitrary starting times for the lock movements.For the model formulation we consider a discretized planning horizon. We consider a setT={0,…,T}of points in time. In the model we restrict ourselves to start times fromTfor each lock movement.We obtain the bound T on the latest possible lockage start time as the sum of the latest arrival time, maximum total travel time, twice the total lockage time, and the maximum waiting time. An upper bound for the latter is derived as the maximum waiting time that a ship can spend at an artificial lock having capacityCminand lockage durationPmaxand assuming that all other ships travelling in the same direction are waiting when s arrives.Let Wu(Wd) denote the maximum waiting time for a ship arriving on the upstream (downstream) side, and letCmin=minℓ∈LCℓandPmax=maxℓ∈LPℓ. ThenWu=⌊|U|Cmin⌋4Pmax,Wd=⌊|D|Cmin⌋4Pmax,and withTRmaxequal to the maximum time needed to pass through the entire canal without waiting, we obtainT=max(maxs∈UAs+TRmax+2×Ptotal+Wu,maxs∈DAs+TRmax+2×Ptotal+Wd).For each ship s and each lock ℓ we can bound the set of points in time at which a lockage of lock ℓ containing ship s can start. It is not hard to compute an earliest and latest possible starting time for such lockages, obtaining a setTs,lfor each ship s and lock ℓ.In addition to the variablesv¯s,ℓintroduced in Section 3.2, we define the following binary decision variables: For eachs∈S,ℓ∈L,t∈Ts,letxs,ℓ,t={1if,attimet,lockℓstartsalockagewithshipsinsidethelock,0otherwise.Note that the completion time cscan then be expressed as follows:cs={∑t∈Ts,Lxs,L,t(t+PL)ifs∈D,∑t∈Ts,1xs,1,t(t+P1)ifs∈U.Model 1shows the mathematical formulation of the time-indexed model. For a schedule to be feasible, each ship should pass each of the locks, as imposed by constraints (2). Notice that these constraints also implicitly ensure that the arrival time and deadline for each ship are respected, since only variables inTs,ℓare considered. Further, all locks must be passed in the correct order, i.e. a ship must arrive at a lock before it can enter that lock. We achieve this by imposing constraints (3) and (4). In these inequalities, the left hand side reflects the time difference between the starting time of the lock movement that handles ship s at lock ℓ, and the ending time of the lockage that handles ship s at the preceding lock.Additionally, a lockage can only start when the lock is in the appropriate position and not currently moving, i.e. lockages of the same lock should not overlap in time. We impose this by adding the constraints (5)–(7). Figs. 3and 4give a visual representation of these constraints. In the figures, for any pair of ships s1, s2 travelling in the appropriate direction, a movement for ship s2 cannot start in the indicated interval if the x variable corresponding to s1 equals one. Note that constraints (6) and (7), which concern ships travelling in the same direction, allow multiple ships to be handled at the same time.Finally, the locks’ capacity restrictions, the limits on attainable ship speed, and the domain of all variables are trivially modelled by constraints (8)–(11).We point out that this model contains O(SLT) binary variables, O(SL) real variables, and O(S2LT) constraints. We refer to Appendix A for a number of model improvements that enhance the performance of the time-indexed model (1)–(11).A notable disadvantage to the time-indexed model is that the number of (binary) variables grows as the time horizon increases. For a small discretization step or when arrival times are large, the value for the upper bound T and thus the number of variables and the computation time to find an optimal solution, may grow prohibitively large. We introduce an alternative formulation that does not use a time index for the variables, and instead numbers the possible lockages. It is clear that for each lock, the number of lockages in an optimal solution does not need to be greater than 2S. Furthermore, we may also use the bound T introduced in the TI model to bound the number of lockages:K=min(2S,⌈T+maxℓ∈LPℓminℓ∈LPℓ⌉).We thus define the setK={1,…,K}to identify the lockages of each lock. In fact, it is easy to see that we can replaceKwith an individual expressionKℓfor each lock, but we ignore this for simplicity of notation.In addition to the variablesv¯s,p,we introduce the following decision variables for eachs∈S,ℓ∈L,k∈K:zs,ℓ,k={1ifshipsishandledbythekthlockmovementoflockℓ,0otherwise.tℓ,kequalsthestartingtimeofthekthlockageoflockℓ,csequalsthecompletiontimeofships.Note that the number of variables does not increase with T. Model 2presents the complete formulation.Notice that the model introducesMsu,Msd,andMk1,k2as big-M values. To define their value, we first define the parameterT¯,which gives an upper bound on the latest starting time of any lock movement. Note that this value may exceed the T introduced for the time-indexed model. We have at least⌈SCmin⌉non-empty lockages, thus:T¯=T+Pmax+(K−⌈SCmin⌉)Pmax.We now discuss the individual constraints. Inequalities (13) and (14) ensure that the completion time of each ship, used in the objective function, is consistent with the timing of the last lockage of each ship and enforce the deadlines for each ship. The valuesMsuandMsdintroduced here give an upper bound on the difference between the latest possible starting time for a lockage and the earliest completion time for a ship s travelling downstream and upstream respectively. WithTRminequal to the minimum time required to cross the entire canal, we can write:Msu=T¯+P1−As−TRminMsd=T¯+PL−As−TRminConstraints (15) guarantee that each ship passes through each of the locks and constraints (16) ensure that they do not overlap in time.The next set of inequalities, (17)–(19), ensures that each lockage can only handle ships in a single direction, and that no two consecutive lockages carry ships in the same direction. Since the only way to characterize the direction of a lockage is to consider the direction of ships inside the lockage, the direction of lockages need not necessarily alternate when empty lockages are present. Using constraints (17)–(19), however, the model does guarantee that all non-empty lockages satisfy all requirements for a feasible solution.Obviously, the locks should be passed in the correct order. This is imposed by specifying that the waiting time each ship incurs at each position must be non-negative. Constraints (20) and (21) ensure this for the upstream side of lock L and the downstream side of lock 1, where the arrival times are known. Constraints (22) and (23) do the same for the remaining sides of locks, where ship arrivals are determined by the timing at a preceding lock. The big-M valueMk1,k2gives an upper bound on the difference in starting time between the lockages k1 and k2:Mk1,k2=T¯−(k1−1)Pmin−(K−k2−1)PminFinally, the capacity constraint (24) and the domain restrictions for the variables are again straightforward to specify.The lockage-based model involves O(S2L) binary variables, O(SL) real variables, and O(S3L) constraints. We refer to Appendix B for a number of performance improvements for the lockage-based model (12)–(28).Notice that, in general, both models allow ships to overtake each other. That is, for two shipsi,j∈Swith Ai< Aj, the model allows ship j to enter any of the locks strictly before ship i enters that lock. In practice, a first-come first-served rule is often enforced for ships travelling in the same direction. Moreover, in case of no deadlines and identical speed intervals[Vsmin,Vsmax],an exchange argument implies that a solution with minimum flow time can be transformed into a solution that still has minimum flow time and also satisfies first-come first-served at each lock. In fact, this argument also applies to a case where given deadlines satisfyDs−As=Cfor some constant C. Since this is the case in all instances we consider in Section 5, we orderUandDby arrival times and add the following constraints to the TI-model:(29)∑τ≤txs1,ℓ,τ≥∑τ≤txs2,ℓ,τ∀s1<s2∈U,ℓ∈L,t∈T(30)∑τ≤txs1,ℓ,τ≥∑τ≤txs2,ℓ,τ∀s1<s2∈D,ℓ∈L,t∈TFor the LB-model, we add the following:(31)∑κ=1kzs1,ℓ,κ≥∑κ=1kxs2,ℓ,κ∀s1<s2∈U,ℓ∈L,κ∈K(32)∑κ=1kzs1,ℓ,κ≥∑κ=1kxs2,ℓ,κ∀s1<s2∈D,ℓ∈L,κ∈KWe note that this FCFS assumption need not hold in general. For example, it is easy to see that a deadline can be chosen such that a ship must move immediately upon its arrival, ignoring waiting ships that arrived at an earlier time.It is also worth noting that some of the constraints introduced in Models 1 and 2 can be tightened by implicitly taking this FCFS property into account. In order to preserve the flexibility of the original model when FCFS does not hold, however, we do not modify the original constraints.We note that the models presented above do not include all practical considerations which may occur in a specific real-world setting. The generality of both models, however, allows such extensions to be included with relative ease, although the required computational effort is likely to increase significantly as a result. We briefly mention some of these additional issues that may arise:•Ships may arrive at, or depart from, the system in between locks, as opposed to at the ends of the canal only.The lockage time may depend on the number of ships inside the lock. In particular, empty lockages could be performed very efficiently in comparison to a non-empty lockage.The water velocity may affect the lockage time depending on whether the water level is raised or lowered,The water velocity may also affect the emission characteristics of ships depending on their direction of travel.In this section, we evaluate the performance, with respect to minimizing total flow time, of the two models and their respective performance improvements described in Appendices A and B. We then use the lockage-based model to minimize the emissions and evaluate the trade-off between emissions and flow time on instances based on real-world data. All instances and results are made available online at https://perswww.kuleuven.be/~u0086328/lockmasterdata.html.We implement the different model formulations with the flow time objective in CPLEX (version 12.5.1). We evaluate the performance on different sets of instances. We start with the description of a reference scenario in Section 5.1.1. In what follows, we then investigate the impact of different parameters on the performance of the models. More concrete, the number of ships is varied in Section 5.1.2, the number of locks in Section 5.1.3, the time granularity in Section 5.1.4 and the lockage time in Section 5.1.5. Each scenario is evaluated for 10 randomly generated instances. We enforce a limit on the computation time of 15 minutes per instance. No model tuning is performed, and the CPLEX solver options are left to their default values. For a summary of the results, we refer to Section 5.1.7.Our reference scenario consists of instances with 3 identical locks and 15 ships. The capacity is equal to 2 ships. We choose a time unit of 5 minutes, i.e. all arrival times are rounded to the nearest multiple of 5 minutes. We choosePℓ=2for allℓ∈L. Arrival times are generated randomly from a Poisson arrival process with parameterλ=0.0536(see also Section 5.3.1). This corresponds to an expected time between arrivals of 18.66 minutes. For simplicity, the distance between the locks is considered to be zero. This allows us to ignore the minimum and maximum speed. Results concerning the distance and ship speed between locks are presented in Section 5.3. Furthermore, since we are minimizing the flow time, we do not need to impose any deadlines. A summary of the input parameters for the reference scenario is given in Table 2.For this reference scenario, we compare the performance of the models presented in Section 4 as well as the models with the performance improvements described in Appendices A and B. The time-indexed and lockage based models, including the FCFS constraints discussed in Section 4.3, are denoted by TI and LB respectively, while the models with the improvements described in Appendices A and B are labelled TI+ and LB+. Table 3presents the results.Perhaps surprisingly, the LB and LB+ models do not perform well, despite reducing the number of variables compared to the TI model. To illustrate this, we present the average number of variables and constraints in each of the models in Table 4. Due to the filtering of variables in the TI+ model, this model has an even lower number of variables, although this number depends on the size of the time unit as well as the valueT¯,as discussed in Section 4. While the LB model performs very badly, the stronger LB+ model does outperform the TI model without preprocessing. This is good to note since the TI preprocessing is only possible when minimizing the flow time, or alternatively when ship speed is fixed, whereas the improvements introduced in the LB+ model can also be applied in the emission context with variable speed.For both models presented in Section 4, it can be seen that the modifications suggested in Appendices A and B provide a strong reduction in computation time. In what follows, we investigate the sensitivity of the models’ performance with respect to different input parameters. Given the drastic improvement of the TI+ and LB+ models over their basic variants, we limit ourselves to the improved models only.We increase the size of the reference instances up to 25 and 35 ships. The other input parameters remain unchanged, e.g. we still ignore distance and ship speed. Table 5present the results for the TI+ and LB+ models. As a consequence of our method of generating Poisson arrivals, the time horizon is expected to grow proportionally with the number of ships. For the TI model, this implies that the number of variables (and constraints accordingly) will increase. Although the number of variables in the LB model does not depend onT¯,several big-M values in the LB+ constraints will increase as a result. The results indicate that the TI+ model continues to outperform the LB+ model. Notice that the time required to generate the TI+ model grows much faster than that of the LB+ model, which reflects the rapidly increasing number of variables. This is also an early indication of the fact that the time-indexed models will fail to generate larger models due to insufficient memory, whereas the lockage-based models are expected not to suffer from this problem.To investigate the effect of the number of locks on the solvability, we solve the reference scenario for a single lock as well as for a set of 5 locks. For the latter scenario, we maintain the assumption that all distances between locks are equal to zero. We note that the single-lock scenario should be considered as a simple reference benchmark only, since Passchyn et al. (2015) describe a polynomial time procedure for a variety of single-lock scheduling settings, which outperforms the MIP approach presented here. The results for both sets of instances can be found in Table 6.For a single lock, it can be seen that the performance of both models is comparable. In the single lock setting, the set of big-M constraints (B.7) and (B.8) vanish from the model, strengthening the LP relaxation. When increasing the number of locks, however, the opposite occurs and additional big-M constraints are added. As a consequence, the LB+ becomes two orders of magnitude slower than the TI+ model.Here, we vary the size of the time unit, i.e. the discretization step size. We solve instances with a time unit equal to 1 minute and to 15 minutes. All arrival times are rescaled and rounded to the nearest unit. We select a lockage time Pℓ equal to 12 time units and 1 time unit in the respective test scenarios, for each lock. Table 7shows the results.Unsurprisingly, both models perform better compared to the reference scenario when a larger time unit is chosen. In the reference scenario, the average total computation time is equal to 2.30 and 14.33 seconds for the TI+ and LB+ models respectively (see Table 3), whereas for a time unit of 1 minute, this changes to 16.63 and 14.72 seconds respectively (Table 7). For smaller time units, the performance of the TI+ model thus quickly degrades, as could be expected, whereas the performance of the LB+ model does not seem to suffer significantly compared to the reference scenario.We also investigate the effect of the lockage duration on the model performance. Table 8shows the results for a lockage duration Pℓ equal to 1 and 5 time units respectively. Note that the time unit, as well as the arrival times, remain unchanged. The table illustrates that the performance of the LB+ model improves whereas the TI+ model performs worse as the lockage time increases. This is consistent with the observation that a large lockage time tightens the LB+ model, through the valueMk,ℓLB+in constraint (B.11). In the TI+ model, however, increasing the lockage duration yields a larger value T, and thus increases the number of variables to be considered.We do not perform a separate test to check for the influence of the arrival rate parameter λ, since varying this parameter is equivalent to varying the time unit and simultaneously rescaling the value for the lockage duration so that the ratio of lockage duration to time unit remains unchanged. Results similar to the scenarios above can be expected, where a low arrival rate favours the LB+ model, and a relatively high arrival rate favours the TI+ model.To summarize, we conclude that the TI+ model outperforms the other models for most of the tested instances. However, the TI+ model does suffer from two important drawbacks:•As with any time-indexed model, the number of variables depends on the length of the time horizon. This can be seen in those instances where the time unit is chosen to be small, as well as for larger lockage durations. As the number of ships increases, the time horizon grows (since the arrival rate λ is fixed), which causes the time needed to generate the TI+ model to increase quickly. Increasing the number of ships, however, is also detrimental to the performance of the LB+ model, prohibiting a comparison for instances containing a larger number of ships.The preprocessing performed in the TI+ model to reduce the number of variables assumes that the travel time for each ship on the different sections is known. Preprocessing is thus only possible when ship speed is fixed. Consequently, the TI+ model can only be applied when the objective is to minimize the flow time, in which case the speed for each ship s can be assumed to be equal toVsmax.We stress that the second item is an important justification for the use of the LB+ model in Section 5.3, where our aim is to evaluate the speed-dependent emissions. While the TI model may also be used to minimize total emission, as discussed in Section 4.1, the corresponding computation time is significantly larger than that of the LB+ model. Furthermore, the relative difference in computation time is expected to increase even further as smaller time units are considered, as is the case in Section 5.3.While the MIP models allow us to find a provably optimal solution, the computational burden can be difficult to overcome for larger instances. To investigate whether the use of an integrated MIP model for multiple locks is justifiable, we compare the exact solution to a solution obtained from an intuitive heuristic. For this experiment we consider only the flow time objective since deadlines should be imposed to obtain sensible results for the emission objective, and it is unclear how to derive deadlines at each of the individual locks while still allowing the model sufficient freedom to minimize emissions.The heuristic solution is based on a decentralized approach where optimal decisions are made for the individual locks. Each of the locks is iteratively scheduled to minimize flow time individually, using only the known ship arrival times. Initially, only the downstream arrivals are known for the first lock, as well as the upstream arrivals for the last lock. We note that obtaining an optimal solution to the single-lock problem, is possible in polynomial time, see Passchyn et al. (2015). From each individual solution, arrival times are then obtained for the neighbouring locks. This process is repeated until convergence or a fixed iteration limit, since convergence can in fact not be guaranteed. An outline of this procedure in pseudo-code is given in Algorithm 1, where SLS(U, D) represents the single lock solver procedure which returns a solution to the single lock problem given a set of upstream arrivals U and downstream arrivals D, and fu(fd) is a function that computes the upstream (downstream) arrival times at a lock given from a given schedule at the previous lock. We denote the heuristic with RISL, short for ‘repeated iterations of single lock scheduling’.The input used for the instances is summarized in Table 9. We again compare the results for 10 instances; the results are listed in Table 10. The heuristic achieves optimal performance in 4 out of the 10 instances. The average performance gain by centralizing the scheduling is 2.12 percent, although the variation over the instances is quite large, up to a maximum of 8.34 percent. Naturally, this comes at the expense of a significantly increased computation time. With respect to minimizing the total flow time, we conclude that there is value in obtaining a centralized schedule. Furthermore, the emission objective inherently requires an integrated approach.We now evaluate the trade-off between emission reduction and flow time reduction based on an instance created from real-world data. We focus on a section of the upper Scheldt river near Ghent, Belgium.We consider three locks, each consisting of a single chamber with capacityCℓ=2and lockage timePℓ=12,separated by a distance of 10.9 kilometres and 12 kilometres respectively. Arrival times are generated randomly for 25 ships, with a time unit of one minute. Based on a dataset with historical arrival data provided by ‘Waterwegen en Zeekanaal’ (the organization responsible for managing the locks), an arrival rate ofλ=0.0536can be estimated between 6 a.m. and 8 p.m. We use this arrival rate, noting that we do not fix the time horizon of the instances since this is determined from the Poisson arrival process where both the number of arrivals and the Poisson parameter λ are fixed. We report the average results obtained over 10 instances.In order to derive the piecewise linear function approximatingE¯(v¯)we employ a tool originating from the ARTEMIS project, see Boulter (2007). It allows to evaluate the CO2 emissions as a function of multiple inputs, including the ship speed and waterway characteristics. The tool’s default ship data is used for ships of the type ‘Rhein–Herne–Kanal’ (RHK), named after the Rhine–Herne Canal for which ships of this size were originally designed. The RHK ships have a size which is representative for freight ships that pass through the upper Scheldt river. The waterway characteristics entered in the ARTEMIS tool are a water depth of 3 metres and an average waterway width of 50 metres.Using the tool, we evaluate the CO2 emissions at a speed of 2, 5.33, 8.66, and 12 kilometres/hour, depicted as dots in Figs. 5and 6. We transform the results into a piecewise linear approximation ofE¯(v¯)with three linear segments. It is important to note that if a piecewise linear function is translated into a function of emission depending on speed, the result is not convex. This is illustrated by the graph in Fig. 5. The effect can be made arbitrarily small, however, by choosing the piecewise linear segments sufficiently short. The resulting functionsE¯(v¯)and E(v) are shown in Figs. 5 and 6 respectively.Further, we impose a minimum speed of 2 kilometres/hour and the canal’s maximum speed of 12 kilometres/hour for all ships.The trade-off between flow time and emissions is evaluated as follows: first, the LB+ model is used to minimize the total flow time without imposing any deadlines, where ship speed is fixed to the maximum allowed speed of 12 kilometres/hour. Notice that the flow time of each ship is at least equal to 150.5 minutes: the time needed to traverse the entire canal at maximum speed plus the total time spent inside locks. To speed up the computation, we set a deadlineDs=As+240minutesfor each of the ships. All instances are solved to optimality.Solving each of these instances yields a set of completion times, which will be used as the reference deadlines in what follows. Next, we treat the ship speed as variable and gradually relax the deadlines so that the flow time for each individual ship is allowed to increase by a given percentage relative to the reference scenario. In each of these modified instances, the ship speed is variable and a deadline is specified for each ship. Table 11lists the average over the instances of the total emission value, as the flow time is allowed to increase. Observe that a reduction in total emission is possible even without relaxing the reference deadlines, as the variable ship speed allows the slowing down, thus reducing emissions, when waiting time is unavoidable at the locks. This scenario, where the reference deadlines are imposed while ship speed is variable, will be referred to as the reference scenario. We find that the reference scenario allows an average emission reduction of 3.44 percent over the initial setting with fixed speed, while the total flow time remains unchanged. In other words, consistently travelling at the maximum allowable speed results in a total emission increase of 3.58 percent over the reference scenario, with no benefit to the total flow time.Table 11 also lists the average computation time as flow times are increased. We should note that the time needed to determine the initial deadlines by minimizing the flow time with ship speed fixed toVsmax,is not included in the table. In fact, this first step provided the largest contribution to computation time, taking 895 seconds on average, although the required time varied greatly by instance, with a minimum of 71 seconds and a maximum of 4374 seconds. Once the reference deadline times are determined, subsequent tests complete much faster since the deadlines strongly constrain the feasible solution space.Fig. 7shows the trade-off between emissions and flow times, averaged over the 10 instances considered. The emission reduction is given as a percentage relative to the solution which minimizes the total flow time where the ship speed is variable, i.e. the reference scenario. It can be seen that the trade-off is approximately linear up to a point where the curve flattens. That is, in our instances, allowing a 1 percent increase in flow time roughly translates into a 3 percent reduction in emission.It should be mentioned that the trade-off is generally slightly more erratic for a single instance. When the increase in flow time is insufficient to allow any changes to the assignment of ships to lockages, an emission reduction is possible only by slightly delaying the starting time of the lockages. However, when the increase in flow time becomes sufficiently large, the assignment of a ship may change to a later lockage, introducing a discontinuity in the trade-off curve. Fig. 8shows the trade-off profile evaluated for a single instance. While this effect is barely visible in this case, it is expected to be more prominent when distances Sℓ are smaller, or for a larger lockage duration Pℓ.In this work, we formulated the general problem of scheduling a system of locks arranged in a sequence. We described two mixed integer programming models which allow to solve the problem to optimality. Both models can be easily extended to include additional constraints or alternative objective functions such as minimizing the total greenhouse gas emissions, as opposed to the total flow time.Computational testing confirms that a time-indexed model (TI) performs well when the unit of time is chosen sufficiently large, thus limiting the number of variables. When the objective is to minimize the total flow time, the TI model permits a preprocessing step (TI+) where the number of variables is reduced, greatly improving the performance. Perhaps more surprisingly, a second model (LB) where the number of variables does not depend on the time unit does not seem to outperform the TI+ model, even with the addition of valid inequalities (LB+) to tighten the LP-relaxation. In the context of minimizing emissions, however, the LB+ model will easily outperform the original TI model.The limited performance for larger instances suggests a decomposition approach such as branch and price, which may overcome the weak LP relaxation of the LB problem while avoiding to include many unnecessary variables and suffering from the same drawback as the TI model.Comparing the exact solutions to a heuristic indicates that, while the heuristic may frequently find an optimal solution, significant improvements can be achieved for other instances.A different set of computational experiments evaluated the trade-off between emission reduction and increase in flow time for a system of three locks on the upper Scheldt river. Compared to the fixed speed scenario, an emission reduction of 3.44 percent could be achieved with no impact on the total flow time. Relaxing the flow time for individual ships allows a further reduction at an approximately linear rate.One possible direction for future work concerns model extensions which could be more relevant in practical contexts. Examples include modelling the priority of ships, or modifying the lockage duration depending on the ships that are in the lock. Another direction would be to reformulate the models to allow decomposition, or to initialize the exact approach with a heuristic solution.

@&#CONCLUSIONS@&#
