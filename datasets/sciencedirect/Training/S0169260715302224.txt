@&#MAIN-TITLE@&#
A graphical user interface (GUI) toolkit for the calculation of three-dimensional (3D) multi-phase biological effective dose (BED) distributions including statistical analyses

@&#HIGHLIGHTS@&#
A GUI was created to calculate the multi-phase BED distributions.The GUI is effective at determining the BED distributions and the dose statistics of the ROIs for multi-phase treatment plans.Using this GUI has shown the inaccuracies of using the approximate BED calculation method for multi-phase cases.This GUI can be used to optimize multi-phase treatment plans.

@&#KEYPHRASES@&#
Biological effective dose,BED,Graphical user interface,GUI,Radiotherapy,

@&#ABSTRACT@&#
A toolkit has been developed for calculating the 3-dimensional biological effective dose (BED) distributions in multi-phase, external beam radiotherapy treatments such as those applied in liver stereotactic body radiation therapy (SBRT) and in multi-prescription treatments. This toolkit also provides a wide range of statistical results related to dose and BED distributions. MATLAB 2010a, version 7.10 was used to create this GUI toolkit. The input data consist of the dose distribution matrices, organ contour coordinates, and treatment planning parameters from the treatment planning system (TPS). The toolkit has the capability of calculating the multi-phase BED distributions using different formulas (denoted as true and approximate). Following the calculations of the BED distributions, the dose and BED distributions can be viewed in different projections (e.g. coronal, sagittal and transverse). The different elements of this toolkit are presented and the important steps for the execution of its calculations are illustrated. The toolkit is applied on brain, head & neck and prostate cancer patients, who received primary and boost phases in order to demonstrate its capability in calculating BED distributions, as well as measuring the inaccuracy and imprecision of the approximate BED distributions. Finally, the clinical situations in which the use of the present toolkit would have a significant clinical impact are indicated.

@&#INTRODUCTION@&#
In modern radiation therapy, dosimetric quantities such as prescribed and tolerance doses, dose-volume histograms (DVH), and isodose distributions, are commonly used for treatment plan evaluations. Dose-volume constraints have been introduced for organs-at-risk (OAR) to prevent unwanted side effects [1–5]. The constraints indicate organ volumes that should not receive doses exceeding certain limits and they are normally derived from retrospective studies. Clinical and radiobiological studies have shown that two treatments delivering the same total dose through different fractionation schemes produce different biological results [6–11].In external beam radiotherapy, the prescribed dose is commonly delivered through multiple fractions. For example, a dose of 60 Gy can be delivered in 30 fractions of 2 Gy. Barendsen showed how the biological effective dose (BED)—which was derived from the linear-quadratic (LQ) model—can quantitatively define the relative effectiveness (RE) of any fractionation scheme [6]. BED has shown that as the dose-per-fraction (DPF) increases, the RE of that fractionation scheme increases. That agrees with the clinical results seen in the infant days of radiotherapy, which led to more conservative fractionation schemes that deliver the total prescribed dose in more fractions with lower doses per fraction in order to prevent normal tissue complications.During the last thirty years, research has confirmed the fact that different fractionation schemes leading to different BEDs produce different clinical results [7,8,12–15]. However, most of that research has involved single-phase treatments, which deliver a total dose using a certain number of fractions. For cases such as prostate cancer, certain treatment protocols include an additional treatment phase, typically called the boost phase, where the additional dose is delivered with a different beam configuration and fractionation scheme. For example, the first phase (primary phase) delivers a dose of 60 Gy in 30 fractions, and the additional phase (boost phase) delivers a dose of 12.6 Gy in 7 fractions. There has not been much research regarding the calculation of BED for patients who receive more than one phase (multi-phase treatments).Another important factor for investigating the proper calculation of BED for multi-phase treatments is the common practice for approximately calculating the BED, possibly leading to errors in the estimation of the effectiveness of the treatments. Due to the lack of studies regarding three-dimensional (3D) multi-phase BED calculations, a toolkit was created in order to correctly calculate the total BED for fractionated treatment modalities such as intensity modulated radiation therapy (IMRT) and stereotactic body radiation therapy (SBRT). In addition to the calculation of the total BED for multi-phase treatments, the toolkit also provides statistical analysis algorithms, which are used to evaluate the accuracy of the approximate BED calculations. The toolkit uses the DICOM-RT communication protocol to access the data of a given treatment plan in order to calculate the 3D BED distributions, the DVHs, BED volume histograms (BEDVH) and the Bland–Altman analysis, which can subsequently be performed. This toolkit was built using MATLAB GUIs in order to provide a user-friendly interface.When analyzing multi-phase treatment plans, the composite dose distribution is typically calculated, which is produced by summing up the dose distributions from the plans of all the phases [13]. In practice, it is common to use the composite dose distribution in the BED equation. By studying the mathematical formula of the LQ-model it can be realized that summing the dose distributions from the different phases prior to BED calculation contradicts the additive property of the LQ-model. That observation raises the question of how accurate is the common, but approximate, method of BED calculation against the conceptually correct method. Furthermore, under what circumstances does the approximate approach produce relatively accurate results with respect to the correct method? In a previous study, Kauweloa et al. derived the mathematical formulations of the approximate BED (BEDApp), and the true BED (BEDTrue) and evaluated their deviation in different clinical settings [16].The graphical user interface (GUI) was created using the MATALB 2010a software (Mathworks, Natick, MA) and it was developed to calculate the BED distributions for single- and multi-phase treatments, as well as to calculate the corresponding inaccuracies when BED is applied on the composite physical dose distribution. The BED is the amount of total dose needed to reach a certain “effect” (clinical endpoint) when delivering the dose using infinitesimal doses-per-fraction. Barendsen derived the BED from the LQ-model using the following formula:(1)S=(e−αd−βd2)n​,where “n” is the number of fractions, α and β are the cell death due to single- and double-track ionizations [6]. The exponent of Eq. (1) has been defined as the “effect”. BED is then derived as follows:(2)BED=ln(1S)α=nd(1+dαβ).The ratio α/β is typically assumed to be 3 Gy and 10 Gy for late- and early-responding tissues, and it is interpreted as the dose at which the amount of cell death due to single- and double-hits are equal. The value of α/β is typically derived from cellular survival curves where α and β correspond to the linear and quadratic components.When dealing with more than one treatment phase, Eq. (1) can be rewritten as follows:(3)S=∏i=1N(e−αdi−βdi2)ni​,where N is the total number of phases. Due to the fact that most protocols involve two phases, in the examples that will be demonstrated N will be 2. The survival function then becomes:(4)S=(e−αd1−βd12)n1(e−αd2−βd22)n2​.As mentioned earlier, the “effect” E is the whole exponent power, hence it is,(5)E=n1(αd1+βd12)+n2(αd2+βd22).Dividing both sides of Eq. (5) by α leads to the BED for two-phases, as shown below,(6)BEDTrue=n1d1(1+d1αβ)+n2d2(1+d2αβ),Generalizing Eq. (6), the BED equation for multi-phase treatments can be written as follows:(7)BEDTrue=∑i=1Nnidi(1+diαβ),Due to multi-phase treatments extending treatment time, tumor proliferation will eventually occur and will reduce the effectiveness of the fractionation scheme. A time factor is included within Eq. (7) to account for the tumor proliferation [13]:(8)BEDTrue=∑i=1Nnidi(1+diαβ)−ln(2)αTpotmax(0,T−TK),whereTpotis the tumor potential doubling time, T is the overall treatment time for the overall fractionation scheme, andTKis the repopulation kick off time for the specific tumor.As seen in Eq. (7), the BED has to be calculated for each phase prior to their summation to derive BEDTrue. In the previous years, due to the complexity of calculating the composite BED distribution in multi-phase treatments, it was common practice to calculate the composite BED from the composite physical dose distribution. This approximation is mathematically represented by the following expression:(9)BEDApp=[(∑i=1Nnidi)∗(1+d¯αβ)]−ln(2)αTpotmax(0,T−TK),(10)whered¯=∑j=1Nnjdj∑j=1Nnj.As seen in Eq. (9), the time factor remains the same since the calculation method has no impact on the quantitative response of tumor proliferation. Fig. 1shows the difference in the calculation process between the true and approximate BED calculation methods utilizing a test case.Eqs. (1–(10) describe the derivation of the BED from the LQ-Model. Due to much research showing the failure of the LQ-model at high dose fractions, Astrahan et al. added an extra component to the LQ-model in order to account for the linear cellular death response once the DPF is greater than 2α/β, which Astrahan et al. defined as the dose-threshold (dT) [17–21]. The LQL-model is shown below,(11)S=(e−αd−βd2−γ(d−dT))nford≥dT​.From Eq. (11), the general BED equation is derived the same way as Eq. (7).(12)BEDHDPF=∑i=1N[nidi(1+diαβ)+niγα(di−dT)]−ln(2)αTpotmax(0,T−TK),ford≥dTwhere dTis 2α/β. If d is less than 2α/β, then Eq. (8) will be used. Astrahan et al. also showed that for the majority of the cells they studied, the ratioγαequals 5 Gy [17].Most of the treatment cases where d is greater than 2α/β are SBRT treatments. Multi-phase SBRT cases, for example, would be liver cancer patients who have more than one tumor of sufficient size to be treated. Many liver SBRT cases involve each tumor receiving a different fractionation scheme. For example, one tumor could receive a fractionation scheme of 15 Gy/fraction in 3 fractions while a second tumor could receive 10 Gy/fraction in 5 fractions. With each tumor receiving its own fractionation scheme, Eq. (12) can be used in order to calculate the total BED of the liver.This toolkit was created with a user-friendly interphase that helps the user navigate easily through the different steps of the process. In order to simplify the use of this toolkit, instead of using multiple windows, all the controls are performed through one window as shown in Fig. 2. Fig. 3displays the general process by which the toolkit calculates the composite BED.Prior to calculating the BEDs, the input information needs to be acquired. This information is exported from the patient's Pinnacle treatment plan. However, the data in the exported file needs to be converted to a format which is compatible with MATLAB (*.mat). After typing in the patient's initials and selecting the treatment phase, the user should select the “Run CERR” button. That will open a MATLAB program, which reads the exported files from the treatment planning system and converts them to MATLAB files. Then, by selecting the button “Finalize” the file transformation is completed.Once this process has been completed for both the primary and boost treatment plans, the folder in the toolbar should be selected to load those files into the Primary and Boost Data fields. Then, the patient's initials must be typed in and the button “Load Organ(s)” must be selected. The list of the organs-at-risk (OARs) that will appear should be the same ones shown in the treatment planning system. The target volumes will also appear in that list. After selecting an OAR from this list the dose distribution for the selected organ of interest will be acquired and the treatment planning parameters (e.g., number of primary/boost fractions (Npri and Nbst), α/β, DVH Delta, and EVH Delta) will need to be entered by typing. This GUI can calculate both multi-phase BEDs as well as single-phase BEDs. That is why the “Calc. Method” needs to be chosen in order to use the right algorithm to perform the calculation. If it is a multi-phase case, the user should choose “Two-Phase” otherwise the “Single-Phase”. Once all the input of the data has been completed, the button “Calculate” should be clicked.When dealing with SBRT treatments, a single-phase BED analysis is performed in order to study the relative error of the LQ-model versus the LQL-model. In order to calculate the total BED, the upper-right region of the program is used, as shown in Fig. 1. In this case, the “Load Type” should be selected (most times it will be prescription (Px) instead of total data). Once the Px of each phase has been typed in, the button “Calculate” should be selected, which will lead to the production of statistical charts and graphs for the total BED. The DVHs and BEDVHs can be saved when the calculation has been performed after selecting the button “Dose Optimization”. The volume of a given organ receiving a given dose limit can be identified by entering the dose limit and then selecting the button “Calculate Vol Limit”.Once the calculations are complete, the button “Data Choice” will provide a list of options regarding the single- or multi-phase cases. In addition, regarding the statistics related to the BED calculations, the user will also be able to look at the DVHs, EVHs (error volume histogram), as well as the images at all views (e.g., sagittal, coronal, and transverse). When reviewing the images or the plots, the tabs in the toolbar allow the user to scroll through different slices and properties of the data. Furthermore, on the right side of the layout there is a box titled “Addition Two-Phase, Maximum Dose Info”. This box gives the percent errors of the maximum values calculated using the approximate BED calculation method relative to the true BED calculation method.A brain cancer case was selected to demonstrate the typical process in which the multi-phase BED calculations are performed. The examined treatment plan was created using Pinnacle, for both the primary and boost phases. Once the exported Pinnacle files are within the “Current Folder” (files from this folder is what the program reads), then the treatment plan is imported as shown in Fig. 4. Once the “Patient Initials” and “Phase” (primary or boost) information has been entered, the button “Run CERR” needs to be selected and the “CERR control panel” will appear. Then, once the “Import” button has been selected and the subsequent instructions have been followed, the “Finalize” button should be selected to complete the file format transformation from dicom to *.mat. This way, MATLAB will have the input data, specifically the dose distributions and treatment plan parameters, in the proper format. As seen in Fig. 4, once the treatment plan has been imported, its filename will be “AG_PriPlanC.mat”. For the boost phase, the same process is repeated and the respective filename will be “AG_BstPlanC.mat” (“Pri” for primary and “Bst” for boost).Fig. 5displays all the input data as well as the process of calculation. As seen, the “Primary” and “Boost” Data can be entered by clicking the open folder in the main toolbar. Following the input of the Patient Initials, the button “Load Organ(s)” should be selected in order to acquire the dose distribution of the chosen organ and subsequently proceed to the multi-phase BED calculations. Once the organ is selected, the number of fractions (Npri, Nbst), α/β (from the LQ-model), the DVH and EVH deltas can be specified. Since this patient receives a primary and boost phase, the Two-Phase calculation method is chosen and the button “Calculate” is selected.During the calculation process, waitbars appear to inform the user of the status during the calculation. The most time consuming part of the process is the rescaling of the dose matrices within the two phases. The statistical calculations are relatively short (~0.5 to 5 sec). The total time of the calculations is shown in the box titled “Calculation Time”, which is located in the bottom right hand corner of the Input Data box, as shown in Fig. 5. For the normal brain of this specific patient, it took approximately 81.2 seconds to complete the calculation.After the completion of the multi-phase BED calculations, the data analysis tool becomes active. Figs. 6–8show examples of original dose distribution, BED distribution and comparison data between BEDApp and BEDTrue. In addition, if there is interest in viewing the BED distribution in each of the dose slices acquired from Pinnacle, the selection of that option from the pulldown menu “Choose Analysis” provides this possibility. Fig. 9 shows such an example.As seen in Figs. 6 and 7, there is a similarity in the shape of the curves. In other words, the BED values are slightly larger than the dose values, and the dose and BED distributions are similar. Fig. 7 then shows the overlap of the BEDTrue and BEDApp curves showing that there are relatively insignificant differences in their values. The overlap of the BED curves shows insignificant differences but to get a closer look at the quantitative differences between the multi-phase BEDs calculated through different methods, the BA Analysis is used. Since this program calculates the BED distribution by calculating the BED for each voxel in the dose distribution matrices, each dot within the BA Analysis plot represents the percent error for that specific voxel. As seen, the maximum percent error for this brain cancer case is 4.46%. A quick note of BEDApp is that it will always be less than BEDTrue as seen in the BA Analysis. Despite the largest percent error being 4.46%, the majority of the voxels had percent errors less than about 2%. This statistical analysis gives a detailed view of the accuracy and precision, depending on the voxel's dose per fraction.Regarding the SBRT multi-prescription Summation utility, after the BED calculation, the prescriptions need to be entered before selecting the “Calculate” button in the window “SBRT Multi-Prescription Summation”. Following that, the statistical data will appear. The toolkit gives the possibility to determine the organ volume that receives a specific dose, by entering that dose value to “Dose Limit” and selecting “Calculate Vol. Limit”.Several facts were revealed regarding BEDApp and its clinical application. The first fact is that as long as the DPFs delivered at a given spatial point by the two phases are equal, BEDApp will always be equal to BEDTrue. If the DPFs are not equal then the error depends upon other factors that determine the magnitude of BED such as the number of fractions in the two phases and α/β. These points are demonstrated in Fig. 10, where the plots show diagrams of Percent Error of BEDApp versus DPF ratio for different clinical situations. As shown, if the DPF at the same spatial position between the two phases are equal, then the DPF ratio is 1 and there is no percent error. If the DPF ratio is not 1, the change in the magnitude of error depends on other factors. Knowing the values of those factors might lead to a better approximation of the BEDTrue.As was shown in Fig. 8, many of the spatial points of the normal brain had insignificantly different DPF values between the two phases. Furthermore, the number of fractions of the primary and boost phases were such that the change in error with respect to the DPF ratio was insignificant, as shown in Fig. 10.This toolkit can also be used to study different organs, both parallel and serial, to reveal the clinical impact of their structural differences. When dealing with parallel organs, a certain amount of volume needs to be irradiated in order to lead to complications, whereas serial organs require a relatively small amount of volume to be damaged in order to cause a functional failure of the whole organ. The use of BED distributions should improve the accuracy of current NTCP models as Mavroidis et al has shown [13].Data acquired from ten prostate and ten brain cancer patients revealed the accuracy and precision of BEDApp when the present toolkit was used to analyze them. Fig. 11shows the Pearson's correlation coefficient (PCC), the average DPF ratio, and the average percent error in a bar plot, as they are produced by the toolkit.Fig. 11 reveals the accuracy and prediction of BEDApp against BEDTrue regarding Rectum, Spinal Cord, and Normal Brain had relatively large percent-errors. For other organs such as Bladder, Optic Chiasm and Brainstem, the average percent errors were slightly larger and less precise.The present toolkit can also be used to reveal the cases where BEDApp can be used with confidence for calculating the maximum multi-phase BED when serial organs are involved. Currently, there is a conservative approach according to which the maximum BED is calculated by finding the maximum dose within the two phases (ignoring the spatial information), and then converting each of those values to BED before their summation. Another approximate approach involves the calculation of the composite dose distribution and the conversion of its maximum dose to BED. In Fig. 12, the latter approach is denoted as “Met 1” and the former method as “Met 2”.Fig. 12 reveals the accuracy of each method relative to the maximum BEDTrue. As seen, for the cases of the left and right optic nerves (LON and RON), Spinal Cord, Optic Chiasm, and Brainstem, Met2 appears to be more accurate than Met1. However, for the cases of the Normal Brain, Rectum, and Bladder, Met1 is shown to be more accurate than Met2.In summary, due to the unpredictability of the accuracy of BEDApp due to several factors such as the number-of-fractions and dose distributions, it is strongly recommended to use BEDTrue to reduce the overall uncertainty within the treatment of the patient and in this sense the clinical use of the presented toolkit becomes imperative.The software package that was used to create this toolkit was MATLAB 2010b (version 7.10, the MathWorks Inc., Natick, MA, 01760, USA). The toolkit runs on an Intel® Xeon® CPU E5540 @ 2.53 GHz (2 Processors) with 12.0 GB installed memory RAM. The operating system type is 64-bit and the speed of calculations of the toolkit strongly depends on the processor speed and memory RAM size.The toolkit is available as a MATLAB-based software package upon request from the authors via the electronic mail.

@&#CONCLUSIONS@&#
