@&#MAIN-TITLE@&#
Integrating rotation and angular velocity from curvature

@&#HIGHLIGHTS@&#
The problem: Determine the rotation and the angular velocity from a given curvature.The quaternions are used to parameterize the rotation.An approximate solution for the rotational quaternion is an exponential function.The approximate angular velocity is obtained from the integrability condition.Numerical tests show the solutions to be accurate and stable.

@&#KEYPHRASES@&#
Curvature,Angular velocity,Rotational quaternion,Integration of rotational quaternion from curvature,Integration of angular velocity from curvature,Initial-value problem,

@&#ABSTRACT@&#
The problem of integrating the rotational vector from a given angular velocity vector is met in such diverse fields as the navigation, robotics, computer graphics, optical tracking and non-linear dynamics of flexible beams. For example, if the numerical formulation of non-linear dynamics of flexible beams is based on the interpolation of curvature, one needs to derive the rotation from the assumed curvature field. The relation between the angular velocity and the rotation is described by the first-order quasi-linear differential equation. If the rotation is given, the related angular velocity is obtained by the differentiation. By contrast, if the angular velocity is given, the related rotations are obtained by the integration. The exact closed-form solution for the rotation is only possible if the angular velocity is constant in time. In dynamics of non-linear flexible spatial beams, the problem of integrating rotations from a given angular velocity becomes even more complex because both the angular velocity and the curvature need simultaneously be integrated and are both functions of space and time. As the angular velocity and the curvature are assumed to be analytic functions, they must satisfy certain integrability conditions to assure the unique rotation is obtained from the two differential equations. The objective of the present paper is to derive approximate, yet closed-form solutions of the following problem: for a given curvature vector, determine both the rotation and the angular velocity. In order to avoid the singularity of kinematic relations, the quaternions are used for the parametrization of rotations, and the integrations are partly performed in the four-dimensional quaternion space. The resulting closed-form expressions for the rotational and angular velocity quaternions are ready to be used in the finite-element formulations of the dynamics of flexible spatial beams as interpolating functions. The present novel solution is assessed by comparisons of the numerical results with analytical solutions for variety of oscillating curvature functions, as well as with the solutions of the quaternion-based midpoint integrator and the Runge–Kutta-based Crouch–Grossman geometrical methods CG3 and CG4.

@&#INTRODUCTION@&#
The problem of integrating the rotational vector from a given time-dependent angular velocity vector is met in such diverse fields as the navigation, robotics, computer graphics, and dynamics of rigid bodies. For example, in a strapdown inertial navigation system [1–5], the body-fixed gyroscopes measure the instantaneous angular velocity of a space vehicle, which is on-line numerically integrated to obtain the instantaneous coordinate transformation matrix between the body-fixed and the spatial coordinate systems needed to establish the attitude of the vehicle. Obviously, having an accurate, stable and computationally efficient integration is vital in controlling the spatial position of such systems in flight. The same integration problem must be solved in real-time optical tracking of a human body motion, which is related to problems in robotics and computer graphics [6,7].A further significant example is met in computational structural mechanics in the study of non-linear dynamics of flexible beams if the numerical formulation is based on the interpolation of curvature as in, e.g. [8,9]. There one needs to derive the rotation from the assumed curvature field when given in terms of the arc-length parameter. This is essentially the same problem as described above, because the differential equations for both the angular velocity and the curvature in terms of the rotation are formally the same.The relation between the angular velocity (or curvature) and the rotation is described by the first-order quasi-linear differential equation. When the rotation is a given function, the related angular velocity (or curvature) is obtained by the differentiation. When the angular velocity (or curvature) is given, the related rotations must be obtained by the integration. The exact closed-form solution for the rotation is possible for angular velocities and curvatures, respectively, only if some further conditions are satisfied; e.g. if the angular velocity is constant in time. An alternative solution in terms of an infinite series is known for any analytic angular velocity (or curvature), see, e.g. [1,10]. Such a solution is computationally inefficient. Various numerical time-integration schemes have been introduced and their performance discussed, see, e.g. [11,12] or [13,10] for the references related to the structural mechanics problems. In [14] it is investigated how the choice of the parametrization of rotations effects accuracy and computational efficiency of various numerical time-integration schemes by comparing three different rotation parameterizations, i.e. the rotational vector [15,16,8], the Argyris tangential vector [15] and the rotational quaternion [17], if combined with two alternative midpoint rules [13,14] or the classical fifth-order Runge–Kutta method. Andrle and Crassidis [11] employ the Crouch–Grossman geometric methods and compare their results with the Runge–Kutta algorithms. Chiou et al. [12] developed a family of general high-order numerical time integrators that exactly preserve the constraint of the rotational quaternion.In dynamics of non-linear flexible spatial beams, the problem of integrating rotations from a given angular velocity becomes even more complex because both the angular velocity and the curvature need simultaneously be integrated and both are functions of independent variables x and t. As the angular velocity and the curvature are assumed to be analytic functions, they must satisfy certain integrability conditions to assure that the unique rotation is obtained from the two differential equations. Our objective here is thus to derive approximate yet closed-form solutions of the following problem: for a given curvature vector dependent on two variables, x and t, determine both the rotation and the angular velocity. In order to avoid the singularity of the kinematic relations [15,18], the quaternions are used for the parametrization of rotations in the present paper, and the integrations are partly performed in the four-dimensional quaternion space. The resulting closed-form expressions for the rotational and angular velocity quaternions could be used in refined, finite-element type of numerical formulations of the dynamics of flexible spatial beams as the interpolating functions.Quaternions have recently often been discussed in structural mechanics literature, see, e.g. [19,20,17], so that only equations essential for the present study are given. A systematic presentation of quaternions can be found elsewhere [21,22].The quaternion,a^, is a four-component element, defined as a formal sum of a scalar and a vector:a^=a0+a⇀. For two arbitrary quaternions,a^=a0+a⇀andb^=b0+b⇀, and a scalar, λ, the following operations are defined:(i)sum:a^+b^≔a0+b0+a⇀+b⇀=b^+a^,multiplication by a scalar:λa^≔λa0+λa⇀,multiplication by a quaternion:a^∘b^≔a0b0-a⇀·b⇀+b0a⇀+a0b⇀+a⇀×b⇀.The quaternion multiplication is associative:a^∘(b^∘c^)=(a^∘b^)∘c^, yet it is not commutative, becausea^∘b^-b^∘a^=2a⇀×b⇀. Quaternions are elements of the 4D vector space.The null quaternion is defined as0^=0+0⇀. The identity quaternion is1^=1+0⇀. Hencea^+0^=0^+a^=a^,0^∘a^=a^∘0^=0^and1^∘a^=a^∘1^=a^. The conjugated quaternion is defined asa^∗=a0-a⇀. This implies that(a^∘b^)∗=b^∗∘a^∗. The norm of a quaternion is defined asa^=a^∘a^∗=a02+a⇀2. The quaternion whose norm is 1 is the unit quaternion. In what follows, the unit quaternion will play a remarkable role and will be denoted byq^. The inverse of a quaternion,a^-1, satisfies the conditiona^-1∘a^=a^∘a^-1=1^; hence [22](1)a^-1=a^∗∥a^∥2.If∥a^∥=1,(2)a^-1=a^∗anda^∘a^∗=a^∗∘a^=1^.The scalar part of a pure quaternion is zero:a^pure=0+a⇀. This impliesa^pure∗=-a^.A quaternion can also be written in an alternative polar forma^=∥a^∥(cosθ+a⇀nsinθ), wherea⇀n=a⇀∥a⇀∥is the unit vector,n⇀; angle θ is extracted from the quaternion usingcosθ=a0∥a^∥andsinθ=∥a⇀∥∥a^∥. When the quaternion is unitary, its norm is 1; thus(3)if∥q^∥=1,thenq^=cosθ+n⇀sinθ.Now we show that the unit quaternionq^=q0+q⇀represents the rotation of a quaternion in 4D. Because the quaternion product is not commutative, the left and the right multiplications of a quaternion,a^, with the unit quaternion,q^, yield two different quaternions(4)a^L=q^∘a^,a^R=a^∘q^,but their norms remain equal to∥a^∥:∥a^L∥2=a^L∘a^L∗=(q^∘a^)∘(q^∘a^)∗=q^∘a^∘a^∗∘q^∗=∥a^∥2q^∘q^∗=∥a^∥2,∥a^R∥2=a^R∘a^R∗=(a^∘q^)∘(a^∘q^)∗=a^∘q^∘q^∗∘a^∗=∥a^∥2.This shows that both the left and the right multiplication with the unit quaternion represent the rotation of a quaternion in 4D. The resulting quaternions are not pure quaternions, however.Similarly, the 3D rotation of a vector must result in a 3D vector whose length is preserved. Consequently, if a vectora⇀is represented by a pure quaternion,a^=0+a⇀, it should remain such in the rotated position. Hence, the 4D rotation of a pure quaternion should result in a pure quaternion. By performing explicit multiplications it can be shown that the following composition of two subsequent multiplications with the unit quaternionq^(5)a^rot=q^∘a^∘q^∗yields the pure quaterniona^rot=0+a⇀rot. As, furthermore, the norm ofa^does not change in the 4D rotation (5)∥a^rot∥2=a^rot∘a^rot∗=q^∘a^∘q^∗∘(q^∘a^∘q^∗)∗=q^∘a^∘q^∗∘q^∘a^∗∘q^∗=∥a^∥2,q^∘a^∘q^∗represents the rotation of vectora⇀in 3D indeed.Becauseq^andq^∗each rotates by the same angle [22], their composition (5) results in the double angle rotation. Thus the double left–right operation (5) with the unit quaternion(6)q^(ϑ,n⇀)=cosϑ2+n⇀sinϑ2on an arbitrary pure quaterniona^=0+a⇀results in a pure quaterniona^rot=q^∘a^∘q^∗=0+a⇀rot, being rotated froma^by angle ϑ about axisn⇀.For the presentation of the quaternions in the 4D matrix form, we need to introduce the 4D quaternion basis. By the rule, two bases are typically utilized in mechanics, i.e. the spatial quaternion basis,B^g, which is fixed in space, and the body quaternion basis,B^G, attached to the moving body, such thatg^i=0+gi⇀, andG^i=0+Gi⇀(i=1,2,3), andg^0=G^0=1+0⇀. Heregi⇀andGi⇀are the orthonormal Cartesian base vectors in the 3D vector space. Such a choice clearly results in an orthonormal basis of the 4D quaternion space. Then any quaterniona^can be represented relative to the spatial or the body quaternion basis, respectively, by one-column matrixa^g=ag0ag1ag2ag3Tora^G=[aG0aG1aG2aG3]T. Here and in what follows, the hat over a bold-face sans-serif symbol is used to denote that a column, row or matrix belongs to the 4D space. For example, the matrix form of the rotational quaternion in the spatial basis is denoted asq^=[q0q1q2q3]T.The double quaternion product ona^in Eq. (5) can be replaced by the action of the4×4matrixQ^(q^)on a column,a^=[0a1a2a3]T, representing pure quaterniona^. MatrixQ^is orthogonal:Q^TQ^=Q^Q^T=I^.We employ the rotational quaternion to describe the rotated position of the quaternion body basis with respect to the spatial one. When the rotational quaternion is a function of time,q^(t), the quaternion body basis also changes with time. Using rule (5) the body quaternion basis can be represented by the spatial quaternion basis as(7)G^0=g^0=1+0⇀,G^i(t)=q^(t)∘g^i∘q^∗(t),i=1,2,3.The time derivatives are given byG^̇0=0^and(8)G^̇i(t)=q^̇(t)∘gi^∘q^∗(t)+q^(t)∘g^i∘q^∗̇(t).Substitutingg^iwithG^i(t)using the left version of Eq. (4) and considering the relation(q^̇∘q^∗)∗=q^∘q^∗̇=-q^̇∘q^∗in Eq. (8) yieldsG^̇i(t)=0+b⇀(t), whereb^(t)=2q^̇(t)∘q^∗(t)∘G^i(t). The quaternion(9)ω^=2q^∗∘q^̇is called the angular velocity quaternion in the body basis. On considering the definition of the quaternion product and the matrix formsq^=[q0q1q2q3]Tandω^=[ω0ω1ω2ω3]Tone obtains the matrix form of Eq. (9) as(10)ω^=ω0ω1ω2ω3=2q0q̇0+q1q̇1+q2q̇2+q3q̇3-q1q̇0+q0q̇1+q3q̇2-q2q̇3-q2q̇0-q3q̇1+q0q̇2+q1q̇3-q3q̇0+q2q̇1-q1q̇2+q0q̇3.Differentiating the norm of the rotational quaternion∥q^∥=q02+q12+q22+q32=1with respect to t yields(11)2(q0q̇0+q1q̇1+q2q̇2+q3q̇3)=0.This shows thatω0=0and proves thatω^is a pure quaternion,ω^=0+ω⇀, whose vector part is the classical angular velocity vectorω⇀. If the angular velocity quaternion,ω^(x,t), is a given function of both x and t, the rotational quaternionq^(x,t)is the solution of the initial-value problem(12)q^̇=12q^∘ω^,q^(x,t0)=q^t0(x).The curvature quaternion,κ^(x,t), is defined in a similar manner, only that the differentiation is performed with respect to the spatial coordinate x:(13)κ^=2q^∗∘q^′.Ifκ^(x,t)is a given function, the rotational quaternionq^(x,t)thus represents the solution of the initial-value problem(14)q^′=12q^∘κ^,q^(x0,t)=q^x0(t),being formally equivalent to the initial-value problem (12) only that this time it is set with respect to x. Note the difference in the initial values forq^in Eqs. (12) and (14). Differentiating the norm of the rotational quaternion with respect to x yields2(q0q0′+q1q1′+q2q2′+q3q3′)=0. This implies thatκ^is a pure quaternion,κ^=0+κ⇀, too. It describes the rate of change of the direction of the unit tangent of a spatial curve if a point moves along the curve with constant velocity. In what follows, we wish to find the solutions of the two initial-value problems, (12) and (14), forq^(x,t)andω^(x,t), ifκ^(x,t)is a given function of x and t. Let us first discuss the solution of the initial-value problem set in Eq. (14).Eq. (14) can be written in the 4D matrix form with respect to the quaternion body basis,B^G, as:(15)q^′(x,t)=12K^(x,t)q^(x,t)orq0′q1′q2′q3′=120-κ1-κ2-κ3κ10κ3-κ2κ2-κ30κ1κ3κ2-κ10q0q1q2q3,where we have considered thatκ0=0. Eq. (15) represents a homogeneous system of quasi-linear ordinary differential equations for unknown rotational quaternionq^(x,t)whose system matrix,K^(x,t), has a convenient property of being skew-symmetric:K^=-K^T. When combined with the initial condition thatq^(x0,t)=q^x0(t), whereq^x0(t)is a given function, the differential Eq. (15) constitutes the 4D initial-value problem set in the matrix form. It must be observed that the components of matrixK^all depend on both x and t, although only the derivative with respect to x is active in this particular equation.WhenK^is given, the unknown function in Eq. (15) is the rotational quaternion. As the rotational quaternion must necessarily preserve its length,∥q^∥=1, and has to assume the valueq^x0atx=x0, the exact solution must have the form of the rotation in the 4D space:(16)q^(x,t)=Q^(x,t)q^x0(t),Q^Q^T=I^.Insertingq^from Eq. (16) into Eq. (15) yieldsQ^′Q^T=12K^. AsQ^is orthogonal, it may alternatively be described by the exponential map if parametrized in terms of a 4D skew-symmetric matrixL^=-L^T,(17)Q^=eL^,L^=-L^T.Then(18)q^(x,t)=eL^(x,t)q^x0(t).After differentiatingq^with respect to x, employing the result and Eqs. (17) and (18) in Eq. (15) and, finally, cancelling outq^x0from the equation, we obtain(19)L^′=12(eL^)TK^eL^.This represents the differential equation forL^(x,t). The problem of solving Eq. (15) has thus been replaced by another problem of solving Eq. (19). Unfortunately, the latter appears to be even harder than the original problem to solve.It is well known [23] that the exact solution of the initial-value problem with a homogeneous system of differential Eqs. (15) at an arbitraryx=x2reads(20)q^(x2,t)=eK^int(x2,t)q^(x1,t),whereq^(x1,t)is the initial value atx=x1, andK^intdenotes the skew-symmetric matrix(21)K^int(x2,t)=12∫x1x2K^(ξ,t)dξ=-K^intT,provided that the condition(22)K^(x2,t)K^(x3,t)=K^(x3,t)K^(x2,t),∀(x2,x3)∈[x1,x2]is satisfied. The above condition is equivalent to the requirement of the commutativity of the matrix product ofK^andK^′:(23)K^(x,t)K^′(x,t)=K^′(x,t)K^(x,t),∀(x∈[x1,x2],t).If the curvature is constant, it follows thatK^′=0^and Eq. (23) is identically satisfied. Therefore, in this particular case, the solution (20) is exact. If the curvature is not constant, condition (23) results in two independent scalar equations(24)κ1(x,t)κ2′(x,t)=κ2(x,t)κ1′(x,t),(25)κ1(x,t)κ3′(x,t)=κ3(x,t)κ1′(x,t).To fulfil the above two conditions, the componentsκiof matrixK^must have the same spatial and time variation, which does not hold true generally. When the interval[x1,x2]decreases, conditions (22) or (23) tend to be more and more satisfied, though; thus the solution (20) approaches to the exact solution in the limit. In what follows the approximate solution (20) is employed for constructing an approximate solution for the unknown rotational quaternion. As seen from Eq. (20), the variation of the curvature with x is accounted for in the proposed solution by an integral ofκover the observed interval[x1,x2]. Furthermore, the matrix exponential needs to be evaluated.The matrix exponential function of a 4D skew-symmetric matrix can be expressed in an analytical, closed-form solution [11,7,5,24]. To that end, the 4D axial vectork̃intofK^intis introduced first:(26)k̃int=k̃0k̃1k̃2k̃3=120∫x1x2κ1(ξ,t)dξ∫x1x2κ2(ξ,t)dξ∫x1x2κ3(ξ,t)dξ.Then the matrix exponential function reads(27)eK^int=Q^K=cos∥k̃int∥I^+sin∥k̃int∥∥k̃int∥K^int,Q^KQ^KT=Q^KTQ^K=I^,whereQ^Kis the rotation matrix andI^the identity matrix in 4D, and∥k̃int∥=k̃12+k̃22+k̃32is the norm ofk̃int. The approximate solution (20) atx=x2then takes the form(28)q^(x2,t)=Q^K(x2,t)q^(x1,t).The differential equations for the rotational quaternion in terms of either the angular velocity or the curvature agree in form. Thus the approximate solution of Eq. (12) is also given as(29)q^(x,t2)=Q^Ω(x,t2)q^(x,t1),where the approximation of the rotation operator related to the given angular velocity is denoted byQ^Ω, and assumed in the form(30)Q^Ω=cos∥ω̃int∥I^+sin∥ω̃int∥∥ω̃int∥Ω^int.Here∥ω̃int∥=ω̃12+ω̃22+ω̃32is the norm of the 4D angular velocity vectorω̃int,(31)ω̃int=ω̃0ω̃1ω̃2ω̃3=120∫t1t2ω1(x,η)dη∫t1t2ω2(x,η)dη∫t1t2ω3(x,η)dη,being the axial vector of the skew-symmetric matrixΩ^int:(32)Ω^int(x,t2)=12∫t1t2Ω^(x,η)dη=-Ω^intT,where(33)Ω^=0-ω1-ω2-ω3ω10ω3-ω2ω2-ω30ω1ω3ω2-ω10.The angular velocity and the curvature quaternion are related to the rotational quaternion via Eqs. (9) and (13). If the rotational quaternion,q^, is a given function of x and t, the two functions,ω^andκ^, can uniquely be determined fromq^using the differentiation. If, alternatively,κ^(x,t)is given, Eq. (13) must be integrated with respect to x to obtain the rotational quaternion. The angular velocity then follows by the differentiation of the rotational quaternion with respect to t. This shows that the angular velocity and the curvature are mutually dependent functions. The relation of dependency is derived next.The relation betweenω^andκ^is obtained by the elimination of the rotational quaternion from Eqs. (9) and (13). To that end, Eq. (9) is differentiated with respect to x, Eq. (13) with respect to t, and the differentiated equations are subtracted. Upon considering smoothness ofq^(x,t)in x and t and after some mathematical manipulations we obtain(34)ω^′-κ^̇=12(ω^∘κ^-κ^∘ω^).This is the relation thatω^andκ^need to satisfy in order to assure the unique integrability of Eqs. (9) and (13) forq^. Asω^andκ^in Eq. (34) are pure quaternions, the above equation is conveniently rewritten in the 3D matrix form as(35)ω1′ω2′ω3′=-0-κ3κ2κ30-κ1-κ2κ10ω1ω2ω3+κ̇1κ̇2κ̇3or, in the compact matrix form(36)ω′=-Kω+κ̇.Note that the variables in Eq. (36) are columns and matrices in the 3D space. Eq. (36) constitutes a quasi-linear inhomogeneous system of three scalar differential equations of the first order forωin terms ofκ. Because no closed-form exact solution of Eq. (36) exists generally, we construct an approximate solution based on the assumption that the solution of the homogeneous part of the equation has the form of an exponential map in Eq. (20).An approximate solution of Eq. (36) for the angular velocity atx=x2is assumed in the form of the sum of the fundamental and the particular solutions [23](37)ω(x2,t)=e-∫x1x2K(ξ,t)dξω(x1,t)+∫x1x2e-∫ηx2K(ξ,t)dξK̇(η,t)dη.It is easy to show that the arguments in matrix exponential functions in Eq. (37) are skew-symmetric 3D matrices. For such matrices the matrix exponential is given by the exact closed-form Rodrigues formula [15]:(38)Rod(A)≔eA=I+sin∥ã∥∥ã∥A+1-cos∥ã∥∥ã∥2A2,A=-AT.HereIis the 3D identity matrix,A=-ATis the 3D matrix andãits axial vector. Introducing Eq. (38) into Eqs. (37) yields(39)ω(x2,t)=Rod-∫x1x2K(ξ,t)dξω(x1,t)+∫x1x2Rod-∫ηx2K(ξ,t)dξK̇(η,t)dη.We must note that the integrals in Eq. (39) are generally not analytically solvable and are hence here solved numerically using the 2-point Gaussian integration. The second integral represents a nested integral with a running lower bound. It is evaluated for two lower bounds which are chosen as Gaussian integration points in interval[x1,x2].The above result for the angular velocity follows, if the curvature is given. When the angular velocity is given, the fully analogous derivation results in the solution for the curvature which is formally the same as the one presented in Eq. (39). As it can be constructed by analogy, we do not display it here.The complete similarity between Eqs. (9) and (13) may suggest that the functional forms of the angular velocity and the curvature are the same. The solution (39) does not confirm this. If the curvature is, e.g. a linear function of x, the angular velocity appears to be some non-linear function of t.The proposed approximate solutions (28), (29) and (39) will now be employed to test their validity, accuracy and stability. We will discuss both the integration of the rotational quaternion and the integration of the angular velocity from the given curvature.In order to assess the present approximate solution (28), we choose an analytical expression for the rotational vector,ϑ(x), and derive exact expressions for the related rotational and curvature quaternions [14]. Then the integration interval,[0,10], is divided into subintervals,[xp,xp+1], here termed steps, and approximate results forq^p+1are evaluated on the basis of the given curvature quaternion. The numerical results for the rotational quaternion are compared with the given exact ones at the end of each step to obtain the current global error. Additionally, the maximum global error over the whole integration interval is introduced which is defined as(40)err(f)=max∥f(xp)-fp∥,where f is the variable under the analysis,f(xp)the exact solution atxp, andfpits approximation. The associated location where the maximum error occurs is denoted byxm. As in [14,10], we choose several characteristic rotational vector functions to test the method for various kinds of rotational behaviour. The use of Eq. (28) requires that the integral ofκ^(x)over the integration step[xp,xp+1]is evaluated. Ifκ^(x)is a polynomial of a low degree, the integration is analytic. Often, as it is also the case in the present study,κ^(x)is not analytically integrable or is its analytical integral inefficient for the evaluation. To overcome accuracy and/or efficiency problems, we here employ the Gaussian numerical integration of an appropriate degree. The 2-point Gaussian integration is employed here since the curvature functions used in the subsequent numerical tests are only low-order functions within an integration step, although not necessarily polynomials. As it will become clear later on, this gives very satisfactory results.In our first test the rotational vector varies linearly withx:(41)ϑ(x)=8x,0.5x,-xT.The associated curvature vector is constant,κ=[8,0.5,-1]T[10]. The results for the interval[0,10]are presented in Table 1and in Figs. 1–3.Fig. 1 shows that the components of the rotational quaternion related to a constant curvature are simple harmonic functions of x. The figure compares the exact and the present results. They agree completely. This is to be expected because solution (28) is, for the present case of the constant curvature, exact for any step size. Thus any error could only occur due to machine round-off errors. This is also demonstrated in Table 1, where the maximum global errors in the rotational quaternion and all its components are shown to be smaller than10-14for step sizesΔx=1.0, 0.1 and 0.01. Note that the global round-off errors are generally about one order of magnitude larger for the smallest step size which is due to a substantially larger number of steps. One may observe from Fig. 2 that the absolute global errors in the quaternion components oscillate nearly periodically about the mean error where the period is roughly equal to 0.7 ifΔx=0.01. The period appears to be about the same for all quaternion components. This pattern of error behaviour is observed in all the subsequent numerical tests. Because our primary aim is to assess maximum errors, Fig. 3 depicts the evolution of the maximum global errors in the form of maximum envelopes. This form will, in what follows, become our standard to presenting the evolution of errors.This time the rotational vector varies quadratically withx:(42)ϑ(x)=0.01x2,0.04x2,0.25x2-0.04T.The mathematical form of the related curvature components is rather involved and is given in Appendix A. By contrast, when drawn as graphs, they appear to look just like straight lines. Note that Eqs. (22) and (23) are now not satisfied, so that the formula given in Eq. (28) is only approximate. The results for the interval[0,10]are presented in Table 2and in Figs. 4 and 5.Fig. 4 shows the graphs of the components of the rotational quaternion as functions of x. Within the graphical accuracy, they match the exact ones perfectly. Please note the oscillating shape of these graphs with the decreasing period of oscillations.The maximum global errors in the rotational quaternion components are displayed in Table 2. ForΔx=0.1, they range from roughly10-6to10-9. When the step size is 10 times smaller,Δx=0.01, the error decreases by10-2. Notice that the unit norm of the rotational quaternions is always preserved within the round-off error precision.Zupan and Zupan [10] also used the present example for making comparisons between several integration methods of different orders. They compared the methods derived from the Taylor series, the exponential map, the Cayley transform and several modified forms of truncated power series. However, only their results from the second-order methods, in [10] denoted byExp12andZed212, could compete with the present ones in terms of accuracy of componentq0. Their disadvantage that the norm of the rotational quaternions is not unitary resulting in the error of about10-6still remains, however.The graphs in Fig. 5 show the evolution of the maximum envelopes of the global errors in the rotational quaternion components and in the norm of the rotational quaternion. The general trend of errors is similar as in the previous numerical test, showing that the maximum global error soon remains nearly constant. This indicates the method’s good potential in solving long-range problems.The rotational vector(43)ϑ(x)=0,0.04x2,0.25x2+2xTyields an almost linear curvature whose third component is not zero initially. Its mathematical form is rather involved, but the graphs of its components look very much like straight lines. It will be observed that the fact thatκ(x)is not zero atx=0decreases the accuracy somewhat.Fig. 6shows the graphs of the components of the rotational quaternion as functions of x. Within the graphical accuracy, they match the exact ones perfectly. Asq1is very small in this particular case, its graph is further displayed in Fig. 7in an enlarged scale.Table 3shows the maximum global errors of the present method for three step sizes. As observed from the table, the maximum global errors in rotational quaternion components revolve from around10-4to10-7forΔx=0.1. The norm of the quaternion is well preserved in all the cases. The results forΔx=1.0,0.1and 0.01 show that the results improve by about two orders of magnitude when the step size decreases by factor 10.Next we compare the results of the present method with the results of the third-order methods of Zupan and Zupan [10]. Although their results of theExp13method experience quite a small maximum global error10-6in the componentq0forΔx=0.1, the error of the norm of the whole quaternion appears to be much bigger (about10-3) compared to the present result (10-15). This indicates the presence of some much larger error in the remaining components of the rotational quaternion not presented in their paper. The norm of the rotational quaternion remains non-unitary even though their improved third-order methods are employed, where the global error of the norms of rotational quaternions estimated by theExp23andZed223methods is about10-6, and the related error ofq0is about10-8.The graphs in Fig. 8show the maximum envelopes of the global integration errors in the rotational quaternion components andq^. It is clear that the maximum error envelopes of both the single components and the whole quaternion stay practically constant. This is a very desired property in solving long-range problems.This example, borrowed from Zupan and Zupan [10], employs the rotational vector exhibiting large amplitude components and oscillations with different frequencies:(44)ϑ(x)=5cosx,sin4x,xT.The graph of the related curvatureκis presented in [10].Table 4shows the results of the present method forΔx=1.0,0.1,0.01and 0.001. The maximum global integration errors in rotational quaternion components range from10-1and10-6, respectively. The unit norm of the rotational quaternions is well preserved in all the cases.The analogous results of [10] for the maximum global errors inq0and∥q^∥obtained with the third-order methods assuming very small step sizeΔx=0.01outperform the present one inq0by factor10-1. Although their results of theExp23,Zed23andZed223methods experience quite a small maximum global error10-6in componentq0, the error in the norm of the rotational quaternion appears to be much bigger (10-6) compared to the present result (10-15).Fig. 9compares the variations of rotational quaternion components of the exact and the present results forΔx=0.01. Within the graphical accuracy, the present results match the exact ones perfectly.The accompanying Fig. 10shows the maximum envelopes of the global errors in quaternion components and its norm. It can again be observed that the envelopes of the maximum errors remain practically constant with increasing x. The actual global errors of particular components of the rotational quaternion may, however, substantially differ for different x’s. This is also apparent from the results in [10].The advantages of using the closed-form formula, Eq. (28), are that it automatically preserves the unity of the rotational quaternion and considers changing of the curvature within an integration step which both improve accuracy of the solution. Its less desired property is a higher computational demand. By contrast, the quaternion-based midpoint integration method, introduced and tested in [14], is computationally efficient in a step, yet it is less accurate globally and does not preserve orthogonality by the definition. Now we compare the two methods and the well known Crouch–Grossman methods [25,26] in their behaviour.Let us assume that the curvature quaternion is the following linear function of x:(45)κ^(x)=0,10x-2,2x,-x+4T.The solution will be determined by both the midpoint method (later on referred as MP-q) [14] and by Eq. (28) (referred as EM4). The latter, with a very small step size,Δx=2·10-4, is taken as the referential solution.Fig. 11shows the variation of the rotational quaternion components with x for the referential solution. It is interesting to see that the linearly varying curvature implies such a high frequency oscillating behaviour of the quaternion components. Fig. 12shows an enlarged view of the variation of componentq0for three step sizes and two methods, EM4 and MP-q, in a sub-intervals[0,3]and[9,10]. Initially only MP-q with a larger step-size,Δx=0.1, differ somewhat from the referential results. Later on the results of the MP-q method with bothΔx=0.1and 0.01 differ substantially, please observe a large horizontal stretching of the related graphs in Fig. 12. By contrast, a very good match between the results of the EM4 method forΔx=0.1,0.01and 0.0002 with no stretch can be observed.The results in Table 5indicate that the maximum global error in the rotational quaternion norm exhibited by the MP-q method is very small for any step size, while the errors in particular components are large; in fact, they are much larger than those experienced by the EM4 method, see Table 6. Recall also that the EM4 method is computationally more demanding than MP-q; e.g. for the data in Tables 5 and 6, the ratio of computing times was about seven; for the data in Table 8, discussed in the next sub-section, the ratio was about 2.5.Fig. 13presents graphs of the maximum envelope of the global error inq0for various step sizes and the two methods. One can see that the maximum global error of the MP-q method increases with x even for a very small step size,Δx=0.0002. This is in a sharp contrast to the EM4 method, where the global error stabilizes and remains nearly constant for any step size. Furthermore, for the step sizesΔx⩾0.01, the maximum global error inq0of the MP-q method approaches value 2. As the norm of the total rotational quaternion is constrained to be one, such a solution is wrong. Note that an artificial, brute-force normalization of the rotational quaternion after completing each step, does not help much because the norm of the quaternion is very close to 1 already.The rate of convergence of the two methods can be estimated from the left figure of Fig. 14. The figure shows the maximum global errors in theq0component after the integration over the whole interval[0,10]has been completed, in terms of the step size and the chosen method. As the graphs are depicted in the logarithmic scale, the 4th and the 2nd rate of convergence of the EM4 and the MP-q methods is easily observed.The rotational vector is assumed as [14](46)ϑ(x)=2+(sin2x)2,x,5x3-4xT.This is a highly oscillating function, whose amplitudes are mainly driven by the cubic polynomial5x3-4x. Consequently, the associated curvature is also an oscillating function, but the quadratic polynomial dominates the overall behaviour. The graphs of the related exact rotational quaternion components are shown in Fig. 15. Because the frequency of oscillations increases with x, and, consequently, the graphs are gradually getting blurred, only the part related to a smaller interval[0,4]is plotted in Fig. 15. Again, the graphs of the exact and the numerical solutions match nicely.Several different classical numerical solution methods presented in [14] were shown to be unable to obtain the solution of the present case due to increasingly fast oscillations of rotations. Unless sufficiently small step sizes were applied in [14], the local error was large and, consequently, the global maximum error was growing until the solution became unstable. On the other hand, if the step sizes were too small, the round-off errors accumulated and the solution diverged as well.Data in Table 7show that the MP-q method may produce large errors in components, although the global error in the norm of the quaternion is very small. The critical components appear to beq0andq3, whoseerr(·)approaches value 2 for any step size employed. Such a wrong value of the component occurs due to the horizontal stretching of the graphs, which is followed by loss of convergence. By contrast, the EM4 solution displayed in Table 8is stable and the accuracy is well improved by the decrease of the step size. The behaviour of the two solutions is also illustrated in Fig. 16where the graphs ofq0(x)for the EM4 (left) and MP-q (right) methods using a very small step size,Δx=0.0002, are displayed in a short interval[9.9,10.0]in an enlarged view. It is clear from Fig. 16 that the MP-q method results in the graph which is substantially horizontally stretched even for a very small step size 0.0002. Due to the horizontal stretch, the locations of the pick values of the exact and the approximate solutions are different, although the magnitudes of the pick values of the two methods almost agree, i.e.∣q0exact∣≐∣q0approx∣. When stretch becomes sufficiently large, say about one half of the period, the two pick values have opposite signs and the absolute error approacheserr(∣q0exact-q0approx∣)≐∣q0exact-(-q0approx)∣≐2∣q0approx∣. Hence ifq0approaches 1, the error approaches 2. Note from the figure that the EM4 method follows the exact graph perfectly.Convergence properties of the two methods are further displayed in the right figure of Fig. 14. As no improvement in accuracy is achieved, if the step size is decreased (see Table 7), the MP-q method yields a completely wrong result atx=10. The EM4 method, on the other side, shows the quadratic rate of convergence in terms of the absolute error.Fig. 17shows the variation of the maximum envelopes of the global error inq0for various step sizes and the EM4 and MP-q methods.Although not shown in the paper, the graphs of maximum envelopes of the global error in the rotational quaternion norm for the very small step sizeΔx=0.001and the two methods indicate that the maximum error of the EM4 method remains small over the whole range. The one of MP-q is initially small, too (less than10-14), but starts accumulating at some point, roughly atx=6, triggering the onset of instability. Reducing the quaternion to 1 after each integration step does not resolve the instability problem.Next, the results of the present method are also compared with those of the third and fourth order Crouch–Grossman (CG) Lie group methods CG3 and CG4 [25,26]. These methods are constructed using the concepts of the Runge–Kutta methods on the Lie groups. For example, the CG3 method is a three-stage algorithm to obtain the rotational quaternion,q^i+1, at new stepi+1as(47)K^(1)=12K^(ω^(xi)),(48)K^(2)=12K^(ω^(xi+34Δx)),(49)K^(3)=12K^(ω^(xi+1724Δx)),(50)q^i+1=e2417ΔxK^(3)e-23ΔxK^(2)e1351ΔxK^(1)q^i.Obviously, the CG3 method requires the evaluation of three matrix exponentials and their multiplications and is thus computationally much more demanding than EM4. Similarly, the CG4 method is a five-step method whose coefficients are provided in, e.g. [11,26]. The detailed description of methods CG3 and CG4 is presented in [25,26]. Note that the CG3 and CG4 methods preserve the unit norm by the definition.The results of the CG methods for the maximum global error inq0are depicted in Fig. 17. It is clear that the CG3 method performs about the same as the EM4 method for larger step sizes,Δx=0.1and 0.01, yet it is at least two orders of magnitude more accurate forΔx=0.001and 0.0002. These differences are even larger for method CG4 (Fig. 17). Note also that the present excellent result for the CG methods is not in keeping with the results of Andrle and Crassidis [11] who stated that both CG3 and CG4 suffer from a considerable round-off error accumulation.Three tests will be performed to validate the formula assumed in Eq. (39) and to assess its accuracy. We start with the assumption that the rotational quaternion is a given function of x and t, so that the exact closed-form expressions for the curvature and the angular velocity quaternions can be derived. The exact curvature quaternion is then employed to obtain the approximate values of the rotational and angular velocity quaternions, which are then compared to the exact ones. In the last test, we assume that the curvature rather than the rotational quaternion is given and evaluate both the rotational and angular velocity quaternions only numerically.The rotational quaternion is a given function of(x,t)as(51)q^(x,t)=cosx2t220,0.5sinx2t220,0.8sinx2t220,0.11sinx2t220T.Note that the above quaternion is unitary. It represents the planar rotation about the fixed axis[0.5,0.8,0.11]T. The exact curvature and the angular velocity quaternions as functions of(x,t)are easily derived from the above quaternion using Eqs. (12) and (9):(52)κ^=0,110,425,1150Txt2,(53)ω^=0,110,425,1150Ttx2.One can observe the co-linearity of the above two quaternions which is due to the fixed rotation axis. The conditions (24) and (25) are hence identically satisfied, see discussion in Section 4.2, so that Eq. (39) will, with the present choice of the rotational quaternion, yield the exact solution. This is confirmed in a square domain[0,5]×[0,5]by the numerical results displayed in Fig. 18where the numerical and the exact solutions for the componentsω1,ω2,ω3are depicted at timest=1,2,3,4,5. The step sizesΔx=Δt=0.1were applied in the integration. The global error of components at any of the discrete points of the square domain was found to be less than1.42·10-14. Therefore the exact and the numerical solutions match completely, which validates the proposed procedure.This time the rotations are spatial with the rotational quaternion whose axis of rotation is constrained to stay within a plane:(54)q^(x,t)=cos5xt,cos0.1tsin5xt,0.8sin0.1tsin5xt,0T.The exact curvature and the angular velocity quaternions as functions of(x,t)are derived from Eqs. (12) and (9) and read:(55)κ^=0,10tcos0.1t,10tsin0.1t,0T,ω^=010xcos0.1t-0.2sin0.1tcos5txsin5tx10xsin0.1t+0.2cos0.1tcos5txsin5tx-0.2sin25tx.Inserting Eq. (55) into Eq. (24) and (25) shows that the two conditions are not identically satisfied. Hence Eq. (39) does not yield the exact solution. The results are presented for a square domain[0,5]×[0,5]and displayed in Fig. 19where the numerical and the exact solutions for the componentsω1,ω2,ω3are depicted. The step sizesΔx=Δt=0.1were applied in the integration. The two solutions match nicely. Observe from Fig. 19 that the amplitudes of the componentω3remain very small but highly oscillating.In the curvature-based finite-element formulations of beams, the curvature takes the role of the basic unknown which needs to be approximated. With this in mind, let us assume that the curvature is given by(56)κ^(x,t)=0.1xt2,tsin2x,0.01x(1-et)Tand employ Eq. (39) in obtaining an approximation of the angular velocity at discrete points of the orthogonal grid(Δx=Δt=0.1)on a square domain[0,5]×[0,5]. Next, two separate sets of the rotational quaternions are derived by the integration, the first one from the given curvature (56) using Eq. (28), and the other one from the computed angular velocity employing Eq. (29). The initial conditions to these integrations are, respectively,ω^(x0,t)=ω^x0(t),q^(x0,t)=q^x0(t)andq^(x,t0)=q^t0(x). Because these two rotational quaternions should be the same, the error can be estimated as∥Δq^∥.Fig. 20shows the variation of the given curvature componentsκ1,κ2andκ3and the computed angular velocity componentsω1,ω2andω3on a square domain[0,5]×[0,5]employingΔx=Δt=0.1. One may observe that the components ofωoscillate much faster than those ofκwhen x and t approach point(5,5). When the computation is repeated with a finer mesh,Δx=Δt=0.05, the maximum norm ofωchanges by about0.5%.The two rotational quaternions, one obtained from the given curvature and the other one from the associated numerically integrated angular velocity, are compared in Fig. 21. To show that the differences between the two quaternions are really small, planar graphs of the quaternions are plotted on the parallel planest={1,2,3,4,5}. The differences between the componentsq0,q1,q2,q3of the two quaternions on the given domain could only be observed in a small area around point(5,5). We may thus conclude that the overall agreement is very good even when applyingΔx=Δt=0.1.

@&#CONCLUSIONS@&#
In dynamics of flexible spatial beams, the rotation, angular velocity and curvature vectors depend on both x and t. When the solution procedure is curvature-based, as e.g. in [8,9], the rotational and angular velocity vectors need to be obtained by the integration of the interpolated curvature. The paper employs the quaternion description to obtain an approximate, yet closed-form solution for the rotational quaternion which preserves the unity constraint exactly and makes possible to account for the actual curvature variation over the integration interval. In some rare cases, e.g. if the curvature is constant in x (although it may be an arbitrary function of t), the solution for the rotational quaternion is exact.The curvature and angular velocity vectors must satisfy certain integrability conditions to assure that the unique rotational quaternion is obtained. They have here been deduced and integrated approximately for the angular velocity as a function of the curvature. This closed form solution needs a nested integral to be evaluated numerically. The assumed interpolation for the curvature components, and the derived closed-form solutions for the rotational quaternion and the curvature vector may then be used as natural interpolations in a refined finite-element formulation of spatial beams.An extensive numerical study has been carried out where the numerical results have also been compared with the exact ones for a variety of oscillating rotations. The present rotational quaternion integration method has also been compared with the quaternion-based midpoint integrator [14] and two geometric Runge–Kutta-type of integrators of Crouch and Grossman [25,26]. It is confirmed that the present method results in a perfect agreement with the exact graphs of the quaternion components and preserves the unity of the rotational quaternion for a wide range of integration steps and oscillating functions. The Crouch–Grossman integrators CG3 and CG4 behave much alike to the present integrator and offer better accuracy, but are computationally much more demanding. This is to be contrasted to the results of the less accurate quaternion-based midpoint integration method [14] where often a significant horizontal stretching of graphs is exhibited even for very small step sizes. It must be noted that the horizontal stretching represents the main reason for an early and sudden instability of the midpoint integrator. The comparisons have also proved the validity of the proposed procedure for the angular velocity integration.