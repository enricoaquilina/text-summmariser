@&#MAIN-TITLE@&#
A practical vehicle routing problem with desynchronized arrivals to depot

@&#HIGHLIGHTS@&#
We solved a routing problem arising in the transportation of biomedical samples.The problem is approached as a multi-trip VRP with time windows.Real data were provided by the Quebec's Ministry of Health and Social Services.Desynchronization of arrivals to depot, an important issue in practice, is introduced.A model and a very efficient heuristic which produces very low gap solutions were proposed.

@&#KEYPHRASES@&#
Routing,Multiple routes,Time windows,Desynchronized arrivals,

@&#ABSTRACT@&#
The transportation of biomedical samples is a key component of healthcare supply chains. The samples are collected, consolidated into cooler boxes, and then transported to be analyzed in a specialized laboratory. Since many hospitals and samples’ collection points are assigned to the same laboratory, it is important to manage the flow of samples arriving to the laboratory to avoid congestion. In other words, it is preferable to try to desynchronize the samples’ arrivals by managing the vehicles’ departure times and the routes ordering. We propose a mathematical model and a multi-start heuristic to minimize the route duration times and the maximum number of samples’ boxes arriving at the laboratory within a given time period. Based on real data, we demonstrated that both the model and the heuristic are very efficient in solving real size instances.

@&#INTRODUCTION@&#
Vehicle routing and scheduling are key components of the efficiency of modern supply chains, where quantities of goods and raw materials should be continuously exchanged in the seamless way possible. In its most common version, the vehicle routing problem (VRP) is used to plan the distribution of goods from a depot to a set of customers, (Koç, Bektas, Jabali, & Laporte, 2016, Laporte, 2009, Semet, Toth, & Vigo, 2014) and subject to some constraints, like time windows (Bräysy & Gendreau, 2005a, 2005b), vehicle restrictions (Semet, 1995) and many other practical and industrial considerations (Coelho, Renaud, & Laporte, 2016). In other situations, products are exchanged between the customers, which leads to the pickup and delivery VRP (Berbeglia, Cordeau, & Laporte, 2010, Gschwind, 2015; Berbeglia, Cordeau, Gribkovskaia, & Laporte, 2007). Vehicles can also be used to bring back the customers’ goods to a central depot, or consolidation point, like in the waste collection problem (Ghiani, Laganà, Manni, Musmanno, & Vigo, 2014). These practical routing problems deal with many real-world constraints and are often referred as rich VRP (Lahyani, Khemakhem, & Semet, 2015).In this article, we focus on a situation arising in the healthcare supply chain context which corresponds to the daily transportation of biomedical samples from hospitals or clinics, which will be referred to as collection points (CP), to a single laboratory (Lab) where they will be analyzed. Transportation is done by a fleet of vehicles performing multiple routes during the day. As the lifespan of these samples is limited, CPs often require multiple collection requests on a given day, and each collection request is generally bounded by a time window. Samples are consolidated in cold boxes that, once collected, must arrive to the Lab within a limited specified time to preserve samples’ integrity. The boxes are opened at the Lab, and each sample is manually registered in the system and bar-coded for tracking purposes during the analysis process. These manual tasks are time consuming and according to our partner's experts, the Quebec's Ministère de la santé et des services sociaux (Ministry of Health and Social Services – MSSS), they constitute a bottleneck of the samples’ supply chain. In fact, if too many boxes arrive in a short period of time, samples are queued and may suffer long wait, which might exceed their remaining lifetime making them unsuitable to be analyzed. Our observations on the ground confirmed that some days or periods are more popular for sample collection. Thereby, reducing the maximum number of samples boxes arriving within a time period is desirable in order to normalize the Lab workload and minimize sample losses. Thus, the objective of this vehicle routing problem with desynchronized arrivals at the depot (VRP-DA) can be defined as minimizing the sum of the routes’ traveling time as well as the maximum number of boxes arriving at the Lab within any time period of the considered planning day. This work is motivated by the reengineering of the health supply chain performed by the Quebec's government under the name of the Optilab project (MSSS, 2012). One of the first objective was to centralize the transportation needs of the collection points to obtain better tariffs from the carriers (Anaya Arenas, Chabot, Renaud, & Ruiz, 2016). Now the MSSS seeks at reducing the number of laboratories in order to better use the strategic ones. In order to do so, it clearly appears that a good management of samples arriving to the Lab would be an important issue. To the best of our knowledge, our contribution is the first one considering desynchronizing the vehicles’ arrivals to the depot as this is closely related to samples’ limited lifetime, which is not the case for most of classical or industrial goods.Instead of regularizing the arrivals, many works have tried to balance the vehicles’ workload. Jozefowiez, Semet, and Talbi (2009) considered a bi-objective VRP which minimized the total length of routes and the balance of routes, which is defined as the difference between the maximal route length and the minimal route length. Kritikos and Ioannou (2010) studied a VRP with time windows (VRPTW) where they balanced the load carried by each active vehicle. Baños, Ortega, Gil, Márquez, and de Toro (2013) also considered a multi-objective VRPTW with both distance and load imbalances. López-Sánchez, Hernández-Díaz, Vigo, Caballero, and Molina (2014) solved a balanced open VRP where the maximum time spent on the vehicle must be minimized. We note that, if all vehicles depart at the same time, balancing the routes will indeed concentrate the vehicle arrival times at the depot.Closer to our context, Doerner, Gronalt, Hartl, Kiechle, and Reimann (2008) and Doerner and Hartl (2008) studied a blood collection problem which shares some characteristics with our problem. However, in their study they considered that the blood deterioration process begins right after the donation, and they used interdependent time windows. They also did not consider arrival times at the depot. Liu, Xie, Augusto, and Rodríguez (2013) considered the pickup and delivery of four demand types in a home health care system. They dealt with many specific constraints, but they did not consider a time limit for the samples’ delivery to the depot, nor did they manage vehicles’ arrival times. Şahinyazan, Kara, and Taner (2015) studied a system composed of bloodmobiles and shuttles which brought the collected blood to the depot to prevent spoilage. In order to maximize the collected blood and minimize the transportation cost, they managed the activities of the bloodmobiles and shuttles over a time horizon. However, they did not consider a time limit for the blood's return to the depot. Finally, and as stated before, this particular context was introduced by Anaya Arenas et al. (2016) which minimized traveling distance, but did not consider desynchronizing the arrivals at the Lab.The remainder of this article is as follows. In Section 2 we propose the problem formulation and some valid inequalities designed to improve its solvability. A multi-start heuristic is developed in Section 3. The efficiency of this formulation and of the heuristic and the impact of desynchronized arrivals are evaluated in Section 4, based on a set of real instances obtained from the MSSS of Quebec, Canada. We also demonstrate how this new formulation and heuristic improve upon those of Anaya Arenas et al. (2016), where desynchronized arrivals were not considered. Our conclusions are presented in Section 5.In order to formulate the vehicle routing problem with desynchronized arrivals, we need to identify both the locations of the CPs and the collections requests. The n CPs are represented byV′={v1′,…,vn′}and each CP l requires Qlcollection requests, leading to a total ofp=∑l=1nQlrequests. Each request is composed of one box that contains several samples. Then we define a complete graphG={V,A}, whereV={v0,v1,…,vp,vp+1}is the set of nodes in the network, which includes the laboratory as nodes{v0,vp+1}where every route must start and end, and the setP={v1,v2,…,vp}, being the p transportation requests. Also, we note Plas the set of request nodes in V which corresponds to the same CP location. We consider the arc setA={(vi,vj):vi,vj∈V,i≠j,i=0,…,p,j=1,…p+1}and a travel time (tij) and a travel distance (dij) are assigned to each arc (vi, vj). Clearly, tijand dijare equal to zero for every (vi, vj) if i and j ∈ Pl(i.e., i and j correspond to two requests from the same CP). In addition, each request needs to be served within a time window [aj, bj]. Finally, any two requests related to the same collection point cannot be on the same route.K uncapacited vehicles are available for satisfying the transportation requests, and each vehicle can perform multiple routes (r=1,…,R)within a work shift, but a limit on the length of the working day(Tk) must be respected. In addition, we need to consider a loading time (τi) for each transportation request, as well as the vehicle's unloading time (τ0) at the Lab before a new route can be started. Furthermore, letTmaxibe the maximal transportation time for the samples associated to request i. The objective is to minimize the total traveling time of the vehicle, including the waiting times, plus a weighted penalty θ associated to the maximum number of boxes arriving at the depot during the most visited time period. In the following sections we present the VRP-DA formulation followed by some valid inequalities to strengthen it.The following decision variables are needed to define the VRP-DA:xijkrBinary variable equal to 1 if vehicle k travels from request i to request j in its route r; 0 otherwise.Continuous variable that indicates the visit time (start of loading) of transportation request i by vehicle k in route r.Binary variable equal to 1 if the request i performed by the rthroute of the vehicle k, arrives at the Lab within the tthtime period; 0 otherwise.Highest number of boxes arriving to the Lab within any given time period (the busiest one).The model VRP-DA reads as follows.(1)Min∑k=1K∑r=1R(up+1kr−u0kr)+θwSubject to:(2)∑k=1K∑r=1R∑i=0pxijkr=1j=1,…,p(3)∑j∈Pl∑i=0pxijkr≤1l=1,…,n;k=1,…,K;r=1,…,R(4)∑i=0pxijkr−∑l=1p+1xjlkr=0j=1,…,p;k=1,…,K;r=1,…,R(5)∑j=1px0jkr≤1k=1,…,K;r=1,…,R(6)∑j=1px0jkr−∑j=1pxj,p+1kr=0k=1,…,K;r=1,…,R(7)aj−Tk(1−∑i=0pxijkr)≤ujkr≤bj+Tk(1−∑i=0pxijkr)j=1,…,p;k=1,…,K;r=1,…,R(8)uikr−ujkr+(bi+τi+tij−aj)xijkr≤bi−aji=0,…,p;j=1,…,p+1;k=1,…,K;r=1,…,R(9)u0kr≥up+1,k,r−1k=1,…,K;r=2,…,R(10)up+1,kr−ujkr≤Tmaxj+Tk(1−∑i=0pxijkr)j=1,…,p;k=1,…,K;r=1,…,R(11)up+1,kr−u0,k1≤Tkk=1,…,K;r=1,…,R(12)∑k=1K∑r=1R∑t=0Tyitkr=1i=1,…,p(13)yitkr≤∑j=1p+1xijkri=1,…,p;t=0,…,T;k=1,…,K;r=1,…,R(14)up+1,kr<ω(t+1)+M(1−yitkr)i=1,…,p;t=0,…,T;k=1,…,K;r=1,…,R(15)up+1,kr≥ωt−M(1−yitkr)i=1,…,p;t=0,…,T;k=1,…,K;r=1,…,R(16)w≥∑k=1K∑r=1R∑i=1pyitkrt=0,…,T(17)xijkr∈{0,1}i=0,…,p;j=1,…,p+1;k=1,…,K;r=1,…,R(18)uikr∈R+i=0,…,p;k=1,…,K;r=1,…,R(19)yitkr∈{0,1}i=0,…,p;t=0,…,T;k=1,…,K;r=1,…,R(20)w∈R+The first part of the objective function (1) minimizes the routes’ total duration (end time minus starting time) which includes the necessary waiting time to respect the time windows. In our case, the total duration of the routes may be different from the total operating time of a vehicle as waiting times are allowed at the Lab between routes. The second applies a penalty factor θ to the maximum number of boxes arriving within a time period (w). In preliminary computations we found that minimizing traveling distance was inefficient, as the model simply added useless waiting times within the route to span the arrivals over the time periods. We found that minimizing the route's duration, including the waiting time, was a more logical objective, even if it is more complicated to optimize. Constraints (2) assure that each request is serviced by exactly one route. Since some of the original collection points are duplicated, constraints (3) ensure that a route visits only one original point at a time. Flow conservation is ensured by constraints (4). Constraints (5) state that truck k can start a route r or not, and if a route is started, it has to come back to the depot by constraints (6). If vehicle k in its route r performs request j, the time windows must be respected by constraints (7). Constraints (8) are the sub-tour elimination constraints. Constraints (9) state that route r of vehicle k starts later than the arrival of its route r-1. The time needed to return to the depot after visiting a request node is bounded by constraints (10) to satisfy sample lifetime. Constraints (11) set the maximum duration on any route. Constraints (12) state that the request i will arrive at the depot within a given time period t. Constraints (13) ensure that, if request i has been visited by the rthroute of vehicle k, the variable yitkrcan take the value one. Constraints (14) and (15) force the relation between the flow and y variables and discretize time into periods of ω units of time. When using these constraints in the case whereyitkr=1, we haveωt≤up+1kr<ω(t+1), meaning that the depot must be visited within the tththtime period, thus within time ωt andω(t+1). Constraints (16) calculate the Lab's maximum workload during the available time periods. As expressed by (16), the number of boxes arriving during a given time period corresponds to the number of locations visited by the routes which return to the depot during this period. Assuming that a sample box is collected at each request location, the workload then corresponds to the number of boxes arriving at the depot during this period. Domains of the variables are given by (17)–(20).The solvability of the model (1)–(20) can be improved by the addition of the following groups of inequalities.(21)∑j=1px0jkr−∑j=1px0jkr−1≤0k=1,…,K;r=2,…,R(22)uikr−∑j=0&i≠jp(aj+τj−ai+tji)xjikr≥aii=1,…,p+1;k=1,…,K;r=1,…,R(23)∑j=1px0jk1−∑j=1px0jk−1,1≤0k=2,…,K(24)∑r=1R∑i=1pxijkr−∑l=1j−1∑r=1R∑i=1pxilk−1,r≤0j=1,…,p;k=2,…,K(25)∑i=1p∑r=1R∑t=0Tyitkr≤M∑i=1p∑t=1Tyitk−1,1k=2,…,p(26)∑i=1p∑t=0Tyitkr≤M∑i=1p∑t=1Tyitk,r−1k=1,…,K;r=2,…,R(27)∑i∈S∑j∈Sxijkr≤|S|−1S⊆{1,2,…,p},|S|=2or3(28)∑k=1K∑r=1Rxijkr=0∀i,j∈V∖{0,p+1}|(ai+τi+tij>bj)(29)∑k=1K∑r=1Rxijkr=0∀i,j∈V∖{0,p+1}|(aj−bi+τj+tj,p+1>Tmax)(30)∑k=1K∑r=1R∑l=1t−1yilkr=0∀i∈V∖{0,p+1}|(ai+τi+ti,p+1≥ωt);t=1,…,T−1To avoid symmetry, active routes are ordered by constraint (21). Constraint (22) puts a lower bound on the minimum value of each variable u. Essentially, when visiting the arc (i, j) by the rthroute of vehicle k we havexijkr=1and consequently,uikr+τi+tij≤ujkr. In case thatxijkr=0we haveuikr−ujkr≤bi−ajwhich is always valid. Constraints (23) and (24) are adaptations of the symmetry breaking constraints proposed by Coelho and Laporte (2014). Essentially, they eliminate many symmetric solutions of same values by ordering the use of the vehicles and the assignment of requests to vehicles. Constraints (25) and (26) are symmetry defeating constraints and are only introduced to enhance the model by breaking the symmetry caused by variables y. In particular, none of the requests can be performed by routes of the vehicle k, whenever the first route of the vehiclek−1has not already been used. In addition, (26) states that route r of the vehicle k can be used to deliver a request to the Lab only if router−1of the same vehicle has already been used. Constraint (27) is a classical sub-tours elimination constraint generated for subsets of two and three requests. Constraints (28) to (30) are generated only if specific conditions are respected. Constraint sets (28) and (29) state that we cannot visit arc (i, j) by different routes of available vehicles whenai+τi+tij>bjandaj+τj+tj,p+1−bi>Tmax, respectively. In fact, (28) and (29) respectively remove redundant arcs violating the time window and maximum sample travel time. Constraint (30) shows the relation between the earliest visit time of a request and the possible time periods where its corresponding sample can be delivered at the Lab. Essentially, whenai+τi+ti,p+1≥ωt, request i cannot be delivered to the Lab sooner than the tththtime period.Model (1)–(30) extends and strengthens the one proposed by Anaya Arenas et al. (2016) who used constraints (2)–(7), (9)–(11), (21), (23), (24) and the following connectivity constraint:(31)uikr+τi+tij−ujkr≤Tk(1−xijkr)i=0,…,p;j=1,…,p+1;k=1,…,K;r=1,…,RWe improved this constraint by using (8) and (22). In their model, they also minimized the total traveled distance which is a different objective function than (1). Nonetheless, the formulation is only able to solve efficiently small to medium sized instances, as it will be shown in the section devoted to numerical experiments. The development of a fast and efficient solving method was therefore necessary to deal with the larger real-life instances provided by our partner.In this section, we develop a multi-start algorithm for the introduced problem. In the next sections we first describe the algorithm, followed by a detailed description of how visiting times are updated efficiently to handle the time windows and the maximal sample transportation time constraints.The multi-start algorithm is based on three procedures, namely Construction, Extraction-Reinsertion and Swap. To ensure that different executions lead to different solutions, the algorithm sets a level of randomization which modifies two important parameters of the problem: the maximal sample transportation time (Tmax) and the maximum length of a vehicle working day (Tk). These parameters impact the Construction algorithm, which may provide different initial feasible or unfeasible solutions. Parameters are adjusted according to the feasibility of the solution produced at the previous execution. Only feasible solutions are passed to the improvement steps.Construction procedureInitial solutions are built by a constructive method in which nodes are sequentially added to the routes. We use the following rules to select n1, the first node to be visited by a route.•N1=argmaxi∈P{t0i}i.e., the set of nodesi∈P={v1,v2,…,vp}whose travel time from the Lab is the greatest.N2=argmini∈N1{bi}i.e., the set of nodes i ∈ N1 whose time window upper bound is the lowest.n1=Choose a node from N2 randomly.At each step, to add a new node to the set of visited nodes of the working route, we verify the possibility of adding each unvisited node to every insertion place of the current route and select the insertion leading to the smallest increase in the route's total travel time. For instance, if node i is inserted between nodes j and k, the detour is computed astji+tik−tij. The general framework of the construction phase is sketched in Algorithm 1, where K is the number of vehicles and R the maximum number of routes per vehicle.Extraction-Reinsertion procedureIn this procedure, the goal is to reduce the value of the objective function (1) by repositioning some of the nodes. Thus, the length of the time period ω must be considered in the calculation of this cost. To try improving the solution, the procedure extracts a node from its location and reinserted into its best feasible position. Starting from the first route of the first vehicle, all the nodes are repositioned in all possible locations. A move is accepted as soon as it leads to an improvement, and the whole procedure is repeated until no improvement can be reached. During this procedure, we are allowed to create a new route or close an already existing one.SwapFollowing their order in the current solution, we consider each pair of nodes and their corresponding positions are swapped. This swap is applied to all possible combinations of two nodes over all the vehicles’ routes. As soon as a move improves the solution's cost, it is accepted and the procedure stops whenever the swapping of all available nodes offers no more improvement.Multi-start heuristic algorithmThe general framework of the multi-start algorithm is provided in Algorithm 2and consists of two loops. During the inner loop's execution, the goal is to construct an initial feasible solution. Within this loop, we run the Construction procedure by setting different temporary values for the maximum vehicle travel time (Tk¯) and the sample travel time (Tmax¯) parameters until a feasible solution is obtained (the Repeat - Until loop). Essentially, the algorithm is initialized at the first iteration by settingTempTmax=TmaxandTempTk=Tk, which are the initial feasible parameters of the instance. For the other iterations, if the generated solution produced by applying the Construction procedure is feasible, the values ofTempTkandTempTmaxare decreased by a factor α which is an input parameter (set to 0.1 in our computational experiments):TempTk=TempTk−αTkTempTmax=TempTmax−αTmaxOtherwise, in order to increase the chance of obtaining a feasible solution, the corresponding values of the parameters are increased by applying the updates:TempTk=Min{TempTk+αTk;Tk}TempTmax=Min{TempTmax+αTmax;Tmax}Finally, the values to be used as the maximum travel and sample times when running the Construction procedure are set by applying the following relations in which rand(0, x) is a random integer number between 0 and x.Tk¯=rand(0,Tk−TempTk)+TempTkTmax¯=rand(0,Tmax−TempTmax)+TempTmaxUpon obtaining an initial feasible solution, we apply the Extraction-Reinsertion and Swap procedures to try to improve the quality of the initial solution. To do so, we use the original values for the sample travel time (i.e. Tmax) and vehicle travel time (i.e. Tk). The algorithm stops after a given number of iterations (i.e. Maxiter).In order to efficiently manage the time windows and the maximum sample transportation time constraints, we need rules to update the earliest and the latest start time of nodes in the solution. In the following, we offer an adaptation of the method proposed by Campbell and Savelsbergh (2004) for the VRP with time windows.We represent the rth route of vehicle k bykr={c0kr,c1kr,…,cikr,ci+1kr,…,cnkrkr,cnkr+1kr}in whichnkris the number of nodes visited by the rthroute of vehicle k. We denote byEcjkrandLcjkr, the earliest and the latest time at which nodecjkrcan be visited by the rthroute of vehicle k, respectively.At the beginning, for each k and r, we setEc0kr=Ecnkr+1kr=a0andLc0kr=Lcnkr+1kr=b0. In case of visiting nodecjkrbetween nodescikrandci+1krwe apply the relations (R1) and (R2) to update the earliest and latest visit time ofcjkras follows:(R1)Ecjkr=max{acjkr,Ecikr+τcikr+tcikrcjkr}(R2)Lcjkr=min{bcjkr,Lci+1kr−τcjkr−tcjkrci+1kr}IfEcjkr≤Lcjkr, insertingcjkrbetweencikrandci+1krwill not violate the time windows, but it is still necessary to verify that both the maximum duration of the vehicle length and the maximum sample travel time are satisfied. To do so, we use the relations (R3) and (R4) to update the earliest and latest start time of nodes visited after and beforecjkras follows:(R3)Ecskr=max{acskr,Ecs−1kr+τcs−1kr+tcs−1kr,cskr}s=i+1,…,nkr+1(R4)Lcskr=min{bcskr,Lcs+1kr−τcskr−tcskrcs+1kr}s=0,…,iFinally, the minimum length of the rthroute of vehicle k requires serving the route at the latest feasible time, by setting it tovtcnkr+1kr−vtc0kr. In this expression,vtcikris the real visit time of nodecikrby the rth route of vehicle k and can be calculated asvtcikr=max{acikr,vtci−1kr+τci−1kr+tci−1kr,cikr},i=1,…,nkr+1. In addition,vtc0kr=Lc0kr.Satisfaction of the maximum vehicle travel time and the maximum sample travel time are ensured byEqs. R5and R6, respectively:(R5)vtcnkR+1kR−vtc0k1≤Tk(R6)vtcnkr+1kr−vtc1kr≤Tmaxr=1,…,RIn addition,vtc0kr=vtcnkr−1+1kr−1forr=2,…,R.In this section we evaluate both the efficiency of the model and the heuristic to solve the set of instances in Anaya Arenas et al. (2016). These instances were obtained from the Quebec's MSSS and correspond to real biomedical sample transportation problems in four administrative regions in the province of Quebec.The heuristic algorithms were implemented in C using Microsoft Visual Studio 2010 and executed on an Intel Core I-7 with a 3.4gigahertz processor and 32 gigabyte of RAM. The mathematical formulations were solved using Cplex 12.6. As the algorithms developed in this article can also solve the instances in Anaya Arenas et al. (2016), our experiments will be separated in two parts. First, we compare our formulation and heuristic to those in Anaya Arenas et al. (2016). Then, we evaluate the model's behavior and the heuristic in the context of desynchronized arrivals.The proposed model VRP-DA of Section 2 can be used to solve the BSTP if we use constraints (2)–(15) and replace the objective function (1) by the distance minimization objective∑i=0n∑j=1n+1∑k=1K∑r=1Rdijxijkr. These results are reported under columns VRP-DA in the following tables. Columns BSTP-EG correspond to the Anaya Arenas et al. (2016) model. Table 1reports data on the small and medium instances. These instances have up to 10 collection points and 20 transportation requests.As can be observed, both formulations solved all the instances to optimality. For medium instances, the BSTP-EG proposed by Anaya Arenas et al. (2016) required 98 seconds in averages, while our formulation required only 0.96.Table 2reports the results for the larger instances having up to 20 collection points and 50 requests. We ran the BSTP-EG model, but it was never able to produce any feasible solution after 10800 seconds of computing. This behavior was also observed by Anaya Arenas et al. (2016) and this is why they initialized their model with the best solution given by their heuristics. Thus, column BSTP-EG in Table 2 reports their original results (distance and final Cplex gap in percentage after 10800 seconds). Column VRP-DA reports our results after 3600 and 10800 seconds of computing time, respectively. Values marked by an asterisk indicate instances for which Cplex ran out of memory and the best feasible solutions for them are reported.The new model clearly offers a better performance, obtaining better solutions for all the cases except instances 33 and 38. The average solution cost was reduced from 1388 for the previous model to respectively 1322 and 1290 after 3600 and 10,800 seconds of computing time with the new VRP-DA model. Average optimality gap was also reduced from 21.51 percent for BSTP-EG to 8.77 percent for VRP-DA. Thus, the new formulation is shown to be faster and more effective.Table 3reports heuristics’ results for all the 38 instances. Column “Anaya-Arenas” reports their best found results over different heuristic combinations. Columns “Heuristic” report the results of the algorithm developed in Section 4 after 1 and 100 iterations, respectively. Computing times are not reported, as they are negligible. Our multi-start algorithm can be applied to the BSTP by using the travel time as a cost function for the Extraction-Reinsertion and Swap procedures and by setting the value ofθ=0. For each heuristic, we report the distance (Dist) and the gap (Gap), with respect to the best solution obtained by Cplex (solution to instances 1 to 27 are proven optimal). For small and medium size instances 1 to 25, the proposed heuristic with 100 iterations produced all of the optimal solutions. For the larger instances, we improved the average gap produced by Anaya Arenas et al. (2016) heuristic, 8.25 percent, to 4.67 percent when only 1 iteration of the heuristic is run, and to −0.91 percent after 100 iterations. Even more, the multi-start heuristic produced solutions that improved the best known ones (produced by Cplex) in 5 times.In this section we analyze the ability of the VRP-DA formulation and the multi-start heuristic to minimize the largest number of boxes arriving to the Lab during any time period. Our computational experiments were still based on the Anaya Arenas et al. (2016) set of instances, as they are the practical foundation of this work. However, for each instance, we set the opening and closing times of the laboratory and then divided the working hours into time periods of ω minutes. Clearly the length of these periods not only influences the size of the model, but also the maximal number of boxes arriving within a period. Managing the time periods adds a new complexity level to the problem and impacts the size of the instances that can be solved to optimality. This is why the instances in this section are divided into to two sets, with instances 1 to 19 in the first one and instances 20 to 38 in the second one. The VRP-DA model can only be solved to optimality by Cplex for the latter set.Let us first analyze the behavior of model VRP-DA when the synchronization factor is not considered. To this end, we set the penalty factorθ=0in the objective function (1). The model optimizes only the sum of the route's durations and we observe for each instance the number of boxes arriving to the Lab at the busiest period.Table 4reports the numerical results produced for these experiments when ω was set to 60 and 30 minutes. ColumnsRD¯provide the optimal duration of the routes. The routes’ duration produced by the heuristic are reported in columns RD. Column w reports the number of boxes arriving during the busiest period, giving an idea of the values that one should obtain if desynchronization is not consider in the optimization process. Finally, columns Second report the Cplex computing time in seconds. We do not report the heuristic computing time as it is always below a second.As expected, the routes’ durations are not impacted by the length of the considered period. However, the average computing time of Cplex rises from 269 seconds to 331 seconds when the time period is reduced from 60 to 30 minutes. We can observe the excellent performance of the heuristic (with 100 iterations), which was able to find the optimal route's duration for all instances. It is also worth to mention that both methods led to the same w value in almost all but four cases. This can be explained by the presence of an equivalent solution with respect to the route duration.Table 5reports the results when we set the penalty factor toθ=100, which means that the model reaches a compromise between minimizing the route's duration and the number of arrivals during the busiest period. In columnRD¯, we report the lower bound on the route duration as per Table 4, which is valid for both values of ω. In order to obtain a lower bound on the number of box arrivals in the busiest period, we ran the model with a very high penalty factor (θ=100000). These results are reported in columnsw¯.When we setω=60minutes and θ=100, Cplex produced optimal solutions having in average a route duration of 439.6 instead of 412.2 units (lower bound in Table 4). However, the average number of boxes arriving during the busiest period is reduced from 3.3 to 1.5 boxes. The heuristic produced average values of 435.6, and 2.3 for the same indicators. When we setω=30minutes, the average number of boxes arriving during the busiest period produced by Cplex decreases to 1.3, whereas the lower bound (w¯) is equal to 1. For this case, and comparing to the results in Table 4, we can say that a better desynchronization has allowed reducing the maximal number of boxes received within the busiest period from 2.8 to 1.3 at the cost of an additional 8.2 percent in the total route duration the reduction.Table 6reports the results produced for the larger instances. Since Cplex was unable to produce a feasible solution after 3600 seconds of computing time, only heuristic results are reported. Experiments were run for penalty factorθ=100and ω=60 minutes. To evaluate the heuristic's robustness and how the number of iterations influences the quality of the solutions, we report the results produced right after the construction phase of the heuristic and after 1, 10 and 500 iterations. Computing times are only reported for 500 iterations, as they are otherwise negligible. Finally, since we do not have bounds on the route duration and the number of arrivals, we ran 10000 iterations of the heuristic to try and get “good” bounds. To this end, first we setθ=0to minimize the route's duration (column RD’), and then we setθ=100000to minimize the number of arrivals during the busiest period (column w′).Table 6 shows that the lowest route duration was achieved with 10 iterations with a deviation of 4.1 percent from the minimum (obtained withθ=0). With 500 iterations, the heuristics improve the maximum number of arrivals to 4.3, while the minimum (obtained withθ=100000) was 4.2, however the routes duration was increased slightly. Thus, running the heuristic with 500 iterations seems a good compromise while the computing time remains below five seconds.

@&#CONCLUSIONS@&#
This article deals with an important practical transportation problem encountered in the health system of the Quebec province. This problem requires the transport of biomedical samples from collection points to a laboratory where they are analyzed. As the laboratory is the bottleneck of the system, it is important to avoid congestion by balancing the arrival of samples. To this end, we discretize the working hours into periods and try to minimize the number of samples boxes arriving to the laboratory in the busiest period. We modeled the problem as a vehicle routing problem with desynchronized arrivals (VRP-DA). To the best of our knowledge, it is the first time that this problem has been addressed and modeled. We formulated it as a MIP and developed a heuristic to solve it. The formulation and the heuristic were adapted to deal with a similar routing problem in which desynchronization was not considered, and both outperformed existing methods. Our computational results demonstrated also that the problem with desynchronized arrivals is much more difficult to solve to optimality. For medium size real instances, the formulation was solved to optimality within few seconds. However, for larger instances, the Cplex was unable to obtain any feasible solution, although the heuristic proved to be efficient in minimizing both the route's duration and the number of arrivals during the busiest period.The algorithms developed in this research have been applied to four administrative regions in the Quebec province. On an annual basis, more than 2.1 million kilometers are involved in the new routes configurations (Renaud, Ruiz, Chabot, Anaya Arenas, & Zue Ntoutoume, 2014). We are currently working with the Ministry to reorganize transportation operations of the other 13 administrative regions as part of the global laboratories optimization project. From a broader perspective, we believe that this practical situation, where the route planner might avoid congestion at depots or other facilities, justifies additional research.