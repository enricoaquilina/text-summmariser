@&#MAIN-TITLE@&#
Hybrid simulation approach for improving railway capacity and train schedules

@&#HIGHLIGHTS@&#
We use timetable management features to study LOS and capacity utilization tradeoff.The hybrid approach leverages strengths of two simulation tools, RTC and RailSys.Timetable compression technique successfully applied for a single track case study.Timetable duration and maximum allowed dwell time used to select preferred scenario.LOS parameters were significantly improved while remaining under capacity threshold.

@&#KEYPHRASES@&#
Railway simulation,Timetable management,Level of service,Railway capacity,Timetable compression technique,

@&#ABSTRACT@&#
Timetable management is one of the operational methodologies commonly applied in the highly structured European rail system to improve the capacity utilization while maintaining acceptable level of service (LOS) parameters; but their potential benefits to the less structured U.S. system have received little attention. The objective of this study was to investigate the use of timetable management features to analyze the trade-off between LOS parameters and capacity utilization in the U.S. The research applies a hybrid simulation approach, where output from RTC, a simulation tool developed in the U.S., was used as an input for timetable compression by RailSys, a simulation tool developed in Europe. 28 scenarios were developed in RailSys to identify a preferred scenario with reasonable LOS parameters while maintaining the capacity utilization under the recommended threshold, and the selected scenario of RailSys was then validated in RTC. The results of the study revealed that 10-min maximum allowed dwell time provided the best corridor capacity utilization. Also, the LOS parameters were significantly improved for total number of stops (55% reduction), total dwell times (80% reduction) and average dwell time (65% reduction); while the timetable duration was increased (capacity utilization was degraded) by 18% compared to the initial schedule.

@&#INTRODUCTION@&#
The majority of passenger rail services in the United States (U.S.) operate on shared-use corridors with substantial freight rail services. Passenger/freight traffic may each operate on dedicated tracks, but in most cases, all trains share the same track infrastructure. The European passenger rail services also operate on shared-use corridors, but the infrastructure conditions and the operating priorities and patterns are different, typically favoring passenger operations (FRA, 2009; Cambridge Systematics and Inc., 2007). Recently, the increasing demand for train traffic (passenger and freight) is creating pressure to add capacity in the U.S. either through the construction of new tracks and lines, or through improved operational strategies.Capacity analysis, at the network, main line/corridor, or terminal/yard level is one of the tools used to evaluate the benefits and costs of capacity improvement alternatives. Although the concept of capacity and the objective to achieve a high utilization while maintaining sufficient level of service (LOS)11Level of service (LOS) may include various parameters to evaluate the desire level of rail customer/clients' satisfaction. In the U.S., common parameters used are various types of train delays, but in this research, the LOS parameters are taken into account from the timetable and scheduling standpoint. Common parameters include number of stops (unplanned or meet-pass stops), average dwell time, maximum allowed dwell time and total dwell time.for trains is global, the configuration differences between the European and the U.S. rail systems (such as the infrastructure ownership and the operating philosophy) leads to the use of different methodologies, techniques, and tools for capacity evaluation. More information on these differences and how they affect the capacity studies is provided in Pouryousef et al., 2013 (Pouryousef et al., 2013).This paper focuses on rail line/corridor level analysis. It provides a brief synopsis of methods and tools to evaluate main line capacity and the LOS parameters, but the main objective of the study was to investigate the use of timetable management features common in European rail environment to analyze the trade-off between LOS parameters and capacity utilization in the U.S. rail environment. The methodology included development of a “Hybrid Simulation Approach”. This differs from traditional analysis, as it takes advantage of the complementary features of non-timetable and timetable based simulation software and uses output from one software as input in another. A single-track case study is used to demonstrate the approach, the outcomes and the challenges.There is no standard definition for railway capacity, but one definition that is used is the number of trains that can safely pass over a given segment of the line within a selected time period (UIC, June 2004). Various definitions, metrics, methodologies and tools are applied for evaluating the capacity in Europe and North America, due to the differences of rail network characteristics between the two continents (Pouryousef et al., 2013). Three critical differences between Europe and the U.S. are the ownership of infrastructure, the predominant traffic type (freight vs. passenger), and operating philosophies. In the U.S. more than 90% of the infrastructure is owned and managed by private freight railroads (Thomas, 2005), while in Europe infrastructure is almost completely owned and managed by governments or public agencies. The U.S. operations are predominantly for freight transportation and the prevailing operating philosophy for the majority of freight trains and even some passenger and commuter services is based on the improvised pattern that has no repeatable dispatching plan on over extended time period. In Europe, passenger trains dominate the corridors and almost all trains (freight and passenger) follow structured operations with a regular schedule that is developed months in advance (Thomas, 2005). The reasons noted above, combined with variations in other characteristics, such as rolling stock and signaling systems, all affect capacity, as well as tools and techniques used for capacity analysis.The literature mainly divides capacity analysis approaches into analytical and simulation methods (Pachl, 2002; Abril et al., 2007; Murali et al., 2009; Khadem Sameni et al., 2011; Sogin and Barkan, 2012; Lai and Barkan, 2009). A combined analytical-simulation approach that takes advantage of both analytical and simulation methods has also been used (Schlechte et al, 2011; Cambridge Systematics and Inc., 2006). The simulation methods typically utilize either general simulation tools or commercial railway simulation software that has been specifically designed for rail transportation (Abril et al., 2007; Khadem Sameni et al., 2011). The commercial railway simulation software can be divided into two major categories: Non-timetable based and Timetable based software. Both incorporate two components: “Train movement simulation” to calculate the train speed along the track, and “Train dispatching simulation” to emulate the actions of the actual dispatcher as closely as possible (Thomas, 2005). The non-timetable based simulations are typically used in railways which are operated based on unstructured operation pattern without initial timetable, such as the majority of the U.S. rail network. The primary objective of this type of simulation tools is to automatically resolve the train conflicts. The Rail Traffic Controller (RTC), developed by “Berkeley Simulation Software, LLC” is the most common software in this category and is used extensively by the U.S. rail industry (Thomas, 2005; Khadem Sameni et al., 2011). The simulation procedure of timetable based software, commonly found in Europe, is based on the initial timetable of trains (often a conflict-free timetable is required). The software can identify the train conflicts, but in most cases have limited capabilities to resolve all conflicts without user intervention. The software typically include features to automatically adjust/improve the initial timetable and are equipped with other timetable management features, such as timetable compression technique. RailSys, developed by Rail Management Consultants GmbH in Germany, is one example of a timetable-based simulation package, and details of the different simulation tools has been provided by Pouryousef et al., 2015 (Pouryousef et al., 2015).Table 1provides a sample of recently published capacity studies in the U.S. and Europe, and shows the difference between tools commonly used for analysis. RTC has been the software of choice for all U.S. studies while several timetable-based packages have been used in Europe.In addition to the software packages highlighted in the Table 1, there are other simulation tools used in the U.S., by rail transit and commuter services (e.g. MultiRail, RailSim), and in Europe (e.g. OpenTrack, Viriato, SLS, RAILCAP, CMS). A review of Table 1 indicates that train delay analysis is a common performance metric for capacity evaluation in the U.S. and one that is recommended by the Federal Railroad Administration (Tolliver, 2010). Europeans have a variety of different methodologies to evaluate the railway performance, but most of them utilize timetable management techniques. For instance, timetable compression technique used in this research, was developed by International Union of Railways (UIC) to improve the capacity utilization or LOS by adjusting operational characteristics, such as dwell times, stop patterns, train departure times and/or the order of trains. This technique is most applicable on corridors with pre-scheduled timetables and predetermined routes for daily trains (structured operating philosophy) and its objective is to modify the pre-determined timetable by rescheduling the trains as close as possible to each other (UIC, June 2004; Landex et al, 2006; Prinz and Hollmuller, 2005; Banverket, 2005; Khadem Sameni et al., 2010). While U.S. shared corridors rarely operate under structured operating philosophy, the daily schedules for passenger trains rarely change, making the shared use corridors with regular passenger traffic more applicable for the technique.“Hybrid Simulation Approach” differs from traditional analysis, as it takes advantage of the complementary features of non-timetable and timetable based software and uses output from one software as input in another. The tools used in the study included RTC as the non-timetable based simulation tool and RailSys as the timetable-based tool. Fig. 1presents key features of each simulation package. RTC has the capability to use preferred departure times, train dispatching simulation process, and its automatic train conflict resolution to develop the initial timetable (stringline). RTC does not consider a specific total timetable duration, but rather uses a decision support core, called “meet-pass N-train logic” to dispatch all trains while avoiding conflicts and minimizing the overall delays and total operating costs of trains (Pouryousef et al., 2015). In contrast, RailSys requires a specific total timetable duration and an initial timetable (typically a conflict-free schedule) for its simulation and uses a timetable compression technique (based on UIC code 406) to adjust/improve the initial timetable for more efficient capacity utilization or for improving the LOS parameters.The hybrid approach uses the initial timetable developed in the RTC as input for RailSys and then applies the RailSys timetable compression technique to investigate the trade-off between capacity utilization/LOS by adjusting the initial timetable. The adjusted timetable developed by RailSys is then imported back to RTC as input, so the results can be validated in the U.S. rail environment (Fig. 2).Fig. 3illustrates additional details on the approach in a step-by-step basis. Step 1 represents the development of the initial timetable using RTC. Step 2 adjusts/improves the RTC timetable through RailSys compression techniques, and Step 3 validates the new timetable in the RTC.As presented in Fig. 3, the hybrid approach requires conversion of the data from RTC to RailSys and then checking that the key simulation outcomes match with each other. There are four categories in the database and the level of conversion criteria and level of difficulty vary (Table 2). The conversion of infrastructure and operating rules is straightforward and consists mainly of unit conversion (English to metric). The conversion of train and signaling characteristics is more complicated and may require specific adjustments in individual parameters, as the train performance calculator (TPC) and signal system emulator of RailSys (and many other European-based simulation tools) are less sophisticated and less tuned to the U.S. operations than the ones in RTC, which have been customized for the U.S. rail environment.The validation process depends on the parameters that need to be matched. In the case study, the main objective was to maintain the same schedule and run time of trains, as well as to check that there were no deviations in train routings. Any deviations in these parameters were used to determine necessary adjustments.A case study was developed as part of the research to demonstrate the hybrid approach. The case study used a rail line in the U.S. that is currently used for excursion passenger trains, but train and signaling parameters were hypothetical. The input data was developed for each simulation package and included four database categories “operating rules, trains, signaling, and infrastructure”.The line is a 30-mile single track corridor with three sidings/yards for meet/pass and stop purposes. (Fig. 4) The vertical track profile and locations of the sidings were derived from an existing corridor data. The horizontal curves were not included as their impact on the train speed was not considered essential for the simulation results. Table 3summarizes the infrastructure parameters for the case study.The signaling system was an absolute permissive block (APB) for single track operation with four-aspect signaling along the main line. The length of blocks varied from 1.2 to 2.5 miles and all sidings/yard tracks were equipped with controlled interlocking systems.Four types of trains were considered in the case study: intercity passenger (4 daily pairs), commuter passenger (2 daily pairs), merchandise freight (2 daily pairs) and intermodal freight trains (3 daily pairs). It was assumed that the characteristic and configuration of trains was uniform in each specific category and each train was operated in both westbound and eastbound directions. All passenger and commuter trains were propelled by a single diesel-electric locomotive and all freight trains were loaded in both directions. Since the type and configuration of locomotives were different in the RTC and RailSys database, some of the characteristics of selected locomotives in RTC (such as power, weight, length, axle load, acceleration/deceleration rate, resistance) were imposed and adjusted over the existing rolling stock database of RailSys as a new type of locomotive.The scenario developed for initial RTC simulation included several relevant operational rules, such as the train priority, speed limits, stop patterns, and preferred time and order of train departures. The train priority (in descending order) was commuter trains, passenger trains, intermodal, and merchandise trains. Due to short train lengths and type of signaling system, the minimum headway between trains was 3 min. The maximum speed of passenger/commuter trains was 60 mph, and for freight trains was 50 mph. In addition, the initial speed of all trains was 30 mph until they reached the track segment that started the simulation process. A predefined timetable was not used, but requested departure times were developed with a goal to have a congested and homogenous dispatching pattern of trains. The congestion aspect of train schedule (with over 25 conflicts) allowed evaluation of rail simulation package capabilities in resolving the potential conflicts. The homogenous pattern of train schedule mimicked a common trend in operating the shared-use corridors in the U.S. where the passenger and commuter trains are often separated from the freight services, particularly during peak hours. No consideration was given for real market conditions or for potential interdependencies between the trains and there were no planned stops for any trains. However, passenger, commuter or merchandise trains were allowed to stop at the sidings due to the meet-pass logic. The intermodal freight trains were allowed to have a meet-pass stop only in the yard tracks, as siding lengths could not accommodate these trains (Table 3).Fig. 5presents the initial simulation results obtained from RTC simulation with no manual adjustments in distance–time diagram format (string-line). There were no planned stops for the trains, but several stops were suggested by RTC for meet-passes in the sidings to resolve train conflicts. The simulated arrival/departure times showed a deviation from the preferred departure times requested, as RTC's automatic decision making features resolved the conflicts between trains and dispatched them to minimize train delay/operational costs.Certain trains witnessed a notable deviation between the requested and actual departure times when they reach the point that starts simulation process. These “limbo times” are identified by red boxes in Fig. 5 and by “*” and “**” in Table 4. Limbo times are caused by conflicts between the trains and result in several dispatching delays, and in some cases a change in the dispatching order of trains.In addition to presenting the limbo times, Table 4 compares the requested departure times and simulated departure times and the order of trains by RTC in both westbound and eastbound directions.As presented in Table 4, trains with higher priority (commuter and passenger) had lower deviation between their requested and simulated departure times. There was also conflict between requested departure time of passenger 3 and commuter 1 (eastbound direction), as both trains were requested to depart at 10:00. RTC solved the time conflict by maintaining the initial schedule of commuter train (with higher priority) and delaying passenger train for 3 min at the entry point of the line. Similar situation occurred between intermodal 2 and freight 2 in eastbound direction (both were planned to depart at 12:50). RTC changed departure times of both trains to facilitate necessary meet-pass events. After the changes, the high priority commuter trains had one short stop in a siding due to the meet-pass enforcement, while passenger trains faced more frequent and longer delays in the sidings and on the entry points of the line. (Fig. 5) The same trend was noticed for freight and intermodal train schedules with even more delays and longer meet-pass time in the sidings, since the priority of these two types of trains was lower than passenger and commuter trains. However, the merchandise freight trains had lower delays in comparison to the intermodal freight trains, although the priority of intermodal trains was slightly higher than merchandise train. This may be due to the fact that merchandise trains had more flexibility for meet-pass stop locations, while intermodal trains were limited to stopping in the yards with sufficient siding lengths to fit the full train. In conclusion, the majority of trains (particularly commuter trains with highest dispatching priority) maintained the order initially requested, while dispatching order for some of the other trains was changed. It should be noted that the dispatching order is very dependent on the gap between the priority values for different train types. Therefore, changing the priority order of trains, or increasing the gap in the priority values causes the RTC to propose a different schedule and dispatching order of trains from those presented in Fig. 5 and Table 4.The output from the RTC simulation (simulated eastbound and westbound departure times) was used as the actual terminal departure times in the RailSys simulation (Fig. 6). Since the actual departure times from RTC output equaled the preferred departure times for RailSys, there were no “limbo times” identified in the RailSys simulation. However, there were some minor deviations between arrival/departure times in RailSys and RTC, due to differences between rolling stock and signaling features/equations of each simulation package, such as tractive effort of engines, acceleration, deceleration, and braking diagram. Despite these differences, approximately 96% of timetable parameters (order of trains, stop patterns, departure/arrival times) were identical in RailSys when compared to the initial timetable obtained from RTC.Once the accuracy of the converted database was verified, RailSys capabilities were used to adjust and compress the initial timetable for LOS and capacity utilization analysis. RailSys uses UIC 406 compression technique with predefined patterns and algorithms to automatically adjust the initial timetable, resulting in changes to LOS/capacity utilization. Several criteria have to be defined in RailSys prior to the automatic timetable adjustment/compression, such as:•The initial timetable (RTC output was used as initial timetable of RailSys)Selection between compression technique (Austrian method, OBB, or German method, DB)Overtaking option in the sidings/stationsTimetable duration (the portion of timetable which is planned to be adjusted)Maximum allowed dwell time of trains in the sidingsThe case study used the OBB compression algorithm and allowed an overtaking option at a maximum of two stations. OBB was selected over DB algorithm, as it maintained the number of simulated trains extracted from RTC results and under this algorithm RailSys does not allow for changes in the departure order of trains. In single track scenarios like ours, it is recommended to allow overtaking option at meet/pass locations. The locations (sidings/stations) and the trains for meets/passes and any additional stops are determined automatically by the RailSys, based on its own decision algorithm of compression technique.As noted earlier, RTC does not use a specific timetable duration when developing the initial timetable. However, in RailSys, timetable duration and maximum allowed dwell time of trains are critical parameters. In the base scenario developed to obtain a maximum LOS for the corridor, both train stops and maximum allowed dwell times were assigned as zero. This matched the initial requests in RTC before simulation (no stop pattern, no dwell time). Fig. 7demonstrates the adjusted timetable developed by RailSys for maximized LOS values. In this scenario, the total duration of the timetable was almost 2 h longer than in the results obtained from the RTC, as the overall capacity utilization was decreased because all meet-pass options were eliminated. Therefore, a more realistic timetable duration/maximum allowed dwell time combination was investigated that would meet recommended capacity utilization, while improving LOS of the initial timetable.A total of 28 timetable duration/maximum allowed dwell time combinations were applied to identify a duration/dwell time combination that aligns closely with the 70% practical capacity utilization threshold recommended in railway literature (Pouryousef et al., 2013; UIC, June 2004; Pachl, 2002). Fig. 8presents the capacity utilization percentage of all simulated scenarios and illustrates that the timetable compression with “10-h timetable duration and 10-min maximum allowed dwell time” keep the capacity utilization under the 70% threshold. Any other combination (e.g. 11-hours timetable duration and 20-min max. allowed dwell time) would either unnecessarily extend the maximum allowed dwell time, or increase the capacity utilization above recommended threshold.Table 5compares the differences in train departure times and dispatching order between initial and “10-min maximum allowed dwell time” scenarios in RailSys. As illustrated in the table, the dispatching order remained the same during the compression for both eastbound and westbound directions, as it was in the initial schedule.Fig. 9presents the timetable with the preferred “10-min maximum allowed dwell time” scenario. The timetable has been compressed by approximately 60 min from the maximum LOS option (Fig. 7). The adjusted timetable is still 57 min longer than the initial timetable of RTC, but the LOS parameters have been substantially improved. This demonstrates the trade-off between LOS parameters and total timetable duration (or capacity utilization).Fig. 9 revealed a few occasions where trains were stopped for a siding without reason (Fig. 10-top). It was speculated that RailSys maintained the unnecessary stops, as they were needed to resolve the train conflicts in the initial schedule. Manual timetable adjustments were made to eliminate the unnecessary stops. The new adjusted timetable (RailSys compression technique + manual adjustments) reduced the overall duration of timetable by approximately 25 min as illustrated in Fig. 10-bottom, making it 32 min longer (instead of 57 min) than the initial RTC timetable, but with improved LOS parameters.As illustrated in the research flow diagram (Fig. 2), the final step of the hybrid process was to validate the new timetable developed in RailSys by running it through RTC. Fig. 11shows the final timetable by RailSys and the validated timetable in RTC.As illustrated in Fig. 11, all trains were successfully dispatched in RTC with the same order and same stop patterns. However, the signaling and rolling stock differences between RailSys and RTC caused the similar deviations of arrival/departure times and dwell times (approx. 1–4 min deviation), as were witnessed during the RTC/RailSys conversion. These deviations caused 40 min longer timetable duration in RTC (Fig. 11-bottom) when compared to the RailSys results (Fig. 11-top).In addition to comparing overall duration, this step of research compared the order of trains, stop patterns, and departure/arrival times. The results showed approximately 92% match between RTC and RailSys in validation process. Table 6presents a breakdown of the matching levels for individual parameters.The first column of Table 6 (Matching Parameters) describes the parameters which were included for evaluating the validation step. The second column of the table presents the observed deviations between the RTC and RailSys outputs for each respective parameter. The third column (Matching %) uses the observed deviations to calculate the matching percentage of each respective parameter. For instance, in “Overall Duration” (the first parameter), the value of deviation (40) was divided by the overall timetable duration of RTC (462) and then deducted from “1” to calculate the “Matching %” (92%).The importance of each parameter for evaluating the validation step is shown in the fourth column (Impact Factor). For this study, a higher impact factor of “0.2” is assigned for “Overall Duration”, “Order of Trains”, and “Stop patterns”, as these parameters are more critical in defining a timetable. The impact factor of the remaining parameters is “0.1”.The “Matching %” of each parameter was multiplied with the respective “Impact Factor” to compute the “Normalized Matching %”. Then, the “Normalized Matching %” were aggregated to calculate the “Overall Matching %” between RTC and RailSys outputs.Table 7summarizes the timetable characteristics derived from outcomes of the hybrid simulation approach for 10-h timetable duration and 10-min maximum allowed dwell time. The table shows substantial improvements in LOS parameters, including 55% reduction in total stops, over 80% reduction in total dwell times and over 65% reduction in average dwell time with low standard deviation. These improvements are countered by an 18% increase in the timetable duration from the initial timetable (after RTC validation). The results highlight timetable management's potential to increase the LOS, but also confirms the reverse relationship between LOS criteria and capacity utilization levels. As we see, if LOS is improved, the timetable tends to be stretched and capacity utilization may be degraded and vice versa.This paper started with an introduction to the railway capacity and LOS analysis, and briefly discussed the use of commercial railway simulation software. The paper also introduced a hybrid simulation approach that uses the capabilities of timetable based (RailSys) and non-timetable based software (Rail Traffic Controller or RTC) to investigate the trade-off between timetable duration (capacity utilization) and LOS parameters. The hybrid simulation approach used the output of RTC as input in RailSys, and the timetable compression technique offered by RailSys was applied to adjust the initial timetable. The adjusted RailSys timetable was then validated through RTC simulation to confirm its repeatability in the U.S. based software.The hybrid simulation approach was successfully completed to turn a train dispatching request with numerous conflicts first to a conflict-free initial timetable by RTC, and then to a modified timetable with maximized LOS (no stop pattern, no dwell time) in RailSys. 28 scenarios were then developed in RailSys to identify timetable duration/maximum allowed dwell time combination that provided reasonable LOS parameters while maintaining the capacity utilization under the recommended threshold of 70%. Finally, the selected scenario of RailSys was validated in RTC with over 90% match between the simulation results.Based on the results, the scenario of 10-h timetable duration and 10-min maximum allowed dwell time was identified as the preferred scenario for evaluating the trade-off between LOS parameters and capacity utilization. When comparing with the initial timetable, the unnecessary stops were reduced by 55%, delays reduced by 85%, and average dwell times were reduced over 70% with low standard deviation. As a trade-off, the total timetable duration was increased by 72 min (18%). The results highlight the timetable management's potential to improve the LOS, but also confirm the reverse relationship between LOS criteria and capacity utilization levels.Overall, the study suggests that timetable compression technique can be applied in the U.S., if an appropriate model and algorithm are developed to address the respective network and operational characteristics of the U.S. rail environment. While the hybrid simulation approach as developed for the research proved to be successful and provided credible results, it was also extremely time-consuming, which reduces its applicability to industry applications. The fact that RailSys is developed in Europe also made the conversion to North American rolling stock and signaling systems challenging and caused minor differences between the simulation outcomes. Future research could investigate whether a different commercial rail simulation package (such as OpenTrack, Schedulemiser, Trapeze) can produce the outcomes of hybrid simulation approach in single software, or if they face similar challenges as software used in the study. Alternatively, one of the tested software packages could either be extended to complete all the steps, or a standalone model could be developed to replace the need for a second simulation software.

@&#CONCLUSIONS@&#
