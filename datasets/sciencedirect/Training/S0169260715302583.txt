@&#MAIN-TITLE@&#
Retinal blood vessels segmentation by using Gumbel probability distribution function based matched filter

@&#HIGHLIGHTS@&#
A novel matched filter approach with the Gumbel PDF as its kernel is proposed.Pre-processing includes PCA based gray-scale conversion and contrast enhancement.Post-processing includes the entropy based optimal thresholding and length filtering.On the basis of exhaustive experiment select the appropriate value of parameters.

@&#KEYPHRASES@&#
Matched filter,Gumbel probability distribution function,Retinal blood vessels segmentation,Entropy based optimal thresholding,

@&#ABSTRACT@&#
Background and objectiveRetinal blood vessel segmentation is a prominent task for the diagnosis of various retinal pathology such as hypertension, diabetes, glaucoma, etc. In this paper, a novel matched filter approach with the Gumbel probability distribution function as its kernel is introduced to improve the performance of retinal blood vessel segmentation.MethodsBefore applying the proposed matched filter, the input retinal images are pre-processed. During pre-processing stage principal component analysis (PCA) based gray scale conversion followed by contrast limited adaptive histogram equalization (CLAHE) are applied for better enhancement of retinal image. After that an exhaustive experiments have been conducted for selecting the appropriate value of parameters to design a new matched filter. The post-processing steps after applying the proposed matched filter include the entropy based optimal thresholding and length filtering to obtain the segmented image.ResultsFor evaluating the performance of proposed approach, the quantitative performance measures, an average accuracy, average true positive rate (ATPR), and average false positive rate (AFPR) are calculated. The respective values of the quantitative performance measures are 0.9522, 0.7594, 0.0292 for DRIVE data set and 0.9270, 0.7939, 0.0624 for STARE data set. To justify the effectiveness of proposed approach, receiver operating characteristic (ROC) curve is plotted and the average area under the curve (AUC) is calculated. The average AUC for DRIVE and STARE data sets are 0.9287 and 0.9140 respectively.ConclusionsThe obtained experimental results confirm that the proposed approach performance better with respect to other prominent Gaussian distribution function and Cauchy PDF based matched filter approaches.

@&#INTRODUCTION@&#
The retinal blood vessel's structure contains the important information which is helpful for the detection and diagnosis of various retinal pathology such as hypertension [1] glaucoma [2], diabetes [3–5]. The ophthalmologist scans the retina of the patients by using high resolution fundus camera and then probing the situation of retinal blood vessels to diagnose the retinal diseases [6]. In some cases it is found that the retinal blood vessels have low contrast with respect to their background. So it is difficult to diagnose the retinal disease. Therefore, it is necessary to apply suitable image segmentation technique for accurate detection of retinal blood vessels. These techniques are based on the image features such as the cross-sectional profiles, uniform intensity regions and edges. The intensity of the retinal blood vessel changes smoothly, so normal edge based models such as gradient operators [7–9], Robert's and Krisch differential operators [10], Prewitt operators [11], Sobel operators [12] are not suitable to identify them accurately.The author Fraz et al. [13] classify the retinal blood vessel segmentation approaches into seven categories on the basis of retinal image features, namely, the intensity based pattern recognition techniques [5,14–16], mathematical morphology based [17–19], vessel tracking based [20], model based [21–23], parallel hardware based [24,25], multi-scale based techniques [26,27] and matched filter based approach [28,17,6,29].In this paper, our concentration on matched filter based retinal blood vessel segmentation approach because it provides the best retinal vessel structure with respect to other filtering approaches [28,17,6,29]. The matched filter based approaches compare the variations of the intensity level of the cross-section profile of the retinal image with the predetermined template or kernel. The first matched filter based retinal blood vessel segmentation approach was proposed by Chaudhuri et al. [28]. The matched filter based approach detects the retinal blood vessel by applying the matched filter kernel and thresholding on the original input retinal image [28]. To design a matched filter kernel, three points are important which include limited curvature of vessels which may be approximated by bell-shape piecewise linear segments and the width of the vessels gradually decreases when one move away from the optical disk of the retinal image, and cross-sectional intensity profile of retinal blood vessels. First time Chaudhuri et al.[28] stated that the cross-sectional profile of retinal blood vessels has an approximate Gaussian shape. Hence the Gaussian shaped matched filter kernel is reported in literature for the detection of retinal blood vessels.According to the literature survey on matched filter based approach, it was found that the many authors improved the performance of matched filter based approach by improving the thresholding techniques [30,31] rather than changing the Gaussian shaped matched filter kernel. The matched filter based approaches use the prior knowledge about the shape and symmetry of the cross-section profile of the retinal blood vessel with respect to their location and scale parameter. Therefore author H. Zolfagharnasa et al. [32] replaced the Gaussian function based matched filter by Cauchy probability density function (PDF) and reported that the accuracy of retinal blood vessel detection was substantially improved.If visually compare the cross-section intensity profile of the region marked in Fig. 1(a) and (d) by selecting 80 pixels between two points, as shown in Fig. 1(b) and (e), or their approximate well shaped cross-section profile by selecting less number of pixels (30pixels) between the selected points, as shown in Fig. 1(c) and (f), with the actual Gaussian, Cauchy, and Gumbel PDFs curves as shown in Fig. 2(a)–(c), it is observed that the Gumbel PDF provides better match with the cross section profile in comparison to Gaussian and Cauchy PDF curves because the Gumbel PDF curve is slightly skewed with respect to the Gaussian and Cauchy PDF curves.After that in this paper we analyze the gray scale cross-section profile data of retinal image statistically and found that cross-section profile of all 20 retinal images (selected from the test set of DRIVE database) are slightly skewed. The statistical results are mentioned in Table 1. So, we examine all extreme value PDF such as Gumbel, Weibull and Frechet PDFs to design a matched filter kernel for the retinal blood vessels segmentation, because the extreme value PDF curves are slightly skewed. Regarding that the average accuracy of Gumbel, Weibull and Frechet PDF based matched filter approach for retinal image segmentations are evaluate experimentally and found 0.9522, 0.9513, and 0.9509 respectively. On the basis of an experimental result it is found that the Gumbel PDF based matched filter approach achieved better result with respect to the Weibull and Frechet PDF based matched filter approach. Therefore, In this paper we propose the Gumbel PDF based matched filter approach to achieved better retinal blood vessel segmentation result. The detailed theoretical aspect of above justifications are shown in Section 2.2 and validated them through experimental result shown in results and performance analysis section.The rest of the paper is organized as follows: Section 2 presents the method and model, Section 3 presents result analysis of proposed approach which is tested on DRIVE, STARE databases and results are encouraging. Finally, Section 4 presents the conclusion of the proposed approach.Our proposed retinal blood vessels extraction approach belongs in the category of matched filter based approach. The block diagram of the proposed approach is shown in Fig. 3, is the combination of pre-processing, Gumbel PDF based matched filtering, entropy based optimal thresholding, vessel length filtering and removing outliers artifacts by using the concept of masking.The contrast difference of the retinal blood vessels with respect to their background is low and their contrast decreases, when move away from the optical disk of the retinal image. Hence to improve the accuracy of retinal blood vessel segmentation, the contrast enhancement of gray scale retinal image is a prominent pre-processing task. The pre-processing module of proposed approach contains two steps, first convert the RGB color retinal image into gray scale image and then enhance the gray scale image found in step one. To convert the RGB color retinal image into gray scale image various authors [7,33–35,28,17,36] used only green channel image of RGB color retinal image for generating the gray scale image. Because the contrast of the blood vessels in the green channel image is better in comparison to the red and blue channels of RGB color retinal image. The green channel image is converted into gray scale image by using ‘rgb2gray’ function available in Matlab say Method-1 (based on weighted sum of the R, G, and B components) and then the successive step of particular retinal blood vessel segmentation approaches are applied on gray scale image.In this paper, principal component analysis (PCA) based color-to-gray image conversion method say Method-2, is used to generate a gray scale image of color retinal image. Because, the PCA based color-to-gray conversion method effectively preserves both the texture and color discriminability by using simple linear computations in subspaces with low computational complexity [37].The average SNR value has been evaluated by using Eqn−1, to compare the quality of gray scale retinal image generated from Method-1 and Method-2 for all 20 retinal image selected from test set of DRIVE database as given in Table 1. On the basis of average SNR as given in Table 1, it is clear that the quality of gray scale generated from Method-2 is better with respect to Method-1. So in first step of the pre-processing module, a PCA based color-to-gray conversion method (Method-2) is used to generate the gray scale image.(1)AverageSNR=MeanofImageStandardDeviationofImageThe PCA based color-to-gray conversion method used in pre-processing module contains four steps which is as follows-•Vectorized color image by using three color channels (red, green, and blue).Finding a zero mean YCbCr image to separate the luminance and chrominance channels.Computation of three eigenvalues and respective normalized eigenvectors are computed by using principal component analysis (PCA).Eigenvalue-weighted linear sum of subspace projection (ELSSP) algorithm [37] is apply to generate gray scale image. (Fig. 4(a) and (c))In second step of pre-processing module, a contrast limited adaptive histogram equalization (CLAHE) is applied on the gray scale retinal image found in first step of this module and generate the contrast enhanced gray scale image as shown in Fig. 4(b) and (d). The average SNR value of enhanced gray scale image generated after completing pre-processing module has been evaluated for all 20 retinal image selected from test set of DRIVE database by using Eqn−1 and reported in Table 1. The average SNR of enhanced gray scale image after completing pre-processing module indicates that their quality is improved.The matched filter based retinal blood vessel segmentation approach compares the gray scale cross section profile of retinal blood vessels with the predefined kernel. The Chaudhuri et al. [28] proposed a first matched filter approach based on Gaussian function and claimed the vessel cross-section profile is in approximate Gaussian shape. The Gaussian function is defined as:-(2)f(x,y)=−e(−x2/2σ2)for|y|≤L/2where σ is the variance and L is the length of piece-wise line segment in the kernel. The actual Gaussian curve is shown in Fig. 2(a). The author H. Zolfagharnasa et al. [32] proposed a Cauchy PDF based matched filter approach and claimed the vessel cross-section profile matched better with Cauchy PDF curve as shown in Fig. 2(b). The Cauchy PDF is defined as:-(3)f(x)=1πγ1+(x−x0)γ2where γ is scale parameter and behave like a variance used in Eqn−2 and x0 is location parameter used to shift the peak position of cauchy curve in x-axis. As shown in Fig. 2(a) and (b) the Gaussian and Cauchy PDFs both equally diminish towards their truncated values on both sides of their peak value but the Gaussian function reaches to its truncated value faster with respect to the Cauchy PDF.If we analyses the vessel cross-section intensity profile of the region marked in Fig. 1(a) and (d) as shown in Fig. 1(b) and (e) by selecting 80 pixels between two points or their well shape cross-section intensity profile as shown in Fig. 1(c) and (f), by selecting 30 pixels between two points, then it is clear that the cross-section intensity profile does not equally diminish toward their truncated values on both sides of their peak value and moderately skewed with respect to the Gaussian and cauchy PDF curve.Therefore, the statistical analysis is required to justify that the gray scale intensity profile curve of retinal image is moderately skewed and not an approximate Gaussian shape. Generally the histogram of image can provide the basic idea about the skewness, but there are some common statistical methods proposed Cunnane et al. [38], Chausse et al. [39], Kochanek et al. [40] and Joanes and Gill [41] are provide a more precise evaluation to measures the skewness. In this paper the skewness is evaluated for gray scale profile data of retinal image by using the statistical method proposed by Joanes and Gill [41]. The moment coefficient of skewness for gray scale data of retinal image is evaluated by using following Eqn.(4)Skewness(τ)=M3/M2(3/2)where M2 and M3 is second and third moment of gray scale data set and evaluated by using the followingEqn′s(5)X¯=∑i=1NXi/N(6)M2=∑i=1N(Xi−X¯)2/N(7)M3=∑i=1N(Xi−X¯)3/NwhereX¯is known as mean of the data set and N is number of element in a data set. The median and mode for gray scale data of retinal image is also evaluated. All the statistical measures for all 20 retinal image taken from test set of DRIVE database are given in Table 1.According to the analysis of statistical measures as reported in Table 1, there are two reasons are found which shows that the gray scale cross-section intensity profile of retinal image is not approximate Gaussian shape. First, the mean, median, and mode of all 20 retinal images (as shown in Table 1) are not equal which contradict the Gaussian characteristic (the value of mean, median, and mode must be equal or approximate equal). Second reason is the skewness (τ) that predict, the gray scale cross-section intensity profile of retinal image is not approximate Gaussian shape. According to classical rule of thumb suggested by author Bulmer et al. [42] to interpret the skewness, it is observe that the value of skewness of all 20 retinal image taken from test set of DRIVE database are belongs in between −1 and −0.5. Therefore, the gray scale cross-section profile curve of retinal image is moderately skewed rather than approximate Gaussian. A classical rule of thumb to interpret the skewness given by Bulmer et al. [42] are as follows-Perfectlyskewed,ifτ=0Highlyskewed,if(τ<−1)or(τ>1)Moderatelyskewed,ifτ∈(−1,−0.5)or(0.5,1)Approximatelysymmetric,ifτ∈(−0.5,0.5)Due to above two reasons, we proposed a novel Gumbel PDF based matched filter approach to segment the retinal blood vessels. The Gumbel PDF is an extreme value probability distribution function having skewed characteristics and defined as:-(8)f(x,y)=1βeX−μβe−eX−μβfor|y|≤L/2where X is the perpendicular distance between point (x, y) and straight line passing through the center of retinal blood vessel, μ and β are the location and scale parameter respectively and L is the piece-wise line segment in the kernel.First we discuss about scale parameter (β), location parameter (μ) used in Gumbel PDF and then discuss about the piece-wise line segment (L) in the kernel. The scale parameter (β) must be positive real number. The behavior of β used in Gumbel PDF is similar to the variance (σ) and scale parameter (γ) used in Gaussian and Cauchy PDF respectively. For small value of β, the Gumbel PDF curve narrows down and for large value of β, the Gumbel curve expands as shown in Fig. 1(f). However, the behavior of scale parameter (β) used in Gumbel PDF is different from σ and γ with respect to their diminishing behavior towards their truncated value as previously discussed and clearly visible in Fig. 2.Beside the scaling parameter (β), Gumbel PDF has another parameter known as location parameter (μ). The location parameter (μ) shift the graph on horizontal X-axis. Therefore selection of location parameter (μ) is important. The proposed approach have been tested for some selected value of β (from 0.5 to 3 with 0.5 interval), at different location (μ=0 to 3 with 0.5 interval). After the analysis of obtained result for all 42 different possible combinations of μ and β as shown in Fig. 5, it is observed that the highest average accuracy of retinal blood vessel segmentation is achieved at μ=1.0 and β=0.5. So in the proposed approach we select 1.0 as the value of location parameter (μ) and 0.5 as the value of scale parameter (β).According to the Chuadhuri et al. [28] notation, The length of retinal blood vessels is assumed as piece-wise line segment (L) in the kernel. In this paper the length of piece-wise line segment determined experimentally by analyzing the blood vessels in both normal and abnormal retinal image. This step reduces the possibility of false vessels detection in non-ideal environment [28]. For the experimental analysis, evaluate the average accuracy of retinal blood vessel segmentation for the different values of L varies from 1 to 15 and observed that the average accuracy of retinal blood vessel segmentation is continuously increasing from L=1 to 10 after that it decreases from L=11 to onwards as shown in Fig. 6.So in this paper the value of L=10 is selected as the length of piece-wise line segment in the kernel.On the basis of above selected parameters matched filter kernel is design. To design a matched filter kernel, we assume that the Px=[x,y] is a point in the kernel, θiis the orientation of the ith kernel matched to the retinal blood vessel at an angle θiand kernel is centered about the origin. To cover the piece-wise line segments of whole retinal image, a set of twelve kernels having size 15×15 are used in each direction to detect the retinal blood vessels by rotating the kernel 15owith respect to the previous one. These twelve kernels with different orientations are calculated by using the following rotation matrix (Rmi) which is defined as:(9)Rmi=Cosθi−SinθiSinθiCosθiThe corresponding pointPxi=[Rx,Ry]in the rotated coordinate system is obtained by(10)Pxi=[Rx,Ry]=PxRmiTAfter constructing twelve different kernels based on Gumbel PDF, it is applied on the gray scale retinal image and then convolved them and found the matched filter response (MFR) image. The MFR image of retina image ‘20−test.tif’ taken from DRIVE data set is shown in Fig. 7.After applying the proposed matched filtering approach, to produce the binary image of retinal blood vessel structure from the Gumbel PDF based matched filter response (MFR) image, an efficient thresholding algorithm is applied. For this purpose, we use entropy based optimal thresholding algorithm [43,44,32]. The entropy based optimal thresholding algorithm is better than other thresholding algorithms. Reason behind this is that the dependencies between the pixel's intensities of MFR image allows us to preserve the spatial structure of the thresholded images and are able to correctly classify the retinal blood vessels from their backgrounds as argued in [43,44,32]. The segmented retinal blood vessels from their background are shown in Figs. 8(a) and 9(a)for image ‘18−test.tif’ and ‘im0082.ppm’ taken from DRIVE and STARE dataset respectively.After observing Figs. 8(a) and 9(a) generated in previous step, it is found that some isolated and misclassified pixels are presents. To remove these isolated and misclassified pixels, length filtering by using eight-connected neighborhood and pixel label propagation is applied to find a retinal blood vessels structure, as shown in Figs. 8(b) and 9(b). It may be possible that some artifacts outside the region of interest may be included in retinal boundary. Hence, for removing these artifacts the masking is applied by using the mask generated by particular retinal image, as shown in Figs. 8(c) and 9(c). Finally, compliment of the segmented image (shown in Figs. 8(d) and 9(d)) is generated for evaluating the TPR (sensitivity), FPR (1-specificity) and accuracy with respect to ground truth image given in DRIVE and STARE databases respectively.The proposed Gumbel-MF method have been implemented on two publicly available retinal image data sets, the DRIVE [45] and the STARE data set [17]. The images taken from the DRIVE data set were obtained from a diabetic retinopathy screening program in the Netherlands, which is on-line freely available [45]. The screening population consisted of 400 diabetic subjects between 25 and 90 years of age and forty images have been randomly selected. Out of 40 images, 33 are normal and 7 are abnormal retina images [3]. These images were acquired from Canon CR5 non-mydriatic 3CCD camera with a 45 degree field of view (FOV). The captured images contain 8 bits per color plane at 768 × 584 pixels. The ground truth image was manually segmented and segmentation process was performed by observers, a computer science student, and they have been trained by an experienced ophthalmologist Michael D. Abramoff [3]. These 40 images were divided into two sets a test set and a training set and each set contains 20 original retinal images together with respective ground truth images. The images taken from STARE database were obtained from the Shiley Eye Center at the University of California, which is on-line freely available [17]. The STARE database contains 20 retinal images and out of 20 images there are 10 healthy retinal fundus images and the remaining belong to unhealthy retinal images. These images were captured by a TopCon TRV-50 fundus camera at 35 degree field of view. The captured images contain 8 bits per color channel at 650×500pixels. The ground truth image was manually segmented and segmentation process was performed by two observers namely Adam Hoover and Valentina Kouznetsova. The proposed vessels segmentation approach have been implemented on Matlab R2013a on a PC having AMD E-450 APU, Radeon with 1.65GHz processor having 2GB RAM. The average execution time of entire process for 20 images of DRIVE database and 20 images of STARE database took about 2.26 and 2.4min respectively.To compare the performance of the proposed approach, the quantitative performance measures, an average accuracy, average true positive rate (ATPR), and the average false positive rate (AFPR) are calculated. These quantitative performance measures are widely used and defined in literature [17,31,28,3,5,4,46,47]. The accuracy of the segmentation algorithms is defined as the ratio of total correctly classified pixels with total number of pixels in the selected image. The TPR is the ratio of total correctly classified vessel pixels with total number of vessel pixels in the respective ground truth image and similarly the FPR is the ratio of total correctly classified non-vessel pixels with total number of non-vessel pixels in the respective ground truth image. The values of these performance measures are shown in Table 2for both DRIVE and STARE databases.In this paper, the proposed approach is compared with three prominent matched filter approaches, namely a classical Gaussian matched filter approach introduced by author Chaudhuri et al. [28], improved matched filter approach introduced by Al-Rawi et al. [6], and Cauchy matched filter approach introduced by H. Zolfagharnasab et al. [32] as well as some other segmentation approaches proposed by Zhang et al. [29], Xiaoyi et al. [31], Cinsdikici et al. [48], Amin et al. [49], D Marin et al. [15], and Lam et al. [23]. All 20 retinal images of test set from DRIVE data set are used for comparative analysis. The ATPR, AFPR, and average accuracy of proposed approach and previously mentioned approaches are reported in Table 3. According to results analysis, the performance measures of proposed approach is found better in comparison to the prominent matched filter approaches as well as other matched filter based approaches. The average accuracy of proposed approach is better by 8.13%, 4.26%, 2.53%, 1.42%, 3.10%, 2.29%, 3.22%, 0.70%, and 0.50% with respect to average accuracy of approaches introduced by Chaudhuri et al. [28], Al-Rawi et al. [6], H. Zolfagharnasab et al. [32], Zhang et al. [29], Xiaoyi et al. [31], Cinsdikici et al. [48], Amin et al. [49], D Marin et al. [15], and Lam et al. [23] respectively. After that for all 20 retinal images of STARE data set, we compare the ATPR, AFPR, and average accuracy of proposed approach with other approaches introduced by Hoover et al. [17], Kande [50], Zhang et al. [51], Perez et al. [52], Palomera et al. [53] and Xiaoyi et al. [31]. According to the comparative analysis as reported in Table 4, it is found that the average accuracy of proposed approach is better by 0.03%, 2.94%, 1.83%, 0.30%, 0.10%, and 2.61% with respect to average accuracy of approaches introduced by Hoover et al. [17], Kande [50], Zhang et al. [51], Perez et al. [52], Palomera et al. [53], and Xiaoyi et al. [31] respectively.Other than the quantitative performance measures, the receiver operating characteristic (ROC) curve is used to justify the effectiveness of the segmentation approach [54]. ROC curve is a graphical representation of TPR on the y-axis and FPR on x-axis. The area under the curve (AUC) is an important component of ROC for justify the effectiveness of any segmentation approach. The maximum value of AUC is 1 which indicates segmentation approach is perfect for differentiating the true vessels from their background that means the number of false positive and false negative pixels must be zero, which is practically not possible [54]. If the value of AUC closer to 1 which indicates the better performance of the segmentation approach [54].Therefore, to justify the effectiveness of proposed approach, we plot the ROC curve and calculate the AUC by using the ATPR and AFPR for both the DRIVE and STARE data set as shown in Figs. 10 and 11respectively. The value of average AUC is 0.9287 and 0.9140 for the 20 retinal images of DRIVE and STARE data sets respectively. In both cases, value of AUC is closer to 1 which indicates that the performance of proposed Gumbel PDF based matched filter approach for retinal blood vessels segmentation is better.

@&#CONCLUSIONS@&#
