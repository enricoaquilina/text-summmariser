@&#MAIN-TITLE@&#
Multithreat multisite protection: A security case study

@&#HIGHLIGHTS@&#
Novel approach to security resource allocation in multithreat, multisite problems.We use the adversarial risk analysis framework.Several modeling variants for structure and assessing relevant parameters.Illustrates a real metro security problem, with fare evasion and pickpocketing.Large savings in operator costs by investing in maximum expected utility portfolios.

@&#KEYPHRASES@&#
Risk analysis,Multiple intelligent attackers,Adversarial risk analysis,Multisite protection,Transportation,

@&#ABSTRACT@&#
We provide a novel adversarial risk analysis approach to security resource allocation decision processes for an organization which faces multiple threats over multiple sites. We deploy a Sequential Defend-Attack model for each type of threat and site, under the assumption that different attackers are uncoordinated, although cascading effects are contemplated. The models are related by resource constraints and results are aggregated over the sites for each participant and, for the Defender, by value aggregation across threats. We illustrate the model with a case study in which we support a railway operator in allocating resources to protect from two threats: fare evasion and pickpocketing. Results suggest considerable expected savings due to the proposed investments.

@&#INTRODUCTION@&#
Crime and terrorism constitute major global issues. As an example, among the threats considered in the World Economic Forum (2015) Global Risks report, there are several related with security, including large-scale terrorist attacks or a major escalation in organized crime. Similarly, we may find security among the seven thematic H2020 priorities for European research (ec.europa.eu/programmes/horizon2020). Governments and organizations worldwide are indeed increasingly committed to protecting themselves against various security threats. Recent large-scale terrorist events like 9/11 or the Madrid train bombings have led to significant national investments in protective responses, see (Haberfeld & von Hassell, 2009). However, public opinion has not always seen such expenditures as prudent or effective, see (Parnell et al., 2008) or (Sunstein, 2007).In turn, this has motivated great interest in modeling issues in relation with security, with varied tools from areas such as reliability analysis, data mining, game theory or complex dynamic systems. Recent accounts of various techniques and applications in the field of counterterrorism may be seen in e.g. Ezell, Bennett, von Winterfeldt, Sokolowski, and Collins (2010) or Wein (2009). Parnell et al. (2008) and Enders and Sandler (2011) provide overviews on strategies, models, and research issues in security risk analysis. Other relevant work include e.g. Zhuang and Bier (2007), who discuss resource allocation for countering terrorism and natural disasters; (Brown, Carlyle, Salmerón, & Wood, 2006), where the protection of critical infrastructures is addressed; or (Yang, Kiekintveld, Ordóñez, Tambe, & John, 2013), who present mathematical models of adversarial behavior to support security forces in their fight against different adversaries.We consider problems in which an organization needs to protect multiple sites from multiple threats. Our case study refers to deciding the security resource allocation for a railway system whose operator faces threats from fare evaders and pickpockets. The figures presented in the paper have been modified from actual figures to protect the confidentiality of the case study provider. Therefore, the data is realistic data but not actual data. We assume that the relevant multiple threats are uncoordinated, in that different attackers do not make common cause, although the outcome of different types of attacks might affect each other. In our case study, fare evaders and pickpockets will not be coordinated, although pickpockets alone and a group of fare evaders will be organized. Hausken and Levitin (2012) provide a classification of systems defense and attack models. Within such classification, we shall be facing a case of protection from attacks over multiple elements with incomplete information. For earlier work on protecting from multiple attackers, see (Hausken & Bier, 2011) and references therein. Haphuriwat and Bier (2011); Hausken (2014b) and Levitin, Hausken, and Dai (2014) provide ideas in relation with multiple site protection. Bier, Oliveros, and Samuelson (2007) and Hausken (2014a) refer to uncertainty in attacker resources and asset valuation. All of them perform game theoretical analyses under convenient common knowledge assumptions.In contrast, we provide an adversarial risk analysis (ARA) approach, see (Ríos Insua, Ríos, & Banks, 2009), for such problems, combining multiple sites, multiple attackers and taking into account all relevant uncertainty sources. ARA builds a decision analysis model for one of the agents (she, the Defender), who forecasts the actions of her adversaries. Then, she will be able to decide her optimal defensive actions. Our approach will be based on the Sequential Defend-Attack model, see e.g. Brown et al. (2006) or Ríos and Ríos Insua (2012). In it, the Defender first chooses a defense and, then, after observing it, the Attacker decides his attack. We deploy one of such models for each type of threat and site, which we relate through resource constraints and aggregation of results over various sites for each participant and, for the case of the Defender, also by value aggregation over the various threats. We assume no particular spatial structure relating the sites, e.g. through proximity or a neighboring structure, see (Gil, Ríos, & Ríos Insua, 2016).In Section 2, we provide a general framework for the basic problem of protecting a single site from multiple threats, illustrating it with our case in Section 3. Section 4 extends the previous model to the protection of multiple sites, applying it to an expanded version of the case study in Section 5. As described below, all the involved parameters have been assessed with the aid of transportation experts, using expert judgment elicitation techniques, see (O’Hagan et al., 2006) or Farquhar (1984), then validated at a security transportation workshop, and finally checked for robustness through sensitivity analysis.We start with the basic multithreat protection problem over a single site. We consider a Defender, D, who needs to deploy defensive resourcesd∈Dto protect the site from m uncoordinated attackersA1,…,Am. These observe her decision d and, then, respectively, launch attacksai∈Ai,i=1,…,m. The interaction between D and Aithrough their corresponding decisions d and ai, leads to a random resultSi∈Si. The Defender faces multiattribute consequences cDwhich depend on her defense effort d and the resultss1,…,sm. She then gets her utility uD. Each attacker will get his multiattribute consequencescAi,which depend on his attack effort aiand his result si, and then gets his utilityuAi.The problem is illustrated in the multiagent influence diagram in Fig. 1, see (Koller & Milch, 2003). For simplicity, we only display two attackers, that ism=2. White nodes correspond to the Defender, solid (light and dark) gray nodes to attackers A1 and A2, respectively. Striped nodes refer to interactions between the Defender and the attackers. Dashed arrows between node D and nodes A1 and A2 indicate that the attackers decide their alternatives after having observed the decision by D.As an example, a port authority (D) is trying to protect a port against actions from drug smugglers (A1) and terrorists (A2) ready to introduce nuclear weapons. The Defender decisions d are portfolios which could include sniffer dogs, metal detectors, inspectors and others. Drug smuggler decisions a1 typically would refer to drug smuggling (timing, placing, quantities) strategies. Terrorist decisions a2 could refer to weapon smuggling strategies, like whether or not to infiltrate a nuclear weapon. S1 could refer to the amount of drugs actually smuggled and S2 could refer to the number of weapons smuggled.The Defender aims at finding her optimal defense strategy d*. She evaluates her consequences through her utilityuD(d,s1,…,sm). Assuming conditional independence between the outcomes Siof different attacks, given the defensive resources d and attacks ai, she needs to assess the probability modelspD(si|d,ai),i=1,…,m,reflecting which outcomes she finds more likely when attacker Ailaunches attack aiand she has deployed defensive resources d. She gets her expected utility, given the attacks, integrating out the uncertainty over the outcomes of the attacks:(1)ψD(d|a1,…,am)=∫…∫uD(d,s1,…,sm)×pD(s1|d,a1)⋯pD(sm|d,am)ds1…dsm.Suppose that the Defender is able to build the modelspD(ai|d),i=1,…,m,expressing her beliefs about which attack aiwill be chosen by the ith attacker after having observed d. Since attacks are uncoordinated, we assume conditional independence ofa1,…,amgiven d. Then, D may computeψD(d)=∫…∫ψD(d|a1,…,am)pD(a1|d)⋯pD(am|d)×da1…dam,and solve maxdψD(d) to find her optimal defense resource allocation d*.The only nonstandard assessments in this formulation are those of pD(ai|d). To obtain them, the Defender may put herself into the shoes of each attacker, and solve their corresponding problem separately, since they are uncoordinated. For instance, for the problem faced by attacker A1, assuming that he is an expected utility maximizer, see (French & Ríos Insua, 2000), the Defender would need his utilityuA1(a1,s1)and probabilitiespA1(s1|d,a1). Then, she would solve(2)a1*(d)=argmaxa1∈A1∫uA1(a1,s1)pA1(s1|d,a1)ds1,to find his optimal attack given that she has implemented d. However, she lacks knowledge aboutuA1andpA1. Suppose we may model her uncertainty about them through random utilities and probabilities(UA1,PA1),and propagate that uncertainty to obtain the random optimal attack, given her defense d,(3)A1*(d)=argmaxa1∈A1∫UA1(a1,s1)PA1(s1|d,a1)ds1.Then,we would getpD(a1|d)=Pr(A1*(d)≤a1),which may be approximated by Monte Carlo through Algorithm 1.A similar scheme could be implemented in parallel for the other attackers,A2,…,Am,leading to estimatespD^(ai|d)of the required probabilitiespD(ai|d),i=2,…,m.The approach may be generalized in several ways. For example, the simultaneous, but uncoordinated, implementation of attacksa1,…,amcould be jointly detrimental in face of defensive resources d, which could be shared against various types of attacks, see Fig. 2a. Then, we could rewrite the probability model in (1) aspD(s1|d,a1,…,am)⋯pD(sm|d,a1,…,am),and proceed in a similar fashion.Alternatively, there could be a cascading effect between the attack results. For example, see Fig. 2b, assuming thatm=2,it could be that s2 affects s1, so that pD(s1|d, a1) pD(s2|d, a2) in (1) becomes pD(s1|d, a1, s2) pD(s2|d, a2). Under this assumption, the general scheme required to estimatepD^(ai|d),i=1,…,mcannot be implemented in parallel, but requires some sequentiality, as shown below and illustrated in our case study.The influence diagram for the Defender’s problem in this latter case is shown in Fig. 3a, where the attacks appear now as chance nodes.Now, the expected utility for the Defender isψD(d|a1,a2)=∫∫uD(d,s1,s2)pD(s1|d,a1,s2)×pD(s2|d,a2)ds1ds2.After integrating out the uncertainty over the attacks, we obtain her expected utilityψD(d)=∫∫ψD(d|a1,a2)pD(a1|d)pD(a2|d)da1da2,and she obtains the optimal portfolio d* through maxdψD(d).We need to assess pD(a1|d) and pD(a2|d). We start with pD(a2|d). The influence diagram for A2 is sketched in Fig. 3b. Since the result of the attack performed by A2 influences—but is not influenced by—that of A1, the estimation of pD(a2|d) is similar to that of pD(a1|d) in the initial basic formulation, as outlined in (2), (3) and Algorithm 1.Once we have dealt with the problem referring to A2, we may address the problem for A1, whose influence diagram is shown in Fig. 3c. We need to consider the influence of chance node(for him). Indeed, he needs to maximize his expected utility incorporating his uncertainty about the attacking decision a2 (given the defense d)a1*(d)=argmaxa1∈A1∫∫∫uA1(a1,s1)pA1(s1|d,a1,s2)pA1(s2|d,a2)×pA1(a2|d)ds1ds2da2.In general, the Defender will not knowuA1,pA1(s1|d,a1,s2),pA1(s2|d,a2)andpA1(a2|d),but she may acknowledge her uncertainty about them through random utilities and probabilities(UA1,PA1(s1|·),PA1(s2|·),PA1(a2|·)),and propagate that uncertainty to obtain the random optimal attack for each dA1*(d)=argmaxa1∈A1∫∫∫UA1(a1,s1)PA1(s1|d,a1,s2)PA1(s2|d,a2)×PA1(a2|d)ds1ds2da2.Once withA1*(d),she can obtainpD(a1|d)=Pr(A1*(d)≤a1),which can be estimated following a sampling scheme similar to that in Algorithm 1.For this, we need to assess(UA1,PA1(s1|d,a1,s2),PA1(s2|d,a2),PA1(a2|d)),and(UA2,PA2(s2|d,a2)). With respect to the random probabilities, we could base them on the corresponding assessments for the Defender, pD(s1|d, a1, s2), pD(s2|d, a2) and pD(a2|d), possibly as we illustrate forPA2(s2|d,a2):•Should S2 be discrete,PA2(s2|d,a2)could be modeled as a Dirichlet distribution with mean pD(s2|d, a2) and variance accounting for the incumbent uncertainty. In particular, when S2 is binary,PA2(s2|d,a2)would be modeled as a beta distribution, see (French & Ríos Insua, 2000).Should S2 be continuous, thenPA2(s2|d,a2)could be a Dirichlet process with base distribution pD(s2|d, a2) and concentration parameter δ expressing our uncertainty about such base, see (Ferguson, 1973).For both cases, when lacking information, we could use a sufficiently large value for the variance or concentration parameter, respectively. Note also that, for some probability distributions pD( · ), we might have available a sample through Monte Carlo simulation, as e.g. for pD(a2|d), which would have been obtained after applying Algorithm 1 to the problem for attacker A2. Should this happen, we could use the sample variance associated with pD(·) to describe our uncertainty about the correspondingPA2(·),adjusting the variance (or concentration parameter) accordingly.As for the random utility, typically we shall have information about the interests and objectives of the attackers, see (Keeney, 2007) or (Keeney & von Winterfeldt, 2010; 2011), which we would aggregate with a weighted measurable value function, as by Dyer and Sarin (1979). Based on the relative risk aversion concept, see (Dyer & Sarin, 1982), we could assume risk proneness on the attackers. Finally, the uncertainty would be reflected by distributions over the weights and risk proneness coefficients. The proposed models for random probabilities and utilities are illustrated within our case study.Wang and Bier (2013) provide another approach for assessing adversary preferences using ordinal judgments and the probabilistic inversion method, see (Kraan & Bedford, 2005).We consider the case of a railway operator (D) which needs to protect a single station from two threats: fare evasion and pickpocketing. The operator has to deal with two types of fare evaders: (1) Standard, regarded as unintentional, who do not pay for the service in a casual manner; and (2) Colluders (A1), who are intentional fare evaders preparing their evasion actions in an organized way. Reddy, Kuhls, and Lu (2011) provide related work addressing fare evasion, studied in detail by Ríos Insua, Cano, Pellot, and Ortega (2015b). We model pickpockets (A2) as a single organized group, see (Troelsen & Barr, 2012) on combating pickpocketing in public transportation. For this threat, we focus on both security and image costs, as pickpocketing may decrease the feeling of security, affecting the operator business level.When the operator faces both threats simultaneously, this can be viewed as a bi-threat Sequential Defend-Attack model with cascading effect, whose influence diagram, adapted from Fig. 2b, is shown in Fig. 4. Light gray nodes refer to fare evasion, dark gray nodes to pickpocketing and white nodes correspond to the operator’s problem.The decision node “Countermeasures” refers to the portfolio deployed by the operator to reduce: (1) The theft level; and (2) The proportion of standard fraudsters and colluders. With respect to pickpockets, we have uncertainty about the number of thefts and, consequently, on its impact over business level. Pickpockets face costs when preparing their actions, as well as the possibility of being fined if caught red-handed. When successful, they obtain a loot. For fare evasion, we have uncertainty about the proportion of (standard) fraudsters and the number of customers (influenced, in turn, by the theft level), from which we obtain the fraud cost. On the other hand, colluders would decide the proportion of fare evasion they would undertake, although the actual proportion, as reflected in node “Prop. of colluders”, would depend also on the means implemented by the operator. For clarity, we keep fraud costs due to standard evaders and colluders separately, but aggregate them in the deterministic node “Costs”. We assume that colluders and pickpockets do not coordinate their criminal activities.The operator can deploy eight different types of countermeasures, displayed in Table 1. The first five fight fare evasion, whereas the last four are addressed towards pickpockets (the fifth one could affect both threats). We aim at supporting the operator in devising an optimal security portfolio. We provide a detailed model of the problem and, then, fully illustrate the required assessments and implementation.Let (d1, d2, d3, d5, d6, d7) be, respectively, the inspectors, door guards, secured automatic access doors, guards, patrols and cameras to be deployed. Their associated unit costs over the planning period will be, respectively, q1, q2, q3, q5, q6 and q7. We also use a binary decision variable d4 ∈ {0, 1}, withd4=1indicating the involvement of ticket clerks in observation tasks, andd4=0,otherwise. As clerks are already hired by the operator, there are no additional direct costs associated with the reassignment of their duties. However, making them switch from a passive to a proactive attitude towards the fare evasion problem could entail negative implications in terms of troubles with unions. We monetize this assuming a cost q4 for that. We also assume that a public awareness plan costs q8. A binary decision variable d8 ∈ {0, 1} models its implementation, withd8=1meaning that the operator pays for the awareness plan, andd8=0,otherwise. The budget available for the relevant planning period will be B. Then, the feasible security portfoliosd=(d1,d2,d3,d4,d5,d6,d7,d8)will satisfy(4)q1d1+q2d2+q3d3+q5d5+q6d6+q7d7+q8d8≤B,d1,d2,d3,d5,d6,d7≥0,d1,d2,d3,d5,d6,d7integer,d3≤d¯3,d4,d8∈{0,1},whered¯3is the maximum number of access doors that may be replaced in the station.Pickpocket gangs are organized groups, taking advantage of crowded situations. Typically, a pickpocket perpetrates the theft, while his colleagues cover him and try to run away with the loot. The event flow for a pickpocket attempt is: (a) Some pickpockets will succeed in committing their theft; (b) Out of them, some will not be caught, getting the loot; (c) Otherwise, they will be caught red-handed, losing the loot and being fined. Should they try to evade the fine, they could be imprisoned, but this rarely happens, since it is better for pickpockets to pay off the fine immediately and return to “business as usual”. The gang will attempt to commit t thefts over the relevant planning period. t will be their decision variable.In the pickpocketing problem, the operator: (a) Investsdp=(d5,d6,d7,d8); (b) Faces the corresponding delinquency level; (c) Possibly observes a reduction in business; (d) Obtains her utility, which will depend on the change in business level and its operational costs.The security investment costs for the operator against pickpocketing are(5)cinv(2)(d5,d6,d7,d8)=q5d5+q6d6+q7d7+q8d8.As for the business level b, the operator considers that it will not change much, unless there is a large number of thefts. We use an average logistic response to model this, see Fig. 5:(6)E[b|t]=b0−br1+exp[γb(t−t0.5)]+br,t>0.Here, b0 is the ideal business level, free of the pickpocketing threat (for t0 ≪ t0.5, E[b|t0] does not differ much from b0); bcis the business level given the current theft level tc; and bris the business level for a large number of thefts: as pickpocketing surpasses a threshold, the business level will tend to attenuate its reduction stabilizing around br. t0.5 designates the number of thefts for which the total expected business level reductionb0−brwould be halved. γbreflects how business level would drop as the number of thefts increases. We assume a normal distribution for pD(b|t), centered at E[b|t], with standard deviation σbaccounting for the uncertainty over b|t. Depending on the scale, we might need to truncate pD(b|t) at 0. The total balance for the operator will becD(2)(d5,d6,d7,d8,b)=−cinv(2)(d5,d6,d7,d8)−(b0−b).The problem faced by pickpockets is depicted in Fig. 6.Their event flow involves the following steps, where we provide, when pertinent, the operator’s assessments pD(·) about the involved quantities together with her assessmentsPA2(·)about the corresponding pickpocket’s random distributions, following the suggestion at the end of Section 2, concerning Dirichlet distributions and processes.(a)They see the operator’s security investmentsdp=(d5,d6,d7,d8).They decide the numbert∈A2of theft attempts they will undertake, beingA2the set of plausible values.They implement the actual number of theft operations,t′=(1−τ)t: due to the measures deployed by the operator, some operations may need to be aborted. We use a modelt′=(1−τ(d5,d6,d7))t,where τ(d5, d6, d7) is the proportion of aborted thefts with respect to the original plan, which depends on d5, d6, d7. A typical assumption for τ would be a beta distributionpD(τ(d5,d6,d7))∼Be(ατ(d5,d6,d7),βτ(d5,d6,d7)),with τ close to zero if we feel that pickpockets are very committed to their plan, thus with ατ≪ βτ. Then, we modelPA2(τ(d5,d6,d7))as a Dirichlet process with base distribution pD(τ(d5, d6, d7)) and concentration parameter δτ. The random distributionPA2(τ(d5,d6,d7))=PA2(τ|d5,d6,d7)inducesPA2(t′|t,d5,d6,d7).The implementation costs of their actions are qpt, where qpis the preparation cost per operation.They face their operational costs per each effectively attempted operation:1.With probability(1−ξ),they will not succeed in the theft attempt. The only consequences are the preparation costs. The proportion ξ of successful operations depends on the pickpockets’ ability. However, the presence of patrols and/or guards, and the influence of awareness campaigns will reduce such value. We model the operator’s beliefs about ξ through a beta distributionpD(ξ(d5,d6,d8))∼Be(αξ(d5,d6,d8),βξ(d5,d6,d8))with standard deviation σξand meanE[ξ|d5,d6,d8]=ξ0·exp(−μ5d5−μ6d6−μ8d8)+ξr.Here, μ5, μ6 and μ8 account for the fact that each additional unit of (d5, d6, d8) is expected to reduce the proportion of successful operations.(ξ0+ξr)represents the current success proportion, if no additional countermeasures are deployed, and ξrthe residual proportion that would persist, even if infinite resources (d5, d6, d8) were deployed. Again, we use a Dirichlet process forPA2(ξ(d5,d6,d8))∼DP(pD(ξ(d5,d6,d8)),δξ).With probability ξθ, they succeed in their theft attempts but are detained afterwards, facing the possibility of being fined with average fine fp. The detention proportion θ depends on the number of patrols and guards. However, such dependence will not be linear: the operator believes that the additional contribution of each new patrol or guard will be smaller. To acknowledge the operator’s uncertainty about θ, we use a beta distributionpD(θ(d5,d6))∼Be(αθ(d5,d6),βθ(d5,d6))with standard deviation σθand meanE[θ|d5,d6]=1−exp(−ρ5d5−ρ6d6),where (ρ5, ρ6) account for the fact that each additional unit (d5, d6) is expected to increase the detention proportion. Then,PA2(θ(d5,d6))∼DP(pD(θ(d5,d6)),δθ).With probabilityξ(1−θ),they succeed and avoid getting caught. They get the theft benefit ℓ, which is uniformly distributedℓ∼U(ℓa,ℓb).The pickpockets face an expected cost/benefit balancecA2(t1,t2,t3)=−qpt−fpt2+ℓt3,where (t1, t2, t3) come from a multinomial distributionM(t′;1−(1−τ)ξ,(1−τ)ξθ,(1−τ)ξ(1−θ)).When necessary, we shall usept1t2t3dp=Pr(titheftattemptswithoutcomei,i=1,2,3|dpisinvested),whereoutcome={1,2,3}corresponds to the pickpocket cases described in (e). The random distributionsPA2(ξ(d5,d6,d8))=PA2(ξ|d5,d6,d8)andPA2(θ(d5,d6))=PA2(θ|d5,d6)induce the random distributionPA2(cA2|t,dp).The pickpockets get their utility, which depends on the loot and costs entailed in implementing their decision. We assume that pickpockets are constant risk prone in benefits, see (Dyer & Sarin, 1982). Therefore, their utility function is strategically equivalent touA2(cA2)=exp(kA2·cA2),kA2>0.A random utility model for the pickpockets could beUA2(cA2)=exp(kA2·cA2),kA2∼U(0,KA2).The fare evasion problem is described in detail by Ríos Insua et al. (2015b). We provide a brief summary of the uncertainty models involved, emphasizing the issue that the number of customers depends on the theft level, reflecting the cascading effect mentioned above.In relation with standard fare evasion, we distinguish three types of customers: (1) Civic, who pay the ticket; (2) Standard evaders who do not pay the ticket but are not caught, therefore producing a loss of vc, the cost of the ticket; and (3) Standard evaders who are caught without a ticket, producing an expected income fcdue to fines. Denote by N1, N2 and N3 the number of customers of each type, withN=N1+N2+N3the total number of customers. LetpNidcbe the probability that there are Nicustomers of typei,i=1,2,3when the security plandc=(d1,d2,d3,d4,d5)is implemented.With respect to colluders, we view them as a “club” which entails M operations over the incumbent planning period. Their event flow is: (1) Some colluders eventually change their mind deciding to pay when using the facility; (2) The rest decide not to pay; (3) Some of these will be inspected and fined. This will partly mitigate the operator losses associated with fare evasion. Colluders benefit from evading the ticket fare, but they face the possibility of being fined, in addition to having some preparation costs. Denote by (M1, M2, M3) the number of aborted, successful, and failed operations, respectively, which we assume come from a multinomial distribution. LetpM1M2M3dcbe the probabilities that there are Micolluders of typei,i=1,2,3when dcis invested.The benefit/cost balance for the operator, due to fare evasion, is(7)cD(1)(N1,N2,N3,M1,M2,M3,dc)=−vc(N2+M2)+fc(N3+M3)−∑k=15qkdk.In Section 3.1.1, we sketched how to solve the pickpocketing problem from the point of view of the attacker. We obtained an estimate of pD(t|dp). By Ríos Insua et al. (2015b), we show how to obtain pD(r|dc), which models the operator beliefs over the proportion r of fare evasion attempted by colluders, when the security investment was dc. Note that we need to adapt the methodology described there to incorporate the inherent cascading effect, as the number of customers will be affected by the presence of pickpockets through the business level. We explain this in Section 3.1.4.We aggregate now all benefits and costs for the operator, using (5) and (7). This includes the investment in countermeasures, the fraud/fine balance associated with fare evasion, and the reduction in business level due to pickpocketing:cD(N1,N2,N3,M1,M2,M3,d,b)=−vc(N2+M2)+fc(N3+M3)−∑k=18qkdk−(b0−b).The operator is constant risk averse to an increase in income, see (Dyer & Sarin, 1982). Therefore, her utility function uDwill be strategically equivalent touD(cD)=−exp(−kD·cD),with kD> 0.We may now evaluate a security portfolio d by computing its expected utility:(8)ψD(d)=∫{∫∫[∑N1,N2,N3M1,M2,M3pM1M2M3dc·pN1dcpN2dcpN3dc·uD(cD)]×pD(t|dp)pD(b|t)dtdb}×pD(r|dc)dr.We would then maximize ψD(d), subject to (4), to find the optimal security plan.We illustrate the model considering a specific railway station, with features representative of many others in the operator network, with a single street level entrance, and a moderate daily flow of customers. We choose one year as the relevant planning period, since the security budget is planned annually. The available annual security budget for new countermeasures at this station is $100,000, to be shared against both threats.Table 2 displays the maximum additional investments over the planning period that the operator contemplates for each countermeasure, as well as their associated unit costs.For human resources, we have provided unit annual gross salaries. The operator would have to hire four full-time (35 hours/week) workers of each category to fully cover service, since the station operates approximately 140 hours weekly. We also include the overall cost of installing a secured automatic access door over a whole year, including maintenance and repair, taking into account the typical door lifetime and, similarly, for costs associated with cameras. There are 324 feasible portfolios. As for the redefinition of clerk duties, the operator estimates that the negotiation with unions over a whole year could cost, in terms of labor troubles, approximately, $15,000 (per station).We discuss now the assessment of the relevant parameters for the pickpocketing threat. With respect to theft level, the operator estimates that, approximately, only one out of every nine thefts is actually reported, and acknowledges, on average, three reported thefts per day across the network. This is roughly equivalent to 10,000 thefts throughout a year. The network has over 100 stations, of which the incumbent station cannot be regarded as a hotspot. Then, the operator estimates that the current annual number of thefts at such station would be around one half of the average value per station. Thus, she chooses a binomial distribution for the current theft leveltc∼Bin(100,0.5)(expected value 50, standard deviation 5).We estimate the reduction in business level due to the presence of pickpockets through the number of annual sold tickets, which has been around 1,000,000 over the last five years. As there are different transportation passes, the effective fare ticket is estimated atvp=$0.75. Then, we setbc=$750,000. The operator believes that the ideal business level, without pickpockets, would be aroundb0=$760,000. In addition, she thinks that business level would never drop below 80% of its current value, i.e.br=$600,000, even for an excessively large number of thefts. She would expect one half of such reduction if the number of thefts doubles, i.e.t0.5=100,see Fig. 5. She does not think that deterioration in business will happen drastically and she assessesγb=0.08. Therefore, it seems reasonable to uset∈{0,1,…,150}=A2as possible values for the pickpockets’ decision variable. Finally, the operator does not have great uncertainty about the expected value of E[b|t], choosingσb=$8,000.We have estimated the costs and consequences for pickpockets based on expert judgment:•Preparation costs are estimated at $7 per attempted operation. This accounts for the ticket fare plus some expenses for daily food, drink and clothes.The fine in case of being caught red-handed depends, to some extent, on the amount robbed. For simplicity, we assume an average finefp=$600 for the whole gang.According to the data collected by the operator from theft complaints, the loot obtained by the whole gang varies uniformly betweenℓa=$150 andℓb=$375. For this, we have used a flat improper prior distribution (π(ℓb′)=1forℓb′=ℓb−ℓa>0,see (Rossman, Short, & Parks, 1998).The estimation of the proportion ξ of successful operations is an involved issue, given that little data is available. We have assessed the current proportionξ0+ξrthrough a betaBe(3,1)distribution. The operator aims at reducing this proportion to a target value ofξr=0.05. We assessed (μ5, μ6, μ8) through expert elicitation. As an illustration, assume that the d5 guards were the only countermeasure available. Our experts considered that having one guard would reduce the success proportion from 0.75 to approximately 0.55. Consequently, we assessedμ5=0.35. We checked for robustness of the assessment, asking the experts about the expected reduction in success proportion if more than one guard were hired, obtaining consistent results. We repeated the same reasoning when varying the number of patrols, obtainingμ6=0.55. The estimation of μ8 was accomplished using the only possible values,d8={0,1},leading toμ8=0.25. The operator expressed little uncertainty about her assessment of the Attacker’s distribution. Thus, we assessedδξ=0.05.Mimicking the argument, we estimatedρ5=0.15andρ6=0.4for the detention proportion θ, with concentration parameterδθ=0.08.Finally, we assessed the risk coefficient kDin the operator’s utility function. We used the probability equivalent (PE) method, see (Farquhar, 1984), to assess a few values for the utility function and, then, fit an appropriate curve through least squares, obtaining a good fit forkD=5·10−6. With respect to pickpockets, based also on the PE method, and taking into account the Defender’s uncertainty about the pickpockets’ behavior, we assessed the maximum risk coefficient in the pickpockets’ utility function,KA2=10−5.The assessment of the parameters in relation with the fare evasion threat is based on the discussion by Ríos Insua et al. (2015b), although, as mentioned, here we have to incorporate the cascading effect arising from pickpocketing. We briefly outline the results for those parameters needed to solve the bi-threat problem. The average number N of customers will depend on the number t of thefts through the average business level b as expressed in (6). We modeled N as a Poisson distribution,N∼Pois(λ),withλ=b/0.75,inheriting the uncertainty in b. In addition, (N1, N2, N3) will follow (conditionally independent given dc) Poisson distributions with parametersλ1=λ(1−ϕ(dc)),λ2=λϕ(dc)(1−q(d1))andλ3=λϕ(dc)q(d1),respectively, being ϕ(dc) the proportion of fraudsters and q(d1) that of customers inspected, see (Ríos Insua et al., 2015b) for details. For the number of colluder operations M, we use a Poisson-gamma model, with diffuse, but proper, prior for the Poisson parameter μ, see (French & Ríos Insua, 2000). We obtained that, a posteriori,μ|data∼G(150000.1,5.1),which shall be estimated, when necessary, through its posterior expectation E(μ|data) ≈ 30000.For the proportion of fraudsters we assume a modelϕ(dc)=ϕ0·exp(−∑k=15γkdk)+ϕr. We use a beta-binomial model for the current fraud proportion,(ϕ0+ϕr),with a noninformative prior, see (French & Ríos Insua, 2000). Based on information provided by the operator, we get the posteriorBe(3·104+1,106+1),with expected value 0.03 and negligible variance. The reduced target fare evasion proportion is 0.01. The γk’s were assessed through expert elicitation, much the same as we did for the μj’s, obtainingγ1=0.13,γ2=0.72,γ3=0.45,γ4=0.23andγ5=0.84. Other relevant parameters are the fare ticket (for the fare evasion threat, we consider the single-ride fare,vc=$2) and the average fine in case someone is caught without a valid ticket ($100). However, according to the metro operator, approximately only one sixth of the imposed fines are actually paid off, giving an effective average fine per caught evader of, roughly, $17. We shall use this value for fcin our computations.We discuss the case solution. We have simulated 10,000 years of operations for each portfolio d, to identify the optimal one. Fig. 7shows the estimated expected utility of the 324 feasible portfolios.From left to right, the portfolio numbering begins with portfolio #1,d=(0,0,0,0,0,0,0,0); portfolio #2,d=(0,0,0,0,0,0,0,1); and so on, increasing sequentially the values ind8,d7,…,d2and d1, being the last feasible portfolio #324,d=(2,0,0,1,0,0,0,0). The optimal portfolio isd*=(1,0,0,0,0,1,0,0),#276, corresponding to hiring one inspector and one patrol. Its estimated expected utility is−2.03,associated investment $85,000, and global expected decrease in income for the operator $171,585 (due to the investment, plus the expected balance between the fraud and the collected fines, which is−$42,980, and the expected reduction in business level, which amounts to $43,605). The next two portfolios with highest expected utilities ared**=(1,0,0,0,0,1,1,0),corresponding to one inspector, one patrol and one camera, with associated investment of $89,500 and expected losses of $177,492; andd***=(1,0,0,1,0,1,0,0),corresponding to one inspector and one patrol, and the involvement of clerks in observation tasks, with associated investment of $85,000, and expected losses of $185,656. As we can observe, when the operator faces multiple threats with similar impact, she has to distribute her available resources to fight against all threats. The optimal portfolio includes countermeasures specific to each threat: inspectors and patrols. Note that although patrols are more expensive than guards, they are preferable because of their higher deterrent effect.The left column of Table 3 shows similar results for other relevant portfolios. We have included (when feasible) those portfolios for which the investment is maximum in one of the countermeasures, with no investment in the other ones. We have also considered those portfolios with highest investments. As we can observe, these are not necessarily the most effective ones in terms of operator’s expected utility. For instance, the portfolio in the last row exhausts the available budget, and incurs in additional costs associated with the change in clerk duties. However, its expected utility is worse (−6.86) than that of the optimal portfolio (−2.03).Due to the complexity of the model and that many parameters are assessed judgmentally, we need to perform sensitivity analysis. We assess here possible sensitivity to variations in the fare evasion proportion. Note first that the proportion estimated above (ϕ0+ϕr=0.03) is not constant but, rather, depends on the specific day and time considered, varying between 0.005 and 0.12, according to the operator. We are interested in evaluating the impact of higher proportions on the operator’s costs. For this, we repeat the previous calculations for proportions 0.06 and 0.12, shown in the central and right columns of Table 3, respectively. As we can observe, under higher fare evasion proportions, the operator needs to make bigger investments. The optimal portfolio in both cases is (2, 0, 0, 0, 0, 0, 0, 0), corresponding to hiring two inspectors, with associated investment of $100,000 and expected losses of $190,207 and $137,218, respectively. The second best portfolio is (1, 0, 0, 0, 0, 1, 0, 0) whenϕ0+ϕr=0.06; and (2, 0, 0, 1, 0, 0, 0, 0) when the proportion is 0.12: just the optimal portfolio plus the expenses associated with the change in clerk duties. Under these settings, hiring as many inspectors as possible becomes crucial, as they have authority for imposing fines.These results suggest that when the relative impact of one of the threats dominates, the operator might need to reallocate resources to better fight against it, possibly unprotecting herself from the other threats. However, we found model performance sensitive to several other factors, especially to variations on the proportion of tickets inspected by each new inspector. Thus, it is essential that inspectors indeed carry out their task, so as to ensure an effective fight against fare evasion.We consider now the multisite case. An organization needs to protect from m threats over n sites. The threats are uncoordinated and the sites are not spatially related. The strategy we apply is to deploy one of the models in Section 2 over each site. Resource constraints for the Defender and for each of the attackers coordinate the models. The Defender and each of the attackers aggregate values attained at nodes, applying their utility function.The Defender deploys defensive resources djover sitej,j=1,…,n. These must fulfill certain constraints which we represent throughg(d)∈D,whered=(d1,…,dn). This might include, among others, financial constraints concerning a maximum budget; logistic constraints, like the impossibility of deploying certain resources separately (e.g. a sniffer dog has to be always accompanied by trained personnel), or the requirement of having some critical infrastructure protected 24/7; or political constraints, like the need of having each site minimally protected. The ith attacker will perform attack aijover the jth site. In turn, each attacker’s strategy should satisfy certain constraintshi(ai)∈Ai,whereai=(ai1,…,ain),i=1,…,m. This might also account for financial constraints, like a limited budget to buy sophisticated weapons or instruct hackers; or human resource constraints, like the need of having, ideally, a minimum number of attackers over each site, among others. The interaction between the Defender and the ith attacker over site j will yield a random result Sij.The Defender aggregates her results throughuD(d,s1,…,sm),wheres1=(s11,…,s1n),…,sm=(sm1,…,smn). She needs to find her optimal defense strategy,d*, subject to the corresponding constraints. Under appropriate conditional independence assumptions over attack results, she needs to build the conditional models pD(sij|dj, aij),i=1,…,m,j=1,…,n,expressing her uncertainty about the outcome sijof the attack aijlaunched by attacker Aiover site j when she has deployed defensive resources dj. By integrating out such uncertainty, she will get her expected utility:ψD(d|a1,…,am)=∫…∫uD(d,s1,…,sm)pD(s11|d1,a11)⋯pD(smn|dn,amn)ds1…dsm.Suppose the Defender is able to build the models pD(aij|dj),i=1,…,m,j=1,…,n,reflecting her beliefs about which attack will be chosen by attacker Aiagainst site j, when protected by defensive resources dj. Then, she will be able to computeψD(d)=∫…∫ψD(d|a11,…,amn)pD(a11|d1)⋯pD(amn|dn)×da11…damn,and solve max  ψD(d) subject tog(d)∈D.The assessments pD(aij|dj),i=1,…,m,j=1,…,nare nonstandard. Following the strategy in Section 2, we can solve separately the problem for attacker Ai, who attacks sites 1 to n, subject to constraintshi(ai)∈Ai,i=1,…,m. As an example, in order to solve the problem faced by attacker A1, the Defender would need his utilityuA1(a1,s1)and probabilitiespA1(s1j|dj,a1j),j=1,…,n. Then, she would solve the optimization problema1*(d)=argmaxh1(a1)∈A1∫…∫uA1(a1,s1)pA1(s11|d1,a11)⋯×pA1(s1n|dn,a1n)ds11…ds1n.However, the Defender does not knowuA1and thepA1’s. To model her uncertainty about them, she uses random utilities and probabilities(UA1,PA1(s11|·),…,PA1(s1n|·))and, then, propagates the uncertainty to obtain the m-dimensional random optimal actionA1*(d)=argmaxh1(a1)∈A1∫…∫UA1(a1,s1)PA1(s11|d1,a11)⋯×PA1(s1n|dn,a1n)ds11…ds1n.Then, she would getpD(A1≤a1|d)=Pr(A1*(d)≤a1). For an estimate of pD(a1|d), we could proceed through a sampling scheme similar to that in Algorithm 1. The problems faced by the other attackersA2…,Amwill be solved in the same way, providing estimatespD^(ai|d),i=2,…,mof the required probabilities. Extensions similar to those provided in Section 2 could be given here.We extend the case in Section 3 to several stations. The railway system analyzed in our case study comprises more than 100 stations. To better illustrate ideas, we consider a small representative group ofn=4stations. As described before, we build a model like that in Section 3 for each station. Thus, for station j ∈ {1, 2, 3, 4}, we deploy resources dj≡ (dj1, dj2, dj3, dj5, dj6, dj7), with meanings as in Section 3.1. The decision d4 on whether or not to change the clerk duties is made for the whole network; the associated costs will be proportional to the number of stations. The investment in an awareness plan is also common for the entire network, and will be denoted d8 ∈ {0, 1}, with the same meaning as in Section 3.1. If the operator has a global budget B for investing in new countermeasures, the resources will have to fulfill the constraints∑j=14(∑k=1k≠47qkdjk)+q8d8≤B,0≤∑j=14djk≤d¯k,k=1,…,7,k≠4,djkinteger,j=1,…,4,k=1,…,7,k≠4,dj3≤d¯j3,j=1,…,4,d4,d8∈{0,1}.Here,d¯j3is the maximum number of secured automatic access doors that may be replaced at site j, and thed¯k’s, the overall maximum allowable number for each resource. Finally, note that some additional constraints could possibly apply for certain sites.We provide specific constraints and parameters for the example. Stations 1–3 have an average annual flow of customers of 1,000,000, whereas Station 4 has 5,000,000 under current operational conditions. The security additional budget is $200,000 for the network, on top of the current one. There is an additional requirement that the investment at each station has to lie between $30,000 and $70,000, except for Station 4, in which the minimum investment has to be $50,000. Besides, for image reasons, the investment in the whole network has to be, at least, $120,000. Resource upper bounds ared¯k=4,k=1,2,3,5,6,andd¯7=8. Moreover, the operator indicates that, at most, two units of each countermeasure should be deployed at a single station.As the impact of both threats over the four incumbent stations regards:•Stations 1 and 2. There are moderate levels of fare evasion,ϕ0+ϕr=0.03,M=30000; and pickpocketing: we assume a range{0,1,…,100}for t.Station 3. There is a high level of fare evasion,ϕ0+ϕr=0.12,M=120000and a moderate level of pickpocketing. This is representative of stations not so well protected against fare evasion. It is required to hire, at least, one inspector.Station 4. There is a moderate level of fare evasion and a high pickpocketing level: we assume a range of valuest∈{0,1,…,150}. This is representative of pickpocketing hotspots, typically busy stations close to main transport hubs. In this station, the presence of, at least, a patrol is required.For simplicity, we consider just one group of pickpockets operating at each station, although they frequently belong to the same gang and move between stations. We assume that countermeasures and attackers are static, in that they are not allowed to move between stations. This may sound unrealistic, but we have to keep in mind that we are planning security in annual terms. Operational decisions, like patrolling routes, may be decided at a later stage, see our final discussion.There are 26 decision variables and 16 constraints. The number of security portfolios is too large to implement the enumeration strategy in Section 3. Alternatively, we use a genetic algorithm, see (Goldberg, 1989), with fitness function given by the operator’s expected utility, which generalizes (8) by including contributions from the four stations. In our computations, we have used the built-in ga function with default options, implemented in MATLAB R2013b (The MathWorks, 2013). Specifically, the algorithm stopped when the weighted average relative change in the best fitness function value over 50 generations was less than or equal to10−6. After 10,000 replications, we obtained the optimal portfolio, shown in Table 4, together with relevant information about investments at each station, expected money collected through fines, and expected losses due to fare evasion and pickpocketing.As we can observe, investing in door guards, cameras and the awareness plan seems not worthwhile for the operator, given the constraints. She should involve ticket clerks in observation tasks, with an impact on costs. Investments at Stations 1 and 2 coincide, as expected, since both have similar features: the operator invests $35,000 in one patrol. At Station 3, the main issue was fare evasion. Thus, in addition to the required inspector, the optimal portfolio suggests installing an automatic access door, with associated overall investment of $65,000. Finally, Station 4 was the busiest one, implying a potentially greater impact of fare evasion and, especially, pickpocketing. The presence of at least one patrol was mandatory. Additionally, two automatic access doors should be installed at this station, with a global investment of $65,000. Under this policy, the annual expected losses for the operator are $1,225,118, corresponding to $200,000 of investments (plus $60,000 of negotiation costs with the unions concerning clerk duties), $682,482 in the fraud/fine balance, and $282,636 of business lost due to pickpocketing. This might seem a large amount, but keep in mind that, should the operator not invest in new countermeasures, the expected loss would be around $2.5 m: thanks to the deployed portfolio, the operator is able to halve expected losses. Other portfolios entail minor changes with respect to the optimal portfolio and have similar expected utility. For instance, the second best portfolio, with annual expected losses of $1,229,250 for the operator, simply changes the decision on where to install an automatic access door: from Station 3 to either Station 1 or 2.Computations took around seven hours on a standard laptop running Windows. Table 5summarizes computing times for several stations and replicationsAs we can observe, times are linear in the number of replications but nonlinear in the number of stations. Indeed, for the whole network, with more than 100 stations, the computation takes over one week with 10,000 replications. Even though computations could be improved with faster parallel machines, recall that this is a tactical decision made yearly, making such computing times actually acceptable.Beyond the computational burden induced by a large number of sites, note that there might be considerable elicitation burden. In our case study, we have assumed the same responses at various stations, thus with the same parameters. But it could be the case that different stations have different responses. One way to mitigate such elicitation burden would be to somehow cluster sites with similar features and perform the elicitation for just one of the stations in the cluster.

@&#CONCLUSIONS@&#
