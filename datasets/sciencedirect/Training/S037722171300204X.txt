@&#MAIN-TITLE@&#
A decomposition approach for the integrated vehicle-crew-roster problem with days-off pattern

@&#HIGHLIGHTS@&#
The objective of this paper is the research on optimization methodologies for a complete integration of vehicle scheduling, crew scheduling and driver rostering problems so as to develop efficient algorithms.We have modeled the integrated vehicle-crew-roster problem as a new integer linear programming problem.We have developed a heuristic approach based on Benders decomposition to solve the problem.Computational experience was performed using data from two bus companies in Portugal as well as random data available in the literature.Computational results show that the presented approach outperforms the traditional sequential approach regarding the reduction of operational costs and driver rosters balance.

@&#KEYPHRASES@&#
Transportation,Vehicle and crew scheduling,Driver rostering,Benders decomposition,

@&#ABSTRACT@&#
The integrated vehicle-crew-roster problem with days-off pattern aims to simultaneously determine minimum cost vehicle and daily crew schedules that cover all timetabled trips and a minimum cost roster covering all daily crew duties according to a pre-defined days-off pattern. This problem is formulated as a new integer linear programming model and is solved by a heuristic approach based on Benders decomposition that iterates between the solution of an integrated vehicle-crew scheduling problem and the solution of a rostering problem. Computational experience with data from two bus companies in Portugal and data from benchmark vehicle scheduling instances shows the ability of the approach for producing a variety of solutions within reasonable computing times as well as the advantages of integrating the three problems.

@&#INTRODUCTION@&#
Operational planning is an important phase in the planning of activities within public transit companies. At this stage, scheduling for both the vehicles and the drivers is defined so that transport demand in a specific area is satisfied. Due to the great complexity of these problems, most transit companies use computer-aided systems for tackling them on a sequential basis. Firstly, the vehicle scheduling problem is solved, secondly the crew scheduling and, lastly, the driver rostering.The vehicle scheduling problem takes as input a set of timetabled trips and produces the vehicle schedules that cover all timetabled trips (or trips for short). A vehicle schedule is the sequence of trips to be assigned to a vehicle on a day. The crew scheduling problem defines the daily crew duties that cover the vehicle schedules. A crew duty is the sequence of tasks to be assigned to a single driver on a day. Finally, for a planning horizon of several days, crew duties are assigned to the drivers of the company leading to a roster that must comply with labor and institutional norms. A roster is the sequence of crew duties assigned to each driver throughout the planning horizon. The sequential approach takes the output of the current problem as the input of the next one. Consequently, one cannot guarantee that the final result is the best solution to the overall problem since there is a high dependency among these three problems. In order to overcome this drawback, it is important to develop integration methodologies. The integrated vehicle-crew-roster problem aims to simultaneously assign drivers of a company to vehicles and assign vehicles to a set of pre-defined timetabled trips that cover passenger transport demand in a specific area, during a planning horizon. Despite its computational burden, some work has been reported on the integration of all or some of these problems expecting to outperform the corresponding sequential approaches. [11,10,18,2,21] have developed efficient algorithms for the integrated vehicle-crew scheduling problem. Crew-rostering integration has been devised by [4,7,8] and [12] albeit within other transport contexts (railway and air crews) and by [5] for airport staff. Advantages of integrating these three problems were pointed out in [16] through a statistical study over different solutions resulting from a sequential approach, where rosters were produced, satisfying labor and internal company laws, without any pre-defined pattern for working or rest periods. In that work, some statistical tests revealed no correlation between the quality of integrated vehicle-crew solutions and the corresponding rostering solutions, hence highlighting the need to develop methodologies that address these three problems in an integrated form. Considering those conclusions and a preliminary study presented in [17], the current paper proposes a new heuristic approach with embedded column generation and branch-and-bound techniques within a Benders decomposition to solve the integrated vehicle-crew-roster problem with days-off pattern (VCRPat). The VCRPat solution consists of daily vehicle and crew schedules and a roster that complies with a days-off pattern in use at some Portuguese public transit companies for a specific group of drivers that share the same rest periods pattern but not necessarily the same type of work.Some special features of the VCRPat mathematical formulation are exploited leading to a decomposition algorithm that iterates between the solution of daily integrated vehicle-crew scheduling problems and the solution of a rostering problem. The resulting heuristic algorithm seems to be a promising alternative tool to the sequential approach.For airline operations, Benders decomposition methods have already been proposed by [6,14] for the integrated aircraft routing and crew scheduling problem and by [15] for the integrated aircraft routing, crew scheduling and flight re-timing problem. Also in the same application context, [20] presented a Benders decomposition approach to deal with the integrated fleet assignment, aircraft routing and crew scheduling problem.This paper is organized as follows: Section 2 introduces the VCRPat in detail, Section 3 presents a mathematical formulation, Section 4 gives a description of the decomposition approach, Section 5 shows computational results taken from sets of real and benchmark based instances and Section 6 presents some conclusions.During a planning horizon H of 7weeks, partitioned into 49days, drivers from a set M must be assigned to a fleet of vehicles from a set D of depots in order to perform a set of timetabled trips. The location and the number of vehicles available in each depot are known.Let Nhbe the set of trips to be performed on day h. For each trip, the starting and ending times and locations are known. Trips i and j are compatible if the same vehicle can perform both in sequence. Between compatible trips i and j and between trips and depots, a deadhead trip may occur, where the vehicle runs without passengers. There are three types of deadhead trips: those between the ending location of a trip and the starting location of a compatible trip, those from a depot to the starting location of a trip (pull-out) and those from an ending location of a trip to a depot (pull-in). Without loss of generality and in order to simplify the notation, depots will be seen as special trips. Let Ihbe the set of pairs of compatible trips (i,j) on day h. The sequence of timetabled trips and deadhead trips performed by a vehicle on day h∈H defines a vehicle schedule. Each vehicle schedule starts and ends at the same depot and is subdivided at points defined by time and location, called relief points, where a change of driver may occur. Two consecutive relief points define a task, that is, the smallest amount of work to be assigned to the same vehicle and crew. Depots as well as the ending location of timetabled trips are potential relief points. Hence, task (i,j) corresponds to the deadhead from trip i to trip j followed by trip j.A crew duty is a daily combination of tasks that respects labor law, union contracts and internal rules of the company. These rules depend on the particular situation under study and usually constrain the maximum and minimum spread (time elapsed between the beginning and ending of a crew duty), the maximum working time without a break, break duration. Drivers may switch between two vehicles if the relief points are close enough in time and walking distance. Let Lhbe the set of crew duties of day h andLijh⊆Lhthe set of crew duties covering task (i,j), on day h.Each crew duty has to be assigned to a driver who works according to a pre-defined days-off pattern. The specific pattern considered in this study is used in some Portuguese public transit companies for specific groups of drivers. For a time horizon of 7weeks (49days), Table 1displays such a pattern through a 0–1 matrix, where 0 stands for day-off and 1 for workday. Each row of the matrix corresponds to a weekday. Seven consecutive columns correspond to the 7weeks of the time horizon, being the last day in column i (i=1,…,6) followed by the first day in column i+1 and the last day in column 7 followed by the first day of column 1. Since a 49days schedule may begin in row 1 of any column, this days-off pattern leads to a schedule set S with seven schedules (Table 2). Each schedule Si, i=1, …, 7 defines a sequence of working and rest periods, containing 1week with 1day-off, 5weeks with two consecutive days-off and 1week with three consecutive days-off. Every period of three consecutive days-off includes Saturday and Sunday and if it also includes a Friday then it will be followed by five consecutive workdays.The pattern in Table 1 is cyclic only in what concerns the days-off. Hence any number of drivers may be assigned to each schedule, getting each driver the same number of days off and the same type of rest periods, at the end of the 49days. A roster is an assignment of drivers to schedules of S covering all the crew duties defined for the planning horizon, where each driver is assigned to at most one schedule and each crew duty is covered by exactly one driver. The cyclic days-off pattern satisfies some compulsory constraints: the minimum number of days-off per week (1day), the minimum number of consecutive days-off (2days), the minimum number of Sundays/weekends off in the planning period (2days) and the maximum number of consecutive workdays (6days). Besides these constraints, drivers must rest a minimum number of hours between two consecutive crew duties and, consequently, a crew duty starting in the morning cannot be assigned to a driver that had worked on a crew duty starting in the evening of the previous day. Moreover, for a roster to be well accepted in the company it should attain balanced workload, meaning that different spread duty types should be equitably distributed among drivers, thus leading to a fair distribution of overtime and also of total working time.The VCRPat aims at simultaneously determining a minimum cost set of vehicle schedules that daily covers all timetabled trips, a minimum cost set of crew duties that daily covers all vehicle schedules and a minimum cost balanced roster for the planning horizon.Decision variables, related to the scheduling of vehicles, are defined aszijdh=1if a vehicle from depot d performs trips i and j in sequence on day h, or 0 otherwise. In particular,zdjdhandziddhrepresent, respectively, the pull-out from depot d to trip j and the pull-in from i to depot d. A vehicle costcijd, related with fuel consumption and/or vehicle maintenance, is associated with the deadhead trip from i to j. Daily vehicle schedules must be covered by crew duties.Decision variableswℓhare defined for feasible crew duties, therefore the rules defining the feasibility of the crew duties are handled in the model through Lh. Letwℓh=1if crew duty ℓis selected on day h, or 0 otherwise. A cost eℓ is assigned to each crew duty ℓ. Cost eℓ usually includes a fixed cost (for example, a driver’s salary) and operational costs related to overtime, evening periods and others.In the rostering process, each crew duty in the solution is assigned to a driver who works according to one of the seven pre-defined days-off schedules. Letxsm=1if driver m is assigned to schedule s, or 0 otherwise, and letyℓmh=1if driver m performs crew duty ℓ on day h, or 0 otherwise.Management often wishes to know the minimum workforce required to operate the fleet of vehicles, so as to transfer drivers to other departments of the company or to replace those absent. Such policy results in minimizing crew duty costs eℓ associated with variableswℓhand costs rmassociated withxsm. To avoid infeasible sequences of crew duties in a roster, for each day h, the set of crew duties, Lh, is partitioned into early duties,LEh, starting before 3:30p.m. and late duties,LAh, starting after 3:30p.m. Moreover, according to the spread, set Lhis also partitioned, into short duties,LTh, which have a maximum spread of 5h (without a break), normal duties,LNh, with spread ∈]5,9]hours, and long duties,LOh, with spread ∈]9,10.75]hours (with overtime). Rosters should attain balanced workload among drivers which can be measured by the number of crew duties of each spread type assigned to the same driver. For this purpose, variables ηTand ηOthat represent, respectively, the maximum number of short and long duties assigned to a driver during H are associated with penalties λTand λO.The VCRPat can be formulated through the following integer linear programming model:(1)min∑h∈H∑d∈D∑(i,j)∈Ihcijdzijdh+∑ℓ∈Lheℓwℓh+∑m∈M∑s∈Srmxsm+λTηT+λOηO(2)∑d∈D∑i:(i,j)∈Ihzijdh=1,j∈Nh-D,h∈H(3)∑i:(i,j)∈Ihzijdh-∑i:(j,i)∈Ihzjidh=0,j∈Nh,d∈D,h∈H(4)∑i∈Nhzdidh⩽νd,d∈D,h∈H(5)∑ℓ∈Lijhwℓh-∑d∈Dzijdh⩾0,(i,j)∈Ih,h∈H(6)∑m∈Myℓmh-wℓh=0,ℓ∈Lh,h∈H(7)∑s∈Sxsm⩽1,m∈M(8)∑ℓ∈Lhyℓmh-∑s∈Sashxsm⩽0,m∈M,h∈H(9)∑ℓ∈Lfhyℓmh+∑ℓ∈Lg(h-1)yℓm(h-1)⩽1,m∈M,h∈H-{1},f≠g∈{E,A}(10)∑h∈H∑ℓ∈Lthyℓmh-ηt⩽0,m∈M,t∈{T,O}(11)zijdh∈{0,1},(i,j)∈Ih,d∈D,h∈H(12)wℓh∈{0,1},ℓ∈Lh,h∈H(13)yℓmh∈{0,1},ℓ∈Lh,m∈M,h∈H(14)xsm∈{0,1},s∈S,m∈M(15)ηT,ηO⩾0andinteger.The objective function, a linear combination of all objectives, measures the quality of the solution in terms of vehicle and driver costs, as well as roster balancing. Constraints (2) and (3) describe the vehicle scheduling problem. Constraints (2) state that each timetabled trip is performed, exactly once, by a vehicle that comes directly from a depot or from the ending location of another timetabled trip. Constraints (2) together with (3) ensure that each vehicle returns to its source depot. Constraints (4) are depot capacity constraints, where νdis the number of vehicles available at depot d. Constraints (5) link vehicle and crew duty variables ensuring that each task in a vehicle schedule is covered by, at least, one crew duty. Equalities (6) impose that each crew duty, in a solution, must be assigned to one driver. Constraints (7) state that each driver is assigned to one of the seven days-off schedules or is available for other service in the company. Constraints (8), where parameterash=1if h is a workday on schedule s, impose coherence between the assignment of a crew duty and the schedule assigned to each driver.Inequalities (9) forbid the sequence late-early duties to ensure that drivers rest a given minimum number of hours between consecutive duties. Furthermore, (9) impose a day-off period between changes of duty types which also forbid the sequence early-late. Inequalities (10) calculate the maximum number of short/long duties assigned to a driver. Constraints (10) along with the two last terms of the objective function ensure the integrality of variables ηTand ηO.The days-off schedules defined by the matrix[ash]already satisfy some of the obligatory rostering constraints. Note that, without this matrix additional rostering constraints are needed to model the rosters as may be seen in [16], where the authors presented a mathematical formulation for the integrated vehicle-crew-roster problem without any underlying pattern.A decomposition approach is suggested by the three combinatorial structures included in the above mathematical formulation, (1)–(15): an integer multi-commodity network flow problem related with the daily scheduling of vehicles; a set covering structure defining the set of crew duties that daily cover the vehicle schedules; a mixed covering-assignment problem with additional constraints that defines the roster covering all (daily) crew duties for the planning horizon H.Taking into account the underlying structures of the problem, our option favors a primal decomposition that may easily give feasible primal solutions for the overall problem. Therefore, we propose a Benders based approach which mimics the way schedulers handle the feedback information between the three problems. The goal is to rely on Benders cuts to guide the procedure towards better overall solutions.In 1962, Benders proposed a decomposition algorithm for solving large single objective mixed integer linear programming problems [1]. The algorithm alternates between a primal subproblem and a master problem. The subproblem is a restriction of the original problem, where some decision variables values are fixed. In each iteration, the solution of the dual subproblem is used to construct Benders cuts. These cuts are added to the master problem and the resulting solution provides the values for the primal variables that are considered fixed in the subproblem. This method guarantees the convergence to the optimum under specific hypotheses later generalized by [9]. Such technique has been applied to different combinatorial optimization contexts (see [3]).The VCRPat may naturally be decomposed into a master problem and a subproblem. In fact, different temporal scheduling problems may be identified in the mathematical formulation for VCRPat: ∣H∣ daily integrated vehicle-crew scheduling problems, with variables z and w for the vehicle schedules and for the crew duties, respectively; and a rostering problem for the whole planning horizon, with variables y, x and η. These temporal scheduling problems share constraint set (6) involving variables w and y. We propose a new heuristic approach based on Benders decomposition, that alternates between the solution of a master problem involving the z, w variables, a vehicle–crew scheduling problem for each day of H, and the solution of the corresponding subproblem involving the y, x, ηvariables, a rostering problem for H.The following sections describe the subproblem, the master problem and the decomposition algorithm for VCRPat, respectively.Fixing the values of variables z and w in VCRPat atz¯andw¯, given by the optimal solution of the master problem, one obtains the subproblem,SUBzw¯:(16)∑h∈H∑d∈D∑(i,j)∈Ihcijdz¯ijdh+∑ℓ∈Lheℓw¯ℓh+min∑m∈M∑s∈Srmxsm+λTηT+λOηO(17)∑m∈Myℓmh=w¯ℓh,ℓ∈Lh,h∈H(18)(7)–(10),(13)–(15).Note that,SUBzw¯is a rostering problem, where (z¯,w¯) induces the sets of vehicle schedules and of crew duties. Let us denote byLSUBzw¯the linear programming relaxation ofSUBzw¯, where (13)–(15) are replaced byyℓmh⩾0,xsm⩾0and ηT, ηO⩾0, respectively.The dual ofLSUBzw¯is denoted byDLSUBzw¯being α,β, γ, δ and ζ the dual variables corresponding, respectively to 17, (7)–(9) and (10) inLSUBzw¯.If the number of drivers is enough to cover all crew duties given byw¯, while respecting all the other constraints, thenLSUBzw¯has a feasible solution and thus an optimal solution (the feasible region is bounded along the optimization direction). In this case, a Benders cut is obtained from the optimal dual solution which corresponds to an extreme point of the feasible region ofDLSUBzw¯. If the available drivers are not enough to cover all the crew duties inw¯thenLSUBzw¯is infeasible andDLSUBzw¯is unbounded (there is always at least a feasible dual solution, the nil vector). In this case, the corresponding Benders cut is obtained from an extreme ray of the feasible region ofDLSUBzw¯. The new cut is added, as a constraint, to the master problem.Let PD and RD be, respectively, the set of extreme points and extreme rays, to be used in the current iteration of the decomposition algorithm. Suppose that PD has k1 extreme points and RD has k2 extreme rays. Then the master problem is MASTER:(19)minφ0(20)φ0⩾∑h∈H∑d∈D∑(i,j)∈Ihcijdzijdh+∑ℓ∈Lheℓ+α¯ℓpqhwℓh+τ¯q,q=1,…,k1(21)0⩾∑h∈H∑ℓ∈Lhα¯ℓrqhwℓh+ϱ¯q,q=1,…,k2(22)(2)–(5), (11), and (12)whereτ¯q=∑m∈Mβ¯pqm+∑h∈H-{1}∑m∈M∑f,g∈{E,A},f≠gδ¯pqmhfg,ϱ¯q=∑m∈Mβ¯rqm+∑h∈H-{1}∑m∈M∑f,g∈{E,A},f≠gδ¯rqmhfg,(αpq¯,βpq¯,γpq¯,δpq¯,ζpq¯)∈PDand(αrq¯,βrq¯,γrq¯,δrq¯,ζrq¯)∈RD.Constraints (20) and (21) defined from the Benders cuts involve variables related with all the days of the planning horizon and the resulting master problem is as difficult to solve as the original VCRPat. Moreover, the convergence results of the Benders algorithm to an optimal VCRPat solution do not apply here due to the combinatorial nature of the subproblem,SUBzw¯. In fact, Benders decomposition theory guarantees that an optimal solution for VCRPaty,x,η⩾0 is achieved, assuming it exists, where VCRPaty,x,η⩾0 is the problem obtained from relaxing the integrality constraints for the y, x, η variables in VCRPat. However, such solution might not be feasible for VCRPat due to the possibility of obtaining non-integer values for the y, x, η variables. Consequently, a non-exact approach is proposed, where in each iteration, the Benders cuts are relaxed into the MASTER objective function, associated with non-negative multipliers uqand vq. A similar relaxation has been used, for instance, by [13] for tractors and trailers scheduling. In the current iteration, the relaxed master problem may be written as RMASTER:(23)minφ0+∑q=1k1uq-φ0+∑h∈H∑d∈D∑(i,j)∈Ihcijdzijdh+∑h∈H∑ℓ∈Lheℓ+α¯ℓpqhwℓh+τ¯q+∑q=1k2vq∑h∈H∑ℓ∈Lhα¯ℓrqhwℓh+ϱ¯q(24)(2)–(5), (11), and (12).Any choice for the multiplier values (uq,vq) that satisfy∑q=1k1uq=1converts (23) into:(25)min∑h∈H∑d∈D∑(i,j)∈Ihcijdzijdh+∑ℓ∈Lhe¯ℓhwℓh+∑q=1k1uqτ¯q+∑q=1k2vqϱ¯qwhere(26)e¯ℓh=eℓ+∑q=1k1uqα¯ℓpqh+∑q=1k2vqα¯ℓrqh.Note that, a possible choice for (uq,vq), that satisfies∑q=1k1uq=1, is given by the dual variables associated with the Benders cuts constraints (20) in the linear relaxation of MASTER.RMASTER, rewritten as (25), (24) and (26), can be partitioned into ∣H∣ independent problems, one for each day of the planning horizon H. In each iteration of the decomposition procedure, crew duty costs in RMASTER are updated with the multipliers and theDLSUBzw¯variables associated with constraint set (17), thus becoming dependent on the day h to which they relate.Usually, public transit companies satisfy two (or three) different transport demand types: one for Monday to Friday and one for weekend (or, one for Monday to Friday, one for Saturday and another one for Sunday). Since days with the same demand type share the same set of trips, due to operational reasons they must have the same set of crew duties to be executed. Should the crew duty costse¯ℓhin (25) not depend on the day h, as it occurs in practice, solving RMASTER would reduce to solve two/three independent integrated vehicle-crew scheduling problems, one for each day-type. Therefore, to keep crew duty costs independent of the day h in which they occur, days are clustered according to the respective day-type demand. For each day-type, crew duty costs are penalized by considering a linear combination of all dualα¯variables values corresponding to the days h of this type. Then an integrated vehicle-crew scheduling problem is solved for each day type. Finally, the solution of RMASTER is built by replicating for all days of H the solutions obtained for the corresponding day-types.In summary, Benders methodology is used to point out how and which crew duties should be penalized in order to obtain a set of vehicle-crew schedules that will lead to a better overall solution.Algorithm 1 describes the non-exact Benders decomposition algorithm based on the proposals of the previous sections. The main body of the algorithm cycles up to a maximum of itermax iterations. In iteration k it solves RMASTERkwith the current sets of extreme points and extreme rays, PDkand RDk, (step 3), obtaining solution(z¯k,w¯k), and then it solvesLSUB(z¯k,w¯k)(from step 4 to step 8).In step 3 the RMASTERkis built by solving an integrated vehicle-crew scheduling problem per day-type. These problems are solved by the algorithm proposed and detailed in [18] which showed to be competitive as compared with other methods in the literature ([2,11]). The algorithm works in three phases. In phase 1, the set of tasks is defined and an initial set of crew duties is obtained. In phase 2, the linear programming relaxation of the model is solved using a column generation scheme, where the vehicle variables z are explicitly considered and the crew variables w are implicitly considered. In fact, each feasible crew duty can be seen as a path in a network, where the feasibility is established by using resources that are consumed along the network. The resource consumption is restricted by imposing time windows on the vertices of the network. The pricing problem is formulated as a resource-constrained shortest-path problem and is approximately solved using dynamic programming with a reduced state space. The heuristic pricing procedure removes some states based on a combination of two criteria: a state is discarded if its reduced cost is greater than a threshold value; a filter is implemented to discard some states at random. If an important state is discarded it is expected that it will be generated in future iterations and not necessarily discarded up to the end. This pricing procedure prevents to generate some duties but at the same time it allows to generate alternative ones leading to a greater diversity of columns, while maintaining the quality of the linear relaxation bound. The diversity of generated columns is important since, whenever the solution of the linear programming relaxation is not integer, a third phase is required in which a branch-and-bound algorithm is used over the set of crew duties generated at the root node to obtain a feasible vehicle-crew scheduling solution. According to the study in [19], when compared with an exact branch-and-price, the branch-and-bound algorithm attained good results in shorter CPU time and, in addition, was able to solve high dimension instances.It is worth noting that, in iteration k of Algorithm 1, new columns based on rostering information are generated for the integrated vehicle-crew scheduling problems of RMASTERk. This is an enhancement on the traditional column generation approaches for the integrated vehicle-crew scheduling subproblem guiding the search for better rosters.In step 4, exact standard algorithms are used to solve the linear programming relaxation of the rostering subproblem,LSUB(z¯k,w¯k). If theLSUB(z¯k,w¯k)solution is not integer and the corresponding value is less than the best upper bound (step 6), then a branch-and-bound is applied to obtain a roster (step 7). Solutions for the rostering subproblem involve a large number of binary variables and a great amount of resources are needed to obtain these solutions. To overcome such drawback, in step 7, different strategies have been incorporated into the branching process, yielding in most cases a feasible solution in short computing time. Depending on which subset of variables branching dichotomy is based, three branching strategies have been combined with variable fixing as follows:•strategy 1: branching is performed over variables x and Σy;strategy 2: branching is performed over all integer variables while fixing to 1 the values of x and y such that x>a0 and y>a1 inLSUB(z¯k,w¯k)optimal solution;strategy 3: branching is performed over variables y, while fixing to 1 the values of y such that y>a2 inLSUB(z¯k,w¯k)optimal solution.Notation Σy represents the vector of aggregated variables∑h∈H∑ℓ∈Lthyℓmh,m∈M,t∈{T,O}. In the first branching scheme, only variables x and the sums Σy are required to be integer. Consequently, in the final solution variables y might not be integer. To avoid obtaining non-integer solutions, a second branching scheme is considered, where all x and y variables are required to be integer. In order to guarantee that integer solutions will be obtained in reasonable CPU time, the value of some variables is fixed using information given by theLSUB(z¯k,w¯k)solution. As for the third strategy, branching over a subset of variables is combined with variable fixing. The thresholds a0, a1 and a2 will be defined in the next section.Finally, the master problem solution(z¯k,w¯k)-set of vehicle-crew schedules covering the planning horizon-along with the corresponding integer solution of the rostering subproblem(y¯k,x¯k,η¯k)-roster for the planning horizon-lead to a feasible solution for the VCRPat and, consequently, to an upper bound on the optimal value of VCRPat. In step 10 of Algorithm 1, the new feasible solution is included in the pool of VCRPat solutions. Decision makers will further analyze the solutions of the pool, from a practical perspective, through different criteria.Algorithm 1Decomposition algorithm pseudo-code.Require:H,M,D,Nh(h∈H),S,[ahs](s∈S,h∈H),itermax1: UB=+∞; PD1=∅; RD1=∅; k=1 {initialization}2: repeat3: solve RMASTERk{that is, solve an integrated vehicle-crew scheduling problem for each day-type and build the solution for all days h∈H} let(z¯k,w¯k)be this solution4: solveLSUB(z¯k,w¯k)and update PDkand RDk5:ifLSUB(z¯k,w¯k)has a feasible solution, let (yk,xk,ηk) be its optimal solution and υ(yk,xk,ηk) the corresponding objective value then6:if (yk,xk,ηk) is not integer and υ (yk,xk,ηk)⩽UBthen7:apply branch-and-bound techniques8:end if9:if an integer solution(y¯k,x¯k,η¯k)is available then10:update UB and the pool of VCRPat solutions with(z¯k,w¯k,y¯k,x¯k,η¯k)11:end if12:end if13:k=k+114: untilk>itermaxA computational experiment was performed using instances based on real world data from two Portuguese public transit companies and also benchmark test instances.Previous computational experiments led us to fix some algorithm options: Parameter itermax of Algorithm 1 was set to 10, due to the trade-off between the quality of the upper bound solution and the time spent to obtain it; All relaxed Bender cuts are equally penalized in the sense that in each iteration of the decomposition algorithm all the multipliers uq, vqhave the same value with uqsatisfying∑q=1k1uq=1.The algorithms were coded in C, using VStudio 6.0/C++ and the programs ran on a PC Pentium IV 3.2GHz. Linear programming relaxations and branch-and-bound schemes were solved with CPLEX 11.0 [22].The input of each VCRPat instance includes the starting and ending times and locations for each timetabled trip and deadhead times between locations and depots. Two sets of real data instances were tested. The first set was derived from an urban bus service operating in the city of Lisboa and includes instances L122, L168, L224, L226, L238 with, respectively, 122, 168, 224, 226 and 238 timetabled trips for Monday through Friday and vehicles from four depots. The second set was built from an urban bus service operating in the city of Porto and involves instances P108a, P108b, P156, P250 and P280 with, respectively, 108, 108, 156, 250 and 280 timetabled trips for Monday through Friday and vehicles from one depot.For all data sets, two types of demand for timetabled trips are considered, one for Monday through Friday and the other for weekend days. The number of timetabled trips for the weekends is around 40% of the number of timetabled trips for Monday through Friday.In order to satisfy the rules imposed by Portuguese labor law, union contracts and specific rules for both bus companies, some parameters have to be defined. Concerning the scheduling of the vehicles and crews:•a penalty of 5000 is added to the cost of each pull-in and each pull-out trip in order to minimize the number of vehicle schedules;for each crew duty the minimum spread is set to 2h;the maximum spread is 5h for crew duties without a break (short duties), 9h for normal duties and 10h and 45min for long duties;break times range from 1h to 2h and 20min;the maximum duration allowed for a crew duty before a break occurs is 5h;10(5) min is set for sign-in (sign-out) when the driver leaves (enters) the depot driving a vehicle; when the driver enters (leaves) the depot without a vehicle, the sign-in (sign-out) is 15min;each crew duty cost is set to 5000.Depots as well as the ending location of timetabled trips are the potential relief points, where a change of driver is allowed. In this context, a driver can switch between two different vehicles at a relief point if and only if the location, where he leaves the first vehicle is the same, where he picks up the second one.Concerning the rostering, the parameters used to balance the different components of the objective function in the subproblem were set to rm=5(m∈M), λO=1 and λT=0.5. Such choice of parameters is explained by the main management goal of minimizing the number of drivers (penalized by rm). Besides, minimizing the number of long duties (associated with parameter λO) is more relevant than minimizing the number of short duties (associated with λT) due to overtime costs incurred by long duties.To compute the VCRPat objective function value, vehicle-crew costs are scaled to balance with roster costs by the scaling factor11510-4.In each iteration of the decomposition algorithm, vehicle-crew schedules for the planning horizon, a linear relaxation rostering solution and, eventually, a roster are obtained from the master and the subproblem, respectively. Section 5.2.1 analyses the performance of the subproblem branch-and-bound by comparing different branching strategies. Sections 5.2.2 and 5.2.3 present and discuss the decomposition algorithm results. The improvement over the sequential approach solution will be assessed from the point of view of transit companies management and from a theoretical point of view using a straightforward lower bound.A comparison of the quality of the rosters and the time needed to obtain them was carried out for the real data instances under the three branching scenarios proposed in Section 4.3. The corresponding computational results are presented in Table 3. For each test problem and each branching strategy, 10 iterations of the decomposition algorithm were executed. Previous computational experience suggested to fix the thresholds a0 and a1, in strategy 2, at 0.75 and 0.9999, respectively, and to fix a2 at 0.85 in strategy 3.Column ‘Instance’ of Table 3 identifies the test instances. Column ‘Strategies’ displays the branching strategy, columns ‘MILP’ and ‘IntSol’ refer, respectively, to the number of times the branch-and-bound was performed and the number of times an integer solution, a roster, was obtained. The following four columns are related to the quality of the best integer solution obtained by the branch-and-bound: the rostering component of the objective value (‘BestSol’); the number of drivers assigned to work schedules (‘Driv’); the maximum number of short duties (‘ηT’) and the maximum number of long duties (‘ηO’) assigned to a single driver during the planning horizon of 49days. The last column reads the total CPU time for the branch-and-bound, in seconds, excluding the root node CPU.Except for intance P280, strategy 3 attained the best performance concerning the number of times branch-and-bound was performed (‘MILP’). Actually, for most cases, strategy 3 attained a good upper bound in early iterations. This feature makes false the condition in step 6 of Algorithm 1, thus skipping the branch-and-bound in step 7.As to the number of rosters obtained (‘IntSol’), strategy 1 (‘x, Σy int’) yielded the worse results for most instances. In fact, this strategy was the unique that did not produce integer solutions for some runs of MILP (see instances L224, P156, P250 and P280). As expected, branching over variablesxsm(strategy 1) that define the assignment of each driver to a schedule is weaker than branching over variablesyℓmhthat define the assignment of a driver to a specific crew duty in a specific day (strategy 3).Regarding the solution quality, strategy 3 yielded the best solution (‘BestSol’) in nine instances out of 10. The results presented in the CPU column for the three strategies confirm that the branching strategy strongly affects the CPU time. For most cases, the smallest CPU times were obtained for strategy 3 whilst the largest ones were obtained for strategy 1.Strategy 2 produced the best results for instances L122, P108a and P108b which have the smaller number of timetabled trips. However, balancing the CPU time and the solution quality, strategy 3 is the best choice in seven instances out of 10. Thus, in subsequent computational results, we adopted strategy 3 in step 7 of Algorithm 1.In this section we discuss computational results from the decomposition algorithm carried out on the set of 10 real based instances. These data always generated feasibleLSUBzw¯, hence all Benders cuts were generated from extreme points.Tables 4 and 5show the solutions obtained from the relaxed master and from the subproblem. In these tables, for each test instance, the first row shows the first iteration solution, which corresponds to the sequential approach, and the second row describes the best result within the 10 iterations. Row ‘Improv’ highlights the improvement of the integrated approach over the sequential approach. The three last rows of these tables present average results from the 10 instances.Table 4 reports on the integrated vehicle-crew solutions for the two demand type days: Monday through Friday and weekend days in brackets. The second column shows the number of daily trips for Monday through Friday and for each weekend day. Column ‘Colgen’ reports on the number of generated crew duties in the first iteration and, in row ‘Improv’, on the additional generated crew duties from iteration 2 to iteration 10. Columns ‘Vehicles’ and ‘Crews’ display, respectively, the number of daily vehicles and the number of daily crew duties from Monday through Friday and for the weekend, partitioned into short/normal/long.The number of additional crew duties generated is on average 8% (14%) of the number of crew duties generated in the first iteration. This shows that the decomposition algorithm requires a small additional effort, over the sequential algorithm, to generate new sets of crew duties that potentially lead to better integrated vehicle-crew-roster solutions. Although the solutions vary from iteration to iteration, the number of vehicles per day as well as the number of crew duties per day are the same in the first and in the best iteration, except for P108b, where the number of weekend crew duties increases by one unit. Column ‘Crews’ shows, in general, a reduction in the number of short/long duties offset by an increase in the number of normal duties. By replacing short/long duties with normal duties, the decomposition algorithm generates a more equitable distribution of work among the drivers. Moreover, for most instances, the number of long duties per day decreases, reducing overtime, which means cost savings for the company.Table 5 reports on the rosters obtained by the branch-and-bound (step 7 of Algorithm 1). Column ‘M’ gives, for each instance, the number of drivers available for work. This number is set to 20% above the total number of crew duties of the planning horizon divided by 35 (working days per work schedule). Column ‘Totcrews’ shows the total number of crew duties partitioned into short/normal/long. These values are calculated from column ‘Crews’ in Table 4 by replicating 35 times the number of crew duties obtained for Monday through Friday plus 14 times the number of crew duties obtained for a weekend day. For column ‘Totcrews’, row ‘Improv’ shows the savings in overtime cost for the planning horizon measured by the reduction in the number of long duties. Column ‘Driv’ presents the number of drivers assigned to work schedules and column ‘ηT/ηO’ shows the maximum number of short/long duties assigned to a driver during the planning horizon.For these test instances, row ‘Improv’ in column ‘Totcrews’ shows significant savings in overtime costs corresponding to an average decrease of about 54 long duties. Instance L238 is the exception with an increase of 28 long duties. However, this is accomplished by a reduction on the number of late duties from 77 to 28 (column ‘Early/late’) thus leading to a better VCRPat solution with one less driver. Note that, concerning instances L226 and P280 the algorithm reduced not only the number of drivers assigned to work (−1 and −2, respectively), but also the number of long duties (−119 and −140, respectively).The global reduction in the ‘ηT/ηO’ values in rosters arises as a natural consequence of the decrease on the number of short/long duties in the RMASTER solution. A lower bound for the ηT(ηO) value may be calculated by dividing the total number of short (long) duties by the number of drivers assigned to driving work and rounding up. Comparing the ηT(ηO) values with the corresponding lower bounds, one may conclude that the algorithm attained the lower bound for ηTin all instances (for ηOin eight instances).In most cases, the decomposition algorithm gives a better VCRPat solution than the sequential approach which corresponds to the first iteration of the algorithm. Actually, except for L224, P108a and P250, the decomposition approach improves on the first solution. In six out of the 10 instances, the best solution was obtained at the fifth or at a later iteration. As expected, Benders cuts adjust crew duty costs in RMASTER problem, thus inducing better balanced sets of (daily) crew duties that lead to better rostering solutions in what concerns the number of drivers and/or the maximum number of short and long duties assigned to a driver.To assess the solutions quality from a theoretical point of view, a straightforward lower bound (LB) may be derived as shown in Appendix A. This LB can be used to calculate an upper bound on the optimality gap in respect to a specific VCRPat solution given byUB-LBLB100%, where UB is the value of the objective function (1) at the solution. The poor quality of the lower bounds, which were obtained by significant relaxations imposed in the model, may lead to huge gap values that may overshadow the improvement given by the decomposition heuristic over the solution of the sequential approach, the one that mimics the way transit companies solve the problem. Nevertheless, the difference between the correspondent gap values may provide an insight on the performance of the proposed methodology. Therefore, the gap improvement of the decomposition algorithm over the sequential approach was then determined for each instance throughUB1-UBbLB×100%, where UB1 is the value of VCRPat given by the sequential approach and UBbis the value of VCRPat given by the decomposition approach. In Table 6one can see that, on average, the decomposition approach was able to improve the gap on 1.7%.This average gap improvement represents significant savings for the transit companies as operational costs are the major part of the total cost. Moreover, expenditure on drivers’ wages contributes with a huge percentage of operational costs. From the results presented above one may infer that this gap improvement is mainly achieved at the rostering component of VCRPat while the vehicle-crew scheduling component remains stable, which highlights the accuracy of the proposed methodology.Table 7reports on the CPU time in seconds spent to solve the relaxed master problem (‘RMASTER’), the linear relaxation of the subproblem (‘LSUB’), the subproblem branch-and-bound (‘SUB–B’) and at last the total CPU time (‘Total’). For each instance, the first row concerns the first iteration and the second row shows the total time for the 10 iterations.On average, the decomposition algorithm CPU time is 1855.1s. for the first iteration and 6175.3s. for the 10 iterations. This shows that the CPU of the proposed approach is only 3.3 times the CPU of the sequential approach. In general, the subproblem CPU time contributes with the major part of the total CPU time. Instance P250 was the hardest one to solve, not only due to the large number of trips (250) but also because it has the largest percentage of late duties (about 12%) when compared with the other instances. This percentage is about 8% for L122 and even lower for all the other instances. The smaller the difference between the number of early and late duties the harder the instance to solve. Note that, the mathematical model (1)–(15) includes not only a set of constraints that imposes a day-off between late-early duties but also a set of constraints preventing early-late sequences.Although the main objective of this study is to address the specific situation that arises at two mass transit companies it is also important to assess the effectiveness and robustness of the proposed decomposition approach under different conditions. Therefore we present some results for the decomposition algorithm running with random data instances for the multiple-depot vehicle and crew scheduling problem that are available at http://people.few.eur.nl/huisman/instances.htm. We have tested the set of 10 instances trips080Axx.txt and the set of 10 instances trips200Axx.txt, both cases involving four depots. Each file tripsxxxAxx.txt gives the daily timetabled trips for Monday through Friday, being the weekend trips randomly selected, with probability 0.4, from the respective non-weekend daily trip set.The same parameters described in Section 5.1, for the scheduling of vehicles and crews and for the rostering, as well as 10 iterations of Algorithm 1 were considered. As for the case of real data, feasibleLSUBzw¯were always obtained, hence all Benders cuts were generated from extreme points.Tables 8–10show average results, whereas detailed results per instance can be found in Appendix B (Tables B.11–B.14). All tables follow the same format of Tables 4–7.Algorithm 1 showed improvement on the results of the sequential approach by reducing the overtime and balancing the workload. On average, for non-weekend days, there was a reduction on the number of short and long duties balanced by an increase on the number of normal duties (Table 8 column ‘Crews’). Despite the results for weekend days, in the overall planning horizon there were significant savings in overtime (Table 9, column ‘Totcrews’). Moreover, the maximum number of short and long duties assigned to a driver also decreased leading to more balanced rosters (Table 9, column ‘ηT/ηO’).In general, the number of vehicles per day remained the same for all iterations. The exception is 200A10 (Table B.11, Appendix B), where the best solution includes one more vehicle and two less daily crews than the first solution, although both solutions have the same costs in terms of the vehicle-crew objective component. By comparing the figures in column ‘Early/late’, Table B.12 in Appendix B, we confirm that these two less daily crew duties represent 70 less crew duties per period. This adjustment leads to less three drivers assigned to work schedules which represent significant cost savings for the integrated vehicle-crew-roster problem even taking into account the increase in overtime.Table B.13 in Appendix B displays the gap improvement for the random instances. On average this gap improvement is 2.6% for the 80Axx instances and 1.1% for the 200Axx instances which suggests that the methodology follows the same behavior as for the real data instances. However, for random instances most of the CPU time was spent solving RMASTER, while for real instances most of the CPU time was spent obtaining the rosters. This may be explained by the fact that these random data instances were specially devised for testing integrated vehicle and crew scheduling algorithms. Moreover, these instances have far less late duties than real based data making it easier to obtain rostering solutions.

@&#CONCLUSIONS@&#
The main goal of public transit companies is to offer a good quality service at low cost. Expenditures on staff contribute with a huge percentage to operating costs and companies must manage their resources efficiently. Hence, any research that leads to the reduction of costs while improving or maintaining service quality is crucial. The objective of this paper is the research on optimization methodologies for a complete integration of vehicle scheduling, crew scheduling and driver rostering problems so as to develop efficient algorithms that give “good” solutions from the standpoint of both the drivers and the company management. This paper proposes a non-exact Benders decomposition based method that generates a pool of feasible solutions for VCRPat, an integrated vehicle-crew-roster problem, where the roster for a specific group of drivers follows a cyclic days-off pattern in use at two mass transit companies.The method outperforms the traditional sequential approach regarding the reduction of operational costs and regarding driver rosters balance. In fact, the computational experience undertaken with real and benchmark based instances shows that, the feedback given by Benders cuts guided the building of the daily vehicle-crew schedules thus leading to balanced workload rosters with fewer drivers and less overtime costs. Furthermore, these results were obtained at low computational expenses.The methodology seems to be also promising if applied to the integrated vehicle-crew-roster problem within other rostering contexts, in particular, the integrated vehicle-crew-roster problem with cycling rosters concerning both the days-off and the working days, as well as the integrated vehicle-crew-roster problem without any underlying pre-defined pattern for rosters.Future research work will focus on the enhancement of methods for obtaining rostering solutions.