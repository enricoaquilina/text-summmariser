@&#MAIN-TITLE@&#
An image processing approach to analyze morphological features of microscopic images of muscle fibers

@&#HIGHLIGHTS@&#
We presented an image processing pipeline that is tailored to model and analyze the two-channel images of muscle fibers.The method integrates information from the two-channel to reduce artifacts in the results.The method quantifies morphological and geometric features of nuclei and cytoplasm of muscle fibers and derives other measurements about muscle fibers.

@&#KEYPHRASES@&#
Cytoplasm,Nuclei,Skeletonization,Quantification,Segmentation,Muscle fiber,

@&#ABSTRACT@&#
We present an image processing approach to automatically analyze duo-channel microscopic images of muscular fiber nuclei and cytoplasm. Nuclei and cytoplasm play a critical role in determining the health and functioning of muscular fibers as changes of nuclei and cytoplasm manifest in many diseases such as muscular dystrophy and hypertrophy. Quantitative evaluation of muscle fiber nuclei and cytoplasm thus is of great importance to researchers in musculoskeletal studies. The proposed computational approach consists of steps of image processing to segment and delineate cytoplasm and identify nuclei in two-channel images. Morphological operations like skeletonization is applied to extract the length of cytoplasm for quantification. We tested the approach on real images and found that it can achieve high accuracy, objectivity, and robustness.

@&#INTRODUCTION@&#
Skeletal muscle is the most abundant tissue of the human body, occupying about half of the body weight in healthy adults [1]. Skeletal muscle is principally composed of individual muscle fibers (or muscle cells) that are arranged in a structured manner. Muscle fibers are formed in the development process from the fusion of myoblasts (primitive muscle cells that can potentially develop into a muscle fiber) in a process known as myogenesis. The long, cylindrical, multinucleated muscle fibers is the biggest cell in the body, generally of tens of micrometers in diameter and hundreds of micrometer in length. The cytoplasm of skeletal muscle fibers mainly consists of regularly arranged myofibrils, in which two components, actin and myosin filaments, are responsible for the striated appearance of skeletal muscles. Functionally, skeletal muscles not only control bodily movement through their contraction and relax but also constitute the largest metabolic pool of the body. Aberration of skeletal muscle is the cause of many muscular diseases, including cardiomyopathy [2–4], muscular hypertrophy [5,6], inflammatory muscle damage [7–9], muscle development [10,11], muscular dystrophies [12–14], amyotrophic lateral sclerosis (ALS) [15], and myasthenia gravis [16]. Many of these diseases have no effective treatment and some of them like muscular dystrophies have a high fatality rate [17,18].In studying skeletal muscles there are multiple criteria in evaluating the healthy status of muscles, including functional improvement of muscles, biochemical changes in muscle mass, and morphology of muscle fibers observed under microscopes. In this paper we focus on developing an image processing approach to automatically analyze and quantify morphology of muscle fibers because many muscular diseases manifest themselves as abnormality in terms of changes in nuclei and cytoplasm of muscle fibers. For example, skeletal muscles are capable of undergoing hypertrophy (increase in their sizes) in response to increased loading, while it can become atrophy upon unloading or immobilization. Skeletal muscle fibers have been shown to gain newly formed nuclei via the fusion of myogenic cells with the adult fibers in muscular hypertrophy. In muscular atrophy, muscle fibers are shown to usually lose nuclei through apoptosis. As such, one important criterion in evaluating the efficacy of treatment under development is to assess whether normality in muscle fiber morphology can be restored, in combination with dynamic evaluation like muscle functions and in vivo imaging [19,20]. The large number of microscopic images of muscle fibers generated in a typical experiment can be on the order of hundreds, making it is time prohibitive and error prone for manual analysis. Computerized analysis can provide objective and quantitative measurements in a high-throughput manner and assist researchers to assess many direct features and derived characteristics of muscle fibers. For example, after finding nuclei and cytoplasm in images, computerized analysis can drive the nuclei-to-cytoplasm ratio of muscle fibers, a criterion widely used to assess the health of muscle fibers [21,22].In this work we developed an image processing pipeline consisting of image segmentation, quantification, and morphological operations to analyze muscle fiber images in a high-throughput manner. We tested the method on muscle fiber images acquired from tissue samples stained for both nuclei and cytoplasm and found the method can achieve high objectivity and accuracy.We harvested primary myoblasts from hind limb muscles of 4-week old C57BL/10 male mice as described in Rando et al. [23]. The myoblasts were expanded in Ham's F10 medium supplemented with 20% fetal calf serum and 5ng/ml basic fibroblast growth factor on collagen-coated plates. After clone culture, the myoblasts were identified with anti-desmin antibody through immunocytochemistry. To induce myogenic differentiation of the cultured myoblasts, the growth medium was replaced with differentiation medium (DMEM with 2% horse serum) after the percentage of coverage reached over 70%. For immunostaining, the differentiated cells were fixed with 4% paraformaldehyde for 30min at 4°C, washed and treated with 0.5% Triton-X 100 in PBS for 5min at room temperature. Then the cells were incubated with primary antibody Myosin Heavy Chain (MHC) diluted in 1:50 (MEDCLA66, Accurate Chemical & Scientific Corp, NY) followed by incubation with a CyTm3-conjugated secondary antibody (Jackson Lab) diluted in 1:500 to observe the cytoplasm. The nuclei were counter-stained with 4,6-diamidino-2-phenylindole (DAPI). Pictures were taken using a laser microscope (Nikon Eclipse E600) and saved as TIFF images with a pixel size of 0.76μm. Fig. 1shows a typical image after merging the DAPI and MHC channels.As the original images were collected in two channels, one for cytoplasm and the other for nuclei, our image processing pipeline features two paths to analyze each channel separately. There are two challenges in extracting objects from this type of two-channel images. The first challenge is that the images may have an uneven background and objects have close adjacency among them. The second challenge is that due to limitations in staining and imaging, there are residual signals from the MHC channel in the DAPI channel and vice versa. For example, Fig. 2(a) shows the DAPI channel image of Fig. 1 and we can observe some weak components of cytoplasm in the image. Fig. 2(b) shows the MHC-stained cytoplasm of Fig. 1 and because nuclei are not stained by MHC, they appear as dark holes on the MHC channel image, which may affect the accuracy of segmenting cytoplasm if the dark holes are not taken into consideration.From Fig. 1 we note that cytoplasm generally has an elongated ellipsoidal shape with varying lengths. We also note that cytoplasm tends to have an approximately straight profile, a fact that we will explore in our algorithm design to detect them. Our image processing pipeline is shown in Fig. 3, which consists of two paths, with one to process the cytoplasm channel and the other to process the nuclei channel. Each branch has two main steps, binarization and morphological analysis. At first, we give an overview of the image processing pipeline. In nuclei channel image processing we employed an adaptive thresholding method to binarize the images. The initial binarized result may consist of both individual and clustered nuclei and thus needs to be further processed. To segment clustered nuclei we calculated the distance transform of each object in the binarized image and apply a peak finding filter. We then determine the centroid of the peaks to account for flat peaks, obtaining the position and number of nuclei inside each object detected in the binarized image. In cytoplasm channel image processing, an adaptive threshold is used to segment the image. Then the segmentation result is merged with that from the nuclei channel image, which identifies the nuclei, to fill the small holes corresponding to the nuclei in the cytoplasm channel. By incorporating the results from the nuclei channel we avoid the necessity to identify small holes directly in the cytoplasm channel, a process that may generate false positives and false negatives. Then we perform skeletonization in the cytoplasm channel to extract the center lines of the cytoplasm. Last, we apply morphological analysis to separate adjacent cytoplasm and remove short spurs in the skeletons of segmented cytoplasm and small areas in the cytoplasm images to clean up the results. Next we describe the steps in the image processing pipeline in more details.Binarization is performed on both channels of images to1.Adaptively thresholding of the nuclei and cytoplasm channels separately. At this step, we employ a circular moving window W with a radius r to binarize each channel [24]. Specifically, for each pixel p(x, y) in a (nuclei or cytoplasm) image we calculate the mean intensityp¯(x,y)of all pixels within W and calculate(1)δp(x,y)=p(x,y)−p¯(x,y)We then compare δp(x, y) to a preset threshold T to classify p(x, y) to 1 if δp(x, y)≥T or 0, otherwise. In our approach, we set T to 0.1 for the nuclei channel and 0.005 for the cytoplasm channel, while the radius of the circular window W was set to 20 pixels for both channels. After thresholding, we obtain the final binarized nuclei image, which we labelInucleiBinarized. The cytoplasm channel needs some additional processing, therefore we label the image obtained in this step asIcytoInter.We next perform a logical OR operation of the two binarized imagesInucleiBinarizedandIcytoInterto create a merged binarized image(2)IMerge=InucleiBinarized∪IcytoInterwhere ∪ is the logical OR operation.At this step we post-process IMergeto remove artifacts. We applied an area filter of 300 pixels to identify small groups of pixels such that(3)IArtifact=f(IMerge)where f is the area filtering process. Here a group of pixels is defined as pixels that are connected. Two pixels are considered connected if they are next to each other in the row or column direction of the image (i.e., diagonally adjacent pixels are not considered as connected in our case). The reason of identifying artifacts based on IMergeinstead of individualInucleiBinarizedandIcytoInteris to reduce the probability of incorrectly marking valid structure that may be partially binarized in bothInucleiBinarizedandIcytoInter. If we apply the area filter onInucleiBinarizedandIcytoInterseparately, this valid structure might be incorrectly identified as an artifact.Based on IArtifactidentified above we then remove artifacts from IMergeto obtain(4)IcytoBinarized=IMerge−IArtifact.In the process of binarization, small holes may be formed in the binarized cytoplasm imageIcytoBinarizeddue to the presence of nuclei or noise. At this step, we fill small holes less than 100 pixels inIcytoBinarized.The nuclei channel segmentation result of Fig. 2(a) is shown in Fig. 4(a). The initial binarized result of the cytoplasm channel of Fig. 2(b) is shown in Fig. 4(b), from which we can observe that there are holes in the binarized cytoplasm results that are caused by the nuclei and small scattered areas. The result of filling the small holes is shown in Fig. 4(c) by incorporating the locations of nuclei from Fig. 4(a). Finally small scattered areas are removed to produce the binarized cytoplasm shown in Fig. 4(d). From the figure we note that while most cytoplasm is well segmented there is some cytoplasm connecting to others in the image. So at the next step we will employ morphological analysis to separate those cytoplasm.At this step we apply morphological operations to segmentIcytoBinarizedbased on prior biological information. First, we modify the Palágyi algorithm to calculate the skeleton (or medial axis) of the binarized cytoplasm [25]. The skeleton corresponding to Fig. 4(d) is shown in Fig. 5(a). For better illustration we randomly chose three ROIs in Fig. 5(a) and show them in Fig. 5(b), (f), and (j). After finding the skeleton, we calculate the widths of all the cytoplasm by measuring the distance from the skeleton to the cytoplasm boundary. The corresponding results are shown in Fig. 5(c), (g), and (k), respectively. This step is implemented by measuring the Euclidean distance d from each point of the skeleton to the closest cytoplasm boundary point. The width of a cytoplasm is estimated as two times d along the skeleton. We also construct the network formed by the skeleton, which includes terminal nodes and bifurcation nodes that connects two or more branches. The constructed network is important for cytoplasm analysis as we need to separate individual cytoplasm that appears connected due to the limited image resolution. The constructed network is shown in Fig. 5(d), (h), and (l). In using the Palágyi algorithm short spiky branches may be created due to the noise in the image that affects the binarization process and such branches need to be removed. A short branch is considered noisy if its length is less than 10 pixels (or 7.6μm), which is slightly larger than the average cytoplasm width. We chose this value because it is unlikely that a fiber has a length almost equal to its width, and therefore this value ensures that no real fibers are removed in this step. Fig. 5(e, i, and m) shows in green the small branches that are removed in this step. After obtaining the skeletons we proceed to separate touching or adjacent cytoplasms. Because we know a priori that cytoplasm does not make sharp turns, in other words, does not have a high curvature, we check each bifurcation point and compute the angles formed between the skeleton segments to determine which of them belong to the same cytoplasm and which one represents separate cytoplasm. Fig. 6illustrates the process of computing angles formed at bifurcation points and separating touching cytoplasms. At bifurcation point C, pairs of three line sectionsAC¯,BC¯, andDC¯form three respective angles, α, β, and γ. We then determine that line sectionsAC¯andBC¯constitute a valid cytoplasm object because β is close to 180° and α and γ are much less than 180°. In the case illustrated in Fig. 6, line sectionsAC¯andBC¯are determined to form the skeleton of one cytoplasm object while line sectionDC¯is considered as the skeleton of another cytoplasm object and it is then separated at the bifurcation point C. Since skeleton sections are not always straight lines, we perform a first-order line fitting to each skeleton segment near the bifurcation point. The lengths of the line sections used for fitting (i.e., the distance of points A, B and D to point C) may affect the accuracy of the result. On the one hand, if the lengths used are too small, the robustness of the angle calculation may be affected as noise in the skeleton near the bifurcation point may have a profound effect in determining the direction of each skeleton section. On the other hand, if the lengths used are too large, the skeleton sections may deviate too much from being a straight line and may also affect the accuracy of calculation. In this work, we set the length of each line section used in angle calculation to 10 pixels. Note that this length is large enough to avoid discretization effects in angle calculation. Next, we dilated the skeleton by several pixels to obtain an approximate representation of the original fibers. In Fig. 7(a) we show the overlap of the obtained skeleton on the original cytoplasm image. The dilated skeleton is shown in Fig. 7(b). Note that in the figure each fiber is represented by a different shade of gray.The purpose of this step is to detect and segment the nuclei. In this work, we applied a distance transform on the binary nuclei image,InucleiBinarized, in order to separate overlapping nuclei. First, we note that noise in the image acquisition process gives rise to very small connected components in the binarized image. Therefore, we need to remove such components while keeping valid nuclei that have small areas. The size of components caused by noise was found to be typically smaller than 30 pixels, while we found no nuclei having a size smaller than 60 pixels. Thus, we choose to remove all components smaller than 60 pixels. Note that this difference in size between the noisy components and the nuclei means that the results are weakly sensitive to this parameter. For example, modifying the threshold to 40 pixels changed the results by less than 0.1% for all measurements. In this step, we have a new image given by(5)InucleiFinal=InucleiBinarized−f(InucleiBinarized)where f is, again, the area filtering process that identifies small components. We then apply a distance transform [26] on the resulting binary image. The distance transform works as follows. For each pixel that belongs to an identified object inInucleiFinal, we calculate the smallest distance between the pixel and the border of the object and assign the obtained value to the respective pixel in a new imageInucleiDistance. In Fig. 8we show an binarized image (Fig. 8(a)) and the respective distance transform (Fig. 8(b)). The task of identifying individual nuclei is then converted into the task of finding peaks in the distance transform. For such a task we use a maximum filter with a circular mask of radius rppixels, that is, we mark each pixel that has maximum intensity inside a disk of radius rpcentered at the pixel under consideration.Note that rpis an important parameter of the nuclei detection method as it sets the scale where we expect to find maximum values of the distance transform. In other words, the detected peaks will be separated by at least rppixels. Since our main objective is to separate peaks in the distance transform that are close to each other and belong to the same object (caused by overlapping nuclei), the chosen radius of the maximum filter is related to the minimum radius expected from a nucleus. As pointed out above, we found no nucleus with an area smaller than 60 pixels, which is equivalent to a minimum radius of roughly 4 pixels (supposing perfect circular nuclei), therefore we set rp=4 pixels (or equivalently, 3.04μm). There are a few cases that a group of pixels have the same maximum value (i.e., a flat peak in the distance transform). In such cases we calculate the centroid of the flat region. We now have the positions of the nuclei in the nuclei channel, which can then be compared to the detected cytoplasm in the other channel to obtain geometric and morphologic measurements such as the number of nuclei in each fiber or number of nuclei per fiber length. We note that changing the radius of the peak finding filter does not change the positions of the detected nuclei as it only affect the total number of detected nuclei. The detected peaks from the nuclei shown in Fig. 8(a) can be seen in Fig. 8(c).

@&#CONCLUSIONS@&#
