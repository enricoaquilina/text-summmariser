@&#MAIN-TITLE@&#
A service flow model for the liner shipping network design problem

@&#HIGHLIGHTS@&#
A novel formulation of the liner shipping network design problem.The first model to fully handle butterfly ports, having multiple calls to the multiple ports, often used in practice.Results are reported for the LINER-LIB benchmark suite.

@&#KEYPHRASES@&#
Liner shipping,Network design,Maritime optimization,

@&#ABSTRACT@&#
Global liner shipping is a competitive industry, requiring liner carriers to carefully deploy their vessels efficiently to construct a cost competitive network. This paper presents a novel compact formulation of the liner shipping network design problem (LSNDP) based on service flows. The formulation alleviates issues faced by arc flow formulations with regards to handling multiple calls to the same port. A problem which has not been fully dealt with earlier by LSNDP formulations. Multiple calls are handled by introducing service nodes, together with port nodes in a graph representation of the problem, and by introducing numbered arcs between a port and a novel service node. An arc from a port node to a service node indicate whether a service is calling the port or not. This representation allows recurrent calls of a service to a port, which previously could not be handled by LSNDP models. The model ensures strictly weekly frequencies of services, ensures that port-vessel draft capabilities are not violated, respects vessel capacities and the number of vessels available. The profit of the generated network is maximized, i.e. the revenue of flowed cargo subtracted operational costs of the network and a penalty for not flowed cargo. The model can be used to design liner shipping networks to utilize a container carrier’s assets efficiently and to investigate possible scenarios of changed market conditions. The model is solved as a Mixed Integer Program. Results are presented for the two smallest instances of the benchmark suite LINER-LIB-2012 presented in Brouer, Alvarez, Plum, Pisinger, and Sigurd (2013).

@&#INTRODUCTION@&#
When manufactured goods are transported from one corner of the world to another it is likely to happen in a container. These containers are carried by up to 400meter long container vessels transporting tens of thousands of containers. Liner shipping carriers operating these vast vessels construct intricate networks of shipping routes that in their interaction provide fast and, relative to other transport modes, cheap transport that operate at the core of the worlds supply chains.A global container shipping network is extremely costly to operate, with Maersk Line using a two-digit billion USD amount yearly for this purpose. Therefore, even a small improvement of the network’s utilization, costs, service levels, etc. can have a significant impact. At the same time the cost structure of the network can be very volatile; by developing models that can investigate an increased cost or reduced demand, the network can rapidly be modified to adapt for these changed market conditions.The basic cost components of a container shipping network are: vessel costs, bunker fuel costs, port call fees and container move costs in ports. These have been very volatile in the past years, with fuel costs reaching record levels in 2008, to fall again during the financial crisis, followed by a rise in prices during the later recovery (Bunkerworld12, 2012). Vessel charter rates are similarly fluctuating and have fallen dramatically as the financial crisis hit world trade (TCCBS09, 2009). Furthermore, there is an increasing interest in limiting CO2 emission, related to the fuel consumption. This is already an important aspect of a shipping line company’s public profile, which is expected to have increased focus in the years to come. All these factors add to the importance of liner shipping network design. This paper presents a novel model of the Liner Shipping Network Design Problem (LSNDP).A liner shipping network consists of a number of services, each service being a roundtrip sailed by a fixed number of vessels, much like a bus transit network. These services are able to tranship containers between each other at ports. Each port to port sailing by a service is denoted the service’s legs. Each port call on the roundtrip will be served at a fixed frequency, predominantly weekly (as a bus route served every 20th minute), by a vessel. To utilize vessels best possible, service roundtrip times are thus generally a multiplier of 7days.These services constitute the network, through which the demand should be flown. Each demand is a fixed weekly volume of containers requiring transport from a specified origin to a specified destination. The demand will pay a revenue for being served, but it is acceptable to leave some demand at the cost of paying a goodwill penalty. The path of the demand will incur additional cost for moving containers on and off the vessels. The goal is then to construct a liner shipping network, consisting of some services, allowing for the transport of containers, with the aim of maximizing the profit of operating the network, e.g. the revenue subtracting costs for services, moving containers on and of vessels (move cost) and goodwill penalties.In the proposed model, services are constructed by opening links from each service (the number of considered services being fixed) to a number of ports, using specialized service-port arcs. This can be reconstructed to a service traversing between the ports, using auxiliary variables. Likewise, the demands will flow from origin port to a service and from a service to destination port (or transhipment), on specialized service-port arcs. The specific port to port path can be reconstructed using auxiliary variables. As compared to LSNDP models of related problems this model has the advantages of allowing non-simple cycles with any number of calls to one or more butterfly ports. Services with one or more butterfly ports is often denoted butterfly routes, such routes are usefull in service design for different reasons:•Increased capacity on the legs between the butterfly port calls, as the service will carry less cargo on these legs. This capacity can be used for other cargo. E.g. in Fig. 1more capacity will be available between the first and second call to port A, as exports from A to region X are not carried here, but instead are lifted in the second call to A. An example could be Singapore as a butterfly port on a Europe to North Asia/Japan service.Two services with non-weekly frequency can be combined to a service with weekly frequency. E.g. LetD,E,Fbe some given ports, then service 1 calling (D→E→D) with a 4day roundtrip time and service 2 (D→F→D) with a 10day roundtrip time, can be combined to a service 3 (D→E→D→F→D) with a 14day roundtrip time and thus satisfying the weekly frequency requirement, by allowing butterfly calls at port D.Draft limits at later ports may require that the vessel is eased before port call, a butterfly port call will alleviate this on port calls in between.Improving transit time, as the extra port call will allow for faster imports or exports to remaining ports on the service. E.g. in Fig. 1 exports from port A to region X will be faster with butterfly calls.Note that draft dependent on vessel load and transit time is not considered in the present model, but still it is a cause for using butterfly routes. Thus it is important for a LSNDP model, to accurately model butterfly port calls (see Fig 2).LSNDP is a strategic problem, where network design decisions are made on a 6–12months time horizon, subject to amendments at a later stage. One concern with the LSNDP is that all demand is considered deterministic, with a fixed demand between the worlds ports every week. This assumption is far from reality, as container demand is subject to large fluctuations from week to week. However, a deterministic approach is still relevant, as the demand on an aggregated level gives a more stable picture. E.g. when looking at demand from continent to continent, the forecasts will be more accurate. A deterministically designed network can to some degree be corrected by short term amendments to vessel schedules, using third party tonnage or rolling cargo to the next sailing. An alternative approach to formulate liner shipping network design problems could be a stochastic approach. However, stochastic models generally greatly add to the complexity compared to deterministic models. As the deterministic version of LSNDP is very hard to solve, it is unlikely that a stochastic approach will scale to anything reasonable, hence this approach has not been investigated.This service flow model for the liner shipping network design problem will be abbreviated SFM.The model has been implemented as a MIP, solved by a commercial solver. Results are reported on data from the LSNDP Benchmark instances LINER-LIB-2012 (Brouer, Alvarez, Plum, Pisinger, & Sigurd, 2013).Relevant literature is introduced in Section 2. In Section 3 we introduce the mathematical notation used in the paper and explain details on the problem structure. The concept of service flow is central for this paper and explained in detail in Section 3.1. This is used to formulate a model for the LSNDP in Section 3.2. This MIP model has been implemented and solved with a commercial solver. Computational results are reported in Section 4, with the key contributions of providing solutions for two instances of LINER-LIB-2012, while considering operational constraints as capacity, port draft and butterfly ports, which no method previously has. We conclude on the paper in Section 5 and discuss directions for future research.In this section we summarize the literature related to the considered problem. For a general introduction to the maritime industry please refer to Stopford (2009). For a review of research in maritime optimization refer to Christiansen, Fagerholt, and Ronen (2004) and Christiansen et al. (2007). For a detailed introduction to liner shipping network design and details on the structure of the liner shipping business, its operational requirements and cost structure we refer to Brouer et al. (2013). A recent overview of research in container routing and scheduling problems in liner shipping is given by Meng, Wang, Andersson, and Thun (2013).Work on liner shipping network design is particularly relevant for this paper. The work of Shintani, Imai, Nishimura, and Papadimitriou (2007) has a detailed description of the cost structure of LSNDP and includes consideration of repositioning empty containers. A service is constructed, assuming all demand is flowed if a port is called. The method allows for butterfly ports, by using duplicate virtual ports, but only for a single service.Two decomposition methods was presented by Agarwal and Ergun (2008), a Benders and a column generation based algorithm. The column generation algorithm considers the flows of the containers in a master problem, and the pricing problem considers the generation of vessel rotations by detecting negative cost cycles. Multiple services are generated and transshipment is allowed. These algorithms scale well to large instances, but transshipment costs are excluded. The methods are based on a time space graph, which allows for multiple visits to a port as long as the visits do not happen on the same day of the week.Fernando Alvarez (2009) proposes a heuristic column generation based method for solving the joint routing and deployment of a fleet of container vessels. The method also considers flow in the master problem and run/service generation in the subproblem. The method is able to solve instances with 7 ports. A solution for a 120 ports instance is reported, using heuristic approaches. The algorithm, allows butterfly ports, but with some shortcomings as discussed in Section 3.1.Reinhardt and Pisinger (2011) propose a branch and cut method for the LSNDP. The formulation allows pseudo-simple cycles, meaning a cycle with a single butterfly port with at most two calls. A clover cut for the problem is derived, and some cuts from VRP are also used. This gives a branch and cut algorithm, which outperforms a pure MIP-model solved by CPLEX. Instances with up to 10 ports are solved optimally.The work of Brouer et al. (2013) describes the domain of LSNDP, discusses the relevant scoping, propose a model of the problem, and presents a number of benchmark instances denoted LINER-LIB-2012, for the LSNDP based on real world problems. A heuristic column generation based algorithm is presented, which solves a number of the LINER-LIB-2012 instances. The algorithm, which can be seen as an extension of Fernando Alvarez (2009), has fixed the butterfly issues, but only allows a single butterfly port per service.Other research in liner shipping network design is Gelareh and Pisinger (2011) who proposes a hub and spoke model for which a primal decomposition based solution method is derived. The method does not allow for butterfly ports. A heuristic algorithm for a scheduling and container routing problem is presented by Wang and Meng (2011), but the method does not design new rotations. Other approaches evaluates the best flows and networks than can be derived from a number of shipping lines, given as input. Among these are Meng and Wang (2011) and Wang and Meng (2012) dealing with robust service generation.To the best of the authors’ knowledge no model or algorithm has been developed considering transhipment costs; allowing any number of butterfly ports on a service; and allowing the butterfly ports to have more than two calls, at the same time. This paper address all these criteria by allowing any number of butterfly ports, with any number of port calls, while considering transhipment costs.The notation used throughout the paper is introduced in this section. Vessels are available in different vessel classes,v∈V, characterized by their forty foot container capacitycv; a maximal numberzvof available vessels of the vessel classv. The portsi∈Phave the following characteristics: a port call cost for a vessel class iswi,v; move cost for a container isui. The set of directed edges considered,a∈A⊆P×P, is a subset of the complete graph spanned by the ports, leta(i,j)denote the arc from port i to port j. All distancesdij=daare assumed to satisfy the triangle inequality.o(a)andd(a)respectively is the head and tail ports of the arc. A distancedaof a path fromo(a)tod(a)is assumed not to travel through canals subject to fee’s for passing (i.e. Suez and Panama). These canals are assumed to exist ini∈Pwith appropriatewi,v, so a canal traversal will only be possible by visiting this port and thus paying the fee.The demandk∈Kwith volumeFk, whereo(k)andd(k)(same notation as for arcs) respectively is origin and destination port of the demand, is assumed to flow continuously over the considered time-period, with a steady supply every week. Demand is only to be satisfied if profitable, the revenue for doing so isqkper container. We have a goodwill penalty for not flowing a demandq̃k.A services∈Sis a directed, possibly non-simple, cycle of portsi∈P, traversed by a given vessel classvbeing intrinsic tos. The port calls ofs, can be denoted the rotation ofs. This rotation is traversed by an integer numberτsof identical vessels of a vessel classvcalling each port in the rotation with a weekly frequency. Services are required to have weekly frequency, i.e. they must follow a fixed schedule with total roundtrip time a multiple of 7days, i.e.7·τs. Lets∈s(v)imply thatsis sailed by vessel classvandv(s)indicate the vessel class used by services.A service consists of a number of port callsb∈B={1,…,|B|}. We also refer to the bth leg of service s, the arc between the bth port call and theb+1’st port call. Note that, as the call legs b are cyclic, thenb′=|B|+1=1to enforce a cyclic service. A service can have no more than|B|port calls.Vessels are assumed to sail at their design speeds∗v, measured in nautical miles per hour, during their whole rotation, and port stays are fixed to 24hours for all port calls, as done in LINER-LIB-2012. Both are very broad assumptions based roughly on actual services, but with large variations. The bunker consumption at speeds∗visl∗v. Additionally, the vessel uses fuel for electricity, pumping and other purposes, this idling consumption of the vessell0vis used irrespective of whether the vessel is sailing or not. Both consumption types are measured in metric tonnes per day.The demandkis then transported on one of these servicesseither in a directpath, wherescallso(k)loads the cargo and carries it all the way tod(k)and unloads the demand. The demand can also be carried in a transhipmentpath, where a service,s1calls porto(k)loads the cargo and carries it to some transhipment port t where the demand is unloaded and loaded by a different service,s2carrying it tod(k). A path can involve multiple such transhipments.Both the demand (weekly number of containers to be flowed) and supply (number of vessels to sail on a service to achieve weekly frequency) is defined in weekly terms, hence the time dimension does not need explicit representation in the problem graph, which can be seen as a recurring representation of the demand/supply balance over a week. The model will then aim to install weekly capacity in the network on which the weekly demand can flow.This assumption follows industry practice, where all larger and most smaller services have weekly frequency. This has the advantages of providing stable use of resources such as vessels and port berths, easing transhipments in ports, as it allows connecting time windows of communicating services, to be minimized, and provide customers with an easily understandable service catalog of the next departure, and its transit time (as a local bus-route with a fixed frequency).The number of vessels required to enforce weekly frequency on a service, can be bounded by:(1)ds/s∗v+24·ns⩽τs·24·7wheredsis the roundtrip distance ofs, andnsis the number of port calls on the service. Using the same assumptions, the weekly running costscsof a servicescan be calculated as the sum of the daily time charter rateTvper vessel, the idling bunker consumption per dayl0vand the sailing bunker consumptionds/s∗v/24·l∗v(2)cs=7·τs·Tv+7·l0v+ds/s∗v/24·l∗v·zwherezis the cost of bunkers in dollars per metric tonne. Note that the unit ofdsis nautical miles per weeknmweekas the whole distance is traversed each week, as the service has a weekly frequency. Following we get the unitsnanometerweek/nanometerhour/hourday·metric tonneday=metric tonneweek, for the last term,ds/s∗v/24·l∗v.Vessels are assumed to sail at design speeds∗von all legs. The distance of the service might not exactly fit this distance, as seen in Eq. (1) where the number of vessels is rounded up. This corresponds to the vessels lying still for a while. In practice a vessel will be able to use this time to sail a bit slower than the design speed, and due to the cubic relation between speed and bunker consumption, it could save bunker cost. Hence the calculated bunker costs are upper bounds on actual bunker costs.Given a graphG(P,A), a set of demands K, a set of vessel classesVand data on above mentioned cost, volume, capacity, etc. the problem is to find a maximal profit liner shipping network.Current mathematical models of liner shipping network design problems use arc flow formulations, an example is seen in Fig. 3(a). These have both flow variablesfi,jfrom port i to j and network decision variables,δi,jof some form, related to the arcs of the graph. This works well when considering simple cycles. But in real world services it is common practice to have butterfly calls, for reasons mentioned in the introduction.The issue arising with arc flow formulations in connection with butterfly services, can be illustrated by Fig. 1(b). A node which is called twice, A, will have flow entering from two directions C and X, and flow leaving in two directions B and X. The flow entering from one of these, can only leave on one of the two leaving arcs. E.g. a demand entering from B should exit towards X, but if the formulation does not explicitly handle this, it can equally well exit towards A. The problem in this (flow entering from B leaving towards A) can be perceived in two ways; The flow is cheating on capacity on the legsA→X→Aor is cheating on paying transhipment costs in A.This issue can be partly remedied as done in Reinhardt and Pisinger (2011), which allows semi simple cycles, i.e. a vessel rotation can have a single butterfly port.The motivation for a service flow formulation comes from the observation that flow, for instance from a feeder port to a hub port, in an arc flow formulation is seen as a path between a number of feeder ports, finally arriving at the hub port. Rather, we could consider it by connecting the feeder port with a service, which then again was connected to the hub port. An example of this is seen in Fig. 3(b), the square black nodes represent services, the round gray nodes represent ports, arcs pass from port-nodes to service-nodes only.Flow variablesfi,b,skrepresent flow of some demandkfrom port i to the bth call of services,fs,b,ikrepresent flow from the bth call of s to i. The auxiliary measured flow variablesfb,skare the flow of demandkon the bth leg of services. Binary decision variablesθi,b,sare then set to 1 iff i is the bth port on service s.This formulation allows any number and sequence of recurring calls to some butterfly ports. Some problems arise from this formulation that must be tackled in different ways.Since B and S are indices of flow and decision variables, these are input parameters of the model. B can be seen as an upper bound on the number of port calls on a service. The binary variablesΨbsare set if the bth leg of service s, is not used. A service can then be of any length less than or equal to B.Large ocean carriers predominantly use weekly frequency on their services. This is enforced in the generated services, by Eq. (1), which ensures that the service can traverse the distancedswith a sailing speed at or less thans∗v. Thus the cost of the service will be a lower bound of the real cost as the vessels in practise may sail slower, allowing for less fuel spent due to the quadratic fuel consumption curve (see Brouer et al. (2013) for details).If vessels have larger draft than a port allows, they are not able to call it, hence the decision variable representing this must be fixed at 0.Each vessel classv, has a limited numberzvof vessels available, all services using the same vessel class must adhere to this.The capacity of each leg of the service must be respected. Looking at Fig. 3(c), it can be seen that the flow on leg 1 (from port 1 to port 2) of demandk,f1,sk, must adhere to:(3)f1,sk⩾∑ifi,1,sk-fs,1,ikandf1,sk⩾∑ifi,1,sk-fs,1,ik+fi,3,sk-fs,3,ikas for all demandskand services s, at least one leg b, will have no flowfb,sk=0, otherwise the flow-path would be taking the full cycle, which cannot be optimal.To arrive at the flow on leg b we need to consider the largest of the flow deltafi,β,sk-fs,β,iksums, for theβ∈circ(b,…,B-1)previous legs. Where circ denotes legs in a circular traversal of the service. This can be generalized to:(4)∑circ(b>β⩾α)∑i∈Pfi,β,sk-fs,β,ik⩽fb,sk∀s,k,b,α∈B⧹{b}where the first summation implies: for each previous callαwe need to sum for legsβuntil the considered call b. The call b can then either be beforeαas seen from the 0th leg, giving: (b⩽α) where we sum overβlegs:β<bandβ⩾α. Or b can be afterαas seen from the 0th leg, giving: (b>α) were we sumβlegs:b>β⩾α. The capacity can then be imposed on variablesfbsk.The auxiliary binary decision variableδb,sais set to 1 iff arcais the bth arc used by services. If the draft of a port i does not allow call by a vesselv:draft(i)<draft(v(s)), the corresponding variablesθi,b,s,δbsa(i,j)andδb,sa(j,i)are set to 0. The non-negative integer variableτsis the number of vessels used on services.The LSNDP can now be formulated as the following mixed integer programming model:(5)max∑k∈Kqkfk-∑k∈Kq̃k(Fk-fk)-∑i∈Pui∑k∈K∑s∈S∑b∈Bfi,b,sk+fs,b,ik-∑s∈S∑i∈P∑b∈Bwi,v(s)θi,b,s-∑s∈Scs(6)s.t.∑i∈P∑b∈Bfi,b,sk=∑i∈P∑b∈Bfs,b,ik∀k∈K,∀s∈S(7)∑s∈S∑b∈Bfd(k),b,sk=fk∀k∈K(8)∑s∈S∑b∈Bfi,b,sk=∑s∈S∑b∈Bfs,b,ik∀k∈K,∀i∈P⧹{o(k),d(k)}(9)∑circ(b>β⩾α)∑i∈Pfi,β,sk-fs,β,ik⩽fb,sk∀s∈S,∀k∈K,∀b∈B,∀α∈B⧹{b}(10)∑k∈Kfb,sk⩽cv(s)∑i∈Pθi,b,s∀b∈B,∀s∈S(11)∑k∈Kfi,b,sk+fs,b,ik⩽2cv(s)θi,b,s∀i∈P,∀b∈B,∀s∈S(12)fi,b,sk+fs,b,ik⩽Fkθi,b,s∀i∈P,∀b∈B,∀s∈S,∀k∈K(13)θi,b,s+θj,b+1,s⩽1+δb,sa(i,j)∀i,j∈P,∀b∈B,∀s∈S(14)2δb,sa(i,j)⩽θi,b,s+θj,b+1,s+Ψb+1,s∀i,j∈P,∀b∈B,∀s∈S(15)θi,b,s+Ψb+1,s+θj,1,s⩽2+δb,sa(i,j)∀i,j∈P,∀b∈B,∀s∈S(16)∑i∈Pθi,b,s+Ψb,s=1∀b∈B,∀s∈S(17)∑a∈Aδb,sa+Ψb,s=1∀b∈B,∀s∈S(18)Ψb,s⩽Ψb+1,s∀b∈B⧹{|B|},∀s∈S(19)∑a∈A∑b∈Bda/s∗v·δb,sa+24∑i∈P∑b∈Bθi,b,s⩽24·7·τs∀s∈S(20)∑s∈vτs⩽zv∀v∈V(21)0⩽fk,fi,b,sk,fs,b,ik,fb,sk⩽Fk∀k∈K,∀i∈P,∀b∈B,∀s∈S(22)θi,b,s,δb,sa∈{0,1}∀i∈P,a∈A,∀b∈B,∀s∈S(23)Ψb,s,τs∈Z+∀b∈B,∀s∈SThe objective is to maximize the profit of flowed cargo on the opened network, by maximizing the revenue subtracted a penalty for cargo not flowed, done in the two first terms of (5), the container move cost are subtracted in the third term, as are the port call cost in the fourth term and lastly the costs of deployed vessels and bunker cost incs.The flow must adhere to flow conservation in service nodes ensured by constraint (6) and port nodes by constraint (8). Constraint (7) allow flow to enter at the demands source node. Thefb,skvariables must be set by constraint (9). The capacity is enforced in constraint (10). We can only flow on open arcs, this is handled by constraint (11), using twice the service capacity as big M, as we at most can fully unload and load the vessel at a port call. This is also tightened by constraint (12). Constraints (13)–(18) ensure proper construction of services, i.e. arc decision variablesδb,saare set in (13). Constraints (14) and (15) links variablesθi,b,sandδb,sa. Each port call must have exactly one call as handled by constraints (16) and (17). Constraint (18) propagates the variableΨb,sthrough b if set. Weekly frequency is enforced as lower bound on service distance with constraint (19). The number of vessels is constrained by (20). Variable bounds are given in (21)–(23).To further tighten the formulation a number of additional constraints can be added:(24)∑j∈P∑b∈Bδb,sa(i,j)=∑j∈P∑b∈Bδb,sa(j,i)∀i∈P,∀s∈S(25)∑i∈P∑j∈P∑b∈Bδb,sa(i,j)=∑i∈P∑b∈Bθi,b,s∀s∈S(26)θi,b,s+θi,b+1,s⩽1∀i∈P,∀b∈B,∀s∈S(27)∑k∈Kdo(k),d(k)fk⩽∑s∈S∑a∈A∑b∈Bcv(s)daδb,sa(28)wi,v(s)θi,b,s⩽∑k∈Kfi,b,sk+fs,b,ikqk+q̃k-uo(k)-ud(k)∀i∈P,∀b∈B,∀s∈Swhere constraints (24)–(26) tighten the domain of the binary variables. Constraint (24) ensures flow balance for the auxiliaryδb,sa(i,j)variables. Constraint (25) gives that the sum of port calls given byδb,saandθi,b,svariables must equal. Constraint (26) ensures that two consecutive port calls cannot call the same port, i. Constraint (27) has the total flowed volume multiplied by its direct distance as a lower bound for all services roundtrip distances multiplied by their capacity, as an optimal capacity allocation would satisfy this. It is required by constraint (28) that revenue and goodwill of demand loaded and unloaded in a port call, subtracted the first load and last discharge move, exceeds the port call cost.The formulation will suffer considerably of degenerate optimal solutions, due to the sets B andS. Some of the degeneracy can be dealt with by two types of symmetry breaking constraints.(29)∑k∈Kfi,b,sk+fs,b,ik⩽∑k∈Kfi,1,sk+fs,1,ik∀b∈B⧹(1),∀s∈S(30)∑a∈A∑b∈Bδbsa·da⩽∑a∈A∑b∈Bδb,s+1a·da∀s∈s(v),∀v∈V,The first constraint considers the flow on a service, as the legs of the service are numbered from{1,…,|B|}, an identical service can be generated by shifting the numbering of all legs by one. Constraint (29) will break this symmetry by requiring that the 1th call of the service always has the most load and unload moves. Note that if several calls have the same number of moves, symmetry will still exist. Constraint (30) considers services of the same vessel class, requiring these to be ordered by non-decreasing distance, this will alleviate symmetry arising in the formulation.The problem is NP-hard by reduction from the TSP. Given a set of nodesi,j∈Pwith distancesdijbetween the nodes the TSP problem asks to find the shortest Hamiltonian cycle visiting all nodesP. For a given instance of TSP we can reduce it to an instance of LSNDP by having only one vessel classv, and only one vesselzv=1. Let the demandfkbetween each pair of nodesPbe 1 and the penaltyq̃kfor not shipping the cargo be infinitely large. The sailing bunker consumption between ports i and j is set todijand the idling bunker consumption is set to zero. The sailing time between all pair of nodes is set to24·7/|P|, such that any route visiting all nodes takes exactly one week. Finally, the transhipment move cost is set to infinity and the port call cost is set to 0.The SFM Mixed Integer Program (5)–(28), has been implemented and solved by CPLEX 12.2 on a Intel i5 @ 2.53GHz with 3GB of RAM. It has been run on the LINER-LIB-2012 instances and compared with the best solutions found in Brouer et al. (2013).The LINER-LIB-2012 benchmark is a set of publicly available instances for the LSNDP presented in Brouer et al. (2013). All relevant data for a network design instance is available: distances between portsda; vessel classesvdescribed by their capacity, drafts, cost and speed limitations; a list of ports i described by their draft limits, call cost and move cost. Seven instances of varying size are available, each with a given fleet of vessels. Each instance has a demand list K with a volume and revenue that can be flowed. The size of the SFM is proportional to the number of port calls per service|B|and the number of services|S|, refer to model Section 3.2, where most constraints and variables depend on|B|and|S|, for details. It follows that the size of the resulting MIP, the MIPs memory requirements and the MIPs running time are dependent on the size of B and S. If|B∗|and|S∗|are the largest values used in an optimal solution for an instance. Then a model where|B∗|>|B|or|S∗|>|S|might find a suboptimal solution, as the optimal solution cannot be found- This results in a tradeoff choice between running time and memory usage against possibly sub optimality of the found solution. The chosen values for|B|and|S|for the instances can be seen in Table 2.The model has been run on the two smallest instances of LINER-LIB-2012, Baltic and WAF, Table 1reports details on the sizes of these. Both instances have one main port (Bremerhaven and Algeciras) and all demands are between this main port and feeder ports. Revenue and all cost parameters outlined in the objective function (5) are included: move cost for loading and unloading containers; port call cost, vessel and bunker costs (both propulsion and idling bunker consumption).The instances have been run with zero goodwill penaltyq̃k=0for demand not flowed. This resembles a scenario where a carrier solely focuses on optimizing profits. The results are given in Tables 2 and 3.None of the instances could be solved to optimality, although one has a gap of just 3%. Profitable solutions are found for all instances. Due to their size the WAF instances are considerably harder than the Baltic instances. No instances use all vessels, but it cannot be ruled out that B and S are restrictive and thus limits the use of vessels. Table 4shows the considerable size of the MIPs. Referring to Table 3 it can be seen that only two instances use transhipment, and one of these on a very small scale. This is reasonable as all demand is from or to a main port. An example of a solution using butterfly calls can be seen in Table 8.In the spirit of the LINER-LIB-2012, the results of the SFM model have been compared with the results from Brouer et al. (2013), the Benchmark Instance Algorithm (BIA). The results of BIA are reported in Brouer et al. (2013) over 180days, and are minimizing the cost subtracted the revenue. The SFM is run on weekly values and is maximizing the revenue subtracted the cost. Hence all values taken from BIA results have been multiplied by −180/7 to be comparable with the results of SFM.A number of differences between the SFM and BIA models mainly arise from diverging opinions of how the LSNDP should be modeled to reflect the actual network design situation. The differences are:1.BIA allows biweekly services in some cases, where ports are only called every other week, a 14day frequency. The average frequencies of the best BIA result services can be seen in Table 5, where the average frequency is closer to 14 than 7 for all instances. This allows solutions serving low demand ports cheaper, as larger (and thus generally with cheaper unit cost) vessels can serve these less frequently.BIA does not enforce strict (bi) weekly frequency, but allows slight deviations. This gives up to 9% extra capacity.The goodwill penalty in BIA is set atq̃k=1000dollar, as opposed toq̃k=0dollarin SFM.BIA optimizes on the speeds of the generated services, allowing it to slow steam, where beneficial and thus get lower bunker costs. Speeding up to get additional cargo where possible, is also allowed, details on the sailing speeds can be seen in Table 5.To make the results of SFM closer to the BIA results, SFM has been modified to imitate difference 1 and 3, by allowing biweekly services (by halving port call, bunker and vessel cost, halving capacity and doubling the right hand side of Eq. (19)), and increasing the goodwill penalty toq̃k=1000. It has not been possible to imitate difference 2 and 4.The results of the modified SFM can be seen in Tables 6 and 7. As the modified SFM is a relaxed version of the SFM, we would expect lower solution values, not higher solution values as seen when comparing these results against the original runs (Tables 2 and 3). This is likely due to limited network capacity, a consequence of halving the vessels capacity. The lower vessel capacity causes all port calls B and services S to be used in all instances, to increase network capacity. This is likely one of the reason for the larger solution values as the size of B and S limits the solution space, even more than the relaxations opens the solution space.Another reason for increased solution values are the goodwill penaltyq̃k, which lowers the overall objective, but also seems to make the problem significantly harder, with much worse gaps. A reason for this is Eq. (28) being looser with increased goodwill penalty.Details of the best solutions are found in Table 3 and 7 showing the distribution between revenue and the different cost components.Other differences between SFM and BIA are:•BIA is a randomized algorithm, which gives different solutions depending on the seed. We are comparing against the best results from 10 randomized runs.To SFM’s advantage any number of butterfly ports is allowed, opening the solution space, where BIA only allows one butterfly port with two port calls.SFM is restricted in its solution space if|B∗|>|B|or|S∗|>|S|, as described earlier in this Section.But these are intrinsic to the algorithms, as they are part of the modeling and algorithmic properties we with to compare.Looking at Tables 5 and 6 it can be seen that BIA finds a better solution in all cases, but except for one instance the BIA solutions are within the upper bound of SFM. One reason is that the sizes of|B|and|S|in SFM is severely restricting, as BIA uses significantly more port calls and services. The upper bounds of SFM exceeds the best found solutions of BIA except for the High WAF instance, which must be due to the differences in the two formulations. In all cases the distance between the BIA solution and the SFM upper bound is small, thus validating that the BIA solutions are close to a comparable upper bound.

@&#CONCLUSIONS@&#
