@&#MAIN-TITLE@&#
Solving air traffic conflict problems via local continuous optimization

@&#HIGHLIGHTS@&#
Original compact trajectory model using B-splines.New semi-infinite programming formulation of the separation constraint.New continuous optimization formulation of the tactical conflict-resolution problem.Numerical experiments show viability of the approach on realistic test problems.Local continuous optimization methods are competitive with the traditional, discretized combinatorial approaches to this problem.

@&#KEYPHRASES@&#
Air traffic conflict problem,B-splines,Continuous optimization,Genetic algorithms,Semi-infinite programming,

@&#ABSTRACT@&#
This paper first introduces an original trajectory model using B-splines and a new semi-infinite programming formulation of the separation constraint involved in air traffic conflict problems. A new continuous optimization formulation of the tactical conflict-resolution problem is then proposed. It involves very few optimization variables in that one needs only one optimization variable to determine each aircraft trajectory. Encouraging numerical experiments show that this approach is viable on realistic test problems. Not only does one not need to rely on the traditional, discretized, combinatorial optimization approaches to this problem, but, moreover, local continuous optimization methods, which require relatively fewer iterations and thereby fewer costly function evaluations, are shown to improve the performance of the overall global optimization of this non-convex problem.

@&#INTRODUCTION@&#
This introduction describes the importance of the conflict-resolution problem, followed by some details on related work.Air traffic management (ATM) aims at ensuring smooth running of the transportation system under safety and schedule alignment constraints while keeping flights on schedule. In order to reach this goal, air traffic is planned at different time frames. Strategical planning is done several months before take-off and consists of assigning flight plans for a whole day of traffic with an emphasis on an even distribution of aircraft density in space and time. Pre-tactical planning then updates the strategical planning trajectories using information such as weather or airspace congestion. It takes place two hours before the aircraft reaches the considered airspace. Tactical planning, the subject of this study, is performed within a 20-minute time horizon and consists mainly of conflict detection and resolution. This tactical planning work has always been done by air traffic controllers who are in charge of the most critical aspect of ATM, namely, ensuring sufficient separation between airplanes. Air traffic controllers are responsible for ensuring the respect of regulatory separation rules that are currently 5 nautical miles horizontally and 1000 feet vertically.A conflict situation happens when an aircraft enters the standard safety zone of another aircraft (a situation where a regulatory separation rule is not respected). Our work focuses on tactical planning, which is currently handled by air traffic controllers on each airspace sector. To solve a conflict, controllers can use a set of maneuvers: offset, turning point, speed change, and flight-level change. For instance, Fig. 1shows maneuvers implying direction changes.As a consequence of increasing traffic, controllers in charge of an airspace sector must handle more and more flights (see Fig. 2). The current approach is to decrease the size of the control sectors in order to compensate for the growth of traffic. However, the traffic is reaching the point where a decrease of the size of sectors is no longer efficient. In reality, ATM has already used every available resource in an attempt to increase airspace capacity. However, from now to 2030, air traffic is expected to increase by a factor of two or three (SESAR Joint Undertaking, 2009). Consequently, ATM will have to deal with this overload while ensuring at least similar standards of safety (SESAR Joint Undertaking, 2009). As is illustrated in Fig. 2, the difference of traffic capacity between 1970 and 2010 is rather dramatic.In this context, the long-term vision aims at lowering the workload of the air traffic controllers by reducing the conflict-resolution task. An example is the 4D-trajectory concept, which consists of defining precisely a trajectory in space and time. One option is to create an automatic conflict-resolution tool to provide advisory solutions to the controller. Some previous work has been done in the direction of automatic-conflict resolution (see Bosc, Durand and Maugis 1997) but to our knowledge, none has been used operationally yet.One approach for air traffic automatic conflict resolution uses navigation functions (Dimarogonas and Kyriakopoulos, 2005; Roussos and Kyriakopoulos, 2009). What follows is a presentation of the repulsive force technique that inspired the navigation function methods (the repulsive force technique is much more intuitive and easier to comprehend). A repulsive force technique considers the airspace as a potential field, and aircraft as particles navigating in it. Negative charges represent obstacles for the aircraft (other aircraft, congested areas). The destination is associated with a positive charge. As a result, each aircraft is attracted by its destination while being repulsed by obstacles, as is illustrated by Fig. 3. Each trajectory is determined in its own functional space so that an aircraft cannot be attracted by the destination of another aircraft. This enables the automatic generation of conflict-free trajectories.Navigation function methods were shown to ensure collision avoidance while connecting the departure and destination points. The major drawback of navigation functions is that the obtained solution does not necessarily respect ATM constraints such as the particular bounded speed (an aircraft cannot fly below or above a certain range of speed), or trajectory smoothness. Furthermore, they can lead to major delays and overcosts as they tolerate large deviations from the direct route, i.e. the straight line between the departure and arrival points.Optimization methods have also been used in air traffic automatic conflict resolution. In Pallottino, Feron and Bicchi (2002), two approaches based on a local optimization method are presented. One approach considers using only speed changes, and the other relies solely on direction changes. However, the speed-change approach cannot solve every conflict situation (simply consider a face-to-face situation for example), and their direction-change approach is restricted to straight-line maneuvers.Further developments are presented in Alonso-Ayuso, Escudero, and Martin-Campo (2011) combining speed and altitude changes and using a mixed-integer linear optimization approach. This method provides very interesting results both from the point of view of computational time and the quality of resolution on conflict situation involving up to 50 aircraft (which are not all involved in the same conflict however). In Alonso-Ayuso et al. (2011) a method is presented that relies on exact optimization, which is a significant advantage. However, the use of altitude changes is a drawback as it induces costly maneuvers that are avoided by air traffic controllers due to their high costs in fuel that are unacceptable for airline companies.Remaining optimization methods for this problem rely on heuristics. The authors of Durand and Alliot (1995) and Médioni, Durand and Alliot (1994) obtain relatively good results on real traffic using Genetic algorithms (GA). However, their approach is restricted to offset and turning-point maneuvers, i.e. piecewise-linear trajectories. Similarly, using ant colony optimization and modelling trajectories as a path in a graph, Durand and Alliot (2009) and Olive (2006) are confined to produce piecewise-linear trajectories. Finally, another recent solution for tactical conflict resolution, presented in Dougui, Delahaye, Puechmorel and Mongeau (2012), called LPA (Light Propagation Algorithm), is inspired by an analogy with light propagation. LPA uses a Branch-and-Bound technique to build trajectories and obtains good results on a full day of traffic over France. However, the trajectories are built sequentially, which can cause significant deviations for some aircraft. For more detail on air traffic conflict detection and resolution, see the reviews by Delahaye and Puechmorel (2013) and Kuchar and Yang (2000).There are three means to solve an air traffic conflict: speed changes, direction changes and altitude changes (of course, reducing the traffic also naturally decrease the number of conflict). This paper focuses on tactical en-route conflict resolution, which in our case means we consider a 20-minute time horizon. Thus, this study considers only direction changes, as speed changes are not as efficient on such a short time frame, and as altitude changes are only used as a last resort by air traffic control (because of their cost and the passenger discomfort they engender). That is why, in this paper, each aircraft is also assumed to preserve its imposed vertical profile. Consequently, as the study concentrates on en-route traffic, aircraft are considered to fly at a stable altitude, which means solving the conflicts solely in two dimensions.This paper presents a tractable and practical method to solve tactical conflicts on the considered time horizon, involving only a small part of the trajectory (corresponding to the considered 20-minute window). One of the contributions of this paper is to model trajectories with B-splines. The overall trajectory is to be managed by an algorithm that aggregates the separate 20-minute windows. To treat a large air traffic instance (for example the French en-route air traffic), the conflict solver presented in the paper is to be applied at regular time intervals using a moving time-window. Furthermore, the solver can be applied on different geographical zones at the same time. See Dougui et al. (2012) for more details on this moving time-window process. For these reasons, computational efficiency is an important aspect of conflict resolution. The concept of a moving time-window (decreasing the number of considered aircraft) and the need for computational efficiency are the main reasons why local optimization has been tested in this study.As already mentioned, the context of this study is the tactical planning phase. The aim here is to obtain, from a conflicted situation, an optimal conflict-free solution by deviating the trajectories smoothly and as little as possible.This paper introduces an original trajectory model using B-splines and a new semi-infinite programming formulation of the separation constraint involved in air traffic conflict problems. Another related contribution consists of a new continuous-optimization formulation of the tactical conflict-resolution problem that involves very few optimization variables: only one real optimization variable per trajectory. Finally, encouraging numerical experiments are obtained using genetic algorithms, a finite-difference interior-point method, and derivative-free optimization.The input data of the problem consist of :1)N: the number of aircraft involved in the conflictαstartiandαendi: the initial and final positions of the aircraft i (i = 1, 2, …, N) respectively, as illustrated in Fig. 4.vi: the speed of aircraft i, which is assumed constant.The use of smooth trajectories is not possible in today’s operational context as air traffic control is currently restricted to trajectories involving linear segments connected with small constant-curvature turns. However, the challenging research projects SESAR and NextGen consider smooth trajectories as an option for the future Flight-Management Systems. The ability of future FMS (Flight Management System) to fly such trajectories opens new opportunities for optimization with respect to environmental criterion. In this context, the use of cubic B-splines (smooth piecewise-cubic polynomials) to design aircraft trajectories allows one to describe an aircraft trajectory deviation between the points αstart and αend with a single continuous parameter. These parameters (one per aircraft) will be the optimization variables in this study. Furthermore, it should be clear that it is more desirable in practice to use smooth trajectories. This section describes the main ingredients of B-spline theory in a more general context.B-splines are parameterized curves determined by a set of points called control points. One considers here a set of control points(Xk,Yk)∈R2. One can define γ(s), the B-spline curve determined by the control points (Xk, Yk) as follows:γ(s)=(γx(s),γy(s)),s∈[0,Ncp−1],where s is the natural parameter of the B-spline, and Ncp is the number of control points. The B-spline curve is obtained as a linear combination of the B-spline function basis(Bk)k=−1,…,Ncp. Each element, Bk, of the function basis is a cubic-polynomial function. The basis function B0 is the interpolation natural cubic spline of the following points: ( − 2, 0),(−1,16),(0,23),(1,16),(2,0)centered on 0, and the remaining elements of the basis are obtained by simple translations of B0.The B-spline basis functions used to calculate the B-spline curve γ(s) for s ∈ [1, 2] are the ones with a non-null value on this interval [1, 2] (in bold in Fig. 5). Thus, the unique 2D B-spline curve that is determined by the Ncp control points (Xk, Yk) along with three so-called phantom points is given by the following linear combination of the Bk’s :γx(s)=∑k=−1Ncp+1XkBk(s)and forγy(s)=∑k=−1Ncp+1YkBk(s).The B-spline fitting curve is a piecewise cubic polynomial function of s, where the knots, sk, are the points where the pieces join. Denoteγxk,dγxkds,d2γxkds2andd3γxkds3respectively the B-spline desired values: the B-spline desired first, second and third derivative values for s = sk. The following requirements yield standard B-spline properties for unit knot intervals:(1)γxk=Xk+1+4Xk+Xk−16,dγxkds=Xk+1−Xk−12,d2γxkds2=Xk+1−2Xk+Xk−1,d3γxkds3=Xk+2−3Xk+1+3Xk−Xk−1.Since the Taylor’s expansion is exact for polynomials (providing enough terms are taken) one then obtains the B-spline value for all s ∈ [sk, sk + 1]:(2)γx(s)=γxk+(s−sk)dγxkds+(s−sk)22d2γxkds2+(s−sk)36d3γxkds3.Higher-degree derivatives are zeros, as γx(s) is a cubic B-spline. As we use three control points (αstart and αend and one movable, α(u)), there are three knots, inducing two sub-intervals. The trajectory γ(s) is represented on the interval [0, 2] and on the two sub-intervals [0, 1] and [1, 2]. For more details, the B-spline theory is described, for example, in Duncan (2005).In the following, the indices i and j will be used to determine the considered aircraft, and k will be used to determine the considered control point. Thus, γistands for the trajectory of the ith aircraft, and γkfor the value of γ at the knot skfor the considered trajectory.B-spline fitting is a very efficient tool for trajectory modelling in terms of both fitting quality and computational time. Moreover, B-splines feature interesting properties such asC2-continuity, which is crucial for modelling flyable smooth aircraft trajectories. In addition, a very attractive property is the fact that, by construction, the B-splines minimize the quantities:∫(γx′′(s))2dsand∫(γy′′(s))2ds. This is important in an operational context as it induces low energy consumption and passenger comfort.B-splines have already been used in trajectory optimization and one can find an example in Milam, Mushambi and Murray (2000).In this study, one models a trajectory with a cubic B-spline defined by three control points: the start and end points (given input data), plus a middle control point (Fig. 6). This middle control point is called the movable control point, as it will be used to deviate the trajectory. The exact position of this control point will be monitored by a single real-valued parameter. The vector of decision variables of the optimization problem we are about to define will be made of these real-valued parameters.One wants a compromise between allowing the trajectory to deviate freely (in any direction) from the direct route in order to avoid conflicts, and staying as close as possible to the direct route. For that purpose, one defines a fixed maximal bandwidth (interval [ − Dmax, Dmax]) that depends on the direct route length (Dinit). The trajectory will be imposed to stay within the maximal bandwidth (see Fig. 7).The middle control point coordinates corresponding to the trajectory of aircraft i (i = 1, 2, …, N) is denoted αi(ui). Its exact position will be determined using the parameter uiwhich will represent a bandwidth proportion. It is defined as:ui=±dDmax(percent), where Dmax = λDinit, d is the distance between the control point αi(ui) and the direct route for aircraft i, and λ is a user-defined proportion. In the numerical tests, λ is set to 0.3, so as to expect a maximal distance increase of about 10 percent from the original trajectory (this was observed empirically).The optimization variable of the problem is therefore the vector u whose ith component is that percentage uicorresponding to trajectory i = 1, 2, …, N. The search space is therefore the hypercube [ − 100, 100]N.In order to calculate the deviation of each aircraft (which will be required for computing the objective function of the optimization formulation of the next section), one must first build the trajectories driven by the above-defined control points. From a given deviation percentage vector, u, one calculates the control point locations, and the B-splines driven by them. In order to illustrate this, consider the trajectory of a single aircraft, i. First, let us define the direction vectorδi:=αendi−αstartiof the ith direct route. The middle of the original trajectory direct route is called the site and is denoted bypmidi. The middle control point αiis placed on the line orthogonal to the direct route and intersecting the direct route atpmidi(see Fig. 7). In other words,(3)pmidi=αstarti+12δi.The vector of normDmaxi(maximal deviation bandwidth of the ith aircraft) that is orthogonal to the direct route, and, by convention, oriented toward the left of the aircraft trajectory, is denoted byqi∈R2. More precisely, it is obtained by solving the system:(4){(δi)Tqi=0||qi||=Dmaxi.The first line of this system ensures the orthogonality between q and δ, while the second line defines the length of q. Solving this system leads to two possible vectors q. To choose between those two possibilities, we define a convention stating that qishould be oriented toward the left of the original trajectory. Consequently, if ui> 0, the ith aircraft will turn left. Hence, one can write the following relation between the control point αi(u) and the ith optimization variable uicorresponding to aircraft i:(5)αi(ui)=pmidi+uiqi.Thus, given ui, one knows the three required control points (αstarti,αi(ui) andαendi), and can compute the B-spline defining the ith aircraft trajectory.The problem consists in designing, if possible, an optimal conflict-free situation. This section proposes an optimization formulation of this problem whose constraints will require that there is no conflict. The objective function of the problem can be defined in several ways: one can consider minimizing the total deviation distance or total fuel consumption for instance. This paper concentrates on finding conflict-free trajectories that minimize the average total deviation distance (with respect to the direct routes). The formulation presented can easily be adapted to other objective functions.A new idea introduced in this paper is to consider the continuous separation distance as a constraint, making the approach more direct than previous methods that rely on a discretization of the trajectories, not only for numerical purposes but in the actual formulation of the problem to be solved. However, this constraint must be respected at all times, leading to an infinite number of constraints. As described above, one uses u, the vector containing all the middle control point locations, ui, i = 1, 2, …, N as the optimization variable.Let f(u) be the objective function representing the average travelled distance for every aircraft (details are given in Section 3.2), which is written as follows:(6)f(u)=1N∑i=1Nfi(ui),where fi(ui) is related to the travelled distance of the aircraft i following its modified trajectory. This function is further explained in Section 3.2.In order to guarantee a conflict-free situation, one must ensure that all aircraft are, at least, τ ≔ 5 nautical miles away from each other (in practice, τ = 5.001 is taken to give a margin tolerance). The separation-norm constraint can be expressed explicitly by imposing, for any pair of aircraft i and j whose trajectories are denoted respectively γi(ui; s) and γj(uj; s):(7)cij(u;t):=∥γi(ui;s(t))−γj(uj;s(t))∥22≥τ2,∀t∈[0,tminij],wheretminij:=min(tendi,tendj),withtendiis the arrival time of aircraft i to its end pointαiend. The natural spline parameter, s, and the time, t, are related by the following bijective relation between s and t:(8)s(t)=θ−1(ui;t)andt=θ(ui;s),whereθ(ui;s)=∫0s(dγx(ui,ξ)dξ)2+(dγx(ui,ξ)dξ)2dξrelates time and the natural spline parameter, s, through the arc-length closed-form expression.Therefore, the problem can be formulated as:(9){minuf(u)=1N∑i=1Nfi(ui)s.t.cij(u;t)≥τ2∀t∈[0,tminij];i=1,…,N−1;j=i+1,…,N.In order to compute cij(u; t), one needs to evaluate γi(ui; s(t)) and γj(uj; s(t)) at time t. This is achieved in practice by sampling the trajectory in time, noting that one has for each s, the values (xi, yi, di, t), where diis the distance travelled by aircraft i whose co-ordinates are (xi, yi) at time t. These values are sampled with respect to time, using linear interpolations (diand t are exact; and xiand yiare approximated via sampling).In this sub-section, the objective function is defined and closed-form expressions of the objective-function derivatives with respect to the optimization variables are obtained. Recall that the objective-function is expressed in (6), and that the optimization variables are meant to describe the middle control-point locations (αi(ui)=pmidi+uiqi).Since fi(u) depends only on the ith u component, the ith partial derivatives of the objective-function is:∂f∂ui=1N∂fi∂ui.As described in the previous section, each trajectory can be represented by a parametric curve inR2:γi(ui;s)=:(γxi(ui;s)γyi(ui;s)), where s ∈ [0, 2] ( = [0, Ncp − 1]), and it is defined by a B-spline driven by three control points corresponding to s ∈ {0, 1, 2}.To define the objective function, let us define:T^i(ui):=∫02(dγxi(ui;s)ds)2+(dγyi(ui;s)ds)2ds.and,(10)Ti(ui):=∫02(dγxi(ui;s)ds)2+(dγyi(ui;s)ds)2ds.The former gives the total distance travelled by the aircraft i while the latter represents an energy. Minimizing the energy Tialso minimizesT^i,therefore, one can rather minimize Tiin order to avoid the square root (see, for example do Carmo 1992, pp. 190–200). We choose the total energy rather than the travelled distance as a criterion in order to ease the derivatives calculation.In order to have a normalized objective function f(u), one defines the functions fi(ui) ∈ [0, 1] as follows:(11)fi(ui)=Ti(ui)−Ti(0)Ti(1)−Ti(0).A tedious calculation, detailed in Appendix  A, yields the closed-form derivatives, for i = 1, …, N:∂∂uifi=1Ti(1)−Ti(0)(3215ui((qxi)2+(qyi)2)).Inspired by Conn and Gould (1987) and Visweswariah, Haring and Conn (2000), one can reformulate the constraint function cijas:Cij(u)=∫0tminijmax{τ2−cij(u;t);0}dt=0.Doing so, one transforms the semi-infinite constraints (each constraints is defined over a time interval[0,tminij]) into a single equality constraint (see also Stein 2012 for a more theoretical survey of semi-infinite optimization). This constraint ensures that the separation norm is respected between aircraft i and j. Indeed, if, for some pair of aircraft (i, j), there is a conflict, then τ − cij(u; t) > 0 during some time interval, leading to a non-zero integral (constraint violation). One can rewrite Cij(u) as:(12)Cij(u)=∫Θij(τ2−cij(u;t))dt,withΘij:=⋃κ[tinκij,toutκij],where the union is over each time interval[tinκij,toutκij]during which the aircraft i and j are in conflict (violating the separation constraint), and where κ is the number of such time intervals. Since there is only one movable control point for each trajectory (which means an aircraft cannot do more than one turn), there can only be at most κ = 2 violating time intervals for each pair of aircraft (see Fig. 8). Consequently, without loss of generality, one can assume there are at most three possible configurations corresponding to κ = 0, 1, 2 depending on the situation. A situation with κ conflicts corresponds to κ violating intervals.Standard optimization methods commonly require providing the objective-function and constraint derivatives. No satisfying results have been obtained for the computation of the constraint derivatives although we are working on such an improvement (and have successfully provided derivatives for the objective function). Thus, in this study, when constraint derivatives will be required by an optimization method, we shall be content with finite-difference gradients.This section details the different optimization methods applied to the problem. First, a genetic optimization method (GA) is used to handle the combinatorial aspect of the problem, as this optimization approach is the most used for conflict resolution problems. One can next take advantage of the fact that the B-spline trajectory model allows one to apply a standard local continuous optimization method such as interior-point methods. Finally, because of the relatively large number of function evaluations required for the use of finite-difference approximations of the gradients, it is natural to try one of the modern derivative-free optimization method.The first optimization method considered to solve the problem is genetic algorithms (GA; Goldberg, 1989). We emphasize that this is also a contribution of this paper since we use the formulation (9).Our implementation of GA selects the best individuals of the population at each iteration using a deterministic (λ, μ)-tournament selection which randomly selects λ individuals and keeps the μ best elements, where λ > μ are user-defined parameters. This step is repeated until a new intermediate population is completed. Genetic operators (crossover, mutation or nothing) are then applied with specified user-defined probabilities (noted respectively pc, pmand, 1 − pc− pm). Ultimately, one obtains the next generation of chromosomes. This generational process is repeated until some user-defined termination condition has been reached. In this study, a maximal number of generations is imposed.The chromosome encoding used here represents the trajectories of N aircraft using a vector of N real numbers (the ui’s, see Fig. 9). It respects the locality principle: two individuals close to each other in the search space represent close solutions. The crossover operator is used to mix the features of two good individuals (good from the point of view of candidates for improving upon the current solution), called parents, from the previous generation. It consists of picking the most conflicted aircraft of each parent (more precisely, we seek for the highest value of ∑j ≠ iCij(u) among all aircraft i = 1, …, N), say aircraft i for one parent and aircraft j for the other, and of modifying its B-spline trajectory over [s0, s2] using a barycentric transformation of the two parents’ corresponding movable control point (Fig. 10). The crossover results in two children that are expected to yield local improvement.The mutation operator, used to diversify the genes in the population in order to explore widely the search space, consists, in this application context, of choosing randomly one movable control point and to assign to it a new value chosen randomly (using a uniform distribution) in the interval (percent) [ − 100; 100] (see Fig. 11).Finally, the fitness, which quantifies the ability of an individual to solve the problem is defined as follows:(13)f(u)=1N∑i=1Nfi(ui)+ω∑i=1N∑j=1NCij(u),where ω is a penalization parameter, weighting the importance of feasibility with respect to optimality, set empirically by the user.This penalty function is also invoked in order to enable the use of the derivative-free optimization method BOBYQA described in Section 4.2.1.This section details briefly the local optimization methods applied and the reasons why they were chosen.The lack of closed-form expressions of the constraint derivatives naturally leads to derivative-free optimization methods (Conn, Scheinberg and Vicente, 2009). The method chosen here is Powell’s BOBYQA (Bound Optimization BY Quadratic Approximation; Powell, 2009), one of the most effective derivative-free optimization methods available. It is based on a trust-region model described in Chapter 10 of Conn et al. (2009). Note that this class of methods does not handle constraints directly (except for simple bounds). Consequently, the penalized objective function defined in (13) is used.For our numerical experiments, we use all the default values proposed in Powell (2009) for the various parameters defining the method.In fact, a closed-form expressions of the derivatives of the objective function can be obtained here (this calculation is detailed in Appendix  A). One can therefore consider applying a standard local differentiable optimization method. We choose constrained interior-point methods because they are state-of-the-art methods for non-linear programming. The numerical experiments are conducted using the Matlab routine fmincon (Byrd, Gilbert and Nocedal, 2000). The gradient of the objective function is supplied to this routine. However, the derivatives of the constraint functions (12) (which are not trivial to obtain) are approximated automatically by fmincon using finite differences. Current work aims at obtaining a closed form of the gradient of the constraint functions.Here again, we use in our tests the default values provided by Matlab for the various parameters involved in the algorithm.This section presents comparative numerical results obtained with the different optimization methods proposed above. First, an academic test problem, called the roundabout, is presented. Then, a more realistic problem (so-called operational-like test problem) is proposed. Although rather artificial, both test problems feature some operational aspects of real-life problems and thereby allows one to test the viability of our methodology.The results we obtain with GA are used as a reference. Indeed, we expect GA, considering its ergodicity property, to be able to reach the neighborhood of any desired point of the search space within the (large) number of iterations allowed. Consequently, with a significant number of function evaluations, we expect GA to find a solution whose value is relatively close to the optimal value. Moreover, GA is known to be fit to handle the air traffic conflict problem (Médioni et al., 1994), which makes it a good reference to compare with the results of our local optimization approach. To summarize, we shall compare the results we obtain with local optimization method with (fmincon) and without derivatives (BOBYQA), to the ones we obtain with our GA implementation.The proposed genetic algorithm is implemented in Java. As mentioned above, the differentiable local optimization method used is the routine fmincon from the Matlab Optimization toolbox. The derivative-free optimization method BOBYQA is coded in fortran 77 and is called from Matlab via a mex interface. As a consequence of this difference in programming language, computational time cannot be considered as an objective comparison criterion. We rather rely here on comparing the number of function evaluations, which represents most of the computational time spent by the optimization methods. This corresponds to common practice in black-box optimization where the objective and/or constraint functions are costly to evaluate. However, in order to give an idea of the order of computation time involved, let us simply present the calculation time for one evaluation of both the objective and constraint functions for a same point, and on a same traffic situation. In both cases (Java and Matlab), we use a 2.53 GHz processor Intel Core 2 Duo on a Ubuntu 12.04 LTS operating system. Using Java, one evaluation requires 7 milliseconds while with Matlab, it needs 26 milliseconds.Here are the parameter values used to implement the different above-mentioned algorithms:1)Population size: 100; number of generations: 100 (hence GA will evaluate 10,000 times the objective and constraint functions)Mutation probability: pm= 0.3Crossover probability: pc= 0.6Constraint penalization parameter: ω = 0.01Stopping criterion of the local optimization methods: ||uk + 1 − uk|| < 10−6Approximate global optimization value tolerance for GA f⋆ − f < εf≔ 10−4, for feasible solutions, where f⋆ is the best solution value found by GA. This f⋆ value will be used as a comparative quality criterion in the numerical results.The local optimization methods fmincon and BOBYQA start with the best feasible point from 100 randomly-generated points from the search space ([ − 1, 1]N). These 100 extra function evaluations are taken into account in the function-call counts for these methods (in a suitable parallel environment, choosing many different starting points could be relatively inexpensive).First, a simple but difficult academic test with conflict situations, that is widely used for air traffic conflict problems, is considered. Each instance of the roundabout problem involves N aircraft uniformly distributed on a circle of radius 100 nautical miles. Each of the N aircraft flies to the diametrically opposed point at a common speed (for N even, each point on the circle has an outgoing and an incoming trajectory, see Fig. 12).This problem is convenient to test conflict-resolution methods because, due to its symmetry, there is an expected solution. Indeed, air traffic controller common practice would then make all the aircraft involved in the conflict turn to the same side. In the sequel, this obvious solution is referred to as a global solution of the problem. This test problem is widely used because automatic air traffic conflict resolution algorithms are not designed to take advantage of this particular symmetry.The roundabout test problems considered here involve successively N = 2, 4, 6, 8, and 16 aircraft. Recall that the chosen start point of the local optimization methods is the best point among a 100 randomly-generated points of [ − 1, 1]N. GA initial population will also be randomly generated in [ − 1, 1]N.The computational results obtained with the three optimization approaches (GA, fmincon, and BOBYQA) on this academic problem reveals that:1)GA and BOBYQA always (for N = 2, 4, 6, 8, and 16) finds a global minimum (all aircraft turn to the same side).For N = 2, fmincon always finds a global optimum.For N = 4, fmincon finds a local minimum for which objective-function value vary in [f⋆, 3 × f⋆] depending on the chosen starting point.For N = 6 fmincon finds a local minimum for which objective-function value vary in [f⋆, 8 × f⋆].For N = 8 and 16 aircraft, a local optimum is not always found with fmincon, depending on the chosen starting point.No further detail is given as this is an academic problem that does not correspond to real-world problems.In order to create test problems that are more realistic, an operational-like test problem can be created by introducing some perturbations in the roundabout test problem. This study is limited to conflicted situations involving N = 6 aircraft, as according to air traffic controller experience, conflicts involving more than four aircraft are not typical in en-route traffic (only one four-aircraft conflict happens over France each year). For each aircraft, one randomly displaces (or not) the position of the start and end points on the circle by 20° to obtain a conflict situation involving various crossing angles, losing thereby the special symmetry of the roundabout test problem (see Fig. 13). A randomly-generated speed vi∈ [550; 650] knots (nautical miles per hour) is assigned to each aircraft i, i = 1, …, N, during the generation of the test-cases (for the academic roundabout test problem, the speed of each aircraft was vi= 600 knots). Following this methodology, 100 different instances were generated. Each optimization method is applied to these 100 instances in order to make an elementary statistically-valid comparative study.To compare the results of the different methods on these 100 instances, GA results are taken as a reference, as, with 10,000 function evaluations, it is expected to find a (nearly) globally optimal value f⋆ for each of these instances. Several criteria are taken into account. First, the percentage of success of the local optimization method is reported (whether it converges to a locally-optimal solution or whether it fails). The objective-value statistics (mean, median, worst, best) are taken over the 100 instance runs. For each instance, the difference in the objective-function values is calculated with respect to f⋆ when the local method converges to a feasible solution. The best (respectively worst) objective-function value differences with respect to f⋆ presented in the table correspond to instances for which fmincon and BOBYQA performed the best (respectively worst). Finally, the statistics on the number of function evaluations required to converge are displayed. The results are summarized in Table 1.The percentage of success for the local optimization methods is high. This shows that local optimization methods are a viable alternative for automatic conflict resolution. The objective-function difference reveals that a local method can even find better feasible objective function values than genetic algorithms. More precisely, fmincon obtains better results (in terms of the objective-function value) than GA in 48 instances (over the 95 solutions fmincon finds), which is very promising. BOBYQA obtains better results (again, in terms of the objective-function value) than GA for 23 instances, which is still significant. A discussion on the corresponding number of function evaluations is given below. Of course, in the remaining cases, the local methods converged to high (i.e. bad) objective-function values (local minima) when compared with GA, which is why there is a discrepancy between the median and the average of the objective-function value difference (a gap of 0.30 can be considered as significantly bad).As mentioned previously, GA performs 10,000 function evaluations here, although it finds a feasible (conflict-free) solution before. After how many function evaluations does GA find such a feasible solution? The first conflict-free solution is discovered by GA quickly (110 evaluations on average, roughly equivalent to the pure random-search starting-point strategy of fmincon and BOBYQA). However, such feasible solutions are of poor quality. In any case, the global optimum found by GA requires much more time to be found with an εfprecision (6 times the average number of function evaluations needed by fmincon, and 15 times for BOBYQA). The local optimization methods are therefore more efficient than GA for finding a feasible solution in terms of computational time for comparable quality. We remark however that GA seems to be more stable than fmincon, as it finds feasible solutions for 98 out of the 100 test cases, and the two cases where GA does not find a feasible solution, the GA solution is close to being feasible (the constraint violation is of order 10−2, when, for fmincon infeasible solution, the violation is significantly larger). However, BOBYQA is the most stable methods among these three as it always find a feasible solution.Finally, note that the number of functions reported for fmincon is strongly impacted by the fact that it relies on finite-difference constraint gradients (in N dimensions, each finite-difference gradient approximation requires N + 1 function evaluations, and gradients are needed at least once at every iteration). Indeed, the average number of iterations is only 54. Once the constraint gradients will be computed (current research work), one can expect a much lower number of function evaluations for local differentiable optimization methods.

@&#CONCLUSIONS@&#
