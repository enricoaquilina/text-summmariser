@&#MAIN-TITLE@&#
Evaluating geodesic active contours in microcalcifications segmentation on mammograms

@&#HIGHLIGHTS@&#
Microcalcification segmentation method based on geodesic active contours.Method incorporates radiologists’ knowledge in its final stage.86.9% of microcalcifications were adequately segmented.Performance satisfactory for microcalcifications larger than 460μm.Modest performance when segmenting microcalcifications smaller than 460μm.

@&#KEYPHRASES@&#
Breast cancer,Microcalcification,Segmentation,Geodesic active contours,Mammography,Radiologists’ knowledge,

@&#ABSTRACT@&#
Breast cancer is the most commonly occurring type of cancer among women, and it is the major cause of female cancer-related deaths worldwide. Its incidence is increasing in developed as well as developing countries. Efficient strategies to reduce the high death rates due to breast cancer include early detection and tumor removal in the initial stages of the disease. Clinical and mammographic examinations are considered the best methods for detecting the early signs of breast cancer; however, these techniques are highly dependent on breast characteristics, equipment quality, and physician experience. Computer-aided diagnosis (CADx) systems have been developed to improve the accuracy of mammographic diagnosis; usually such systems may involve three steps: (i) segmentation; (ii) parameter extraction and selection of the segmented lesions and (iii) lesions classification. Literature considers the first step as the most important of them, as it has a direct impact on the lesions characteristics that will be used in the further steps. In this study, the original contribution is a microcalcification segmentation method based on the geodesic active contours (GAC) technique associated with anisotropic texture filtering as well as the radiologists’ knowledge. Radiologists actively participate on the final step of the method, selecting the final segmentation that allows elaborating an adequate diagnosis hypothesis with the segmented microcalcifications presented in a region of interest (ROI). The proposed method was assessed by employing 1000 ROIs extracted from images of the Digital Database for Screening Mammography (DDSM). For the selected ROIs, the rate of adequately segmented microcalcifications to establish a diagnosis hypothesis was at least 86.9%, according to the radiologists. The quantitative test, based on the area overlap measure (AOM), yielded a mean of 0.52±0.20 for the segmented images, when all 2136 segmented microcalcifications were considered. Moreover, a statistical difference was observed between the AOM values for large and small microcalcifications. The proposed method had better or similar performance as compared to literature for microcalcifications with maximum diameters larger than 460μm. For smaller microcalcifications the performance was limited.

@&#INTRODUCTION@&#
Cancer is the name given to a group of more than 100 diseases, whose common characteristic is the uncontrolled growth of cells that can potentially invade other tissues and organs in the body, and its main types are lung, prostate, cervical, breast and skin cancers [1]. Breast cancer is the most commonly occurring type of cancer among women, and it is the major cause of female cancer-related deaths worldwide. Its incidence is increasing in developed as well as developing countries, and it accounts for around 22% of new cancer cases that are reported each year [2]. Breast cancer is also one of the leading causes of female deaths in Brazil. INCA predicted the occurrence of 57,120 new cases of this disease in 2014 [3]. Although breast cancer is more common in women, it can also occur in men. According to INCA, in 2010, breast cancer was responsible for 147 male deaths, corresponding to 1.14% of the total deaths (12,852) due to breast cancer in Brazil [2].In Brazil, death rates related to breast cancer are high, mainly because of late diagnosis, i.e., when the disease is already in an advanced stage [2]. Efficient strategies to reduce such high death rates include early detection and tumor removal in the initial stages of the disease. Clinical and mammographic examinations are considered the best methods for detecting the early signs of breast cancer; the objective of the latter is to identify non-palpable breast lesions [4].Nevertheless, several factors, such as physician knowledge and experience, equipment quality, and the presence of adipose and glandular tissues, may affect the diagnostic accuracy in breast cancer screening. Even if the mammographic procedure is carried out by an experienced technician using adequate equipment, the final mammography quality is highly dependent on the breast tissue itself; the more the adipose, the easier is the analysis and diagnosis [5]. Furthermore, the sensitivity of mammography is very low for patients younger than 40 years, because they have highly dense parenchyma, and for patients older than 70 years owing to the composition of the breast tissue beyond this age [6].In routine mammography, microcalcifications are considered as significant signs of the existence of malignant lesions, as they occur in most breast cancer cases. Microcalcifications are small granular deposits of calcium that appear in a mammogram as small bright dots. Microcalcification detection is often difficult, requiring a radiologist to carefully examine the mammogram; the microcalcifications may be hidden, especially in dense tissues [7].Despite their frequent occurrence in mammograms, only 30–50% of microcalcifications in breast carcinoma are detected via mammographic examination, whereas 60–80% are detected via histological examination [7]. The difficulty in detecting microcalcifications in mammograms is due to their variation in shape (from granular to rod shapes), orientation, brightness, and diameter, as well as the density of the surrounding tissue [8].In an effort to facilitate microcalcification detection and diagnosis, computer-aided detection (CADe) and computer-aided diagnosis (CADx) systems have been developed [9,10]. Such systems can minimize the false-positive and false-negative rates in breast cancer diagnosis, and they are usually based on parameters extracted from microcalcifications; for example: mean microcalcification area, mean microcalcification orientation, compactness, roughness, number of microcalcifications in a cluster [11,12].CADe systems allow automatic detection of lesions (including microcalcifications), whereas CADx systems are employed for classification of lesions; in general, the latter are used to provide a second opinion, thereby increasing the accuracy of a radiologist's final diagnosis [9,10,13–16]. CADx systems basically involve three steps [17,18]: (i) segmentation, (ii) parameter extraction and selection of the segmented microcalcifications and their clusters, and (iii) lesion classification. Although improvements to any of the individual steps could enhance the performance of the entire system, the segmentation step is considered to be the most important step [17–19], because it defines the characteristics of the microcalcifications to be used in the following CADx steps.Several techniques have been adopted for segmenting microcalcifications, such as active contours [18,20–22], gray-level histogram features associated with fuzzy rule-based classifiers, methods based on image entropy [23], wavelet analysis [14,24,25], and morphological filters [7,26]. More recently, researches pointed out the importance of some microcalcifications segmentation techniques with good results for this task. These researches are mainly based on active contours [17], wavelet analyses [27] and mathematical morphology [28].Arikidis et al. [17] presented a multiscale active contours method to segment microcalcifications in mammographic exams, which also employs radiologists’ intervention for manually defining a seed point to initialize the method. A ROI was defined as a square of 81×81 pixels, centered at the seed point. The authors assessed the results by comparing the obtained segmentation areas with the ones manually defined by a radiologist, and pointed out a mean value of area overlap measure of 0.61±0.15.Batchelder et al. [27] used the 2D wavelet transform modulus maxima method (WTMM) to detect microcalcifications in human breast tissue in mammograms and to characterize the fractal geometry of benign and malignant microcalcification clusters. They estimated a 3D fractal structure of a breast lesion by pairing the information from two separate 2D projected mammographic views of the same breast (cranial–caudal (CC) and mediolateral-oblique (MLO) views) and defined the “CC-MLO fractal dimension plot”, where a “fractal zone” and “Euclidean zones” (non-fractal) were defined. The authors analyzed 118 images from 59 patients (25 malignant and 34 benign) obtained from a digital databank of mammograms with known radiologist diagnostics and determined which cases would be plotted in the fractal zone and which cases would fall in the Euclidean zones. From their results, a Bayesian statistical analysis showed (with 95% credibility) that the probability that fractal breast lesions are malignant is between 74% and 98% and the probability that Euclidean breast lesions are benign is between 76% and 96%.In a previous study, we presented a semi-automatic segmentation method based on mathematical morphology (MM) and Otsu's method [28]. The method was applied to 1000 ROIs from images provided by the Digital Database for Screening Mammography (DDSM). Morphological operators were applied to enhance the image contrast between microcalcifications and background, while Otsu's Method automatically selected the best gray-level threshold to segment microcalcifications in a ROI. As a post-processing stage, a set of morphological filters was applied to fill up any small flaw in the segmented microcalcifications. Finally, two experienced radiologists (R1 and R2) independently choose, among three possibilities, the segmentation image considered as the best to elaborate a diagnosis hypothesis. In this qualitative evaluation the method proposed in [28] adequately segmented 97.8% (R1) and 97.3% (R2) of the microcalcifications presented in the 1000 ROIs with regard to the possibility of establishing a diagnosis from exactly the same ROIs. In a quantitative evaluation, the mean value of the area overlap measure was 0.64±0.14, considering as gold standard to compare with the area of the segmented microcalcifications, the manually delineated microcalcifications made by the most experienced radiologist (R1: more than 30 years of radiology practice).Also using the same database, but with only cranial–caudal images, Moradmand et al. [29] applied morphological operators and wavelet transformation to enhance the mammography images, before investigating two semi-automatic methods of microcalcifications segmentation: adaptive threshold and watershed segmentation. Although the authors did not present a quantitative result in their work, they conclude that watershed segmentation is more accurate than adaptive threshold, but is more time consuming and claim that the whole system introduces an improvement in the breast cancer detection.The geodesic active contours technique has been used to segment satellite images [30], nodules in ultrasound images [31] and for detection and tracking of moving objects [32], for example. The present work proposes, for the first time, the application of the geodesic active contours (GAC) technique in segmenting microcalcifications, evaluates its performance and compares with other works presented in literature. Moreover, the GAC is associated with anisotropic texture filtering as well as the radiologists’ knowledge. The proposed method was assessed using 1000 regions of interest (ROIs); they were extracted from images of the Digital Database for Screening Mammography (DDSM) [33]. Herein, the radiologists’ knowledge is incorporated as the final stage of the method. Their task is to evaluate the possibility of establishing a diagnosis hypothesis from the segmented images. The GAC method was evaluated qualitatively, based on the opinions of two radiologists with more than 30 years (R1) and 15 years (R2) of experience in breast radiology, and quantitatively by calculating the area overlap measure (AOM) based on the microcalcifications delineated by the more experienced radiologist, which were considered as the gold standard.The GAC method aims to minimize the contour energy, given by [34](1)Egac(C)=∫Cgσ[C(s)]ds,where C, defined asC:0,L→ℝ2, L>0, is a rectifiable curve parameterized by an arc of lengths and gσ(x, y) is a smoothing and decreasing function of the gradient modulus of an image I(x, y) on which segmentation is performed. The energy is minimized for the snake C, using the descent evolution curve of the gradient, described by(2)Ct=−δEgac(C)δ(C),where δEgac(C)/δ(C) represents the first variation of Egac.The evolution curve equation is obtained by computing the first variation of Egac:(3)Ct=−(kgσ−〈∇gσ,n→〉)n→,where k represents the C curvature of the snake. The function gσ(x, y) acts as an edge detector, whilen→is the external unit vector normal to the curve. Thus, one can obtain(4)gσ(I)=11+α||∇Iσ||2,where Iσrepresents the convolution between the original image I(x, y) and a Gaussian of standard deviation σ, which determines the smoothing that will be employed in I(x, y). The α parameter controls the contrast level over the edge used as a threshold for gradient evolution.Some filters were used in this work to reduce the background noise and enhance the contrast of the analyzed images. The basic theory of these filters is described below.The first filter applied to the original image is the contrast-limited adaptive histogram equalization (CLAHE) filter, which aims to enhance image contrast. Such filtering is performed by applying the adaptive histogram equalization function, limited by contrast. This function limits the contrast in homogeneous regions of the image, while avoiding enhancement of the noise that may be present therein. Furthermore, it operates on small regions and equalizes each of them, instead of equalizing the image as a whole. Further details can be found elsewhere [35,36].The alternating sequential filtering (ASF) technique makes use of morphological filters; it applies these filters alternately and iteratively to an image in order to reduce its background noise. The morphological operators commonly used in this procedure are the opening and closing operators, or the opening by reconstruction and closing by reconstruction operators. For example, one can proceed with some iterations by first applying the morphological opening operator, and then, the morphological closing operator, alternately. The structuring element (SE) may or may not be changed at each iteration [37]. The morphological closing operator can also be applied before the morphological opening operator. Because these two filters are not dual, they yield results that are somewhat different [37].The Gabor filter [38] is a linear filter that is used for edge detection. In the spatial domain, a 2D Gabor filter is a Gaussian kernel function modulated by a sinusoidal or co-sinusoidal plane wave; it is defined by the frequency of this plane wave and by the direction of the Gaussian window spread [39].Considering only the real part, with the Gaussian window spread equal in the x and y dimensions, one can use the following expression for Gabor filter implementation [31].(5)g(x,y)=12πσ2e−1/2((x2/σ2)+(y2/σ2))cos(2πω0x2+y2),where ω0 is the central frequency and σ represents the Gaussian window spread, with the same value for the x and y dimensions.The last filter to describe is the anisotropic diffusion filter (ADF). According to [34], an anisotropic diffusion (It) of the image (I) is defined by:(6)It=div[c(x,y,t)∇I]=c(x,y,t)ΔI+∇c⋅∇I,where div is the divergent operator, ∇ is the gradient operator, and Δ the Laplacian operator, with respect to the spatial variables, and c(x, y, t) is the diffusion coefficient. The diffusion coefficient c(x, y, t) controls the rate of diffusion, and its selection is usually dependent on the image gradient in order to preserve the edges. It may be written as c(||∇I||). Perona and Malik proposed two functions for the diffusion coefficient [40]:(7)c(||∇I||)=e[−((||∇I||)/(K))2],(8)c(||∇I||)=11+||∇I||K2,where K is a constant that controls edge sensitivity; it is experimentally selected as a function of the image noise.Eq. (7) favors high-contrast edges over low–contrast edges, while Eq. (8) favors larger regions over smaller regions in an image [40].Owing to its characteristics, an ADF can be used to remove noise in a digital image without blurring the important elements of the image (the ADF only blurs the image background, making it more homogeneous). Accordingly, an ADF may be useful in edge detection methods [40].The database used in our study comprised 158 mammograms obtained from 78 patients; they were extracted from three image sets of the DDSM database: benign_1, benign_2, and cancer_1. The images from cancer_1 and benign_1 have a resolution of 50μm/pixel, whereas benign_02 has a resolution of 43.5μm/pixel. Those different resolutions were taken into account across the whole analysis. As in the case of [11,26,41], the original images (300dpi), which were 12- or 16-bit images, were converted into 8-bit images in order to reduce the computation time. Moreover, 1000 ROIs from 20×20 pixels up to 41×41 pixels [20] were selected by the double reading procedure. First, an experienced radiologist selected the ROI, and then, another radiologist independently confirmed it. We decided to use all the microcalcifications in a ROI, provided that the size of ROI was no bigger than 41×41 pixels. This approach allowed checking the possibility of establishing a diagnosis hypothesis with the microcalcifications segmented by the proposed method. The ROIs selections were made using a program developed in MATLAB® (MathWorks Inc., Natick, MA), specifically for this task, which allowed delimiting a rectangular area in the original image with the PC mouse. The same program warned if a ROI size was higher than 41×41 pixels. In such cases, the radiologist reselected the ROI, keeping them smaller or equal to this proposed maximum size. Thus, 500 ROIs were selected from images of the benign databases (793 microcalcifications), and another 500 were selected from images of the cancer database (1343 microcalcifications). Among the 1000 ROIs, the types of benign and malignant microcalcifications observed, according to DDSM, are presented in Table 1. All the ROIs were selected from delimited regions already marked in the DDSM images [33]. Considering the mammography views, craniocaudal and mediolateral oblique, the one that best represent the microcalcifications was selected, and both views were considered in many cases.The microcalcifications were classified by their maximum diameters, following the criterion proposed by [17]. Thus, lesions (608 microcalcifications) with maximum diameters less than 460μm were classified as small lesions, whereas the remaining was classified as large lesions (1528 microcalcifications). An example of ROI extracted from a mammogram (Fig. 1a) with large benign microcalcifications is shown in Fig. 1b.The segmentation procedure proposed herein was developed using MATLAB® (MathWorks Inc., Natick, MA), and it was based on the method proposed in [31]. Originally, the GAC segmentation method had been used for segmenting nodules present in ultrasound breast images, but herein, this procedure was adapted to segment microcalcifications. The following paragraphs describe the proposed procedure and state the parameters for the different filters that are employed in parentheses. The flow chart shown in Fig. 2illustrates the entire process, which has been already adapted to microcalcification segmentation.In Fig. 2, one can observe two branches starting with CLAHE filter from the original ROI box. These two branches define the two important inputs to the GAC method: (a) the image, where the GAC gradients are determined, and (b) the initial contour that will be adapted based on the gradients. In order to determine the initial contour (Fig. 2b), the procedure involved two filters in a pre-processing step: CLAHE was applied to improve contrast (size of the regions to be equalized: 2 rows by 2 columns; contrast enhancement clipping factor: 0.1; distribution parameter: 0.1; distribution type: exponential) and the ASF was used to reduce background noise. The ASF consisted of alternating opening by reconstruction and closing by reconstruction operators (SE: disk; diameter: 2 pixels; number of iterations: 1). Next, a pre-segmentation procedure, which searches for the initial contour for the GAC method, was performed using morphological operators. First, it is necessary to identify an initialization point (seed point) within the object to be segmented in the original ROI, which is achieved with a single mouse click by a radiologist. Thus, a square, generated from the morphological dilation applied in the seed point position of the filtered image, was used as the mark image in the minima imposition procedure. This technique forces the existence of a regional minimum in the original image, in regions defined by a mark [37]. After minima imposition, the morphological opening and closing operators were applied to the image to further improve its contrast and reduce background noise. Finally, the watershed technique [37] was applied to determine the initial contour.Considering the branch defined to the input image pre-segmentation procedure (Fig. 2a), CLAHE was used again to enhance image contrast (size of the regions to be equalized: 2 rows by 2 columns; contrast enhancement clipping factor: 0.1; distribution parameter: 0.1; distribution type: exponential). Then, the anisotropic diffusion filter (ADF) guided by texture descriptors derived from the Gabor filter (Gaussian window propagation parameter: 2; frequency: 0.05 rad/s) was applied to reduce noise without blurring the boundaries between homogeneous regions [34]. A two-dimensional network structure with eight neighboring nodes (control points) was used for conducting the diffusion (number of iterations: 50; integration constant: 1/7; border sensitivity constant: 2; diffusion coefficient: Eq. (8)).Then, energy minimization of the object border was performed according to Eqs. (1)–(4) in order to identify the microcalcification contour (maximum number of iterations: 300; smoothing curvature parameter (SCP): 0.5, 1.25, and 2.0). As SCP is the main parameter that affects the GAC performance concerning structures of different sizes, three SCP values were adopted to segment microcalcifications with different sizes. Hence, three segmented images are generated, one for each value of SCP.Tests were performed in 20 pre-selected ROIs containing microcalcifications of different size, shape, orientation, and brightness in order to define the parameters used in GAC method, which were modified in relation to their original values, as described in [31]. For each parameter, 21 values centered on the original value (at intervals of ±10%) were tested. The values that provided the best segmentation of the 20 tested ROIs were selected on the basis of the opinion of an experienced radiologist.Finally, for each of the 1000 selected ROIs, a figure showing the original ROI along with three segmented images, generated by the application of the three before mentioned SCP values in the contour energy minimization step, was created; this figure contained the microcalcification contour candidates. At different moments, the figures were randomly and separately presented to each of the radiologists, one at a time. Among the three images segmented, the best option for elaborating an adequate diagnosis hypothesis was to be selected by each radiologist. If a radiologist was not able to elaborate a hypothesis with any of the segmented images, then none of them was considered adequate. Note that the entire segmented ROI was considered for a radiologist to establish the diagnosis hypothesis, i.e., if the microcalcifications in the ROI were adequately segmented in a radiologist's opinion, the results were considered adequate, regardless of the number of microcalcifications; otherwise, they were considered inadequate.It is important to highlight that this last step of the proposed procedure makes use of the radiologists’ knowledge. In a real clinical situation a gold standard will not be available, and in some cases the segmentation result can be inadequate. Hence, the radiologists’ intervention is an important step on the proposed procedure.Fig. 3shows the images obtained in each step of the proposed procedure. In this example, the SCP value is 0.5. Note that in the implemented program, the image gray-level was inverted before processing (Fig. 3c). Thus, the image characteristics would be closer to those generated by ultrasound, for which the method was originally designed.In this work, the results were evaluated using qualitative and quantitative criteria. The proposed method was qualitatively evaluated on the basis of the opinions of two radiologists with more than 30 years (R1) and 15 years (R2) of experience in breast radiology, and it was quantitatively evaluated by the AOM approach. It is known that evaluation based on the opinions of radiologists is highly subjective and dependent on the experience of the radiologists. The same can be said about manual contour design, which is considered difficult because of the small size of the calcifications [10]; thus, a radiologist might delineate contours with less detail than what can be perceived visually. The two evaluation procedures were carried out in order to minimize subjectivity, as they are considered complementary.As previously mentioned, two experienced radiologists choose the best segmentation for elaborating an adequate diagnosis hypothesis. The qualitative assessment was based on these choices. Although the evaluation method is operator-dependent, according to [12], radiologists’ opinions are well accepted for evaluating segmentations methods. A similar approach was followed in [42]. However, in that segmentation method, six different boundaries were determined by an algorithm and presented to the radiologists. The radiologists had to select the most accurate delineation, and if necessary, modify the boundaries to adjust the segmentations. In the method proposed herein, only three possible segmentations were presented to the radiologists, and they were not allowed to modify the boundaries.The performance of the quantitative evaluation was independent of the qualitative evaluation. The more experienced radiologist manually delineated (i.e., segmented) the 2136 microcalcifications of the 1000 selected ROIs, and these contours were considered as the gold standard for calculating the AOM, expressed as [17](9)AOM=area(M∩R)area(M∪R)⋅In this equation, M denotes the microcalcification manually delineated by the radiologist and R represents the segmentation obtained using the proposed method (i.e., the one considered by the radiologist as the best option for elaborating an adequate diagnosis hypothesis). The symbol ∩ denotes intersection, i.e., the number of pixels common to both segmentation procedures, and the symbol ∪ represents the union of the M and R areas. Hence, if there is no overlap between the delineated microcalcification and the one from the proposed method, AOM=0. For a complete overlap, AOM=1.The Wilcoxon non-parametric statistical test for paired data (Wilcoxon two-sided rank sum test, p<0.05) was performed to determine whether there were significant differences between AOMs obtained from benign and malignant microcalcifications, as well as between those obtained from small and large ones.

@&#CONCLUSIONS@&#
The originality of this work resides in two points: (1) the geodesic active contours (GAC) technique associated with anisotropic texture filtering to segment microcalcifications in mammography; and (2) the contribution of the radiologists’ knowledge incorporated in the final stage of the segmentation method. In this method three different SCP values are employed in the energy minimization step. For each ROI, three segmented images (one for each SCP value) are presented to a radiologist, who selects the best option for elaborating an adequate diagnosis hypothesis. The proposed method had better or similar performance as compared to literature for microcalcifications larger than 460μm. For smaller microcalcifications the performance was limited. However, based on the radiologists’ knowledge, the achieved segmentation result would be adequate to perform a diagnosis hypothesis in at least 87.4% (437/500) of the malignant cases and 86.4% (432/500) of the benign ones. Then, one may suppose the proposed segmentation procedure associated to radiologists’ knowledge as feasible, foreseeing a clinical application.