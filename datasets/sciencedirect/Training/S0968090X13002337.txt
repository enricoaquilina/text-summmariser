@&#MAIN-TITLE@&#
A spatio-temporal approach for identifying the sample size for transport mode detection from GPS-based travel surveys: A case study of London’s road network

@&#HIGHLIGHTS@&#
Sample size for transport mode detection studies from GPS data using coefficient of variation CV.Sample size depends on mode of transport, temporal granularity and spatial extent of the study.Sample size based on the geographic extent (London’s Transport Doughnut zones).Sample size based on the temporal extent (defining seasonality and temporal periods).Sample size based on the mode of transport (walk, cycle, bus and car).

@&#KEYPHRASES@&#
Mode of transport,GPS,Inference,Sample size,Spatio-temporal,

@&#ABSTRACT@&#
Compared with conventional household one/two days travel survey, GPS-based travel surveys hold many attractive features for travel behaviour studies. Different machine learning-based techniques have been developed to infer the transportation mode based upon GPS data from such surveys. However, nearly none of these studies calculate the sample size required for validating these techniques. Since different surveys target different study areas for different temporal periods and different travel modes, identifying sample sizes for all transport modes at different spatio-temporal granularities is of imperative urgency given the high time and financial costs of GPS-based travel surveys. Here we use road network journey time data of London to calculate appropriate sample sizes for travel surveys designed either for a specific period-of-the-day, day-of-the-week or month-of-the-year. We also use different transportation analysis zones (central, inner and outer London) to demonstrate the spatial variability of the data over these different survey durations. Then we finally calculate and analyse the range of required sample sizes for different travel modes within these spatio-temporal granularities. This case study provides a good reference of sample size design for GPS-based travel survey in big cities.

@&#INTRODUCTION@&#
Travel surveys are one of the most important ways of obtaining critical information needed for transportation planning and decision making. These surveys gather current information about the demographic, socioeconomic, and trip-making characteristics of individuals and households (Bolbol et al., 2012). Nevertheless, they are also used to enhance our understanding of travel in relation to the choice, location, and scheduling of daily activities. This enables us to enhance our travel forecasting methods and improve our ability to predict changes in daily travel patterns in response to current social and economic trends and new investments in transportation systems and services. These travel surveys also play a role in evaluating changes in transportation supply and regulation as they occur (Griffiths et al., 2000).Traditionally, travel surveys used to be conducted using different methods such as telephone and face-to-face interviews and computer-based reporting to maintain a diary (Stopher and Greaves, 2007). These have proven to be a burden for participants to use as well as being expensive and time consuming (Stopher and Metcalf, 1996). Later, a new trend emerged as to use GPS devices in conjunction with traditional surveys (Stopher, 2008). Although using GPS devices might introduce an element of bias in a participant’s behaviour, however, their usage has proven to minimize trip under-reporting through improved survey methods (Bricka and Bhat, 2006). GPS-based surveys were also found useful for exact time and destination recording and capture of trip underreporting (Wolf et al., 2003; Schönfelder, 2006). Such surveys are used to produce various analyses such as travel time, modal split, discrete choice and trip distribution models (Ortúzar and Willumsen, 2011). These analyses include measuring variables such as traffic congestion (Bachman et al., 2012), properties of mode of transport, length of stages, journey time, purpose of the journeys (DfT, 2011), and so forth.Although prompt recall surveys could be used to improve the accuracy of GIS-based survey, they are still proved to be expensive, time consuming and burdensome. Many research groups tackled this problem by attempting to infer travel information from the GPS data automatically (Liao et al., 2007; Zheng et al., 2008; Bolbol et al., 2012). Among these types of information is the transportation mode (e.g. cycle, walk, bus and so forth). This inference would eventually replace or complete a lot of the feedback required by participants when labelling and tagging their travel diaries.Calculating the minimum sample size is an important consideration for this kind of inference models, and depends very largely on these investigated variables (Ortúzar and Willumsen, 2011). For conventional one-day or two-day travel surveys, sample size procedures are well known and widely applied; for example, the Travel Survey Manual by Cambridge Systematics (Tierney et al., 1996). The corresponding sample size procedures for GPS-based panel surveys however, are less well developed. One of the few studies tackling this problem is Xu (2010), where it develops a framework to estimate the effective sample size of GPS-based panel surveys in urban travel behaviour studies for a variety of planning purposes. The study attempts to obtain reliable means for key travel behaviour variables such as demographic characteristics and seasonal factors, using data from only 95 households. Stopher et al. (2008) also attempts to find the best threshold between the minimum sample size and the least sampling period. The study analyses hypothetical and actual multi-day data on person kilometres travelled (PKT), trips, and daily travel time for about 70 persons living in Adelaide, Australia and a second sample of about 500 persons also living in Adelaide. However, there are no studies, to the knowledge of the authors, which calculate the sample size for GPS-based travel surveys taking into consideration the modal, spatial or temporal granularities of the designed study.The aim of this work is to provide an insight on the process of sample size calculations for travel surveys depending on the intended modal and spatio-temporal scope of the study. Here we provide the means to calculate the sample size for transportation mode inference studies, for different spatial analysis zones at different temporal granularities. The calculation is based on the value coefficient of variation (CV) of the variable under investigation. The CV measures how “variable” a variable is relative to its average value. The variability is primarily calculated for different modes. For motorised modes, we use data provided by Transport for London (TfL) from their London Congestion Analysis Project (LCAP) project obtained from Automatic Number Plate Recognition (ANPR) cameras (Haworth et al., 2013; Tsapakis et al., 2013). We study the speed variation within an urban environment such as London across daily periods, days and different months taking seasonality into account. We also compare these different temporal granularities within the different spatial extents of any designed survey. Therefore, we use TfL’s doughnut zones for London (Central, Inner and Outer) as a geographical division to measure the impact of varying the location of the survey on the required sample size calculation. Also, for non-motorised modes, outcomes from other studies are used to assign a rough calculation and hence draw comparisons with motorised data variability calculations.In this section we discuss the process of identifying the sample size for studies aiming at detecting the modes of transport from GPS data. In order to perform this calculation we need to clearly define the independent variables involved, which in our case is speed calculated from GPS data. The most important factor that the calculated sample size depends on is how variable speed is in the study area, which in our case is London. The reason that we use London as a case study is because it represents an example of a highly complex urban environment with many different transport networks and distinct movement characteristics.Estimating the sample size adequate for whichever survey type requires good knowledge of: (1) the variables under investigation, (2) their coefficient of variation (CV) and (3) the desired accuracy of measurement together with the level of significance associated with it (Smith, 1979).The first element in the sample size calculation process is identifying the variables to be used in the study. In recent work of ours, we have conducted an ANOVA test on different Independent Variables (IV) derived from GPS data to identify which IV best discriminates between different classes of modes of transport (Bolbol et al., 2012). The outcome of the evaluation identifies the best IVs to be used for the classification as speed and acceleration. The chosen variables can also be anything that the survey is conducted to measure or to use in its analysis, but as a case study in this paper we will use speed to demonstrate the calculation process.The second element of the calculation process is the coefficient of variation (CV) of the chosen IVs, where the sample size depends largely on how much the variable deviates from its mean. The CV is a normalized measure of dispersion of a probability distribution, or a statistical measure of the dispersion of data points in a data series around the mean. It is calculated by dividing the standard deviation (σ) by the mean of the population (x¯) as shown in Eq. (1).(1)CV=σx¯*100The third element is the accuracy desired (and significance level) where the accuracy level is the percentage error acceptable to the analyst. Both the accuracy and the significance level are context-dependant elements to be decided by the analyst according to the analyst’s experience (Ortúzar and Willumsen, 2011). Once these three factors are defined, the sample size (n) could be computed from Eq. (2) as stated by Richardson et al. (1995) and Ortúzar and Willumsen (2011) for continuous variables such as speed.(2)n=CV2Zα2E2where E is the level of accuracy (the margin of error for the estimate ofx¯) and Zα is the standard normal distribution quantile value for the confidence level (α) required (Ortúzar and Willumsen, 2011; Richardson et al., 1995). A normal random variable X will exceedx¯+σZαwith probability 1−α; and will lie outside the intervalx¯±σZαwith probability 2(1−α). In this research, we use the quantile Z0.90 which corresponds to a value of 1.645; therefore, a normal random variable will lie outside the intervalx¯±1.645σin only 10% of cases.The coefficient of variation of speed could be computed from speed data available from different resources available to this research. However, we need first to consider the different categories/classes (modes of transport) to be used in this calculation, where different modes will have different variability in terms of the speed used. An example could be the difference between walk and car modes, where different car drivers in the population would drive in different manners and speeds, whereas pedestrians would be more constrained in terms of speed variability. Hence, the inter-modal variability will be quite high, while the intra-modal variability would be relatively low but varying depending on the mode type. Nevertheless, since the CV is calculated by dividing by the average speed, the walk mode might have a higher “relative” variability. On the whole, there is a need to calculate the CV for different modes separately. This will be further discussed in Section 3.The speed would also vary differently according to both: different temporal (seasonal) periods of the study, that being; hourly, daily or monthly, and spatial zones where the survey is being planned. Examples of these scenarios might vary from a survey aiming to study city centre pedestrian activity over certain hours of the day to a study of bus trips within urban outskirts over a year. Therefore, in the following section (Section 3) we attempt to quantify the CV for the different modes of transport, temporal granularities and spatial zones, and analyse the impact of varying these survey scopes. Hence, we quantify the sufficient sample size for different surveys targeting a range of spatio-temporal combinations by applying a case study of the City of London.In this section, we will consider calculating the CV of speed in order to calculate the sample size needed for each mode of transport separately. The train and underground modes however should theoretically have the lowest variation since they run according to schedules and their networks are more controlled and therefore not very much congestion-affected. Moreover, since they travel at high speeds, their CV will be very low compared to other modes, and hence their sample sizes rather insignificant relative to the rest. This means in turn that other modes such as motorized and un-motorized vehicles using a road network should have more variation in their speed values; being affected by external factors such as congestion, number of lanes, road classification, and precipitation. This as a result would lead to the need of a higher sample size for other modes and therefore we will ignore calculating that of train and underground modes. Furthermore, the underground mode will acquire very few GPS fixes (if any) to be a significant phenomenon to measure.Thompson et al. (1997) conducted a study on the typical cyclist speeds in a recreational population from self-reported speeds in Washington, US. The mean speed across genders and different age groups was found to be 4.11m/s with a standard deviation of ±1.16. As for London, TfL (2010) has compiled a report on cycling analysis finding an average cycling speed in London of 4.17m/s with around a standard deviation of ±1.15. The reason for the low standard deviation is that cyclists in London are only slightly affected by varying congestion levels along the day. These figures mount to a calculation of a CV of 28% by applying equation 1 as shown below.Coefficient of Variation(Cycle)=CV=1.15/4.17=0.28By applying Eq. (2), a sample size of 85 participants is found as a requirement for testing a cycling population, assuming a standard normal value Zα (Z0.90) of 1.645 for a confidence level (α) of 90% and a level of accuracy (E) of 0.05.Sample Size(Cycle)=n=(0.28)2*(1.645)2/(0.05)2=85participantsPublished in another research aimed at studying Pedestrian Level of Service design and impact on the quality of pedestrian life, Weidmann (1993) obtained a normally distributed average speed of 1.34m/s and a standard deviation of 0.26 (CV=19%) for pedestrians walking on the street (Bloomberg and Burden, 2006). Another study measured walking speeds in different age groups, with an average speed of 1.51 and 1.25 for younger and older pedestrians respectively and a standard deviation of ±0.25 in both cases, leading to CVs of 17% and 20% (Knoblauch et al., 1996). The study included a total of 7123 participants from all age groups. Similarly, by applying Eq. (2), this would result in a sample size of around 40 participants.This leaves us with the car and bus modes. These two modes are the two main motorised modes of transport that use the road network. The complexity of the road network and of the temporal variation in congestion dictates how difficult it is to detect the speed variability within such a network. The case of these two modes is more complex than that of walking and cycling because of the fact that they are motorised and hence varying in speed massively. They also obey the road network restrictions, unlike walking and cycling where the urban setting does not restrict the speeds as much. The following subsection discusses the nature of these modes and their associated speed variations.Yet the most problematic and variant modes are the motorised vehicles due to the road network constraints that govern vehicle movements and hence largely dictate speed variability. To obtain an accurate understanding of speed variability in the context of London, we use journey time data collected by Transport for London (TfL). In this subsection, we provide a brief description of the dataset used, together with the mathematical model adopted to calculate a weighted sample size leading to obtain more accurate figures. We analyse then the spatio-temporal variability of the calculated speeds, and hence, a sample size based on different spatio-temporal dimension.We use the LCAP data provided by TfL to study the speed variability of these vehicles. The data consists of journey times for each network link, and is by far the best resource for understanding traffic congestion and speeds within London. The dataset consists of daily journey times for every link every 5min by identifying vehicles at the beginning and the end of each link using ANPR cameras. This system provides continuous journey time information for key routes in London (676 road links with an average link length of 2600m). Fig. 1shows these LCAP links that are measured within London along with a geographical division of the city into doughnut-shaped zones defined by TfL. Tsapakis et al. (2013) and Haworth et al. (2013) discuss the dataset in more detail for further reference.The chosen data period is for 2009, and hence, the data was queried for an entire year of 2009 (365days) and aggregated according to each link per different time durations of the day per the day of week per month. The data could be divided into two categories, assuming the bus lane user category is restricted to the bus mode while the non-bus lane user is restricted to the car mode.One might argue that using such data to calculate the number of individual participants needed for mode of transport detection studies ignores the normal assumption of statistics that observations, such as that of the TfL data, are independent, while if a person provides measurements for multiple days (or time periods, or months), the observations are no longer independent. In fact, one person may repetitively use the same route on multiple days and is, in any case, geographically limited to a particular part of the urban area. As a result, observations from multiple time periods will violate the assumption of independence. However, we argue that individuals moving using vehicles or buses are still correlated to the congestion levels at each given point in space and time. Therefore, in this work, we divide the sample size calculation geographically to customise the calculation based on the sample’s travelling zones. We also divide the calculation based on time periods to account for the correlation based on the congestion levels at different times.An average could be calculated for the speed data for each of the bus lane and non-bus lane categories, however, all links are treated equally regardless their length. Therefore, a rather more realistic figure would be calculating the weighted average of the speed using each link’s length using Eq. (3).(3)x¯w=∑i=1Nlixi∑i=1Nliwherex¯wis the weighted average, liis the length of road link i, xiis the speed of link i and N is the total number of links. In order to calculate the CV, we need to calculate the standard deviation associated with these speeds. Traditionally, we would use the following formula to perform this calculation:(4)σ=∑i=1N(xi-x¯)2N-1where σ is the standard deviation for a population sample and thex¯is the sample’s average. However, to calculate the weighted standard deviation σwthe following formula could be used:(5)σw=∑i=1Nli2σi2where liis the length of link i and N is the number of non-zero weights. The CV then becomes the following:(6)CVw=σwx¯w*100wherex¯wis the weighted mean of the speeds calculated from Eq. (3) and the CVwis the weighted coefficient of variation computed from the division of the weighted standard deviation σwby the weighted meanx¯w. And then Eq. (2) becomes:(7)n=CVw2Zα2E2where the sample size becomes based on the weighted mean of the calculations. The difference between the weighted and un-weighted means is illustrated in Fig. 2for car and bus categories in each of the three doughnut zones of London. As might be noted, the weighted means are slightly higher than the un-weighted means for bus and non-bus lane users. The difference between weighted and un-weighted means is due to that longer links are given higher weights while containing higher speeds (such as in the case of motorways). This exaggeration of the speed values of longer links eventually leads to the increase of the overall weighted mean of speed.The next step is to identify different speed variability values according to different spatio-temporal combinations (Inter-daily, daily and monthly for the 3 London analysis zones). In the rest of this section, we compare these combinations by calculating the intra and inter temporal CVs of each the bus lane and non-bus lane users for each spatio-temporal granularity. We will then use the each relative variability to apply it to Eq. (7) to identify the sample size required for each of these two modes. The results of the sample size calculations are presented later in Section 4.Table 1illustrates the results calculated for intra-hourly variability aggregated into significant periods of the day (identified by TfL) for bus lane users (assuming bus mode) and non-bus lane users (assuming car mode). Fig. 3illustrates the weighted average speed values by different time intervals along the day for the aggregated data period for both categories. It could be noted how differently the speed varies from relatively low speeds in the earlier half to the lowest values at the pm peak period of the day raising up again at the evening, night and pre-am periods again. One could also note that the difference in speed between cars and buses increases significantly in the late part of the day highlighting the fact that buses will not exceed certain speeds even in low congestion periods, being restricted by stoppage at bus stops and vehicle-acceleration limitations. The average intra-hourly variation is shown to be around 52% and 50% for bus lane and non-bus lane users respectively as shown in Table 1. The overall inter-hourly variation however could be calculated from the average speeds giving 10.34% and 13.26% for each group respectively.Fig. 4also demonstrates the difference between bus lane and non-bus lane users in the form of box plots for different time intervals within the day along different days of the week. It could be noted that on Saturdays and Sundays the average weighted speed increases notably especially in the AM period, which illustrates the significance of this temporal granularity. It also seems that only the night period for either mode on weekdays have slightly higher speed values compared to the weekends. One might also note that at congested periods during the day, the speed of cars is less variant than of buses. This reflects that during busy times, some bus lanes might be relatively free and others busy, while for non-bus lanes, most of them are similar in congestion levels.The intra-daily variation and average speeds are presented in Table 2. The inter-daily variation can also be calculated from the table to give 3.36% and 4.05% for bus and car modes respectively.Fig. 5illustrates the inter-monthly variation for different periods of the day over different geographical analysis zones of London. It could be noted that the night and pre-am periods contain the highest speed values for both cases, while the pm period contains the lowest speed values due to peak hour congestion. There also seems to be a spike in August where values go a little higher expressing less congestion which could be attributed to holiday season, while having the opposite effect in November. This could inform us that some intra-monthly variation exists; however, we further discuss this in Section 4. One might also note the difference in average speed levels from one zone to another in London; highlighting how high they can go in outer London and how low they might decrease to in central London. Also, the space between the daily time intervals increases as we move from central to outer London. This suggests that as we move towards outer London the significance of the time of day on speed levels is amplified. It also seems that the difference in speed between buses and cars slightly increases as we move towards outer London.On the other hand, Table 3illustrates the intra-monthly temporal variability for both user types all through the year. From the table, an average inter-monthly variation of 1.43% and 1.75% for bus and car modes respectively; which is less than any other granularity.

@&#CONCLUSIONS@&#
We use journey time data for London to calculate appropriate sample sizes for studies that aim to infer the mode of transport from GPS-based travel surveys. The sample size required will depend on the mode of transport, temporal granularity and the spatial extent of the study. Therefore, we start off by measuring the variability of different modes that use the road network. The study demonstrates that motorised modes require by far a larger sample size since they comprise of a higher variability, where overall sample sizes required for walk, cycle, car and bus modes were 40, 85, 289 and 271 participants respectively. As a result, we analyse the intra-modal speed variability of the motorised mode data within London (car and bus) in the spatio-temporal domain.We calculate hourly, daily and monthly variability for three spatial analysis zones of London (central, inner and outer), as defined by Transport for London (TfL), to calculate the sample size for each spatio-temporal combination for both bus and car modes. On the whole, the bus mode appeared to require a larger sample size for surveys in all zones except outer London, which requires nearly equal sample sizes for both car and bus modes. Temporally, we have also concluded that the smaller the temporal granularity the larger sample size required (e.g. a survey of a certain period of the day). For that reason, it might be advantageous to conduct temporally-longer surveys which will also reduce the effect of seasonality. Spatially, surveys targeted for outer London were shown to require a higher sample size than central and inner London for the car mode. Conversely for the bus mode, surveys targeted at central and outer London equally require the highest sample size except for peak-hour-surveys in central London which require as much as double the sample size required for outer London.The work carried out in this research can be used as a conceptual reference for identifying the sample size for studies aiming at detecting the travel modes from GPS-based travel survey at specific zone and time of day/month/year within London. Given the availability of any type of traffic datasets that cover an adequate spatiotemporal extent for any another city, this work can be used as a guiding reference for detecting the adequate sample size for this type of travel surveys for speed-related purposes. The study could also be used in conjunction with other studies that attempt to minimise that sample size required by extending studies to several temporal waves. This study could also be further applied to walking and cycling modes in the spatio-temporal domain, if the relevant data was made available.The study could also be extended to inform Field Operation Tests (FOT) or Naturalistic Driving Studies (NDS) on the appropriate sample sizes for such studies (FOT-NET, 2012). This extension can incorporate other geographic information such as landuse and Points Of Interest (POI) for different spatial zones in order to get higher sample sizes for underrepresented surrounding environmental conditions. Other relevant information can also be incorporated such as the types of vehicles using (or allowed to use) the road links at different spatiotemporal study periods. The calculation will then have more variables than just the speed to account for studies that assess phenomena such as the relationship between driver-, vehicle-, and/or environment factors with crash risk.