@&#MAIN-TITLE@&#
Prediction of facial deformation after complete denture prosthesis using BP neural network

@&#HIGHLIGHTS@&#
BP neural network is used to predict feature positions on facial model.The deformation of facial model is simulated using Laplacian deformation technique.This method can predict facial deformation quickly and accurately.CT scan is not necessary.

@&#KEYPHRASES@&#
BP neural network,Laplacian deformation,Complete denture,Soft tissue simulation,Feature Template,

@&#ABSTRACT@&#
With the accelerated aging of world population, complete denture prosthesis plays an increasingly important role in mouth rehabilitation. In addition to recovering stomatognathic system function, restoring the appearance of a third of the area under the face has become a great challenge in complete denture prosthesis. This study analyzes the interactive relationship between the appearance of a third of the area under the face and complete denture, and proposes a new method to predict facial deformation after complete denture prosthesis. Firstly, to improve computational efficiency, the feature template is constructed to replace the deformed facial region. Secondly, a forecast model of elastic deformation is constructed using BP neural network and predicts elastic deformation amount because of the inhomogeneous, anisotropic and nonlinear material properties of soft tissue. Finally, a new feature template is calculated using deformation amount, and the deformation of preoperative model is simulated using Laplacian deformation technique. The average error rates of different hidden layer nodes in the neural network are analysed. Deformation and postoperative models are superimposed for match analysis. Experimental results show that this method can predict facial soft tissue deformation quickly and accurately.

@&#INTRODUCTION@&#
The complex process of complete denture prosthesis includes many treatments and testing steps. Complete denture prosthesis mainly targets edentulous patients, which not only improves function but also restores the appearance of the face. The optimum operation scheme is developed before operation to produce the best results. Delicate surgeries require doctors to develop treatment plans, which integrate clinical examination, dental cast and cephalometry. The doctors must predict the facial aesthetic and facial soft tissue changes of the patients after operations. Currently, the prediction of facial deformation depends on the subjective judgments and experience of doctors, but this process lacks scientific quantitative analysis.In the past years, many scholars employed quantitative facial analysis after maxillofacial surgery [1,2]. Many studies on facial soft tissue modelling have been conducted, and they are classified into three categories, namely, mass-spring model (MSM), finite-element model (FEM) and mass-tensor model (MTM). MSM was initially accepted for face animation because of its well-known physics and computational efficiency. Koch et al. [3] reconstructed facial model and skull model according to CT data. They constructed MSM between facial and skull models for deformation simulation. Keeve et al. [4] constructed MSM with prismatic element and compare its precision with FEM. Teschner et al. [5] computed the state of equilibrium of soft tissue by using multilayer nonlinear MSM. FEM has high precision, but requires long calculation time. Sarti et al. [6] used a super computer to compute voxel-based FEM. Zachow et al. [7] proposed fast tetrahedral elements for FEM and applied the model in clinical practise. Gladilin [8] applied FEM to the simulation of facial muscles. Chabanas et al. [9] reduced the pretreatment time with a mesh morphing algorithm to prepare FEM. Many studies optimised computing strategies and models [10–12] because of the substantial and long calculation time of FEM. MTM was developed to balance calculation speed and precision. Mollemans et al. [13] applied MTM to soft tissue simulation for maxillofacial surgery. They reconstructed the facial and skull models by using CT data and then simulated the displacement of skull and facial deformation. MTM is a combination of FEM and MSM. On the one hand, MTM has the biomechanical relevance of FEM. On the other hand, MTM retains the easy architecture of MSM. Patients require CT scans to analyse the soft tissue model to determine the boundary conditions of the model. This procedure could affect the health of patients.Artificial neural networks (ANNs) have been widely applied to complex system modelling and are particularly suitable to problems that involve the manipulation of multiple parameters and nonlinear interpolation. BP neural network is a typical ANN, which can implement any complex nonlinear mapping functions. Scott et al. [14] predicted the material properties of ceramic using ANNs. Suganthi et al. [15] applied BP neural network to predict the multiple quality responses in micro-EDM operations. Oktem [16] constructed BP neural network model for surface roughness prediction. Models of the diffusion of oxygen through mixed ionic conductors have provided accurate predictions of the diffusion coefficient [17]. ANNs have provided accurate predictions in the performance of materials with highly complex behaviour [18,19]. However, ANNs have not been applied in facial deformation prediction research.No current studies have analysed the prediction of facial deformation after complete denture prosthesis. This paper proposes a new facial deformation prediction method after complete denture prosthesis. This method has high computational efficiency and good predictive accuracy and does not require CT scan. Preoperative and postoperative models of 48 patients were obtained from doctors. The feature templates containing several feature points were designed to replace the deformed area of facial models. They also improved the computational efficiency. The transformation from preoperative to postoperative models must be examined with BP neural network. Then, BP neural network was applied to construct the nonlinear elastic prediction model of soft tissue. Forecast output data can be obtained through elastic prediction model. According to the forecast output data, the deformations of preoperative models were simulated using Laplacian deformation technique.This study aims to predict the facial deformation of a patient after complete denture prosthesis and to provide the constraints related to the digital arrangement of artificial teeth in the complete denture. The proposed method in this paper is prepared for the digital design and manufacturing of complete denture. The traditional production of complete denture requires skilled technicians, high treatment costs, and long production cycle. A CAD/CAM (Computer Aided Design/Computer Aided Manufacturing) system can assist the completion of manual arrangement and wax production by using a computer and a rapid prototyping technology. A 3D model of the edentulous mould is obtained through scanning. Then critical features are very necessary to provide the basis of tooth-arrangement and the constraints on the spatial position and posture of complete denture. The fullness constraint surface is one of the most important features of complete denture production, as shown inFig. 1. The completely arranged artificial articulation is related to the fullness surface and satisfies individualised needs. The fullness constraint surface, which is the inner surface of the skin, is ratiocinated by the prediction of facial deformation of a patient after complete denture prosthesis.The models used in this paper were supplied by the Department of Orthodontics, School of Stomatology, Peking University. A total of 48 edentulous patients agreed to participate in this research. Preoperative and postoperative models of each patient were acquired. Face Scan (3D SHAPE, Germany) was used to obtain the models (scan time: 0.3/0.8s; scan accuracy: 0.1mm). Finally, preoperative and postoperative facial 3D point cloud data of 48 patients were collected.The main work of this study is to predict the facial deformation of edentulous patients after complete denture prosthesis. The overview of our simulation pipeline is depicted inFig. 2. The work flow includes the following steps:(1)Model matching. According to the positions of the eyes and nose, ICP-based registration can be performed between preoperative and postoperative models.Constructing feature templates. Feature templates are constructed for the preoperative and postoperative models and consisted of several feature points.Constructing elastic deformation prediction model. BP neural network can be trained using feature templates. Thereafter, BP neural network becomes an elastic deformation prediction model.Prediction and simulation. According to the output data predicted by elastic deformation prediction model, the deformation of preoperative model can be simulated using Laplacian deformation technique.Validation. The computed facial appearance is qualitatively and quantitatively compared with the real postoperative model. The average error rates of a different number of hidden layer nodes of neural network are analysed.3D face scan data have considerable differences. The vertices among the models have no corresponding relationship and the number of vertices contradicts the number of triangle meshes. The feature template is constructed to replace the deformed facial region to allow manoeuvrability of data, to improve the calculation efficiency and to simplify the point cloud models.Before constructing the feature template, ICP-based registration is performed between preoperative and postoperative models according to the positions of the eyes and nose, as shown inFig. 3.The feature template is constructed as shown inFig. 4(b). The main steps include the following:(1)The maximum point A (Fig. 4(a)) in the Z direction is founded in the coordinates, as shown in Fig. 3.The vertical isoline across point A in the Y direction is shown in Fig. 4(a). According to the contour curvature, the feature points under the nose and on upper lip part are located and labelled as points 1, 3, 4 and 5. The contour curvature is expressed by mean curvature(1)H=1n∑i=1nKii=1,2,…,n(2)Ki=2∙(pj−pi)∙n⃑(pj−pi)∙(pj−pi)whereHis the mean curvature;nis the number of points in one ring neighbourhood ofpi;piis the centre point;pjis the point in one ring neighbourhood ofpi;Kiis the curvature of the surface betweenpiandpj; andn⃑is the normal vector atpi. The middle point 2 between points 1 and 3 is computed, and the symmetric points 6 and 7 of points 1 and 2 are relative to point 4 in X and Y plane.The horizontal isoline across point A in the X direction can be obtained. According to the contour curvature, the feature points E and F on both sides of the nose are located. Similar to the middle point G between points A and E, the middle point H between points A and F is computed.Similar to step (2), the vertical isolines across points E, G, H, F in the Y direction are obtained. The feature points are located according to the contour curvature. Finally, the feature template comprising feature points 1–29 is collected (Fig. 4(b)).Human skin tissue is a heterogeneous material. Its mechanical properties include nonlinearity and anisotropism. BP neural network can express complex, nonlinear and uncertain systems.In this paper, BP neural network is used to obtain the relationship between elastic deformation and the feature template of the preoperative model. The facial elastic deformation prediction model can be constructed.BP neural network is a feedforward neural network. The main characteristic of this network is that the signals are transmitted forward, and the errors are transmitted in reverse. Hecht-Nielsen [21] proved that three layers of feedforward network with one hidden layer can approach any multivariable polynomial function. Therefore, the three layers of BP neural network are used to predict the amount of elastic deformation in the preoperative model. The topology of BP neural network is shown inFig. 5.Fig. 5 shows that{X1,X2,…,Xn}are the input data of BP neural network.Xi(i=1,2,…,n) preserves the coordinates of feature points on the preoperative model.{Y1,Y2,…,Yn}are the predicted values.Yi(i=1,2,…,n) preserves the displacements of corresponding feature points from preoperative to postoperative model, also known as amount of elastic deformation. The number of neuron of input layer is the same as that of the output layer at 29.ωijandωjkare the weights of the BP neural network.The node transfer function of neuron in the hidden layer is the tangent transfer function(3)f(x)=1−e−x1+e−xThe space partition of different samples is achieved. The node transfer function of neuron in output layer is linear transfer function. The initial weights are the key trigger for the local minimum and the convergence in the training because of the nonlinear mapping relationship between input and output. Therefore, the initial weights are even-distributed empirical decimal. L–M algorithm (Levenberg–Marquardt algorithm) is chosen to update and compute forωijandωjkbecause L–M algorithm has fast convergence speed. Nonlinear mapping between input and output can be realized. The training of BP neural network is shown inFig. 6.The completely trained BP neural network is the prediction model of nonlinear facial elastic deformation and has the ability to predict the elastic deformation of preoperative model.The required deformation is obtained by moving many control points in the facial point cloud data. If one control point is moved, then new coordinates for every point in the point cloud data must be computed, and the calculation burden is too heavy. The ideal method is to calculate the relevant points after moving all control points to the specified location.Elastic deformation prediction model predicts the amount of elastic deformation, in which feature points in preoperative models move, that isYi(i=1, 2,…, n). The new coordinates of feature points are expressed asZi=Xi+Yi(i=1, 2,…, n). The feature points in preoperative models are control points applied to deformation. When all control points are moved to their new positions, all points in the point cloud data are computed using Laplacian deformation technique.Vertex p in the point cloud data is given asvp. The Laplacian coordinate corresponding tovpis shown asδp. The centre point of one ring neighbourhood ofvpis expressed as(4)v¯p=1dp∑q∈N(p)vqwherev̅pis the centre point anddpis the number of the neighbourhood points.According to uniform weight, the Cartesian coordinate of the triangle mesh is transformed into Laplacian coordinate, as shown inFig. 7 and expressed as(5)δp=L(vp)=vp−1dp∑q∈N(p)vqBased on discrete mathematics, the adjacent matrix A can be expressed as(6)Apq={1,(p,q)∈edge0,otherwiseThe Laplacian coefficient matrix L can be expressed as(7)L=I−D−1Awhere D is the diagonal matrix,Dpp=dpandIcontains the weights of control points.The new coordinates of all points in the facial point cloud data can be computed by(8)[LI]V′=[δW]whereWis the coordinate of the control points andV′is the new coordinate of all points.The new coordinates of all points in the facial point cloud data are computed based on the changes in the positions of the control points. The deformation of preoperative models is simulated.

@&#CONCLUSIONS@&#
