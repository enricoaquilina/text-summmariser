@&#MAIN-TITLE@&#
Structural topology optimization with minimum distance control of multiphase embedded components by level set method

@&#HIGHLIGHTS@&#
We present topology optimization with distance control of embedded components.Both structural topology and multi-component layout are represented by level set.Specified geometries of component can be well preserved thanks to level set model.A unified level set-based distance constraint for arbitrary components is proposed.Explicit integral form of the distance constraint facilitates sensitivity analysis.

@&#KEYPHRASES@&#
Topology optimization,Level set,Integrated design,Embedded component,Minimum distance control,Virtual boundary offset,

@&#ABSTRACT@&#
This paper presents a novel topology optimization method for designing structures with multiphase embedded components under minimum distance constraints in the level set framework. By using the level set representation for both the component layout and the host structure topology, the shapes of the components can be easily preserved, and optimal structural topologies with smooth boundary/material interface can be obtained. With the purpose of preventing the components moving too close to each other, a minimum distance constraint based on virtual boundary offset is proposed. Different from existing distance detection methods relying on explicit topology representation, the proposed constraint is imposed as a unified integral form, for which the design sensitivity can be readily obtained. Moreover, this constraint is effective for detecting the distance between any complex-shaped components. Several numerical examples are presented to demonstrate the validity and effectiveness of the proposed method.

@&#INTRODUCTION@&#
Structural topology optimization aims to seek the optimal material distribution for achieving desired performance in the conceptual design stage. It enables systematic exploration of novel structural configurations meeting various specific design requirements. Since the pioneering work of Bendsøe and Kikuchi  [1], topology optimization has undergone considerable progress in both academic research and engineering applications, see recent review papers  [2,3].Nowadays, several methods for continuum topology optimization have achieved great success and gained wide popularity. In particular, since the works by Wang et al.  [4] and Allaire et al.  [5], the level set-based topology optimization methods have seen rapid development  [6–10]. The level set method was originally developed for tracking the shape and topological changes of dynamic multiphase interfaces  [11], in which the front propagation is controlled by solving a first-order Hamilton–Jacobi equation. In virtue of the implicit representation model, the level set-based topology optimization approaches attain the merits of accurate boundary description and natural topological changes. Some variants of level set methods have also been developed, including the parametrical level set method  [12], the color level set method  [13], and the fictitious interface energy method  [14].In engineering structure design problems, it is often necessary to embed a given number of geometrical objects with specified shapes into the structure, for fulfilling certain functionality and manufacturing requirements  [15,16]. These objects may be functional components that can also act as load-bearing structural members, or prescribed opening holes that are reserved as assembling space or for inserting certain functional devices in future service stage  [15]. Such a design requirement is of particular importance for structural configuration synthesis within a tight space. For instance, some load-bearing structures in aerospace or aeronautical engineering (e.g. miniature satellites, space capsules and aircraft wing-box structures) should preferably allow certain payload devices (e.g. payload adapter, storage container and power supplier) to be integrated into the main structure and use them as enhancements members when the installation space for these devices is very limited. Similarly, to accommodate certain functional units (e.g. electronic devices, control and guidance modules) in these structures, one may need to determine both the load transmission path and the layout (position and orientation) of some particular-shaped holes  [15], which can be naturally viewed as a special case of components composed of void material phase. In these applications, the topology of the structure and the layout of the embedded components need to be simultaneously optimized, so as to enhance the structural load-bearing capacity and to make better use of the available space. This thus raises the problem of topology optimization embedding multiple movable components with prescribed geometries (see Fig. 1)  [15]. Here, the word “layout” refers to the location and orientation of the embedded components, but not the topologies of the embedded components themselves. This means, the components are “movable” during the optimization, but their own shapes will be precisely kept unchanged. Clearly, this is a much more challenging task compared with topological design with embedded components at fixed positions, which can be simply regarded as a problem with predefined non-design domain.Earliest works on topology optimization of component embedding structures can be found in  [17–19]. Thereafter, integrated optimization of structural topology and component layout has drawn considerable interest. A systematic study in this field has been conducted by Zhang and Zhu’s group  [16,20–23]. They proposed a material density-based framework using the so-called finite circle method (FCM) as an ad hoc strategy for approximately detecting component overlaps  [16]. The basic idea of FCM is to approximate each component with a set of circles and then convert the non-overlapping constraint of each individual pair of components into one between two sets of circles. In their methods, an explicit geometry control method is used to approximately detect overlaps between the components  [20,22]. This may introduce a large number of constraints. Chen et al.  [24] studied integrated free-form and parametric shape optimization using composition of primitive implicit representations by R-functions. Clausen et al.  [25] presented a new density-based method for minimum compliance topology optimization including the design of a flexible void area within the design domain. Kang and Wang  [15] proposed a combined topological description model integrating the level set model and the independent point-wise density interpolation (iPDI)  [26]. Here, the level set function offers an accurate and smooth representation of the geometrical shapes of the embedded objects and tracks their movements during the optimization, while the density field is still used to describe the topological changes of the structure. The authors also proposed an explicit integral form of non-overlap condition based on combined topology description model of level set and embedded geometrical objects to avoid overlap between the objects and that between each object and the design domain boundary. This mathematical treatment of non-overlap condition offers a unique advantage in that the explicit mathematical expression of the constraint facilitates the sensitivity analysis. Kang et al.  [27] also studied simultaneous optimization of topology of the host structure and positions/orientations of embedded PZT actuators, with the aim to exploit the overall actuation performance. In the work of Zhou and Wang  [28], engineering features are optimized along with the topology design of the main structure under the level set framework.For topology optimization of certain multi-component structures, minimum distance control between the movable components is also of great importance. In practical applications, functional devices for some particular usage should be properly positioned with certain minimum distance considerations for satisfying various design requirements. For example, electromagnetic devices need to keep a minimum distance from each other to avoid possible interference. Another example is that, in the layout design of piezoelectric smart structures, the embedded sensor/actuator patches must be well separated from each other to allow for reliable insulation and electric circuit arrangement.However, existing studies on the minimal distance control between discrete movable objects are still quite limited, due to the lack of unified mathematical treatment for arbitrarily complex geometries. Guest  [29] may be the first author to implement the distance control among discrete objects of regular convex geometries within the design domain. By retaining the level set function to be a signed distance function, Allaire et al.  [30] proposed a skeleton concept and then defined point-wise/global averaged constraints of the maximum and minimum member thickness in the level set-based topology optimization. Although they presented a 3D design result, finding the skeleton of a spatial structure presents a great challenge. They also pointed out that the minimum thickness constraint they proposed only works for smooth shapes without corners. In a density-based topology optimization study of component-embedding structures by Zhang et al.  [31], an integral form of distance constraint is mentioned. This approach relies on extraction of the structural skeleton of current designs, and possible overlap between the components and the structural boundary is not resolved. It should be pointed out here that maximum member thickness constraints themselves, without appropriate small feature control of void regions, do not make any sense for compliance minimization problems. This is because simply inserting infinitely small holes into the otherwise solid part of the structure would satisfy such constraints without increasing the material volume and worsening the objective function.In this paper, we present a new integrated design optimization method for structures with multiple embedded movable components of prescribed geometry using implicit level set description model. In the optimization formulation, the level set functions provide accurate and smooth representation of the material interfaces among the embedded objects and the host structures. From numerical point of view, the level set representation of both the embedded objects and the host structures possesses the merit of implicit topology models in aspects of well-posedness and solution stability of the optimization model. The layout evolvement of the embedded objects and the topological/shape changes of the host structure are achieved by solving the Hamilton–Jacobi equation. Theoretically, the shapes of embedded objects can be accurately preserved during the course of optimization process, since their boundaries are advanced with rigid-body motion velocities. Nevertheless, numerical errors in solution of the Hamilton–Jacobi equation might induce undesirable shape inaccuracy. To avoid this, we employ a high-order accurate upwind scheme to solve the Hamilton–Jacobi equation.Another contribution of the present paper is that a minimum distance constraint is proposed using the level set function. Generally speaking, the distance of two geometries is defined as the minimum distance between any two points on the two geometrical objects  [32]. However, it is an extremely time-consuming task to find the closest points between two arbitrary objects. To overcome this difficulty, we mathematically state the minimum distance constraint in a unified integral form, which is a natural extension of the explicit multi-component non-overlap constraints proposed in our previous work  [15]. Thanks to the level set description, the minimum distance constraint for each pair of embedded objects is imposed as a single explicit constraint, thus avoiding the difficulties in treating multiple arbitrary-shaped objects. This also facilitates the design sensitivity analysis, and therefore provides gradient information for guiding the optimal placement of the embedded objects.The remaining part of this paper is organized as follows. In the next section, the level set-based topology description of structures with multiphase components is presented. In this context, the minimum distance constraint of multi-components is stated in a unified integral form and a mathematic proof is provided. In Section  3, the mathematical formulation of the considered topology optimization problem is given, and the sensitivity analysis is derived. Numerical examples are presented in Section  4 to show validity and effectiveness of the proposed method. Finally, concluding remarks are given.In the level set method, a higher dimensional function with Lipschitz continuityΦ(x)is used to implicitly represent the material domainΩcontained in a fixed design domainDas(1){Φ(x)>0,ifx∈Ω∖∂Ω,Φ(x)=0,ifx∈∂Ω∩D,Φ(x)<0,ifx∈(D∖Ω).This concept is schematically shown in Fig. 2. In practice, the level set function is usually defined as the signed distance function.In the present method, thejth component to be embedded in the design domain is represented by a level set functionΦj(j=1,2,…,m), wheremis the total number of the components. Thus, the assembly of all the components is defined by(2)Φc=min(Φ1,Φ2,…,Φm).As the components are embedded in the structure, an additional level set functionΦ0is also required to describe the boundary of the structure material, i.e. the host material phase that supports the components. In this way, the topology representation model for multi-component embedding structures is stated as(3){Φc(x)>0,Φ0(x)<0,x∈Ωv(void phase);Φc(x)>0,Φ0(x)=0,x∈Γs(structural boundary);Φc(x)>0,Φ0(x)>0,x∈Ωh(host material phase);Φj(x)=0,x∈Γj(jth component boundary);Φj(x)<0,x∈Ωj(jth component).An illustration of this description model is given in Fig. 3. Here, two components are embedded in the design domainD, represented byΦ1andΦ2with the boundaryΓ1andΓ2, respectively. Clearly, the assembly of the two components is represented byΦc(x)=min(Φ1,Φ2)<0. The solid host material and the void phase are defined byΦ0(x)>0,Φc(x)>0andΦ0(x)<0,Φc(x)>0, respectively.During the optimization process, the boundary evolution of the host material phase and the components is achieved by solving the Hamilton–Jacobi equations(4)∂Φj∂t+Vjn|∇Φj|=0,j=0,1,2,…,m,whereV0nis the normal velocity of the structural boundary,Vjn(j=1,2,…,m)is the normal velocity of thejth component’s boundary.Eq. (4) is generally solved by an up-wind scheme  [33] given the normal velocities of the boundary, yielding updated level set function values. Here, a higher-order WENO  [33] scheme is used in solution of the Hamilton–Jacobi equations describing movements of the embedded components for the purpose of accurately preserving their geometrical shapes, while a first-order ENO scheme is applied to evolve the boundary of the host material phase. The normal velocities in Eq. (4) are originally defined only on the boundary of each level set function, and they need to be extended to the whole design domain or a specified narrow band around the boundary. In this study, we employ the velocity extension technique presented in  [4]. As usual, we also apply re-initialization procedures to keepΦj(j=0,1,2,…,m)as the signed distance functions  [4,5].By using the description model Eq. (3), the elasticity tensor is defined by(5)D=H(Φc)H(Φ0)Dh+∑j=1m(1−H(Φj))Dj,whereH(⋅)is the Heaviside function,Dhis the elasticity tensor of the host material andDjis that for thejth component.In this method, it is convenient to track the movement of the boundary and to extract the geometrical quantities of the boundary such as the normal direction and curvature. We will show that such a level set representation has also great advantages in topology optimization with minimum distance constraints for embedded multi-components.In order to prevent the embedded components from getting too close from each other, we propose an integral form of minimum distance constraint in terms of the level set function. Assume that there aremcomponents embedded in the design domain, marked byΩ1,Ω2,…,Ωm(m≥2). The minimum distance constraint can be stated as(6)d(Ωi,Ωj)≥dmin,∀i≠j,whered(Ωi,Ωj)is the distance measure between theith andjth components, anddmin>0is a specified lower bound value.The constraint condition (6) relies on explicit distance expressions between each pair of components. However, it presents a great difficulty to calculate exact distance between two arbitrarily shaped components. In this study, as a natural extension of our earlier work on non-overlap condition of embedded objects, we first propose a virtual boundary offset approach and recast the minimum distance constraint in a sufficiently large design domain (without occurrence of overlap between embedded components and the design domain boundary) into an integral form in terms of the level set function, as(7)∫DH(Φc−dmin/2)dΩ≤VD−∑j=1mVjvc,whereVjvcis the volume of thejth virtual component attained bydmin/2offset of the corresponding component boundary (whereΦj=0), andVDis the volume of the design domain.Here, the signed distance property of the level set function is used, which can be achieved by re-initialization during the optimization process  [4,5]. This property ensures that an offset of the zero-contour will be a set of points with the corresponding distance to the zero-contour.The basic idea of the minimum distance constraint (7) is explained in Fig. 4. Two components with any arbitrary shapes embedded in a sufficiently large design domain, are denoted byΩ1andΩ2. The minimum distance constraint (6) requires that their distance not to be smaller than a given valuedmin, see Fig. 4(a). The boundaries (zero level sets) of both components are first offset to thedmin/2level sets. The resulting new boundaries are referred to as the virtual boundaries for the corresponding components, and the virtual components are denoted byΩ̃1andΩ̃2. In virtue of this, the minimum distance constraint (6) for the componentsΩ1andΩ2is equivalent to the non-overlap condition (7) of the componentsΩ̃1andΩ̃2. A mathematical proof on the equivalence of constraint condition (6) and (7) is given as follows.PropositionIn a sufficiently large domain, the explicit minimum distance constraint between multiple components is equivalent to the non-overlap constraint between the virtual components with boundary offsets.ProofWithout loss of generality, we consider the case with two componentsΩ1andΩ2, which are bounded and connected closed sets inRn. The condition in (6) can be rewritten as(8)d(Ω1,Ω2)=infd(Pa,Pb)=mind(Pa,Pb)≥dmin,∀Pa∈Ω1,∀Pb∈Ω2,whered(Pa,Pb)is the Euclidean distance between pointsPaandPb.For the virtual componentsΩ̃1andΩ̃2defined above, the non-overlap constraint betweenΩ̃1andΩ̃2can be stated as(9)int(Ω̃1∩Ω̃2)=∅,whereint(Ω̃1∩Ω̃2)denotes the set of all the interior points ofΩ̃1∩Ω̃2.(i)The non-overlap constraint betweenΩ̃1andΩ̃2is a sufficient condition of the minimum distance constraint betweenΩ1andΩ2.For any two pointsa0∈Ω1andb0∈Ω2, the segmenta0b0must intersect with∂Ω̃1and∂Ω̃2, where the intersections are denoted bya0′andb0′, as shown in Fig. 5(a). Then it yields(10)d(a0′,a0)≥d(a0′,∂Ω1)=Φ1(a0′)=dmin2,d(b0′,b0)≥d(b0′,∂Ω2)=Φ2(b0′)=dmin2.According to Eq. (9), one has(11)int(a0a0′∩b0b0′)=∅,which further leads to(12)d(a0,b0)=d(a0,a0′)+d(a0′,b0′)+d(b0′,b0)≥dmin.Recalling thata0is an arbitrary point inΩ1andb0is an arbitrary point inΩ2, one has(13)d(Ω1,Ω2)≥dmin.Thus, the sufficiency from condition (7) to condition (6) is proved.(ii)The non-overlap constraint betweenΩ̃1andΩ̃2is a necessary condition of the minimum distance constraint betweenΩ1andΩ2.Here, the method of reductio ad absurdum is applied to finish the proof. Assuming that(14)int(Ω̃1∩Ω̃2)≠∅,there must exist a pointc1which is an interior point ofΩ̃1andΩ̃2, see Fig. 5(b).Obviously, the values of bothΦ1andΦ2at pointc1are smaller thandmin/2, which leads to the following statement(15)∃a1∈A1,b1∈A2,s.t.d(a1,c1)<dmin2,d(c1,b1)<dmin2.In this sense, one obtains the following relationship(16)d(a1,b1)≤d(a1,c1)+d(c1,b1)<dmin,which means(17)d(Ω1,Ω2)=mind(Pa,Pb)≤d(a1,b1)<dmin,∀Pa∈Ω1,∀Pb∈Ω2.Since (17) violates the minimum distance condition (6), the basic assumption in (14) is invalid. Thus, (7) is also a necessary condition of (6).In summary, the minimum distance constraint (6) in a sufficiently large domain is equivalent to the non-overlap condition (7) of the two virtual components.□However, since component-embedding topology optimization problems are always defined within a bounded design domain with finite volume, using condition (7) directly as the minimum distance constraint may be problematic, as illustrated in Fig. 6. As seen in the figure, when a part of the virtual componentΩ̃2moves out of the design domainD, the integral in the left-hand side of condition (7) will not exactly reflect overlap of the two virtual components. To avoid this undesirable limitation, the integration in condition (7) should be carried out in an extended domain whose boundary should have an offset not less thandmin/2from the original design domain boundary (for instance, in Fig. 6, the integration domain is selected as the rectangular domainD¯). Now we rewrite the minimum distance constraint as(18)∫D¯H(Φc−dmin/2)dΩ≤VD¯−∑j=1mVjvc.In topology optimization of structures with embedded components, it is usually also necessary to restrict all the components within the design domain. To achieve this, we introduce an additional non-overlap constraint between the components and the design domain boundary, as(19)∫DH(Φc)dΩ≤VD−∑j=1mVjcwhereVjcis the volume of thejth component.The constraints (18) and (19) are continuous with respect to topological changes of the main structure. That is, it is continuous when an infinitely small hole is inserted into the solid material domainΩ. Therefore, standard gradient-based optimization algorithms can be applied to solve the optimization problem.The proposed minimum distance constraint (18) is formulated with implicit level set representation of virtual boundary offset. As compared with explicit geometrical model-based approaches, other merits of the proposed constraint are: (1) it provides a unified expression for minimum distance control between any number of arbitrary-shaped components, regardless of the convexity of their geometrical shapes; (2) it avoids the difficult task of calculating the exact distance between each pair of components, thus greatly saves the computational cost; (3) since the constraint has an explicit expression, it also facilitates efficient sensitivity analysis and is thus well suited for mathematical programming solution of the problem; (4) it can be naturally extended to 3D problems. Besides, constraints (18) and (19) exhibit a similar property as the “contact constraints” in the variational form of some continuum mechanics problems, in that these constraints and their sensitivities will always be zero unless they are active.The compliance minimization problem of a linear elastic continuum structure with the minimum distance constraint of multiple embedded components is formulated by(20)FindVn∈RN,ηj∈R3,j=1,2,…,mMin.J=∫Ωε(u):D:ε(u)dΩs.t.{a(u,v)=l(v),∀v∈Uad,G1≜∫D¯H(Φc−dmin/2)dΩ−(VD¯−∑j=1mVjvc)≤0(minimum distance constraint)G2≜∫DH(Φc)dΩ−(VD−∑j=1mVjc)≤0(non-overlap constraint with∂D)Gv≜∫DH(Φc)H(Φ0)dΩ−fvVD≤0(volume constraint of host material)η¯k≤ηjk≤η̄k,j=1,2,…,m;k=1,2,3V¯n≤Vin≤V¯n,i=1,2,…,NwhereVnandηjare the velocity design variables;uandvare the displacement and virtual displacement, respectively;a(u,v)=∫Ωε(u):D:ε(v)dΩis the bilinear energy form andl(v)=∫Ωf⋅vdΩ+∫ΓNt⋅vdΓis the load linear form;fis the body force,tis the surface traction on the Neumann boundaryΓN, andΩdenotes the solid part of the design domain, including the host structure and the solid components. In the volume constraint,fvis the volume fraction ratio of the host material andVDis the volume of the design domainD.In the optimization problem (20), there are two types of design variables. The first type of design variables are the normal velocity vectorVn={V1n,V2n,…,VNn}TofNlevel set points. They are mapped to a continuous normal velocity field of the level set functionΦ0, as will be shown later. The other type of design variables are the rigid-body velocities of the componentsηj(j=1,2,…,m). Specifically, in 2D problems,ηj={vjx,vjy,ωj}Tcollects the translational and rotational velocities of thejth component. We refer to the component velocity as the “rigid body velocity”, because only the positions and orientations of the embedded components are changed during the optimization process. However, the elastic deformation of these components are still accounted for in the subsequent finite element analysis and the design sensitivity analysis. The bound limitsV¯n,V¯n,η¯kandη̄kof the design variables are imposed to improve convergence of the optimization process. These velocities are used to drive topological evolution of the host structure and the movement of the embedded components by solving the Hamilton–Jacobi equations (4).It should be noted that the embedded components cannot be simply treated as a non-design domain prior to the topology optimization since their position and orientation are still to be determined simultaneously with the load transmission path of the host structure.The velocity design variables of the problem (20)Vnandηj(j=1,2,…,m)are updated by the MMA (the method of moving asymptotes) algorithm  [34]. Thus, the gradients of the objective function and the constraints with respect to the design variables are required.We now consider shape perturbation parametersθ0andθj(j=1,2,…,m)for the host material phase and thejth embedded component,i.e.(21)Ωθh=(Id+θ0)Ωh,Ωθj=(Id+θj)Ωj,j=1,2,…,m,which yielding the whole solid regionΩθ=(Id+θ)Ω. Then, the functionalJ(Ωθ)can be expressed by(22)J(Ωθ)=J(Ω)+J′(Ωh)(θ0)+∑j=1mJ′(Ωj)(θj)+o(θ0,θ1,θ2,…,θm).Here,limθ0→0[o(θ0,θ1,θ2,…,θm)/‖θ0‖]=limθj→0[o(θ0,θ1,θ2,…,θm)/‖θj‖]=0.The Lagrangian function for the objective function in (20) is(23)ℒ(Ω,u,q)=∫Ωε(u):D:ε(u)dΩ+∫Ωσ(u):ε(q)dΩ−∫Ωf⋅qdΩ−∫ΓNt⋅qdΓ,whereqis the Lagrange multiplier.The shape derivative of the Lagrangian function becomes(24)ℒ′(Ω,u,q)=ℒ′(Ωb)(θ0)+∑j=1mℒ′(Ωj)(θj)+〈∂ℒ(Ω,u,q)∂u,δu〉,whereδuis the displacement variation due to the shape changes of the solid regionΩ, and the last term denotes the derivative ofℒwith respect touin the directionδu.Here, Eq. (24) is established on the condition that the derivative of the Lagrangian function with respect to the Lagrange multiplier would yield the equilibrium equation. It is well known that the considered compliance minimization problem is a self-adjoint problem, thus it follows that the third term on the right-hand side of Eq. (24) vanishes for allδu∈Uadby settingq=−2u. In particular, for a traction-free and body force-free problem, the shape derivatives of the objective function with respect toθ0andθjbecome  [5](25)J′(Ω)(θ0)=−∫Γs[ε(u):Dh:ε(u)]θ0⋅ndΓ,J′(Ω)(θj)=−∫Γj[ε(u):(Dj−H(Φ0)Dh):ε(u)]θj⋅ndΓ,j=1,2,…,m.The shape derivatives of the minimum distance constraint and the non-overlap constraint can be also obtained as(26)(G1)′(θj)=∫ΓvcjH(Φc−dmin2)θj⋅ndΓ,j=1,2,…,m,(G2)′(θj)=∫ΓjH(Φc)θj⋅ndΓ,j=1,2,…,m,whereΓvcjis the boundary of thejth virtual component.Similarly, the shape derivative of the volume constraint for the host material phase is(27)(Gv)′(θ0)=∫Γsθ0⋅ndΓ,(Gv)′(θj)=∫ΓjH(Φ0)H(Φc)θj⋅ndΓ,j=1,2,…,m.Using above relations, the derivatives of the objective function and constraints with respect to the velocity design variables will be derived in what follows.In the present study, the topological evolution of the host material phase is achieved by solving the Hamilton–Jacobi equation with the normal velocities evaluated at the level set point. To obtain the derivatives with respect to these normal velocities, the integrals related toθ0in Eqs. (25) and (27) are converted into domain integrals as(28)J′(Ω)(θ0)=−∫D[ε(u):Dh:ε(u)]H(Φc)δ(Φ0)|∇Φ0|VndΩ,(Gv)′(θ0)=∫DH(Φc)δ(Φ0)|∇Φ0|VndΩ,whereδ(⋅)is the Dirac delta function, and the normal velocityVn=θ0⋅nis extended to the whole design domain.We now express the normal velocity fieldVnas a linear combination ofVin(i=1,2,…,N), as(29)Vn=∑i=1Npi(x)Vin,wherepi(x)is the interpolation function depending only onx.Then Eq. (28) is rewritten as(30)J′(Ω)(θ0)=−∑i=1N∫D[ε(u):Dh:ε(u)]H(Φc)δ(Φ0)|∇Φ0|pi(x)VindΩ,(Gv)′(θ0)=∑i=1N∫DH(Φc)δ(Φ0)|∇Φ0|pi(x)VindΩ.Thus, we obtain the derivative of the objective function and the volume constraint with respect to theith normal velocity design variable, which are expressed in the integral form as(31)∂J∂Vin=−∑e=1k∫Ωe[ε(u):Dh:ε(u)]H(Φc)δ(Φ0)|∇Φ0|pi(x)dΩ∂G3∂Vin=∑e=1k∫ΩeH(Φc)δ(Φ0)|∇Φ0|pi(x)dΩi=1,2,…,N,whereΩeis the domain occupied by theeth finite element, andkis the number of elements. Both integrals can be easily calculated by Gaussian integral at elemental level.As usual, in this study, square shaped finite elements are used in discretization of the design domain and the level set points within the design domain are positioned at the element centers. Therefore, from the computational efficiency point of view, the interpolation functionpi(x)is simply set to be 1 within the corresponding element and 0 elsewhere.The boundary velocities of the components are related to their rigid-body velocities as(32)θj=vjxex+vjyey+ωj×r,j=1,2,…,m,whereexandeyare the unit vectors alongxandydirections, andris the position vector from the rotation center to the boundary point of the component.According to the chain-rule, one has(33)∂J∂ηj=J′(Ω)(θj)∂θj∂ηj,∂G1∂ηj=G1′(Ω)(θj)∂θj∂ηj,∂G2∂ηj=G2′(Ω)(θj)∂θj∂ηj,∂Gv∂ηj=Gv′(Ω)(θj)∂θj∂ηj,j=1,2,…,m.Using the above expressions, the derivative of the objective function and constraints with respect to the rigid-body velocity design variables can be easily calculated.The solution procedures of the considered problem are given as follows.Step  1:Initialize configuration of the main structure and layout of the components;Solve the elasticity problem to obtain the displacement field;Calculate the derivative of the objective function and constraints with respect to the design variables by using Eqs. (31)–(33);Update the design variables by solving the optimization problem with the MMA algorithm;Evolve the boundaries of the host material phase and the components by solving the Hamilton–Jacobi equations (4);Re-initialize the level set functions;Repeat steps 2–6 until convergence.Remark 1The design variables include two kinds of velocity vectors, namelyVnandηj(j=1,2,…,m). The former vectorVncollects the normal velocities ofNlevel set points, which are mapped to a continuous normal velocity field of the level set function representing the host material phase, andηjdenotes the rigid-body velocity vector of thejth component. In the optimization process, the velocity design variables are updated by the MMA algorithm  [34], rather than the steepest descent method in standard implementation of the level set method.Remark 2In the sensitivity analysis, the boundary integrals along the material interfaces are transformed into volume integrals, which are easier for the numerical implementation. For smoothing the Dirac delta functionδ(x)in the volume integrals, we use the following approximation function  [4](34)δ(x)={3(1−α)4Δ(1−x2Δ2),|x|≤Δ,0,|x|>Δ,whereαhas a small positive value, and2Δis the width of smooth region.Remark 3In order to ensure stability while solving the Hamilton–Jacobi equation, the Courant–Friedrichs–Lewy (CFL) condition is to be observed. To maintain the signed distance property of the level set function, re-initialization of the level set function is required, which is achieved by solving the equation(35)∂Φ∂t+sign(Φ∗)(|∇Φ|−1)=0,whereΦ∗is the value of the level set function in the previous time step  [11].In this section, numerical examples are presented to illustrate the effectiveness of the proposed topology optimization method considering minimum distance constraints among multiple embedded components. Without loss of generality, only 2D problems are considered. In the first two examples, the components have convex shapes. To show the merits of this approach, in the third and fourth examples, we also consider non-convex shaped components which are much more difficult to treat than convex-shaped ones when using existing methods.In all examples, 4-node bilinear square element with unit side length is used. The Gaussian integral is applied to compute the stiffness matrix and the sensitivities, and each element cut by the material boundaries has 25 (5 × 5) Gaussian points. The Young’s moduli of the host material and the artificial weak material (for mimicking the void regions) areEh=1andEw=10−3, respectively, and the Poisson’s ratio of all materials isν=0.3. The move limits for the design variables in each iteration are set asη̄={0.5,0.5,0.05}T. Unless otherwise stated, the time step in solving the Hamilton–Jacobi equation forΦ0is set to 0.5, and the number of time steps for solving the re-initialization equation (35) is 20. The values ofΦ0on the outmost level set nodes (half element length outside the design domain) are set to a near-zero value (−10−6). The optimization progress will be terminated when the difference of the objective function between each two successive iterations falls below 10−5, or the total number of iterations reaches 250. In order to show the distance between the components more clearly, the level set contours forΦj=dmin/2(j=1,2,…,m)are also plotted in the figures of optimal solutions.To verify the effectiveness of the proposed minimum distance constraint condition, we consider the optimal layout design problem of two movable components (a square one and a circular one) in a given design domain, as shown in Fig. 7. In this example, only the layout of the components is optimized, therefore there are no volume fraction constraints. The initial reference point positions (cross marks in the figures) of the square and the circular components are (70, 25) and (30, 25), respectively. The distance between the components is restricted to be larger thandmin=6. The Young’s moduli of the two components areEsquare=Ecircle=0.5. The parameters for the approximation function ofδ(x)in Eq. (34) areα=10−4andΔ=0.5.For comparison, we first solve the problem without the distance constraint. The optimization process converged after 107 iterations, with selected intermediate solutions and the final optimal solution shown in Fig. 8. It is found that the two embedded components move towards the bottom right corner of the design domain during the course of optimization and finally merge with each other. This is no surprising, since the material of the components is weaker than the host material.Now we solve the same problem but with the distance constraint. Convergence is achieved after 178 iterations, and the optimization history is shown in Fig. 9. It is seen that the two components still tend to move towards each other, but their distance is well controlled due to the distance constraint.To examine the robustness of the proposed method and dependence of the optimal solutions on initial guesses, we now perform topology optimization of a cantilever beam along with the layout of a square and a circular component starting from two different cases of initial positions. The geometrical dimensions of the design domain and the embedded component, as well as the loading condition, are shown in Fig. 10. The Young’s moduli of the two components areEsquare=Ecircle=0.5. The host material volume fraction is restricted byfv=0.4. In the first case, the initial positions of the square and the circle are (55, 20) and (85, 30), respectively; while in the second case, they are (40, 30) and (110, 20), respectively. A minimum distance constraintdmin=6is imposed between the two components. The parameters for the approximation function ofδ(x)areα=10−4andΔ=0.5.The optimization results for both cases are shown in Figs. 11 and 12, and the iteration histories are given in Fig. 13. We can see that though the two optimized structural topologies exhibit distinct differences, the optimal objective function values for the two cases are very similar (as shown in Fig. 13). This shows that the present formulation can achieve meaningful results from different initial guesses, and also implies that the obtained solutions are local minima. At this point, it is worth noting from the optimization results that the optimal force transmission path evidently depends on the layout of the embedded components, which highlights the importance of integrated optimization of the overall structural topology and component layout.To show the advantage of the present method in treating multiphase material components, we consider topology optimization of an L-shape bracket with two embedded components of different materials, one with the “dumbbell” shape and another with the “calabash” shape, as shown in Fig. 14. It is noted that both components have non-convex geometrical shapes, for which it is computationally very expensive to check the distance constraint using conventional techniques. The Young’s moduli of the two components areEdumbbell=4andEcalabash=0.25. The initial positions of the dumbbell and the calabash components are (25, 40) and (25, 15), respectively. The minimum distance between the components is set asdmin=5. The structural material volume fraction is given asfv=0.35. The parameters for approximation function ofδ(x)areα=10−4andΔ=0.4. The values ofΦ0on the outmost level set nodes are set to zero.Starting with the initial component positions, we obtain the final optimization results shown in Fig. 15. Here, different colors are used to distinguish different material phases. It is noted in the final result that the dumbbell component (with stronger material) acts as a major load-bearing member beam and the calabash (with weaker material) acts as a supplementary enhancement to the main force transmission path. This is obviously an intuitively reasonable design exploiting different stiffnesses of the embedded components. It is also seen that the smoothness of structural boundary and complex geometric shapes of the embedded components are well preserved during the course of optimization, thanks to the high shape description quality of the implicit level set model. From the iteration history plotted in Fig. 16, a stable decrease of the objective function can be observed and thus robustness of the presented method is demonstrated.In the last example, we consider a simply-supported beam embedding three components composed of different materials, namely a square one, a circular one and an L-shape one. The geometrical dimensions of the design domain and embedded components, as well as the loading condition, are shown in Fig. 17. The Young’s moduli of the components areEsquare=4,Ecircle=0.25andEL-shape=0.5. The initial positions of the square, circular and L-shape components are (90, 25), (30, 25) and (55, 20), respectively. The distance between the components is required to be larger thandmin=6. The structural material volume fraction is set to befv=0.4. The parameters for approximation ofδ(x)areα=10−4andΔ=0.5. Considering the complexity of this example, the time step in solving the Hamilton–Jacobi equation forΦ0is set to 0.25 to improve the computation accuracy. The Hamilton–Jacobi equation forΦ0is solved twice in each optimization iteration. Here, the number of time steps for solving the re-initialization Eq. (35) is 10.The obtained optimization results and the iteration histories are presented in Figs. 18 and 19, respectively. Again, it is observed that the optimization process converged steadily and the minimum distance constraints are well satisfied during the course of optimization.This paper proposes a new level set-based method for topology optimization of structures with multiple embedded components of different material phases. As an implicit boundary representation model, the level set function has been introduced into topology optimization to provide accurate and smooth description of topology evolution. In this study, different level set functions are used to represent the geometry of the components and the host structure configuration. By this means, not only the geometrical shapes of the components can be precisely preserved, but also smooth structural boundary can be obtained in the optimal solutions. Moreover, a mathematically rigorous minimum distance constraint based on virtual boundary offset is proposed, by converting the distance detection into an implicit non-overlap condition, to prevent the components from moving too close to each other. The proposed constraint condition is applicable for multiple embedded components with arbitrary (convex and non-convex) geometrical shapes. In addition, the constraint has a unified and explicit integral form, thus facilitating the sensitivity analysis. As compared with component-embedding topology optimization approaches relying on explicit topology description models, this constraint statement avoids numerical difficulties in calculating the distance between complex-shaped components. Numerical examples show that the proposed method performs well and is able to generate well-defined and meaningful optimization results.The integrated optimization formulation for simultaneous design of component layout and host structure topology is clearly a highly nonlinear and non-convex optimization problem. Thus global optima cannot be ensured by the proposed method. However, the achieved local optimal solutions can still provide useful guidance in the conceptual design stage. Some generic convergence enhancing techniques for mathematical programming problems may be employed to accelerate the convergence. Improving the computation accuracy of shape derivatives with finer finite element resolution around the material interfaces would also be beneficial to increase the convergence speed. However, this would increase the computational cost.Although this paper only considers the minimum compliance design of planar structures, it is natural to extend this method to topology optimization problems with other objective functions and 3D problems.In the present study, for the purpose of simplicity, the required minimum distances between any two components are the same. It would be straightforward to consider different distance constraints for different pairs of components by including multiple distance constraints.

@&#CONCLUSIONS@&#
