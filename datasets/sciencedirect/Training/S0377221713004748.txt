@&#MAIN-TITLE@&#
Stochastic non-convex envelopment of data: Applying isotonic regression to frontier estimation

@&#HIGHLIGHTS@&#
Isotonic nonparametric least squares (INLS) fits a step function to data.Free disposal hull (FDH) envelops all data points by step function.We show that FDH is a sign-constrained version of INLS regression.Using the result, we develop two new methods, corrected INLS and non-convex StoNED.We examine performance of the proposed methods by Monte Carlo simulations.

@&#KEYPHRASES@&#
Data envelopment analysis,Free disposal hull,Nonparametric regression,Productive efficiency analysis,Stochastic frontier analysis,

@&#ABSTRACT@&#
Isotonic nonparametric least squares (INLS) is a regression method for estimating a monotonic function by fitting a step function to data. In the literature of frontier estimation, the free disposal hull (FDH) method is similarly based on the minimal assumption of monotonicity. In this paper, we link these two separately developed nonparametric methods by showing that FDH is a sign-constrained variant of INLS. We also discuss the connections to related methods such as data envelopment analysis (DEA) and convex nonparametric least squares (CNLS). Further, we examine alternative ways of applying isotonic regression to frontier estimation, analogous to corrected and modified ordinary least squares (COLS/MOLS) methods known in the parametric stream of frontier literature. We find that INLS is a useful extension to the toolbox of frontier estimation both in the deterministic and stochastic settings. In the absence of noise, the corrected INLS (CINLS) has a higher discriminating power than FDH. In the case of noisy data, we propose to apply the method of non-convex stochastic envelopment of data (non-convex StoNED), which disentangles inefficiency from noise based on the skewness of the INLS residuals. The proposed methods are illustrated by means of simulated examples.

@&#INTRODUCTION@&#
There is a large and growing literature on productive efficiency analysis, which encompasses several disciplines such as operational research, applied economics and econometrics, and statistics. Unsurprisingly, a wide range of alternative approaches and methods are available. The key differences between the alternative approaches concern the assumptions and the estimation method. Approaches can be classified as deterministic versus stochastic. Deterministic approaches attribute deviations from the frontier to inefficiency, whereas stochastic approaches also allow for stochastic noise. Methods can also be classified as parametric versus nonparametric. Parametric methods assume a specific functional form for the frontier, whereas nonparametric methods avoid the functional form assumption. The classic data envelopment analysis (DEA) method (Charnes et al., 1978) is an example of a deterministic, nonparametric method. In contrast, stochastic frontier analysis (SFA) method (Aigner et al., 1977) is an example of a stochastic, parametric method.Bridging the gap between DEA and SFA has recently attracted increasing attention. Earlier studies mainly departed from SFA, replacing the parametric frontier by a nonparametric specification that can be estimated by kernel regression (e.g., Kneip and Simar, 1996; Fan et al., 1996) or local maximum likelihood (ML) techniques (e.g., Kumbhakar et al., 2007; Simar and Zelenyuk, 2011). Departing from DEA, Banker and Maindiratta (1992) consider ML estimation of the stochastic frontier model subject to free disposability and convexity. The recent studies Kuosmanen (2008) and Kuosmanen and Johnson (2010) show that DEA can be interpreted as constrained variant of convex nonparametric least squares (CNLS) regression (Hildreth, 1954; Hanson and Gordon Pledger, 1976; Groeneboom et al., 2001a, 2001b). This link further implies that DEA can be seen as a nonparametric counterpart to the parametric programming approach by Aigner and Chu (1968). Building on this link between DEA and CNLS, Kuosmanen and Johnson (2010) propose a nonparametric version to the corrected ordinary least squares (COLS) approach. In the deterministic setting, the proposed corrected CNLS (C2NLS) method has a higher discriminatory power than the conventional DEA. To estimate stochastic frontiers, Kuosmanen and Kortelainen (2012) combine CNLS with the methods used in the modified ordinary least squares (MOLS) approach. Since the approach of Kuosmanen and Kortelainen (2012) melds nonparametric DEA-style frontier with stochastic SFA-style treatment of noise, they refer to the new amalgam method as stochastic nonparametric envelopment of data (StoNED).2Published applications of the StoNED method include such areas as agriculture (Kuosmanen and Kuosmanen, 2009), electricity generation (Mekaroonreung and Johnson, 2012) and electricity distribution (Kuosmanen, 2012). Further details regarding the StoNED method can be found on the website: http://www.nomepre.net/stoned/.2The nonparametric DEA, CNLS, and StoNED methods are based on the axioms of free disposability (monotonicity) and convexity (concavity), which can be seen as the first- and second-order conditions for the curvature of frontier (regression function). For both DEA and CNLS, there exist parallel methods, which do not impose convexity (concavity) but maintain free disposability (monotonicity). The non-convex version of DEA is known as the free disposal hull (FDH) method.3The name FDH originates from Deprins et al. (1984), but the main principles of the approach can be found already in Afriat (1972).3In statistics, the nonparametric approach to estimating a monotonic increasing function is known as isotonic regression (the decreasing case is called antitonic regression). Isotonic nonparametric least squares (INLS) method originates from the articles by Ayer et al. (1955) and Brunk (1955, 1958). More recent applications include Wu et al. (2001), Stylianou and Flournoy (2002), Tang et al. (2011), and Hansohm and Hu (2012).In this paper, we extend the classification of approaches by Kuosmanen and Johnson (2010) to non-convex approaches. We first establish formal links between the separately developed FDH and INLS methods. The obvious similarity between FDH and INLS is that they both fit a step function to data. In INLS the step function is fitted to minimize the sum of squares of deviations, whereas in FDH the step function provides the tightest envelope to data points. We show that the FDH problem can be obtained by imposing additional sign-constraints to the INLS problem. Thus, FDH can be interpreted as a restricted version of INLS.We then utilize the link between FDH and INLS to develop two new methods for frontier estimation, which are intended for the deterministic and stochastic settings, respectively. The first one is the non-convex version of C2NLS, referred to as corrected INLS (CINLS). This method applies INLS to estimate the shape of the frontier, and then shifts the estimated step-function to the frontier according to the maximum INLS residual. The second one is the non-convex version of StoNED, and is referred to as non-convex stochastic envelopment of data (non-convex StoNED). In this method the noise term is taken into account in a probabilistic manner. The expected value of inefficiency is estimated based on the skewness of INLS residuals, and the INLS frontier is shifted accordingly.Recently, a number of studies propose to reduce the sensitivity of FDH to outliers using the expected frontier of order-m (Cazals et al., 2002) and the order-α quintile frontier (Daouia and Simar, 2007). These robust frontiers still assume a deterministic setting with no noise. Thus far, the only known FDH-based estimator that explicitly assumes noise is the stochastic FDH by Simar and Zelenyuk (2011), which is based on local maximum likelihood estimation. This paper proposes an alternative approach that builds upon nonparametric least squares, analogous to Kuosmanen and Johnson (2010) and Kuosmanen and Kortelainen (2012), and applies to both deterministic and stochastic settings. Following the previous papers on CNLS and StoNED, we restrict attention to the single output multiple inputs case, which is conceptually simpler than the general multi-input multi-output setting. Joined production is conventionally modeled using the radial or directional distance functions, and the axiomatic, mathematical programming formulations developed in this paper could be adapted to the distance functions in a relatively straightforward manner. However, the more exotic distance function formulations would likely blur the connections that we intend to establish in this paper. Further, probabilistic models of stochastic noise usually restrict to the univariate setting, and it is not directly obvious how these models could be extended to the general multivariate setting without imposing restrictive assumptions. We consider the appropriate modeling of noise as the main challenge for the modeling of joint production in the multi-input multi-output setting.The structure of this paper is as follows. In Section 2, we briefly review the nonparametric least squares regression and present a classification of different approaches for estimating the production frontiers. The structure of classification comes from Kuosmanen and Johnson (2010) and we extend it to include the non-convex technologies. In Section 3, we discuss the INLS method and present the mathematical program. In Section 4, we explain the relationship between INLS and CINLS and explain that INLS is a convexity relaxed CNLS regression. We also illustrate the INLS and CNLS production functions with some examples. In Section 5, we show that FDH is a sign constrained INLS regression and we can obtain the optimal solution of the FDH from the optimal solution of signed constrained INLS regression and vice versa. In Section 6, we propose two new methods for estimating the frontier of non-convex technologies, CINLS and non-convex StoNED, using the INLS regression and then correcting the result by shifting the estimated frontier in deterministic and stochastic settings, respectively. We illustrate CINLS and compare its discrimination power with the FDH model using an example, then illustrate an example of frontier estimated by non-convex StoNED and discuss the heteroscedasticity in non-convex StoNED method. Section 7 provides some simulated examples to examine the performance of CINLS and non-convex StoNED using mean squared error (MSE) and bias statistics. Section 8 presents our concluding remarks. The proofs of all mathematical theorems and lemmas (Appendix 1) and additional simulated examples (Appendix 2) are presented as in the Supplementary material, available online at http://www.sciencedirect.com.In empirical production analysis, one typically has no prior information about the functional form of the production function, but the production function must satisfy certain axioms or regularity properties. For example, we usually can assume that the production function is increasing in inputs. In some applications, we can also assume that the production function is concave or quasi-concave. Nonparametric least squares methods allow one to specify such axiomatic properties without assuming a specific functional form of the production function.History of nonparametric least squares dates back to Hildreth (1954), who introduced nonparametric least squares subject to monotonicity and concavity constraints and applied to the estimation of production function for cotton farming. Statistical properties of Hildreth’s method have been examined in Hanson and Gordon Pledger (1976) and Groeneboom et al. (2001a, 2001b), among others. Kuosmanen (2008) coined the term convex nonparametric least squares (CNLS), and developed a quadratic programming formulation for solving the CNLS problem in the general multivariate setting.In a parallel stream of literature, Farrell (1957) and Farrell and Fieldhouse (1962) introduced a method for estimating the frontier production function using linear programming techniques. Afriat (1972) further developed Farrell’s method in the single output case under variable and constant returns to scale. Charnes et al. (1978) extended to the multiple output case under constant returns to scale, and coined the catchy term data envelopment analysis (DEA). Banker et al. (1984) developed the multiple output DEA formulation under variable returns to scale. During the past three decades, DEA has extended to various directions, and it has become a widely used method in empirical economics and operations research.For a long time, DEA has been seen as a deterministic, mathematical programming approach that is fundamentally different from regression analysis. Banker and Maindiratta (1992) and Banker (1993) started the investigation of the statistical foundations of DEA, showing that DEA can be interpreted as a maximum likelihood estimator. In a recent study, Kuosmanen and Johnson (2010) show that DEA can further be interpreted as a least-squares problem, specifically, a sign-constrained version of the CNLS problem. It is worth emphasizing that DEA and the sign-constrained CNLS not only share the assumptions of monotonicity and concavity, but the two methods are mathematically equivalent. This result bridges the two separately developed approaches to nonparametric estimation of production functions.Interestingly, a similar development of two independent streams of literature can be observed in the estimation of monotonic increasing production function without the concavity assumption. In statistics, Ayer et al. (1955) and Brunk (1955, 1958), Brunk (1965) introduced isotonic regression that employs least squares method to estimate an unknown monotonic function. The optimal solution to the isotonic least squares problem is always a step function. Isotonic regression is well established in statistics, but to our knowledge, it has not been used in empirical estimation of production functions.Relaxing the concavity assumption of DEA, Deprins et al. (1984) introduced the free disposal hull (FDH) method to productive efficiency analysis. Tulkens (1993) presented the mixed integer linear programming (MILP) formulation of the FDH problem and a simple enumerative algorithm. Kerstens and Vanden Eeckaut (1999) extended FDH to encompass alternative returns to scale properties. Cherchye et al. (2001) extended FDH to the directional distance function case. Linear programming formulations of the FDH technology have been developed in Agrell and Tind (2001), Podinovski (2004) and Leleu (2006, 2009).Taking the monotonic increasing function as the starting point, we can develop alternative types of estimation methods by adding further axioms (e.g., concavity), and specifying the disturbance term as inefficiency or noise or a composite error that includes both. Kuosmanen and Johnson (2010) present a classification of alternative parametric and nonparametric methods in the deterministic and stochastic settings. They also establish formal links between methods, and develop some new alternatives to obtain a complete classification.This paper extends the work of Kuosmanen and Johnson (2010) to the class of non-convex technologies that satisfy the free disposability axiom. To summarize our main results, Table 1presents our proposal for an extended classification of methods. The first two columns (i.e., “parametric” and “convex nonparametric”) are adopted from Kuosmanen and Johnson (2010). The third column (“non-convex nonparametric”) is appended as a result of this paper. On the first row, central tendency refers to the conventional regression methods. We introduce the isotonic nonparametric least squares (INLS) method in the context of production function estimation, parallel to the convex CNLS and parametric OLS. Frontier sign constrained approaches include the parametric and nonparametric programming approaches. Kuosmanen and Johnson (2010) showed that DEA is a sign constrained variant of CNLS. In this paper, we show that FDH also is a sign constrained version of isotonic regression. In other words, FDH has also a regression interpretation in terms of INLS.Building on this link, we develop two new frontier estimation methods. The first one is a two-stage estimation method, referred to as corrected INLS (CINLS), analogous to the corrected OLS (COLS, Greene, 1980) and corrected CNLS (C2NLS, Kuosmanen and Johnson, 2010) methods. CINLS is intended for the deterministic setting: we first estimate the average production function by INLS, and subsequently shift the average function to the frontier by using the maximum INLS residual (similar to the standard COLS procedure). The second method is devised for the stochastic setting, and is referred to as stochastic non-convex envelopment of data (non-convex StoNED), analogous to the StoNED method (Kuosmanen and Kortelainen, 2012). We first estimate the average production function by INLS. Based on the distribution of INLS residuals, we estimate the parameters of the inefficiency and noise distributions, similar to the modified OLS (MOLS) and StoNED. The average production function is converted to a frontier production function by using the expected value of inefficiency. The unit-specific efficiency estimates are obtained by using the conditional expected value of inefficiency as shown by Jondrow et al. (1982).This section introduces the INLS regression in the context of production function estimation. We also present a mathematical programming formulation that links it to convex nonparametric least squares (CNLS).Consider the frontier production model(1)yi=f(xi)+εi(i=1,…,n),where yiis the output of firmi,f:R+m→R+is the production function, xi=(x1i,x2i,…,xmi)′ is the input vector of firm i, and εiis the disturbance term of firm i. We assume that f is isotonic, but the functional form of f is unknown. The composite disturbance term εi=vi−uiconsists of inefficiency uiand noise vi. Specific assumptions regarding the disturbance term lead to different modeling approaches, as will be discussed in more detail below.Isotonicity is defined as follows. LetXbe a non-empty set of points xiinR+msoX=xi∈R+m. The production function f is isotonic with respect to the partial-order4Partial orderings are reflexive(xi≼xi,∀xi∈X), asymmetric (xi≼xi→xj≼xi,∀xi,xj∈Xunless in case xi=xjthat is called identitive) and transitive (xi≼xjandxj≼xk→xi≼xk,∀xi,xj,xk∈X), but differ from complete ordering in that all the points inXare not required to be comparable. Two points xiand xjinXare comparable if either xi≼xjor xj≼xi.4≼ onXifxi,xj∈X,xi≼xjimplies f(xi)⩽f(xj). Note that monotonicity (i.e., free disposability of inputs) and isotonicity are closely related but not exactly equivalent: if define the partial ordering as the standard dominance relation, xi≼xjif xi⩽xj, then we postulate a monotonic increasing production function that satisfies the free disposability axiom (Quentin, 2008). In general, however, the partial ordering could be based on some other criterion, for example, revealed or stated preference information. In this paper we use as the general notion of isotonicity, keeping in mind the monotonicity as an important special case.LetFbe the set of all real-value isotonic functions overXrespect to the partial ordering ≼. Assume the composite disturbance terms εi(i=1,…,n) are uncorrelated random variables with E(εi)=0 and Var (εi)=σ2<∞(i=1,…,n). The INLS regression for a given set of data (xi,yi) i=1,…,n is(2)minz=∑i=1nεi2s.t.yi=f(xi)+εii=1,…,n,f∈FThe isotonic regression problem (2) selects the best fit isotonic function with respect to the partial ordering ≼ for function f. The setFcontains an infinite number of functions, which makes problem (2) impossible to solve by brute force strategy.Denote the set of isotonic step functions byG=g:R+m→R+|g(x)=∑i=1nδiχ(xi),where χ(xi) is an indicator function defined asχ(xi)=1ifxi≼x,0otherwise,and δi>0, i=1,…,n, are parameter values that characterize the step height. Clearly,G⊂F. The following result (adapted from Barlow and Brunk, 1972) shows that we can harmlessly replace the class of isotonic functions(F)by its subset(G)in problem (2).Theorem 1Given a finite real-valued data set (xi,yi), i=1,…,n, letz∗,εi∗be the optimal solution of problem(2). There exists a step function g in the set of isotonic functionsGsuch that g is the optimal solution to problem(2)andz∗=∑i=1n(yi-g(xi))2.See Appendix 1.Theorem 1 establishes we can always find the optimal solution to problem (2) from the class of isotonic step functions(G), which is a subset of the class of isotonic functions(F). Since the step functions can be characterized by parameters δi, Theorem 1 allows us to convert the infinite dimensional problem (2) into a finite dimensional one. However, a more convenient parametrization is to introduce coefficients αi, i=1,…,n, such that g(xi)=αiand g(x)=max αis.t. xi≼x. Using this alternative parametrization, we can formulate the following finite-dimensional isotonic nonparametric least squares (INLS) problem:(3)min∑i=1nεi2s.t.yi=αi+εii=1,…,n,αi⩽αj∀i,jxi≼xjBy Theorem 1, the optimal solution to problem (3) provides one of the optimal solutions to problem (2). This formulation of the isotonic nonparametric regression problem helps us to reveal some formal relationships between parallel developments in the fields of isotonic regression and frontier estimation, which have not been noted before.From the computational point of view, the second constraint of the INLS problem (3) is a disjunctive constraint. Disjunctive constraints can be modeled in mathematical modeling languages such as GAMS and AIMMS by inserting a dollar sign as a conditional operator indices (see Alexander, 1983; Voss and Woodruff, 2006; and the manuals of the above mentioned software for details). Alternatively, we can also convert the disjunctive programming problem to a quadratic programming problem, but this requires an additional preprocessing step.Define the binary matrix P=[pij]n×nas follows(4)pij=1ifxi≼xj0otherwiseGiven matrix P, problem (3) can be formulated as a quadratic programming (QP) problem as follows(5)min∑i=1nεi2s.t.yi=αi+εii=1,…,n,pijαi⩽pijαj∀i,j=1,…,nNote that the disjunctive constraint (i.e., the second constraint of (3)) is now replaced by a constraint containing elements of matrix P, which converts the partial ordering ≼ between elements ofXinto binary values. This eliminates the need for disjunctive constraints. Note that if the partial ordering represents the preferences of a decision maker, as in the literature of multi-criteria decision-making, matrix P can be interpreted as a preference matrix. In the following, we use matrix P as defined above.In practice, the elements of matrix P (i.e., values pij) can be determined by a simple enumeration method to detect the dominance relations between observations. Tulkens (1993) shows that the MILP formulation of the FDH problem can be effectively solved by enumeration. In the FDH literature, enumerative algorithm for FDH are also available for the directional distance functions (Cherchye et al., 2001) and for different returns to scale assumptions (Keshvari and Dehghan Hardoroudi, 2008). By representing the dominance relationships by the elements of a binary matrix P, we see that prior enumeration of the dominance relations can help to reduce the computational burden of the INLS problem, too. While the disjunctive optimization problem (3) is computationally burdensome, the QP problem (5) can be solved by standard mathematical programming algorithms.Kuosmanen (2008) shows that the nonparametric least squares regression method that selects the functional form of the regression function from the family of continuous concave isotonic functions can be characterized by a the family of continuous piece-wise isotonic functions that satisfies the concavity conditions. Since the family of continuous concave isotonic functions is a subset of the family of continuous isotonic functions(F), we expect that CNLS can be obtained as a constrained variant of problem (3). In this section we prove that this is indeed the case.The set of continuous, monotonic increasing and globally concave functions overXis defined asF2={f∈F|f(txi+(1-t)xj)⩾tf(xi)+(1-t)f(xj)whent∈[0,1]∀xi,xj∈X}.Note thatF2⊂F. The CNLS problem is(6)min∑i=1nεi2s.t.yi=αi+βi′xi+εii=1,…,n,αi+βi′xi⩽αj+βj′xii,j=1,…,n,βi⩾0i=1,…,nwhereβi(i=1,…,n) is a vector of nonnegative coefficients that together with αicharacterize a supporting hyper plane of the unknown concave function to be estimated in point xi. In this problem, the first constraint is the regression equation that specifies the locations of the estimates on the hyper planes. The second constraint is the concavity condition that is a system of Afriat inequalities (Afriat, 1972).To relax the concavity assumption of CNLS, we need to modify the second constraint of (6). Recall the preference matrix P defined in (4). Applying enumeration methods to define the elements of matrix P as discussed in the previous section, we solve the following QP problem:(7)min∑i=1nεi2s.t.yi=αi+βi′xi+εii=1,…,n,pijαi+βi′xi⩽pijαj+βj′xj,i,j=1,…,n,βi⩾0i=1,…,nNote that the concavity constraint between units i and j is relaxed by setting pij=0 in problem (7): if pij=1 for all i and j, then problem (7) reduces to (6). For a given matrix P, problem (7) is a QP problem with linear constraints, which can be solved by the standard mathematical programming algorithms. In the next lemma, we show the connection between CNLS and INLS by restricting the concavity condition.Lemma 1If matrixPis specified according to(4), then problem(7)is equivalent to the INLS problem(5).See the online Appendix 1.While the QP formulation (5) developed in the previous section is simpler and computationally less demanding than problem (7), formulation (7) is more general in that it contains the CNLS problem as its special case. Besides the conceptual link to CNLS, there may be other benefits of the more general formulation. In particular, we note that the INLS problem (7) could prove a useful starting point for imposing additional assumptions concerning returns to scale (RTS), following Kerstens and Vanden Eeckaut (1999). Note that the intercept terms αiare unrestricted in problem (7), which corresponds to the variable returns to scale case (VRS). In the convex CNLS problem (6), one can enforce the supporting hyperplanes characterized by vectorsβito pass through the origin by imposing additional constraints αi=0 for all i=1,…,n, which effectively imposes constant returns to scale (CRS) (see Kuosmanen and Kortelainen, 2012). Analogously, the constraints αi⩾0 [αi⩽0] for all i=1,…,n inserted to problem (6) impose non-increasing returns to scale (NIRS) [non-decreasing returns to scale, NDRS]. Unfortunately, modeling the RTS properties proves more challenging in the case of the nonconvex INLS estimator: imposing additional constraints on parameters αidoes not generally suffice. We leave the extension of the INLS problem to alternative RTS assumptions as an interesting research question for future research.We illustrate the INLS method by a simulated example where the true frontier f is a logistic function, all units are efficient, and the data are perturbed by noise (additional simulated examples are presented in the Supplementary material, which is available online at: http://www.sciencedirect.com). Specifically, we assume y=2+3/(1+e6−x)+v where v is a normally distributed random variable with a zero mean and the standard deviation of 0.7. The number of observations is 100. The values of input x are randomly drawn from the uniform distribution between 1 and 10. Fig. 1illustrates the true frontier and the estimated INLS function with the solid and the dashed lines, respectively. The INLS function is a step function that approximates the S-shape of the true function. The INLS estimator is statistically consistent: it converges to the true function as the number of observation increases (Robertson and Wright, 1975).FDH is a well-known nonparametric approach in productive efficiency analysis. The link between the non-convex FDH and convex DEA is well understood (e.g., Tulkens, 1993). On the other hand, the step-wise structure of the FDH frontier is very similar to the shape of the INLS estimator. We will next formally show that the FDH production frontier is a sign constrained version of INLS.The first definition and mathematical formulation of the axiomatic nonparametric non-convex frontier production function was presented by Afriat (1972) as(8)fA(x)=maxjyj.s.t.xj⩽xTulkens (1993) introduced the mixed integer linear program (MILP) formulation of FDH(9)maxφis.t.Xλ⩽xi,Yλ⩾yiϕi,1λ=1,λj∈{0,1}j=1,…,nwhere X=[x1,x2,…,xn] is the matrix of inputs, Y=[y1,y2,…,yn]′ is the matrix containing n output vectors (the multiple output setting) andλ=[λ1,λ2,…,λn]′ is the vector of intensity weights. Ifφi∗,λ∗indicates the optimal solution of problem (9) the efficiency of firm i is1/φi∗.In the single-output case, denote the estimated FDH frontier for firm i byfiFDH=yiφi∗. In this case, the FDH frontier turns out to be equivalent to the Afriat (1972) production function introduced in (8).Lemma 2In the single output case, the Afriat production function(8)is equivalent to the FDH production function characterized by(9), specifically,fA(xi)=fiFDH.See the online Appendix 1.In the past two decades, several alternative formulations and extensions of FDH have been developed (e.g., Leleu, 2006). Agrell and Tind (2001) were the first to note that the MILP problem (9) can be linearized, and solved using linear programming. We will next show that FDH can be recast as a sign-constrained regression, analogous to the parametric programming model by Aigner and Chu (1968) and the regression interpretation of DEA presented by Kuosmanen and Johnson (2010).Consider the following sign constrained isotonic nonparametric least squares problem(10)min∑i=1nεi2s.t.εi⩽0i=1,…,n,yi=αi+εii=1,…,n,pijαi⩽pijαj∀i,jwhere the values of pijare specified according to (4). Note that the only difference between problem (10) and the INLS problem (3) is the first constraint (εi⩽0 i=1,…,n).For a given real-valued data set (xi,yi), i=1,…,n, letφk∗be the output distance of firm k relative to the FDH frontier, obtained as the optimal solution to the MILP problem(9), and letεk∗be the residual of firm k obtained from the sign constrained INLS problem(10). Problems(9) and (10)are equivalent formulations of the FDH frontier, and the radial output distance satisfiesφk∗=1-εk∗/ykandεk∗=yk1-φk∗.See the online Appendix 1.Lemma 3 is a parallel result to Theorem 3.1 in Kuosmanen and Johnson (2010). Based on Lemma 3, the optimal solutions of problems (9) and (10) indicate the same point as the reference point of firm k and we also note thatαk∗=ykφk∗. Thus, if we denote the production function from problem (10) by g and efficient frontier from problem (9) by f there is g(xk)=f(xk). Thus, we can interpret FDH as a sign constrained version of monotonic INLS regression, in the same way as DEA is a sign constrained variant of CNLS (compare with Kuosmanen and Johnson, 2010).In this section we apply INLS and the insights gained in the previous section to frontier estimation. In Section 6.1 we consider the deterministic case without noise, and extend the corrected convex nonparametric least squares (C2NLS) by Kuosmanen and Johnson (2010) to the non-convex case. In Section 6.2 we consider the stochastic case with noise, and extend the StoNED method by Kuosmanen and Kortelainen (2012) to the non-convex case. Readers familiar with the previous works cited above may skip or browse through these sections. In Section 6.3 we briefly discuss the modeling of heteroskedasticity in the present context.Corrected ordinary least squares (COLS) is a method for estimating the frontier by correcting the results of OLS and shifting the production function to cover the data points, initially suggested by Winsten (1957) and rigorously examined by Greene (1980). Kuosmanen and Johnson (2010) extended the COLS approach to the context of nonparametric CNLS, introducing the C2NLS method. Kuosmanen and Johnson show in the deterministic setting with no noise that the C2NLS estimator is consistent and asymptotically unbiased. In this section we extend this approach to non-convex technologies. The proposed method is referred to as corrected isotonic nonparametric least squares (CINLS).The proposed CINLS method consists of the following two stages:Stage 1:Estimate production function by solving INLS (problem (5)). Denote the optimal residuals and optimal values of αibyεiINLSandαiINLS, respectively.Shift the estimated production function by introducing the new values for the residuals asεiCINLS=εiINLS-maxhεhINLS. Further, the new estimation for the frontier is(11)fiCINLS=αiINLS+maxhεhINLS.The differences between COLS, C2NLS and CINLS concern the first stage where the production function is estimated. Thus, CINLS can be seen as an isotonic variant of C2NLS, obtained by replacing CNLS in the first stage by INLS.Statistical consistency of the FDH estimator has been studied in Korostelev et al. (1995), Park et al. (2000), and Simar and Wilson (2000). The consistency of INLS estimator is studied in several studies, for instance, Barlow et al. (1972), Robertson and Wright (1975), and Robertson et al. (1988), and the consistency of the second stage estimator is studied in Greene (1980). Therefore, the CINLS estimator, as defined before, is a consistent estimator, provided that the assumptions required for consistency in each stage are satisfied. Since the statistical assumptions of CINLS do not differ from those of C2NLS, we do not prove consistency of CINLS formally in this paper, but refer to the consistency result for the parallel C2NLS estimator Kuosmanen and Johnson (2010, Theorem 4.1). In essence, consistency of the first stage INLS estimator requires that inputs do not correlate with inefficiency. Consistency of the second stage requires that the inefficiency term is identically and independently distributed, and has a positive density at u=0. Kuosmanen and Johnson (2010, p. 154) provide a detailed discussion of these statistical assumptions, as well as possible violations and remedies.Theorem 2 shows that the CILNS estimator provides a frontier that is always above the estimated value by FDH.Theorem 2For every observationi=1,…,n,fiFDH⩽fiCINLS.See the online Appendix 1.The FDH frontier that is the tightest monotonic envelope of observations, and thus it is always less than or equal to the CINLS frontier. Both estimators satisfyfiFDH⩾yiandfiCINLS⩾yi. Theorem 2 shows that the number of efficient firms is always smaller in CINLS than in FDH. More precisely, the number of efficient firms in CINLS is equal to the cardinality of the setargmaxhεhINLS. Typically, there is only a single efficient firm in CINLS and the other firms are inefficient. Thus, CINLS has considerably higher discriminating power than FDH. Further, the number of efficient units with CINLS frontier is smaller than or equal to the number of the FDH efficient units – typically much smaller. In Section 7 we will illustrate the FDH and CINLS frontiers and show that only a small portion of FDH efficient units are CINLS efficient.In this section we introduce the non-convex StoNED method as an extension of isotonic regression to the setting where the composite error term contains an asymmetric inefficiency term and a random noise term, analogous to SFA (Aigner et al., 1977) and convex StoNED (Kuosmanen and Kortelainen, 2012). Specifically, the composite error term εican be written asεi=vi-ui,where ui>0 is the asymmetric inefficiency term and viis the noise term. Thus, the stochastic frontier model is(12)yi=f(xi)-ui+vi(i=1,…,n).We deviate from standard SFA in that we do not assume a specific functional form for f. Further, we do not assume concavity of f, in contrast to Kuosmanen and Kortelainen (2012). The inefficiency and noise terms are conventionally assumed to be identically and independently distributed random variables that are uncorrelated with each other and with the inputs xi.5It is worth to note that the i.i.d. assumption of the inefficiency and noise terms can be empirically tested (Peyrache and Coelli, 2009) and/or relaxed (Smith, 2008) by appropriate parameterization of the composite error term.5The inefficiency term uiis assumed to be half-normally distributed with varianceσu2(alternative distributional assumptions are available in the SFA literature, and could be adopted in the present context as well). The noise term viis assumed to be normally distributed with the zero mean and the varianceσv2.Denoting the expected value of u by μu, we define g(x)=f(x)−μuas a mean adjusted version of function f. By construction, g(xi)=E(yi∣xi) for all observations i, and thus the function g is a regression function. Noting further that yi=[f(xi)−μu]+[μu−ui+vi] and E (μu−ui+vi)=0, we can apply a least squares estimator for estimating g. Our proposition is to apply INLS in the case of non-convex technology.More specifically, the non-convex StoNED method consists of the following two stages:Stage 1:Estimate the inefficiency of observation by estimating function g using INLS,Estimate the parameters of the inefficiency term uiand the disturbance term viusing method of moments (or pseudolikelihood technique) and the residuals of the INLS estimations, and then adjust the step function estimated by INLS by the expected value of inefficiency.The first stage is conducted by solving problem (5) to estimate the INLS step function. Thus, we next briefly elaborate the second stage, focusing on the method of moments estimation (for a detailed discussion about the pseudolikelihood estimation, we refer to Fan et al. (1996) and Kuosmanen and Kortelainen (2012)). Under the assumptions of a half-normal inefficiency and normally distributed noise, the third central moment of the distribution of the composite error term (M3) relates to the variance of the inefficiency term u asM3=2/π(1-4/π)σu3.We can estimate M3 using the INLS residuals(νˆi)asM^3=∑i=1n(νˆi-E(νˆi))3/n.Hence, an unbiased estimators of the standard deviations of the inefficiency term isσˆu=M^32/π(1-4/π)3,Givenσˆu, the non-convex StoNED frontier is obtained by simply shifting the INLS step-function (the estimatedαiINLS) upwards asfiN.StoNED=αiINLS+σˆu2/π,whereσˆu2/πis an unbiased estimator of the expected value μu.It is worth emphasizing that measuring distance from an observed point (xi,yi) to the stochastic frontier such asfiN.StoNEDcaptures both inefficiency and noise. In many applications, the frontier production (or cost) function provides useful information. To obtain firm-specific efficiency estimates, we may apply the conditional expected value formula developed by Jondrow et al. (1982). Although the unconditional expected value of inefficiency is a constant μu, the conditional expectation of the inefficiency term isE(ui|εi)=μ∗+σ∗ϕ(-μ∗/σ∗)/[1-Φ(-μ∗/σ∗)],where μ∗ and σ∗ are the mean and standard deviation of the zero-truncated normal distribution, specifically,μ∗=-εiσu2/σu2+σv2,σ∗=σuσv/σu2+σv2,and ϕ and Φ are the standard normal density and cumulative distribution functions, respectively. Given the INLS residuals, the conditional expected value of the inefficiency term can be calculated as(13)E(ui|εˆi)=σˆuσˆvσˆu2+σˆv2ϕ-εˆiσˆu/σˆvσˆu2+σˆv21-Φ-εˆiσˆu/σˆvσˆu2+σˆv2-εˆiσˆuσˆvσˆu2+σˆv2,whereεˆi=vˆi-σˆu2/πis the estimator of the composite error term in model (12). A careful reader notes that Eq. (13) is slightly different from Eq. (18) in Kuosmanen and Kortelainen (2012). There is an error in Kuosmanen and Kortelainen (2012) formula, Eq. (13) is the correct expression.We have assumed throughout the paper that the error terms are homoscedastic, that is, Var (εi)=σ2 is constant across all observations i=1,…,n. This is a standard assumption both in regression analysis and in the parametric literature of frontier estimation (e.g., Aigner et al., 1977). A violation of homoscedasticity is called heteroscedasticity. In practice, the inefficiency and/or the noise term may be heteroscedastic. Thus, the possibilities to test for or relax the homoscedasticity assumption deserve a brief elaboration here.If the composite error term is heteroscedastic, the INLS estimator remains unbiased and consistent, similar to OLS. However, adjusting the regression function to the frontier in the second stages of the CINLS and non-convex StoNED methods rely on homoscedasticity. Therefore, it is critically important to test for heteroscedasticity in any empirical work. The usual econometric tests of heteroscedasticity (such as the White or the Breusch-Pagan test) can be applied to the INLS residuals. Indeed, we emphasize that heteroscedasticity is not a maintained assumption that must be taken by faith, it is an empirical hypothesis that can be subjected to a statistical test.If significant heteroscedasticity is found, one could try to restore homoscedasticity through data transformations or use an alternative model specification (e.g., specify the composite error term in a multiplicative rather than additive form). Another possibility is to specify a parametric model of heteroscedasticity, which can be estimated based on the INLS residuals, and then apply firm-specific variance parameters. In this case, the expected value of inefficiency is also firm-specific. In the non-convex StoNED, the INLS step function can be adjusted upward to the frontier by firm-specific correction factors, and thus the shapes of the INLS function and the frontier are no longer the same under heteroscedasticity. However, the assumed model of heteroscedasticity is such that the variance of the composite error term is a monotonic function with respect to the input variables. Monotonic heteroscedasticity ensures that both the frontier f(xi) and the regression function g(xi)=E(yi∣xi) are monotonic increasing functions of inputs, and thus function g can be consistently estimated by INLS.Note that the convex StoNED method would additionally require that the variance of the composite error term is a concave function of inputs. Therefore, it is worth to note that non-concave heteroscedasticity may violate the concavity of the regression function even if the frontier function f is concave. To our knowledge, heteroscedasticity has not been recognized before as a possible source of non-convexity in the axiomatic literature. Although the deterministic DEA and FDH methods do not take heteroscedasticity explicitly into account, it is obvious that heteroscedasticity does affect performance of these estimators (see, e.g., Monte Carlo simulations reported in Kuosmanen and Kortelainen, 2012, Section 5). While the frontier-shifting approaches such as MOLS, StoNED, and the CINLS and non-convex StoNED suggested in this paper may provide biased estimates if heteroscedasticity is present but ignored, the fact that heteroscedasticity can be tested and explicitly modeled using the standard econometric techniques based on the CNLS or INLS residuals does also present some advantages – to be examined in detail in future research.In this section we compare the FDH, CINLS and non-convex StoNED methods in the controlled environment of Monte Carlo simulations. Additional simulation examples for illustration purposes are presented in the Supplementary material, which is available online at: http://www.sciencedirect.com.The data generation process used in our simulations follows that of Simar and Zelenyuk (2011). We consider models involving one and two input variables, both with or without the noise term. As our primary performance statistics, we use the root mean square error (RMSE) of the estimatefi,tEst(Est=FDH, CINLS, N.StoNED) for observation i in replication t proportional to the true value of production function fiRMSE=1M∑t1n∑ifi,tEst-fi20.5The proportional RMSE statistic measures the average distance between the true frontier and and the estimated one in the randomly generated data points. RMSE is always greater than or equal to zero; small RMSE values indicate high precision. To facilitate comparisons with Simar and Zelenyuk (2011) and Kuosmanen and Kortelainen (2012), we also measure performance of methods in terms of the absolute mean squared error (MSE) and Bias, defined asMSE=1M∑t1n∑ifi,tEst-fi2,Bias=1Mn∑t∑ifi,tEst-fi.In this paper we set n=100 and M=100, which means that each scenario includes 100 randomly generated observations and each scenario is replicated 100 times, resulting as 10,000 data points in total.We first examine performance of the deterministic FDH and CINLS methods in scenarios involving no noise. Four alternative scenarios are considered:•Cobb–Douglas, single input:yi=xi0.5-ui, xi∼Uni(1,6), ui∼∣N(0,0.52)∣.Cobb–Douglas, two inputs:yi=x1i0.5x2i0.5-ui, x1i, x2i∼Uni(1,6), ui∼∣N(0,0.52)∣Logistic function, single input:yi=1+e7e7e-3+10xi1+e-3+10xi-ui, xi∼Uni(0,1), ui∼∣N(0,0.52)∣Logistic function, two inputs:yi=1+e7e7e-3+10x1i+10x2i1+e-3+10x1i+10x2i-ui, x1i, x2i∼Uni(0,1), ui∼∣N(0,0.52)∣Note that the Cobb–Douglas (CD) function satisfies concavity, and hence the DEA and StoNED estimators could be applied in the two CD scenarios. The logistic function violates concavity, and hence FDH or CINLS are the most appealing candidates in the logistic scenarios.The results of these four deterministic scenarios are reported in Table 2. Consider first the proportional RMSE and the absolute MSE statistics. In the case of the Cobb–Douglas function, both FDH and CINLS achieve a reasonably good precision with only 4–8% error in the frontier estimates according to the proportional RMSE statistics. However, the relative RMSE statistics of both estimators increase dramatically in the case of the logistic function. We find this result somewhat surprising, as we would expect FDH and CINLS to perform to perform equally well in the cases of convex and non-convex frontier functions. The only explanation we can suggest for this finding relates to the scaling of the inputs and the true frontier in the logistic case. The simulated examples presented in Appendix 2 (see the Supplementary material online) can help to illustrate that, for relatively small input levels (x< 5), the proportional estimation error can be much higher in the case of the non-concave frontier than in the concave frontier. Note that the RMSE measures precision of the estimates proportionate to the true frontier, and hence the scaling of the true frontier obviously influences the performance measure. In contrast, note that the absolute MSE statistics reported in Table 2 are systematically smaller in the logistic case than in the Cobb–Douglas case.In both Cobb–Douglas and logistic cases, the FDH estimator yields somewhat better precision in terms of RMSE and MSE than CINLS in the single input case, whereas CINLS wins in the two input scenario. Regarding the bias, it is well known that the FDH estimator is downward biased, and our simulations confirm this fact. Our simulation results suggest that the proposed CINLS estimator tends to be upward biased, at least in the four scenarios considered here. Our intuitive explanation is the following. In the first stage, the INLS estimator is not systematically biased in either direction, but the use of the maximum residual in the second stage will likely select as a benchmark such an observation for which INLS underestimates the true conditional expectation of the output y. Although the second stage is not systematically biased as such, the transition from stage one to stage two, involving the selection of the observation with the maximum residual as the benchmark, seems to be the source of the positive bias. It would be interesting to examine the bias of the CINLS estimator more rigorously, but this is left as a topic for future research.We next examine performance of the non-convex StoNED method in the noisy environment. The following four scenarios are identical to those of the previous section, except for a random noise term that is added to the data generation process of output y. The four scenarios are the following:•Cobb–Douglas, single input:yi=xi0.5-ui+vi,xi∼Uni(1,6),ui∼Exp(1/6),vi∼N0,σv2Cobb–Douglas, two inputs:yi=x1i0.5x2i0.5-ui-vi,x1i,x2i∼Uni(1,6),ui∼Exp(1/6),vi∼N0,σv2Logistic function, single input:yi=1+e7e7e-3+10xi1+e-3+10xi-ui+vi, xi∼Uni(0,1), ui∼Exp(1/6),vi∼N0,σv2Logistic function, two inputs:yi=1+e7e7e-3+10x1i+10x2i1+e-3+10x1i+10x2i-ui+vi,x1i,x2i∼Uni(0,1),ui∼Exp1/6,vi∼N0,σv2In order to take into account the signal to noise, we examine two noisy scenarios usingσv2=0.1044(low noise) andσv2=0.2089(high noise), similar to Simar and Zelenyuk (2011) and Kuosmanen and Kortelainen (2012). Note that in these simulations we use a misspecified distribution for the inefficiency term: we assume the half-normal distribution of u in the estimation of non-convex StoNED, whereas the true distribution of u is exponential.The results of the simulations are reported in Table 3. The proportional RMSE deteriorates dramatically when we move from the Cobb–Douglas to the logistic case, similar to the deterministic scenarios reported in Table 2. However, such dramatic change does not occur in the absolute MSE statistics. The bias of the non-convex StoNED can be positive or negative.To put the results of Table 3 to perspective, we note that the non-convex StoNED yields the proportional RMSE values in the range of 5–10% in the Cobb–Douglas case, which is only slightly worse than the 4–8% range of RMSE figures reported for FDH and CINLS in Table 3. In this light, precision of the non-convex StoNED in the noisy scenarios is very promising. We must emphasize that the introduction of random noise presents a major challenge, and would completely spoil the good performance of FDH and CINLS achieved in the deterministic scenarios. For example, in the simulations reported by Simar and Zelenyuk (2011), Table 2), the MSE of the FDH estimator increases by factor 5 when one moves from the no noise scenario to the low noise scenario, and by factor 9 when moving from the low noise to high noise scenario. For comparison, the MSE of non-convex StoNED increases approximately by factor 2 when we move from the low noise to the high noise scenarios in Table 3; note that the noise to signal ratio also increases by factor 2.It is also interesting to compare the MSE statistics of Table 3 with those reported in Kuosmanen and Kortelainen (2012), Section 5, and Simar and Zelenyuk (2011), Section 3. As a general remark, the performance of non-convex StoNED in terms of both MSE and bias appears to be competitive to other semi-nonparametric estimation methods available in the recent literature. However, we must stress that the MSE and bias statistics reported in different papers should be compared with great caution. Although we have replicated the data generation process of Simar and Zelenyuk (2011) as closely as possible, one deviation is worth noting: we use an additive specification of the composite error term to be consistent with the model specification introduced in Section 2, Eq. (1), and leave the multiplicative specification of CINLS and non-convex StoNED as a topic for future research. We note that the simulation results can be sensitive to the specification of the data generation process, including the scale of the input variables and the distributional assumptions, as the comparison of the RMSE statistics in the Cobb–Douglas and logistic scenarios aptly illustrates. Finally, we note that the results reported by Simar and Zelenyuk (2011) are obtained by using the theoretically optimal bandwidth value, which in known in the simulated environment, but must be estimated from data in real applications. In contrast, the nonparametric least squares estimators developed in Kuosmanen and Kortelainen (2012) and in this paper do not require estimation of any smoothing or bandwidth parameters.

@&#CONCLUSIONS@&#
This paper examines the estimation of non-convex frontier technologies in the presence and absence of stochastic noise. First, we extended the classification of methods for estimating the production functions introduced by Kuosmanen and Johnson (2010) to non-convex technologies. This classification (see Table 1 above) includes a family of methods, which can be used for estimating the production function in different settings and under different assumptions. We believe this classification contributes to a better understanding of the relationships between different approaches known in the literature. In particular, we have introduced the isotonic nonparametric least squares (INLS), which is a regression technique to estimate step functions, and established its relationship with the free disposal hull (FDH) method. Specifically, we showed that the FDH estimator can be obtained as a sign-constrained variant of INLS regression. This link further enhances the connection between nonparameric regression and axiomatic frontier estimation.The second contribution of our paper is the development of two new methods for estimating the frontier of non-convex technologies: the corrected INLS (CINLS) and the non-convex stochastic nonparametric envelopment of data (non-convex StoNED). Both methods involve two-stage estimation, applying the INLS regression in the first stage, but differ in terms of how the INLS step function is shifted upward to characterize the frontier.The CINLS method requires a very strong assumption of no noise. As stochastic noise is present in virtually all thinkable real world applications, the CINLS method is mainly introduced for academic curiosity, as a counterpart to the deterministic FDH method. In the second stage of CINLS, we employ the maximum value of the INLS residuals to shift the estimated INLS step function. Thus, the CINLS frontier envelopes all data points, similar to FDH. While the average efficiency scores of CINLS and FDH are similar in our experiments, the number of efficient firms in CINLS is typically much smaller than the number of FDH efficient firms. We have formally shown that the CINLS estimator has a higher discriminatory power than FDH in any arbitrary real valued data. However, it is worth to emphasize that the higher discriminating power does necessarily imply better precision.Another new method proposed in this paper is the non-convex StoNED, which takes stochastic noise explicitly into account. In non-convex StoNED, we use the INLS residuals from the first stage to estimate the variance parameters of the inefficiency and noise terms. Subsequently, we shift the INLS step-function upwards according the expected value of inefficiency to obtain a consistent estimator of the frontier. We can also apply the conditional expected value formula by Jondrow et al. (1982) to obtain firm-specific estimates of inefficiency.We believe this paper opens up several interesting avenues for further research. We have suggested using the INLS and CNLS regression as instruments for statistical testing of the convexity assumption. However, formal development of a statistical test falls beyond the scope of the present paper. Another interesting line of research is to explore the intermediate cases between INLS and CNLS, for example, estimation of quasi-convex functions. Further, extending the notion of selective convexity, which imposes convexity between a subset of inputs and/or outputs, to the present setting would be interesting. Extending our approach to the multi-output setting is yet another important avenue for future research. Since INLS is a computationally demanding method, developing more efficient computational algorithms for large-scale problems presents a interesting challenge. The statistical properties of the INLS and non-convex StoNED deserve further attention. Finally, we hope that the proposed approach could provide useful managerial insights and/or policy recommendations when applied to real world data.Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2013.06.005.Appendix 1: Proofs of theorems and lemmas.Appendix 2: Simulated examples.