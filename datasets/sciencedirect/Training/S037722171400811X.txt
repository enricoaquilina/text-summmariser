@&#MAIN-TITLE@&#
On finite-time ruin probabilities in a generalized dual risk model with dependence

@&#HIGHLIGHTS@&#
A ruin-probabilistic duality between insurance and dual risk models is established.Assumptions on the inter-arrival times and/or the capital gains allow dependence.Closed-form expressions for the probability of non-ruin in both models are obtained.The ruin probability results are used to determine alarm time(s) and risk capital.All results are thoroughly numerically tested and illustrated.

@&#KEYPHRASES@&#
Dual (dependent) risk model,Finite-time ruin probability,Capital allocation,Alarm time,(Exponential) classical Appell polynomials,

@&#ABSTRACT@&#
In this paper, we study the finite-time ruin probability in a reasonably generalized dual risk model, where we assume any non-negative non-decreasing cumulative operational cost function and arbitrary capital gains arrival process. Establishing an enlightening link between this dual risk model and its corresponding insurance risk model, explicit expressions for the finite-time survival probability in the dual risk model are obtained under various general assumptions for the distribution of the capital gains. In order to make the model more realistic and general, different dependence structures among capital gains and inter-arrival times and between both are also introduced and corresponding ruin probability expressions are also given. The concept of alarm time, as introduced in Das and Kratz (2012), is applied to the dual risk model within the context of risk capital allocation. Extensive numerical illustrations are provided.

@&#INTRODUCTION@&#
Research on the so called dual risk model is recently attracting increasing attention. Substantial amount of work has been devoted to finding the ruin probability and optimal dividend strategies under the dual risk model. The name “dual risk model” stems from its duality to the insurance risk model. In the classical insurance risk model, the surplus or risk process, R(t) of an insurance company at time t is(1)R(t)=u+ct−S(t),t≥0,where u denotes the initial capital, c is a constant premium income rate andS(t)=∑i=1N(t)Ziis the aggregate claim amount process, where N(t) is a homogeneous Poisson process and the Zi’s are i.i.d. consecutive claim sizes. More general assumptions on the insurance risk model, e.g. non-linear aggregate premium income and non-homogeneous, possibly dependent claim amounts have been considered by Ignatov and Kaishev (2000); 2004) and Lefèvre and Picard (2006). By reversing the signs of the premium inflow term and the aggregate claim severity process in (1), the surplus in the classical dual risk model, first considered by Takacs (1967), is defined as(2)R(t)=u−ct+S(t),t≥0,whereS(t)=∑i=1N(t)Zi,and the interpretation of the terms in (2) is as follows. It is assumed that a company operating in a certain industry holds initial capital u and is subject to operational expenses accumulating in time at a rate c. As a result of its activity, the company receives capital gains of sizes Zi, i = 1, 2, …, assumed i.i.d. random variables, arriving according to a homogeneous Poisson process, N(t) with rate λ. What is nice about such a dual risk model is that it is more generally applicable to modelling the surplus of any company, not necessarily from the insurance sector. As noted by Avanzi et al. (2007), while the insurance risk model is suitable for insurance companies, the dual risk model describes well the operation of companies specializing in geological exploration of minerals and petroleum, pharmaceutical research, and technological discoveries and inventions, where routine operations generate continuous expenses over time and occasional discoveries or inventions bring stochastic capital gains to the company. It can also be applied in modelling the operation of research and development departments from companies in other industries. Or alternatively, these could be banks, hedge funds or other investment institutions, receiving capital gains from their investment and other financial operations, while at the same time experiencing permanently accumulating operational expenses.Both the insurance and the dual risk models are also relevant to operational research problems, e.g. in systems reliability risk analysis and inventory and supply chain risk management. For example, slowdowns and server failures in computer networks, occurring at some random moments and disrupting electronic business transactions may generate losses modelled by an aggregate loss process, S(t). In general, losses from systems failures can be measured in different units, lost production time, volumes of defective units, lost customers, financial losses due to credit defaults, etc. As noted by Todinov (2006), “maximizing the reliability of a system does not necessarily minimize the losses from failures”. The author’s approach to modelling the systems reliability is based on maximizing the profit (i.e. surplus) expected to emerge from its operation, which can directly be modelled by R(t) from (1) and its more general version considered in Section 2. A further natural extension of this reliability problem is to consider maximizing the expected profit, given the system’s survival, which can be addressed based on the results provided in this paper. An appropriate compound aggregate loss distribution, S(t) has also been used by Dutang et al. (2013) to model the competition among non-life insurance companies, for policyholders in a noncooperative game.One of the central quantities of interest, related to the operation of a firm is the probability of its failure also referred to as ruin. Generally ruin occurs when the company’s surplus process, R(t) becomes negative for the first time, within a finite or infinite time horizon. The literature on ruin probability is vast. Ruin problems under different assumptions on the underlying surplus/risk model have been considered in a number of contributions. Cifarelli et al. (2002) assume that the value of a firm, which can be viewed as a model of its surplus, obeys a stochastic differential equation under which ruin occurs when the firm value hits the zero barrier. Diasparra and Romera (2010) consider ruin probabilities in a controlled discrete-time insurance risk process with interest rate modelled by a Markov chain. Huang et al. (2009) consider mean probability of ultimate ruin under Poisson claim arrivals and claim amounts modelled by fuzzy random variables. Some of the numerous further contributions to ruin probability research are summarized in the monograph by Asmussen and Albrecher (2010).In what follows, we will concentrate on the dual risk model and will provide a brief overview of some recent contributions to the related literature. Various generalizations of the classical dual risk model have been introduced, such as dependence structures between capital gains and inter-arrival times, Markovian features and diffusion terms in the surplus process. As in the insurance risk model, ruin probability under the dual risk model has also attracted considerable attention. Mazza and Rullière (2004) consider ruin in both the classical insurance and dual risk models and establish a link between them based on wave governed random motion. Dong and Wang (2008) are concerned with the ultimate ruin probability in a dual risk model with generalized assumptions on the capital gain arrival process. Starting from a general renewal process N(t), integral equations and integro-differential equations are derived for the probability of ruin and survival over infinite-time horizon. As special cases, the Erlang(n) renewal process and the Poisson process are considered. The latter relates to the classical dual risk model and in this case closed-form expression for the ultimate survival probability is obtained. Zhu and Yang (2008) consider a dual Markov-modulated risk model, where both the expense rate and the distribution of the gains are determined by a m-state Markov process, and the conditional ruin probabilities, conditioning on the initial state, over both finite and infinite horizon are studied. Since, as noted by the authors, it is difficult to obtain these quantities explicitly, a likelihood ratio approach is applied, where martingales of exponential form based on the surplus process need to be found first and finite-time and ultimate ruin probabilities are then obtained by change of measure. Lundberg upper and lower bounds are also derived for the ultimate probabilities of ruin. Afonso et al. (2013) consider the classical dual risk model with linear expense outgo function and compound Poisson capital gain process, and study its corresponding quantities of interest, such as the ultimate ruin probability, total expected discounted dividend payments under a barrier strategy, probability of receiving a dividend payment and the distributions of the number and the sizes of dividend payments.Attention has also been paid to the dual risk model assuming dividend payments with a focus at finding an optimal dividend paying strategy. For example, Yao et al. (2011) consider the dividend payments and capital injections control problem in a dual risk model. Further contributions in this strand of literature include Albrecher et al. (2008),Avanzi et al. (2007),Bayraktar and Egami (2008),Dai et al. (2010),Dong and Liu (2010),Wen (2011) and Yang and Sendova (2014).In this paper, we consider a generalized dual risk model assuming any non-negative non-decreasing cumulative operational cost function and arbitrary capital gain arrival process and focus on the ruin probability over a finite horizon, which to the best of our knowledge has not been considered before. First, by establishing an enlightening connection between the two models, a trajectory hitting an upper bound and a trajectory hitting a lower bound, we link the dual risk model with its corresponding insurance risk model. It is worth mentioning that in Mazza and Rullière (2004), both the classical insurance risk model and its corresponding dual risk model are studied and a link between these two models is given based on a wave governed random motion. Our demonstration of the connection is different, more straightforward and applies under more general assumptions. By revisiting the formulas of survival probability in two reasonably general insurance risk models considered by Ignatov and Kaishev (2004) and Ignatov and Kaishev (2012), we obtain explicit formulas for the finite-time survival probability in our generalized dual risk model for exponential and Erlang capital gains, in terms of classical Appell polynomials and the so-called exponential Appell polynomials, respectively. These results are shown to be special cases of the finite-time survival probability formula which we derive in the case when capital gains follow a linear combination of exponential distributions or a hyperexponential distribution. The latter formula is then used to obtain the survival probability for arbitrarily distributed capital gains, including heavy-tailed families. We further relax the independence assumptions and introduce certain dependence structures between capital gains and/or inter-arrival times. Under these dependence assumptions we provide closed-form expressions for the survival probability. Finally, we address the problem of risk capital allocation in the dual risk model, which to the best of our knowledge, has not been previously considered in the literature. We base our approach on the ideas of Kaishev et al. (2008) of distributing the initial capital over a finite-time horizon without affecting a fixed desired sufficiently high level of survival probability in the insurance risk model. These ideas have been further extended by Das and Kratz (2012), who introduced the concepts of alarm time, and early warning systems to the problem of risk capital allocation. In this paper, we transfer these ideas and concepts to the dual risk model and illustrate them numerically.To summarize, our main contributions are three-fold. First, we provide Lemma 2.1 which is new and extends further the duality insight, providing an elegant way of establishing explicit ruin probability results (see e.g. formulae (7), (9) and (11)) which have not been previously known in the dual risk modelling literature. Second, we prove Lemma B.1 which is new and generalizes the result of Ignatov and Kaishev (2012) for the finite-time ruin probability in the insurance risk model, to the case of inter-arrival times distributed as linear combinations of exponential random variables. This result is important on its own right, and combining it with Lemma 2.1 has allowed us to establish Proposition 2.2 which gives a new ruin probability formula for the dual risk model, also with arbitrarily distributed capital gains. Third, we have introduced the notion of alarm time, defined previously by Das and Kratz (2012) for the insurance risk model, to the context of the dual risk model and the related capital allocation problem.This paper is organized as follows. In Section 2, we introduce our general dual risk model and related assumptions and notations, and give Lemma 2.1. The latter is used to obtain explicit formulas for the finite-time ruin probability in our dual risk model, under various assumptions on the distribution of the capital gains (see Sections 2.1–2.2). In Section 2.3, we introduce some interesting dependence structures among capital gains and/or inter-arrival times and across, and provide expressions for the probability of survival. In Section 2.4, we consider the problem of risk capital allocation and give a procedure for computing the related alarm time. Section 3 provides extensive numerical illustrations of the results of Section 2. Section 4 concludes the paper.In this paper, we will be concerned with the following model. As mentioned in Section 1, we will consider the operation of companies and organizations whose cumulative operational expenses may be assumed to be composed of a stream of frequently occurring small and medium sized outgo payments and occasional bigger fixed lump sum payments. Therefore, we model these by a possibly non-linear and discontinuous non-decreasing function of time. Earnings come as occasional capital gains, following, e.g. mineral finds, inventions or returns from investments. The inter-occurrence times between consecutive capital gains, and their sizes are assumed stochastic, reflecting the uncertainty of the related operations. We may assume that capital gains may occur seldomly but their sizes would be substantial. This, for example, is the case with mineral exploration, where finds happen rarely but may be of significant value.Based on these ideas, let us now introduce appropriate notation and formalize the assumptions. Assume an initial capital of size U0 (U0 > 0) is held to start business and prevent from early ruin. Let g(t) denote the accumulation of operational costs over time t, which decrease the capital level of the company. In contrast to the classical assumption of g(t) being a linear function of time t, here we consider a more general case by assuming g(t) to be an arbitrary non-negative and non-decreasing real function of time t, not necessarily linear, and with possible jumps, corresponding to lump sum expense payments, with two natural conditions g(0) = 0 and limt → ∞g(t) = ∞. Future capital gains, which increase the capital level of the company, are assumed random variables denoted by Zi, i = 1, 2, …, with a joint probability density functionfZ1,…,Zk(z1,…,zk),following a stochastic arrival process N(t). The inter-arrival times are denoted by τ1, …, τk, which are random variables independent of the sizes of the capital gains, and their joint density function is denoted byϕτ1,…,τk(w1,…,wk). Let Yiand Tidenote the partial sums of the capital gains and the inter-arrival times respectively, i.e. Yi= Z1 + ⋅⋅⋅ + Zi, Ti= τ1 + ⋅⋅⋅ + τi. LetfT1,…,Tk(t1,…,tk)be the joint density function of (T1, …, Tk). Clearly, we havefT1,…,Tk(t1,…,tk)=ϕτ1,…,τk(t1,t2−t1,…,tk−tk−1). LetS(t)=∑i=1N(t)Zibe the aggregate capital gain process. Thus, the surplus process, R(t), in our dual risk model, can be expressed as follows,R(t)=U0−g(t)+S(t)=U0−g(t)+∑i=1N(t)Zi,t≥0.The instant of ruin Tdual is then defined asTdual:=inf{t:t>0,R(t)<0}.The assumptions made on the dual risk model are significantly more general than the classical ones (see e.g., Mazza and Rullière, 2004). We relax the assumptions of linear operational expenses and Poisson capital gain arrivals, and consider possibly dependent inter-arrival times τ1, …, τk, having any joint densityϕτ1,…,τk(w1,…,wk). We further consider capital gains Z1, Z2, … to coincide in distribution with a linear combination of exponential r.v.s, as the most general case, and its three special cases. We first assume them to be independent, non-identically Erlang distributed, i.e. Zi∼ Erlang(gi, λi) with different shape and scale parameters, gi, λi(as known this is a special case of Gamma distribution for gipositive integer). Second, we assume them to be i.i.d. exponential with parameter λ. Third, we consider the case in which Zi, i = 1, 2, …, have i.i.d. mixed exponential distributions. We then assume capital gains Zi, i = 1, 2, …, to be independent and identically distributed with any distribution, which we approximate with a mixture of exponential r.v.s. Finally, we introduce some dependence structures between capital gain sizes, inter-arrival times and across both capital gains and their inter-arrival times.Under this general dual risk model, we consider the probability of non-ruin within a finite time interval [0, x], denoted by P(Tdual > x). In order to obtain an explicit formula for P(Tdual > x), we note that the definition of the ruin time Tdual can be re-written asTdual=inf{t:t>0,R(t)<0}=inf{t:t>0,U0−g(t)+∑i=0N(t)Zi<0}=inf{t:t>0,∑i=0N(t)Zi<−U0+g(t)}=inf{t:t>0,∑i=0N(t)Zi<hdual(t)},where hdual(t) = −U0 + g(t), t ≥ 0.Thus, the ruin probability in the dual risk model can be viewed as the probability of a trajectory hitting a lower bound, as illustrated in the left panel of Fig. 1. The right panel of Fig. 1, which represents a trajectory hitting an upper bound, is obtained by reflecting the left panel with respect to the line t = y. As can be seen, the graph in the right panel is similar to a graph which corresponds to an insurance risk model, in which the premium income function is the inverted aggregate expense function,hdual−1(y),y>0,the capital gains Zi, i = 1, 2, …, are interpreted as inter-arrival times, and τibecome the claim amounts, with the first claim of size τ1 occurring at time 0+. The latter feature is not part of an insurance risk model for which all claims (including the first one) arrive at random moments in time strictly greater than 0. In order to adjust for this and exploit the duality suggested in Fig. 1, one would need to shift down the plot in the right panel by the random amount τ1 ≡ T1. In this way, the occurrence of a first claim (of size τ1) is eliminated and the upper bound, i.e. the aggregate premium function,hdual−1(y)is adjusted by subtracting τ1 from it. With these adjustments, the model in the right panel becomes an insurance risk model, and as can be seen, finding the probability of a trajectory hitting a lower bound in a dual risk model within a finite-time interval [0, x] is equivalent to finding the probability of a trajectory hitting an upper bound in an insurance risk model within the finite-time interval [0, hdual(x)].We can now express this equivalence in a more formal way, as follows. Consider an insurance risk model with a premium income functionhins(y)=hdual−1(y)−τ1,y≥0,wherehdual−1(y)is the inverse of the function hdual(t) = −U0 + g(t) and τ1 is a random variable which coincides in distribution with the first inter-arrival time τ1, in the dual risk model. Assume that the inter-arrival times, τ1, τ2, …, and the capital gains, Z1, Z2, …, have certain given distributions, and note that their interpretation in the insurance risk model is interchanged. Based on the reasoning described above, the following lemma establishes a link between the probability of non-ruin, P(Tdual > x), within the time interval [0, x] and the probability of non-ruin, P(Tins > hdual(x)), within the time interval [0, hdual(x)] in the related insurance risk model.Lemma 2.1(3)P(Tdual>x)={∫0hdual−1(0)P(Tins>hdual(x))ϕτ1(w1)dw1,x>hdual−1(0),1,x≤hdual−1(0),where P(Tins > hdual(x)) is the probability of non-ruin within the time interval [0, hdual(x)], in the insurance risk model with premium income functionhins(y)=hdual−1(y)−τ1,and claim amounts τ2, τ3, … with inter-arrival times Z1, Z2, …, andϕτ1(w1)is the marginal probability density function of τ1.In what follows, we apply Lemma 2.1 to obtain explicit expressions for the probability of survival, P(Tdual > x), under several assumptions on the distribution of the capital gains listed previously in this section.In this section, we first derive an expression for the non-ruin probability given in Proposition 2.2 in the case when capital gains Zi, i = 1, 2, …, are independent non-identically distributed random variables which coincide in distribution with linear combinations of exponential random variables, i.e.(4)Zi=αi1Xi1+⋯+αimiXimi,i=1,2,…,where Xij, i = 1, 2, …, j = 1, …, mi, are independent, exponentially distributed with parameter λij, i.e. Xij∼ Exp(λij), and αijare positive real coefficients. Considering this case is important since linear combinations of exponentials are quite flexible and include the special cases of independent, non-identical Erlang and i.i.d. exponential capital gains (see Corollaries 2.4 and 2.5), as well as mixtures of exponentials. Therefore, they can be successfully applied in approximating other arbitrary distributions for the capital gains, as an alternative to approximating with mixtures, as described in Section 2.2. We first derive the survival probability in the insurance risk model with inter-arrival times following a linear combination of exponential distributions (see Lemma B.1 in Appendix B) and then transfer the result of Lemma B.1 to the corresponding dual risk model, using Lemma 2.1. This result is new and can be viewed as a generalization of Theorem 2.1 of Ignatov and Kaishev (2012) obtained for the case of Erlang(gi, λi) inter-arrival times, i.e. when αij≡ 1, gi≡ miand λij≡ λiin the definition (4). Thus, the survival probability in the dual risk model with capital gains following a linear combination of exponential distributions and arbitrarily distributed inter-arrival times is obtained as follows.Proposition 2.2(5)P(Tdual>x)={∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x))×fT1,…,Tj(k)+1(t1,…,tj(k)+1)dtj(k)+1…dt2dt1,x>hdual−1(0),1,x≤hdual−1(0),where j(k), k = 0, 1, 2, …, is an integer-valued function such thatm1+⋯+mj(k)≤k<m1+⋯+mj(k)+mj(k)+1,so thatk01...m1−1m1...m1+m2−1j(k)00...01...1m1+m2...m1+m2+m3−1m1+m2+m3...2...23...and Bk are called exponential Appell polynomials (seeIgnatov and Kaishev 2012) defined recursively as(6)Bk(x)=θke−θk+1x∫νk+1xeθk+1zBk−1(z)dz,k=1,2,…withB0(x)=e−θ1x,νk=max{0,hdual(tj(k))},and {θk}k ≥ 1is a sequence of real numbers correspondingly defined asθ1,…,θm1,θm1+1,…,θm1+m2,…≡λ11α11,…,λ1m1α1m1,λ21α21,…,λ2m2α2m2,….The name exponential Appell polynomials is justified since the functions Bk(x) can be expressed as a linear combination of exponentials multiplied by classical Appell polynomials. To see this note thatB0(x)=e−θ1xA0(x),B1(x)=θ1θ2−θ1e−θ1xA0(x)−θ1e(θ2−θ1)ν1θ2−θ1e−θ2xA0(x)and if θ1 = θ2 ≡ θ then B1(x) = θe−θx(x − ν1) = θe−θxA1(x), where Ak(x) are the classical Appell polynomials defined as in (10). For further properties and explicit expressions for Bk(x), see Ignatov and Kaishev (2012). For properties of Ak(x) and their connection to ruin probabilities, see Appendix A.The result follows applying Lemma 2.1 with P(Tins > y) given by Lemma B.1, noting that y = hdual(x) andhins(y)=hdual−1(y)−τ1,y≥0. Hence, hins(hdual(x)) = x − τ1 and sincet=hins(y)=hdual−1(y)−τ1,we havehins−1(t)=y=max{0,hdual(t+τ1)}. Thus, whenx>hdual−1(0),we haveP(Tdual>x)=∫0hdual−1(0)P(Tins>hdual(x))ϕτ1(w1)dw1=∫0hdual−1(0)(∑k=0∞∫…∫0≤t2−t1≤⋯≤tj(k)+1−t1≤hins(hdual(x))Bk(hdual(x))×fT2,…,Tj(k)+1(t2−t1,…,tj(k)+1−t1)dtj(k)+1…dt2∑k=0∞∫…∫0≤t2−t1≤⋯≤tj(k)+1−t1≤hins(hdual(x)))×fT1(t1)dt1with Bk(hdual(x)) ≡ Bk(hdual(x); ν2, …, νk + 1) where 0 ≤ ν2 ≤ ν3 ≤ ⋅⋅⋅ is a sequence of real numbers denotinghins−1(0)≤⋯≤hins−1(0)︸m1−1≤hins−1(t2−t1)≤⋯≤hins−1(t2−t1)︸m2≤⋯correspondingly, i.e.νk=hins−1(tj(k)−t1). Therefore,P(Tdual>x)=∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x))×fT1,…,Tj(k)+1(t1,…,tj(k)+1)dtj(k)+1…dt2dt1,where Bk(hdual(x)) ≡ Bk(hdual(x); ν2, …, νk + 1) and νk= max {0, hdual(tj(k))}.Clearly, whenx≤hdual−1(0),hdual(t)≤0for t ∈ [0, x], whereas S(t) > 0, and therefore {Tdual > x} is the sure event, i.e. P(Tdual > x) = 1. This completes the proof of the proposition.□Next, we assume the capital gains, Zi, follow an independent, (non-identical) Erlang distribution with shape parameter gi> 0 and rate parameter λi> 0, i.e. Zi∼ Erlang(gi, λi), with densityfZi(z)=λigizgi−1e−λizΓ(gi),where gi’s are arbitrary positive integers and λi’s are positive real numbers. Under this assumption, for the probability of survival, P(Tdual > x), we haveCorollary 2.4Ziindependent non-identically Erlang(gi,λi)(7)P(Tdual>x)={∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x))×fT1,…,Tj(k)+1(t1,…,tj(k)+1)dtj(k)+1…dt2dt1,x>hdual−1(0),1,x≤hdual−1(0),where j(k), k = 0, 1, 2, …, is an integer-valued function such thatg1+⋯+gj(k)≤k<g1+⋯+gj(k)+gj(k)+1,so thatk01...g1−1g1...g1+g2−1j(k)00...01...1g1+g2...g1+g2+g3−1g1+g2+g3...2...23...and Bkare the exponential Appell polynomials, defined recursively as(8)Bk(x)=λj(k−1)+1e−λj(k)+1x∫νj(k+1)xeλj(k)+1zBk−1(z)dz,k=1,2,…withB0(x)=e−λ1xand νk= max{0, hdual(tj(k))}.The result directly follows from Proposition 2.2 substituting αij≡ 1, mi≡ giand λij≡ λiin definition (4).□Formula (7) is illustrated numerically in Example 3.3 in Section 3.Next, we derive an expression for the non-ruin probability given in Proposition 2.2 in the case when capital gains, Zi, i = 1, 2, …, follow an i.i.d. exponential distribution with parameter λ. In this case the finite-time survival probability, P(Tdual > x), is given by the following proposition.Corollary 2.5Zi∼ Exp(λ), i.i.d.(9)P(Tdual>x)={e−λhdual(x)(∑k=0∞λk∫0hdual−1(0)∫t1x⋯∫tkxAk(hdual(x);ν2,…,νk+1)fT1,…,Tk+1(t1,…,tk+1)dtk+1…dt2dt1∑k=0∞∫0hdual−1(0)),x>hdual−1(0),1,x≤hdual−1(0),where νk= max{0, hdual(tk)}, k = 1, 2, …, so that ν1 ≤ ν2 ≤ ⋅⋅⋅, and Ak(z; ν2, …, νk + 1) are the classical Appell polynomials of degree k, with coefficient in front of zkequal to 1/k!, defined recursively as follows.(10)A0(z)=1,Ak′(z;ν1,…,νk)=Ak−1(z;ν1,…,νk−1)Ak(νk;ν1,…,νk)=0,k=1,2,…The result follows from Corollary 2.4 substituting αij≡ 1, mi≡ gi≡ 1 and λij≡ λ in definition (4). The result can also be directly deduced applying Lemma 2.1 with P(Tins > y) given by Theorem 1 in Ignatov and Kaishev (2004), noting that y = hdual(x) andhins(y)=hdual−1(y)−τ1,y≥0. Hence, hins(hdual(x)) = x − τ1 and sincet=hins(y)=hdual−1(y)−τ1we havehins−1(t)=y=max{0,hdual(t+τ1)}. Thus, whenx>hdual−1(0),we haveP(Tdual>x)=∫0hdual−1(0)P(Tins>hdual(x))ϕτ1(w1)dw1=∫0hdual−1(0)(e−λhdual(x)∑k=0∞λk∫0hins(hdual(x))×∫0hins(hdual(x))−w2⋯∫0hins(hdual(x))−w2−⋯−wk×Ak(hdual(x);ν2,…,νk+1)×ϕτ2,…,τk+1(w2,…,wk+1)dwk+1…dw2∫0hins)ϕτ1(w1)dw1=e−λhdual(x)∑k=0∞λk∫0hdual−1(0)∫0x−w1∫0x−w1−w2⋯∫0x−w1−w2−⋯−wkAk(hdual(x);ν2,…,νk+1)×ϕτ1,…,τk+1(w1,…,wk+1)dwk+1…dw2dw1=e−λhdual(x)∑k=0∞λk∫0hdual−1(0)∫t1x∫t2x⋯∫tkx×Ak(hdual(x);ν2,…,νk+1)×fT1,…,Tk+1(t1,…,tk+1)dtk+1…dt2dt1,whereνk=hins−1(w2+⋯+wk)≡hins−1(tk−t1)=max{0,hdual(tk)},tk= w1 + ⋅⋅⋅ + wk.Clearly, whenx≤hdual−1(0),hdual(t)≤0for t ∈ [0, x] whereas S(t) > 0, and therefore {Tdual > x} is the sure event, i.e. P(Tdual > x) = 1. This completes the proof of the proposition.□It should be noted that, due to the connection established by Lemma 2.1, the numerical properties of formula (9) (respectively (7) and (5)) are similar to the numerical properties of the ruin probability formulas in the (direct) insurance risk model considered recently by Dimitrova et al. (2013).Remark 2.6Clearly, the numerical performance of (9) crucially depends on: 1) how (efficiently) the Appell polynomials are computed; 2) how the infinite sum with respect to k is truncated; and 3) how (efficiently) the multiple integrals are computed. These three aspects have been addressed in Sections 4, 5 and 6 of Dimitrova et al. (2013) under the insurance risk model setting where in particular, an algorithm of how to truncate the infinite summation, so that the resulting error is less than a pre-specified accuracy level, is presented. Furthermore, the domain of computability with respect to the model parameters has been investigated and shown to depend mainly on the product λy, where λ is the Poisson rate and y is the time horizon. For instance, for λy = 50 and accuracy level 10−4 only terms with dimensions k = 25, 26, …, 79 need to be evaluated and a numerical method for computing these k dimensional integrals is provided. For further details, we refer the reader to Dimitrova et al. (2013).As an alternative assumption on capital gains, Zi, we consider them to be independent identically distributed with any distribution. In order to cover that case, we approximate the latter distribution with a mixture of exponential distributions. As suggested by Botta and Harris (1986), any distribution can be approximated by a mixed exponential distribution in the sense of weak convergence. In order to achieve that, one can use e.g. the algorithm of Feldmann and Whitt (1998). Following this idea, we first assume the capital gains, Zi, follow an i.i.d. mixed exponential distribution, with densityfZi(x)=Λie−Λix,where Λi’s are i.i.d. discrete random variables whose distribution is given by P(Λi= λj) = αj, j = 1, …, m, with∑j=1mαj=1. Equivalently, we havefZi(z)=∑j=1mαjλje−λjz.Given Λi= λ[i], where λ[i] ∈ {λ1, …, λm}, the distribution of Zibecomes a non-identical Erlang distribution with parameters gi= 1 and λ[i], which in fact is the exponential case. Thus, the conditional survival probability, given Λi= λ[i], i.e. P(Tdual > x|Λ1 = λ[1], …), can be directly deduced from (7). Therefore, the unconditional survival probability in the mixed exponential case is then given by(11)P(Tdual>x)=EΛ1,…[P(Tdual>x|Λ1=λ[1],…)].The expectation in (11) is with respect to the set of Λi’s. As noted in Remark 2.6, the infinite summation in (7), with respect to the number of capital gains, could be appropriately truncated when numerically implemented in order to achieve a prescribed accuracy. Thus, there are only a finite number of Zi’s, and therefore Λi’s, in (11) and the expectation is therefore computable.Hence, for any arbitrarily distributed capital gains, one can first fit the distribution with a mixed exponential distribution and then approximate the corresponding survival probability using formula (11). Numerical illustrations of formula (11) are provided in Examples 3.1 and 3.2 in Section 3.In the dual risk model introduced in Sections 2.1 and 2.2 we relax the classical assumptions of linear operational costs and Poisson inter-arrival process, which makes the model more general than the classical dual risk model. However, one may still argue that the assumptions of independence among consecutive capital gains and inter-arrival times may not always be reasonable. In the next subsection, we remove such independent assumptions to further generalize our model.Let us recall that formulas (5), (7), (9) allow for possibly dependent arrival times in the dual risk model with any joint densityfT1,T2,…(t1,t2,…). However, they assume independent capital gains. In what follows, we consider some interesting dependence structures among capital gains and inter-arrival times and between both, and explain briefly why it may be necessary or reasonable to incorporate such dependencies. The latter are based on applying some mixing to the (joint) distribution of the inter-arrival times and/or the capital gains, and are illustrated on formula (7).In practice, the inter-arrival times between consecutive capital gains may be dependent. For example, the times spent on each invention or petroleum exploration may be jointly dependent on the occurrence/non-occurrence of an event, i.e. they may be influenced by a common random factor Θ (e.g. funding, know-how/expertise, technological break-through etc.), which indeed justifies conditional independence (given Θ = θ) among the inter-arrival times random variables τ1, τ2, …. Therefore, we introduce a dependence structure by assuming that the inter-arrival times have a (common) distribution which depends on a common parameter, Θ, randomized with an appropriate distribution. This is illustrated next on the basis of formula (7).(12)P(Tdual>x)={∫0∞(∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x))fT1(t1|θ)×⋯×fTj(k)+1(tj(k)+1|θ)dtj(k)+1…dt2dt1∫0hdual−1(0))×fΘ(θ)dθ,x>hdual−1(0),1,x≤hdual−1(0),where fΘ(θ) is the density of the parameter Θ, and Bk( · ) and j(k) are defined as in Corollary 2.4. One should note that for such a conditionally independent structure, the corresponding unconditional joint density of the inter-arrival times τ1, τ2, … may be obtained explicitly. Therefore, P(Tdual > x) can be computed either by formula (12) with the conditionally independent structure or by formula (7) using the corresponding (unconditional) joint density with its related dependence structure. This is illustrated numerically in Example 3.3 in Section 3.We next consider removing the assumption of independence among consecutive capital gains and introduce some dependence. One can argue that this is reasonable since good quality of previous products or results will not only bring higher earnings, but would also contribute to the reputation of the company. This could directly or indirectly increase the amounts of gains coming in the future, whereas poor previous experience would be expected to bring lower future benefits. Following this reasoning, one can incorporate a positive dependence structure among the capital gains, for instance, by randomizing the rate parameter Λ of the Erlang distribution in formula (7) and obtain(13)P(Tdual>x)={∫0∞(∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x)|λ)fT1,…,Tj(k)+1(t1,…,tj(k)+1)dtj(k)+1…dt2dt1∫0hdual−1(0))×fΛ(λ)dλ,x>hdual−1(0),1,x≤hdual−1(0),where fΛ(λ) is the density of parameter Λ, and j(k) and Bk(.) are defined as in Corollary 2.4 but with λi’s replaced by Λ.Furthermore, the size of each gain could be dependent on the inter-occurrence time preceding it. For example, one can argue that the longer time is spent on exploration or research, the more likely it is to obtain a higher capital gain (although there might exist a threshold above which this is no longer valid). Thus, it would be natural to introduce a positive dependence between the inter-arrival times and gain sizes. Therefore, we randomize the parameters of the distributions of both capital gains and inter-arrival times, denoted by Λ and Θ respectively, and model the dependence between them by a certain joint distribution with joint density fΛ, Θ(λ, θ). For P(Tdual > x), we then obtain(14)P(Tdual>x)={∫0∞∫0∞(∑k=0∞∫0hdual−1(0)∫t1x⋯∫tj(k)xBk(hdual(x)|λ)fT1(t1|θ)×⋯×fTj(k)+1(tj(k)+1|θ)dtj(k)+1…dt2dt1∑k=0∞∫0hdual−1(0))×fΛ,Θ(λ,θ)dλdθ,x>hdual−1(0),1,x≤hdual−1(0),where j(k) and Bk( · ) are defined as in Corollary 2.4 but with λi’s replaced by Λ.In order to illustrate the dependence structures introduced in this section, numerical examples are provided for different model parameter choices in Examples 3.3, 3.4 and 3.5 of Section 3.In our dual risk model, an initial capital of some size U0 is required to start business and prevent early ruin. The problem of determining the amount of this capital, viewed as a risk reserve capital, is known as the capital allocation problem. The standard approach to the problem is to set the entire risk capital amount at the beginning of the period. This may guarantee high enough survival probability, but because capital is reserved and not invested, any investment returns would be missed. Alternatively, as has been demonstrated by Kaishev et al. (2008) for the insurance risk model, risk capital could be allocated in portions, first part initially and second part at a later date before the period expires. This could guarantee the same survival probability but may lead to reducing the initial capital thus allowing it to earn investment returns.Various capital allocation strategies have been proposed in the literature, see e.g. Dhaene et al. (2012),Tasche (2004); 2008). Embrechts et al. (2004) and Kaishev et al. (2008) proposed to use ruin probability in capital allocation. The latter authors have illustrated numerically that, in the insurance risk model, two alternative ways of capital accumulation, one linear and the other one piece-wise linear with a jump somewhere halfway and different slopes before and after the jump, can result in the same level of survival probability, with equal amounts of accumulated capital at the end of the time interval considered. This implies that the initial capital level can be decreased without sacrificing the chances of survival. The important idea from the paper by Kaishev et al. (2008) is that it is preferable to reserve less capital initially, allowing more of it to be invested and top it up later, even if the survival probability may slightly be reduced, compared to setting the entire capital initially.These ideas have been extended further in the paper by Das and Kratz (2012), who suggest to place the capital sequentially in portions at moments where the survival probability becomes alarmingly low. These moments are called alarm times. Such strategy would allow to sequentially maintain sufficiently high level of survival probability throughout the entire period. It should be mentioned however, that Das and Kratz (2012) do not consider the problem of how much capital to allocate at each alarm time. The latter is also outside the scope of this paper and is a subject of ongoing research. It should also be noted that the whole strategy is decided at time zero and hence, the moments and sizes of additional capital injections are known a priori as opposed to being random and/or unknown.In this paper, we follow the ideas from Kaishev et al. (2008) and Das and Kratz (2012) but apply them in the context of the dual risk model. First, we provide an example to examine whether a similar appealing phenomena to the one studied in Kaishev et al. (2008) occurs under the dual risk model. In this example, two alternative ways of capital allocation are considered. First, we assume an initial capital U0 and a linear function of cumulative operational costs g(t) = ct, where c is constant, so that we have h1(t) = −U0 + ct. Second, we consider an initial capital of sizeU0′and a jump of size J at some instant tJ∈ [0, x], such thatU0=U0′+J,and a piecewise linear cumulative operational cost function with different slopes before and after the jump, slopes denoted by c1 and c2 respectively, i.e.(15)h2(t)={−U0′+c1t,0≤t<tJ−U0′+c1tJ−J+c2(t−tJ),tJ≤t≤xso that h1(x) = h2(x). We are hoping to see if, with these two capital allocation strategies, we can achieve the same level of survival. A numerical example is provided in Example 3.6 in Section 3, which illustrates that this is again possible.In fact, even if the survival probability may be sacrificed a little compared to the first strategy, the second capital allocation strategy which requires lower initial capital can still be preferable, due to better investment returns on capital. Thus, if the latter is pursued, a natural question arises when is it optimal for the capital injection to take place, in order to effectively fulfil the solvency requirements. A direct answer, as suggested by Das and Kratz (2012), is to inject the capital at the alarm time.Various definitions of alarm time have been introduced in different contexts in previous literature. In this paper, we are mainly concerned with the one proposed by Das and Kratz (2012) in the insurance risk model context. More precisely, the basic idea is that the alarm time is “when the probability of ruin (in absence of any intervention) within a specified future time period is high”. Thus, the following two intuitive requirements are taken into account when deterministic alarms are devised:1.the alarm is sounded when, without any remedial action, the ruin probability in a specified future time window (relatively small) is considerably high;the possibility that ruin occurs before the alarm time is reasonably insignificant.Formally, adopting definition (8) of Das and Kratz (2012) to the dual risk model, the alarm time A is defined as(16)A=inf{s>0:P(Tdual≤s+d|Tdual>s)≥1−αandP(Tdual>s)≥1−β},where α and β are pre-specified probabilities and d denotes a pre-determined future time window. Definition (16) can be rewritten as follows,(17)A=inf{s>0:P(Tdual>s+d)≤αP(Tdual>s)andP(Tdual>s)≥1−β},which only involves finite-time survival probability and the explicit expressions (5), (7), (9), or (11), (12), (13) and (14) for the latter, which have been obtained in Section 2.1–2.3, could be used in (17) to evaluate the corresponding alarm time, A.As noted in Das and Kratz (2012), the requirements stated above suggest that, the value of the parameter β should be significantly small to ensure that the ruin probability before the sound of the alarm is minimal; the value of the parameter α needs to be moderately small, but not too small so that the prospect of ruin is realistic and a remedial action is required; d has to be moderate, neither very small, which leaves little possibility for remedial actions to be effected, nor very large, which indicates that ruin would occur in the distant future and there is no strong immediate likelihood of it. In fact, as noted by Das and Kratz (2012), α and d can be inter-related. It is also worth mentioning that, in some cases, the two conditions in (17) cannot be satisfied simultaneously. In other words, such an alarm time A may not necessarily exist in all cases, because, for all possible values s such that P(Tdual > s) ≥ 1 − β and fixed α and d, the survival probability may not drop significantly within a short future period [s, s + d]. In such cases, we define the alarm time as(18)A=inf{s>0:P(Tdual>s)<1−β}.It has to be noted that it is difficult to obtain the alarm time A analytically, given the complexity of the expressions for P(Tdual > x). An alternative way is to compute the alarm time numerically. More precisely, the following procedure can be implemented.1.For fixed α, β and d, select a relatively small s0 as a starting point such that the second condition in (17) is fulfilled. Generally, a small s0 should not meet the first condition in (17). Set s = s0.Evaluate the two probabilities involved in (17) with s in order to check if both conditions are satisfied. If not, increase the checking point s with a small step δs until the smallest value s1 is identified which either breaks the second condition or satisfies both conditions. Thus, s1 is an upper bound of A; if s1 breaks the second condition, s1 − δs ≤ A < s1; if s1 meets both conditions, s1 − δs < A ≤ s1.Set a new starting point s = s1 − δs and a smaller step size δs and repeat step 2 to find a new upper bound of A with a higher level of accuracy.Repeat step 3 until the alarm time A is obtained with a desirable level of accuracy, then stop.Numerical illustrations for the alarm time are provided in Example 3.7 in Section 3.It is worth noting that setting alarm times can efficiently warn a company when a projected capital injection should take place, but it does not provide a solution on what the size of each capital portion should be. We note that developing optimal capital allocation strategies is a popular research area of considerable interest. However, it is outside the focus of this paper.This section is devoted to studying the numerical performance of formulas (7), (11), (12), (13) and (14), the problem of capital allocation discussed and the procedure of computing alarm time introduced in Section 2.4. For the purpose, we have used Mathematica system and a PC with 2.93  gigahertz Intel(R) Core(TM) i7 CPU and 8.00 gigabytes RAM. It is worth mentioning that Mathematica allows for the recursive results to be stored in the RAM automatically, which contributes significantly to saving of computation time, as all formulas of survival probability incorporate recursive structures. As also noted in Remark 2.6, all formulas involve a summation to infinity and a truncation to k = mε will be employed, as described in Dimitrova et al. (2013) for the insurance risk model, to achieve a desirable accuracy ε in the resulting survival probability. For simplicity but without loss of generality, in all the numerical examples illustrated in this section except Example 3.6, we assume linearly accumulating expenses, i.e. g(t) = ct, where c is constant, and hdual(t) = −U0 + ct. Also the distributions and numerical values of the parameters in all examples are chosen so as to illustrate different special cases of Proposition 2.2. Other distributions and parameter values could of course have been selected.We start with two examples, 3.1 and 3.2, where we assume i.i.d. heavy-tailed distribution of the capital gains and apply the results of Section 2.1 and 2.2 to approximate the survival probability by fitting the distribution with a hyperexponential distribution. Then, in Examples 3.3–3.5 three alternative numerical illustrations of the results of Section 2.3 are provided, where we relax the independence assumptions and introduce dependence structures among capital gains and/or inter-arrival times. In Example 3.6, we illustrate numerically Section 2.4 and compare two alternative strategies of capital allocation with different cumulative operational cost functions, one linear and the other one piecewise linear with a capital injection somewhere halfway and different slopes before and after the capital injection. The last example 3.7 illustrates the numerical procedure of computing the alarm time, A, introduced in Section 2.4 according to definitions (17) and (18).Example 3.1Assumptions: i.i.d. Pareto(a, b) distributed capital gains Zi, i = 1, 2, …, whose cdf is fitted with a mixed exponential distribution as described in Section 2.2; capital gain arrivals following a Poisson process with parameter θ; survival probability computed using formula (11).In this example, we explore the case of i.i.d. capital gains, Zi, i = 1, 2, …, following a long-tail distribution, which is best tested assuming Ziare Pareto(a, b) distributed with cdf given byFZi(z)=1−(1+bz)−a,z>0,where a and b are positive parameters. Without loss of generality, we choose the parameter values as a = 1.2 and b = 5, which leads to mean equal to 1. We then approximateFZi(z)with a hyperexponential distribution, which is a mixture of m exponentials with cdfHm(z)=1−∑j=1mαje−λjz,z>0,where αj≥ 0 for all j and α1 + ⋅⋅⋅ + αm= 1. Various methods have been proposed in the literature to fit an arbitrary distribution with a hyperexponential distribution. Here, we consider the algorithm developed by Feldmann and Whitt (1998). Thus, we approximated the Pareto(1.2,5) cdf,FZi(z)with the cdf, H4(z), of a hyperexponential distribution with four exponents, i.e. m = 4, with parameters given in Table 1. The comparison of the original and fitted cdf is illustrated in Fig. 2on a log–log scale.As can be observed in the left and middle panels in Fig. 2, H4(z) fits the cdf of Pareto(1.2, 5) quite well in the range z ∈ [0, 10], where the maximum difference is less than 0.0113 for 0 < z ≤ 1 (attained at z = 0.085) and less than 0.0005 for 1 < z ≤ 10 (attained at z = 2.5). In the right panel we illustrate the distance between the fitted and the original Pareto(1.2, 5) distribution in the tail, which, although visually observable, is not significant with the maximum difference being less than 0.0012 for 10 < z (attained at z = 40). Choosing the remaining parameter values as θ = 0.5, u = 1, c = 0.6 and x = 2, formula (11) gives a theoretical survival probability (with the approximated cdf H4(z)) of 0.335042, where we have required ε = 0.001 and so, mε = 3. We then employ Monte Carlo simulation to simulate directly from Pareto(1.2, 5) to evaluate the survival probability, run 1,000,000 simulations each time and repeat 100 times, which yields a mean of 0.333408 and a 95 percent confidence interval of (0.332475, 0.334341). Although the approximated survival probability does not fall into the confidence interval, it is very close to the truth and the error may come from the bias of the fitted hyperexponential distribution, in particular in the tail. It may seem counterintuitive that a higher survival probability is obtained with the approximating distribution which allocates less mass at the higher values (beyond 100) of the capital gains than the true one. However, it could be argued that the short time-horizon and/or small cost rate and initial capital, x = 2, c = 0.6, u, do not leave sufficient room for high capital gains (in the tail) to affect the survival probability.Example 3.2Assumptions: i.i.d. Weibull(c, a) distributed capital gains, Zi, i = 1, 2, …, whose cdf is fitted with a mixed exponential distribution, as described in Section 2.2; capital gain arrivals following a Poisson process with parameter θ; survival probability computed using formula (11).In this example, we have chosen another member of the long-tail family, the Weibull distribution, i.e. we assume i.i.d. Zi∼ Weibull(c, a), whose cdf has the formFZi(z)=1−e−(z/a)c,z>0,with positive parameters c and a. In particular, we chose the parameter values as c = 0.6 and a = 0.66464, which again gives mean equal to 1. Employing the algorithm proposed by Feldmann and Whitt (1998), we approximate the cdf of Weibull(0.6, 0.66464) with a hyperexponential distribution H4(z), and the results are summarized in Table 2and Fig. 3. The maximum difference between the two cdfs is less than 0.0148 for 0 < z ≤ 1 (attained at z = 2.5 × 10−3), less than 0.0026 for 1 < z ≤ 10 (attained at z = 1) and less than 0.0004 for 10 < z (attained at z = 14.5).Fig. 3 indicates that the cdf of Weibull(0.6, 0.66464) is better fitted by H4(z) than the Pareto(1.2, 5) in Example 3.1. Particularly, as is observed in the right panel in Fig. 3, the fitting bias in the tail is much less significant. With the remaining parameter values chosen as in the previous example, i.e. θ = 0.5, u = 1, c = 0.6 and x = 2, formula (11) yields a theoretical survival probability (with the approximated cdf H4(z)) of 0.414054, where, again, we have required ε = 0.001 and so, mε = 3. Employing Monte Carlo simulations from Weibull(0.6, 0.66464), and running 1,000,000 simulations each time repeated 100 times, lead to a survival probability with a mean of 0.414033 and a 95 percent confidence interval of (0.413077, 0.414989). Clearly, the approximated survival probability falls nicely into the confidence interval. It may be argued that, in this case, the approximated survival probability is closer to the true value than in Example 3.1, and one possible reason is that the Weibull distribution is moderately lighter-tailed than Pareto distribution, resulting in a relatively better approximation with a hyperexponential distribution for the former and therefore a more accurate approximation of the survival probability.Example 3.3Computing survival probability with formulas (7) and (12), assuming non-identically Erlang(g, λi) distributed capital gains and exponential inter-arrival times τ1, τ2, … with parameter Θ, where Θ follows a Gamma(α, β) distribution.In this example, we introduce a dependence between the inter-arrival times by randomizing the parameter of the distribution of τ1, τ2, …. Additionally, we also make the assumption that consecutive capital gains are non-identically distributed with the justification that the capital gains will on average be increasing when the company becomes stronger with time and earns more reputation. Thus, we assume{λ1,λ2,λ3,λ4,λ5,λ6,…}={1,1,12,12,13,13,…}in order to have stationary periods within the increasing (on average) capital gains. It is worth noting that the dependence structure of exponential inter-arrival times with a mixing parameter Θ, following a gamma distribution with parameters α and β, leads to conditional independence i.e.ϕτ1,…,τk(w1,…,wk|Θ=θ)=∏i=1kθe−θτi=θke−θ∑i=1kτi=θke−θtk,Θ∼Gamma(α,β).It has been shown by Albrecher et al. (2011) (see Example 2.3 therein) that this dependence structure is equivalent to a rotated Clayton copula with parameter α, with Pareto(α, β) marginals, where the density of the rotated Clayton copula is defined ascRCl(u1,…,uk;α)=αkΓ(1/α+k)Γ(1/α)∏i=1k(1−ui)−α−1×(∑i=1k(1−ui)−α−k+1)−1/α−k.As mentioned previously, a significant advantage of formula (7) is that it assumes any joint distribution, i.e. any dependence structure of inter-arrival times, so here we evaluate the survival probability first by using formula (12) with the conditionally independent structure and then by using formula (7) with the corresponding unconditional joint density and compare the results and computation times in Table 3; see also Fig. 4.In Table 3, we compute the survival probability for different values of c and as expected, for different c values, different truncation points mε are required in order to reach the same level of accuracy; for more details on determining the truncation point mε for the infinite sum in the survival probability formula, we refer the reader to Dimitrova et al. (2013). It is clearly demonstrated that it is numerically more efficient to compute P(Tdual > x) using formula (7) with the copula structure than to use formula (12) which involves the conditional independence structure. This may be because the latter needs additional integration with respect to Θ, which makes it more time consuming. However, it should be noted that, not all conditional independence structures can be expressed equivalently through an easily computable copula, and formula (12) should therefore be considered in such cases.Example 3.4Computing survival probability with formula (13), assuming Erlang(g, Λ) distributed capital gains, where Λ is a random variable following a Gamma(α, β) distribution, and inter-arrival times are i.i.d. exponentially distributed with parameter θ.In this example, we assume a positive dependence structure among the gain sizes by assuming the rate parameter of Erlang distribution is a random variable Λ, and evaluate the survival probability with formula (13) as shown in Fig. 5.Fig. 5 illustrates the survival probability for fixed values of U0, as a function of the shape parameter α of the gamma distribution of the randomized parameter Λ. Clearly, the survival probability decreases with α. This is because an increasing α results in a higher expected value of the randomized rate parameter Λ which leads to a lower expected value of future capital gains and therefore a lower survival probability.Example 3.5Computing survival probability with formula (14), assuming Erlang(g, Λ) distributed capital gains, and exponentially distributed inter-arrival times with parameter Θ, where Λ and Θ are dependent random variables with their joint distribution modelled by a Farlie–Gumbel–Morgenstern (FGM) copula with parameter γ, with gamma marginals with parameters αλand βλ, αθand βθrespectively.In this example, we randomize the parameters of the distributions of capital gain sizes and their inter-arrival times, Λ and Θ, and model the dependence between them using an FGM copula with parameter γ, which is defined asC(u1,u2)=u1u2(1+γ(1−u1)(1−u2)),with densityc(u1,u2)=1+γ(1−2u1)(1−2u2),where γ represents the dependence level with domain − 1 ≤ γ ≤ 1 and γ = 0 corresponds to the independent case. This parametric family of copulas has well-studied properties and has been used in operational research applications to model weak dependence structures, see e.g. Meade and Islam (2010).In Fig. 6, we plot survival probability against γ. In the top left panel, the five curves from the bottom correspond to U0 from 0.1 to 0.5, and the remaining panels illustrate each individual curve. Although it is very difficult to observe the trend in the curves in the top left panel, it is very interesting to see in the remaining panels that, for U0 = 0.1, 0.2, the survival probability decreases monotonically with γ, whereas for U0 = 0.3, 0.4, 0.5, it increases monotonically with γ. This can be explained as follows. Because of the positive dependence, if the inter-arrival time is small, the capital gain which follows would also tend to be small and vice versa, long inter-arrival times would be associated with large capital gains. So in either case, the cumulative capital gain would tend not to offset the cumulative expense outgo when U0 is small, which would increase the likelihood of ruin. This effect becomes more and more pronounced causing P(Tdual > x) to decrease when the dependence parameter γ increases. However, when U0 is large, this is not the case and the trend in P(Tdual > x) as a function of γ reverses. The latter phenomenon indicates that the trend in the monotonic relation between the survival probability and the level of dependence may reverse depending on the value of the initial capital U0.It has to be noted that the trend in the survival probability against the dependence level is also affected by the choice of the copula structure. For alternative choices of copula, the effect observed in Fig. 6 may not occur. Based on our extensive experiments, for some copulas such as Frank copula, the change in the trend in the survival probability against the dependence level consistently occurs for different choices of model parameters, whereas for other copulas such as Clayton copula, the trend either changes or not depending on the choice of model parameters.Example 3.6Comparing two alternative strategies of capital allocation with different cumulative operational cost functions, one linear and the other one piecewise linear with a capital injection somewhere halfway and different slopes before and after the capital injection, see (15) in Section 2.4, assuming i.i.d. exponentially distributed capital gains with parameter λ and i.i.d. exponentially distributed inter-arrival times with parameter θ.As already mentioned in Section 2.4, we are interested in testing whether for the dual risk model we would observe the phenomena observed by Kaishev et al. (2008) that two alternative ways of capital accumulation, one linear and the other one piecewise linear with a capital injection somewhere halfway and different slopes before and after the capital injection, can result in the same level of survival probability, with equal amounts of accumulated capital at the end of time interval considered. Numerical results are illustrated graphically in Fig. 7.In the left panel of Fig. 7, two choices of hdual(t) are plotted, h1(t) = −0.777 + 0.5t andh2(t)={−0.577+0.491t,0≤t<1.1−0.577+0.491×1.1−0.2+0.511(t−1.1),1.1≤t≤2In the right panel of Fig. 7, moving the location tJof the capital injection J = 0.2 from tJ= 0 to tJ= 2 and keeping the remaining of the parameters unchanged, it can be observed that a maximum of P(Tdual > x) is achieved at tJ= 1.1, and interestingly, there is a jump in the survival probability at tJ= 1.2. The occurrence of a downward jump in the survival probability can be explained as follows. Define t* = inf{t: 0 < t ≤ 2, h2(t) ≥ 0}. Clearly, survival is certain within the interval [0, t*], which is a component in the survival probability P(Tdual > 2). Changing the position of the jump between 0 and 1.1 causes t* to move to the right (compare the intersection points of the solid blue line and the dashed red line with the horizontal axis in the left panel of Fig. 7), which leads to an increase in the survival probability. The downward jump in P(Tdual > 2) occurs when t* moves to the left jumpwise (compare the intersection points of the dashed red line and the dotted purple line with the horizontal axis in the left panel of Fig. 7), and thereafter the survival probability decreases as the hitting barrier is gradually moving to the left.Clearly, in Fig. 7, we can observe that, at the end of the time interval considered, x = 2, h1(2) = h2(2) = 0.223, and the two choices of hdual(t) give equal probability of survival of 99 percent. The second strategy should therefore be more favourable, as a lower initial capital is required.Example 3.7Computing alarm times according to definitions (17) and (18), assuming i.i.d. exponentially distributed capital gains with parameter λ and i.i.d. exponentially distributed inter-arrival times with parameter θ.In this final example, we compute the alarm time, A, following the numerical procedure described in Section 2.4 and the alarm times are plotted in Fig. 8.Due to the reasons discussed in Section 2.4, the values of parameters α, β and d are carefully selected. Choosing β = 0.05 requires a reasonably high solvency level of 95 percent before the alarm is sounded; α = 0.5 indicates that there is a 50 percent chance of ruin in the specified future time interval, which is alarming enough for a company to take some remedial actions and of course these actions should not be postponed until the ruin probability becomes very close to 1; d = 2 is not too distant from the current time but leaves enough time for the remedial measures to be put into action.In the left panel in Fig. 8, the alarm time A is plotted against initial capital U0. It is observed that the alarm is sounded later with a larger initial capital. This naturally makes sense, as more initial capital will support the business for longer time before it reaches the bottom line of prescribed solvency level and would require capital injection. In the right panel of Fig. 8, the alarm time A against the expense rate c is plotted. We observe that, with the increase of c, the alarm time gets shorter and shorter. This is again reasonable, since with a higher cost rate, the same amount of initial capital becomes less sufficient for a company to maintain the same level of survival probability within a fixed future period. The projected capital injection should therefore be put into action earlier. The observations are comparable to those made in the insurance risk model by Das and Kratz (2012) where further analysis has been provided.In this paper, we consider the problem of finding the probability of ruin in a finite time in a reasonably generalized dual risk model, where we assume any non-negative non-decreasing cumulative operational cost function and arbitrary capital gain arrival process. Establishing an enlightening link between this dual risk model and its corresponding insurance risk model (see Lemma 2.1), we obtain explicit expressions for finite-time survival probability in the dual risk model for various reasonably general assumptions for capital gains distribution (see Proposition 2.2 and its Corollaries 2.4 and 2.5). Dependence structures among capital gains and inter-arrival times or between both have also been incorporated to make the model more realistic and general and corresponding ruin probability expressions have been obtained (see formulas (12), (13) and (14)). A risk capital allocation approach based on the concept of alarm time, due to Das and Kratz (2012), has been proposed for the dual risk model. A corresponding procedure for the computation of alarm times, where additional capital needs to be injected in order to maintain chance of survival above a certain level, has been developed and implemented numerically. Numerical illustrations of the results of Section 2 have been provided in Section 3.Another important contribution of the paper is the result of Lemma B.1, which generalizes a previous result of Ignatov and Kaishev (2012), obtained for the case of Erlang claim amounts to the case of claim sizes following a linear combination of exponentials. As noted in Section 2.1, due to the connection established by Lemma 2.1, the numerical properties of formula (9) (respectively (7) and (5)) are similar to the numerical properties of the ruin probability formulas in the (direct) insurance risk model considered recently by Dimitrova et al. (2013). Some limitations related to the numerical performance of these formulas have been mentioned in Remark 2.6, e.g. the need to evaluate high dimensional integrals when the intensity of the arrival process and/or the length of the finite-time horizon is too large; for further details the reader is referred to Dimitrova et al. (2013).In conclusion, it has to be highlighted that the ruin probabilistic results obtained here and the elegant duality Lemma 2.1 are worth noticing since there are very few papers in the literature devoted to the ruin probability in the dual risk model and, to the best of our knowledge, there are no closed-form results. As illustrated, the dual risk model has the potential for much wider applications than the insurance risk model.

@&#CONCLUSIONS@&#
