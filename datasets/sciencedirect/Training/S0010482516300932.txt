@&#MAIN-TITLE@&#
Shape, texture and statistical features for classification of benign and malignant vertebral compression fractures in magnetic resonance images

@&#HIGHLIGHTS@&#
Vertebral compression fractures (VCFs) involve partial collapse of vertebral bodies.Statistics of gray levels, texture features, and shape features were computed.Classification of normal vertebral bodies versus VCFs was performed.Area under the receiver operating characteristic curve AUROC=0.97 was obtained.AUROC=0.92 was obtained in classification of benign versus malignant VCFs.

@&#KEYPHRASES@&#
Computer-aided diagnosis,Image processing,Magnetic resonance images,Shape analysis,Statistical analysis of gray levels,Texture analysis,Vertebral compression fractures,

@&#ABSTRACT@&#
PurposeVertebral compression fractures (VCFs) result in partial collapse of vertebral bodies. They usually are nontraumatic or occur with low-energy trauma in the elderly secondary to different etiologies, such as insufficiency fractures of bone fragility in osteoporosis (benign fractures) or vertebral metastasis (malignant fractures). Our study aims to classify VCFs in T1-weighted magnetic resonance images (MRI).MethodsWe used the median sagittal planes of lumbar spine MRIs from 63 patients (38 women and 25 men) previously diagnosed with VCFs. The lumbar vertebral bodies were manually segmented and statistical features of gray levels were computed from the histogram. We also extracted texture and shape features to analyze the contours of the vertebral bodies. In total, 102 lumbar VCFs (53 benign and 49 malignant) and 89 normal lumbar vertebral bodies were analyzed. The k-nearest-neighbor method, a neural network with radial basis functions, and a naïve Bayes classifier were used with feature selection. We compared the classification obtained by these classifiers with the final diagnosis of each case, including biopsy for the malignant fractures and clinical and laboratory follow up for the benign fractures.ResultsThe results obtained show an area under the receiver operating characteristic curve of 0.97 in distinguishing between normal and fractured vertebral bodies, and 0.92 in discriminating between benign and malignant fractures.ConclusionsThe proposed classification methods based on shape, texture, and statistical features have provided high accuracy and may assist in the diagnosis of VCFs.

@&#INTRODUCTION@&#
Vertebral compression fracture (VCF) is a fracture with partial collapse of the affected vertebral body. Clinically, a radiologist will have no doubt about the etiology of a traumatic VCF as a patient typically presents with a recent history of trauma, such as a fall or an accident. However, when the patient develops a recent vertebral collapse without trauma, or when there was a low-energy traumatic incident, the etiology needs to be investigated, and there can be difficulty in arriving at a diagnosis. This problem is common especially in the elderly population due to the higher incidence of VCFs secondary to bone failure. Vertebral fragility fractures secondary to osteoporosis are an increasingly important health issue [1,2]. The elderly population also has a high incidence of VCFs related to metastatic cancer affecting bone [3]. Clinically, a VCF secondary to osteoporosis is labeled as a benign VCF, and a VCF caused by bone metastasis is defined as a malignant VCF [3]. Complaints from patients related to both types of VCFs, benign and malignant, may be similar; however, the differentiation between the two types of VCFs is fundamental for correct diagnosis and appropriate treatment.Magnetic resonance imaging (MRI) is effective in early detection of vertebral fractures [4,5]. The distribution of the signal intensity abnormality throughout the vertebral body is an important criterion to discriminate between benign and malignant VCFs in MRI, but the analysis of vertebral body shape can also help in this process [6–9]. A malignant vertebral collapse typically exhibits diffuse low signal intensity throughout the vertebral body in T1-weighted MRI. Osteoporotic VCFs, on the other hand, characteristically demonstrate partial preservation of the normal fatty bone marrow signal in the vertebral body in T1-weighted MRI [6]. In clinical practice, a radiologist compares the vertebral body signal intensity with the signal intensity in the intervertebral discs. Usually, normal vertebral bodies exhibit higher signal intensity than the intervertebral discs in T1-weighted MRI because of bone marrow adiposity. A vertebral body with bone marrow signal intensity similar to that of a neighboring disc is suspicious for malignancy [10].VCFs may cause multiple types of changes in the shapes of vertebrae. Malignant VCFs could result in a posterior bulge or convexity of the posterior vertebral body wall, though this may occur together with a concave deformation of the vertebral plateaus. Malignant processes may cause the contours of vertebrae to be relatively rounded or smoothened due to bulging neoplastic tissue. In the case of benign VCFs, the vertebral plateaus may acquire a more accentuated concave shape, and subchondral bone impaction may result in rough contours with indentations. Benign VCFs may cause posterior wall fragment retropulsion with angulated or irregular contours [6,11].Vertebrae without any fracture typically present nearly rectangular shapes in the sagittal plane. However, they may include small bone outgrowths and marginal bone proliferation known as osteophytes that may cause shape abnormalities. Such modifications of shape may potentially confound analysis with typical shape factors such as compactness and convex deficiency [12–14].Link et al. [15] describe common signs of benign VCFs and malignant VCFs in MRI. Benign VCFs can present a concave posterior cortex, retropulsion of posterior fragments into the spinal canal, preserved marrow signal in T1-weighted MRI, and an isointense vertebra on T2-weighted and T1-weighted MRI with gadolinium contrast. Malignant VCFs can present a convex posterior cortex with an epidural mass, diffuse and low T1 signal, heterogeneous or high signal in T2-weighted and in T1-weighted MRI with gadolinium contrast, and pedicles that show low signal in T1-weighted MRI.Fig. 1 shows two MRIs with both types of VCFs and normal vertebral bodies. Not all cases demonstrate the typical expected characteristics of benign or malignant VCFs in clinical practice, which calls for the development of accurate and reproducible diagnostic methods for VCFs with the aid of computational techniques.There has been some research interest in the area of imaging of the spine involving VCFs and segmentation of vertebrae and intervertebral discs. Grados et al. [16] presented a review of 149 articles on description and evaluation of osteoporotic vertebral fractures with standard radiographs or dual-energy X-ray absorptiometry (DXA) as well as the role of each method in clinical practice. The grading method of Genant et al. [17] for semiquantitative assessment of VCFs using standard radiographs provides information on the severity and prognosis of osteoporosis, while DXA for bone mineral density measurement may detect vertebral fractures in asymptomatic patients. Guglielmi et al. [18] conducted a morphometric study on benign VCFs in radiographs and evaluated a semiautomatic model-based image analysis software tool using a 6-point morphometry protocol and a manual procedure according to the shape and size measures of Genant et al. [17]. The time consumed for the semiautomatic procedure was significantly less than the time consumed for the manual procedure. The semiautomatic approach resulted in mean±standard deviation errors of 2.50±0.72% and 2.16±0.5% for anterior–posterior and superior–inferior measurements, respectively. They also noted that a vertebral deformity does not always indicate a vertebral fracture but a vertebral fracture is always accompanied by vertebral deformity, and also that the combination of semiquantitative visual and quantitative morphometric methods may be the best approach to the diagnosis of a vertebral fracture. Ribeiro et al. [19] proposed procedures for detection of VCFs in lateral radiographs of the lumbar spine using Gabor filters and an artificial neural network for extraction of the superior and the inferior plateaus of each vertebral body, and applied the method of Genant et al. [17] for classification using measures of height of the vertebral bodies. Their results indicated sensitivity up to 78% and specificity of 95%. Kasai et al. [20] developed an automatic computer-aided diagnosis (CAD) system for vertebral fractures based on chest X-ray images. Comparing with manual analysis performed by radiologists, they obtained accuracy ranging between 70.9% and 76.6% in the detection of vertebral fractures.Al-Helo et al. [21] developed a CAD system for detecting vertebral body fractures in computed tomography (CT) images. Using active shape models and gradient vector flow active contours, they obtained 99% sensitivity and 87.5% specificity with the k-means method. Ghosh et al. [22] proposed a fully automated CAD system for detection of lumbar VCFs in CT images using three height deviation measures of vertebral bodies as features. They obtained an accuracy of 97.33%. While CT is the preferred modality for trauma patients, MRI is used in most of other clinical scenarios of spinal disease investigation [22].The previous works reviewed above have in common the use of imaging modalities with ionizing radiation. Arevalo-Perez et al. [23] studied the use of dynamic contrast-enhanced MRI (DCE-MRI) to aid in noninvasive distinction between pathological and benign vertebral fractures. They reviewed cases of patients with vertebral fractures who underwent DCE-MRI and biopsy. The results indicated that pathological fractures had significantly higher (p<0.01) perfusion parameters, compared with benign fractures. Khan et al. [24] studied variation in the aging lumbar spine using principal component and factor analysis in MRI. They used the MATLAB Statistical Toolbox [25] to compute the principal components using a variance technique, and found that disc signal intensities have strong correlation with natural aging and that the heights of the discs and vertebral bodies are correlated.In our reviews, we have not found any work on classification of benign VCFs, malignant VCFs, and nonfractured vertebral bodies using image processing methods for extraction of diagnostic features in MRI.We propose image processing methods to characterize statistical variations of gray levels, texture, and shape of vertebral bodies to detect VCFs and further to classify VCFs as benign or malignant towards CAD of VCFs using T1-weighted MRI. We describe our proposed Fourier-descriptor-based feature (FDF) and analyze its performance in conjunction with nine shape factors including convex deficiency (CD), compactness (Co), and the seven measures based on central invariant moments as proposed by Hu [26]. Furthermore, we analyze three statistical measures of gray levels including the coefficient of variation (CV), skewness (Skew), and kurtosis (Kurt) [27], and the fourteen texture features described by Haralick et al. [28]. The present paper is an updated and expanded version of our previous related presentations at conferences [7–9,29].This study has been approved by the Research Committee of Ethics of the Ribeirão Preto Medical School. We used a set of MRIs of patients treated at the University Hospital of the Ribeirão Preto Medical School, University of São Paulo, Brazil. The cases and images were collected from the Radiology Information System (RIS) and the Picture Archiving and Communication System (PACS) of the University Hospital spanning the period September, 2010–March, 2014. All exams were acquired using a Philips Achieva 1.5T MRI system (Philips Medical Systems, Best, The Netherlands). The MRI acquisition protocol was the clinical routine protocol, and the images used in the present study are the T1-weighted median sagittal slices of each patient. All cases were selected and the diagnosis reviewed by a senior radiologist (M.H.N.B.). Three radiologists previously diagnosed all cases, and cases of metastasis were confirmed by biopsy and histopathology. The MRI exams were made anonymous to ensure privacy of the patients. The imaging parameters used are: T1-weighted sequence with mean echo time (ET)=9.83±0.82 ms, mean repetition time (RT)=489±75.58ms, mean field-of-view (FOV)=32.25×33.33±3.98×6.39cm, acquisition type 2D, flip angle 90°, and a slice thickness of 4mm.For the present study, MRI exams of 63 patients, including 38 women and 25 men, with the mean age of 62.25±14.13 years, and diagnosed with at least one lumbar VCF were selected; some patients have more than one lumbar VCF. The set of images for analysis consists of 63 images in 8bits/pixel (256Gy levels) TIFF files, collected from 63 different exams. The lumbar vertebral bodies (L1, L2, L3, L4, and L5) are the regions of interest (ROIs) of our study. The data set includes 102 lumbar vertebral bodies with VCFs, of which 53 are secondary to osteoporosis (benign VCFs) and 49 are secondary to bone metastasis (malignant VCFs); in addition, the data set includes 89 nonfractured (normal) vertebral bodies of the lumbar spine. Nonfractured vertebral bodies were selected from MRI exams of patients with benign VCFs in other vertebrae. Nonfractured vertebral bodies of cases with malignant VCFs were not included in the set of normal vertebral bodies.Bone metastasis in the patients with malignant VCFs was secondary to multiple myeloma (n=12), breast carcinoma (n=8), lung carcinoma (n=1), prostate carcinoma (n=2), oropharyngeal squamous cell carcinoma (n=2), cholangiocarcinoma (n=1), paraganglioma (n=1), inflammatory myofibroblastic cancer (n=1), chronic lymphocytic leukemia (n=1), and acute lymphocytic leukemia (n=1).Manual segmentation of the lumbar vertebral bodies selected from the 63 images was performed by a medical student (G.A.M.) with previous training in segmentation of spinal anatomy in MRI using Adobe Photoshop software CS5™ [30], supervised by the senior radiologist (M.H.N.B.). In addition, the results of segmentation were verified and modified where needed by the senior radiologist. Thus, the ROIs used in the present study represent the results of consensus between two observers.Fig. 2 shows samples of ROIs of normal vertebral bodies, benign VCFs, and malignant VCFs used in the study;Fig. 3 shows the corresponding contours.We computed 27 features for each vertebral body ROI, covering 3 statistical measures of gray levels, 14 texture features, and 10 shape factors. All image processing and feature extraction methods were developed in MATLAB [25].Before feature extraction based on gray levels, blocks of size 5×5 pixels were automatically positioned at each lumbar intervertebral disc (seeFig. 4), using the manually drawn masks of the vertebral bodies as reference, and the mean gray-level of all such blocks was computed. Each sagittal MRI section was divided by the corresponding mean disc value and the result was linearly transformed to the range [0, 255].Three features were derived from the gray-level histogram of each vertebral body ROI. The featureCVis given by the ratio of the standard deviation to the mean of the ROI. The featuresSkewand kurtosisKurt[27] are the normalized third-order and fourth-order moments of the histogram characterizing the symmetry of the histogram and its peaked or tailed nature, respectively.We computed the 14 texture features defined by Haralick et al. [28] using the averaged coocurrence matrix of the gray levels of each vertebral body ROI in four directions (±0°, ±45°, ±90°, and ±135°) and with the distance of one pixel. The 14 features are angular second moment or energy (H1), contrast (H2), correlation (H3), sum of squares: variance (H4), inverse difference moment (H5), sum average (H6), sum variance (H7), sum entropy (H8), entropy (H9), difference variance (H10), difference entropy (H11), information measures of correlation 1 and 2 (H12andH13), and maximal correlation coefficient (H14). These measures are commonly used to characterize texture in medical images [12].Compactness is defined asC=P2/A, wherePis the perimeter or length of the contour of an object andAis the area contained within the contour. This dimensionless quantity is invariant to translation, rotation, scaling, and reflection, as desired in most applications of shape analysis. The quantityCincreases with increasing elongation, indentation, and roughness of the shape of the object. A normalized version of compactness was computed asCo=1−4πAP2,which has the range of [0, 1] with the value of zero for a circle. This feature has found applications in the analysis of breast tumors [12–14].The difference between the areas contained by a vertebral body contour (Varea) and its convex hull (CHarea) divided by the area within the contour defines the featureCDof the vertebral body:CD=CHarea−VareaVarea.IfCD=0, the vertebral body is a convex object comparable to a perfect rectangle; lower values ofCDare related to the presence of concavities as well as protrusions in the vertebral body.Fourier descriptors [12,31–33] are defined asz(k)=1N∑n=0N=1z(n)exp[−j2πNnk]k=−N/2+1, …,−1, 0, 1, 2, …, N/2, where z(n)=x(n)+jy(n), n=0, 1, ..., N−1, are the coordinates of the N pixels on the contour; see Rangayyan [12] for details and examples. Because the same sequence of contour pixels is obtained if the contour is traversed repeatedly, z(n) is a periodic signal. Hence, Z(k) represents a Fourier series, with k being the index of harmonics of a fundamental frequency. Z(1) and Z(−1) represent circles centered at the coordinates given by Z(0); the use of Z(−1), Z(0), and Z(1) together in the inverse Fourier formula leads to the best-fitting ellipse to the given contour. Rough contours cause larger values of Z(k) for higher values of k than smooth contours. In order to characterize the shape changes caused by VCFs, in particular the roughness caused by benign VCFs and the smoother changes caused by malignant VCFs, we define the feature FDF asFDF=∑k=k1N/2|Z(k)|2+∑−N2+1k=−k1|Z(k)|2∑k=−N2+1N/2|Z(k)|2with Z(0)=0. FDF represents the fraction of the total power present in the harmonics of order greater than ±k1, not including Z(0). After conducting several feature selection and pattern classification experiments with various values for k1, we set k1=⌊N/12⌋in the present work. FDF is normalized to the range [0, 1], with larger values for rougher shapes, corresponding to larger Fourier-descriptor values at higher frequencies.Hu [26] proposed seven shape factors, referred to asM1toM7, based on the moments of planar geometric figures, which have been used in many applications of shape analysis [12]. These features, while being effective in classification of several types of shapes, are difficult to interpret and relate to shape variations in a specific application such as analysis of breast tumors [9,12–14] or VCFs.Two different types of analyses were performed in the present work: classification of benign VCFs versus malignant VCFs, and classification of both types of VCFs together versus normal vertebral bodies. Feature selection and pattern classification experiments were performed using the machine learning software WEKA [34].The vectors of features were used as input to a wrapper method [35] for feature selection with a 10-fold cross-validation strategy. This method evaluates feature sets by using a learning scheme and the cross-validation step is used to estimate the accuracy of the learning scheme for a set of attributes. Features that were selected in at least 30% of the repetitions in the feature selection experiments were used in the subsequent pattern classification experiments with the same classifiers, also with 10-fold cross-validation. The classifiers used were the k-nearest-neighbor (k-NN) method [36], a naïve Bayesian classifier [37], and a neural network with radial basis functions (RBF network) [38]. The k-NN classifier was based on the Euclidean distance. The naïve Bayes classifier did not use either supervised discretization or any kernel estimator. The RBF network used the following parameters: clustering seed=1; minimum standard deviation for the clusters=0.1; number of clusters=2; and ridge value for regression=1.0E−8. The RBF network used the k-means clustering algorithm to learn a regression model.Feature selection experiments were conducted for each procedure of analysis and each classifier used. The performance of each classification procedure was analyzed using the confusion matrix, the area under the receiver operating characteristic (ROC) curve (AUROC), and accuracy (ACC). Stratified cross-validation was used with each fold having the same class distributions as the complete data set. The performance measures were averaged over all folds.In addition, statistical analysis was performed for each feature by grouping both VCFs together versus normal vertebral bodies and for benign VCFs versus malignant VCFs. The Kolmogorov–Smirnov test [39] was applied to check the normality of the distributions of the features. As all sets of all features rejected the null hypothesis that the samples follow a normal distribution, we used the Wilcoxon rank-sum test [40] to compute the p-values to analyze the statistical significance of the differences between the sets. Furthermore, the area under the estimated ROC curve (Az) was obtained using the ROCKIT software package [41].

@&#CONCLUSIONS@&#
