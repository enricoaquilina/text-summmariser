@&#MAIN-TITLE@&#
Methodology to automatically detect abnormal values of vital parameters in anesthesia time-series: Proposal for an adaptable algorithm

@&#HIGHLIGHTS@&#
Methods for automatic detection of abnormal vital signs occurring during anesthesia are poorly documented in the literature.Existing methods are not reproducible between databases.We have developed a data model and an algorithm that allow automatic detection of abnormal values of vital parameters occurring during anesthesia.Predefined thresholds and various parameters such as time between measurements and time spent outside predefined thresholds provide adaptability to various clinical situations, e.g. hypotension occurring after start of anesthesia.The relation between occurrence of abnormal values of vital parameters and mortality and length of stay may then be studied on a large and automated scale.

@&#KEYPHRASES@&#
Medical informatics,Time-series data analysis,Algorithm,Anesthesia,

@&#ABSTRACT@&#
Abnormal values of vital parameters such as hypotension or tachycardia may occur during anesthesia and may be detected by analyzing time-series data collected during the procedure by the Anesthesia Information Management System. When crossed with other data from the Hospital Information System, abnormal values of vital parameters have been linked with postoperative morbidity and mortality. However, methods for the automatic detection of these events are poorly documented in the literature and differ between studies, making it difficult to reproduce results. In this paper, we propose a methodology for the automatic detection of abnormal values of vital parameters. This methodology uses an algorithm allowing the configuration of threshold values for any vital parameters as well as the management of missing data. Four examples illustrate the application of the algorithm, after which it is applied to three vital signs (heart rate, SpO2, and mean arterial pressure) to all 2014 anesthetic records at our institution.

@&#INTRODUCTION@&#
Abnormal values of vital parameters (AVVP) such as hypotension or tachycardia frequently occur during anesthesia procedures and may lead to organ dysfunction, resulting in increased hospital length of stay, increased morbidity and, in some cases, death [1]. These AVVP are related to side effects of anesthetic drugs such as vasoplegia or myocardial depression, procedure-related complications such as bleeding or fluid loss, and patient-related risk factors and comorbidities stratified by ASA status (patient health status assessed before surgery on a scale of 1 to 6, defined by the American Society of Anesthesiologists [2]). Occurrences of AVVP can be detected by analysis of time-series data collected during the anesthesia procedure by Anesthesia Information Management Systems (AIMS). AIMS are a specialized form of electronic health record (EHR) systems that allow the automatic and reliable collection, storage, and presentation of patient data during the perioperative period, from preoperative assessments through the intraoperative period to discharge from post-anesthesia care unit (PACU). These systems record patient history, surgery or procedure, drugs administered, surgical and anesthetic procedures, ventilation parameters (tidal volume, inhaled oxygen fraction, inhaled and exhaled anesthetic gas fractions…) and both vital and physiologic parameters among which: mean arterial pressure (MAP), heat rate (HR), respiratory rate (RR), end-tidal CO2 (EtCO2), bispectral index (BIS, an electroencephalogram-based index designed to assess depth of anesthesia). AVVP are characterized by clinically relevant thresholds/ranges defined for each parameter and time elapsed outside predefined thresholds/ranges. As an example, intraoperative time spent with a MAP lower than 55mmHg is associated with increased likelihood of postoperative acute kidney injury and myocardial injury in patients undergoing noncardiac surgery [3].Through the implementation of Health Information Systems (HIS) in hospitals, huge volumes of data related to patient care are currently recorded daily worldwide [4,5]. Some components of HIS, such as EHRs and AIMS, allow physicians to access patient information remotely and instantaneously for decision making during care delivery. HIS also offer opportunities for further post hoc use of recorded data for research, decision support, quality-control, and optimization or educational purposes [6,7]. To these ends, anesthesia time-series data collected with AIMS may be used post hoc to automatically detect AVVP retrospectively for analysis [8]. Automatic detection of these events has been reported to be of better quality than when manually recorded [8–10]. Moreover, AIMS data may be further analyzed in relation with information about hospital stay from other Hospital Information System (HIS) databases. Indeed, some studies highlighted a statistical relation between the occurrence of intraoperative AVVP and increased mortality or length of stay [1,3,11–15]. However, AVVP detection methods and management of missing data vary widely. Moreover, these issues are compounded by poor description of methods used in reported studies, so that reproducing results obtained by others remains challenging.Concerning the issue of AVVP detection, various thresholds have been reported for vital parameters and for time elapsed outside of normal ranges. Reich et al.[12] measured hypotension using the median value of MAP measurements over a 5min period in order to minimize the effect of measurement artifacts. Each median value was then classified as low, normal, or high according to the two predefined upper and lower thresholds of 55 and 100mmHg, respectively. On the other hand, Sessler et al.[1] used the most recent values (measured at 1min intervals from an arterial line or at 5min intervals through oscillometry) within the past 20min when available, and were otherwise considered to be missing. Neither study provided information on how missing data were handled. In order to detect the same AVVP, Kertai et al.[11] chose the linear interpolation between two successive measurements, with a MAP threshold of 75mmHg defining hypotension. Records were excluded when there were missing data for more than 15 consecutive minutes for MAP, for more than 55% of the procedure time for BIS and/or more than 25% of missing data for the three studied parameters MAP, BIS, and Minimum Alveolar Concentration (MAC).As these studies, crucial to defining safe intraoperative care, become increasingly frequent, proposing reliable and reproducible methods for automatic detection of AVVP in anesthesia time-series data is a priority. To this end, we propose detailed principles for AVVP detection on time-series data, the parameters that must be taken into account to configure an AVVP detection algorithm, an algorithm based upon these principles, the associated data model that can be implemented to compute the total duration of AVVP over the studied period, and a proposal for management of missing data. Additionally, the application of the algorithm is illustrated with sample runs covering various cases.In order to be configurable in the way it deals with data and various missing data management methods, the algorithm must take into account the following constraints:•manage the input data flow and discern the different interventions recorded;allow simultaneous screening for AVVP across several parameter/thresholds as different parameters may present abnormal values over the same or overlapping periods;detect episodes of abnormal values with a beginning and an end per event;measure the time spent outside predefined thresholds for a given parameter, which can be either an absolute value or a relative change compared with a predefined reference value;manage missing data.In this section, we illustrate definitions related to AVVP detection and how missing data are managed in the case of hypotension, defined as a MAP lower than 60mmHg (threshold chosen from available studies [3,11]) (Fig. 1).Threshold value: value of the monitored parameter (e.g. heart rate, MAP, etc.…) used to define an abnormal value. In Fig. 1, the predefined threshold is represented as a dotted line. The threshold value can be an absolute value as in this case, or be a variation when compared with a reference value, for example, a 20% variation compared with the first MAP measured prior to anesthesia during a specific case.Episode of abnormal values: begins when a measure of a given parameter crosses the threshold and ends when the parameter reverts back to values within the normal range. For example in Fig. 1, a first episode of hypotension is triggered between T1 and T2, and a second episode is triggered between T3 and T4. The two episodes are represented as a shaded area. Given an episode i of abnormal values, with start and end time points TStartiand TEndi, the duration Diof the episode is:Di=TEndi−TStartiTotal duration of abnormal values: sum of all the episodes’ durations. In Fig. 1, the total duration of hypotension corresponds to the addition of durations of episodes 1 and 2. This can be generalized to a case presenting with n episodes i of an AVVP:Totaldurationofabnormalvalues=∑i=1nDi=∑i=1nTEndi−TStartiStudy period: period of interest for AVVP detection. This period must be clinically relevant as artifacts may occur in many situations, for example, when a patient is transferred from the operating room to the PACU. Moreover, to answer clinically relevant questions related to the administration of a specific drug, specific clinically relevant time periods related to drug pharmacokinetics and pharmacodynamics must be defined beforehand. In the case illustrated Fig. 1, the study period lasts for the whole anesthesia procedure.Measurement Interval (MI): time elapsed between two successively recorded measurements, between the start of the period of interest and the first measure, or between the last measure and the end of the period of interest. Clinical parameters are often recorded at irregular intervals, as illustrated in Fig. 2. MI corresponds to the duration of time between two successively recorded measures, between the start of the period of interest and the first measure, or between the last measure and the end of the period of interest.Interpolation method: corresponds to a way of dealing with irregular time intervals between successive measurements. Different interpolation methods rely on different hypotheses concerning how a physiological parameter evolves between two successive measurements. The sample-and-hold method consists in repeating the value until the next measure becomes available (Fig. 3a) [1] and the linear interpolation method relies on the assumption that a parameter increases or decreases linearly between two successive measurements [11], as illustrated in Fig. 3b, for the start and the end of two episodes.Sampling rate (SR): predefined time interval between successive measurements of a signal. As an example, MAP is usually non-invasively recorded every 5min (and can be measured invasively through an arterial line at much higher rates down to a beat-to-beat resolution). SR can be used to repeat the first measured value in the case of the sample-and-hold interpolation method defined above.Maximal interval between two successive measurements (MXI): maximal admissible time interval between two successive measurements. It may therefore be equal to or slightly longer than SR in order to take into account technical variations in sampling methods. In the case of MAP, an acceptable value of MXI would be 6min when SR equals 5min.Missing data episode (MD): when MI is longer than MXI, we considered that some data are missing. In this case, the last measurement is interpolated during SR duration, after which the period of time until the next available measurement is considered as MD. When an episode of abnormal values has been detected, that episode ends at the last interpolated value and the remaining time until the next available measure is recorded as MD. For example, in Fig. 4, the period between the 3rd and the 4th measurement is longer than MXI: the gray area after the last interpolated value is considered as a period without data (MD) and is not taken into account for calculating the duration of this AVVP episode.Total time with missing data (TMD): sum of all MD episodes. When divided by the duration of the studied period, it represents the proportion of missing data (PMD) during the period of interest.The maximal proportion of missing data (MXP): maximal acceptable proportion of TMD. As an example, Kertai et al. [11] excluded records whose PMD was over 25%.In order to exploit data recorded by the AIMS and other HIS software, a clinical data warehouse was developed at our institution [16], which is fed by the tool OpenText Integration Center [17] and stored in an Oracle 11g database [18]. The same technologies were used to implement the algorithm and store the results. With the use of such a database to store the algorithm results, huge volumes of data can be managed during the detection process and retrospectively queried to feed reports.Fig. 5represents the data model. The INTERVENTION, INTERV_MEASURE, INTERV_STUDY_PERIOD, and INTERV_REFERENCE_MEASURE tables store all necessary data for AVVP detection: procedures, measurements, and study periods for each procedure as well as reference measurements required to define relative thresholds.The THRESHOLD table is used to store predefined threshold parameters: threshold type, interpolation method, etc. The various fields are fully described (Table 1). The INTERV_EPISODE and INTERV_ABNORMAL_VALUE tables, respectively, store information about each detected AVVP episode and total duration of aggregated AVVP episodes resulting from the algorithm (Table 2).The automatic AVVP detection process includes three steps (Fig. 6): (i) data preprocessing, (ii) automatic scanning of time-series data with AVVP episode detection, and (iii) aggregation of AVVP episodes to measure total AVVP duration.Data preprocessing for AVVP detection includes the following steps:•Measurements are selected for procedures and physiological parameters corresponding to criteria required by the analysis. The procedures are selected when they fulfill inclusion criteria: age, type of anesthesia, and type of surgery (this information is stored in tables not represented in Fig. 5 in order to simplify the data model). In the case of MAP measurement, the system switches from non-invasive oscillometric blood pressure measurements to invasive arterial-line pressure measurements when appropriate, in order to use the data with the highest sampling frequency. This rule is automatically applied to any other signal with redundant recordings as well such as heart rate measured from both EKG and plethysmographic signals.Measurements are filtered over the studied period: events related to the various phases of the studied anesthesia procedures are detected (e.g. induction, intubation, incision, end of surgery, end of anesthesia, extubation, and administration of a drug). These phases are identified in order to define the temporal boundaries between which measurements are selected and stored in the table INTERV_STUDY_PERIOD. For recordings with missing event data, we have developed a substitution method that allows automatic approximation of anesthesia procedure phases even if events are not clearly flagged in the original AIMS recording [19].Artifacts and aberrant data are rejected when outside of plausible physiological/pathological ranges and necessary data are collected or computed so that quality indicators can be measured.When detection of the relative variation of a parameter is concerned, reference values are defined and collected.Measurements are ordered by procedure, threshold, and date of record.The recorded measurements are scanned one-by-one. At the end of each iteration, the last scanned measurements are kept so that they can be compared with the next measurements, so that a change of threshold or study period can be detected.Local variables are used during the AVVP detection process to store data related to the calculation steps of the algorithm (start and end of an AVVP episode, successive durations of missing data periods). At the end of the process, their contents are recorded in the INTERV_EPISODE and INTERV_ABNORMAL_VALUE tables, respectively, at the end of the calculation.The AVVP detection algorithm is represented in Fig. 7. The operations are defined below:Measurement selection: selection of necessary data: procedure and thresholds, study period dates, measurement date, measurement value, threshold value, SR, and IMAX.Measurement comparison: previously selected measurement is compared with the last locally stored measurement to check whether the intervention, the threshold or the study period has changed.Case initialization: identifier numbers of procedures, thresholds, and period with the current selected measure data are initialized. Cumulated duration of missing data is set to zero.Episode opening: local storage of start date of the considered AVVP episode. The date is the measurement's date in situations 1 and 3, but is interpolated in situation 2.Episode closing: start and end dates of episode are recorded in the INTERV_EPISODE table. In situations 1 and 3 (last measurement of a procedure), the end date of the AVVP episode is expressed as the date of the actual measurement when MI is lower than MXI, otherwise it is equal to the last interpolated measurement. In situation 2 (MI>MXI), the end date is equal to the last interpolated measurement.Adding missing data: duration of missing data period is computed as reported in Fig. 4. In situation 1, the missing data duration is equal to the difference between the date of last interpolated measurement and the period end date. In situation 2, it is equal to the difference between the period start date and the first measurement. Finally, in situation 3, it is equal to the difference between the date of the last interpolated measurement and the date of the next available measurement.Missing data recording: the cumulated duration of missing data periods is stored in the INTERV_ABNORMAL_VALUE table.Local variable storage: the actual measurement is kept to allow comparison or interpolation with the next measurement.The last step of the process consists in the aggregation of AVVP episodes so that the total duration of abnormal values, the number of episodes and the extreme values over the studied period can be computed. If PMD is higher than MXP, the record is excluded from the analyzed dataset, otherwise, data are recorded in the INTERV_ ABNORMAL_VALUE table.In this section, we propose four case studies covering different record types (with/without AVVP and with/without missing data) for the detection of tachycardia defined by a heart rate over 100 beats per minute (bpm). It shows the potential of the algorithm to manage records in various situations. Other parameters, such as arterial pressure, pulse oxymetry, etc.…are handled in the same way by the algorithm.The parameters used to configure automatic detection are detailed in appendix A and correspond to the first threshold: the threshold value is 100bpm and MXI is 60s. The time-series data are presented in Fig. 8a. For each case, the input data correspond to anesthesia time-series ordered by case, threshold and study period as specified in the preprocessing section. Data for each case study are available in the supplementary material section. After algorithm application, results are reported for detected AVVP episodes (start and end of each episode, duration) and for the entire procedure (duration of missing data, proportion of period with missing data, total duration outside threshold, and number of AVVP episodes).Fig. 8b reports the results for the four cases. The full results are available as supplementary data. In case 1, no AVVP is detected. Four episodes of AVVP are detected in case 2, with a total duration of heart rate over 100bpm of 19.8min. For the third case, eight episodes are detected with a total duration of 31.5min. The duration of missing data is 27.3min, which correspond to 24.4% of the study period duration. In case 4, three episodes of AVVP are detected, for a total duration of 6.1min. Data are missing during 36min which corresponds to 30% of the procedure. As a result, this record would be excluded from further analysis, as the proportion of missing data is superior to the permitted proportion (25%).This automatic AVVP detection method was applied retrospectively on data recorded at the University Hospital of Lille, France (CHU Lille) [20]. We applied this method to the detection of three types of AVVP occurring during procedures performed on adult patients in 2014: tachycardia over a threshold of 100bpm, bradycardia below a threshold of 50bpm and hypotension according to different MAP thresholds: below 50, below 65mmHg (with both sample-and-hold and linear interpolation methods) and MAP below 80% of the first recorded measurement. Parameters for these three AVVP are detailed in appendix A. Results are presented (Table 3).Automatic AVVP detection thus configured and applied to the 50 480 adult patient procedures performed in 2014 for the detection of MAP lower than 65mmHg with the linear interpolation method showed that: (i) 25 422 interventions had missing data, with a median [1st quart.-3rd quart.] duration of 13.3 [4.2−111.6] minutes of missing data and a median [1st quart.-3rd quart.] proportion of 14.4 [3.7−55.5] % of missing data over the studied period. (ii) 33 669 interventions had less than 25% missing data and could be included for AVVP detection. (iii) From these 33 669 interventions, 19 964 presented at least one AVVP episode, with a median [1st quart.-3rd quart.] total duration of 15.1 [5.9−34.7] minutes.

@&#CONCLUSIONS@&#
