@&#MAIN-TITLE@&#
An approach to the asymmetric multi-depot capacitated arc routing problem

@&#HIGHLIGHTS@&#
The directed multidepot capacitated arc routing problem is addressed.An MILP formulation and some valid inequalities that can be used to tighten its LP-relaxation are proposed.A branch-and-cut approach for solving the problem exactly is presented.A numerical study exploring the properties of the multidepot version of the problem and of the proposed approach is reported.

@&#KEYPHRASES@&#
Arc routing,Valid inequalities,Branch-and-cut,

@&#ABSTRACT@&#
Despite the fact that the Capacitated Arc Routing Problems (CARPs) received substantial attention in the literature, most of the research concentrates on the symmetric and single-depot version of the problem. In this paper, we fill this gap by proposing an approach to solving a more general version of the problem and analysing its properties. We present an MILP formulation that accommodates asymmetric multi-depot case and consider valid inequalities that may be used to tighten its LP relaxation. A symmetry breaking scheme for a single-depot case is also proposed. An extensive numerical study is carried to investigate the properties of the problem and the proposed solution approach.

@&#INTRODUCTION@&#
The Capacitated Arc Routing Problem (CARP) originally defined by Golden and Wong (1981) has been extensively studied during the recent decades due to its numerous potential applications, including post delivery, waste collection, winter services (e.g. salt gritting or snow plowing), public transport routing, etc. To fulfil the needs of applications, a number of extensions and modifications of the CARP were considered. These can be roughly classified based on the following features:•symmetric (undirected) vs. asymmetric (including a particular case of directed) network;single vs. multiple vehicles;single vs. multiple depots;single vs. multiple objectives (see, e.g., Grandinetti, Guerriero, Laganá, and Pisacane, 2003);additional constraints: time windows, priorities, etc.For an overview of the modifications and solution methods we refer the reader to Corberan and Prins (2010); Hertz (2005). The available solution approaches can be divided into two broad categories: (a) those based on a reduction of the ARP to the Vehicle (Node) Routing Problem (VRP) (Longo, de Aragão, and Uchoa, 2006), and (b) those designed specifically for the ARP. The success of the first group of approaches is partially based on the fact that the VRP is substantially better studied than the ARP. At the same time, the transformation of the ARP to the VRP ignores sparsity of the underlying graph and creates computational problems for larger networks. On the contrary, most of the original ARP approaches utilise the sparse nature of realistic road networks (see Fig. 1), which allows large instances at least to be handled, if not solved to optimality (see, e.g., Bartolini, Cordeau, and Laporte, 2013; Bode and Irnich, 2012; 2014; Corberan, Oswald, Plana, Reinelt, and Sanchis, 2012 for a single vehicle case).As seen from the literature, most research concentrates on the undirected version of the problem (see, e.g., Belenguer and Benavent, 2003; Bode and Irnich, 2014 and references within). At the same time, one way streets are not uncommon, which implies that a realistic approach should be able to handle this case. Furthermore, we could not find an exact approach dealing with the multi-depot CARP – another natural extension of the original problem. These observations motivated us to consider a more general version of the CARP with multiple depots and directed arcs.The major goal of this paper is to study the properties of the CARP and to consider the possibility of finding exact solutions to the multi-depot CARP for realistic (large, sparse, asymmetric) road networks.This paper is organised as follows. The next section presents the basic MILP formulation utilised throughout the paper. Section 3 focuses on the inequalities that can be used to tighten the formulation, followed by Section 4 describing our branch-and-cut solution approach. Section 5 provides a computational study of our approach. Finally, Section 6 concludes the paper with a summary of main results and future research directions.In this section, we propose a two-index MILP formulation for the asymmetric multi-depot CARP. First, we introduce some notions and notation.Through the rest of the paper, let G(V, A, w) denote a directed weighted graph with the set of vertices V (|V| = n), the set of arcs A (|A| = m) and a weight functionw(·):A→R+. Given some set S⊂V, G(V∖S) denotes a graph obtained from G by deleting each vertex from S together with all incident arcs.A walk of length L in G is a sequence i1 − i2 − ⋅⋅⋅ − iLof vertices such that there is an arc between each consecutive pair, i.e. (il, il + 1) ∈ A for all l = 1, …, L − 1. Without any ambiguity one may think of a walk in terms of the corresponding arcs, rather then vertices. Under a tour, we understand a walk for which holds i1 = iL, and by the weight of a walk we understand the sum of the weights of all arcs in it. Note that the multiplicity of arcs in a walk does matter, i.e. if some arc is traversed three times then its weight contributes to the weight of the walk with a factor of 3. An elementary cycle is a tour traversing each vertex and arc at most once. Given a directed cycle i1 − i2 − ⋅⋅⋅ − ij− ⋅⋅⋅ − ik− ⋅⋅⋅ − iL, arc (ij, ik) is a forward chord if i1 − i2 − ⋅⋅⋅ − ij− ik− ⋅⋅⋅ − iLis also a directed cycle. Respectively, arc (ik, ij) is a backward chord.We say that vertex j is reachable from vertex i, if there exists a directed i − j path; arc (j, l) is reachable from i, if j is reachable from i.Further, for any subset S ∈ V let us denote by δ+(S) = {(i, j) ∈ A | i ∈ S, j ∈ V∖S} and δ−(S) = {(i, j) ∈ A | i ∈ V∖S, j ∈ S} the sets of arcs having one of the endpoints in S; for singletons we use shortcuts δ+(i) = δ+({i}) and δ−(i) = δ−({i}).The problem under consideration can be formalised as follows. Given a directed weighted graph G(V, A, w), a demand functiond(·):A→R+,selected vertices (depot vertices)vkd∈V(k ∈ K) and a numberQ∈R+(capacity), the goal is to find:•|K| tours of the minimum total weight, each tour traversing a corresponding vertexvkd(k ∈ K);an assignment of arcs with positive demand to the tours, such that each arc is assigned to one of the tours and the sum of demands assigned to a tour does not exceed Q.Let us denote da= d(a), Ad= {a ∈ A | d(a) > 0} and introduce two sets of variables:zak∈Z+(a ∈ A) denote how many times arc a ∈ A is traversed by tour k, andxak∈{0,1}(a ∈ Ad) reflect the assignment of arcs to the tours. Now, the problem can be formulated as follows.(1)∑k∈K∑a∈Awazak⟶min(2)s.t.∑a∈Adaxak≤Q,k∈K(3)∑k∈Kxak=1,a∈Ad(4)∑a∈δ+(i)zak=∑a∈δ−(i)zak,i∈V,k∈K(5)xak≤zak,a∈Ad,k∈K(6)∑a∈δ−(i)uak≤1,i∈V,k∈K(7)uak≤zak,a∈A,k∈K(8)∑a∈δ−(vkd)uak=0,k∈K(9)yvkdk=0,k∈K(10)yjk≥yik+1+M(u(i,j)k−1),(i,j)∈A,k∈K(11)∑a∈δ−(i)uak≥1M∑a∈δ+(i)zak,i∈V∖{vkd},k∈K(12)zak∈Z+,a∈A,k∈K(13)xak∈{0,1},a∈Ad,k∈K(14)yik∈R+,i∈V,k∈K(15)uak∈{0,1},a∈A,k∈KObjective (1) explicitly minimises the total weight of all the tours. The capacity of each tour is limited by constraints (2), while constraints (3) ensure that each demand arc is served. Constraints (4) are flow conservation constraints. Further, constraints (5) ensure that only traversed demand arcs can be assigned to a tour. Finally, constraints (6)–(11) ensure connectedness of each tour by constructing a tree rooted at the depot vertexvkdand spanning all vertices traversed by a tour. The tree is oriented so that there is a directed path from the root to each leaf. Variablesuakreflect the arcs in such a tree, while variablesyikdenote the level of vertex i in a tree. The root has level 0 (as assigned by constraints (9)), its neighbours have level 1, etc. Constraints (6) and (7) ensure that each vertex in the tree has at most one incoming arc and that the tree contains only the traversed arcs, respectively. Constraints (10) prohibit cycles. Constraints (11) ensure that each traversed vertex, except the depot, has an incoming arc in the tree. Parameter M in (10) and (11) is a large enough positive number. Note that constraints (6)–(11) are given here purely on the purpose of making the formulation complete and are not used further in this paper.It is not hard to understand that the proposed formulation can be adjusted for the case of an undirected graph by assuming that each undirected edge is represented by two arcs and replacing constraints (3) by:(16)∑k∈Kx(i,j)k+x(j,i)k=1,(i,j)∈Ad.Though this formulation has a polynomial size, it is quite extensive, both in terms of constraints (|Ad| + (4 + 3n + 2|Ad| + 5m)|K|) and variables (m|K| + |Ad| · |K| + n|K| + m|K|), 2m|K| + |Ad| · |K| of which are integer. In case all arcs have positive demands, Ad= A holds and these quantities become n + (4 + 3n + 7m)|K|, (n + 3m)|K| and 3m|K|, respectively. However, it can be seen that as much as (3 + 3n + 5m)|K| constraints and (n + m)|K| variables (m|K| of which are integer) are used purely to guarantee connectedness of the tours. In fact, constraints (6)–(11) can be replaced by the following subtour eliminating constraints:(17)∑a∈δ+(S)zak≥1M∑a∈A′zak,k∈K,wherevdk∈S⊂V,A′ = {(i, j) | (i, j) ∈ A, i, j ∈ V∖S}, M is a large enough positive constant ensuring that the right hand side does not exceed 1. Similar constraints are considered in Maniezzo (2004), but we will show how to strengthen them.Though formulation ((1–5), (12)–(13), (17)) can have exponentially many constraints, it can be utilised within a row generating framework to realise computational benefits. The further analysis is based on its LP relaxation. Note that this formulation does not explicitly contain information about locations of the depots, this information is implicitly present only via the definition of sets S in constraints (17).In this section, we consider several families of valid inequalities, divided into two major groups: (a) structural inequalities enforcing a correct structure of feasible solutions, and (b) capacity-related inequalities derived from the capacity constraints. Note that some of these valid inequalities were also used in other CARP formulations, but we describe them for the sake of completeness (there are certain peculiarities w.r.t. our formulation). In addition, we consider symmetry breaking constraints that are not valid inequalities, as they cut off some feasible solutions (but preserve at least one optimal solution).We first show how the subtour elimination constraints can be tightened and propose other valid inequalities based purely on the structure of the tours.Observe that any optimal solution to our relaxation does not contain a subtour not serving any demand arc, because eliminating such a subtour improves the objective value (assuming that all arc weights are positive) and does not violate any constraints. Taking this into account allows revising inequality (17) as:(18)∑a∈δ−(S)zak≥1|A′|∑a∈A′xak,where A′ = {(i, j) | (i, j) ∈ Ad, i, j ∈ V∖S}. Though one constraint (18) per cut (equivalently, per set S) suffices, it is beneficial to split it as follows:(19)∑a∈δ−(S)zak≥xak,∀a∈A′,because the latter leads to a tighter LP relaxation.Constraints (19) can be trivially tightened in case G(V∖S) is disconnected: each left hand side sum can be limited to only arcs joining S with the connected component of G(V∖S) containing particular a ∈ Ad(see Fig. 2a).However, for a directed graph this case can be generalised and constraints (19) can be tightened even if G(V∖S) is connected but not strongly connected (see Fig. 2b). In particular, it is enough that for each demand arc a′ = (i′, j′) ∈ A′ the left hand side sum is taken only over all arcs a = (i, j) ∈ δ+(S) for which i′ is reachable from j in G(V∖S).Besides the case of disconnected subtours, inequalities (19) can be used to cut off some fractional solutions corresponding to connected tours. However, in this case the separation problem becomes more difficult: instead of just identifying connected components, it involves finding a cut with a weight smaller than the weight of some arc separated from the depot by the cut (weights are values of z-variables in the solution). We formulate this separation problem as an MILP (see Appendix B.1).Besides the subtour elimination (necessary for a valid ARP solution), there are a number of constraints that tighten the LP relaxation and may be useful in practice. Here we would like to consider a family of inequalities that rely on the presence of bridges in the input graph.Let us define a bridge as a pair of opposite arcs whose removal increases the number of connected components in G by 1. This notion of a bridge is quite general, but we consider only two types of bridges that we call O-bridges (two arcs share two vertices) and V-bridges (two arcs have one common vertex), see Fig. 3.The following simple observation shows that O-bridges have a very general property.Observation 1In each optimal solution to ARP, each arc in any O-bridge is traversed by each tour at most once.The properties of V-bridges are less general. Let us consider some V-bridge B = {(i, j1), (j2, i)} that decomposes G into G1(V1, A1) and G2(V2, A2) so that i ∈ V1 and j1, j2 ∈ V2. If one defines G′ as G′(V2∪{i}, A2∪B), then the following lemma takes place.Lemma 1If G′ defined above is a directed cycle without forward chords or G′ contains an arc (j2, j1) such thatw(j2,j1)<w(i,j1)+w(j2,i),then each arc from B is traversed by each tour at most once in any optimal solution.Let us label vertices of G′ as i1, i2, …, inso that G′ contains all arcs of the type (ij, ij + 1) (j = 1, …, n − 1) and arc (in, i1). Suppose, i1 corresponds to i in the statement of the lemma, then i2 and incorrespond to j1 and j2, respectively. Note that G′ does not contain any chord having i1 as one of its endpoints, due to the fact that {(i1, i2), (in, i1)} corresponds to a bridge in G.Clearly, if G′ is a chordless cycle, each arc needs only to be traversed at most once. If G′ contains a backward arc, say (i8, i5), than the route i1 − ⋅⋅⋅ − i8 − i5 − ⋅⋅⋅ − i8 − ⋅⋅⋅ − inis the shortest route traversing each arc in G′ and it does not traverse (i1, i2) and (in, i1) more than once. It is straighforward to check that the latter holds also in case of an arbitrary number of backward arcs. Presence of a single forward arc, say (i5, i8), leads to an optimal route i1 − i2 − ⋅⋅⋅ − i5 − i8 − ⋅⋅⋅ − in− i1 − i2 − ⋅⋅⋅ − i5 − ⋅⋅⋅ − i8 − ⋅⋅⋅ − inthat traverses (i1, i2) and (in, i1) twice. However, if G′ contains a shortcut (in, i2) satisfying the condition of the lemma, any route traversing (i1, i2) and (in, i1) at most once will be optimal, e.g. i1 − i2 − ⋅⋅⋅ − i5 − i8 − ⋅⋅⋅ − in− i2 − ⋅⋅⋅ − i5 − ⋅⋅⋅ − i8 − ⋅⋅⋅ − in. Again, it can be easily verified that the result extends to the case of arbitrarily many forward arcs in G′.□If G′ defined above contains an arc (j2, j1) such thatw(j2,j1)<w(i,j1)+w(j2,i),then each arc from B is traversed by each tour at most once in any optimal solution.Note that the flows through (i, j1) and (j2, i) are equal for any feasible solution. Suppose, there is an optimal solution violating the assertion of the corollary. By replacing a unit of flow through j2 − i − j1 by a unit of flow through (j2, j1) one improves the objective value while preserving feasibility.□These properties of bridges allow introducing the following constraints that exclude fractional solutions similar to the one in Fig. 4.Lemma 2Suppose, {(i, j1), (j2, i)} is an O-bridge (in this case j1 = j2) or a V-bridge satisfying Lemma 1. Then the following constraint is valid:(20)∑a∈δ+(i)∖(i,j1)zak≥z(i,j1)k.Let us consider the following two cases:z(i,j1)k=0andz(i,j1)k≥1. In the first case, the inequality trivially holds. The second case can be reduced toz(i,j1)k=1due to Observation 1 or Lemma 1, depending on the type of the bridge under consideration. Suppose, that the inequality (20) is not valid. This implies existence of a feasible route traversing (i, j1) but not traversing any arc a ∈ δ+(i)∖(i, j1) and, thus, not containing any path from i to the depot. This, in turn implies that the route contains a directed path from j1 to the depot that does not include arc (j2, i), which is a contradiction because {(i, j1), (j2, i)} is a bridge.□Fig. 4 illustrates bridge inequalities. It can be seen in the figure that {(v2, v3), (v4, v2)} is a V-bridge, and inequality (20) becomesz(v2,v1)k≥z(v2,v3)k,which is violated by the given solution.Clearly, the number of bridges is at most m/2 as each arc can belong to only one bridge. This bound is tight for O-bridges (consider a graph obtained from an undirected tree by replacing each edge by two opposite arcs). Taking into account that the number of possible bridge inequalities is relatively small, it makes sense to include all of them into the formulation.Taking into account that our formulation contains the so-called knapsack constraints (2) one may apply to each tour any of the valid inequalities for the well studied 0–1 knapsack problem, e.g. cover inequalities for which separation and lifting procedures are known (see, e.g., Balas, 1975). However, such inequalities may not work well in practice, because the projection of the ARP feasible set onto the subspace of x-variables for each tour has a nonempty intersection with the interior of convex hull of 0–1 knapsack feasible solutions. This is due to the fact that normally ∑a ∈ Ada< Q|K| holds as a strict inequality. Thus, pure exploitation of the knapsack constraints in the space of x-variables seems not very promising.Observing the fact that constraints (2) and (3) describe a polytope of the Generalised Assignment problem (GAP), one may try to separate some of the GAP facet defining inequalities. For an overview of the GAP and corresponding inequalities, see, for example, Gottlieb and Rao (1990). However, according to our experience, these are not efficient: in a branch-and-cut tree with hundreds of nodes we could find only a couple of violated GAP inequalities using both specific GAP cutting planes and general techniques, like lift-and-project procedure (see, e.g., Balas, Ceria, and Cornuéjols, 1993). To sum up, any cutting planes defined only in the space of x-variables are unlikely to be violated by solutions to our LP-relaxation.This motivated us to consider possibilities of utilising knapsack constraints in the space of both x- and z-variables exploiting relations between the two classes of variables. As we show in the next sections, this can be done in different ways.Consider some subsetS⊂V∖{vkd}k∈Knot containing any of the depot vertices. Clearly, if the total demand of all arcs having at least one endpoint in S exceeds Q then at least two tours cross δ+(S) (or, equivalently, δ−(S)). This idea may be generalised into the following inequality:(21)∑k∈K∑a∈δ+(S)zak≥⌈1Q∑a∈A′∪δ(S)da⌉,where A′ = {(i, j) | (i, j) ∈ Ad, |{i, j}∩S| ≥ 1}. Equivalent inequalities were proposed by Belenguer and Benavent (2003) for their aggregated formulation.The separation problem for inequalities (21) is equivalent to the problem of finding a cut (in a graph of the same size as the input graph) of a weight exceeding a certain threshold that depends on the cut itself. For the numerical experiments, we formulated this separation problem as an MILP (see Appendix B.2). As the structure of the latter closely resembles the structure of an MILP formulation for a polynomially solvable mincut problem, it can be solved reasonably fast.Note that inequalities (21) are aggregated in a sense that they impose certain constraints on all the tours. At the same time, they induce inequalities involving only a subset of all the tours. For some fixedS⊂V∖{vkd}k∈K,if one denotes by q the value of the right hand side in (21), then the following inequalities are valid:(22)∑k∈K′∑a∈δ+(S)zak≥1,∀K′∈K:|K′|=|K|−q+1.These inequalities make sense only if the demand cannot be served by less than |K| vehicles. Let us denote by Q′ the minimum demand assigned to a route. This can be approximated as Q′ ≥ D − Q · (|K| − 1), where D is the total demand, or computed via a variant of the bin packing problem. It is not hard to understand that the inequality(23)∑a∈δ+(S)zak≥1,k∈Kis valid for any S satisfying∑a∈Ad∩S×Sda<Q′. For a particular tour k′, it can be lifted by introducing the information from other tours as follows:(24)∑a∈δ+(S)zak′+∑k∈K∖{k′}∑a∈A′xak≥1,where sets S⊂V and A′⊂Ad∩S × S must satisfy∑a∈(Ad∩S×S)∖A′da<Q′. In particular, if A′ = ∅, inequality (24) transforms to (23), and S must be small enough to satisfy∑a∈Ad∩S×Sda<Q′). Otherwise, S can be an arbitrary large subset of V. Note that each such valid inequality is described by a triple (k′, S, A′).The separation problem for (24) can be solved in two ways: either by formulating it as an MILP (see Appendix B.3) or by the following heuristic algorithm (we use the notationx¯to denote the value of variable x):1.Input: graph G(V, A), solution to cut off(z¯ak,x¯ak),k′ ∈ KInitialise: S* ≔ V, A′* ≔ Ad– parameters of the cut (24); define viol(k′, S, A′) as an amount by which inequality (24) is violated for the given parametersRepeat: L times1.generate a random cut δ(S) in G by running the contraction algorithm (see, e.g., Karger and Stein, 1996) while treating valuesz¯ak′as weights of arcs in G.if∑a∈δ+(S)z¯ak′≥1−viol(k′,S*,A′*),then go to step 1, else:solve the following knapsack problem(25)u*=argmax{∑a∈Ad∩S×Sx¯ak′ua:∑a∈Ad∩S×S(∑k∈K∖{k′}x¯ak′)ua≤Q′}defineA′:={a:ua*=0}and calculate the violation viol(k′, S, A′) of (24) for the current k′, S, A′.if viol(k′, S, A′) > viol(k′, S*, A′*), then update S* ≔ S, A′* ≔ A′.Output: (k′, S*, A′*)The contraction algorithm (step 1) tends to produce a cut in G minimising the leftmost sum in (24), while by solving the knapsack problem the second sum is minimised. Step 2 is a shortcut that reduces the amount of computations for the cutting planes that cannot be stronger than the previously found one. Parameter L must be chosen in order to balance the quality of the generated inequalities and the computational effort. The value L = |V|2log(|V|) guarantees that the cut minimising the first sum in (24) is found with a high probability (see, e.g., Karger and Stein, 1996), but it may not correspond to the most violated constraint. We use a fixed value L = 100 for the sake of efficiency.Though the knapsack problem (step 2) is NP-hard, there exist a number of efficient specialised algorithms. We use the one by Pisinger (1996).To the best of our knowledge, this family of cutting planes is not described in the literature.In Appendix A we present one more family of valid inequalities that we call CI3. These inequalities, however, did not prove useful.Clearly, in case all the depots are placed in the same vertex (a single-depot case), the described above model has an inherent symmetry w.r.t. a permutation of routes. In contrast to the node routing, there is also another source of symmetry inherent to both single- and multi-depot case. Such a symmetry relies on the fact that feasible routes may intersect, i.e. some arcs may (usually, will) be traversed by more than one vehicle. This creates certain freedom in assigning demands to routes: serving the demand of some arc by any of the vehicles traversing it does not affect the objective value (of course, if capacity constraints permit).These symmetries can be also seen in our formulation. It is easy to see that all the described constraints are either valid for each route or contain variables from all routes with equal coefficients. Even if depots are placed in different vertices, only constraints (19) may break the symmetry if derived from a cut separating at least one pair of depots.Let us start with a single-depot case. One can reduce the symmetry by considering only a subspace of solutions where the routes are sorted by the demand they serve, for example, in a decreasing order. That is, the following constraints can be included into the formulation while preserving at least one optimal solution:(26)∑a∈Adda(xak−xak+1)≥0,k=1,…,|K|−1.In general, these constraints are not very efficient because there are feasible solutions with some routes serving equal demands. Now we are going to show how these constraints can be modified to become more useful. The modification is based on the following general observation.Observation 2Constraints(27)∑a∈Adαa(xak−xak+1)≥0,k=1,…,|K|−1preserve at least one optimal solution for any fixed set of real coefficients{αa}a∈Ad.The proof is trivial: take any optimal solution and permute the routes so that the corresponding sums become sorted.Observation 2 means that instead of actual demands one can choose ’surrogate’ coefficients for (26) so that the left hand side tends to be strictly positive for most of the feasible solutions. A straightforward (yet, not very practical) choice is given in the following proposition.Proposition 1Constraints(28)∑i=1|Ad|2i(xik−xik+1)≥1,k=1,…,K−1preserve at least one optimal solution.This proposition is easy to verify if one treats(x1k,…,x|Ad|k)as a binary representation of some integer. As each route in a feasible solution has a unique set of x-values, the corresponding integers are also all different, allowing for 1 in the right hand side.By performing a more rigorous analysis, it is possible to select a sequence of coefficients which is dominated by {2i} but still guarantees 1 in the right hand side of inequality (28). Still, we conjecture that each such sequence has an exponential (average) rate of growth, and is practically inapplicable due to computational issues. On the other hand, we will show in Section 5 that constraints (27) equipped with coefficients of the form (1 + ε)imay be useful, where ε is a constant small enough to ensure that all the coefficients are of a reasonable magnitude.In a multi-depot setting, Observation 2 does not hold in general. Constraints (27) can still be used for obtaining high quality solutions, but optimality is not guaranteed in this case.Given the LP-relaxation of formulation ((1–5), (12–13), (19)) and the families of constraints described in Section 3 we develop a branch-and-cut algorithm. Note that the cutting plane approach alone does not work because all the constraints mentioned above do not suffice for a complete description of the convex hull of feasible solutions.As input of the algorithm, we assume the formulation ((1–5), (12–13)) extended with bridge inequalities (20). The subtour elimination inequalities (19) are added during the cutting phase as needed.Each node of the BnB tree (subproblem) is subjected to a cutting phase when violated inequalities (19), (21) and (24) are added sequentially until none can be found. If the rounded up lower bound of the node exceeds the best global upper bound or an integer solution is found, the node is fathomed. Otherwise, a branching step takes place.A variety of branching rules were implemented and tested. The first is the classical branching on the most fractional variable: if fxdenotes the fractional part of some variable x, then the variable with the highest value of (0.5 − |0.5 − fx|) is selected. We also consider a weighted extension of this rule by multiplying the just mentioned criterion by the weight of the corresponding arc.Observing the relations between x-variables, we have also developed another rule for selecting a variable to branch upon. Let us fix some arc a and consider the corresponding variablesxa1,…,xa|K|. While in any integer feasible solution exactly one of them must be nonzero, a feasible solution to the LP- relaxation may assign several positive values to these variables. Intuitively, this can be interpreted in the following way: instead of selecting a single route to serve arc a the LP-relaxation ‘prefers’ some routes (those with higher values) to other ones. In the worst case, there is no preference and all the variables obtain the value of 1/|K|. Another interpretation is as follows. Suppose, one is going to perform a randomised rounding of the fractional solution. Clearly, rounding each x-variable independently is not efficient because this may generate a lot of infeasible solutions. It rather makes sense to randomly select one variable for each demand arc that will be set to 1. A natural distribution for this randomised selection is described by the values of the variables. Now, the case when all these variables are equal to 1/|K| is the worst one because it represents the highest uncertainty, or, equivalently, the highest entropy. Thus, we propose first to select arc a with the highest entropy defined as−∑kxakln(xak)and then for this fixed a select the most fractional variablexak. Such a procedure tries both to reduce uncertainty and to perform the deepest cut. A weighted extension of this branching rule is also possible where entropies are multiplied by the weights of the corresponding arcs. This branching rule can be also applied to z-variables by considering the fractional parts of their values.The strength of the above two rules is that they essentially fix some variables. Their weakness is due to the local effect: at each branching only 1 variable is affected if branching was performed on a z-variable, and K variables are affected otherwise. This effect may result in very slowly growing lower bounds and deep branch-and-bound trees. This motivated us to consider alternative branching rules that would facilitate a faster update of the lower bound.One of such possibilities is branching on the flows through vertices: the sums of in- and outcoming flow variables must be integral for each vertex. For vertices with an in- or out-degree of 1 this rule is equivalent to branching on a single z-variable, but for vertices with higher degrees it has a more global impact. A similar branching rule was used e.g. in Bode and Irnich (2012).An even stronger possibility is the branching on cuts in G: a one-way flow through each cut in the input graph must be integral. Except of affecting many variables (those corresponding to arcs in a cut) this rule has another advantage. If the flow through the cut is set to 0, none of the arcs separated by the cut from the depot vertex can be served by the current tour and some x-variables can be fixed to 0. Actually, this latter case is the most interesting; that is why we consider only cuts where a one-way flow does not exceed 1. Finding a cut to branch upon is essentially equivalent to finding a minimum cut and can be efficiently done.The purpose of our numerical experiments is twofold. First of all, we want to check the possibility of solving the CARP defined on large networks and the impact of the proposed cutting planes, symmetry breaking constraints and branching rules. Next, we want to study the influence of a multi-depot setting on the complexity of the problem. Thus, the experiments can be divided in two groups: those aimed at studying the properties of the approach and of the multi-depot CARP itself, respectively.For testing purposes, we propose a library of benchmark instances that contains:1.Self-generated artificial instances (see Table 1):•nested structure (a wide range of weights and demands: max.weight/min.weight ≈ 50);grid structure (a small range of weights and demands: max.weight/min.weight ≈ 5).Instances from the CARP literature (see Table 2).Instances derived from real road networks (see Table 3).The library and its detailed description are available at http://smartlogisticslab.ieis.tue.nl/#benchm.For the experimenting purposes, the formulation was solved with CPLEX 12.6 (single thread mode), the proposed cutting planes and branching rules were implemented as callbacks and coded in C++. The subtour eliminating constraints were implemented as lazy cuts. Based on the testing experience, a limit of 75 new cuts per node was set for constraints CI2 (24) and to 15 – for constraints (19) if applied to fractional solutions. We have also observed that constraints CI1 (21) are rarely found deep in the branch-and-bound tree, that is why we tried separating them only at the first three levels of the tree. Unless stated otherwise, the weighted entropy-based branching rule was used. The computing times are reported for a laptop with Intel Core-i5 2.60  GHz CPU and 4GB RAM.In the first series of experiments, we assigned all the depots to the same vertex (the first one). To have a unified setting, in all the experiments the capacity of a vehicle was defined as ⌈D/(|K| − 0.5)⌉, where D is the total demand. For each input graph, we solved the CARP for 3, 4, … vehicles. Tables 1–3 summarise the sizes of the dataset and our computational experience with the instances that we could solve. The first column in the tables contains the titles of the instances (networks), ’LB’ and ’UB’ denote the root lower bound and the global upper bound (value of the best feasible solution found), respectively. The rest of the column titles are self-descriptive.As can be seen from Tables 1–3, the lower bound is usually tight. It can be also seen that the performance of the proposed approach does only slowly degrade as the size of the underlying network increases, but strongly deteriorates with an increase in the number of vehicles. This can be explained by the inherent symmetries of the model and by the fact that each vehicle (route) adds many variables to the formulation. It is remarkable that, in contrast to many other problems, even in case of exact lower bounds many branchings are needed to find an integral solution. This behaviour was observed for all variations of our framework, as well as for the CPLEX solver with the default settings. Note, that for instances from the literature a direct performance comparison with other papers cannot be made because we replace each undirected edge with two arcs, thus doubling the problem size.The behaviour of the cutting planes can be characterised as follows. Constraints CI1 (21) are crucial for a tight root lower bound: without them the CPU time needed for obtaining the same bound increases by orders of magnitude. Constraints (19) are necessary to eliminate subtours, but it also makes sense to apply them to fractional solutions without disconnected subtours for the sake of performance. The proposed constraints CI3 (24) are very useful for reducing the size of the BnB tree and the CPU times (see Fig. 5). We observed that the heuristic for their separation described in Section 3.2.2 produces high quality cutting planes, in comparison with the MILP that solves the separation problem exactly, and is considerably faster. The contribution of bridge inequalities (20) is very limited for the instances tested, but they may be useful for instances with more bridges. Concerning the generic cutting planes implemented in CPLEX, typically, very few of them (less than 5) are found during the solution, mainly zero-half cuts.Among the branching rules mentioned in Section 4, the weighted entropy-based rule leads to the smallest BnB tree and CPU time for most of the instances tested. Generally, branching on variables performed better that branching on cuts or node flows, weighted versions of rules performed better than simple ones (a difference of 10–20 percent).We would like to mention that the symmetry breaking scheme described in Section 3.3 allows reducing the CPU times at least by a factor of 2 if the root lower bound is not tight. Otherwise, the performance slightly deteriorates because the symmetry breaking constraints reduce the number of optimal solutions and it may take more time before one is found.The final series of experiments was aimed at assessing the impact of the location of depots on the performance of the model. In particular, for a selected network (“vypas6” in Table 3 ) and a fixed number of vehicles (|K| = 3) we tried solving the problem while locating each depot independently at a random vertex in the network. In total, more than 1000 trials were made. In some of them, all depots appeared to be assigned to the same vertex, thus representing a single-depot situation (all such cases were tried), in some cases two depots coincided – a case with effectively two depots, otherwise a valid 3-depot case occurs. Fig. 6summarises the results obtained. As can be seen from the figure, the case when all depots are placed in different vertices is statistically the easiest because the highest part of such instances can be solved within a minute. At the same time, there exist a considerable portion of the instances that could not be solved to optimality even within an hour. The single-depot case, while being more complex in terms of average performance, has better worst-case performance as the portion of unsolved instances is considerably less. Finally, the case when two out of three depots coincide appears to be the most complex one from the statistics perspective.

@&#CONCLUSIONS@&#
